<html>
<head>
<title>on-demand-entry-handler.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
on-demand-entry-handler.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../src/server/dev/on-demand-entry-handler.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type ws from 'next/dist/compiled/ws'</span><span class="s3">\n</span><span class="s1">import type { webpack } from 'next/dist/compiled/webpack/webpack'</span><span class="s3">\n</span><span class="s1">import type { NextConfigComplete } from '../config-shared'</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">DynamicParamTypesShort,</span><span class="s3">\n  </span><span class="s1">FlightRouterState,</span><span class="s3">\n  </span><span class="s1">FlightSegmentPath,</span><span class="s3">\n</span><span class="s1">} from '../app-render/types'</span><span class="s3">\n</span><span class="s1">import type { CompilerNameValues } from '../../shared/lib/constants'</span><span class="s3">\n</span><span class="s1">import type { RouteDefinition } from '../route-definitions/route-definition'</span><span class="s3">\n</span><span class="s1">import type HotReloaderWebpack from './hot-reloader-webpack'</span><span class="s3">\n\n</span><span class="s1">import createDebug from 'next/dist/compiled/debug'</span><span class="s3">\n</span><span class="s1">import { EventEmitter } from 'events'</span><span class="s3">\n</span><span class="s1">import { findPageFile } from '../lib/find-page-file'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">getStaticInfoIncludingLayouts,</span><span class="s3">\n  </span><span class="s1">runDependingOnPageType,</span><span class="s3">\n</span><span class="s1">} from '../../build/entries'</span><span class="s3">\n</span><span class="s1">import { join, posix } from 'path'</span><span class="s3">\n</span><span class="s1">import { normalizePathSep } from '../../shared/lib/page-path/normalize-path-sep'</span><span class="s3">\n</span><span class="s1">import { normalizePagePath } from '../../shared/lib/page-path/normalize-page-path'</span><span class="s3">\n</span><span class="s1">import { ensureLeadingSlash } from '../../shared/lib/page-path/ensure-leading-slash'</span><span class="s3">\n</span><span class="s1">import { removePagePathTail } from '../../shared/lib/page-path/remove-page-path-tail'</span><span class="s3">\n</span><span class="s1">import { reportTrigger } from '../../build/output'</span><span class="s3">\n</span><span class="s1">import getRouteFromEntrypoint from '../get-route-from-entrypoint'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">isInstrumentationHookFile,</span><span class="s3">\n  </span><span class="s1">isInstrumentationHookFilename,</span><span class="s3">\n  </span><span class="s1">isMiddlewareFile,</span><span class="s3">\n  </span><span class="s1">isMiddlewareFilename,</span><span class="s3">\n</span><span class="s1">} from '../../build/utils'</span><span class="s3">\n</span><span class="s1">import { PageNotFoundError, stringifyError } from '../../shared/lib/utils'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">COMPILER_INDEXES,</span><span class="s3">\n  </span><span class="s1">COMPILER_NAMES,</span><span class="s3">\n  </span><span class="s1">RSC_MODULE_TYPES,</span><span class="s3">\n  </span><span class="s1">UNDERSCORE_NOT_FOUND_ROUTE_ENTRY,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/constants'</span><span class="s3">\n</span><span class="s1">import { PAGE_SEGMENT_KEY } from '../../shared/lib/segment'</span><span class="s3">\n</span><span class="s1">import { HMR_ACTIONS_SENT_TO_BROWSER } from './hot-reloader-types'</span><span class="s3">\n</span><span class="s1">import { isAppPageRouteDefinition } from '../route-definitions/app-page-route-definition'</span><span class="s3">\n</span><span class="s1">import { scheduleOnNextTick } from '../../lib/scheduler'</span><span class="s3">\n</span><span class="s1">import { Batcher } from '../../lib/batcher'</span><span class="s3">\n</span><span class="s1">import { normalizeAppPath } from '../../shared/lib/router/utils/app-paths'</span><span class="s3">\n</span><span class="s1">import { PAGE_TYPES } from '../../lib/page-types'</span><span class="s3">\n</span><span class="s1">import { getNextFlightSegmentPath } from '../../client/flight-data-helpers'</span><span class="s3">\n\n</span><span class="s1">const debug = createDebug('next:on-demand-entry-handler')</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Returns object keys with type inferred from the object key</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">const keys = Object.keys as &lt;T&gt;(o: T) =&gt; Extract&lt;keyof T, string&gt;[]</span><span class="s3">\n\n</span><span class="s1">const COMPILER_KEYS = keys(COMPILER_INDEXES)</span><span class="s3">\n\n</span><span class="s1">function treePathToEntrypoint(</span><span class="s3">\n  </span><span class="s1">segmentPath: FlightSegmentPath,</span><span class="s3">\n  </span><span class="s1">parentPath?: string</span><span class="s3">\n</span><span class="s1">): string {</span><span class="s3">\n  </span><span class="s1">const [parallelRouteKey, segment] = segmentPath</span><span class="s3">\n\n  </span><span class="s1">// TODO-APP: modify this path to cover parallelRouteKey convention</span><span class="s3">\n  </span><span class="s1">const path =</span><span class="s3">\n    </span><span class="s1">(parentPath ? parentPath + '/' : '') +</span><span class="s3">\n    </span><span class="s1">(parallelRouteKey !== 'children' &amp;&amp; !segment.startsWith('@')</span><span class="s3">\n      </span><span class="s1">? `@${parallelRouteKey}/`</span><span class="s3">\n      </span><span class="s1">: '') +</span><span class="s3">\n    </span><span class="s1">(segment === '' ? 'page' : segment)</span><span class="s3">\n\n  </span><span class="s1">// Last segment</span><span class="s3">\n  </span><span class="s1">if (segmentPath.length === 2) {</span><span class="s3">\n    </span><span class="s1">return path</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const childSegmentPath = getNextFlightSegmentPath(segmentPath)</span><span class="s3">\n  </span><span class="s1">return treePathToEntrypoint(childSegmentPath, path)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function convertDynamicParamTypeToSyntax(</span><span class="s3">\n  </span><span class="s1">dynamicParamTypeShort: DynamicParamTypesShort,</span><span class="s3">\n  </span><span class="s1">param: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">switch (dynamicParamTypeShort) {</span><span class="s3">\n    </span><span class="s1">case 'c':</span><span class="s3">\n    </span><span class="s1">case 'ci':</span><span class="s3">\n      </span><span class="s1">return `[...${param}]`</span><span class="s3">\n    </span><span class="s1">case 'oc':</span><span class="s3">\n      </span><span class="s1">return `[[...${param}]]`</span><span class="s3">\n    </span><span class="s1">case 'd':</span><span class="s3">\n    </span><span class="s1">case 'di':</span><span class="s3">\n      </span><span class="s1">return `[${param}]`</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">throw new Error('Unknown dynamic param type')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* format: {compiler type}@{page type}@{page path}</span><span class="s3">\n </span><span class="s1">* e.g. client@pages@/index</span><span class="s3">\n </span><span class="s1">* e.g. server@app@app/page</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This guarantees the uniqueness for each page, to avoid conflicts between app/ and pages/</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">export function getEntryKey(</span><span class="s3">\n  </span><span class="s1">compilerType: CompilerNameValues,</span><span class="s3">\n  </span><span class="s1">pageBundleType: PAGE_TYPES,</span><span class="s3">\n  </span><span class="s1">page: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">// TODO: handle the /children slot better</span><span class="s3">\n  </span><span class="s1">// this is a quick hack to handle when children is provided as children/page instead of /page</span><span class="s3">\n  </span><span class="s1">const pageKey = page.replace(/(@[^/]+)</span><span class="s3">\\</span><span class="s1">/children/g, '$1')</span><span class="s3">\n  </span><span class="s1">return `${compilerType}@${pageBundleType}@${pageKey}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getPageBundleType(pageBundlePath: string): PAGE_TYPES {</span><span class="s3">\n  </span><span class="s1">// Handle special case for /_error</span><span class="s3">\n  </span><span class="s1">if (pageBundlePath === '/_error') return PAGE_TYPES.PAGES</span><span class="s3">\n  </span><span class="s1">if (isMiddlewareFilename(pageBundlePath)) return PAGE_TYPES.ROOT</span><span class="s3">\n  </span><span class="s1">return pageBundlePath.startsWith('pages/')</span><span class="s3">\n    </span><span class="s1">? PAGE_TYPES.PAGES</span><span class="s3">\n    </span><span class="s1">: pageBundlePath.startsWith('app/')</span><span class="s3">\n      </span><span class="s1">? PAGE_TYPES.APP</span><span class="s3">\n      </span><span class="s1">: PAGE_TYPES.ROOT</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getEntrypointsFromTree(</span><span class="s3">\n  </span><span class="s1">tree: FlightRouterState,</span><span class="s3">\n  </span><span class="s1">isFirst: boolean,</span><span class="s3">\n  </span><span class="s1">parentPath: string[] = []</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const [segment, parallelRoutes] = tree</span><span class="s3">\n\n  </span><span class="s1">const currentSegment = Array.isArray(segment)</span><span class="s3">\n    </span><span class="s1">? convertDynamicParamTypeToSyntax(segment[2], segment[0])</span><span class="s3">\n    </span><span class="s1">: segment</span><span class="s3">\n\n  </span><span class="s1">const isPageSegment = currentSegment.startsWith(PAGE_SEGMENT_KEY)</span><span class="s3">\n\n  </span><span class="s1">const currentPath = [...parentPath, isPageSegment ? '' : currentSegment]</span><span class="s3">\n\n  </span><span class="s1">if (!isFirst &amp;&amp; isPageSegment) {</span><span class="s3">\n    </span><span class="s1">// TODO get rid of '' at the start of tree</span><span class="s3">\n    </span><span class="s1">return [treePathToEntrypoint(currentPath.slice(1))]</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return Object.keys(parallelRoutes).reduce(</span><span class="s3">\n    </span><span class="s1">(paths: string[], key: string): string[] =&gt; {</span><span class="s3">\n      </span><span class="s1">const childTree = parallelRoutes[key]</span><span class="s3">\n      </span><span class="s1">const childPages = getEntrypointsFromTree(childTree, false, [</span><span class="s3">\n        </span><span class="s1">...currentPath,</span><span class="s3">\n        </span><span class="s1">key,</span><span class="s3">\n      </span><span class="s1">])</span><span class="s3">\n      </span><span class="s1">return [...paths, ...childPages]</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">[]</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const ADDED = Symbol('added')</span><span class="s3">\n</span><span class="s1">export const BUILDING = Symbol('building')</span><span class="s3">\n</span><span class="s1">export const BUILT = Symbol('built')</span><span class="s3">\n\n</span><span class="s1">interface EntryType {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Tells if a page is scheduled to be disposed.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">dispose?: boolean</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Timestamp with the last time the page was active.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">lastActiveTime?: number</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Page build status.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">status?: typeof ADDED | typeof BUILDING | typeof BUILT</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Path to the page file relative to the dist folder with no extension.</span><span class="s3">\n   </span><span class="s1">* For example: `pages/about/index`</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">bundlePath: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Webpack request to create a dependency for.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">request: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Shadowing check in ESLint does not account for enum</span><span class="s3">\n</span><span class="s1">// eslint-disable-next-line no-shadow</span><span class="s3">\n</span><span class="s1">export const enum EntryTypes {</span><span class="s3">\n  </span><span class="s1">ENTRY,</span><span class="s3">\n  </span><span class="s1">CHILD_ENTRY,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">interface Entry extends EntryType {</span><span class="s3">\n  </span><span class="s1">type: EntryTypes.ENTRY</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The absolute page to the page file. Used for detecting if the file was removed. For example:</span><span class="s3">\n   </span><span class="s1">* `/Users/Rick/project/pages/about/index.js`</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">absolutePagePath: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* All parallel pages that match the same entry, for example:</span><span class="s3">\n   </span><span class="s1">* ['/parallel/@bar/nested/@a/page', '/parallel/@bar/nested/@b/page', '/parallel/@foo/nested/@a/page', '/parallel/@foo/nested/@b/page']</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">appPaths: ReadonlyArray&lt;string&gt; | null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface ChildEntry extends EntryType {</span><span class="s3">\n  </span><span class="s1">type: EntryTypes.CHILD_ENTRY</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Which parent entries use this childEntry.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">parentEntries: Set&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The absolute page to the entry file. Used for detecting if the file was removed. For example:</span><span class="s3">\n   </span><span class="s1">* `/Users/Rick/project/app/about/layout.js`</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">absoluteEntryFilePath?: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const entriesMap: Map&lt;</span><span class="s3">\n  </span><span class="s1">string,</span><span class="s3">\n  </span><span class="s1">{</span><span class="s3">\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* The key composed of the compiler name and the page. For example:</span><span class="s3">\n     </span><span class="s1">* `edge-server/about`</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">[entryName: string]: Entry | ChildEntry</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&gt; = new Map()</span><span class="s3">\n\n</span><span class="s1">// remove /server from end of output for server compiler</span><span class="s3">\n</span><span class="s1">const normalizeOutputPath = (dir: string) =&gt; dir.replace(/[/</span><span class="s3">\\\\</span><span class="s1">]server$/, '')</span><span class="s3">\n\n</span><span class="s1">export const getEntries = (</span><span class="s3">\n  </span><span class="s1">dir: string</span><span class="s3">\n</span><span class="s1">): NonNullable&lt;ReturnType&lt;(typeof entriesMap)['get']&gt;&gt; =&gt; {</span><span class="s3">\n  </span><span class="s1">dir = normalizeOutputPath(dir)</span><span class="s3">\n  </span><span class="s1">const entries = entriesMap.get(dir) || {}</span><span class="s3">\n  </span><span class="s1">entriesMap.set(dir, entries)</span><span class="s3">\n  </span><span class="s1">return entries</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const invalidators: Map&lt;string, Invalidator&gt; = new Map()</span><span class="s3">\n\n</span><span class="s1">export const getInvalidator = (dir: string) =&gt; {</span><span class="s3">\n  </span><span class="s1">dir = normalizeOutputPath(dir)</span><span class="s3">\n  </span><span class="s1">return invalidators.get(dir)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const doneCallbacks: EventEmitter = new EventEmitter()</span><span class="s3">\n</span><span class="s1">const lastClientAccessPages = ['']</span><span class="s3">\n</span><span class="s1">const lastServerAccessPagesForAppDir = ['']</span><span class="s3">\n\n</span><span class="s1">type BuildingTracker = Set&lt;CompilerNameValues&gt;</span><span class="s3">\n</span><span class="s1">type RebuildTracker = Set&lt;CompilerNameValues&gt;</span><span class="s3">\n\n</span><span class="s1">// Make sure only one invalidation happens at a time</span><span class="s3">\n</span><span class="s1">// Otherwise, webpack hash gets changed and it'll force the client to reload.</span><span class="s3">\n</span><span class="s1">class Invalidator {</span><span class="s3">\n  </span><span class="s1">private multiCompiler: webpack.MultiCompiler</span><span class="s3">\n\n  </span><span class="s1">private building: BuildingTracker = new Set()</span><span class="s3">\n  </span><span class="s1">private rebuildAgain: RebuildTracker = new Set()</span><span class="s3">\n\n  </span><span class="s1">constructor(multiCompiler: webpack.MultiCompiler) {</span><span class="s3">\n    </span><span class="s1">this.multiCompiler = multiCompiler</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public shouldRebuildAll() {</span><span class="s3">\n    </span><span class="s1">return this.rebuildAgain.size &gt; 0</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">invalidate(compilerKeys: typeof COMPILER_KEYS = COMPILER_KEYS): void {</span><span class="s3">\n    </span><span class="s1">for (const key of compilerKeys) {</span><span class="s3">\n      </span><span class="s1">// If there's a current build is processing, we won't abort it by invalidating.</span><span class="s3">\n      </span><span class="s1">// (If aborted, it'll cause a client side hard reload)</span><span class="s3">\n      </span><span class="s1">// But let it to invalidate just after the completion.</span><span class="s3">\n      </span><span class="s1">// So, it can re-build the queued pages at once.</span><span class="s3">\n\n      </span><span class="s1">if (this.building.has(key)) {</span><span class="s3">\n        </span><span class="s1">this.rebuildAgain.add(key)</span><span class="s3">\n        </span><span class="s1">continue</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">this.building.add(key)</span><span class="s3">\n      </span><span class="s1">this.multiCompiler.compilers[COMPILER_INDEXES[key]].watching?.invalidate()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public startBuilding(compilerKey: keyof typeof COMPILER_INDEXES) {</span><span class="s3">\n    </span><span class="s1">this.building.add(compilerKey)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public doneBuilding(compilerKeys: typeof COMPILER_KEYS = []) {</span><span class="s3">\n    </span><span class="s1">const rebuild: typeof COMPILER_KEYS = []</span><span class="s3">\n    </span><span class="s1">for (const key of compilerKeys) {</span><span class="s3">\n      </span><span class="s1">this.building.delete(key)</span><span class="s3">\n\n      </span><span class="s1">if (this.rebuildAgain.has(key)) {</span><span class="s3">\n        </span><span class="s1">rebuild.push(key)</span><span class="s3">\n        </span><span class="s1">this.rebuildAgain.delete(key)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (rebuild.length &gt; 0) {</span><span class="s3">\n      </span><span class="s1">this.invalidate(rebuild)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public willRebuild(compilerKey: keyof typeof COMPILER_INDEXES) {</span><span class="s3">\n    </span><span class="s1">return this.rebuildAgain.has(compilerKey)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function disposeInactiveEntries(</span><span class="s3">\n  </span><span class="s1">entries: NonNullable&lt;ReturnType&lt;(typeof entriesMap)['get']&gt;&gt;,</span><span class="s3">\n  </span><span class="s1">maxInactiveAge: number</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">Object.keys(entries).forEach((entryKey) =&gt; {</span><span class="s3">\n    </span><span class="s1">const entryData = entries[entryKey]</span><span class="s3">\n    </span><span class="s1">const { lastActiveTime, status, dispose, bundlePath } = entryData</span><span class="s3">\n\n    </span><span class="s1">// TODO-APP: implement disposing of CHILD_ENTRY</span><span class="s3">\n    </span><span class="s1">if (entryData.type === EntryTypes.CHILD_ENTRY) {</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// For the root middleware and the instrumentation hook files,</span><span class="s3">\n    </span><span class="s1">// we don't dispose them periodically as it's needed for every request.</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">isMiddlewareFilename(bundlePath) ||</span><span class="s3">\n      </span><span class="s1">isInstrumentationHookFilename(bundlePath)</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (dispose)</span><span class="s3">\n      </span><span class="s1">// Skip pages already scheduled for disposing</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n\n    </span><span class="s1">// This means this entry is currently building or just added</span><span class="s3">\n    </span><span class="s1">// We don't need to dispose those entries.</span><span class="s3">\n    </span><span class="s1">if (status !== BUILT) return</span><span class="s3">\n\n    </span><span class="s1">// We should not build the last accessed page even we didn't get any pings</span><span class="s3">\n    </span><span class="s1">// Sometimes, it's possible our XHR ping to wait before completing other requests.</span><span class="s3">\n    </span><span class="s1">// In that case, we should not dispose the current viewing page</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">lastClientAccessPages.includes(entryKey) ||</span><span class="s3">\n      </span><span class="s1">lastServerAccessPagesForAppDir.includes(entryKey)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n\n    </span><span class="s1">if (lastActiveTime &amp;&amp; Date.now() - lastActiveTime &gt; maxInactiveAge) {</span><span class="s3">\n      </span><span class="s1">entries[entryKey].dispose = true</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Normalize both app paths and page paths</span><span class="s3">\n</span><span class="s1">function tryToNormalizePagePath(page: string) {</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">return normalizePagePath(page)</span><span class="s3">\n  </span><span class="s1">} catch (err) {</span><span class="s3">\n    </span><span class="s1">console.error(err)</span><span class="s3">\n    </span><span class="s1">throw new PageNotFoundError(page)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface PagePathData {</span><span class="s3">\n  </span><span class="s1">filename: string</span><span class="s3">\n  </span><span class="s1">bundlePath: string</span><span class="s3">\n  </span><span class="s1">page: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Attempts to find a page file path from the given pages absolute directory,</span><span class="s3">\n </span><span class="s1">* a page and allowed extensions. If the page can't be found it will throw an</span><span class="s3">\n </span><span class="s1">* error. It defaults the `/_error` page to Next.js internal error page.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param rootDir Absolute path to the project root.</span><span class="s3">\n </span><span class="s1">* @param page The page normalized (it will be denormalized).</span><span class="s3">\n </span><span class="s1">* @param extensions Array of page extensions.</span><span class="s3">\n </span><span class="s1">* @param pagesDir Absolute path to the pages folder with trailing `/pages`.</span><span class="s3">\n </span><span class="s1">* @param appDir Absolute path to the app folder with trailing `/app`.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export async function findPagePathData(</span><span class="s3">\n  </span><span class="s1">rootDir: string,</span><span class="s3">\n  </span><span class="s1">page: string,</span><span class="s3">\n  </span><span class="s1">extensions: string[],</span><span class="s3">\n  </span><span class="s1">pagesDir: string | undefined,</span><span class="s3">\n  </span><span class="s1">appDir: string | undefined,</span><span class="s3">\n  </span><span class="s1">isGlobalNotFoundEnabled: boolean</span><span class="s3">\n</span><span class="s1">): Promise&lt;PagePathData&gt; {</span><span class="s3">\n  </span><span class="s1">const normalizedPagePath = tryToNormalizePagePath(page)</span><span class="s3">\n  </span><span class="s1">let pagePath: string | null = null</span><span class="s3">\n\n  </span><span class="s1">const isInstrumentation = isInstrumentationHookFile(normalizedPagePath)</span><span class="s3">\n  </span><span class="s1">if (isMiddlewareFile(normalizedPagePath) || isInstrumentation) {</span><span class="s3">\n    </span><span class="s1">pagePath = await findPageFile(</span><span class="s3">\n      </span><span class="s1">rootDir,</span><span class="s3">\n      </span><span class="s1">normalizedPagePath,</span><span class="s3">\n      </span><span class="s1">extensions,</span><span class="s3">\n      </span><span class="s1">false</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">if (!pagePath) {</span><span class="s3">\n      </span><span class="s1">throw new PageNotFoundError(normalizedPagePath)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const pageUrl = ensureLeadingSlash(</span><span class="s3">\n      </span><span class="s1">removePagePathTail(normalizePathSep(pagePath), {</span><span class="s3">\n        </span><span class="s1">extensions,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">let bundlePath = normalizedPagePath</span><span class="s3">\n    </span><span class="s1">let pageKey = posix.normalize(pageUrl)</span><span class="s3">\n\n    </span><span class="s1">if (isInstrumentation || isMiddlewareFile(normalizedPagePath)) {</span><span class="s3">\n      </span><span class="s1">bundlePath = bundlePath.replace('/src', '')</span><span class="s3">\n      </span><span class="s1">pageKey = page.replace('/src', '')</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">filename: join(rootDir, pagePath),</span><span class="s3">\n      </span><span class="s1">bundlePath: bundlePath.slice(1),</span><span class="s3">\n      </span><span class="s1">page: pageKey,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Check appDir first falling back to pagesDir</span><span class="s3">\n  </span><span class="s1">if (appDir) {</span><span class="s3">\n    </span><span class="s1">if (page === UNDERSCORE_NOT_FOUND_ROUTE_ENTRY) {</span><span class="s3">\n      </span><span class="s1">// Load `global-not-found` when global-not-found is enabled.</span><span class="s3">\n      </span><span class="s1">// Prefer to load it when both `global-not-found` and root `not-found` present.</span><span class="s3">\n      </span><span class="s1">if (isGlobalNotFoundEnabled) {</span><span class="s3">\n        </span><span class="s1">const globalNotFoundPath = await findPageFile(</span><span class="s3">\n          </span><span class="s1">appDir,</span><span class="s3">\n          </span><span class="s1">'global-not-found',</span><span class="s3">\n          </span><span class="s1">extensions,</span><span class="s3">\n          </span><span class="s1">true</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">if (globalNotFoundPath) {</span><span class="s3">\n          </span><span class="s1">return {</span><span class="s3">\n            </span><span class="s1">filename: join(appDir, globalNotFoundPath),</span><span class="s3">\n            </span><span class="s1">bundlePath: `app${UNDERSCORE_NOT_FOUND_ROUTE_ENTRY}`,</span><span class="s3">\n            </span><span class="s1">page: UNDERSCORE_NOT_FOUND_ROUTE_ENTRY,</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">// Then if global-not-found.js doesn't exist then load not-found.js</span><span class="s3">\n        </span><span class="s1">const notFoundPath = await findPageFile(</span><span class="s3">\n          </span><span class="s1">appDir,</span><span class="s3">\n          </span><span class="s1">'not-found',</span><span class="s3">\n          </span><span class="s1">extensions,</span><span class="s3">\n          </span><span class="s1">true</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">if (notFoundPath) {</span><span class="s3">\n          </span><span class="s1">return {</span><span class="s3">\n            </span><span class="s1">filename: join(appDir, notFoundPath),</span><span class="s3">\n            </span><span class="s1">bundlePath: `app${UNDERSCORE_NOT_FOUND_ROUTE_ENTRY}`,</span><span class="s3">\n            </span><span class="s1">page: UNDERSCORE_NOT_FOUND_ROUTE_ENTRY,</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// If they're not presented, then fallback to global-not-found</span><span class="s3">\n      </span><span class="s1">return {</span><span class="s3">\n        </span><span class="s1">filename: require.resolve(</span><span class="s3">\n          </span><span class="s1">'next/dist/client/components/builtin/global-not-found'</span><span class="s3">\n        </span><span class="s1">),</span><span class="s3">\n        </span><span class="s1">bundlePath: `app${UNDERSCORE_NOT_FOUND_ROUTE_ENTRY}`,</span><span class="s3">\n        </span><span class="s1">page: UNDERSCORE_NOT_FOUND_ROUTE_ENTRY,</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">pagePath = await findPageFile(appDir, normalizedPagePath, extensions, true)</span><span class="s3">\n    </span><span class="s1">if (pagePath) {</span><span class="s3">\n      </span><span class="s1">const pageUrl = ensureLeadingSlash(</span><span class="s3">\n        </span><span class="s1">removePagePathTail(normalizePathSep(pagePath), {</span><span class="s3">\n          </span><span class="s1">keepIndex: true,</span><span class="s3">\n          </span><span class="s1">extensions,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n\n      </span><span class="s1">return {</span><span class="s3">\n        </span><span class="s1">filename: join(appDir, pagePath),</span><span class="s3">\n        </span><span class="s1">bundlePath: posix.join('app', pageUrl),</span><span class="s3">\n        </span><span class="s1">page: posix.normalize(pageUrl),</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!pagePath &amp;&amp; pagesDir) {</span><span class="s3">\n    </span><span class="s1">pagePath = await findPageFile(</span><span class="s3">\n      </span><span class="s1">pagesDir,</span><span class="s3">\n      </span><span class="s1">normalizedPagePath,</span><span class="s3">\n      </span><span class="s1">extensions,</span><span class="s3">\n      </span><span class="s1">false</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (pagePath !== null &amp;&amp; pagesDir) {</span><span class="s3">\n    </span><span class="s1">const pageUrl = ensureLeadingSlash(</span><span class="s3">\n      </span><span class="s1">removePagePathTail(normalizePathSep(pagePath), {</span><span class="s3">\n        </span><span class="s1">extensions,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">filename: join(pagesDir, pagePath),</span><span class="s3">\n      </span><span class="s1">bundlePath: posix.join('pages', normalizePagePath(pageUrl)),</span><span class="s3">\n      </span><span class="s1">page: posix.normalize(pageUrl),</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (page === '/_error') {</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">filename: require.resolve('next/dist/pages/_error'),</span><span class="s3">\n      </span><span class="s1">bundlePath: page,</span><span class="s3">\n      </span><span class="s1">page: normalizePathSep(page),</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">throw new PageNotFoundError(normalizedPagePath)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function onDemandEntryHandler({</span><span class="s3">\n  </span><span class="s1">hotReloader,</span><span class="s3">\n  </span><span class="s1">maxInactiveAge,</span><span class="s3">\n  </span><span class="s1">multiCompiler,</span><span class="s3">\n  </span><span class="s1">nextConfig,</span><span class="s3">\n  </span><span class="s1">pagesBufferLength,</span><span class="s3">\n  </span><span class="s1">pagesDir,</span><span class="s3">\n  </span><span class="s1">rootDir,</span><span class="s3">\n  </span><span class="s1">appDir,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">hotReloader: HotReloaderWebpack</span><span class="s3">\n  </span><span class="s1">maxInactiveAge: number</span><span class="s3">\n  </span><span class="s1">multiCompiler: webpack.MultiCompiler</span><span class="s3">\n  </span><span class="s1">nextConfig: NextConfigComplete</span><span class="s3">\n  </span><span class="s1">pagesBufferLength: number</span><span class="s3">\n  </span><span class="s1">pagesDir?: string</span><span class="s3">\n  </span><span class="s1">rootDir: string</span><span class="s3">\n  </span><span class="s1">appDir?: string</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">const hasAppDir = !!appDir</span><span class="s3">\n  </span><span class="s1">let curInvalidator: Invalidator = getInvalidator(</span><span class="s3">\n    </span><span class="s1">multiCompiler.outputPath</span><span class="s3">\n  </span><span class="s1">) as any</span><span class="s3">\n  </span><span class="s1">const curEntries = getEntries(multiCompiler.outputPath) as any</span><span class="s3">\n\n  </span><span class="s1">if (!curInvalidator) {</span><span class="s3">\n    </span><span class="s1">curInvalidator = new Invalidator(multiCompiler)</span><span class="s3">\n    </span><span class="s1">invalidators.set(multiCompiler.outputPath, curInvalidator)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const startBuilding = (compilation: webpack.Compilation) =&gt; {</span><span class="s3">\n    </span><span class="s1">const compilationName = compilation.name as any as CompilerNameValues</span><span class="s3">\n    </span><span class="s1">curInvalidator.startBuilding(compilationName)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">for (const compiler of multiCompiler.compilers) {</span><span class="s3">\n    </span><span class="s1">compiler.hooks.make.tap('NextJsOnDemandEntries', startBuilding)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">function getPagePathsFromEntrypoints(</span><span class="s3">\n    </span><span class="s1">type: CompilerNameValues,</span><span class="s3">\n    </span><span class="s1">entrypoints: Map&lt;string, { name?: string | null }&gt;</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">const pagePaths: string[] = []</span><span class="s3">\n    </span><span class="s1">for (const entrypoint of entrypoints.values()) {</span><span class="s3">\n      </span><span class="s1">const page = getRouteFromEntrypoint(entrypoint.name!, hasAppDir)</span><span class="s3">\n\n      </span><span class="s1">if (page) {</span><span class="s3">\n        </span><span class="s1">const pageBundleType = entrypoint.name?.startsWith('app/')</span><span class="s3">\n          </span><span class="s1">? PAGE_TYPES.APP</span><span class="s3">\n          </span><span class="s1">: PAGE_TYPES.PAGES</span><span class="s3">\n        </span><span class="s1">pagePaths.push(getEntryKey(type, pageBundleType, page))</span><span class="s3">\n      </span><span class="s1">} else if (</span><span class="s3">\n        </span><span class="s1">isMiddlewareFilename(entrypoint.name) ||</span><span class="s3">\n        </span><span class="s1">isInstrumentationHookFilename(entrypoint.name)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">pagePaths.push(</span><span class="s3">\n          </span><span class="s1">getEntryKey(type, PAGE_TYPES.ROOT, `/${entrypoint.name}`)</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return pagePaths</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">for (const compiler of multiCompiler.compilers) {</span><span class="s3">\n    </span><span class="s1">compiler.hooks.done.tap('NextJsOnDemandEntries', () =&gt;</span><span class="s3">\n      </span><span class="s1">getInvalidator(compiler.outputPath)?.doneBuilding([</span><span class="s3">\n        </span><span class="s1">compiler.name as keyof typeof COMPILER_INDEXES,</span><span class="s3">\n      </span><span class="s1">])</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">multiCompiler.hooks.done.tap('NextJsOnDemandEntries', (multiStats) =&gt; {</span><span class="s3">\n    </span><span class="s1">const [clientStats, serverStats, edgeServerStats] = multiStats.stats</span><span class="s3">\n    </span><span class="s1">const entryNames = [</span><span class="s3">\n      </span><span class="s1">...getPagePathsFromEntrypoints(</span><span class="s3">\n        </span><span class="s1">COMPILER_NAMES.client,</span><span class="s3">\n        </span><span class="s1">clientStats.compilation.entrypoints</span><span class="s3">\n      </span><span class="s1">),</span><span class="s3">\n      </span><span class="s1">...getPagePathsFromEntrypoints(</span><span class="s3">\n        </span><span class="s1">COMPILER_NAMES.server,</span><span class="s3">\n        </span><span class="s1">serverStats.compilation.entrypoints</span><span class="s3">\n      </span><span class="s1">),</span><span class="s3">\n      </span><span class="s1">...(edgeServerStats</span><span class="s3">\n        </span><span class="s1">? getPagePathsFromEntrypoints(</span><span class="s3">\n            </span><span class="s1">COMPILER_NAMES.edgeServer,</span><span class="s3">\n            </span><span class="s1">edgeServerStats.compilation.entrypoints</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">: []),</span><span class="s3">\n    </span><span class="s1">]</span><span class="s3">\n\n    </span><span class="s1">for (const name of entryNames) {</span><span class="s3">\n      </span><span class="s1">const entry = curEntries[name]</span><span class="s3">\n      </span><span class="s1">if (!entry) {</span><span class="s3">\n        </span><span class="s1">continue</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (entry.status !== BUILDING) {</span><span class="s3">\n        </span><span class="s1">continue</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">entry.status = BUILT</span><span class="s3">\n      </span><span class="s1">doneCallbacks.emit(name)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">getInvalidator(multiCompiler.outputPath)?.doneBuilding([...COMPILER_KEYS])</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">const pingIntervalTime = Math.max(1000, Math.min(5000, maxInactiveAge))</span><span class="s3">\n\n  </span><span class="s1">setInterval(function () {</span><span class="s3">\n    </span><span class="s1">disposeInactiveEntries(curEntries, maxInactiveAge)</span><span class="s3">\n  </span><span class="s1">}, pingIntervalTime + 1000).unref()</span><span class="s3">\n\n  </span><span class="s1">function handleAppDirPing(tree: FlightRouterState): void {</span><span class="s3">\n    </span><span class="s1">const pages = getEntrypointsFromTree(tree, true)</span><span class="s3">\n\n    </span><span class="s1">for (const page of pages) {</span><span class="s3">\n      </span><span class="s1">for (const compilerType of [</span><span class="s3">\n        </span><span class="s1">COMPILER_NAMES.client,</span><span class="s3">\n        </span><span class="s1">COMPILER_NAMES.server,</span><span class="s3">\n        </span><span class="s1">COMPILER_NAMES.edgeServer,</span><span class="s3">\n      </span><span class="s1">]) {</span><span class="s3">\n        </span><span class="s1">const entryKey = getEntryKey(compilerType, PAGE_TYPES.APP, `/${page}`)</span><span class="s3">\n        </span><span class="s1">const entryInfo = curEntries[entryKey]</span><span class="s3">\n\n        </span><span class="s1">// If there's no entry, it may have been invalidated and needs to be re-built.</span><span class="s3">\n        </span><span class="s1">if (!entryInfo) {</span><span class="s3">\n          </span><span class="s1">// if (page !== lastEntry) client pings, but there's no entry for page</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// We don't need to maintain active state of anything other than BUILT entries</span><span class="s3">\n        </span><span class="s1">if (entryInfo.status !== BUILT) continue</span><span class="s3">\n\n        </span><span class="s1">// If there's an entryInfo</span><span class="s3">\n        </span><span class="s1">if (!lastServerAccessPagesForAppDir.includes(entryKey)) {</span><span class="s3">\n          </span><span class="s1">lastServerAccessPagesForAppDir.unshift(entryKey)</span><span class="s3">\n\n          </span><span class="s1">// Maintain the buffer max length</span><span class="s3">\n          </span><span class="s1">// TODO: verify that the current pageKey is not at the end of the array as multiple entrypoints can exist</span><span class="s3">\n          </span><span class="s1">if (lastServerAccessPagesForAppDir.length &gt; pagesBufferLength) {</span><span class="s3">\n            </span><span class="s1">lastServerAccessPagesForAppDir.pop()</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">entryInfo.lastActiveTime = Date.now()</span><span class="s3">\n        </span><span class="s1">entryInfo.dispose = false</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">function handlePing(pg: string): void {</span><span class="s3">\n    </span><span class="s1">const page = normalizePathSep(pg)</span><span class="s3">\n    </span><span class="s1">for (const compilerType of [</span><span class="s3">\n      </span><span class="s1">COMPILER_NAMES.client,</span><span class="s3">\n      </span><span class="s1">COMPILER_NAMES.server,</span><span class="s3">\n      </span><span class="s1">COMPILER_NAMES.edgeServer,</span><span class="s3">\n    </span><span class="s1">]) {</span><span class="s3">\n      </span><span class="s1">const entryKey = getEntryKey(compilerType, PAGE_TYPES.PAGES, page)</span><span class="s3">\n      </span><span class="s1">const entryInfo = curEntries[entryKey]</span><span class="s3">\n\n      </span><span class="s1">// If there's no entry, it may have been invalidated and needs to be re-built.</span><span class="s3">\n      </span><span class="s1">if (!entryInfo) {</span><span class="s3">\n        </span><span class="s1">// if (page !== lastEntry) client pings, but there's no entry for page</span><span class="s3">\n        </span><span class="s1">if (compilerType === COMPILER_NAMES.client) {</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">continue</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// We don't need to maintain active state of anything other than BUILT entries</span><span class="s3">\n      </span><span class="s1">if (entryInfo.status !== BUILT) continue</span><span class="s3">\n\n      </span><span class="s1">// If there's an entryInfo</span><span class="s3">\n      </span><span class="s1">if (!lastClientAccessPages.includes(entryKey)) {</span><span class="s3">\n        </span><span class="s1">lastClientAccessPages.unshift(entryKey)</span><span class="s3">\n\n        </span><span class="s1">// Maintain the buffer max length</span><span class="s3">\n        </span><span class="s1">if (lastClientAccessPages.length &gt; pagesBufferLength) {</span><span class="s3">\n          </span><span class="s1">lastClientAccessPages.pop()</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">entryInfo.lastActiveTime = Date.now()</span><span class="s3">\n      </span><span class="s1">entryInfo.dispose = false</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">async function ensurePageImpl({</span><span class="s3">\n    </span><span class="s1">page,</span><span class="s3">\n    </span><span class="s1">appPaths,</span><span class="s3">\n    </span><span class="s1">definition,</span><span class="s3">\n    </span><span class="s1">isApp,</span><span class="s3">\n    </span><span class="s1">url,</span><span class="s3">\n  </span><span class="s1">}: {</span><span class="s3">\n    </span><span class="s1">page: string</span><span class="s3">\n    </span><span class="s1">appPaths: ReadonlyArray&lt;string&gt; | null</span><span class="s3">\n    </span><span class="s1">definition: RouteDefinition | undefined</span><span class="s3">\n    </span><span class="s1">isApp: boolean | undefined</span><span class="s3">\n    </span><span class="s1">url?: string</span><span class="s3">\n  </span><span class="s1">}): Promise&lt;void&gt; {</span><span class="s3">\n    </span><span class="s1">const stalledTime = 60</span><span class="s3">\n    </span><span class="s1">const stalledEnsureTimeout = setTimeout(() =&gt; {</span><span class="s3">\n      </span><span class="s1">debug(</span><span class="s3">\n        </span><span class="s1">`Ensuring ${page} has taken longer than ${stalledTime}s, if this continues to stall this may be a bug`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}, stalledTime * 1000)</span><span class="s3">\n\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">let route: Pick&lt;RouteDefinition, 'filename' | 'bundlePath' | 'page'&gt;</span><span class="s3">\n      </span><span class="s1">if (definition) {</span><span class="s3">\n        </span><span class="s1">route = definition</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">route = await findPagePathData(</span><span class="s3">\n          </span><span class="s1">rootDir,</span><span class="s3">\n          </span><span class="s1">page,</span><span class="s3">\n          </span><span class="s1">nextConfig.pageExtensions,</span><span class="s3">\n          </span><span class="s1">pagesDir,</span><span class="s3">\n          </span><span class="s1">appDir,</span><span class="s3">\n          </span><span class="s1">!!nextConfig.experimental.globalNotFound</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const isInsideAppDir = !!appDir &amp;&amp; route.filename.startsWith(appDir)</span><span class="s3">\n\n      </span><span class="s1">if (typeof isApp === 'boolean' &amp;&amp; isApp !== isInsideAppDir) {</span><span class="s3">\n        </span><span class="s1">Error.stackTraceLimit = 15</span><span class="s3">\n        </span><span class="s1">throw new Error(</span><span class="s3">\n          </span><span class="s1">`Ensure bailed, found path </span><span class="s3">\&quot;</span><span class="s1">${</span><span class="s3">\n            </span><span class="s1">route.page</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\&quot; </span><span class="s1">does not match ensure type (${isApp ? 'app' : 'pages'})`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const pageBundleType = getPageBundleType(route.bundlePath)</span><span class="s3">\n      </span><span class="s1">const addEntry = (</span><span class="s3">\n        </span><span class="s1">compilerType: CompilerNameValues</span><span class="s3">\n      </span><span class="s1">): {</span><span class="s3">\n        </span><span class="s1">entryKey: string</span><span class="s3">\n        </span><span class="s1">newEntry: boolean</span><span class="s3">\n        </span><span class="s1">shouldInvalidate: boolean</span><span class="s3">\n      </span><span class="s1">} =&gt; {</span><span class="s3">\n        </span><span class="s1">const entryKey = getEntryKey(compilerType, pageBundleType, route.page)</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">curEntries[entryKey] &amp;&amp;</span><span class="s3">\n          </span><span class="s1">// there can be an overlap in the entryKey for the instrumentation hook file and a page named the same</span><span class="s3">\n          </span><span class="s1">// this is a quick fix to support this scenario by overwriting the instrumentation hook entry, since we only use it one time</span><span class="s3">\n          </span><span class="s1">// any changes to the instrumentation hook file will require a restart of the dev server anyway</span><span class="s3">\n          </span><span class="s1">!isInstrumentationHookFilename(curEntries[entryKey].bundlePath)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">curEntries[entryKey].dispose = false</span><span class="s3">\n          </span><span class="s1">curEntries[entryKey].lastActiveTime = Date.now()</span><span class="s3">\n          </span><span class="s1">if (curEntries[entryKey].status === BUILT) {</span><span class="s3">\n            </span><span class="s1">return {</span><span class="s3">\n              </span><span class="s1">entryKey,</span><span class="s3">\n              </span><span class="s1">newEntry: false,</span><span class="s3">\n              </span><span class="s1">shouldInvalidate: false,</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">return {</span><span class="s3">\n            </span><span class="s1">entryKey,</span><span class="s3">\n            </span><span class="s1">newEntry: false,</span><span class="s3">\n            </span><span class="s1">shouldInvalidate: true,</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">curEntries[entryKey] = {</span><span class="s3">\n          </span><span class="s1">type: EntryTypes.ENTRY,</span><span class="s3">\n          </span><span class="s1">appPaths,</span><span class="s3">\n          </span><span class="s1">absolutePagePath: route.filename,</span><span class="s3">\n          </span><span class="s1">request: route.filename,</span><span class="s3">\n          </span><span class="s1">bundlePath: route.bundlePath,</span><span class="s3">\n          </span><span class="s1">dispose: false,</span><span class="s3">\n          </span><span class="s1">lastActiveTime: Date.now(),</span><span class="s3">\n          </span><span class="s1">status: ADDED,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">return {</span><span class="s3">\n          </span><span class="s1">entryKey: entryKey,</span><span class="s3">\n          </span><span class="s1">newEntry: true,</span><span class="s3">\n          </span><span class="s1">shouldInvalidate: true,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const staticInfo = await getStaticInfoIncludingLayouts({</span><span class="s3">\n        </span><span class="s1">page,</span><span class="s3">\n        </span><span class="s1">pageFilePath: route.filename,</span><span class="s3">\n        </span><span class="s1">isInsideAppDir,</span><span class="s3">\n        </span><span class="s1">pageExtensions: nextConfig.pageExtensions,</span><span class="s3">\n        </span><span class="s1">isDev: true,</span><span class="s3">\n        </span><span class="s1">config: nextConfig,</span><span class="s3">\n        </span><span class="s1">appDir,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n\n      </span><span class="s1">const added = new Map&lt;CompilerNameValues, ReturnType&lt;typeof addEntry&gt;&gt;()</span><span class="s3">\n      </span><span class="s1">const isServerComponent =</span><span class="s3">\n        </span><span class="s1">isInsideAppDir &amp;&amp; staticInfo.rsc !== RSC_MODULE_TYPES.client</span><span class="s3">\n\n      </span><span class="s1">let pageRuntime = staticInfo.runtime</span><span class="s3">\n\n      </span><span class="s1">runDependingOnPageType({</span><span class="s3">\n        </span><span class="s1">page: route.page,</span><span class="s3">\n        </span><span class="s1">pageRuntime,</span><span class="s3">\n        </span><span class="s1">pageType: pageBundleType,</span><span class="s3">\n        </span><span class="s1">onClient: () =&gt; {</span><span class="s3">\n          </span><span class="s1">// Skip adding the client entry for app / Server Components.</span><span class="s3">\n          </span><span class="s1">if (isServerComponent || isInsideAppDir) {</span><span class="s3">\n            </span><span class="s1">return</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">added.set(COMPILER_NAMES.client, addEntry(COMPILER_NAMES.client))</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">onServer: () =&gt; {</span><span class="s3">\n          </span><span class="s1">added.set(COMPILER_NAMES.server, addEntry(COMPILER_NAMES.server))</span><span class="s3">\n          </span><span class="s1">const edgeServerEntry = getEntryKey(</span><span class="s3">\n            </span><span class="s1">COMPILER_NAMES.edgeServer,</span><span class="s3">\n            </span><span class="s1">pageBundleType,</span><span class="s3">\n            </span><span class="s1">route.page</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">if (</span><span class="s3">\n            </span><span class="s1">curEntries[edgeServerEntry] &amp;&amp;</span><span class="s3">\n            </span><span class="s1">!isInstrumentationHookFile(route.page)</span><span class="s3">\n          </span><span class="s1">) {</span><span class="s3">\n            </span><span class="s1">// Runtime switched from edge to server</span><span class="s3">\n            </span><span class="s1">delete curEntries[edgeServerEntry]</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">onEdgeServer: () =&gt; {</span><span class="s3">\n          </span><span class="s1">added.set(</span><span class="s3">\n            </span><span class="s1">COMPILER_NAMES.edgeServer,</span><span class="s3">\n            </span><span class="s1">addEntry(COMPILER_NAMES.edgeServer)</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">const serverEntry = getEntryKey(</span><span class="s3">\n            </span><span class="s1">COMPILER_NAMES.server,</span><span class="s3">\n            </span><span class="s1">pageBundleType,</span><span class="s3">\n            </span><span class="s1">route.page</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">if (</span><span class="s3">\n            </span><span class="s1">curEntries[serverEntry] &amp;&amp;</span><span class="s3">\n            </span><span class="s1">!isInstrumentationHookFile(route.page)</span><span class="s3">\n          </span><span class="s1">) {</span><span class="s3">\n            </span><span class="s1">// Runtime switched from server to edge</span><span class="s3">\n            </span><span class="s1">delete curEntries[serverEntry]</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n\n      </span><span class="s1">const addedValues = [...added.values()]</span><span class="s3">\n      </span><span class="s1">const entriesThatShouldBeInvalidated = [...added.entries()].filter(</span><span class="s3">\n        </span><span class="s1">([, entry]) =&gt; entry.shouldInvalidate</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">const hasNewEntry = addedValues.some((entry) =&gt; entry.newEntry)</span><span class="s3">\n\n      </span><span class="s1">if (hasNewEntry) {</span><span class="s3">\n        </span><span class="s1">const routePage = isApp ? route.page : normalizeAppPath(route.page)</span><span class="s3">\n        </span><span class="s1">reportTrigger(routePage, url)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (entriesThatShouldBeInvalidated.length &gt; 0) {</span><span class="s3">\n        </span><span class="s1">const invalidatePromise = Promise.all(</span><span class="s3">\n          </span><span class="s1">entriesThatShouldBeInvalidated.map(([compilerKey, { entryKey }]) =&gt; {</span><span class="s3">\n            </span><span class="s1">return new Promise&lt;void&gt;((resolve, reject) =&gt; {</span><span class="s3">\n              </span><span class="s1">doneCallbacks.once(entryKey, (err: Error) =&gt; {</span><span class="s3">\n                </span><span class="s1">if (err) {</span><span class="s3">\n                  </span><span class="s1">return reject(err)</span><span class="s3">\n                </span><span class="s1">}</span><span class="s3">\n\n                </span><span class="s1">// If the invalidation also triggers a rebuild, we need to</span><span class="s3">\n                </span><span class="s1">// wait for that additional build to prevent race conditions.</span><span class="s3">\n                </span><span class="s1">const needsRebuild = curInvalidator.willRebuild(compilerKey)</span><span class="s3">\n                </span><span class="s1">if (needsRebuild) {</span><span class="s3">\n                  </span><span class="s1">doneCallbacks.once(entryKey, (rebuildErr: Error) =&gt; {</span><span class="s3">\n                    </span><span class="s1">if (rebuildErr) {</span><span class="s3">\n                      </span><span class="s1">return reject(rebuildErr)</span><span class="s3">\n                    </span><span class="s1">}</span><span class="s3">\n                    </span><span class="s1">resolve()</span><span class="s3">\n                  </span><span class="s1">})</span><span class="s3">\n                </span><span class="s1">} else {</span><span class="s3">\n                  </span><span class="s1">resolve()</span><span class="s3">\n                </span><span class="s1">}</span><span class="s3">\n              </span><span class="s1">})</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">curInvalidator.invalidate([...added.keys()])</span><span class="s3">\n        </span><span class="s1">await invalidatePromise</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} finally {</span><span class="s3">\n      </span><span class="s1">clearTimeout(stalledEnsureTimeout)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">type EnsurePageOptions = {</span><span class="s3">\n    </span><span class="s1">page: string</span><span class="s3">\n    </span><span class="s1">appPaths?: ReadonlyArray&lt;string&gt; | null</span><span class="s3">\n    </span><span class="s1">definition?: RouteDefinition</span><span class="s3">\n    </span><span class="s1">isApp?: boolean</span><span class="s3">\n    </span><span class="s1">url?: string</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Make sure that we won't have multiple invalidations ongoing concurrently.</span><span class="s3">\n  </span><span class="s1">const batcher = Batcher.create&lt;EnsurePageOptions, void, string&gt;({</span><span class="s3">\n    </span><span class="s1">// The cache key here is composed of the elements that affect the</span><span class="s3">\n    </span><span class="s1">// compilation, namely, the page, whether it's client only, and whether</span><span class="s3">\n    </span><span class="s1">// it's an app page. This ensures that we don't have multiple compilations</span><span class="s3">\n    </span><span class="s1">// for the same page happening concurrently.</span><span class="s3">\n    </span><span class="s1">//</span><span class="s3">\n    </span><span class="s1">// We don't include the whole match because it contains match specific</span><span class="s3">\n    </span><span class="s1">// parameters (like route params) that would just bust this cache. Any</span><span class="s3">\n    </span><span class="s1">// details that would possibly bust the cache should be listed here.</span><span class="s3">\n    </span><span class="s1">cacheKeyFn: (options) =&gt; JSON.stringify(options),</span><span class="s3">\n    </span><span class="s1">// Schedule the invocation of the ensurePageImpl function on the next tick.</span><span class="s3">\n    </span><span class="s1">schedulerFn: scheduleOnNextTick,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">async ensurePage({</span><span class="s3">\n      </span><span class="s1">page,</span><span class="s3">\n      </span><span class="s1">appPaths = null,</span><span class="s3">\n      </span><span class="s1">definition,</span><span class="s3">\n      </span><span class="s1">isApp,</span><span class="s3">\n      </span><span class="s1">url,</span><span class="s3">\n    </span><span class="s1">}: EnsurePageOptions) {</span><span class="s3">\n      </span><span class="s1">// If the route is actually an app page route, then we should have access</span><span class="s3">\n      </span><span class="s1">// to the app route definition, and therefore, the appPaths from it.</span><span class="s3">\n      </span><span class="s1">if (!appPaths &amp;&amp; definition &amp;&amp; isAppPageRouteDefinition(definition)) {</span><span class="s3">\n        </span><span class="s1">appPaths = definition.appPaths</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Wrap the invocation of the ensurePageImpl function in the pending</span><span class="s3">\n      </span><span class="s1">// wrapper, which will ensure that we don't have multiple compilations</span><span class="s3">\n      </span><span class="s1">// for the same page happening concurrently.</span><span class="s3">\n      </span><span class="s1">return batcher.batch({ page, appPaths, definition, isApp }, async () =&gt; {</span><span class="s3">\n        </span><span class="s1">await ensurePageImpl({</span><span class="s3">\n          </span><span class="s1">page,</span><span class="s3">\n          </span><span class="s1">appPaths,</span><span class="s3">\n          </span><span class="s1">definition,</span><span class="s3">\n          </span><span class="s1">isApp,</span><span class="s3">\n          </span><span class="s1">url,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">onHMR(client: ws, getHmrServerError: () =&gt; Error | null) {</span><span class="s3">\n      </span><span class="s1">let bufferedHmrServerError: Error | null = null</span><span class="s3">\n\n      </span><span class="s1">client.addEventListener('close', () =&gt; {</span><span class="s3">\n        </span><span class="s1">bufferedHmrServerError = null</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">client.addEventListener('message', ({ data }) =&gt; {</span><span class="s3">\n        </span><span class="s1">try {</span><span class="s3">\n          </span><span class="s1">const error = getHmrServerError()</span><span class="s3">\n\n          </span><span class="s1">// New error occurred: buffered error is flushed and new error occurred</span><span class="s3">\n          </span><span class="s1">if (!bufferedHmrServerError &amp;&amp; error) {</span><span class="s3">\n            </span><span class="s1">hotReloader.send({</span><span class="s3">\n              </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ERROR,</span><span class="s3">\n              </span><span class="s1">errorJSON: stringifyError(error),</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n            </span><span class="s1">bufferedHmrServerError = null</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">const parsedData = JSON.parse(</span><span class="s3">\n            </span><span class="s1">typeof data !== 'string' ? data.toString() : data</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n\n          </span><span class="s1">if (parsedData.event === 'ping') {</span><span class="s3">\n            </span><span class="s1">if (parsedData.appDirRoute) {</span><span class="s3">\n              </span><span class="s1">handleAppDirPing(parsedData.tree)</span><span class="s3">\n            </span><span class="s1">} else {</span><span class="s3">\n              </span><span class="s1">handlePing(parsedData.page)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">} catch {}</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ADDED&quot;</span><span class="s0">,</span><span class="s1">&quot;BUILDING&quot;</span><span class="s0">,</span><span class="s1">&quot;BUILT&quot;</span><span class="s0">,</span><span class="s1">&quot;EntryTypes&quot;</span><span class="s0">,</span><span class="s1">&quot;findPagePathData&quot;</span><span class="s0">,</span><span class="s1">&quot;getEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;getEntryKey&quot;</span><span class="s0">,</span><span class="s1">&quot;getInvalidator&quot;</span><span class="s0">,</span><span class="s1">&quot;onDemandEntryHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;debug&quot;</span><span class="s0">,</span><span class="s1">&quot;createDebug&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;COMPILER_KEYS&quot;</span><span class="s0">,</span><span class="s1">&quot;COMPILER_INDEXES&quot;</span><span class="s0">,</span><span class="s1">&quot;treePathToEntrypoint&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;parentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;parallelRouteKey&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;childSegmentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;getNextFlightSegmentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;convertDynamicParamTypeToSyntax&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicParamTypeShort&quot;</span><span class="s0">,</span><span class="s1">&quot;param&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;compilerType&quot;</span><span class="s0">,</span><span class="s1">&quot;pageBundleType&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;pageKey&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;getPageBundleType&quot;</span><span class="s0">,</span><span class="s1">&quot;pageBundlePath&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGE_TYPES&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGES&quot;</span><span class="s0">,</span><span class="s1">&quot;isMiddlewareFilename&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT&quot;</span><span class="s0">,</span><span class="s1">&quot;APP&quot;</span><span class="s0">,</span><span class="s1">&quot;getEntrypointsFromTree&quot;</span><span class="s0">,</span><span class="s1">&quot;tree&quot;</span><span class="s0">,</span><span class="s1">&quot;isFirst&quot;</span><span class="s0">,</span><span class="s1">&quot;parallelRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;currentSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;isPageSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGE_SEGMENT_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;currentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;reduce&quot;</span><span class="s0">,</span><span class="s1">&quot;paths&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;childTree&quot;</span><span class="s0">,</span><span class="s1">&quot;childPages&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;entriesMap&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeOutputPath&quot;</span><span class="s0">,</span><span class="s1">&quot;dir&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidators&quot;</span><span class="s0">,</span><span class="s1">&quot;doneCallbacks&quot;</span><span class="s0">,</span><span class="s1">&quot;EventEmitter&quot;</span><span class="s0">,</span><span class="s1">&quot;lastClientAccessPages&quot;</span><span class="s0">,</span><span class="s1">&quot;lastServerAccessPagesForAppDir&quot;</span><span class="s0">,</span><span class="s1">&quot;Invalidator&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;multiCompiler&quot;</span><span class="s0">,</span><span class="s1">&quot;building&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;rebuildAgain&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldRebuildAll&quot;</span><span class="s0">,</span><span class="s1">&quot;size&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;compilerKeys&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;compilers&quot;</span><span class="s0">,</span><span class="s1">&quot;watching&quot;</span><span class="s0">,</span><span class="s1">&quot;startBuilding&quot;</span><span class="s0">,</span><span class="s1">&quot;compilerKey&quot;</span><span class="s0">,</span><span class="s1">&quot;doneBuilding&quot;</span><span class="s0">,</span><span class="s1">&quot;rebuild&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;willRebuild&quot;</span><span class="s0">,</span><span class="s1">&quot;disposeInactiveEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;maxInactiveAge&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;entryKey&quot;</span><span class="s0">,</span><span class="s1">&quot;entryData&quot;</span><span class="s0">,</span><span class="s1">&quot;lastActiveTime&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;dispose&quot;</span><span class="s0">,</span><span class="s1">&quot;bundlePath&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;isInstrumentationHookFilename&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;Date&quot;</span><span class="s0">,</span><span class="s1">&quot;now&quot;</span><span class="s0">,</span><span class="s1">&quot;tryToNormalizePagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizePagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;PageNotFoundError&quot;</span><span class="s0">,</span><span class="s1">&quot;rootDir&quot;</span><span class="s0">,</span><span class="s1">&quot;extensions&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesDir&quot;</span><span class="s0">,</span><span class="s1">&quot;appDir&quot;</span><span class="s0">,</span><span class="s1">&quot;isGlobalNotFoundEnabled&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizedPagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;pagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;isInstrumentation&quot;</span><span class="s0">,</span><span class="s1">&quot;isInstrumentationHookFile&quot;</span><span class="s0">,</span><span class="s1">&quot;isMiddlewareFile&quot;</span><span class="s0">,</span><span class="s1">&quot;findPageFile&quot;</span><span class="s0">,</span><span class="s1">&quot;pageUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;ensureLeadingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;removePagePathTail&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizePathSep&quot;</span><span class="s0">,</span><span class="s1">&quot;posix&quot;</span><span class="s0">,</span><span class="s1">&quot;normalize&quot;</span><span class="s0">,</span><span class="s1">&quot;filename&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;UNDERSCORE_NOT_FOUND_ROUTE_ENTRY&quot;</span><span class="s0">,</span><span class="s1">&quot;globalNotFoundPath&quot;</span><span class="s0">,</span><span class="s1">&quot;notFoundPath&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;keepIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;hotReloader&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesBufferLength&quot;</span><span class="s0">,</span><span class="s1">&quot;hasAppDir&quot;</span><span class="s0">,</span><span class="s1">&quot;curInvalidator&quot;</span><span class="s0">,</span><span class="s1">&quot;outputPath&quot;</span><span class="s0">,</span><span class="s1">&quot;curEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;compilation&quot;</span><span class="s0">,</span><span class="s1">&quot;compilationName&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;compiler&quot;</span><span class="s0">,</span><span class="s1">&quot;hooks&quot;</span><span class="s0">,</span><span class="s1">&quot;make&quot;</span><span class="s0">,</span><span class="s1">&quot;tap&quot;</span><span class="s0">,</span><span class="s1">&quot;getPagePathsFromEntrypoints&quot;</span><span class="s0">,</span><span class="s1">&quot;entrypoints&quot;</span><span class="s0">,</span><span class="s1">&quot;pagePaths&quot;</span><span class="s0">,</span><span class="s1">&quot;entrypoint&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;getRouteFromEntrypoint&quot;</span><span class="s0">,</span><span class="s1">&quot;done&quot;</span><span class="s0">,</span><span class="s1">&quot;multiStats&quot;</span><span class="s0">,</span><span class="s1">&quot;clientStats&quot;</span><span class="s0">,</span><span class="s1">&quot;serverStats&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeServerStats&quot;</span><span class="s0">,</span><span class="s1">&quot;stats&quot;</span><span class="s0">,</span><span class="s1">&quot;entryNames&quot;</span><span class="s0">,</span><span class="s1">&quot;COMPILER_NAMES&quot;</span><span class="s0">,</span><span class="s1">&quot;client&quot;</span><span class="s0">,</span><span class="s1">&quot;server&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeServer&quot;</span><span class="s0">,</span><span class="s1">&quot;entry&quot;</span><span class="s0">,</span><span class="s1">&quot;emit&quot;</span><span class="s0">,</span><span class="s1">&quot;pingIntervalTime&quot;</span><span class="s0">,</span><span class="s1">&quot;Math&quot;</span><span class="s0">,</span><span class="s1">&quot;max&quot;</span><span class="s0">,</span><span class="s1">&quot;min&quot;</span><span class="s0">,</span><span class="s1">&quot;setInterval&quot;</span><span class="s0">,</span><span class="s1">&quot;unref&quot;</span><span class="s0">,</span><span class="s1">&quot;handleAppDirPing&quot;</span><span class="s0">,</span><span class="s1">&quot;pages&quot;</span><span class="s0">,</span><span class="s1">&quot;entryInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;unshift&quot;</span><span class="s0">,</span><span class="s1">&quot;pop&quot;</span><span class="s0">,</span><span class="s1">&quot;handlePing&quot;</span><span class="s0">,</span><span class="s1">&quot;pg&quot;</span><span class="s0">,</span><span class="s1">&quot;ensurePageImpl&quot;</span><span class="s0">,</span><span class="s1">&quot;appPaths&quot;</span><span class="s0">,</span><span class="s1">&quot;definition&quot;</span><span class="s0">,</span><span class="s1">&quot;isApp&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;stalledTime&quot;</span><span class="s0">,</span><span class="s1">&quot;stalledEnsureTimeout&quot;</span><span class="s0">,</span><span class="s1">&quot;setTimeout&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;pageExtensions&quot;</span><span class="s0">,</span><span class="s1">&quot;experimental&quot;</span><span class="s0">,</span><span class="s1">&quot;globalNotFound&quot;</span><span class="s0">,</span><span class="s1">&quot;isInsideAppDir&quot;</span><span class="s0">,</span><span class="s1">&quot;stackTraceLimit&quot;</span><span class="s0">,</span><span class="s1">&quot;addEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;newEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldInvalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;absolutePagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;staticInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;getStaticInfoIncludingLayouts&quot;</span><span class="s0">,</span><span class="s1">&quot;pageFilePath&quot;</span><span class="s0">,</span><span class="s1">&quot;isDev&quot;</span><span class="s0">,</span><span class="s1">&quot;config&quot;</span><span class="s0">,</span><span class="s1">&quot;added&quot;</span><span class="s0">,</span><span class="s1">&quot;isServerComponent&quot;</span><span class="s0">,</span><span class="s1">&quot;rsc&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_MODULE_TYPES&quot;</span><span class="s0">,</span><span class="s1">&quot;pageRuntime&quot;</span><span class="s0">,</span><span class="s1">&quot;runtime&quot;</span><span class="s0">,</span><span class="s1">&quot;runDependingOnPageType&quot;</span><span class="s0">,</span><span class="s1">&quot;pageType&quot;</span><span class="s0">,</span><span class="s1">&quot;onClient&quot;</span><span class="s0">,</span><span class="s1">&quot;onServer&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeServerEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;onEdgeServer&quot;</span><span class="s0">,</span><span class="s1">&quot;serverEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;addedValues&quot;</span><span class="s0">,</span><span class="s1">&quot;entriesThatShouldBeInvalidated&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;hasNewEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;some&quot;</span><span class="s0">,</span><span class="s1">&quot;routePage&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;reportTrigger&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidatePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;all&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;reject&quot;</span><span class="s0">,</span><span class="s1">&quot;once&quot;</span><span class="s0">,</span><span class="s1">&quot;needsRebuild&quot;</span><span class="s0">,</span><span class="s1">&quot;rebuildErr&quot;</span><span class="s0">,</span><span class="s1">&quot;clearTimeout&quot;</span><span class="s0">,</span><span class="s1">&quot;batcher&quot;</span><span class="s0">,</span><span class="s1">&quot;Batcher&quot;</span><span class="s0">,</span><span class="s1">&quot;create&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheKeyFn&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;schedulerFn&quot;</span><span class="s0">,</span><span class="s1">&quot;scheduleOnNextTick&quot;</span><span class="s0">,</span><span class="s1">&quot;ensurePage&quot;</span><span class="s0">,</span><span class="s1">&quot;isAppPageRouteDefinition&quot;</span><span class="s0">,</span><span class="s1">&quot;batch&quot;</span><span class="s0">,</span><span class="s1">&quot;onHMR&quot;</span><span class="s0">,</span><span class="s1">&quot;getHmrServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;bufferedHmrServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;addEventListener&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;send&quot;</span><span class="s0">,</span><span class="s1">&quot;action&quot;</span><span class="s0">,</span><span class="s1">&quot;HMR_ACTIONS_SENT_TO_BROWSER&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;errorJSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringifyError&quot;</span><span class="s0">,</span><span class="s1">&quot;parsedData&quot;</span><span class="s0">,</span><span class="s1">&quot;parse&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;event&quot;</span><span class="s0">,</span><span class="s1">&quot;appDirRoute&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>