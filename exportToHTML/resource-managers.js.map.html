<html>
<head>
<title>resource-managers.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
resource-managers.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/server/web/sandbox/resource-managers.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;abstract class ResourceManager&lt;T, Args&gt; {</span><span class="s3">\n  </span><span class="s1">private resources: T[] = []</span><span class="s3">\n\n  </span><span class="s1">abstract create(resourceArgs: Args): T</span><span class="s3">\n  </span><span class="s1">abstract destroy(resource: T): void</span><span class="s3">\n\n  </span><span class="s1">add(resourceArgs: Args) {</span><span class="s3">\n    </span><span class="s1">const resource = this.create(resourceArgs)</span><span class="s3">\n    </span><span class="s1">this.resources.push(resource)</span><span class="s3">\n    </span><span class="s1">return resource</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">remove(resource: T) {</span><span class="s3">\n    </span><span class="s1">this.resources = this.resources.filter((r) =&gt; r !== resource)</span><span class="s3">\n    </span><span class="s1">this.destroy(resource)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">removeAll() {</span><span class="s3">\n    </span><span class="s1">this.resources.forEach(this.destroy)</span><span class="s3">\n    </span><span class="s1">this.resources = []</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">class IntervalsManager extends ResourceManager&lt;</span><span class="s3">\n  </span><span class="s1">number,</span><span class="s3">\n  </span><span class="s1">Parameters&lt;typeof setInterval&gt;</span><span class="s3">\n</span><span class="s1">&gt; {</span><span class="s3">\n  </span><span class="s1">create(args: Parameters&lt;typeof setInterval&gt;) {</span><span class="s3">\n    </span><span class="s1">// TODO: use the edge runtime provided `setInterval` instead</span><span class="s3">\n    </span><span class="s1">return webSetIntervalPolyfill(...args)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">destroy(interval: number) {</span><span class="s3">\n    </span><span class="s1">clearInterval(interval)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">class TimeoutsManager extends ResourceManager&lt;</span><span class="s3">\n  </span><span class="s1">number,</span><span class="s3">\n  </span><span class="s1">Parameters&lt;typeof setTimeout&gt;</span><span class="s3">\n</span><span class="s1">&gt; {</span><span class="s3">\n  </span><span class="s1">create(args: Parameters&lt;typeof setTimeout&gt;) {</span><span class="s3">\n    </span><span class="s1">// TODO: use the edge runtime provided `setTimeout` instead</span><span class="s3">\n    </span><span class="s1">return webSetTimeoutPolyfill(...args)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">destroy(timeout: number) {</span><span class="s3">\n    </span><span class="s1">clearTimeout(timeout)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function webSetIntervalPolyfill&lt;TArgs extends any[]&gt;(</span><span class="s3">\n  </span><span class="s1">callback: (...args: TArgs) =&gt; void,</span><span class="s3">\n  </span><span class="s1">ms?: number,</span><span class="s3">\n  </span><span class="s1">...args: TArgs</span><span class="s3">\n</span><span class="s1">): number {</span><span class="s3">\n  </span><span class="s1">return setInterval(() =&gt; {</span><span class="s3">\n    </span><span class="s1">// node's `setInterval` sets `this` to the `Timeout` instance it returned,</span><span class="s3">\n    </span><span class="s1">// but web `setInterval` always sets `this` to `window`</span><span class="s3">\n    </span><span class="s1">// see: https://developer.mozilla.org/en-US/docs/Web/API/Window/setInterval#the_this_problem</span><span class="s3">\n    </span><span class="s1">return callback.apply(globalThis, args)</span><span class="s3">\n  </span><span class="s1">}, ms)[Symbol.toPrimitive]()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function webSetTimeoutPolyfill&lt;TArgs extends any[]&gt;(</span><span class="s3">\n  </span><span class="s1">callback: (...args: TArgs) =&gt; void,</span><span class="s3">\n  </span><span class="s1">ms?: number,</span><span class="s3">\n  </span><span class="s1">...args: TArgs</span><span class="s3">\n</span><span class="s1">): number {</span><span class="s3">\n  </span><span class="s1">const wrappedCallback = () =&gt; {</span><span class="s3">\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">// node's `setTimeout` sets `this` to the `Timeout` instance it returned,</span><span class="s3">\n      </span><span class="s1">// but web `setTimeout` always sets `this` to `window`</span><span class="s3">\n      </span><span class="s1">// see: https://developer.mozilla.org/en-US/docs/Web/API/Window/setTimeout#the_this_problem</span><span class="s3">\n      </span><span class="s1">return callback.apply(globalThis, args)</span><span class="s3">\n    </span><span class="s1">} finally {</span><span class="s3">\n      </span><span class="s1">// On certain older node versions (&lt;20.16.0, &lt;22.4.0),</span><span class="s3">\n      </span><span class="s1">// a `setTimeout` whose Timeout was converted to a primitive will leak.</span><span class="s3">\n      </span><span class="s1">// See: https://github.com/nodejs/node/issues/53335</span><span class="s3">\n      </span><span class="s1">// We can work around this by explicitly calling `clearTimeout` after the callback runs.</span><span class="s3">\n      </span><span class="s1">clearTimeout(timeout)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const timeout = setTimeout(wrappedCallback, ms)</span><span class="s3">\n  </span><span class="s1">return timeout[Symbol.toPrimitive]()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const intervalsManager = new IntervalsManager()</span><span class="s3">\n</span><span class="s1">export const timeoutsManager = new TimeoutsManager()</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;intervalsManager&quot;</span><span class="s0">,</span><span class="s1">&quot;timeoutsManager&quot;</span><span class="s0">,</span><span class="s1">&quot;ResourceManager&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;resourceArgs&quot;</span><span class="s0">,</span><span class="s1">&quot;resource&quot;</span><span class="s0">,</span><span class="s1">&quot;create&quot;</span><span class="s0">,</span><span class="s1">&quot;resources&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;remove&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;r&quot;</span><span class="s0">,</span><span class="s1">&quot;destroy&quot;</span><span class="s0">,</span><span class="s1">&quot;removeAll&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;IntervalsManager&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;webSetIntervalPolyfill&quot;</span><span class="s0">,</span><span class="s1">&quot;interval&quot;</span><span class="s0">,</span><span class="s1">&quot;clearInterval&quot;</span><span class="s0">,</span><span class="s1">&quot;TimeoutsManager&quot;</span><span class="s0">,</span><span class="s1">&quot;webSetTimeoutPolyfill&quot;</span><span class="s0">,</span><span class="s1">&quot;timeout&quot;</span><span class="s0">,</span><span class="s1">&quot;clearTimeout&quot;</span><span class="s0">,</span><span class="s1">&quot;callback&quot;</span><span class="s0">,</span><span class="s1">&quot;ms&quot;</span><span class="s0">,</span><span class="s1">&quot;setInterval&quot;</span><span class="s0">,</span><span class="s1">&quot;apply&quot;</span><span class="s0">,</span><span class="s1">&quot;globalThis&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;toPrimitive&quot;</span><span class="s0">,</span><span class="s1">&quot;wrappedCallback&quot;</span><span class="s0">,</span><span class="s1">&quot;setTimeout&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;IAuFaA,gBAAgB;eAAhBA;;IACAC,eAAe;eAAfA;;;AAxFb,MAAeC;IAMbC,IAAIC,YAAkB,EAAE;QACtB,MAAMC,WAAW,IAAI,CAACC,MAAM,CAACF;QAC7B,IAAI,CAACG,SAAS,CAACC,IAAI,CAACH;QACpB,OAAOA;IACT;IAEAI,OAAOJ,QAAW,EAAE;QAClB,IAAI,CAACE,SAAS,GAAG,IAAI,CAACA,SAAS,CAACG,MAAM,CAAC,CAACC,IAAMA,MAAMN;QACpD,IAAI,CAACO,OAAO,CAACP;IACf;IAEAQ,YAAY;QACV,IAAI,CAACN,SAAS,CAACO,OAAO,CAAC,IAAI,CAACF,OAAO;QACnC,IAAI,CAACL,SAAS,GAAG,EAAE;IACrB;;aAnBQA,YAAiB,EAAE;;AAoB7B;AAEA,MAAMQ,yBAAyBb;IAI7BI,OAAOU,IAAoC,EAAE;QAC3C,4DAA4D;QAC5D,OAAOC,0BAA0BD;IACnC;IAEAJ,QAAQM,QAAgB,EAAE;QACxBC,cAAcD;IAChB;AACF;AAEA,MAAME,wBAAwBlB;IAI5BI,OAAOU,IAAmC,EAAE;QAC1C,2DAA2D;QAC3D,OAAOK,yBAAyBL;IAClC;IAEAJ,QAAQU,OAAe,EAAE;QACvBC,aAAaD;IACf;AACF;AAEA,SAASL,uBACPO,QAAkC,EAClCC,EAAW,EACX,GAAGT,IAAW;IAEd,OAAOU,YAAY;QACjB,0EAA0E;QAC1E,uDAAuD;QACvD,4FAA4F;QAC5F,OAAOF,SAASG,KAAK,CAACC,YAAYZ;IACpC,GAAGS,GAAG,CAACI,OAAOC,WAAW,CAAC;AAC5B;AAEA,SAAST,sBACPG,QAAkC,EAClCC,EAAW,EACX,GAAGT,IAAW;IAEd,MAAMe,kBAAkB;QACtB,IAAI;YACF,yEAAyE;YACzE,sDAAsD;YACtD,2FAA2F;YAC3F,OAAOP,SAASG,KAAK,CAACC,YAAYZ;QACpC,SAAU;YACR,sDAAsD;YACtD,uEAAuE;YACvE,mDAAmD;YACnD,wFAAwF;YACxFO,aAAaD;QACf;IACF;IACA,MAAMA,UAAUU,WAAWD,iBAAiBN;IAC5C,OAAOH,OAAO,CAACO,OAAOC,WAAW,CAAC;AACpC;AAEO,MAAM9B,mBAAmB,IAAIe;AAC7B,MAAMd,kBAAkB,IAAImB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>