<html>
<head>
<title>pull-google-metadata.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #1750eb;}
.s4 { color: #8c8c8c; font-style: italic;}
.s5 { color: #0037a6;}
.s6 { color: #264eff;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
pull-google-metadata.js</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">fs from </span><span class="s2">'fs'</span>
<span class="s0">import </span><span class="s1">{ download } from </span><span class="s2">'libphonenumber-metadata-generator'</span>

<span class="s0">const </span><span class="s1">metadataFileOutputPath = process.argv[</span><span class="s3">2</span><span class="s1">]</span>
<span class="s0">const </span><span class="s1">infoFileOutputPath = process.argv[</span><span class="s3">3</span><span class="s1">]</span>

<span class="s4">// Pulls the latest released metadata from Google's repostory.</span>
<span class="s4">// Updates `PhoneNumberMetadata.xml` and `metadata-info.json` files.</span>
<span class="s1">download().then(({ date, version, changes, xml }) =&gt; {</span>
	<span class="s4">// Print the metadata version and a list of changes.</span>
	<span class="s1">console.log(</span><span class="s2">'========================================'</span><span class="s1">)</span>
	<span class="s1">console.log(</span><span class="s2">`= Metadata / </span><span class="s1">${version}</span><span class="s2">`</span><span class="s1">)</span>
	<span class="s1">console.log(</span><span class="s2">'='</span><span class="s1">)</span>
	<span class="s1">console.log(</span><span class="s2">`= Date: </span><span class="s1">${date.toUTCString()</span>
		<span class="s1">.slice(</span><span class="s3">0</span><span class="s1">, date.toUTCString().indexOf(</span><span class="s2">'00:00:00'</span><span class="s1">) - </span><span class="s3">1</span><span class="s1">)</span>
		<span class="s1">.slice(date.toUTCString().indexOf(</span><span class="s2">','</span><span class="s1">) + </span><span class="s2">', '</span><span class="s1">.length)</span>
	<span class="s1">}</span><span class="s2">`</span><span class="s1">)</span>
	<span class="s1">console.log(</span><span class="s2">'='</span><span class="s1">)</span>
	<span class="s0">const </span><span class="s1">consoleOutputPrefix = </span><span class="s2">'= '</span>
	<span class="s1">console.log(</span><span class="s2">`= Changes:</span><span class="s5">\n</span><span class="s1">${changes.map(_ =&gt; consoleOutputPrefix + </span><span class="s2">'* ' </span><span class="s1">+ _.replace(</span><span class="s6">/\n/g</span><span class="s1">, </span><span class="s2">'</span><span class="s5">\n</span><span class="s2">' </span><span class="s1">+ consoleOutputPrefix + </span><span class="s2">'  '</span><span class="s1">)).join(</span><span class="s2">'</span><span class="s5">\n</span><span class="s2">'</span><span class="s1">)}</span><span class="s2">`</span><span class="s1">)</span>
	<span class="s1">console.log(</span><span class="s2">'========================================'</span><span class="s1">)</span>
	<span class="s4">// Write metadata changes info.</span>
	<span class="s1">fs.writeFileSync(infoFileOutputPath, JSON.stringify({ date, version, changes }, </span><span class="s0">null</span><span class="s1">, </span><span class="s3">2</span><span class="s1">))</span>
	<span class="s4">// Write the latest metadata XML to `PhoneNumberMetadata.xml` file.</span>
	<span class="s1">fs.writeFileSync(metadataFileOutputPath, xml)</span>
<span class="s1">}).catch((error) =&gt; {</span>
	<span class="s1">console.error(error)</span>
	<span class="s1">process.exit(</span><span class="s3">1</span><span class="s1">)</span>
<span class="s1">})</span></pre>
</body>
</html>