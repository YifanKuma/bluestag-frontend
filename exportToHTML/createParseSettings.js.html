<html>
<head>
<title>createParseSettings.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #1750eb;}
.s4 { color: #8c8c8c; font-style: italic;}
.s5 { color: #264eff;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
createParseSettings.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>
<span class="s2">var </span><span class="s1">__createBinding = (</span><span class="s2">this </span><span class="s1">&amp;&amp; </span><span class="s2">this</span><span class="s1">.__createBinding) || (Object.create ? (</span><span class="s2">function</span><span class="s1">(o, m, k, k2) {</span>
    <span class="s2">if </span><span class="s1">(k2 === undefined) k2 = k;</span>
    <span class="s2">var </span><span class="s1">desc = Object.getOwnPropertyDescriptor(m, k);</span>
    <span class="s2">if </span><span class="s1">(!desc || (</span><span class="s0">&quot;get&quot; </span><span class="s2">in </span><span class="s1">desc ? !m.__esModule : desc.writable || desc.configurable)) {</span>
      <span class="s1">desc = { enumerable: </span><span class="s2">true</span><span class="s1">, get: </span><span class="s2">function</span><span class="s1">() { </span><span class="s2">return </span><span class="s1">m[k]; } };</span>
    <span class="s1">}</span>
    <span class="s1">Object.defineProperty(o, k2, desc);</span>
<span class="s1">}) : (</span><span class="s2">function</span><span class="s1">(o, m, k, k2) {</span>
    <span class="s2">if </span><span class="s1">(k2 === undefined) k2 = k;</span>
    <span class="s1">o[k2] = m[k];</span>
<span class="s1">}));</span>
<span class="s2">var </span><span class="s1">__setModuleDefault = (</span><span class="s2">this </span><span class="s1">&amp;&amp; </span><span class="s2">this</span><span class="s1">.__setModuleDefault) || (Object.create ? (</span><span class="s2">function</span><span class="s1">(o, v) {</span>
    <span class="s1">Object.defineProperty(o, </span><span class="s0">&quot;default&quot;</span><span class="s1">, { enumerable: </span><span class="s2">true</span><span class="s1">, value: v });</span>
<span class="s1">}) : </span><span class="s2">function</span><span class="s1">(o, v) {</span>
    <span class="s1">o[</span><span class="s0">&quot;default&quot;</span><span class="s1">] = v;</span>
<span class="s1">});</span>
<span class="s2">var </span><span class="s1">__importStar = (</span><span class="s2">this </span><span class="s1">&amp;&amp; </span><span class="s2">this</span><span class="s1">.__importStar) || (</span><span class="s2">function </span><span class="s1">() {</span>
    <span class="s2">var </span><span class="s1">ownKeys = </span><span class="s2">function</span><span class="s1">(o) {</span>
        <span class="s1">ownKeys = Object.getOwnPropertyNames || </span><span class="s2">function </span><span class="s1">(o) {</span>
            <span class="s2">var </span><span class="s1">ar = [];</span>
            <span class="s2">for </span><span class="s1">(</span><span class="s2">var </span><span class="s1">k </span><span class="s2">in </span><span class="s1">o) </span><span class="s2">if </span><span class="s1">(Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;</span>
            <span class="s2">return </span><span class="s1">ar;</span>
        <span class="s1">};</span>
        <span class="s2">return </span><span class="s1">ownKeys(o);</span>
    <span class="s1">};</span>
    <span class="s2">return function </span><span class="s1">(mod) {</span>
        <span class="s2">if </span><span class="s1">(mod &amp;&amp; mod.__esModule) </span><span class="s2">return </span><span class="s1">mod;</span>
        <span class="s2">var </span><span class="s1">result = {};</span>
        <span class="s2">if </span><span class="s1">(mod != </span><span class="s2">null</span><span class="s1">) </span><span class="s2">for </span><span class="s1">(</span><span class="s2">var </span><span class="s1">k = ownKeys(mod), i = </span><span class="s3">0</span><span class="s1">; i &lt; k.length; i++) </span><span class="s2">if </span><span class="s1">(k[i] !== </span><span class="s0">&quot;default&quot;</span><span class="s1">) __createBinding(result, mod, k[i]);</span>
        <span class="s1">__setModuleDefault(result, mod);</span>
        <span class="s2">return </span><span class="s1">result;</span>
    <span class="s1">};</span>
<span class="s1">})();</span>
<span class="s2">var </span><span class="s1">__importDefault = (</span><span class="s2">this </span><span class="s1">&amp;&amp; </span><span class="s2">this</span><span class="s1">.__importDefault) || </span><span class="s2">function </span><span class="s1">(mod) {</span>
    <span class="s2">return </span><span class="s1">(mod &amp;&amp; mod.__esModule) ? mod : { </span><span class="s0">&quot;default&quot;</span><span class="s1">: mod };</span>
<span class="s1">};</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, { value: </span><span class="s2">true </span><span class="s1">});</span>
<span class="s1">exports.createParseSettings = createParseSettings;</span>
<span class="s1">exports.clearTSConfigMatchCache = clearTSConfigMatchCache;</span>
<span class="s1">exports.clearTSServerProjectService = clearTSServerProjectService;</span>
<span class="s2">const </span><span class="s1">project_service_1 = require(</span><span class="s0">&quot;@typescript-eslint/project-service&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">debug_1 = __importDefault(require(</span><span class="s0">&quot;debug&quot;</span><span class="s1">));</span>
<span class="s2">const </span><span class="s1">node_path_1 = __importDefault(require(</span><span class="s0">&quot;node:path&quot;</span><span class="s1">));</span>
<span class="s2">const </span><span class="s1">ts = __importStar(require(</span><span class="s0">&quot;typescript&quot;</span><span class="s1">));</span>
<span class="s2">const </span><span class="s1">shared_1 = require(</span><span class="s0">&quot;../create-program/shared&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">validateDefaultProjectForFilesGlob_1 = require(</span><span class="s0">&quot;../create-program/validateDefaultProjectForFilesGlob&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">source_files_1 = require(</span><span class="s0">&quot;../source-files&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">candidateTSConfigRootDirs_1 = require(</span><span class="s0">&quot;./candidateTSConfigRootDirs&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">ExpiringCache_1 = require(</span><span class="s0">&quot;./ExpiringCache&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">getProjectConfigFiles_1 = require(</span><span class="s0">&quot;./getProjectConfigFiles&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">inferSingleRun_1 = require(</span><span class="s0">&quot;./inferSingleRun&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">resolveProjectList_1 = require(</span><span class="s0">&quot;./resolveProjectList&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">warnAboutTSVersion_1 = require(</span><span class="s0">&quot;./warnAboutTSVersion&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">log = (</span><span class="s3">0</span><span class="s1">, debug_1.default)(</span><span class="s0">'typescript-eslint:typescript-estree:parseSettings:createParseSettings'</span><span class="s1">);</span>
<span class="s2">let </span><span class="s1">TSCONFIG_MATCH_CACHE;</span>
<span class="s2">let </span><span class="s1">TSSERVER_PROJECT_SERVICE = </span><span class="s2">null</span><span class="s1">;</span>
<span class="s4">// NOTE - we intentionally use &quot;unnecessary&quot; `?.` here because in TS&lt;5.3 this enum doesn't exist</span>
<span class="s4">// This object exists so we can centralize these for tracking and so we don't proliferate these across the file</span>
<span class="s4">// https://github.com/microsoft/TypeScript/issues/56579</span>
<span class="s4">/* eslint-disable @typescript-eslint/no-unnecessary-condition */</span>
<span class="s2">const </span><span class="s1">JSDocParsingMode = {</span>
    <span class="s1">ParseAll: ts.JSDocParsingMode?.ParseAll,</span>
    <span class="s1">ParseForTypeErrors: ts.JSDocParsingMode?.ParseForTypeErrors,</span>
    <span class="s1">ParseForTypeInfo: ts.JSDocParsingMode?.ParseForTypeInfo,</span>
    <span class="s1">ParseNone: ts.JSDocParsingMode?.ParseNone,</span>
<span class="s1">};</span>
<span class="s4">/* eslint-enable @typescript-eslint/no-unnecessary-condition */</span>
<span class="s2">function </span><span class="s1">createParseSettings(code, tsestreeOptions = {}) {</span>
    <span class="s2">const </span><span class="s1">codeFullText = enforceCodeString(code);</span>
    <span class="s2">const </span><span class="s1">singleRun = (</span><span class="s3">0</span><span class="s1">, inferSingleRun_1.inferSingleRun)(tsestreeOptions);</span>
    <span class="s2">const </span><span class="s1">tsconfigRootDir = (() =&gt; {</span>
        <span class="s2">if </span><span class="s1">(tsestreeOptions.tsconfigRootDir == </span><span class="s2">null</span><span class="s1">) {</span>
            <span class="s2">const </span><span class="s1">inferredTsconfigRootDir = (</span><span class="s3">0</span><span class="s1">, candidateTSConfigRootDirs_1.getInferredTSConfigRootDir)();</span>
            <span class="s2">if </span><span class="s1">(node_path_1.default.resolve(inferredTsconfigRootDir) !== inferredTsconfigRootDir) {</span>
                <span class="s2">throw new </span><span class="s1">Error(</span><span class="s0">`inferred tsconfigRootDir should be a resolved absolute path, but received: </span><span class="s1">${JSON.stringify(inferredTsconfigRootDir)}</span><span class="s0">. This is a bug in typescript-eslint! Please report it to us at https://github.com/typescript-eslint/typescript-eslint/issues/new/choose.`</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s2">return </span><span class="s1">inferredTsconfigRootDir;</span>
        <span class="s1">}</span>
        <span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">tsestreeOptions.tsconfigRootDir === </span><span class="s0">'string'</span><span class="s1">) {</span>
            <span class="s2">const </span><span class="s1">userProvidedTsconfigRootDir = tsestreeOptions.tsconfigRootDir;</span>
            <span class="s2">if </span><span class="s1">(!node_path_1.default.isAbsolute(userProvidedTsconfigRootDir) ||</span>
                <span class="s4">// Ensure it's fully absolute with a drive letter if windows</span>
                <span class="s1">(process.platform === </span><span class="s0">'win32' </span><span class="s1">&amp;&amp;</span>
                    <span class="s1">!</span><span class="s5">/^[a-zA-Z]:/</span><span class="s1">.test(userProvidedTsconfigRootDir))) {</span>
                <span class="s2">throw new </span><span class="s1">Error(</span><span class="s0">`parserOptions.tsconfigRootDir must be an absolute path, but received: </span><span class="s1">${JSON.stringify(userProvidedTsconfigRootDir)}</span><span class="s0">. This is a bug in your configuration; please supply an absolute path.`</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s4">// Deal with any funny business around trailing path separators (a/b/) or relative path segments (/a/b/../c)</span>
            <span class="s4">// Since we already know it's absolute, we can safely use path.resolve here.</span>
            <span class="s2">return </span><span class="s1">node_path_1.default.resolve(userProvidedTsconfigRootDir);</span>
        <span class="s1">}</span>
        <span class="s2">throw new </span><span class="s1">Error(</span><span class="s0">`If provided, parserOptions.tsconfigRootDir must be a string, but received a value of type &quot;</span><span class="s1">${</span><span class="s2">typeof </span><span class="s1">tsestreeOptions.tsconfigRootDir}</span><span class="s0">&quot;`</span><span class="s1">);</span>
    <span class="s1">})();</span>
    <span class="s2">const </span><span class="s1">passedLoggerFn = </span><span class="s2">typeof </span><span class="s1">tsestreeOptions.loggerFn === </span><span class="s0">'function'</span><span class="s1">;</span>
    <span class="s2">const </span><span class="s1">filePath = (</span><span class="s3">0</span><span class="s1">, shared_1.ensureAbsolutePath)(</span><span class="s2">typeof </span><span class="s1">tsestreeOptions.filePath === </span><span class="s0">'string' </span><span class="s1">&amp;&amp;</span>
        <span class="s1">tsestreeOptions.filePath !== </span><span class="s0">'&lt;input&gt;'</span>
        <span class="s1">? tsestreeOptions.filePath</span>
        <span class="s1">: getFileName(tsestreeOptions.jsx), tsconfigRootDir);</span>
    <span class="s2">const </span><span class="s1">extension = node_path_1.default.extname(filePath).toLowerCase();</span>
    <span class="s2">const </span><span class="s1">jsDocParsingMode = (() =&gt; {</span>
        <span class="s2">switch </span><span class="s1">(tsestreeOptions.jsDocParsingMode) {</span>
            <span class="s2">case </span><span class="s0">'all'</span><span class="s1">:</span>
                <span class="s2">return </span><span class="s1">JSDocParsingMode.ParseAll;</span>
            <span class="s2">case </span><span class="s0">'none'</span><span class="s1">:</span>
                <span class="s2">return </span><span class="s1">JSDocParsingMode.ParseNone;</span>
            <span class="s2">case </span><span class="s0">'type-info'</span><span class="s1">:</span>
                <span class="s2">return </span><span class="s1">JSDocParsingMode.ParseForTypeInfo;</span>
            <span class="s2">default</span><span class="s1">:</span>
                <span class="s2">return </span><span class="s1">JSDocParsingMode.ParseAll;</span>
        <span class="s1">}</span>
    <span class="s1">})();</span>
    <span class="s2">const </span><span class="s1">parseSettings = {</span>
        <span class="s1">loc: tsestreeOptions.loc === </span><span class="s2">true</span><span class="s1">,</span>
        <span class="s1">range: tsestreeOptions.range === </span><span class="s2">true</span><span class="s1">,</span>
        <span class="s1">allowInvalidAST: tsestreeOptions.allowInvalidAST === </span><span class="s2">true</span><span class="s1">,</span>
        <span class="s1">code,</span>
        <span class="s1">codeFullText,</span>
        <span class="s1">comment: tsestreeOptions.comment === </span><span class="s2">true</span><span class="s1">,</span>
        <span class="s1">comments: [],</span>
        <span class="s1">debugLevel: tsestreeOptions.debugLevel === </span><span class="s2">true</span>
            <span class="s1">? </span><span class="s2">new </span><span class="s1">Set([</span><span class="s0">'typescript-eslint'</span><span class="s1">])</span>
            <span class="s1">: Array.isArray(tsestreeOptions.debugLevel)</span>
                <span class="s1">? </span><span class="s2">new </span><span class="s1">Set(tsestreeOptions.debugLevel)</span>
                <span class="s1">: </span><span class="s2">new </span><span class="s1">Set(),</span>
        <span class="s1">errorOnTypeScriptSyntacticAndSemanticIssues: </span><span class="s2">false</span><span class="s1">,</span>
        <span class="s1">errorOnUnknownASTType: tsestreeOptions.errorOnUnknownASTType === </span><span class="s2">true</span><span class="s1">,</span>
        <span class="s1">extraFileExtensions: Array.isArray(tsestreeOptions.extraFileExtensions) &amp;&amp;</span>
            <span class="s1">tsestreeOptions.extraFileExtensions.every(ext =&gt; </span><span class="s2">typeof </span><span class="s1">ext === </span><span class="s0">'string'</span><span class="s1">)</span>
            <span class="s1">? tsestreeOptions.extraFileExtensions</span>
            <span class="s1">: [],</span>
        <span class="s1">filePath,</span>
        <span class="s1">jsDocParsingMode,</span>
        <span class="s1">jsx: tsestreeOptions.jsx === </span><span class="s2">true</span><span class="s1">,</span>
        <span class="s1">log: </span><span class="s2">typeof </span><span class="s1">tsestreeOptions.loggerFn === </span><span class="s0">'function'</span>
            <span class="s1">? tsestreeOptions.loggerFn</span>
            <span class="s1">: tsestreeOptions.loggerFn === </span><span class="s2">false</span>
                <span class="s1">? () =&gt; { } </span><span class="s4">// eslint-disable-line @typescript-eslint/no-empty-function</span>
                <span class="s1">: console.log, </span><span class="s4">// eslint-disable-line no-console</span>
        <span class="s1">preserveNodeMaps: tsestreeOptions.preserveNodeMaps !== </span><span class="s2">false</span><span class="s1">,</span>
        <span class="s1">programs: Array.isArray(tsestreeOptions.programs)</span>
            <span class="s1">? tsestreeOptions.programs</span>
            <span class="s1">: </span><span class="s2">null</span><span class="s1">,</span>
        <span class="s1">projects: </span><span class="s2">new </span><span class="s1">Map(),</span>
        <span class="s1">projectService: tsestreeOptions.projectService ||</span>
            <span class="s1">(tsestreeOptions.project &amp;&amp;</span>
                <span class="s1">tsestreeOptions.projectService !== </span><span class="s2">false </span><span class="s1">&amp;&amp;</span>
                <span class="s1">process.env.TYPESCRIPT_ESLINT_PROJECT_SERVICE === </span><span class="s0">'true'</span><span class="s1">)</span>
            <span class="s1">? populateProjectService(tsestreeOptions.projectService, {</span>
                <span class="s1">jsDocParsingMode,</span>
                <span class="s1">tsconfigRootDir,</span>
            <span class="s1">})</span>
            <span class="s1">: undefined,</span>
        <span class="s1">setExternalModuleIndicator: tsestreeOptions.sourceType === </span><span class="s0">'module' </span><span class="s1">||</span>
            <span class="s1">(tsestreeOptions.sourceType == </span><span class="s2">null </span><span class="s1">&amp;&amp; extension === ts.Extension.Mjs) ||</span>
            <span class="s1">(tsestreeOptions.sourceType == </span><span class="s2">null </span><span class="s1">&amp;&amp; extension === ts.Extension.Mts)</span>
            <span class="s1">? (file) =&gt; {</span>
                <span class="s1">file.externalModuleIndicator = </span><span class="s2">true</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s1">: undefined,</span>
        <span class="s1">singleRun,</span>
        <span class="s1">suppressDeprecatedPropertyWarnings: tsestreeOptions.suppressDeprecatedPropertyWarnings ??</span>
            <span class="s1">process.env.NODE_ENV !== </span><span class="s0">'test'</span><span class="s1">,</span>
        <span class="s1">tokens: tsestreeOptions.tokens === </span><span class="s2">true </span><span class="s1">? [] : </span><span class="s2">null</span><span class="s1">,</span>
        <span class="s1">tsconfigMatchCache: (TSCONFIG_MATCH_CACHE ??= </span><span class="s2">new </span><span class="s1">ExpiringCache_1.ExpiringCache(singleRun</span>
            <span class="s1">? </span><span class="s0">'Infinity'</span>
            <span class="s1">: (tsestreeOptions.cacheLifetime?.glob ??</span>
                <span class="s1">ExpiringCache_1.DEFAULT_TSCONFIG_CACHE_DURATION_SECONDS))),</span>
        <span class="s1">tsconfigRootDir,</span>
    <span class="s1">};</span>
    <span class="s4">// debug doesn't support multiple `enable` calls, so have to do it all at once</span>
    <span class="s2">if </span><span class="s1">(parseSettings.debugLevel.size &gt; </span><span class="s3">0</span><span class="s1">) {</span>
        <span class="s2">const </span><span class="s1">namespaces = [];</span>
        <span class="s2">if </span><span class="s1">(parseSettings.debugLevel.has(</span><span class="s0">'typescript-eslint'</span><span class="s1">)) {</span>
            <span class="s1">namespaces.push(</span><span class="s0">'typescript-eslint:*'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s2">if </span><span class="s1">(parseSettings.debugLevel.has(</span><span class="s0">'eslint'</span><span class="s1">) ||</span>
            <span class="s4">// make sure we don't turn off the eslint debug if it was enabled via --debug</span>
            <span class="s1">debug_1.default.enabled(</span><span class="s0">'eslint:*,-eslint:code-path'</span><span class="s1">)) {</span>
            <span class="s4">// https://github.com/eslint/eslint/blob/9dfc8501fb1956c90dc11e6377b4cb38a6bea65d/bin/eslint.js#L25</span>
            <span class="s1">namespaces.push(</span><span class="s0">'eslint:*,-eslint:code-path'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s1">debug_1.default.enable(namespaces.join(</span><span class="s0">','</span><span class="s1">));</span>
    <span class="s1">}</span>
    <span class="s2">if </span><span class="s1">(Array.isArray(tsestreeOptions.programs)) {</span>
        <span class="s2">if </span><span class="s1">(!tsestreeOptions.programs.length) {</span>
            <span class="s2">throw new </span><span class="s1">Error(</span><span class="s0">`You have set parserOptions.programs to an empty array. This will cause all files to not be found in existing programs. Either provide one or more existing TypeScript Program instances in the array, or remove the parserOptions.programs setting.`</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s1">log(</span><span class="s0">'parserOptions.programs was provided, so parserOptions.project will be ignored.'</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">// Providing a program or project service overrides project resolution</span>
    <span class="s2">if </span><span class="s1">(!parseSettings.programs &amp;&amp; !parseSettings.projectService) {</span>
        <span class="s1">parseSettings.projects = (</span><span class="s3">0</span><span class="s1">, resolveProjectList_1.resolveProjectList)({</span>
            <span class="s1">cacheLifetime: tsestreeOptions.cacheLifetime,</span>
            <span class="s1">project: (</span><span class="s3">0</span><span class="s1">, getProjectConfigFiles_1.getProjectConfigFiles)(parseSettings, tsestreeOptions.project),</span>
            <span class="s1">projectFolderIgnoreList: tsestreeOptions.projectFolderIgnoreList,</span>
            <span class="s1">singleRun: parseSettings.singleRun,</span>
            <span class="s1">tsconfigRootDir,</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s4">// No type-aware linting which means that cross-file (or even same-file) JSDoc is useless</span>
    <span class="s4">// So in this specific case we default to 'none' if no value was provided</span>
    <span class="s2">if </span><span class="s1">(tsestreeOptions.jsDocParsingMode == </span><span class="s2">null </span><span class="s1">&amp;&amp;</span>
        <span class="s1">parseSettings.projects.size === </span><span class="s3">0 </span><span class="s1">&amp;&amp;</span>
        <span class="s1">parseSettings.programs == </span><span class="s2">null </span><span class="s1">&amp;&amp;</span>
        <span class="s1">parseSettings.projectService == </span><span class="s2">null</span><span class="s1">) {</span>
        <span class="s1">parseSettings.jsDocParsingMode = JSDocParsingMode.ParseNone;</span>
    <span class="s1">}</span>
    <span class="s1">(</span><span class="s3">0</span><span class="s1">, warnAboutTSVersion_1.warnAboutTSVersion)(parseSettings, passedLoggerFn);</span>
    <span class="s2">return </span><span class="s1">parseSettings;</span>
<span class="s1">}</span>
<span class="s2">function </span><span class="s1">clearTSConfigMatchCache() {</span>
    <span class="s1">TSCONFIG_MATCH_CACHE?.clear();</span>
<span class="s1">}</span>
<span class="s2">function </span><span class="s1">clearTSServerProjectService() {</span>
    <span class="s1">TSSERVER_PROJECT_SERVICE = </span><span class="s2">null</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">/**</span>
 <span class="s4">* Ensures source code is a string.</span>
 <span class="s4">*/</span>
<span class="s2">function </span><span class="s1">enforceCodeString(code) {</span>
    <span class="s2">return </span><span class="s1">(</span><span class="s3">0</span><span class="s1">, source_files_1.isSourceFile)(code)</span>
        <span class="s1">? code.getFullText(code)</span>
        <span class="s1">: </span><span class="s2">typeof </span><span class="s1">code === </span><span class="s0">'string'</span>
            <span class="s1">? code</span>
            <span class="s1">: String(code);</span>
<span class="s1">}</span>
<span class="s4">/**</span>
 <span class="s4">* Compute the filename based on the parser options.</span>
 <span class="s4">*</span>
 <span class="s4">* Even if jsx option is set in typescript compiler, filename still has to</span>
 <span class="s4">* contain .tsx file extension.</span>
 <span class="s4">*/</span>
<span class="s2">function </span><span class="s1">getFileName(jsx) {</span>
    <span class="s2">return </span><span class="s1">jsx ? </span><span class="s0">'estree.tsx' </span><span class="s1">: </span><span class="s0">'estree.ts'</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s2">function </span><span class="s1">populateProjectService(optionsRaw, settings) {</span>
    <span class="s2">const </span><span class="s1">options = </span><span class="s2">typeof </span><span class="s1">optionsRaw === </span><span class="s0">'object' </span><span class="s1">? optionsRaw : {};</span>
    <span class="s1">(</span><span class="s3">0</span><span class="s1">, validateDefaultProjectForFilesGlob_1.validateDefaultProjectForFilesGlob)(options.allowDefaultProject);</span>
    <span class="s1">TSSERVER_PROJECT_SERVICE ??= (</span><span class="s3">0</span><span class="s1">, project_service_1.createProjectService)({</span>
        <span class="s1">options,</span>
        <span class="s1">...settings,</span>
    <span class="s1">});</span>
    <span class="s2">return </span><span class="s1">TSSERVER_PROJECT_SERVICE;</span>
<span class="s1">}</span>
</pre>
</body>
</html>