<html>
<head>
<title>types.ts</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #1750eb;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
types.ts</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">type { SourceMapSegment } from </span><span class="s2">'./sourcemap-segment'</span><span class="s1">;</span>
<span class="s0">import </span><span class="s1">type { GREATEST_LOWER_BOUND, LEAST_UPPER_BOUND, TraceMap } from </span><span class="s2">'./trace-mapping'</span><span class="s1">;</span>

<span class="s0">export interface </span><span class="s1">SourceMapV3 {</span>
  <span class="s1">file?: string | </span><span class="s0">null</span><span class="s1">;</span>
  <span class="s1">names: string[];</span>
  <span class="s1">sourceRoot?: string;</span>
  <span class="s1">sources: (string | </span><span class="s0">null</span><span class="s1">)[];</span>
  <span class="s1">sourcesContent?: (string | </span><span class="s0">null</span><span class="s1">)[];</span>
  <span class="s1">version: </span><span class="s3">3</span><span class="s1">;</span>
  <span class="s1">ignoreList?: number[];</span>
<span class="s1">}</span>

<span class="s0">export interface </span><span class="s1">EncodedSourceMap </span><span class="s0">extends </span><span class="s1">SourceMapV3 {</span>
  <span class="s1">mappings: string;</span>
<span class="s1">}</span>

<span class="s0">export interface </span><span class="s1">DecodedSourceMap </span><span class="s0">extends </span><span class="s1">SourceMapV3 {</span>
  <span class="s1">mappings: SourceMapSegment[][];</span>
<span class="s1">}</span>

<span class="s0">export interface </span><span class="s1">Section {</span>
  <span class="s1">offset: { line: number; column: number };</span>
  <span class="s1">map: EncodedSourceMap | DecodedSourceMap | SectionedSourceMap;</span>
<span class="s1">}</span>

<span class="s0">export interface </span><span class="s1">SectionedSourceMap {</span>
  <span class="s1">file?: string | </span><span class="s0">null</span><span class="s1">;</span>
  <span class="s1">sections: Section[];</span>
  <span class="s1">version: </span><span class="s3">3</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s0">export </span><span class="s1">type OriginalMapping = {</span>
  <span class="s1">source: string | </span><span class="s0">null</span><span class="s1">;</span>
  <span class="s1">line: number;</span>
  <span class="s1">column: number;</span>
  <span class="s1">name: string | </span><span class="s0">null</span><span class="s1">;</span>
<span class="s1">};</span>

<span class="s0">export </span><span class="s1">type InvalidOriginalMapping = {</span>
  <span class="s1">source: </span><span class="s0">null</span><span class="s1">;</span>
  <span class="s1">line: </span><span class="s0">null</span><span class="s1">;</span>
  <span class="s1">column: </span><span class="s0">null</span><span class="s1">;</span>
  <span class="s1">name: </span><span class="s0">null</span><span class="s1">;</span>
<span class="s1">};</span>

<span class="s0">export </span><span class="s1">type GeneratedMapping = {</span>
  <span class="s1">line: number;</span>
  <span class="s1">column: number;</span>
<span class="s1">};</span>
<span class="s0">export </span><span class="s1">type InvalidGeneratedMapping = {</span>
  <span class="s1">line: </span><span class="s0">null</span><span class="s1">;</span>
  <span class="s1">column: </span><span class="s0">null</span><span class="s1">;</span>
<span class="s1">};</span>

<span class="s0">export </span><span class="s1">type Bias = </span><span class="s0">typeof </span><span class="s1">GREATEST_LOWER_BOUND | </span><span class="s0">typeof </span><span class="s1">LEAST_UPPER_BOUND;</span>

<span class="s0">export </span><span class="s1">type XInput = { x_google_ignoreList?: SourceMapV3[</span><span class="s2">'ignoreList'</span><span class="s1">] };</span>
<span class="s0">export </span><span class="s1">type EncodedSourceMapXInput = EncodedSourceMap &amp; XInput;</span>
<span class="s0">export </span><span class="s1">type DecodedSourceMapXInput = DecodedSourceMap &amp; XInput;</span>
<span class="s0">export </span><span class="s1">type SectionedSourceMapXInput = Omit&lt;SectionedSourceMap, </span><span class="s2">'sections'</span><span class="s1">&gt; &amp; {</span>
  <span class="s1">sections: SectionXInput[];</span>
<span class="s1">};</span>
<span class="s0">export </span><span class="s1">type SectionXInput = Omit&lt;Section, </span><span class="s2">'map'</span><span class="s1">&gt; &amp; {</span>
  <span class="s1">map: SectionedSourceMapInput;</span>
<span class="s1">};</span>

<span class="s0">export </span><span class="s1">type SourceMapInput = string | EncodedSourceMapXInput | DecodedSourceMapXInput | TraceMap;</span>
<span class="s0">export </span><span class="s1">type SectionedSourceMapInput = SourceMapInput | SectionedSourceMapXInput;</span>

<span class="s0">export </span><span class="s1">type Needle = { line: number; column: number; bias?: Bias };</span>
<span class="s0">export </span><span class="s1">type SourceNeedle = { source: string; line: number; column: number; bias?: Bias };</span>

<span class="s0">export </span><span class="s1">type EachMapping =</span>
  <span class="s1">| {</span>
      <span class="s1">generatedLine: number;</span>
      <span class="s1">generatedColumn: number;</span>
      <span class="s1">source: </span><span class="s0">null</span><span class="s1">;</span>
      <span class="s1">originalLine: </span><span class="s0">null</span><span class="s1">;</span>
      <span class="s1">originalColumn: </span><span class="s0">null</span><span class="s1">;</span>
      <span class="s1">name: </span><span class="s0">null</span><span class="s1">;</span>
    <span class="s1">}</span>
  <span class="s1">| {</span>
      <span class="s1">generatedLine: number;</span>
      <span class="s1">generatedColumn: number;</span>
      <span class="s1">source: string | </span><span class="s0">null</span><span class="s1">;</span>
      <span class="s1">originalLine: number;</span>
      <span class="s1">originalColumn: number;</span>
      <span class="s1">name: string | </span><span class="s0">null</span><span class="s1">;</span>
    <span class="s1">};</span>

<span class="s0">export </span><span class="s1">abstract </span><span class="s0">class </span><span class="s1">SourceMap {</span>
  <span class="s1">declare version: SourceMapV3[</span><span class="s2">'version'</span><span class="s1">];</span>
  <span class="s1">declare file: SourceMapV3[</span><span class="s2">'file'</span><span class="s1">];</span>
  <span class="s1">declare names: SourceMapV3[</span><span class="s2">'names'</span><span class="s1">];</span>
  <span class="s1">declare sourceRoot: SourceMapV3[</span><span class="s2">'sourceRoot'</span><span class="s1">];</span>
  <span class="s1">declare sources: SourceMapV3[</span><span class="s2">'sources'</span><span class="s1">];</span>
  <span class="s1">declare sourcesContent: SourceMapV3[</span><span class="s2">'sourcesContent'</span><span class="s1">];</span>
  <span class="s1">declare resolvedSources: SourceMapV3[</span><span class="s2">'sources'</span><span class="s1">];</span>
  <span class="s1">declare ignoreList: SourceMapV3[</span><span class="s2">'ignoreList'</span><span class="s1">];</span>
<span class="s1">}</span>

<span class="s0">export </span><span class="s1">type Ro&lt;T&gt; =</span>
  <span class="s1">T </span><span class="s0">extends </span><span class="s1">Array&lt;infer V&gt;</span>
    <span class="s1">? V[] | Readonly&lt;V[]&gt; | RoArray&lt;V&gt; | Readonly&lt;RoArray&lt;V&gt;&gt;</span>
    <span class="s1">: T </span><span class="s0">extends </span><span class="s1">object</span>
      <span class="s1">? T | Readonly&lt;T&gt; | RoObject&lt;T&gt; | Readonly&lt;RoObject&lt;T&gt;&gt;</span>
      <span class="s1">: T;</span>
<span class="s1">type RoArray&lt;T&gt; = Ro&lt;T&gt;[];</span>
<span class="s1">type RoObject&lt;T&gt; = { [K </span><span class="s0">in </span><span class="s1">keyof T]: T[K] | Ro&lt;T[K]&gt; };</span>

<span class="s0">export function </span><span class="s1">parse&lt;T&gt;(map: T): Exclude&lt;T, string&gt; {</span>
  <span class="s0">return typeof </span><span class="s1">map === </span><span class="s2">'string' </span><span class="s1">? JSON.parse(map) : (map as Exclude&lt;T, string&gt;);</span>
<span class="s1">}</span>
</pre>
</body>
</html>