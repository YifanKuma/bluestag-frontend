<html>
<head>
<title>next-fixture.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
next-fixture.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/experimental/testmode/playwright/next-fixture.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { Page, TestInfo } from '@playwright/test'</span><span class="s3">\n</span><span class="s1">import type { NextWorkerFixture, FetchHandler } from './next-worker-fixture'</span><span class="s3">\n</span><span class="s1">import type { NextOptions } from './next-options'</span><span class="s3">\n</span><span class="s1">import type { FetchHandlerResult } from '../proxy'</span><span class="s3">\n</span><span class="s1">import { handleRoute } from './page-route'</span><span class="s3">\n</span><span class="s1">import { reportFetch } from './report'</span><span class="s3">\n\n</span><span class="s1">export interface NextFixture {</span><span class="s3">\n  </span><span class="s1">onFetch: (handler: FetchHandler) =&gt; void</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">class NextFixtureImpl implements NextFixture {</span><span class="s3">\n  </span><span class="s1">public readonly testId: string</span><span class="s3">\n  </span><span class="s1">private fetchHandlers: FetchHandler[] = []</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">private testInfo: TestInfo,</span><span class="s3">\n    </span><span class="s1">private options: NextOptions,</span><span class="s3">\n    </span><span class="s1">private worker: NextWorkerFixture,</span><span class="s3">\n    </span><span class="s1">private page: Page</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">this.testId = testInfo.testId</span><span class="s3">\n    </span><span class="s1">worker.onFetch(this.testId, this.handleFetch.bind(this))</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">async setup(): Promise&lt;void&gt; {</span><span class="s3">\n    </span><span class="s1">const testHeaders = {</span><span class="s3">\n      </span><span class="s1">'Next-Test-Proxy-Port': String(this.worker.proxyPort),</span><span class="s3">\n      </span><span class="s1">'Next-Test-Data': this.testId,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">await this.page</span><span class="s3">\n      </span><span class="s1">.context()</span><span class="s3">\n      </span><span class="s1">.route('**', (route) =&gt;</span><span class="s3">\n        </span><span class="s1">handleRoute(route, this.page, testHeaders, this.handleFetch.bind(this))</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">teardown(): void {</span><span class="s3">\n    </span><span class="s1">this.worker.cleanupTest(this.testId)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">onFetch(handler: FetchHandler): void {</span><span class="s3">\n    </span><span class="s1">this.fetchHandlers.push(handler)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private async handleFetch(request: Request): Promise&lt;FetchHandlerResult&gt; {</span><span class="s3">\n    </span><span class="s1">return reportFetch(this.testInfo, request, async (req) =&gt; {</span><span class="s3">\n      </span><span class="s1">for (const handler of this.fetchHandlers.slice().reverse()) {</span><span class="s3">\n        </span><span class="s1">const result = await handler(req.clone())</span><span class="s3">\n        </span><span class="s1">if (result) {</span><span class="s3">\n          </span><span class="s1">return result</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">if (this.options.fetchLoopback) {</span><span class="s3">\n        </span><span class="s1">return fetch(req.clone())</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return undefined</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function applyNextFixture(</span><span class="s3">\n  </span><span class="s1">use: (fixture: NextFixture) =&gt; Promise&lt;void&gt;,</span><span class="s3">\n  </span><span class="s1">{</span><span class="s3">\n    </span><span class="s1">testInfo,</span><span class="s3">\n    </span><span class="s1">nextOptions,</span><span class="s3">\n    </span><span class="s1">nextWorker,</span><span class="s3">\n    </span><span class="s1">page,</span><span class="s3">\n  </span><span class="s1">}: {</span><span class="s3">\n    </span><span class="s1">testInfo: TestInfo</span><span class="s3">\n    </span><span class="s1">nextOptions: NextOptions</span><span class="s3">\n    </span><span class="s1">nextWorker: NextWorkerFixture</span><span class="s3">\n    </span><span class="s1">page: Page</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">): Promise&lt;void&gt; {</span><span class="s3">\n  </span><span class="s1">const fixture = new NextFixtureImpl(testInfo, nextOptions, nextWorker, page)</span><span class="s3">\n\n  </span><span class="s1">await fixture.setup()</span><span class="s3">\n  </span><span class="s1">// eslint-disable-next-line react-hooks/rules-of-hooks -- not React.use()</span><span class="s3">\n  </span><span class="s1">await use(fixture)</span><span class="s3">\n\n  </span><span class="s1">fixture.teardown()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;applyNextFixture&quot;</span><span class="s0">,</span><span class="s1">&quot;NextFixtureImpl&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;testInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;worker&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchHandlers&quot;</span><span class="s0">,</span><span class="s1">&quot;testId&quot;</span><span class="s0">,</span><span class="s1">&quot;onFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;handleFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;bind&quot;</span><span class="s0">,</span><span class="s1">&quot;setup&quot;</span><span class="s0">,</span><span class="s1">&quot;testHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;proxyPort&quot;</span><span class="s0">,</span><span class="s1">&quot;context&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;handleRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;teardown&quot;</span><span class="s0">,</span><span class="s1">&quot;cleanupTest&quot;</span><span class="s0">,</span><span class="s1">&quot;handler&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;reportFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;reverse&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;clone&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchLoopback&quot;</span><span class="s0">,</span><span class="s1">&quot;fetch&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;use&quot;</span><span class="s0">,</span><span class="s1">&quot;nextOptions&quot;</span><span class="s0">,</span><span class="s1">&quot;nextWorker&quot;</span><span class="s0">,</span><span class="s1">&quot;fixture&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BA8DsBA;;;eAAAA;;;2BA1DM;wBACA;AAM5B,MAAMC;IAIJC,YACE,AAAQC,QAAkB,EAC1B,AAAQC,OAAoB,EAC5B,AAAQC,MAAyB,EACjC,AAAQC,IAAU,CAClB;aAJQH,WAAAA;aACAC,UAAAA;aACAC,SAAAA;aACAC,OAAAA;aANFC,gBAAgC,EAAE;QAQxC,IAAI,CAACC,MAAM,GAAGL,SAASK,MAAM;QAC7BH,OAAOI,OAAO,CAAC,IAAI,CAACD,MAAM,EAAE,IAAI,CAACE,WAAW,CAACC,IAAI,CAAC,IAAI;IACxD;IAEA,MAAMC,QAAuB;QAC3B,MAAMC,cAAc;YAClB,wBAAwBC,OAAO,IAAI,CAACT,MAAM,CAACU,SAAS;YACpD,kBAAkB,IAAI,CAACP,MAAM;QAC/B;QAEA,MAAM,IAAI,CAACF,IAAI,CACZU,OAAO,GACPC,KAAK,CAAC,MAAM,CAACA,QACZC,IAAAA,sBAAW,EAACD,OAAO,IAAI,CAACX,IAAI,EAAEO,aAAa,IAAI,CAACH,WAAW,CAACC,IAAI,CAAC,IAAI;IAE3E;IAEAQ,WAAiB;QACf,IAAI,CAACd,MAAM,CAACe,WAAW,CAAC,IAAI,CAACZ,MAAM;IACrC;IAEAC,QAAQY,OAAqB,EAAQ;QACnC,IAAI,CAACd,aAAa,CAACe,IAAI,CAACD;IAC1B;IAEA,MAAcX,YAAYa,OAAgB,EAA+B;QACvE,OAAOC,IAAAA,mBAAW,EAAC,IAAI,CAACrB,QAAQ,EAAEoB,SAAS,OAAOE;YAChD,KAAK,MAAMJ,WAAW,IAAI,CAACd,aAAa,CAACmB,KAAK,GAAGC,OAAO,GAAI;gBAC1D,MAAMC,SAAS,MAAMP,QAAQI,IAAII,KAAK;gBACtC,IAAID,QAAQ;oBACV,OAAOA;gBACT;YACF;YACA,IAAI,IAAI,CAACxB,OAAO,CAAC0B,aAAa,EAAE;gBAC9B,OAAOC,MAAMN,IAAII,KAAK;YACxB;YACA,OAAOG;QACT;IACF;AACF;AAEO,eAAehC,iBACpBiC,GAA4C,EAC5C,EACE9B,QAAQ,EACR+B,WAAW,EACXC,UAAU,EACV7B,IAAI,EAML;IAED,MAAM8B,UAAU,IAAInC,gBAAgBE,UAAU+B,aAAaC,YAAY7B;IAEvE,MAAM8B,QAAQxB,KAAK;IACnB,yEAAyE;IACzE,MAAMqB,IAAIG;IAEVA,QAAQjB,QAAQ;AAClB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>