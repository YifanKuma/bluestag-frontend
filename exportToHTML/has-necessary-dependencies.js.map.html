<html>
<head>
<title>has-necessary-dependencies.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
has-necessary-dependencies.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../src/lib/has-necessary-dependencies.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { existsSync, promises as fs } from 'fs'</span><span class="s3">\n</span><span class="s1">import { resolveFrom } from './resolve-from'</span><span class="s3">\n</span><span class="s1">import { dirname, join, relative } from 'path'</span><span class="s3">\n\n</span><span class="s1">export interface MissingDependency {</span><span class="s3">\n  </span><span class="s1">file: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The package's package.json (e.g. require(`${pkg}/package.json`)) MUST resolve.</span><span class="s3">\n   </span><span class="s1">* If `exportsRestrict` is false, `${file}` MUST also resolve.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pkg: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If true, the pkg's package.json needs to be resolvable.</span><span class="s3">\n   </span><span class="s1">* If true, will resolve `file` relative to the real path of the package.json.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* For example, `{ file: '@types/react/index.d.ts', pkg: '@types/react', exportsRestrict: true }`</span><span class="s3">\n   </span><span class="s1">* will try to resolve '@types/react/package.json' first and then assume `@types/react/index.d.ts`</span><span class="s3">\n   </span><span class="s1">* resolves to `path.join(dirname(resolvedPackageJsonPath), 'index.d.ts')`.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* If false, will resolve `file` relative to the baseDir.</span><span class="s3">\n   </span><span class="s1">* ForFor example, `{ file: '@types/react/index.d.ts', pkg: '@types/react', exportsRestrict: true }`</span><span class="s3">\n   </span><span class="s1">* will try to resolve `@types/react/index.d.ts` directly.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">exportsRestrict: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type NecessaryDependencies = {</span><span class="s3">\n  </span><span class="s1">resolved: Map&lt;string, string&gt;</span><span class="s3">\n  </span><span class="s1">missing: MissingDependency[]</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function hasNecessaryDependencies(</span><span class="s3">\n  </span><span class="s1">baseDir: string,</span><span class="s3">\n  </span><span class="s1">requiredPackages: MissingDependency[]</span><span class="s3">\n</span><span class="s1">): Promise&lt;NecessaryDependencies&gt; {</span><span class="s3">\n  </span><span class="s1">let resolutions = new Map&lt;string, string&gt;()</span><span class="s3">\n  </span><span class="s1">const missingPackages: MissingDependency[] = []</span><span class="s3">\n\n  </span><span class="s1">await Promise.all(</span><span class="s3">\n    </span><span class="s1">requiredPackages.map(async (p) =&gt; {</span><span class="s3">\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">const pkgPath = await fs.realpath(</span><span class="s3">\n          </span><span class="s1">resolveFrom(baseDir, `${p.pkg}/package.json`)</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">const pkgDir = dirname(pkgPath)</span><span class="s3">\n\n        </span><span class="s1">if (p.exportsRestrict) {</span><span class="s3">\n          </span><span class="s1">const fileNameToVerify = relative(p.pkg, p.file)</span><span class="s3">\n          </span><span class="s1">if (fileNameToVerify) {</span><span class="s3">\n            </span><span class="s1">const fileToVerify = join(pkgDir, fileNameToVerify)</span><span class="s3">\n            </span><span class="s1">if (existsSync(fileToVerify)) {</span><span class="s3">\n              </span><span class="s1">resolutions.set(p.pkg, fileToVerify)</span><span class="s3">\n            </span><span class="s1">} else {</span><span class="s3">\n              </span><span class="s1">return missingPackages.push(p)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">resolutions.set(p.pkg, pkgPath)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">resolutions.set(p.pkg, resolveFrom(baseDir, p.file))</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} catch (_) {</span><span class="s3">\n        </span><span class="s1">return missingPackages.push(p)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">resolved: resolutions,</span><span class="s3">\n    </span><span class="s1">missing: missingPackages,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;hasNecessaryDependencies&quot;</span><span class="s0">,</span><span class="s1">&quot;baseDir&quot;</span><span class="s0">,</span><span class="s1">&quot;requiredPackages&quot;</span><span class="s0">,</span><span class="s1">&quot;resolutions&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;missingPackages&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;all&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;p&quot;</span><span class="s0">,</span><span class="s1">&quot;pkgPath&quot;</span><span class="s0">,</span><span class="s1">&quot;fs&quot;</span><span class="s0">,</span><span class="s1">&quot;realpath&quot;</span><span class="s0">,</span><span class="s1">&quot;resolveFrom&quot;</span><span class="s0">,</span><span class="s1">&quot;pkg&quot;</span><span class="s0">,</span><span class="s1">&quot;pkgDir&quot;</span><span class="s0">,</span><span class="s1">&quot;dirname&quot;</span><span class="s0">,</span><span class="s1">&quot;exportsRestrict&quot;</span><span class="s0">,</span><span class="s1">&quot;fileNameToVerify&quot;</span><span class="s0">,</span><span class="s1">&quot;relative&quot;</span><span class="s0">,</span><span class="s1">&quot;file&quot;</span><span class="s0">,</span><span class="s1">&quot;fileToVerify&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;existsSync&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;_&quot;</span><span class="s0">,</span><span class="s1">&quot;resolved&quot;</span><span class="s0">,</span><span class="s1">&quot;missing&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BA+BsBA;;;eAAAA;;;oBA/BqB;6BACf;sBACY;AA6BjC,eAAeA,yBACpBC,OAAe,EACfC,gBAAqC;IAErC,IAAIC,cAAc,IAAIC;IACtB,MAAMC,kBAAuC,EAAE;IAE/C,MAAMC,QAAQC,GAAG,CACfL,iBAAiBM,GAAG,CAAC,OAAOC;QAC1B,IAAI;YACF,MAAMC,UAAU,MAAMC,YAAE,CAACC,QAAQ,CAC/BC,IAAAA,wBAAW,EAACZ,SAAS,GAAGQ,EAAEK,GAAG,CAAC,aAAa,CAAC;YAE9C,MAAMC,SAASC,IAAAA,aAAO,EAACN;YAEvB,IAAID,EAAEQ,eAAe,EAAE;gBACrB,MAAMC,mBAAmBC,IAAAA,cAAQ,EAACV,EAAEK,GAAG,EAAEL,EAAEW,IAAI;gBAC/C,IAAIF,kBAAkB;oBACpB,MAAMG,eAAeC,IAAAA,UAAI,EAACP,QAAQG;oBAClC,IAAIK,IAAAA,cAAU,EAACF,eAAe;wBAC5BlB,YAAYqB,GAAG,CAACf,EAAEK,GAAG,EAAEO;oBACzB,OAAO;wBACL,OAAOhB,gBAAgBoB,IAAI,CAAChB;oBAC9B;gBACF,OAAO;oBACLN,YAAYqB,GAAG,CAACf,EAAEK,GAAG,EAAEJ;gBACzB;YACF,OAAO;gBACLP,YAAYqB,GAAG,CAACf,EAAEK,GAAG,EAAED,IAAAA,wBAAW,EAACZ,SAASQ,EAAEW,IAAI;YACpD;QACF,EAAE,OAAOM,GAAG;YACV,OAAOrB,gBAAgBoB,IAAI,CAAChB;QAC9B;IACF;IAGF,OAAO;QACLkB,UAAUxB;QACVyB,SAASvB;IACX;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>