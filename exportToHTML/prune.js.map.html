<html>
<head>
<title>prune.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
prune.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;file&quot;</span><span class="s0">:</span><span class="s1">&quot;prune.js&quot;</span><span class="s0">,</span><span class="s1">&quot;sourceRoot&quot;</span><span class="s0">:</span><span class="s1">&quot;&quot;</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../src/eslint-bulk-suppressions/cli/prune.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;AAAA,4FAA4F;AAC5F,2DAA2D;;;;;AAY3D,gCAsBC;AAhCD,4CAAoB;AAEpB,mDAAoD;AACpD,2CAA6C;AAC7C,4CAA8D;AAC9D,sEAGmC;AAE5B,KAAK,UAAU,UAAU;IAC9B,MAAM,IAAI,GAAa,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAE7C,IAAI,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC;QACnD,IAAA,2BAAc,GAAE,CAAC;QACjB,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IAClB,CAAC;IAED,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;QACpB,MAAM,IAAI,KAAK,CAAC,8CAA8C,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;IAClF,CAAC;IAED,MAAM,aAAa,GAAW,OAAO,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;IAChE,MAAM,QAAQ,GAAa,MAAM,8CAA8C,CAAC,aAAa,CAAC,CAAC;IAC/F,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;QACxB,OAAO,CAAC,GAAG,CAAC,0CAA8B,CAAC,GAAG,GAAG,CAAC;QAClD,OAAO,CAAC,GAAG,CAAC,4BAA4B,QAAQ,CAAC,MAAM,WAAW,CAAC,CAAC;QACpE,MAAM,IAAA,0BAAc,EAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;IAC1C,CAAC;SAAM,CAAC;QACN,OAAO,CAAC,GAAG,CAAC,4CAA4C,CAAC,CAAC;QAC1D,IAAA,uEAA8C,EAAC,aAAa,CAAC,CAAC;IAChE,CAAC;AACH,CAAC;AAED,KAAK,UAAU,8CAA8C,CAAC,aAAqB;IACjF,MAAM,EAAE,UAAU,EAAE,0BAA0B,EAAE,GAC9C,IAAA,uEAA8C,EAAC,aAAa,CAAC,CAAC;IAChE,MAAM,QAAQ,GAAgB,IAAI,GAAG,EAAE,CAAC;IACxC,KAAK,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,0BAA0B,CAAC,YAAY,EAAE,CAAC;QACzE,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IACzB,CAAC;IAED,MAAM,aAAa,GAAa,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAErD,MAAM,gBAAgB,GAAa,EAAE,CAAC;IACtC,wGAAwG;IACxG,MAAM,OAAO,CAAC,GAAG,CACf,aAAa,CAAC,GAAG,CAAC,KAAK,EAAE,QAAgB,EAAE,EAAE;QAC3C,IAAI,CAAC;YACH,MAAM,YAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,EAAE,YAAE,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YACtD,gBAAgB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAClC,CAAC;QAAC,WAAM,CAAC;YACP,yBAAyB;QAC3B,CAAC;IACH,CAAC,CAAC,CACH,CAAC;IAEF,OAAO,CAAC,GAAG,CAAC,SAAS,gBAAgB,CAAC,MAAM,oCAAoC,CAAC,CAAC;IAClF,MAAM,YAAY,GAAW,aAAa,CAAC,MAAM,GAAG,gBAAgB,CAAC,MAAM,CAAC;IAC5E,IAAI,YAAY,GAAG,CAAC,EAAE,CAAC;QACrB,OAAO,CAAC,GAAG,CAAC,GAAG,YAAY,wCAAwC,CAAC,CAAC;IACvE,CAAC;IAED,OAAO,gBAAgB,CAAC;AAC1B,CAAC&quot;</span><span class="s0">,</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.</span><span class="s3">\n</span><span class="s1">// See LICENSE in the project root for license information.</span><span class="s3">\n\n</span><span class="s1">import fs from 'fs';</span><span class="s3">\n\n</span><span class="s1">import { printPruneHelp } from './utils/print-help';</span><span class="s3">\n</span><span class="s1">import { runEslintAsync } from './runEslint';</span><span class="s3">\n</span><span class="s1">import { ESLINT_BULK_PRUNE_ENV_VAR_NAME } from '../constants';</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">deleteBulkSuppressionsFileInEslintConfigFolder,</span><span class="s3">\n  </span><span class="s1">getSuppressionsConfigForEslintConfigFolderPath</span><span class="s3">\n</span><span class="s1">} from '../bulk-suppressions-file';</span><span class="s3">\n\n</span><span class="s1">export async function pruneAsync(): Promise&lt;void&gt; {</span><span class="s3">\n  </span><span class="s1">const args: string[] = process.argv.slice(3);</span><span class="s3">\n\n  </span><span class="s1">if (args.includes('--help') || args.includes('-h')) {</span><span class="s3">\n    </span><span class="s1">printPruneHelp();</span><span class="s3">\n    </span><span class="s1">process.exit(0);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (args.length &gt; 0) {</span><span class="s3">\n    </span><span class="s1">throw new Error(`@rushstack/eslint-bulk: Unknown arguments: ${args.join(' ')}`);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const normalizedCwd: string = process.cwd().replace(/</span><span class="s3">\\\\</span><span class="s1">/g, '/');</span><span class="s3">\n  </span><span class="s1">const allFiles: string[] = await getAllFilesWithExistingSuppressionsForCwdAsync(normalizedCwd);</span><span class="s3">\n  </span><span class="s1">if (allFiles.length &gt; 0) {</span><span class="s3">\n    </span><span class="s1">process.env[ESLINT_BULK_PRUNE_ENV_VAR_NAME] = '1';</span><span class="s3">\n    </span><span class="s1">console.log(`Pruning suppressions for ${allFiles.length} files...`);</span><span class="s3">\n    </span><span class="s1">await runEslintAsync(allFiles, 'prune');</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">console.log('No files with existing suppressions found.');</span><span class="s3">\n    </span><span class="s1">deleteBulkSuppressionsFileInEslintConfigFolder(normalizedCwd);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">async function getAllFilesWithExistingSuppressionsForCwdAsync(normalizedCwd: string): Promise&lt;string[]&gt; {</span><span class="s3">\n  </span><span class="s1">const { jsonObject: bulkSuppressionsConfigJson } =</span><span class="s3">\n    </span><span class="s1">getSuppressionsConfigForEslintConfigFolderPath(normalizedCwd);</span><span class="s3">\n  </span><span class="s1">const allFiles: Set&lt;string&gt; = new Set();</span><span class="s3">\n  </span><span class="s1">for (const { file: filePath } of bulkSuppressionsConfigJson.suppressions) {</span><span class="s3">\n    </span><span class="s1">allFiles.add(filePath);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const allFilesArray: string[] = Array.from(allFiles);</span><span class="s3">\n\n  </span><span class="s1">const allExistingFiles: string[] = [];</span><span class="s3">\n  </span><span class="s1">// TODO: limit parallelism here with something similar to `Async.forEachAsync` from `node-core-library`.</span><span class="s3">\n  </span><span class="s1">await Promise.all(</span><span class="s3">\n    </span><span class="s1">allFilesArray.map(async (filePath: string) =&gt; {</span><span class="s3">\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">await fs.promises.access(filePath, fs.constants.F_OK);</span><span class="s3">\n        </span><span class="s1">allExistingFiles.push(filePath);</span><span class="s3">\n      </span><span class="s1">} catch {</span><span class="s3">\n        </span><span class="s1">// Doesn't exist - ignore</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n\n  </span><span class="s1">console.log(`Found ${allExistingFiles.length} files with existing suppressions.`);</span><span class="s3">\n  </span><span class="s1">const deletedCount: number = allFilesArray.length - allExistingFiles.length;</span><span class="s3">\n  </span><span class="s1">if (deletedCount &gt; 0) {</span><span class="s3">\n    </span><span class="s1">console.log(`${deletedCount} files with suppressions were deleted.`);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return allExistingFiles;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">]}</span></pre>
</body>
</html>