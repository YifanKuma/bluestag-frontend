<html>
<head>
<title>get-script-nonce-from-header.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
get-script-nonce-from-header.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../src/server/app-render/get-script-nonce-from-header.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { ESCAPE_REGEX } from '../htmlescape'</span><span class="s3">\n\n</span><span class="s1">export function getScriptNonceFromHeader(</span><span class="s3">\n  </span><span class="s1">cspHeaderValue: string</span><span class="s3">\n</span><span class="s1">): string | undefined {</span><span class="s3">\n  </span><span class="s1">const directives = cspHeaderValue</span><span class="s3">\n    </span><span class="s1">// Directives are split by ';'.</span><span class="s3">\n    </span><span class="s1">.split(';')</span><span class="s3">\n    </span><span class="s1">.map((directive) =&gt; directive.trim())</span><span class="s3">\n\n  </span><span class="s1">// First try to find the directive for the 'script-src', otherwise try to</span><span class="s3">\n  </span><span class="s1">// fallback to the 'default-src'.</span><span class="s3">\n  </span><span class="s1">const directive =</span><span class="s3">\n    </span><span class="s1">directives.find((dir) =&gt; dir.startsWith('script-src')) ||</span><span class="s3">\n    </span><span class="s1">directives.find((dir) =&gt; dir.startsWith('default-src'))</span><span class="s3">\n\n  </span><span class="s1">// If no directive could be found, then we're done.</span><span class="s3">\n  </span><span class="s1">if (!directive) {</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Extract the nonce from the directive</span><span class="s3">\n  </span><span class="s1">const nonce = directive</span><span class="s3">\n    </span><span class="s1">.split(' ')</span><span class="s3">\n    </span><span class="s1">// Remove the 'strict-src'/'default-src' string, this can't be the nonce.</span><span class="s3">\n    </span><span class="s1">.slice(1)</span><span class="s3">\n    </span><span class="s1">.map((source) =&gt; source.trim())</span><span class="s3">\n    </span><span class="s1">// Find the first source with the 'nonce-' prefix.</span><span class="s3">\n    </span><span class="s1">.find(</span><span class="s3">\n      </span><span class="s1">(source) =&gt;</span><span class="s3">\n        </span><span class="s1">source.startsWith(</span><span class="s3">\&quot;</span><span class="s1">'nonce-</span><span class="s3">\&quot;</span><span class="s1">) &amp;&amp;</span><span class="s3">\n        </span><span class="s1">source.length &gt; 8 &amp;&amp;</span><span class="s3">\n        </span><span class="s1">source.endsWith(</span><span class="s3">\&quot;</span><span class="s1">'</span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">// Grab the nonce by trimming the 'nonce-' prefix.</span><span class="s3">\n    </span><span class="s1">?.slice(7, -1)</span><span class="s3">\n\n  </span><span class="s1">// If we could't find the nonce, then we're done.</span><span class="s3">\n  </span><span class="s1">if (!nonce) {</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Don't accept the nonce value if it contains HTML escape characters.</span><span class="s3">\n  </span><span class="s1">// Technically, the spec requires a base64'd value, but this is just an</span><span class="s3">\n  </span><span class="s1">// extra layer.</span><span class="s3">\n  </span><span class="s1">if (ESCAPE_REGEX.test(nonce)) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">'Nonce value from Content-Security-Policy contained HTML escape characters.</span><span class="s3">\\</span><span class="s1">nLearn more: https://nextjs.org/docs/messages/nonce-contained-invalid-characters'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return nonce</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getScriptNonceFromHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;cspHeaderValue&quot;</span><span class="s0">,</span><span class="s1">&quot;directive&quot;</span><span class="s0">,</span><span class="s1">&quot;directives&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;trim&quot;</span><span class="s0">,</span><span class="s1">&quot;find&quot;</span><span class="s0">,</span><span class="s1">&quot;dir&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;nonce&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;source&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;ESCAPE_REGEX&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BAEgBA;;;eAAAA;;;4BAFa;AAEtB,SAASA,yBACdC,cAAsB;QAmBRC;IAjBd,MAAMC,aAAaF,cACjB,+BAA+B;KAC9BG,KAAK,CAAC,KACNC,GAAG,CAAC,CAACH,YAAcA,UAAUI,IAAI;IAEpC,yEAAyE;IACzE,iCAAiC;IACjC,MAAMJ,YACJC,WAAWI,IAAI,CAAC,CAACC,MAAQA,IAAIC,UAAU,CAAC,kBACxCN,WAAWI,IAAI,CAAC,CAACC,MAAQA,IAAIC,UAAU,CAAC;IAE1C,mDAAmD;IACnD,IAAI,CAACP,WAAW;QACd;IACF;IAEA,uCAAuC;IACvC,MAAMQ,SAAQR,kCAAAA,UACXE,KAAK,CAAC,IACP,yEAAyE;KACxEO,KAAK,CAAC,GACNN,GAAG,CAAC,CAACO,SAAWA,OAAON,IAAI,GAC5B,kDAAkD;KACjDC,IAAI,CACH,CAACK,SACCA,OAAOH,UAAU,CAAC,cAClBG,OAAOC,MAAM,GAAG,KAChBD,OAAOE,QAAQ,CAAC,0BAVRZ,gCAaVS,KAAK,CAAC,GAAG,CAAC;IAEd,iDAAiD;IACjD,IAAI,CAACD,OAAO;QACV;IACF;IAEA,sEAAsE;IACtE,uEAAuE;IACvE,eAAe;IACf,IAAIK,wBAAY,CAACC,IAAI,CAACN,QAAQ;QAC5B,MAAM,qBAEL,CAFK,IAAIO,MACR,gKADI,qBAAA;mBAAA;wBAAA;0BAAA;QAEN;IACF;IAEA,OAAOP;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>