<html>
<head>
<title>setup-dev-bundler.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
setup-dev-bundler.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/server/lib/router-utils/setup-dev-bundler.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { NextConfigComplete } from '../../config-shared'</span><span class="s3">\n</span><span class="s1">import type { FilesystemDynamicRoute } from './filesystem'</span><span class="s3">\n</span><span class="s1">import type { UnwrapPromise } from '../../../lib/coalesced-function'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">getPageStaticInfo,</span><span class="s3">\n  </span><span class="s1">type MiddlewareMatcher,</span><span class="s3">\n</span><span class="s1">} from '../../../build/analysis/get-page-static-info'</span><span class="s3">\n</span><span class="s1">import type { RoutesManifest } from '../../../build'</span><span class="s3">\n</span><span class="s1">import type { MiddlewareRouteMatch } from '../../../shared/lib/router/utils/middleware-route-matcher'</span><span class="s3">\n</span><span class="s1">import type { PropagateToWorkersField } from './types'</span><span class="s3">\n</span><span class="s1">import type { NextJsHotReloaderInterface } from '../../dev/hot-reloader-types'</span><span class="s3">\n\n</span><span class="s1">import { createDefineEnv } from '../../../build/swc'</span><span class="s3">\n</span><span class="s1">import fs from 'fs'</span><span class="s3">\n</span><span class="s1">import url from 'url'</span><span class="s3">\n</span><span class="s1">import path from 'path'</span><span class="s3">\n</span><span class="s1">import qs from 'querystring'</span><span class="s3">\n</span><span class="s1">import Watchpack from 'next/dist/compiled/watchpack'</span><span class="s3">\n</span><span class="s1">import { loadEnvConfig } from '@next/env'</span><span class="s3">\n</span><span class="s1">import findUp from 'next/dist/compiled/find-up'</span><span class="s3">\n</span><span class="s1">import { buildCustomRoute } from './filesystem'</span><span class="s3">\n</span><span class="s1">import * as Log from '../../../build/output/log'</span><span class="s3">\n</span><span class="s1">import HotReloaderWebpack from '../../dev/hot-reloader-webpack'</span><span class="s3">\n</span><span class="s1">import { setGlobal } from '../../../trace/shared'</span><span class="s3">\n</span><span class="s1">import type { Telemetry } from '../../../telemetry/storage'</span><span class="s3">\n</span><span class="s1">import type { IncomingMessage, ServerResponse } from 'http'</span><span class="s3">\n</span><span class="s1">import loadJsConfig from '../../../build/load-jsconfig'</span><span class="s3">\n</span><span class="s1">import { createValidFileMatcher } from '../find-page-file'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">EVENT_BUILD_FEATURE_USAGE,</span><span class="s3">\n  </span><span class="s1">eventCliSession,</span><span class="s3">\n</span><span class="s1">} from '../../../telemetry/events'</span><span class="s3">\n</span><span class="s1">import { getSortedRoutes } from '../../../shared/lib/router/utils'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">getStaticInfoIncludingLayouts,</span><span class="s3">\n  </span><span class="s1">sortByPageExts,</span><span class="s3">\n</span><span class="s1">} from '../../../build/entries'</span><span class="s3">\n</span><span class="s1">import { verifyTypeScriptSetup } from '../../../lib/verify-typescript-setup'</span><span class="s3">\n</span><span class="s1">import { verifyPartytownSetup } from '../../../lib/verify-partytown-setup'</span><span class="s3">\n</span><span class="s1">import { getRouteRegex } from '../../../shared/lib/router/utils/route-regex'</span><span class="s3">\n</span><span class="s1">import { normalizeAppPath } from '../../../shared/lib/router/utils/app-paths'</span><span class="s3">\n</span><span class="s1">import { buildDataRoute } from './build-data-route'</span><span class="s3">\n</span><span class="s1">import { getRouteMatcher } from '../../../shared/lib/router/utils/route-matcher'</span><span class="s3">\n</span><span class="s1">import { normalizePathSep } from '../../../shared/lib/page-path/normalize-path-sep'</span><span class="s3">\n</span><span class="s1">import { createClientRouterFilter } from '../../../lib/create-client-router-filter'</span><span class="s3">\n</span><span class="s1">import { absolutePathToPage } from '../../../shared/lib/page-path/absolute-path-to-page'</span><span class="s3">\n</span><span class="s1">import { generateInterceptionRoutesRewrites } from '../../../lib/generate-interception-routes-rewrites'</span><span class="s3">\n\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">CLIENT_STATIC_FILES_PATH,</span><span class="s3">\n  </span><span class="s1">DEV_CLIENT_PAGES_MANIFEST,</span><span class="s3">\n  </span><span class="s1">DEV_CLIENT_MIDDLEWARE_MANIFEST,</span><span class="s3">\n  </span><span class="s1">PHASE_DEVELOPMENT_SERVER,</span><span class="s3">\n  </span><span class="s1">TURBOPACK_CLIENT_MIDDLEWARE_MANIFEST,</span><span class="s3">\n  </span><span class="s1">ROUTES_MANIFEST,</span><span class="s3">\n  </span><span class="s1">PRERENDER_MANIFEST,</span><span class="s3">\n</span><span class="s1">} from '../../../shared/lib/constants'</span><span class="s3">\n\n</span><span class="s1">import { getMiddlewareRouteMatcher } from '../../../shared/lib/router/utils/middleware-route-matcher'</span><span class="s3">\n\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">isMiddlewareFile,</span><span class="s3">\n  </span><span class="s1">NestedMiddlewareError,</span><span class="s3">\n  </span><span class="s1">isInstrumentationHookFile,</span><span class="s3">\n  </span><span class="s1">getPossibleMiddlewareFilenames,</span><span class="s3">\n  </span><span class="s1">getPossibleInstrumentationHookFilenames,</span><span class="s3">\n</span><span class="s1">} from '../../../build/utils'</span><span class="s3">\n</span><span class="s1">import { devPageFiles } from '../../../build/webpack/plugins/next-types-plugin/shared'</span><span class="s3">\n</span><span class="s1">import type { LazyRenderServerInstance } from '../router-server'</span><span class="s3">\n</span><span class="s1">import { HMR_ACTIONS_SENT_TO_BROWSER } from '../../dev/hot-reloader-types'</span><span class="s3">\n</span><span class="s1">import { PAGE_TYPES } from '../../../lib/page-types'</span><span class="s3">\n</span><span class="s1">import { createHotReloaderTurbopack } from '../../dev/hot-reloader-turbopack'</span><span class="s3">\n</span><span class="s1">import { generateEncryptionKeyBase64 } from '../../app-render/encryption-utils-server'</span><span class="s3">\n</span><span class="s1">import { isMetadataRouteFile } from '../../../lib/metadata/is-metadata-route'</span><span class="s3">\n</span><span class="s1">import { normalizeMetadataPageToRoute } from '../../../lib/metadata/get-metadata-route'</span><span class="s3">\n</span><span class="s1">import { createEnvDefinitions } from '../experimental/create-env-definitions'</span><span class="s3">\n</span><span class="s1">import { JsConfigPathsPlugin } from '../../../build/webpack/plugins/jsconfig-paths-plugin'</span><span class="s3">\n</span><span class="s1">import { store as consoleStore } from '../../../build/output/store'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">isPersistentCachingEnabled,</span><span class="s3">\n  </span><span class="s1">ModuleBuildError,</span><span class="s3">\n</span><span class="s1">} from '../../../shared/lib/turbopack/utils'</span><span class="s3">\n</span><span class="s1">import { getDefineEnv } from '../../../build/define-env'</span><span class="s3">\n</span><span class="s1">import { TurbopackInternalError } from '../../../shared/lib/turbopack/internal-error'</span><span class="s3">\n</span><span class="s1">import { normalizePath } from '../../../lib/normalize-path'</span><span class="s3">\n</span><span class="s1">import { JSON_CONTENT_TYPE_HEADER } from '../../../lib/constants'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">createRouteTypesManifest,</span><span class="s3">\n  </span><span class="s1">writeRouteTypesManifest,</span><span class="s3">\n  </span><span class="s1">writeValidatorFile,</span><span class="s3">\n</span><span class="s1">} from './route-types-utils'</span><span class="s3">\n</span><span class="s1">import { isParallelRouteSegment } from '../../../shared/lib/segment'</span><span class="s3">\n</span><span class="s1">import { ensureLeadingSlash } from '../../../shared/lib/page-path/ensure-leading-slash'</span><span class="s3">\n\n</span><span class="s1">export type SetupOpts = {</span><span class="s3">\n  </span><span class="s1">renderServer: LazyRenderServerInstance</span><span class="s3">\n  </span><span class="s1">dir: string</span><span class="s3">\n  </span><span class="s1">turbo?: boolean</span><span class="s3">\n  </span><span class="s1">appDir?: string</span><span class="s3">\n  </span><span class="s1">pagesDir?: string</span><span class="s3">\n  </span><span class="s1">telemetry: Telemetry</span><span class="s3">\n  </span><span class="s1">isCustomServer?: boolean</span><span class="s3">\n  </span><span class="s1">fsChecker: UnwrapPromise&lt;</span><span class="s3">\n    </span><span class="s1">ReturnType&lt;typeof import('./filesystem').setupFsCheck&gt;</span><span class="s3">\n  </span><span class="s1">&gt;</span><span class="s3">\n  </span><span class="s1">nextConfig: NextConfigComplete</span><span class="s3">\n  </span><span class="s1">port: number</span><span class="s3">\n  </span><span class="s1">onDevServerCleanup: ((listener: () =&gt; Promise&lt;void&gt;) =&gt; void) | undefined</span><span class="s3">\n  </span><span class="s1">resetFetch: () =&gt; void</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface DevRoutesManifest {</span><span class="s3">\n  </span><span class="s1">version: number</span><span class="s3">\n  </span><span class="s1">caseSensitive: RoutesManifest['caseSensitive']</span><span class="s3">\n  </span><span class="s1">basePath: RoutesManifest['basePath']</span><span class="s3">\n  </span><span class="s1">rewrites: RoutesManifest['rewrites']</span><span class="s3">\n  </span><span class="s1">redirects: RoutesManifest['redirects']</span><span class="s3">\n  </span><span class="s1">headers: RoutesManifest['headers']</span><span class="s3">\n  </span><span class="s1">i18n: RoutesManifest['i18n']</span><span class="s3">\n  </span><span class="s1">skipMiddlewareUrlNormalize: RoutesManifest['skipMiddlewareUrlNormalize']</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type ServerFields = {</span><span class="s3">\n  </span><span class="s1">actualMiddlewareFile?: string | undefined</span><span class="s3">\n  </span><span class="s1">actualInstrumentationHookFile?: string | undefined</span><span class="s3">\n  </span><span class="s1">appPathRoutes?: Record&lt;string, string | string[]&gt;</span><span class="s3">\n  </span><span class="s1">middleware?:</span><span class="s3">\n    </span><span class="s1">| {</span><span class="s3">\n        </span><span class="s1">page: string</span><span class="s3">\n        </span><span class="s1">match: MiddlewareRouteMatch</span><span class="s3">\n        </span><span class="s1">matchers?: MiddlewareMatcher[]</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">| undefined</span><span class="s3">\n  </span><span class="s1">hasAppNotFound?: boolean</span><span class="s3">\n  </span><span class="s1">interceptionRoutes?: ReturnType&lt;</span><span class="s3">\n    </span><span class="s1">typeof import('./filesystem').buildCustomRoute</span><span class="s3">\n  </span><span class="s1">&gt;[]</span><span class="s3">\n  </span><span class="s1">setIsrStatus?: (key: string, value: boolean) =&gt; void</span><span class="s3">\n  </span><span class="s1">resetFetch?: () =&gt; void</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">async function verifyTypeScript(opts: SetupOpts) {</span><span class="s3">\n  </span><span class="s1">let usingTypeScript = false</span><span class="s3">\n  </span><span class="s1">const verifyResult = await verifyTypeScriptSetup({</span><span class="s3">\n    </span><span class="s1">dir: opts.dir,</span><span class="s3">\n    </span><span class="s1">distDir: opts.nextConfig.distDir,</span><span class="s3">\n    </span><span class="s1">intentDirs: [opts.pagesDir, opts.appDir].filter(Boolean) as string[],</span><span class="s3">\n    </span><span class="s1">typeCheckPreflight: false,</span><span class="s3">\n    </span><span class="s1">tsconfigPath: opts.nextConfig.typescript.tsconfigPath,</span><span class="s3">\n    </span><span class="s1">disableStaticImages: opts.nextConfig.images.disableStaticImages,</span><span class="s3">\n    </span><span class="s1">hasAppDir: !!opts.appDir,</span><span class="s3">\n    </span><span class="s1">hasPagesDir: !!opts.pagesDir,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">if (verifyResult.version) {</span><span class="s3">\n    </span><span class="s1">usingTypeScript = true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return usingTypeScript</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function propagateServerField(</span><span class="s3">\n  </span><span class="s1">opts: SetupOpts,</span><span class="s3">\n  </span><span class="s1">field: PropagateToWorkersField,</span><span class="s3">\n  </span><span class="s1">args: any</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">await opts.renderServer?.instance?.propagateServerField(opts.dir, field, args)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">async function startWatcher(</span><span class="s3">\n  </span><span class="s1">opts: SetupOpts &amp; {</span><span class="s3">\n    </span><span class="s1">isSrcDir: boolean</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const { nextConfig, appDir, pagesDir, dir, resetFetch } = opts</span><span class="s3">\n  </span><span class="s1">const { useFileSystemPublicRoutes } = nextConfig</span><span class="s3">\n\n  </span><span class="s1">const distDir = path.join(opts.dir, opts.nextConfig.distDir)</span><span class="s3">\n\n  </span><span class="s1">setGlobal('distDir', distDir)</span><span class="s3">\n  </span><span class="s1">setGlobal('phase', PHASE_DEVELOPMENT_SERVER)</span><span class="s3">\n\n  </span><span class="s1">const validFileMatcher = createValidFileMatcher(</span><span class="s3">\n    </span><span class="s1">nextConfig.pageExtensions,</span><span class="s3">\n    </span><span class="s1">appDir</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">const serverFields: ServerFields = {}</span><span class="s3">\n\n  </span><span class="s1">// Update logging state once based on next.config.js when initializing</span><span class="s3">\n  </span><span class="s1">consoleStore.setState({</span><span class="s3">\n    </span><span class="s1">logging: nextConfig.logging !== false,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">const hotReloader: NextJsHotReloaderInterface = opts.turbo</span><span class="s3">\n    </span><span class="s1">? await createHotReloaderTurbopack(opts, serverFields, distDir, resetFetch)</span><span class="s3">\n    </span><span class="s1">: new HotReloaderWebpack(opts.dir, {</span><span class="s3">\n        </span><span class="s1">isSrcDir: opts.isSrcDir,</span><span class="s3">\n        </span><span class="s1">appDir,</span><span class="s3">\n        </span><span class="s1">pagesDir,</span><span class="s3">\n        </span><span class="s1">distDir,</span><span class="s3">\n        </span><span class="s1">config: opts.nextConfig,</span><span class="s3">\n        </span><span class="s1">buildId: 'development',</span><span class="s3">\n        </span><span class="s1">encryptionKey: await generateEncryptionKeyBase64({</span><span class="s3">\n          </span><span class="s1">isBuild: false,</span><span class="s3">\n          </span><span class="s1">distDir,</span><span class="s3">\n        </span><span class="s1">}),</span><span class="s3">\n        </span><span class="s1">telemetry: opts.telemetry,</span><span class="s3">\n        </span><span class="s1">rewrites: opts.fsChecker.rewrites,</span><span class="s3">\n        </span><span class="s1">previewProps: opts.fsChecker.prerenderManifest.preview,</span><span class="s3">\n        </span><span class="s1">resetFetch,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">await hotReloader.start()</span><span class="s3">\n\n  </span><span class="s1">// have to write this after starting hot-reloader since that</span><span class="s3">\n  </span><span class="s1">// cleans the dist dir</span><span class="s3">\n  </span><span class="s1">const distTypesDir = path.join(distDir, 'types')</span><span class="s3">\n  </span><span class="s1">await writeRouteTypesManifest(</span><span class="s3">\n    </span><span class="s1">{</span><span class="s3">\n      </span><span class="s1">appRoutes: {},</span><span class="s3">\n      </span><span class="s1">pageRoutes: {},</span><span class="s3">\n      </span><span class="s1">layoutRoutes: {},</span><span class="s3">\n      </span><span class="s1">appRouteHandlerRoutes: {},</span><span class="s3">\n      </span><span class="s1">redirectRoutes: {},</span><span class="s3">\n      </span><span class="s1">rewriteRoutes: {},</span><span class="s3">\n      </span><span class="s1">appPagePaths: new Set(),</span><span class="s3">\n      </span><span class="s1">pagesRouterPagePaths: new Set(),</span><span class="s3">\n      </span><span class="s1">layoutPaths: new Set(),</span><span class="s3">\n      </span><span class="s1">appRouteHandlers: new Set(),</span><span class="s3">\n      </span><span class="s1">pageApiRoutes: new Set(),</span><span class="s3">\n      </span><span class="s1">filePathToRoute: new Map(),</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">path.join(distTypesDir, 'routes.d.ts'),</span><span class="s3">\n    </span><span class="s1">opts.nextConfig</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">const usingTypeScript = await verifyTypeScript(opts)</span><span class="s3">\n\n  </span><span class="s1">const routesManifestPath = path.join(distDir, ROUTES_MANIFEST)</span><span class="s3">\n  </span><span class="s1">const routesManifest: DevRoutesManifest = {</span><span class="s3">\n    </span><span class="s1">version: 3,</span><span class="s3">\n    </span><span class="s1">caseSensitive: !!nextConfig.experimental.caseSensitiveRoutes,</span><span class="s3">\n    </span><span class="s1">basePath: nextConfig.basePath,</span><span class="s3">\n    </span><span class="s1">rewrites: opts.fsChecker.rewrites,</span><span class="s3">\n    </span><span class="s1">redirects: opts.fsChecker.redirects,</span><span class="s3">\n    </span><span class="s1">headers: opts.fsChecker.headers,</span><span class="s3">\n    </span><span class="s1">i18n: nextConfig.i18n || undefined,</span><span class="s3">\n    </span><span class="s1">skipMiddlewareUrlNormalize: nextConfig.skipMiddlewareUrlNormalize,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">await fs.promises.writeFile(</span><span class="s3">\n    </span><span class="s1">routesManifestPath,</span><span class="s3">\n    </span><span class="s1">JSON.stringify(routesManifest)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">const prerenderManifestPath = path.join(distDir, PRERENDER_MANIFEST)</span><span class="s3">\n  </span><span class="s1">await fs.promises.writeFile(</span><span class="s3">\n    </span><span class="s1">prerenderManifestPath,</span><span class="s3">\n    </span><span class="s1">JSON.stringify(opts.fsChecker.prerenderManifest, null, 2)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">if (opts.nextConfig.experimental.nextScriptWorkers) {</span><span class="s3">\n    </span><span class="s1">await verifyPartytownSetup(</span><span class="s3">\n      </span><span class="s1">opts.dir,</span><span class="s3">\n      </span><span class="s1">path.join(distDir, CLIENT_STATIC_FILES_PATH)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">opts.fsChecker.ensureCallback(async function ensure(item) {</span><span class="s3">\n    </span><span class="s1">if (item.type === 'appFile' || item.type === 'pageFile') {</span><span class="s3">\n      </span><span class="s1">await hotReloader.ensurePage({</span><span class="s3">\n        </span><span class="s1">clientOnly: false,</span><span class="s3">\n        </span><span class="s1">page: item.itemPath,</span><span class="s3">\n        </span><span class="s1">isApp: item.type === 'appFile',</span><span class="s3">\n        </span><span class="s1">definition: undefined,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">let resolved = false</span><span class="s3">\n  </span><span class="s1">let prevSortedRoutes: string[] = []</span><span class="s3">\n\n  </span><span class="s1">await new Promise&lt;void&gt;(async (resolve, reject) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (pagesDir) {</span><span class="s3">\n      </span><span class="s1">// Watchpack doesn't emit an event for an empty directory</span><span class="s3">\n      </span><span class="s1">fs.readdir(pagesDir, (_, files) =&gt; {</span><span class="s3">\n        </span><span class="s1">if (files?.length) {</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (!resolved) {</span><span class="s3">\n          </span><span class="s1">resolve()</span><span class="s3">\n          </span><span class="s1">resolved = true</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const pages = pagesDir ? [pagesDir] : []</span><span class="s3">\n    </span><span class="s1">const app = appDir ? [appDir] : []</span><span class="s3">\n    </span><span class="s1">const directories = [...pages, ...app]</span><span class="s3">\n\n    </span><span class="s1">const rootDir = pagesDir || appDir</span><span class="s3">\n    </span><span class="s1">const files = [</span><span class="s3">\n      </span><span class="s1">...getPossibleMiddlewareFilenames(</span><span class="s3">\n        </span><span class="s1">path.join(rootDir!, '..'),</span><span class="s3">\n        </span><span class="s1">nextConfig.pageExtensions</span><span class="s3">\n      </span><span class="s1">),</span><span class="s3">\n      </span><span class="s1">...getPossibleInstrumentationHookFilenames(</span><span class="s3">\n        </span><span class="s1">path.join(rootDir!, '..'),</span><span class="s3">\n        </span><span class="s1">nextConfig.pageExtensions</span><span class="s3">\n      </span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">]</span><span class="s3">\n    </span><span class="s1">let nestedMiddleware: string[] = []</span><span class="s3">\n\n    </span><span class="s1">const envFiles = [</span><span class="s3">\n      </span><span class="s1">'.env.development.local',</span><span class="s3">\n      </span><span class="s1">'.env.local',</span><span class="s3">\n      </span><span class="s1">'.env.development',</span><span class="s3">\n      </span><span class="s1">'.env',</span><span class="s3">\n    </span><span class="s1">].map((file) =&gt; path.join(dir, file))</span><span class="s3">\n\n    </span><span class="s1">files.push(...envFiles)</span><span class="s3">\n\n    </span><span class="s1">// tsconfig/jsconfig paths hot-reloading</span><span class="s3">\n    </span><span class="s1">const tsconfigPaths = [</span><span class="s3">\n      </span><span class="s1">path.join(dir, 'tsconfig.json'),</span><span class="s3">\n      </span><span class="s1">path.join(dir, 'jsconfig.json'),</span><span class="s3">\n    </span><span class="s1">] as const</span><span class="s3">\n    </span><span class="s1">files.push(...tsconfigPaths)</span><span class="s3">\n\n    </span><span class="s1">const wp = new Watchpack({</span><span class="s3">\n      </span><span class="s1">ignored: (pathname: string) =&gt; {</span><span class="s3">\n        </span><span class="s1">return (</span><span class="s3">\n          </span><span class="s1">!files.some((file) =&gt; file.startsWith(pathname)) &amp;&amp;</span><span class="s3">\n          </span><span class="s1">!directories.some(</span><span class="s3">\n            </span><span class="s1">(d) =&gt; pathname.startsWith(d) || d.startsWith(pathname)</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">const fileWatchTimes = new Map()</span><span class="s3">\n    </span><span class="s1">let enabledTypeScript = usingTypeScript</span><span class="s3">\n    </span><span class="s1">let previousClientRouterFilters: any</span><span class="s3">\n    </span><span class="s1">let previousConflictingPagePaths: Set&lt;string&gt; = new Set()</span><span class="s3">\n\n    </span><span class="s1">const routeTypesFilePath = path.join(distDir, 'types', 'routes.d.ts')</span><span class="s3">\n    </span><span class="s1">const validatorFilePath = path.join(distDir, 'types', 'validator.ts')</span><span class="s3">\n\n    </span><span class="s1">wp.on('aggregated', async () =&gt; {</span><span class="s3">\n      </span><span class="s1">let middlewareMatchers: MiddlewareMatcher[] | undefined</span><span class="s3">\n      </span><span class="s1">const routedPages: string[] = []</span><span class="s3">\n      </span><span class="s1">const knownFiles = wp.getTimeInfoEntries()</span><span class="s3">\n      </span><span class="s1">const appPaths: Record&lt;string, string[]&gt; = {}</span><span class="s3">\n      </span><span class="s1">const pageNameSet = new Set&lt;string&gt;()</span><span class="s3">\n      </span><span class="s1">const conflictingAppPagePaths = new Set&lt;string&gt;()</span><span class="s3">\n      </span><span class="s1">const appPageFilePaths = new Map&lt;string, string&gt;()</span><span class="s3">\n      </span><span class="s1">const pagesPageFilePaths = new Map&lt;string, string&gt;()</span><span class="s3">\n      </span><span class="s1">const appRouteHandlers: Array&lt;{ route: string; filePath: string }&gt; = []</span><span class="s3">\n      </span><span class="s1">const pageApiRoutes: Array&lt;{ route: string; filePath: string }&gt; = []</span><span class="s3">\n\n      </span><span class="s1">const pageRoutes: Array&lt;{ route: string; filePath: string }&gt; = []</span><span class="s3">\n      </span><span class="s1">const appRoutes: Array&lt;{ route: string; filePath: string }&gt; = []</span><span class="s3">\n      </span><span class="s1">const layoutRoutes: Array&lt;{ route: string; filePath: string }&gt; = []</span><span class="s3">\n      </span><span class="s1">const slots: Array&lt;{ name: string; parent: string }&gt; = []</span><span class="s3">\n\n      </span><span class="s1">let envChange = false</span><span class="s3">\n      </span><span class="s1">let tsconfigChange = false</span><span class="s3">\n      </span><span class="s1">let conflictingPageChange = 0</span><span class="s3">\n      </span><span class="s1">let hasRootAppNotFound = false</span><span class="s3">\n\n      </span><span class="s1">const { appFiles, pageFiles } = opts.fsChecker</span><span class="s3">\n\n      </span><span class="s1">appFiles.clear()</span><span class="s3">\n      </span><span class="s1">pageFiles.clear()</span><span class="s3">\n      </span><span class="s1">devPageFiles.clear()</span><span class="s3">\n\n      </span><span class="s1">const sortedKnownFiles: string[] = [...knownFiles.keys()].sort(</span><span class="s3">\n        </span><span class="s1">sortByPageExts(nextConfig.pageExtensions)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n\n      </span><span class="s1">for (const fileName of sortedKnownFiles) {</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">!files.includes(fileName) &amp;&amp;</span><span class="s3">\n          </span><span class="s1">!directories.some((d) =&gt; fileName.startsWith(d))</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">const meta = knownFiles.get(fileName)</span><span class="s3">\n\n        </span><span class="s1">const watchTime = fileWatchTimes.get(fileName)</span><span class="s3">\n        </span><span class="s1">// If the file is showing up for the first time or the meta.timestamp is changed since last time</span><span class="s3">\n        </span><span class="s1">const watchTimeChange =</span><span class="s3">\n          </span><span class="s1">watchTime === undefined ||</span><span class="s3">\n          </span><span class="s1">(watchTime &amp;&amp; watchTime !== meta?.timestamp)</span><span class="s3">\n        </span><span class="s1">fileWatchTimes.set(fileName, meta?.timestamp)</span><span class="s3">\n\n        </span><span class="s1">if (envFiles.includes(fileName)) {</span><span class="s3">\n          </span><span class="s1">if (watchTimeChange) {</span><span class="s3">\n            </span><span class="s1">envChange = true</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (tsconfigPaths.includes(fileName)) {</span><span class="s3">\n          </span><span class="s1">if (fileName.endsWith('tsconfig.json')) {</span><span class="s3">\n            </span><span class="s1">enabledTypeScript = true</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">if (watchTimeChange) {</span><span class="s3">\n            </span><span class="s1">tsconfigChange = true</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">meta?.accuracy === undefined ||</span><span class="s3">\n          </span><span class="s1">!validFileMatcher.isPageFile(fileName)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const isAppPath = Boolean(</span><span class="s3">\n          </span><span class="s1">appDir &amp;&amp;</span><span class="s3">\n            </span><span class="s1">normalizePathSep(fileName).startsWith(</span><span class="s3">\n              </span><span class="s1">normalizePathSep(appDir) + '/'</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">const isPagePath = Boolean(</span><span class="s3">\n          </span><span class="s1">pagesDir &amp;&amp;</span><span class="s3">\n            </span><span class="s1">normalizePathSep(fileName).startsWith(</span><span class="s3">\n              </span><span class="s1">normalizePathSep(pagesDir) + '/'</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">const rootFile = absolutePathToPage(fileName, {</span><span class="s3">\n          </span><span class="s1">dir: dir,</span><span class="s3">\n          </span><span class="s1">extensions: nextConfig.pageExtensions,</span><span class="s3">\n          </span><span class="s1">keepIndex: false,</span><span class="s3">\n          </span><span class="s1">pagesType: PAGE_TYPES.ROOT,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n\n        </span><span class="s1">if (isMiddlewareFile(rootFile)) {</span><span class="s3">\n          </span><span class="s1">const staticInfo = await getStaticInfoIncludingLayouts({</span><span class="s3">\n            </span><span class="s1">pageFilePath: fileName,</span><span class="s3">\n            </span><span class="s1">config: nextConfig,</span><span class="s3">\n            </span><span class="s1">appDir: appDir,</span><span class="s3">\n            </span><span class="s1">page: rootFile,</span><span class="s3">\n            </span><span class="s1">isDev: true,</span><span class="s3">\n            </span><span class="s1">isInsideAppDir: isAppPath,</span><span class="s3">\n            </span><span class="s1">pageExtensions: nextConfig.pageExtensions,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">if (nextConfig.output === 'export') {</span><span class="s3">\n            </span><span class="s1">Log.error(</span><span class="s3">\n              </span><span class="s1">'Middleware cannot be used with </span><span class="s3">\&quot;</span><span class="s1">output: export</span><span class="s3">\&quot;</span><span class="s1">. See more info here: https://nextjs.org/docs/advanced-features/static-html-export'</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">continue</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">serverFields.actualMiddlewareFile = rootFile</span><span class="s3">\n          </span><span class="s1">await propagateServerField(</span><span class="s3">\n            </span><span class="s1">opts,</span><span class="s3">\n            </span><span class="s1">'actualMiddlewareFile',</span><span class="s3">\n            </span><span class="s1">serverFields.actualMiddlewareFile</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">middlewareMatchers = staticInfo.middleware?.matchers || [</span><span class="s3">\n            </span><span class="s1">{ regexp: '.*', originalSource: '/:path*' },</span><span class="s3">\n          </span><span class="s1">]</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">if (isInstrumentationHookFile(rootFile)) {</span><span class="s3">\n          </span><span class="s1">serverFields.actualInstrumentationHookFile = rootFile</span><span class="s3">\n          </span><span class="s1">await propagateServerField(</span><span class="s3">\n            </span><span class="s1">opts,</span><span class="s3">\n            </span><span class="s1">'actualInstrumentationHookFile',</span><span class="s3">\n            </span><span class="s1">serverFields.actualInstrumentationHookFile</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (fileName.endsWith('.ts') || fileName.endsWith('.tsx')) {</span><span class="s3">\n          </span><span class="s1">enabledTypeScript = true</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (!(isAppPath || isPagePath)) {</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// Collect all current filenames for the TS plugin to use</span><span class="s3">\n        </span><span class="s1">devPageFiles.add(fileName)</span><span class="s3">\n\n        </span><span class="s1">let pageName = absolutePathToPage(fileName, {</span><span class="s3">\n          </span><span class="s1">dir: isAppPath ? appDir! : pagesDir!,</span><span class="s3">\n          </span><span class="s1">extensions: nextConfig.pageExtensions,</span><span class="s3">\n          </span><span class="s1">keepIndex: isAppPath,</span><span class="s3">\n          </span><span class="s1">pagesType: isAppPath ? PAGE_TYPES.APP : PAGE_TYPES.PAGES,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">isAppPath &amp;&amp;</span><span class="s3">\n          </span><span class="s1">appDir &amp;&amp;</span><span class="s3">\n          </span><span class="s1">isMetadataRouteFile(</span><span class="s3">\n            </span><span class="s1">fileName.replace(appDir, ''),</span><span class="s3">\n            </span><span class="s1">nextConfig.pageExtensions,</span><span class="s3">\n            </span><span class="s1">true</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">const staticInfo = await getPageStaticInfo({</span><span class="s3">\n            </span><span class="s1">pageFilePath: fileName,</span><span class="s3">\n            </span><span class="s1">nextConfig: {},</span><span class="s3">\n            </span><span class="s1">page: pageName,</span><span class="s3">\n            </span><span class="s1">isDev: true,</span><span class="s3">\n            </span><span class="s1">pageType: PAGE_TYPES.APP,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n\n          </span><span class="s1">pageName = normalizeMetadataPageToRoute(</span><span class="s3">\n            </span><span class="s1">pageName,</span><span class="s3">\n            </span><span class="s1">!!(staticInfo.generateSitemaps || staticInfo.generateImageMetadata)</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">!isAppPath &amp;&amp;</span><span class="s3">\n          </span><span class="s1">pageName.startsWith('/api/') &amp;&amp;</span><span class="s3">\n          </span><span class="s1">nextConfig.output === 'export'</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">Log.error(</span><span class="s3">\n            </span><span class="s1">'API Routes cannot be used with </span><span class="s3">\&quot;</span><span class="s1">output: export</span><span class="s3">\&quot;</span><span class="s1">. See more info here: https://nextjs.org/docs/advanced-features/static-html-export'</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (isAppPath) {</span><span class="s3">\n          </span><span class="s1">const isRootNotFound = validFileMatcher.isRootNotFound(fileName)</span><span class="s3">\n          </span><span class="s1">hasRootAppNotFound = true</span><span class="s3">\n\n          </span><span class="s1">if (isRootNotFound) {</span><span class="s3">\n            </span><span class="s1">continue</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Ignore files/directories starting with `_` in the app directory</span><span class="s3">\n          </span><span class="s1">if (normalizePathSep(pageName).includes('/_')) {</span><span class="s3">\n            </span><span class="s1">continue</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Record parallel route slots for layout typing</span><span class="s3">\n          </span><span class="s1">// May run multiple times (e.g. if a parallel route</span><span class="s3">\n          </span><span class="s1">// has both a layout and a page, and children) but that's fine</span><span class="s3">\n          </span><span class="s1">const segments = normalizePathSep(pageName).split('/')</span><span class="s3">\n          </span><span class="s1">for (let i = segments.length - 1; i &gt;= 0; i--) {</span><span class="s3">\n            </span><span class="s1">const segment = segments[i]</span><span class="s3">\n            </span><span class="s1">if (isParallelRouteSegment(segment)) {</span><span class="s3">\n              </span><span class="s1">const parentPath = normalizeAppPath(</span><span class="s3">\n                </span><span class="s1">segments.slice(0, i).join('/')</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n\n              </span><span class="s1">const slotName = segment.slice(1)</span><span class="s3">\n              </span><span class="s1">// check if the slot already exists</span><span class="s3">\n              </span><span class="s1">if (</span><span class="s3">\n                </span><span class="s1">slots.some(</span><span class="s3">\n                  </span><span class="s1">(s) =&gt; s.name === slotName &amp;&amp; s.parent === parentPath</span><span class="s3">\n                </span><span class="s1">)</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n                </span><span class="s1">continue</span><span class="s3">\n\n              </span><span class="s1">slots.push({</span><span class="s3">\n                </span><span class="s1">name: slotName,</span><span class="s3">\n                </span><span class="s1">parent: parentPath,</span><span class="s3">\n              </span><span class="s1">})</span><span class="s3">\n              </span><span class="s1">break</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Record layouts</span><span class="s3">\n          </span><span class="s1">if (validFileMatcher.isAppLayoutPage(fileName)) {</span><span class="s3">\n            </span><span class="s1">layoutRoutes.push({</span><span class="s3">\n              </span><span class="s1">route: ensureLeadingSlash(</span><span class="s3">\n                </span><span class="s1">normalizeAppPath(normalizePathSep(pageName)).replace(</span><span class="s3">\n                  </span><span class="s1">/</span><span class="s3">\\</span><span class="s1">/layout$/,</span><span class="s3">\n                  </span><span class="s1">''</span><span class="s3">\n                </span><span class="s1">)</span><span class="s3">\n              </span><span class="s1">),</span><span class="s3">\n              </span><span class="s1">filePath: fileName,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">if (!validFileMatcher.isAppRouterPage(fileName)) {</span><span class="s3">\n            </span><span class="s1">continue</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">const originalPageName = pageName</span><span class="s3">\n          </span><span class="s1">pageName = normalizeAppPath(pageName).replace(/%5F/g, '_')</span><span class="s3">\n          </span><span class="s1">if (!appPaths[pageName]) {</span><span class="s3">\n            </span><span class="s1">appPaths[pageName] = []</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">appPaths[pageName].push(</span><span class="s3">\n            </span><span class="s1">opts.turbo</span><span class="s3">\n              </span><span class="s1">? // Turbopack outputs the correct path which is normalized with the `_`.</span><span class="s3">\n                </span><span class="s1">originalPageName.replace(/%5F/g, '_')</span><span class="s3">\n              </span><span class="s1">: originalPageName</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n\n          </span><span class="s1">if (useFileSystemPublicRoutes) {</span><span class="s3">\n            </span><span class="s1">appFiles.add(pageName)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">if (validFileMatcher.isAppRouterRoute(fileName)) {</span><span class="s3">\n            </span><span class="s1">appRouteHandlers.push({</span><span class="s3">\n              </span><span class="s1">route: normalizePathSep(pageName),</span><span class="s3">\n              </span><span class="s1">filePath: fileName,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">appRoutes.push({</span><span class="s3">\n              </span><span class="s1">route: normalizePathSep(pageName),</span><span class="s3">\n              </span><span class="s1">filePath: fileName,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">if (routedPages.includes(pageName)) {</span><span class="s3">\n            </span><span class="s1">continue</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">if (useFileSystemPublicRoutes) {</span><span class="s3">\n            </span><span class="s1">pageFiles.add(pageName)</span><span class="s3">\n            </span><span class="s1">// always add to nextDataRoutes for now but in future only add</span><span class="s3">\n            </span><span class="s1">// entries that actually use getStaticProps/getServerSideProps</span><span class="s3">\n            </span><span class="s1">opts.fsChecker.nextDataRoutes.add(pageName)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">if (pageName.startsWith('/api/')) {</span><span class="s3">\n            </span><span class="s1">pageApiRoutes.push({</span><span class="s3">\n              </span><span class="s1">route: normalizePathSep(pageName),</span><span class="s3">\n              </span><span class="s1">filePath: fileName,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">pageRoutes.push({</span><span class="s3">\n              </span><span class="s1">route: normalizePathSep(pageName),</span><span class="s3">\n              </span><span class="s1">filePath: fileName,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// Record pages</span><span class="s3">\n        </span><span class="s1">if (isAppPath) {</span><span class="s3">\n          </span><span class="s1">appPageFilePaths.set(pageName, fileName)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">pagesPageFilePaths.set(pageName, fileName)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (appDir &amp;&amp; pageNameSet.has(pageName)) {</span><span class="s3">\n          </span><span class="s1">conflictingAppPagePaths.add(pageName)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">pageNameSet.add(pageName)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">/**</span><span class="s3">\n         </span><span class="s1">* If there is a middleware that is not declared in the root we will</span><span class="s3">\n         </span><span class="s1">* warn without adding it so it doesn't make its way into the system.</span><span class="s3">\n         </span><span class="s1">*/</span><span class="s3">\n        </span><span class="s1">if (/[</span><span class="s3">\\\\\\\\</span><span class="s1">/]_middleware$/.test(pageName)) {</span><span class="s3">\n          </span><span class="s1">nestedMiddleware.push(pageName)</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">routedPages.push(pageName)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const numConflicting = conflictingAppPagePaths.size</span><span class="s3">\n      </span><span class="s1">conflictingPageChange = numConflicting - previousConflictingPagePaths.size</span><span class="s3">\n\n      </span><span class="s1">if (conflictingPageChange !== 0) {</span><span class="s3">\n        </span><span class="s1">if (numConflicting &gt; 0) {</span><span class="s3">\n          </span><span class="s1">let errorMessage = `Conflicting app and page file${</span><span class="s3">\n            </span><span class="s1">numConflicting === 1 ? ' was' : 's were'</span><span class="s3">\n          </span><span class="s1">} found, please remove the conflicting files to continue:</span><span class="s3">\\</span><span class="s1">n`</span><span class="s3">\n\n          </span><span class="s1">for (const p of conflictingAppPagePaths) {</span><span class="s3">\n            </span><span class="s1">const appPath = path.relative(dir, appPageFilePaths.get(p)!)</span><span class="s3">\n            </span><span class="s1">const pagesPath = path.relative(dir, pagesPageFilePaths.get(p)!)</span><span class="s3">\n            </span><span class="s1">errorMessage += `  </span><span class="s3">\&quot;</span><span class="s1">${pagesPath}</span><span class="s3">\&quot; </span><span class="s1">- </span><span class="s3">\&quot;</span><span class="s1">${appPath}</span><span class="s3">\&quot;\\</span><span class="s1">n`</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">hotReloader.setHmrServerError(new Error(errorMessage))</span><span class="s3">\n        </span><span class="s1">} else if (numConflicting === 0) {</span><span class="s3">\n          </span><span class="s1">hotReloader.clearHmrServerError()</span><span class="s3">\n          </span><span class="s1">await propagateServerField(opts, 'reloadMatchers', undefined)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">previousConflictingPagePaths = conflictingAppPagePaths</span><span class="s3">\n\n      </span><span class="s1">let clientRouterFilters: any</span><span class="s3">\n      </span><span class="s1">if (nextConfig.experimental.clientRouterFilter) {</span><span class="s3">\n        </span><span class="s1">clientRouterFilters = createClientRouterFilter(</span><span class="s3">\n          </span><span class="s1">Object.keys(appPaths),</span><span class="s3">\n          </span><span class="s1">nextConfig.experimental.clientRouterFilterRedirects</span><span class="s3">\n            </span><span class="s1">? ((nextConfig as any)._originalRedirects || []).filter(</span><span class="s3">\n                </span><span class="s1">(r: any) =&gt; !r.internal</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">: [],</span><span class="s3">\n          </span><span class="s1">nextConfig.experimental.clientRouterFilterAllowedRate</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">!previousClientRouterFilters ||</span><span class="s3">\n          </span><span class="s1">JSON.stringify(previousClientRouterFilters) !==</span><span class="s3">\n            </span><span class="s1">JSON.stringify(clientRouterFilters)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">envChange = true</span><span class="s3">\n          </span><span class="s1">previousClientRouterFilters = clientRouterFilters</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (!usingTypeScript &amp;&amp; enabledTypeScript) {</span><span class="s3">\n        </span><span class="s1">// we tolerate the error here as this is best effort</span><span class="s3">\n        </span><span class="s1">// and the manual install command will be shown</span><span class="s3">\n        </span><span class="s1">await verifyTypeScript(opts)</span><span class="s3">\n          </span><span class="s1">.then(() =&gt; {</span><span class="s3">\n            </span><span class="s1">tsconfigChange = true</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">.catch(() =&gt; {})</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (envChange || tsconfigChange) {</span><span class="s3">\n        </span><span class="s1">if (envChange) {</span><span class="s3">\n          </span><span class="s1">const { loadedEnvFiles } = loadEnvConfig(</span><span class="s3">\n            </span><span class="s1">dir,</span><span class="s3">\n            </span><span class="s1">process.env.NODE_ENV === 'development',</span><span class="s3">\n            </span><span class="s1">Log,</span><span class="s3">\n            </span><span class="s1">true,</span><span class="s3">\n            </span><span class="s1">(envFilePath) =&gt; {</span><span class="s3">\n              </span><span class="s1">Log.info(`Reload env: ${envFilePath}`)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n\n          </span><span class="s1">if (usingTypeScript &amp;&amp; nextConfig.experimental?.typedEnv) {</span><span class="s3">\n            </span><span class="s1">// do not await, this is not essential for further process</span><span class="s3">\n            </span><span class="s1">createEnvDefinitions({</span><span class="s3">\n              </span><span class="s1">distDir,</span><span class="s3">\n              </span><span class="s1">loadedEnvFiles: [</span><span class="s3">\n                </span><span class="s1">...loadedEnvFiles,</span><span class="s3">\n                </span><span class="s1">{</span><span class="s3">\n                  </span><span class="s1">path: nextConfig.configFileName,</span><span class="s3">\n                  </span><span class="s1">env: nextConfig.env,</span><span class="s3">\n                  </span><span class="s1">contents: '',</span><span class="s3">\n                </span><span class="s1">},</span><span class="s3">\n              </span><span class="s1">],</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">await propagateServerField(opts, 'loadEnvConfig', [</span><span class="s3">\n            </span><span class="s1">{ dev: true, forceReload: true, silent: true },</span><span class="s3">\n          </span><span class="s1">])</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">let tsconfigResult:</span><span class="s3">\n          </span><span class="s1">| UnwrapPromise&lt;ReturnType&lt;typeof loadJsConfig&gt;&gt;</span><span class="s3">\n          </span><span class="s1">| undefined</span><span class="s3">\n\n        </span><span class="s1">if (tsconfigChange) {</span><span class="s3">\n          </span><span class="s1">try {</span><span class="s3">\n            </span><span class="s1">tsconfigResult = await loadJsConfig(dir, nextConfig)</span><span class="s3">\n          </span><span class="s1">} catch (_) {</span><span class="s3">\n            </span><span class="s1">/* do we want to log if there are syntax errors in tsconfig while editing? */</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (hotReloader.turbopackProject) {</span><span class="s3">\n          </span><span class="s1">const hasRewrites =</span><span class="s3">\n            </span><span class="s1">opts.fsChecker.rewrites.afterFiles.length &gt; 0 ||</span><span class="s3">\n            </span><span class="s1">opts.fsChecker.rewrites.beforeFiles.length &gt; 0 ||</span><span class="s3">\n            </span><span class="s1">opts.fsChecker.rewrites.fallback.length &gt; 0</span><span class="s3">\n\n          </span><span class="s1">const rootPath =</span><span class="s3">\n            </span><span class="s1">opts.nextConfig.turbopack?.root ||</span><span class="s3">\n            </span><span class="s1">opts.nextConfig.outputFileTracingRoot ||</span><span class="s3">\n            </span><span class="s1">opts.dir</span><span class="s3">\n          </span><span class="s1">await hotReloader.turbopackProject.update({</span><span class="s3">\n            </span><span class="s1">defineEnv: createDefineEnv({</span><span class="s3">\n              </span><span class="s1">isTurbopack: true,</span><span class="s3">\n              </span><span class="s1">clientRouterFilters,</span><span class="s3">\n              </span><span class="s1">config: nextConfig,</span><span class="s3">\n              </span><span class="s1">dev: true,</span><span class="s3">\n              </span><span class="s1">distDir,</span><span class="s3">\n              </span><span class="s1">fetchCacheKeyPrefix:</span><span class="s3">\n                </span><span class="s1">opts.nextConfig.experimental.fetchCacheKeyPrefix,</span><span class="s3">\n              </span><span class="s1">hasRewrites,</span><span class="s3">\n              </span><span class="s1">// TODO: Implement</span><span class="s3">\n              </span><span class="s1">middlewareMatchers: undefined,</span><span class="s3">\n              </span><span class="s1">projectPath: opts.dir,</span><span class="s3">\n              </span><span class="s1">rewrites: opts.fsChecker.rewrites,</span><span class="s3">\n            </span><span class="s1">}),</span><span class="s3">\n            </span><span class="s1">rootPath,</span><span class="s3">\n            </span><span class="s1">projectPath: normalizePath(path.relative(rootPath, dir)),</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">hotReloader.activeWebpackConfigs?.forEach((config, idx) =&gt; {</span><span class="s3">\n          </span><span class="s1">const isClient = idx === 0</span><span class="s3">\n          </span><span class="s1">const isNodeServer = idx === 1</span><span class="s3">\n          </span><span class="s1">const isEdgeServer = idx === 2</span><span class="s3">\n          </span><span class="s1">const hasRewrites =</span><span class="s3">\n            </span><span class="s1">opts.fsChecker.rewrites.afterFiles.length &gt; 0 ||</span><span class="s3">\n            </span><span class="s1">opts.fsChecker.rewrites.beforeFiles.length &gt; 0 ||</span><span class="s3">\n            </span><span class="s1">opts.fsChecker.rewrites.fallback.length &gt; 0</span><span class="s3">\n\n          </span><span class="s1">if (tsconfigChange) {</span><span class="s3">\n            </span><span class="s1">config.resolve?.plugins?.forEach((plugin: any) =&gt; {</span><span class="s3">\n              </span><span class="s1">// look for the JsConfigPathsPlugin and update with</span><span class="s3">\n              </span><span class="s1">// the latest paths/baseUrl config</span><span class="s3">\n              </span><span class="s1">if (plugin instanceof JsConfigPathsPlugin &amp;&amp; tsconfigResult) {</span><span class="s3">\n                </span><span class="s1">const { resolvedBaseUrl, jsConfig } = tsconfigResult</span><span class="s3">\n                </span><span class="s1">const currentResolvedBaseUrl = plugin.resolvedBaseUrl</span><span class="s3">\n                </span><span class="s1">const resolvedUrlIndex = config.resolve?.modules?.findIndex(</span><span class="s3">\n                  </span><span class="s1">(item) =&gt; item === currentResolvedBaseUrl?.baseUrl</span><span class="s3">\n                </span><span class="s1">)</span><span class="s3">\n\n                </span><span class="s1">if (resolvedBaseUrl) {</span><span class="s3">\n                  </span><span class="s1">if (</span><span class="s3">\n                    </span><span class="s1">resolvedBaseUrl.baseUrl !== currentResolvedBaseUrl?.baseUrl</span><span class="s3">\n                  </span><span class="s1">) {</span><span class="s3">\n                    </span><span class="s1">// remove old baseUrl and add new one</span><span class="s3">\n                    </span><span class="s1">if (resolvedUrlIndex &amp;&amp; resolvedUrlIndex &gt; -1) {</span><span class="s3">\n                      </span><span class="s1">config.resolve?.modules?.splice(resolvedUrlIndex, 1)</span><span class="s3">\n                    </span><span class="s1">}</span><span class="s3">\n\n                    </span><span class="s1">// If the resolvedBaseUrl is implicit we only remove the previous value.</span><span class="s3">\n                    </span><span class="s1">// Only add the baseUrl if it's explicitly set in tsconfig/jsconfig</span><span class="s3">\n                    </span><span class="s1">if (!resolvedBaseUrl.isImplicit) {</span><span class="s3">\n                      </span><span class="s1">config.resolve?.modules?.push(resolvedBaseUrl.baseUrl)</span><span class="s3">\n                    </span><span class="s1">}</span><span class="s3">\n                  </span><span class="s1">}</span><span class="s3">\n                </span><span class="s1">}</span><span class="s3">\n\n                </span><span class="s1">if (jsConfig?.compilerOptions?.paths &amp;&amp; resolvedBaseUrl) {</span><span class="s3">\n                  </span><span class="s1">Object.keys(plugin.paths).forEach((key) =&gt; {</span><span class="s3">\n                    </span><span class="s1">delete plugin.paths[key]</span><span class="s3">\n                  </span><span class="s1">})</span><span class="s3">\n                  </span><span class="s1">Object.assign(plugin.paths, jsConfig.compilerOptions.paths)</span><span class="s3">\n                  </span><span class="s1">plugin.resolvedBaseUrl = resolvedBaseUrl</span><span class="s3">\n                </span><span class="s1">}</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">if (envChange) {</span><span class="s3">\n            </span><span class="s1">config.plugins?.forEach((plugin: any) =&gt; {</span><span class="s3">\n              </span><span class="s1">// we look for the DefinePlugin definitions so we can</span><span class="s3">\n              </span><span class="s1">// update them on the active compilers</span><span class="s3">\n              </span><span class="s1">if (</span><span class="s3">\n                </span><span class="s1">plugin &amp;&amp;</span><span class="s3">\n                </span><span class="s1">typeof plugin.definitions === 'object' &amp;&amp;</span><span class="s3">\n                </span><span class="s1">plugin.definitions.__NEXT_DEFINE_ENV</span><span class="s3">\n              </span><span class="s1">) {</span><span class="s3">\n                </span><span class="s1">const newDefine = getDefineEnv({</span><span class="s3">\n                  </span><span class="s1">isTurbopack: false,</span><span class="s3">\n                  </span><span class="s1">clientRouterFilters,</span><span class="s3">\n                  </span><span class="s1">config: nextConfig,</span><span class="s3">\n                  </span><span class="s1">dev: true,</span><span class="s3">\n                  </span><span class="s1">distDir,</span><span class="s3">\n                  </span><span class="s1">fetchCacheKeyPrefix:</span><span class="s3">\n                    </span><span class="s1">opts.nextConfig.experimental.fetchCacheKeyPrefix,</span><span class="s3">\n                  </span><span class="s1">hasRewrites,</span><span class="s3">\n                  </span><span class="s1">isClient,</span><span class="s3">\n                  </span><span class="s1">isEdgeServer,</span><span class="s3">\n                  </span><span class="s1">isNodeServer,</span><span class="s3">\n                  </span><span class="s1">middlewareMatchers: undefined,</span><span class="s3">\n                  </span><span class="s1">projectPath: opts.dir,</span><span class="s3">\n                  </span><span class="s1">rewrites: opts.fsChecker.rewrites,</span><span class="s3">\n                </span><span class="s1">})</span><span class="s3">\n\n                </span><span class="s1">Object.keys(plugin.definitions).forEach((key) =&gt; {</span><span class="s3">\n                  </span><span class="s1">if (!(key in newDefine)) {</span><span class="s3">\n                    </span><span class="s1">delete plugin.definitions[key]</span><span class="s3">\n                  </span><span class="s1">}</span><span class="s3">\n                </span><span class="s1">})</span><span class="s3">\n                </span><span class="s1">Object.assign(plugin.definitions, newDefine)</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">await hotReloader.invalidate({</span><span class="s3">\n          </span><span class="s1">reloadAfterInvalidation: envChange,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (nestedMiddleware.length &gt; 0) {</span><span class="s3">\n        </span><span class="s1">Log.error(</span><span class="s3">\n          </span><span class="s1">new NestedMiddlewareError(</span><span class="s3">\n            </span><span class="s1">nestedMiddleware,</span><span class="s3">\n            </span><span class="s1">dir,</span><span class="s3">\n            </span><span class="s1">(pagesDir || appDir)!</span><span class="s3">\n          </span><span class="s1">).message</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">nestedMiddleware = []</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Make sure to sort parallel routes to make the result deterministic.</span><span class="s3">\n      </span><span class="s1">serverFields.appPathRoutes = Object.fromEntries(</span><span class="s3">\n        </span><span class="s1">Object.entries(appPaths).map(([k, v]) =&gt; [k, v.sort()])</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">await propagateServerField(</span><span class="s3">\n        </span><span class="s1">opts,</span><span class="s3">\n        </span><span class="s1">'appPathRoutes',</span><span class="s3">\n        </span><span class="s1">serverFields.appPathRoutes</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n\n      </span><span class="s1">// TODO: pass this to fsChecker/next-dev-server?</span><span class="s3">\n      </span><span class="s1">serverFields.middleware = middlewareMatchers</span><span class="s3">\n        </span><span class="s1">? {</span><span class="s3">\n            </span><span class="s1">match: null as any,</span><span class="s3">\n            </span><span class="s1">page: '/',</span><span class="s3">\n            </span><span class="s1">matchers: middlewareMatchers,</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">: undefined</span><span class="s3">\n\n      </span><span class="s1">await propagateServerField(opts, 'middleware', serverFields.middleware)</span><span class="s3">\n      </span><span class="s1">serverFields.hasAppNotFound = hasRootAppNotFound</span><span class="s3">\n\n      </span><span class="s1">opts.fsChecker.middlewareMatcher = serverFields.middleware?.matchers</span><span class="s3">\n        </span><span class="s1">? getMiddlewareRouteMatcher(serverFields.middleware?.matchers)</span><span class="s3">\n        </span><span class="s1">: undefined</span><span class="s3">\n\n      </span><span class="s1">const interceptionRoutes = generateInterceptionRoutesRewrites(</span><span class="s3">\n        </span><span class="s1">Object.keys(appPaths),</span><span class="s3">\n        </span><span class="s1">opts.nextConfig.basePath</span><span class="s3">\n      </span><span class="s1">).map((item) =&gt;</span><span class="s3">\n        </span><span class="s1">buildCustomRoute(</span><span class="s3">\n          </span><span class="s1">'before_files_rewrite',</span><span class="s3">\n          </span><span class="s1">item,</span><span class="s3">\n          </span><span class="s1">opts.nextConfig.basePath,</span><span class="s3">\n          </span><span class="s1">opts.nextConfig.experimental.caseSensitiveRoutes</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n\n      </span><span class="s1">opts.fsChecker.rewrites.beforeFiles.push(...interceptionRoutes)</span><span class="s3">\n\n      </span><span class="s1">const exportPathMap =</span><span class="s3">\n        </span><span class="s1">(typeof nextConfig.exportPathMap === 'function' &amp;&amp;</span><span class="s3">\n          </span><span class="s1">(await nextConfig.exportPathMap?.(</span><span class="s3">\n            </span><span class="s1">{},</span><span class="s3">\n            </span><span class="s1">{</span><span class="s3">\n              </span><span class="s1">dev: true,</span><span class="s3">\n              </span><span class="s1">dir: opts.dir,</span><span class="s3">\n              </span><span class="s1">outDir: null,</span><span class="s3">\n              </span><span class="s1">distDir: distDir,</span><span class="s3">\n              </span><span class="s1">buildId: 'development',</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">))) ||</span><span class="s3">\n        </span><span class="s1">{}</span><span class="s3">\n\n      </span><span class="s1">const exportPathMapEntries = Object.entries(exportPathMap || {})</span><span class="s3">\n\n      </span><span class="s1">if (exportPathMapEntries.length &gt; 0) {</span><span class="s3">\n        </span><span class="s1">opts.fsChecker.exportPathMapRoutes = exportPathMapEntries.map(</span><span class="s3">\n          </span><span class="s1">([key, value]) =&gt;</span><span class="s3">\n            </span><span class="s1">buildCustomRoute(</span><span class="s3">\n              </span><span class="s1">'before_files_rewrite',</span><span class="s3">\n              </span><span class="s1">{</span><span class="s3">\n                </span><span class="s1">source: key,</span><span class="s3">\n                </span><span class="s1">destination: `${value.page}${</span><span class="s3">\n                  </span><span class="s1">value.query ? '?' : ''</span><span class="s3">\n                </span><span class="s1">}${qs.stringify(value.query)}`,</span><span class="s3">\n              </span><span class="s1">},</span><span class="s3">\n              </span><span class="s1">opts.nextConfig.basePath,</span><span class="s3">\n              </span><span class="s1">opts.nextConfig.experimental.caseSensitiveRoutes</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">// we serve a separate manifest with all pages for the client in</span><span class="s3">\n        </span><span class="s1">// dev mode so that we can match a page after a rewrite on the client</span><span class="s3">\n        </span><span class="s1">// before it has been built and is populated in the _buildManifest</span><span class="s3">\n        </span><span class="s1">const sortedRoutes = getSortedRoutes(routedPages)</span><span class="s3">\n\n        </span><span class="s1">opts.fsChecker.dynamicRoutes = sortedRoutes.map(</span><span class="s3">\n          </span><span class="s1">(page): FilesystemDynamicRoute =&gt; {</span><span class="s3">\n            </span><span class="s1">const regex = getRouteRegex(page)</span><span class="s3">\n            </span><span class="s1">return {</span><span class="s3">\n              </span><span class="s1">regex: regex.re.toString(),</span><span class="s3">\n              </span><span class="s1">match: getRouteMatcher(regex),</span><span class="s3">\n              </span><span class="s1">page,</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">const dataRoutes: typeof opts.fsChecker.dynamicRoutes = []</span><span class="s3">\n\n        </span><span class="s1">for (const page of sortedRoutes) {</span><span class="s3">\n          </span><span class="s1">const route = buildDataRoute(page, 'development')</span><span class="s3">\n          </span><span class="s1">const routeRegex = getRouteRegex(route.page)</span><span class="s3">\n          </span><span class="s1">dataRoutes.push({</span><span class="s3">\n            </span><span class="s1">...route,</span><span class="s3">\n            </span><span class="s1">regex: routeRegex.re.toString(),</span><span class="s3">\n            </span><span class="s1">match: getRouteMatcher({</span><span class="s3">\n              </span><span class="s1">// TODO: fix this in the manifest itself, must also be fixed in</span><span class="s3">\n              </span><span class="s1">// upstream builder that relies on this</span><span class="s3">\n              </span><span class="s1">re: opts.nextConfig.i18n</span><span class="s3">\n                </span><span class="s1">? new RegExp(</span><span class="s3">\n                    </span><span class="s1">route.dataRouteRegex.replace(</span><span class="s3">\n                      </span><span class="s1">`/development/`,</span><span class="s3">\n                      </span><span class="s1">`/development/(?&lt;nextLocale&gt;[^/]+?)/`</span><span class="s3">\n                    </span><span class="s1">)</span><span class="s3">\n                  </span><span class="s1">)</span><span class="s3">\n                </span><span class="s1">: new RegExp(route.dataRouteRegex),</span><span class="s3">\n              </span><span class="s1">groups: routeRegex.groups,</span><span class="s3">\n            </span><span class="s1">}),</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">opts.fsChecker.dynamicRoutes.unshift(...dataRoutes)</span><span class="s3">\n\n        </span><span class="s1">if (!prevSortedRoutes?.every((val, idx) =&gt; val === sortedRoutes[idx])) {</span><span class="s3">\n          </span><span class="s1">const addedRoutes = sortedRoutes.filter(</span><span class="s3">\n            </span><span class="s1">(route) =&gt; !prevSortedRoutes.includes(route)</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">const removedRoutes = prevSortedRoutes.filter(</span><span class="s3">\n            </span><span class="s1">(route) =&gt; !sortedRoutes.includes(route)</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n\n          </span><span class="s1">// emit the change so clients fetch the update</span><span class="s3">\n          </span><span class="s1">hotReloader.send({</span><span class="s3">\n            </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.DEV_PAGES_MANIFEST_UPDATE,</span><span class="s3">\n            </span><span class="s1">data: [</span><span class="s3">\n              </span><span class="s1">{</span><span class="s3">\n                </span><span class="s1">devPagesManifest: true,</span><span class="s3">\n              </span><span class="s1">},</span><span class="s3">\n            </span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n\n          </span><span class="s1">addedRoutes.forEach((route) =&gt; {</span><span class="s3">\n            </span><span class="s1">hotReloader.send({</span><span class="s3">\n              </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.ADDED_PAGE,</span><span class="s3">\n              </span><span class="s1">data: [route],</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n\n          </span><span class="s1">removedRoutes.forEach((route) =&gt; {</span><span class="s3">\n            </span><span class="s1">hotReloader.send({</span><span class="s3">\n              </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.REMOVED_PAGE,</span><span class="s3">\n              </span><span class="s1">data: [route],</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">prevSortedRoutes = sortedRoutes</span><span class="s3">\n\n        </span><span class="s1">if (usingTypeScript) {</span><span class="s3">\n          </span><span class="s1">const routeTypesManifest = await createRouteTypesManifest({</span><span class="s3">\n            </span><span class="s1">dir,</span><span class="s3">\n            </span><span class="s1">pageRoutes,</span><span class="s3">\n            </span><span class="s1">appRoutes,</span><span class="s3">\n            </span><span class="s1">layoutRoutes,</span><span class="s3">\n            </span><span class="s1">slots,</span><span class="s3">\n            </span><span class="s1">redirects: opts.nextConfig.redirects,</span><span class="s3">\n            </span><span class="s1">rewrites: opts.nextConfig.rewrites,</span><span class="s3">\n            </span><span class="s1">// Ensure relative paths in validator.ts are computed from validatorFilePath,</span><span class="s3">\n            </span><span class="s1">// matching behavior of build and CLI typegen.</span><span class="s3">\n            </span><span class="s1">validatorFilePath,</span><span class="s3">\n            </span><span class="s1">appRouteHandlers,</span><span class="s3">\n            </span><span class="s1">pageApiRoutes,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n\n          </span><span class="s1">await writeRouteTypesManifest(</span><span class="s3">\n            </span><span class="s1">routeTypesManifest,</span><span class="s3">\n            </span><span class="s1">routeTypesFilePath,</span><span class="s3">\n            </span><span class="s1">opts.nextConfig</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">await writeValidatorFile(routeTypesManifest, validatorFilePath)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (!resolved) {</span><span class="s3">\n          </span><span class="s1">resolve()</span><span class="s3">\n          </span><span class="s1">resolved = true</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} catch (e) {</span><span class="s3">\n        </span><span class="s1">if (!resolved) {</span><span class="s3">\n          </span><span class="s1">reject(e)</span><span class="s3">\n          </span><span class="s1">resolved = true</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">Log.warn('Failed to reload dynamic routes:', e)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} finally {</span><span class="s3">\n        </span><span class="s1">// Reload the matchers. The filesystem would have been written to,</span><span class="s3">\n        </span><span class="s1">// and the matchers need to re-scan it to update the router.</span><span class="s3">\n        </span><span class="s1">await propagateServerField(opts, 'reloadMatchers', undefined)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n\n    </span><span class="s1">wp.watch({ directories: [dir], startTime: 0 })</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">const clientPagesManifestPath = `/_next/${CLIENT_STATIC_FILES_PATH}/development/${DEV_CLIENT_PAGES_MANIFEST}`</span><span class="s3">\n  </span><span class="s1">opts.fsChecker.devVirtualFsItems.add(clientPagesManifestPath)</span><span class="s3">\n\n  </span><span class="s1">const devMiddlewareManifestPath = `/_next/${CLIENT_STATIC_FILES_PATH}/development/${DEV_CLIENT_MIDDLEWARE_MANIFEST}`</span><span class="s3">\n  </span><span class="s1">opts.fsChecker.devVirtualFsItems.add(devMiddlewareManifestPath)</span><span class="s3">\n\n  </span><span class="s1">const devTurbopackMiddlewareManifestPath = `/_next/${CLIENT_STATIC_FILES_PATH}/development/${TURBOPACK_CLIENT_MIDDLEWARE_MANIFEST}`</span><span class="s3">\n  </span><span class="s1">opts.fsChecker.devVirtualFsItems.add(devTurbopackMiddlewareManifestPath)</span><span class="s3">\n\n  </span><span class="s1">async function requestHandler(req: IncomingMessage, res: ServerResponse) {</span><span class="s3">\n    </span><span class="s1">const parsedUrl = url.parse(req.url || '/')</span><span class="s3">\n\n    </span><span class="s1">if (parsedUrl.pathname?.includes(clientPagesManifestPath)) {</span><span class="s3">\n      </span><span class="s1">res.statusCode = 200</span><span class="s3">\n      </span><span class="s1">res.setHeader('Content-Type', JSON_CONTENT_TYPE_HEADER)</span><span class="s3">\n      </span><span class="s1">res.end(</span><span class="s3">\n        </span><span class="s1">JSON.stringify({</span><span class="s3">\n          </span><span class="s1">pages: prevSortedRoutes.filter(</span><span class="s3">\n            </span><span class="s1">(route) =&gt; !opts.fsChecker.appFiles.has(route)</span><span class="s3">\n          </span><span class="s1">),</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">return { finished: true }</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">parsedUrl.pathname?.includes(devMiddlewareManifestPath) ||</span><span class="s3">\n      </span><span class="s1">parsedUrl.pathname?.includes(devTurbopackMiddlewareManifestPath)</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">res.statusCode = 200</span><span class="s3">\n      </span><span class="s1">res.setHeader('Content-Type', JSON_CONTENT_TYPE_HEADER)</span><span class="s3">\n      </span><span class="s1">res.end(JSON.stringify(serverFields.middleware?.matchers || []))</span><span class="s3">\n      </span><span class="s1">return { finished: true }</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return { finished: false }</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">function logErrorWithOriginalStack(</span><span class="s3">\n    </span><span class="s1">err: unknown,</span><span class="s3">\n    </span><span class="s1">type?: 'unhandledRejection' | 'uncaughtException' | 'warning' | 'app-dir'</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">if (err instanceof ModuleBuildError) {</span><span class="s3">\n      </span><span class="s1">// Errors that may come from issues from the user's code</span><span class="s3">\n      </span><span class="s1">Log.error(err.message)</span><span class="s3">\n    </span><span class="s1">} else if (err instanceof TurbopackInternalError) {</span><span class="s3">\n      </span><span class="s1">// An internal Turbopack error that has been handled by next-swc, written</span><span class="s3">\n      </span><span class="s1">// to disk and a simplified message shown to user on the Rust side.</span><span class="s3">\n    </span><span class="s1">} else if (type === 'warning') {</span><span class="s3">\n      </span><span class="s1">Log.warn(err)</span><span class="s3">\n    </span><span class="s1">} else if (type === 'app-dir') {</span><span class="s3">\n      </span><span class="s1">Log.error(err)</span><span class="s3">\n    </span><span class="s1">} else if (type) {</span><span class="s3">\n      </span><span class="s1">Log.error(`${type}:`, err)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">Log.error(err)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">serverFields,</span><span class="s3">\n    </span><span class="s1">hotReloader,</span><span class="s3">\n    </span><span class="s1">requestHandler,</span><span class="s3">\n    </span><span class="s1">logErrorWithOriginalStack,</span><span class="s3">\n\n    </span><span class="s1">async ensureMiddleware(requestUrl?: string) {</span><span class="s3">\n      </span><span class="s1">if (!serverFields.actualMiddlewareFile) return</span><span class="s3">\n      </span><span class="s1">return hotReloader.ensurePage({</span><span class="s3">\n        </span><span class="s1">page: serverFields.actualMiddlewareFile,</span><span class="s3">\n        </span><span class="s1">clientOnly: false,</span><span class="s3">\n        </span><span class="s1">definition: undefined,</span><span class="s3">\n        </span><span class="s1">url: requestUrl,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function setupDevBundler(opts: SetupOpts) {</span><span class="s3">\n  </span><span class="s1">const isSrcDir = path</span><span class="s3">\n    </span><span class="s1">.relative(opts.dir, opts.pagesDir || opts.appDir || '')</span><span class="s3">\n    </span><span class="s1">.startsWith('src')</span><span class="s3">\n\n  </span><span class="s1">const result = await startWatcher({</span><span class="s3">\n    </span><span class="s1">...opts,</span><span class="s3">\n    </span><span class="s1">isSrcDir,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">opts.telemetry.record(</span><span class="s3">\n    </span><span class="s1">eventCliSession(</span><span class="s3">\n      </span><span class="s1">path.join(opts.dir, opts.nextConfig.distDir),</span><span class="s3">\n      </span><span class="s1">opts.nextConfig,</span><span class="s3">\n      </span><span class="s1">{</span><span class="s3">\n        </span><span class="s1">webpackVersion: 5,</span><span class="s3">\n        </span><span class="s1">isSrcDir,</span><span class="s3">\n        </span><span class="s1">turboFlag: !!opts.turbo,</span><span class="s3">\n        </span><span class="s1">cliCommand: 'dev',</span><span class="s3">\n        </span><span class="s1">appDir: !!opts.appDir,</span><span class="s3">\n        </span><span class="s1">pagesDir: !!opts.pagesDir,</span><span class="s3">\n        </span><span class="s1">isCustomServer: !!opts.isCustomServer,</span><span class="s3">\n        </span><span class="s1">hasNowJson: !!(await findUp('now.json', { cwd: opts.dir })),</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">// Track build features for dev server here:</span><span class="s3">\n  </span><span class="s1">opts.telemetry.record({</span><span class="s3">\n    </span><span class="s1">eventName: EVENT_BUILD_FEATURE_USAGE,</span><span class="s3">\n    </span><span class="s1">payload: {</span><span class="s3">\n      </span><span class="s1">featureName: 'turbopackPersistentCaching',</span><span class="s3">\n      </span><span class="s1">invocationCount: isPersistentCachingEnabled(opts.nextConfig) ? 1 : 0,</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">return result</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type DevBundler = Awaited&lt;ReturnType&lt;typeof setupDevBundler&gt;&gt;</span><span class="s3">\n\n</span><span class="s1">// Returns a trace rewritten through Turbopack's sourcemaps</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;propagateServerField&quot;</span><span class="s0">,</span><span class="s1">&quot;setupDevBundler&quot;</span><span class="s0">,</span><span class="s1">&quot;verifyTypeScript&quot;</span><span class="s0">,</span><span class="s1">&quot;opts&quot;</span><span class="s0">,</span><span class="s1">&quot;usingTypeScript&quot;</span><span class="s0">,</span><span class="s1">&quot;verifyResult&quot;</span><span class="s0">,</span><span class="s1">&quot;verifyTypeScriptSetup&quot;</span><span class="s0">,</span><span class="s1">&quot;dir&quot;</span><span class="s0">,</span><span class="s1">&quot;distDir&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;intentDirs&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesDir&quot;</span><span class="s0">,</span><span class="s1">&quot;appDir&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;Boolean&quot;</span><span class="s0">,</span><span class="s1">&quot;typeCheckPreflight&quot;</span><span class="s0">,</span><span class="s1">&quot;tsconfigPath&quot;</span><span class="s0">,</span><span class="s1">&quot;typescript&quot;</span><span class="s0">,</span><span class="s1">&quot;disableStaticImages&quot;</span><span class="s0">,</span><span class="s1">&quot;images&quot;</span><span class="s0">,</span><span class="s1">&quot;hasAppDir&quot;</span><span class="s0">,</span><span class="s1">&quot;hasPagesDir&quot;</span><span class="s0">,</span><span class="s1">&quot;version&quot;</span><span class="s0">,</span><span class="s1">&quot;field&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;renderServer&quot;</span><span class="s0">,</span><span class="s1">&quot;instance&quot;</span><span class="s0">,</span><span class="s1">&quot;startWatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;resetFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;useFileSystemPublicRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;setGlobal&quot;</span><span class="s0">,</span><span class="s1">&quot;PHASE_DEVELOPMENT_SERVER&quot;</span><span class="s0">,</span><span class="s1">&quot;validFileMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;createValidFileMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;pageExtensions&quot;</span><span class="s0">,</span><span class="s1">&quot;serverFields&quot;</span><span class="s0">,</span><span class="s1">&quot;consoleStore&quot;</span><span class="s0">,</span><span class="s1">&quot;setState&quot;</span><span class="s0">,</span><span class="s1">&quot;logging&quot;</span><span class="s0">,</span><span class="s1">&quot;hotReloader&quot;</span><span class="s0">,</span><span class="s1">&quot;turbo&quot;</span><span class="s0">,</span><span class="s1">&quot;createHotReloaderTurbopack&quot;</span><span class="s0">,</span><span class="s1">&quot;HotReloaderWebpack&quot;</span><span class="s0">,</span><span class="s1">&quot;isSrcDir&quot;</span><span class="s0">,</span><span class="s1">&quot;config&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;encryptionKey&quot;</span><span class="s0">,</span><span class="s1">&quot;generateEncryptionKeyBase64&quot;</span><span class="s0">,</span><span class="s1">&quot;isBuild&quot;</span><span class="s0">,</span><span class="s1">&quot;telemetry&quot;</span><span class="s0">,</span><span class="s1">&quot;rewrites&quot;</span><span class="s0">,</span><span class="s1">&quot;fsChecker&quot;</span><span class="s0">,</span><span class="s1">&quot;previewProps&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;preview&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;distTypesDir&quot;</span><span class="s0">,</span><span class="s1">&quot;writeRouteTypesManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;appRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;pageRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;layoutRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;appRouteHandlerRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;redirectRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;rewriteRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;appPagePaths&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesRouterPagePaths&quot;</span><span class="s0">,</span><span class="s1">&quot;layoutPaths&quot;</span><span class="s0">,</span><span class="s1">&quot;appRouteHandlers&quot;</span><span class="s0">,</span><span class="s1">&quot;pageApiRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;filePathToRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;routesManifestPath&quot;</span><span class="s0">,</span><span class="s1">&quot;ROUTES_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;routesManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;caseSensitive&quot;</span><span class="s0">,</span><span class="s1">&quot;experimental&quot;</span><span class="s0">,</span><span class="s1">&quot;caseSensitiveRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;basePath&quot;</span><span class="s0">,</span><span class="s1">&quot;redirects&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;i18n&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;skipMiddlewareUrlNormalize&quot;</span><span class="s0">,</span><span class="s1">&quot;fs&quot;</span><span class="s0">,</span><span class="s1">&quot;promises&quot;</span><span class="s0">,</span><span class="s1">&quot;writeFile&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderManifestPath&quot;</span><span class="s0">,</span><span class="s1">&quot;PRERENDER_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;nextScriptWorkers&quot;</span><span class="s0">,</span><span class="s1">&quot;verifyPartytownSetup&quot;</span><span class="s0">,</span><span class="s1">&quot;CLIENT_STATIC_FILES_PATH&quot;</span><span class="s0">,</span><span class="s1">&quot;ensureCallback&quot;</span><span class="s0">,</span><span class="s1">&quot;ensure&quot;</span><span class="s0">,</span><span class="s1">&quot;item&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;ensurePage&quot;</span><span class="s0">,</span><span class="s1">&quot;clientOnly&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;itemPath&quot;</span><span class="s0">,</span><span class="s1">&quot;isApp&quot;</span><span class="s0">,</span><span class="s1">&quot;definition&quot;</span><span class="s0">,</span><span class="s1">&quot;resolved&quot;</span><span class="s0">,</span><span class="s1">&quot;prevSortedRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;reject&quot;</span><span class="s0">,</span><span class="s1">&quot;readdir&quot;</span><span class="s0">,</span><span class="s1">&quot;_&quot;</span><span class="s0">,</span><span class="s1">&quot;files&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;pages&quot;</span><span class="s0">,</span><span class="s1">&quot;app&quot;</span><span class="s0">,</span><span class="s1">&quot;directories&quot;</span><span class="s0">,</span><span class="s1">&quot;rootDir&quot;</span><span class="s0">,</span><span class="s1">&quot;getPossibleMiddlewareFilenames&quot;</span><span class="s0">,</span><span class="s1">&quot;getPossibleInstrumentationHookFilenames&quot;</span><span class="s0">,</span><span class="s1">&quot;nestedMiddleware&quot;</span><span class="s0">,</span><span class="s1">&quot;envFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;file&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;tsconfigPaths&quot;</span><span class="s0">,</span><span class="s1">&quot;wp&quot;</span><span class="s0">,</span><span class="s1">&quot;Watchpack&quot;</span><span class="s0">,</span><span class="s1">&quot;ignored&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;some&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;d&quot;</span><span class="s0">,</span><span class="s1">&quot;fileWatchTimes&quot;</span><span class="s0">,</span><span class="s1">&quot;enabledTypeScript&quot;</span><span class="s0">,</span><span class="s1">&quot;previousClientRouterFilters&quot;</span><span class="s0">,</span><span class="s1">&quot;previousConflictingPagePaths&quot;</span><span class="s0">,</span><span class="s1">&quot;routeTypesFilePath&quot;</span><span class="s0">,</span><span class="s1">&quot;validatorFilePath&quot;</span><span class="s0">,</span><span class="s1">&quot;on&quot;</span><span class="s0">,</span><span class="s1">&quot;middlewareMatchers&quot;</span><span class="s0">,</span><span class="s1">&quot;routedPages&quot;</span><span class="s0">,</span><span class="s1">&quot;knownFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;getTimeInfoEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;appPaths&quot;</span><span class="s0">,</span><span class="s1">&quot;pageNameSet&quot;</span><span class="s0">,</span><span class="s1">&quot;conflictingAppPagePaths&quot;</span><span class="s0">,</span><span class="s1">&quot;appPageFilePaths&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesPageFilePaths&quot;</span><span class="s0">,</span><span class="s1">&quot;slots&quot;</span><span class="s0">,</span><span class="s1">&quot;envChange&quot;</span><span class="s0">,</span><span class="s1">&quot;tsconfigChange&quot;</span><span class="s0">,</span><span class="s1">&quot;conflictingPageChange&quot;</span><span class="s0">,</span><span class="s1">&quot;hasRootAppNotFound&quot;</span><span class="s0">,</span><span class="s1">&quot;appFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;pageFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;clear&quot;</span><span class="s0">,</span><span class="s1">&quot;devPageFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;sortedKnownFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;sort&quot;</span><span class="s0">,</span><span class="s1">&quot;sortByPageExts&quot;</span><span class="s0">,</span><span class="s1">&quot;fileName&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;meta&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;watchTime&quot;</span><span class="s0">,</span><span class="s1">&quot;watchTimeChange&quot;</span><span class="s0">,</span><span class="s1">&quot;timestamp&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;accuracy&quot;</span><span class="s0">,</span><span class="s1">&quot;isPageFile&quot;</span><span class="s0">,</span><span class="s1">&quot;isAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizePathSep&quot;</span><span class="s0">,</span><span class="s1">&quot;isPagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;rootFile&quot;</span><span class="s0">,</span><span class="s1">&quot;absolutePathToPage&quot;</span><span class="s0">,</span><span class="s1">&quot;extensions&quot;</span><span class="s0">,</span><span class="s1">&quot;keepIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesType&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGE_TYPES&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT&quot;</span><span class="s0">,</span><span class="s1">&quot;isMiddlewareFile&quot;</span><span class="s0">,</span><span class="s1">&quot;staticInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;getStaticInfoIncludingLayouts&quot;</span><span class="s0">,</span><span class="s1">&quot;pageFilePath&quot;</span><span class="s0">,</span><span class="s1">&quot;isDev&quot;</span><span class="s0">,</span><span class="s1">&quot;isInsideAppDir&quot;</span><span class="s0">,</span><span class="s1">&quot;output&quot;</span><span class="s0">,</span><span class="s1">&quot;Log&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;actualMiddlewareFile&quot;</span><span class="s0">,</span><span class="s1">&quot;middleware&quot;</span><span class="s0">,</span><span class="s1">&quot;matchers&quot;</span><span class="s0">,</span><span class="s1">&quot;regexp&quot;</span><span class="s0">,</span><span class="s1">&quot;originalSource&quot;</span><span class="s0">,</span><span class="s1">&quot;isInstrumentationHookFile&quot;</span><span class="s0">,</span><span class="s1">&quot;actualInstrumentationHookFile&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;pageName&quot;</span><span class="s0">,</span><span class="s1">&quot;APP&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGES&quot;</span><span class="s0">,</span><span class="s1">&quot;isMetadataRouteFile&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;getPageStaticInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;pageType&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeMetadataPageToRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;generateSitemaps&quot;</span><span class="s0">,</span><span class="s1">&quot;generateImageMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;isRootNotFound&quot;</span><span class="s0">,</span><span class="s1">&quot;segments&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;isParallelRouteSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;parentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;slotName&quot;</span><span class="s0">,</span><span class="s1">&quot;s&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;parent&quot;</span><span class="s0">,</span><span class="s1">&quot;isAppLayoutPage&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;ensureLeadingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;filePath&quot;</span><span class="s0">,</span><span class="s1">&quot;isAppRouterPage&quot;</span><span class="s0">,</span><span class="s1">&quot;originalPageName&quot;</span><span class="s0">,</span><span class="s1">&quot;isAppRouterRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;nextDataRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;numConflicting&quot;</span><span class="s0">,</span><span class="s1">&quot;size&quot;</span><span class="s0">,</span><span class="s1">&quot;errorMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;p&quot;</span><span class="s0">,</span><span class="s1">&quot;appPath&quot;</span><span class="s0">,</span><span class="s1">&quot;relative&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesPath&quot;</span><span class="s0">,</span><span class="s1">&quot;setHmrServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;clearHmrServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;clientRouterFilters&quot;</span><span class="s0">,</span><span class="s1">&quot;clientRouterFilter&quot;</span><span class="s0">,</span><span class="s1">&quot;createClientRouterFilter&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;clientRouterFilterRedirects&quot;</span><span class="s0">,</span><span class="s1">&quot;_originalRedirects&quot;</span><span class="s0">,</span><span class="s1">&quot;r&quot;</span><span class="s0">,</span><span class="s1">&quot;internal&quot;</span><span class="s0">,</span><span class="s1">&quot;clientRouterFilterAllowedRate&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;catch&quot;</span><span class="s0">,</span><span class="s1">&quot;loadedEnvFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;loadEnvConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;envFilePath&quot;</span><span class="s0">,</span><span class="s1">&quot;info&quot;</span><span class="s0">,</span><span class="s1">&quot;typedEnv&quot;</span><span class="s0">,</span><span class="s1">&quot;createEnvDefinitions&quot;</span><span class="s0">,</span><span class="s1">&quot;configFileName&quot;</span><span class="s0">,</span><span class="s1">&quot;contents&quot;</span><span class="s0">,</span><span class="s1">&quot;dev&quot;</span><span class="s0">,</span><span class="s1">&quot;forceReload&quot;</span><span class="s0">,</span><span class="s1">&quot;silent&quot;</span><span class="s0">,</span><span class="s1">&quot;tsconfigResult&quot;</span><span class="s0">,</span><span class="s1">&quot;loadJsConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;turbopackProject&quot;</span><span class="s0">,</span><span class="s1">&quot;hasRewrites&quot;</span><span class="s0">,</span><span class="s1">&quot;afterFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;beforeFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;fallback&quot;</span><span class="s0">,</span><span class="s1">&quot;rootPath&quot;</span><span class="s0">,</span><span class="s1">&quot;turbopack&quot;</span><span class="s0">,</span><span class="s1">&quot;root&quot;</span><span class="s0">,</span><span class="s1">&quot;outputFileTracingRoot&quot;</span><span class="s0">,</span><span class="s1">&quot;update&quot;</span><span class="s0">,</span><span class="s1">&quot;defineEnv&quot;</span><span class="s0">,</span><span class="s1">&quot;createDefineEnv&quot;</span><span class="s0">,</span><span class="s1">&quot;isTurbopack&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchCacheKeyPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;projectPath&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizePath&quot;</span><span class="s0">,</span><span class="s1">&quot;activeWebpackConfigs&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;idx&quot;</span><span class="s0">,</span><span class="s1">&quot;isClient&quot;</span><span class="s0">,</span><span class="s1">&quot;isNodeServer&quot;</span><span class="s0">,</span><span class="s1">&quot;isEdgeServer&quot;</span><span class="s0">,</span><span class="s1">&quot;plugins&quot;</span><span class="s0">,</span><span class="s1">&quot;plugin&quot;</span><span class="s0">,</span><span class="s1">&quot;JsConfigPathsPlugin&quot;</span><span class="s0">,</span><span class="s1">&quot;jsConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvedBaseUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;currentResolvedBaseUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvedUrlIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;modules&quot;</span><span class="s0">,</span><span class="s1">&quot;findIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;baseUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;splice&quot;</span><span class="s0">,</span><span class="s1">&quot;isImplicit&quot;</span><span class="s0">,</span><span class="s1">&quot;compilerOptions&quot;</span><span class="s0">,</span><span class="s1">&quot;paths&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;assign&quot;</span><span class="s0">,</span><span class="s1">&quot;definitions&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_DEFINE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;newDefine&quot;</span><span class="s0">,</span><span class="s1">&quot;getDefineEnv&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;reloadAfterInvalidation&quot;</span><span class="s0">,</span><span class="s1">&quot;NestedMiddlewareError&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;appPathRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;fromEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;k&quot;</span><span class="s0">,</span><span class="s1">&quot;v&quot;</span><span class="s0">,</span><span class="s1">&quot;match&quot;</span><span class="s0">,</span><span class="s1">&quot;hasAppNotFound&quot;</span><span class="s0">,</span><span class="s1">&quot;middlewareMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;getMiddlewareRouteMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;interceptionRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;generateInterceptionRoutesRewrites&quot;</span><span class="s0">,</span><span class="s1">&quot;buildCustomRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;exportPathMap&quot;</span><span class="s0">,</span><span class="s1">&quot;outDir&quot;</span><span class="s0">,</span><span class="s1">&quot;exportPathMapEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;exportPathMapRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;source&quot;</span><span class="s0">,</span><span class="s1">&quot;destination&quot;</span><span class="s0">,</span><span class="s1">&quot;query&quot;</span><span class="s0">,</span><span class="s1">&quot;qs&quot;</span><span class="s0">,</span><span class="s1">&quot;sortedRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;getSortedRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;regex&quot;</span><span class="s0">,</span><span class="s1">&quot;getRouteRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;re&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;getRouteMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;dataRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;buildDataRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;routeRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;dataRouteRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;groups&quot;</span><span class="s0">,</span><span class="s1">&quot;unshift&quot;</span><span class="s0">,</span><span class="s1">&quot;every&quot;</span><span class="s0">,</span><span class="s1">&quot;val&quot;</span><span class="s0">,</span><span class="s1">&quot;addedRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;removedRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;send&quot;</span><span class="s0">,</span><span class="s1">&quot;action&quot;</span><span class="s0">,</span><span class="s1">&quot;HMR_ACTIONS_SENT_TO_BROWSER&quot;</span><span class="s0">,</span><span class="s1">&quot;DEV_PAGES_MANIFEST_UPDATE&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;devPagesManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;ADDED_PAGE&quot;</span><span class="s0">,</span><span class="s1">&quot;REMOVED_PAGE&quot;</span><span class="s0">,</span><span class="s1">&quot;routeTypesManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;createRouteTypesManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;writeValidatorFile&quot;</span><span class="s0">,</span><span class="s1">&quot;e&quot;</span><span class="s0">,</span><span class="s1">&quot;warn&quot;</span><span class="s0">,</span><span class="s1">&quot;watch&quot;</span><span class="s0">,</span><span class="s1">&quot;startTime&quot;</span><span class="s0">,</span><span class="s1">&quot;clientPagesManifestPath&quot;</span><span class="s0">,</span><span class="s1">&quot;DEV_CLIENT_PAGES_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;devVirtualFsItems&quot;</span><span class="s0">,</span><span class="s1">&quot;devMiddlewareManifestPath&quot;</span><span class="s0">,</span><span class="s1">&quot;DEV_CLIENT_MIDDLEWARE_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;devTurbopackMiddlewareManifestPath&quot;</span><span class="s0">,</span><span class="s1">&quot;TURBOPACK_CLIENT_MIDDLEWARE_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;requestHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;parsedUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;parse&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;setHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;finished&quot;</span><span class="s0">,</span><span class="s1">&quot;logErrorWithOriginalStack&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;ModuleBuildError&quot;</span><span class="s0">,</span><span class="s1">&quot;TurbopackInternalError&quot;</span><span class="s0">,</span><span class="s1">&quot;ensureMiddleware&quot;</span><span class="s0">,</span><span class="s1">&quot;requestUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;record&quot;</span><span class="s0">,</span><span class="s1">&quot;eventCliSession&quot;</span><span class="s0">,</span><span class="s1">&quot;webpackVersion&quot;</span><span class="s0">,</span><span class="s1">&quot;turboFlag&quot;</span><span class="s0">,</span><span class="s1">&quot;cliCommand&quot;</span><span class="s0">,</span><span class="s1">&quot;isCustomServer&quot;</span><span class="s0">,</span><span class="s1">&quot;hasNowJson&quot;</span><span class="s0">,</span><span class="s1">&quot;findUp&quot;</span><span class="s0">,</span><span class="s1">&quot;cwd&quot;</span><span class="s0">,</span><span class="s1">&quot;eventName&quot;</span><span class="s0">,</span><span class="s1">&quot;EVENT_BUILD_FEATURE_USAGE&quot;</span><span class="s0">,</span><span class="s1">&quot;payload&quot;</span><span class="s0">,</span><span class="s1">&quot;featureName&quot;</span><span class="s0">,</span><span class="s1">&quot;invocationCount&quot;</span><span class="s0">,</span><span class="s1">&quot;isPersistentCachingEnabled&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>