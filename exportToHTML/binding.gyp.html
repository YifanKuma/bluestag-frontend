<html>
<head>
<title>binding.gyp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #8c8c8c; font-style: italic;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #0037a6; font-style: italic;}
.s4 { color: #1750eb; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
binding.gyp</font>
</center></td></tr></table>
<pre><span class="s0"># Copyright 2013 Lovell Fuller and others.</span>
<span class="s0"># SPDX-License-Identifier: Apache-2.0</span>

<span class="s1">{</span>
  <span class="s2">'variables'</span><span class="s1">: {</span>
    <span class="s2">'vips_version'</span><span class="s1">: </span><span class="s2">'&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">../lib/libvips</span><span class="s3">\'</span><span class="s2">).minimumLibvipsVersion&quot;)'</span><span class="s1">,</span>
    <span class="s2">'platform_and_arch'</span><span class="s1">: </span><span class="s2">'&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">../lib/libvips</span><span class="s3">\'</span><span class="s2">).buildPlatformArch()&quot;)'</span><span class="s1">,</span>
    <span class="s2">'sharp_libvips_version'</span><span class="s1">: </span><span class="s2">'&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">../package.json</span><span class="s3">\'</span><span class="s2">).optionalDependencies[</span><span class="s3">\'</span><span class="s2">@img/sharp-libvips-&lt;(platform_and_arch)</span><span class="s3">\'</span><span class="s2">]&quot;)'</span><span class="s1">,</span>
    <span class="s2">'sharp_libvips_yarn_locator'</span><span class="s1">: </span><span class="s2">'&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">../lib/libvips</span><span class="s3">\'</span><span class="s2">).yarnLocator()&quot;)'</span><span class="s1">,</span>
    <span class="s2">'sharp_libvips_include_dir'</span><span class="s1">: </span><span class="s2">'&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">../lib/libvips</span><span class="s3">\'</span><span class="s2">).buildSharpLibvipsIncludeDir()&quot;)'</span><span class="s1">,</span>
    <span class="s2">'sharp_libvips_cplusplus_dir'</span><span class="s1">: </span><span class="s2">'&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">../lib/libvips</span><span class="s3">\'</span><span class="s2">).buildSharpLibvipsCPlusPlusDir()&quot;)'</span><span class="s1">,</span>
    <span class="s2">'sharp_libvips_lib_dir'</span><span class="s1">: </span><span class="s2">'&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">../lib/libvips</span><span class="s3">\'</span><span class="s2">).buildSharpLibvipsLibDir()&quot;)'</span>
  <span class="s1">},</span>
  <span class="s2">'targets'</span><span class="s1">: [{</span>
    <span class="s2">'target_name'</span><span class="s1">: </span><span class="s2">'libvips-cpp-&lt;(vips_version)'</span><span class="s1">,</span>
    <span class="s2">'conditions'</span><span class="s1">: [</span>
      <span class="s1">[</span><span class="s2">'OS == &quot;win&quot;'</span><span class="s1">, {</span>
        <span class="s0"># Build libvips C++ binding for Windows due to MSVC std library ABI changes</span>
        <span class="s2">'type'</span><span class="s1">: </span><span class="s2">'shared_library'</span><span class="s1">,</span>
        <span class="s2">'defines'</span><span class="s1">: [</span>
          <span class="s2">'_VIPS_PUBLIC=__declspec(dllexport)'</span><span class="s1">,</span>
          <span class="s2">'_ALLOW_KEYWORD_MACROS'</span><span class="s1">,</span>
          <span class="s2">'G_DISABLE_ASSERT'</span><span class="s1">,</span>
          <span class="s2">'G_DISABLE_CAST_CHECKS'</span><span class="s1">,</span>
          <span class="s2">'G_DISABLE_CHECKS'</span>
        <span class="s1">],</span>
        <span class="s2">'sources'</span><span class="s1">: [</span>
          <span class="s2">'&lt;(sharp_libvips_cplusplus_dir)/VConnection.cpp'</span><span class="s1">,</span>
          <span class="s2">'&lt;(sharp_libvips_cplusplus_dir)/VError.cpp'</span><span class="s1">,</span>
          <span class="s2">'&lt;(sharp_libvips_cplusplus_dir)/VImage.cpp'</span><span class="s1">,</span>
          <span class="s2">'&lt;(sharp_libvips_cplusplus_dir)/VInterpolate.cpp'</span><span class="s1">,</span>
          <span class="s2">'&lt;(sharp_libvips_cplusplus_dir)/VRegion.cpp'</span>
        <span class="s1">],</span>
        <span class="s2">'include_dirs'</span><span class="s1">: [</span>
          <span class="s2">'&lt;(sharp_libvips_include_dir)'</span><span class="s1">,</span>
          <span class="s2">'&lt;(sharp_libvips_include_dir)/glib-2.0'</span><span class="s1">,</span>
          <span class="s2">'&lt;(sharp_libvips_lib_dir)/glib-2.0/include'</span>
        <span class="s1">],</span>
        <span class="s2">'link_settings'</span><span class="s1">: {</span>
          <span class="s2">'library_dirs'</span><span class="s1">: [</span>
            <span class="s2">'&lt;(sharp_libvips_lib_dir)'</span>
          <span class="s1">],</span>
          <span class="s2">'libraries'</span><span class="s1">: [</span>
            <span class="s2">'libvips.lib'</span>
          <span class="s1">],</span>
        <span class="s1">},</span>
        <span class="s2">'configurations'</span><span class="s1">: {</span>
          <span class="s2">'Release'</span><span class="s1">: {</span>
            <span class="s2">'msvs_settings'</span><span class="s1">: {</span>
              <span class="s2">'VCCLCompilerTool'</span><span class="s1">: {</span>
                <span class="s2">&quot;AdditionalOptions&quot;</span><span class="s1">: [</span>
                  <span class="s2">&quot;/std:c++17&quot;</span>
                <span class="s1">],</span>
                <span class="s2">'ExceptionHandling'</span><span class="s1">: </span><span class="s4">1</span><span class="s1">,</span>
                <span class="s2">'Optimization'</span><span class="s1">: </span><span class="s4">1</span><span class="s1">,</span>
                <span class="s2">'WholeProgramOptimization'</span><span class="s1">: </span><span class="s2">'true'</span>
              <span class="s1">},</span>
              <span class="s2">'VCLibrarianTool'</span><span class="s1">: {</span>
                <span class="s2">'AdditionalOptions'</span><span class="s1">: [</span>
                  <span class="s2">'/LTCG:INCREMENTAL'</span>
                <span class="s1">]</span>
              <span class="s1">},</span>
              <span class="s2">'VCLinkerTool'</span><span class="s1">: {</span>
                <span class="s2">'ImageHasSafeExceptionHandlers'</span><span class="s1">: </span><span class="s2">'false'</span><span class="s1">,</span>
                <span class="s2">'OptimizeReferences'</span><span class="s1">: </span><span class="s4">2</span><span class="s1">,</span>
                <span class="s2">'EnableCOMDATFolding'</span><span class="s1">: </span><span class="s4">2</span><span class="s1">,</span>
                <span class="s2">'LinkIncremental'</span><span class="s1">: </span><span class="s4">1</span><span class="s1">,</span>
                <span class="s2">'AdditionalOptions'</span><span class="s1">: [</span>
                  <span class="s2">'/LTCG:INCREMENTAL'</span>
                <span class="s1">]</span>
              <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s2">'msvs_disabled_warnings'</span><span class="s1">: [</span>
              <span class="s4">4275</span>
            <span class="s1">]</span>
          <span class="s1">}</span>
        <span class="s1">}</span>
      <span class="s1">}, {</span>
        <span class="s0"># Ignore this target for non-Windows</span>
        <span class="s2">'type'</span><span class="s1">: </span><span class="s2">'none'</span>
      <span class="s1">}]</span>
    <span class="s1">]</span>
  <span class="s1">}, {</span>
    <span class="s2">'target_name'</span><span class="s1">: </span><span class="s2">'sharp-&lt;(platform_and_arch)'</span><span class="s1">,</span>
    <span class="s2">'defines'</span><span class="s1">: [</span>
      <span class="s2">'G_DISABLE_ASSERT'</span><span class="s1">,</span>
      <span class="s2">'G_DISABLE_CAST_CHECKS'</span><span class="s1">,</span>
      <span class="s2">'G_DISABLE_CHECKS'</span><span class="s1">,</span>
      <span class="s2">'NAPI_VERSION=9'</span><span class="s1">,</span>
      <span class="s2">'NODE_ADDON_API_DISABLE_DEPRECATED'</span><span class="s1">,</span>
      <span class="s2">'NODE_API_SWALLOW_UNTHROWABLE_EXCEPTIONS'</span>
    <span class="s1">],</span>
    <span class="s2">'dependencies'</span><span class="s1">: [</span>
      <span class="s2">'&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">node-addon-api</span><span class="s3">\'</span><span class="s2">).gyp&quot;)'</span><span class="s1">,</span>
      <span class="s2">'libvips-cpp-&lt;(vips_version)'</span>
    <span class="s1">],</span>
    <span class="s2">'variables'</span><span class="s1">: {</span>
      <span class="s2">'conditions'</span><span class="s1">: [</span>
        <span class="s1">[</span><span class="s2">'OS != &quot;win&quot;'</span><span class="s1">, {</span>
          <span class="s2">'pkg_config_path'</span><span class="s1">: </span><span class="s2">'&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">../lib/libvips</span><span class="s3">\'</span><span class="s2">).pkgConfigPath()&quot;)'</span><span class="s1">,</span>
          <span class="s2">'use_global_libvips'</span><span class="s1">: </span><span class="s2">'&lt;!(node -p &quot;Boolean(require(</span><span class="s3">\'</span><span class="s2">../lib/libvips</span><span class="s3">\'</span><span class="s2">).useGlobalLibvips()).toString()&quot;)'</span>
        <span class="s1">}, {</span>
          <span class="s2">'pkg_config_path'</span><span class="s1">: </span><span class="s2">''</span><span class="s1">,</span>
          <span class="s2">'use_global_libvips'</span><span class="s1">: </span><span class="s2">''</span>
        <span class="s1">}]</span>
      <span class="s1">]</span>
    <span class="s1">},</span>
    <span class="s2">'sources'</span><span class="s1">: [</span>
      <span class="s2">'common.cc'</span><span class="s1">,</span>
      <span class="s2">'metadata.cc'</span><span class="s1">,</span>
      <span class="s2">'stats.cc'</span><span class="s1">,</span>
      <span class="s2">'operations.cc'</span><span class="s1">,</span>
      <span class="s2">'pipeline.cc'</span><span class="s1">,</span>
      <span class="s2">'utilities.cc'</span><span class="s1">,</span>
      <span class="s2">'sharp.cc'</span>
    <span class="s1">],</span>
    <span class="s2">'include_dirs'</span><span class="s1">: [</span>
      <span class="s2">'&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">node-addon-api</span><span class="s3">\'</span><span class="s2">).include_dir&quot;)'</span><span class="s1">,</span>
    <span class="s1">],</span>
    <span class="s2">'conditions'</span><span class="s1">: [</span>
      <span class="s1">[</span><span class="s2">'use_global_libvips == &quot;true&quot;'</span><span class="s1">, {</span>
        <span class="s0"># Use pkg-config for include and lib</span>
        <span class="s2">'include_dirs'</span><span class="s1">: [</span><span class="s2">'&lt;!@(PKG_CONFIG_PATH=&quot;&lt;(pkg_config_path)&quot; pkg-config --cflags-only-I vips-cpp vips glib-2.0 | sed s\/-I//g)'</span><span class="s1">],</span>
        <span class="s2">'libraries'</span><span class="s1">: [</span><span class="s2">'&lt;!@(PKG_CONFIG_PATH=&quot;&lt;(pkg_config_path)&quot; pkg-config --libs vips-cpp)'</span><span class="s1">],</span>
        <span class="s2">'defines'</span><span class="s1">: [</span>
          <span class="s2">'SHARP_USE_GLOBAL_LIBVIPS'</span>
        <span class="s1">],</span>
        <span class="s2">'conditions'</span><span class="s1">: [</span>
          <span class="s1">[</span><span class="s2">'OS == &quot;linux&quot;'</span><span class="s1">, {</span>
            <span class="s2">'defines'</span><span class="s1">: [</span>
              <span class="s0"># Inspect libvips-cpp.so to determine which C++11 ABI version was used and set _GLIBCXX_USE_CXX11_ABI accordingly. This is quite horrible.</span>
              <span class="s2">'_GLIBCXX_USE_CXX11_ABI=&lt;!(if readelf -Ws &quot;$(PKG_CONFIG_PATH=&quot;&lt;(pkg_config_path)&quot; pkg-config --variable libdir vips-cpp)/libvips-cpp.so&quot; | c++filt | grep -qF __cxx11;then echo &quot;1&quot;;else echo &quot;0&quot;;fi)'</span>
            <span class="s1">]</span>
          <span class="s1">}]</span>
        <span class="s1">]</span>
      <span class="s1">}, {</span>
        <span class="s0"># Use pre-built libvips stored locally within node_modules</span>
        <span class="s2">'include_dirs'</span><span class="s1">: [</span>
          <span class="s2">'&lt;(sharp_libvips_include_dir)'</span><span class="s1">,</span>
          <span class="s2">'&lt;(sharp_libvips_include_dir)/glib-2.0'</span><span class="s1">,</span>
          <span class="s2">'&lt;(sharp_libvips_lib_dir)/glib-2.0/include'</span>
        <span class="s1">],</span>
        <span class="s2">'library_dirs'</span><span class="s1">: [</span>
          <span class="s2">'&lt;(sharp_libvips_lib_dir)'</span>
        <span class="s1">],</span>
        <span class="s2">'conditions'</span><span class="s1">: [</span>
          <span class="s1">[</span><span class="s2">'OS == &quot;win&quot;'</span><span class="s1">, {</span>
            <span class="s2">'defines'</span><span class="s1">: [</span>
              <span class="s2">'_ALLOW_KEYWORD_MACROS'</span><span class="s1">,</span>
              <span class="s2">'_FILE_OFFSET_BITS=64'</span>
            <span class="s1">],</span>
            <span class="s2">'link_settings'</span><span class="s1">: {</span>
              <span class="s2">'libraries'</span><span class="s1">: [</span>
                <span class="s2">'libvips.lib'</span>
              <span class="s1">]</span>
            <span class="s1">}</span>
          <span class="s1">}],</span>
          <span class="s1">[</span><span class="s2">'OS == &quot;mac&quot;'</span><span class="s1">, {</span>
            <span class="s2">'link_settings'</span><span class="s1">: {</span>
              <span class="s2">'libraries'</span><span class="s1">: [</span>
                <span class="s2">'libvips-cpp.&lt;(vips_version).dylib'</span>
              <span class="s1">]</span>
            <span class="s1">},</span>
            <span class="s2">'xcode_settings'</span><span class="s1">: {</span>
              <span class="s2">'OTHER_LDFLAGS'</span><span class="s1">: [</span>
                <span class="s2">'-Wl,-s'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-dead_strip'</span><span class="s1">,</span>
                <span class="s0"># Ensure runtime linking is relative to sharp.node</span>
                <span class="s2">'-Wl,-rpath,</span><span class="s3">\'</span><span class="s2">@loader_path/../../sharp-libvips-&lt;(platform_and_arch)/lib</span><span class="s3">\'</span><span class="s2">'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-rpath,</span><span class="s3">\'</span><span class="s2">@loader_path/../../../sharp-libvips-&lt;(platform_and_arch)/&lt;(sharp_libvips_version)/lib</span><span class="s3">\'</span><span class="s2">'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-rpath,</span><span class="s3">\'</span><span class="s2">@loader_path/../node_modules/@img/sharp-libvips-&lt;(platform_and_arch)/lib</span><span class="s3">\'</span><span class="s2">'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-rpath,</span><span class="s3">\'</span><span class="s2">@loader_path/../../node_modules/@img/sharp-libvips-&lt;(platform_and_arch)/lib</span><span class="s3">\'</span><span class="s2">'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-rpath,</span><span class="s3">\'</span><span class="s2">@loader_path/../../../node_modules/@img/sharp-libvips-&lt;(platform_and_arch)/lib</span><span class="s3">\'</span><span class="s2">'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-rpath,</span><span class="s3">\'</span><span class="s2">@loader_path/../../../../../@img-sharp-libvips-&lt;(platform_and_arch)-npm-&lt;(sharp_libvips_version)-&lt;(sharp_libvips_yarn_locator)/node_modules/@img/sharp-libvips-&lt;(platform_and_arch)/lib</span><span class="s3">\'</span><span class="s2">'</span>
              <span class="s1">]</span>
            <span class="s1">}</span>
          <span class="s1">}],</span>
          <span class="s1">[</span><span class="s2">'OS == &quot;linux&quot;'</span><span class="s1">, {</span>
            <span class="s2">'defines'</span><span class="s1">: [</span>
              <span class="s2">'_GLIBCXX_USE_CXX11_ABI=1'</span>
            <span class="s1">],</span>
            <span class="s2">'cflags_cc'</span><span class="s1">: [</span>
              <span class="s2">'&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">detect-libc</span><span class="s3">\'</span><span class="s2">).isNonGlibcLinuxSync() ? </span><span class="s3">\'\' </span><span class="s2">: </span><span class="s3">\'</span><span class="s2">-flto=auto</span><span class="s3">\'</span><span class="s2">&quot;)'</span>
            <span class="s1">],</span>
            <span class="s2">'link_settings'</span><span class="s1">: {</span>
              <span class="s2">'libraries'</span><span class="s1">: [</span>
                <span class="s2">'-l:libvips-cpp.so.&lt;(vips_version)'</span>
              <span class="s1">],</span>
              <span class="s2">'ldflags'</span><span class="s1">: [</span>
                <span class="s2">'-lstdc++fs'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-s'</span><span class="s1">,</span>
                <span class="s2">'-Wl,--disable-new-dtags'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-z,nodelete'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-Bsymbolic-functions'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-rpath=</span><span class="s3">\'</span><span class="s2">$$ORIGIN/../../sharp-libvips-&lt;(platform_and_arch)/lib</span><span class="s3">\'</span><span class="s2">'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-rpath=</span><span class="s3">\'</span><span class="s2">$$ORIGIN/../../../sharp-libvips-&lt;(platform_and_arch)/&lt;(sharp_libvips_version)/lib</span><span class="s3">\'</span><span class="s2">'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-rpath=</span><span class="s3">\'</span><span class="s2">$$ORIGIN/../../node_modules/@img/sharp-libvips-&lt;(platform_and_arch)/lib</span><span class="s3">\'</span><span class="s2">'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-rpath=</span><span class="s3">\'</span><span class="s2">$$ORIGIN/../../../node_modules/@img/sharp-libvips-&lt;(platform_and_arch)/lib</span><span class="s3">\'</span><span class="s2">'</span><span class="s1">,</span>
                <span class="s2">'-Wl,-rpath,</span><span class="s3">\'</span><span class="s2">$$ORIGIN/../../../../../@img-sharp-libvips-&lt;(platform_and_arch)-npm-&lt;(sharp_libvips_version)-&lt;(sharp_libvips_yarn_locator)/node_modules/@img/sharp-libvips-&lt;(platform_and_arch)/lib</span><span class="s3">\'</span><span class="s2">'</span>
              <span class="s1">]</span>
            <span class="s1">}</span>
          <span class="s1">}],</span>
          <span class="s1">[</span><span class="s2">'OS == &quot;emscripten&quot;'</span><span class="s1">, {</span>
            <span class="s2">'product_extension'</span><span class="s1">: </span><span class="s2">'node.js'</span><span class="s1">,</span>
            <span class="s2">'link_settings'</span><span class="s1">: {</span>
              <span class="s2">'ldflags'</span><span class="s1">: [</span>
                <span class="s2">'-fexceptions'</span><span class="s1">,</span>
                <span class="s2">'--pre-js=&lt;!(node -p &quot;require.resolve(</span><span class="s3">\'</span><span class="s2">./emscripten/pre.js</span><span class="s3">\'</span><span class="s2">)&quot;)'</span><span class="s1">,</span>
                <span class="s2">'-Oz'</span><span class="s1">,</span>
                <span class="s2">'-sALLOW_MEMORY_GROWTH'</span><span class="s1">,</span>
                <span class="s2">'-sENVIRONMENT=node'</span><span class="s1">,</span>
                <span class="s2">'-sEXPORTED_FUNCTIONS=emnapiInit,_vips_shutdown,_uv_library_shutdown'</span><span class="s1">,</span>
                <span class="s2">'-sNODERAWFS'</span><span class="s1">,</span>
                <span class="s2">'-sWASM_ASYNC_COMPILATION=0'</span>
              <span class="s1">],</span>
              <span class="s2">'libraries'</span><span class="s1">: [</span>
                <span class="s2">'&lt;!@(PKG_CONFIG_PATH=&quot;&lt;!(node -p &quot;require(</span><span class="s3">\'</span><span class="s2">@img/sharp-libvips-dev-wasm32/lib</span><span class="s3">\'</span><span class="s2">)&quot;)/pkgconfig&quot; pkg-config --static --libs vips-cpp)'</span>
              <span class="s1">],</span>
            <span class="s1">}</span>
          <span class="s1">}]</span>
        <span class="s1">]</span>
      <span class="s1">}]</span>
    <span class="s1">],</span>
    <span class="s2">'cflags_cc'</span><span class="s1">: [</span>
      <span class="s2">'-std=c++17'</span><span class="s1">,</span>
      <span class="s2">'-fexceptions'</span><span class="s1">,</span>
      <span class="s2">'-Wall'</span><span class="s1">,</span>
      <span class="s2">'-Os'</span>
    <span class="s1">],</span>
    <span class="s2">'xcode_settings'</span><span class="s1">: {</span>
      <span class="s2">'CLANG_CXX_LANGUAGE_STANDARD'</span><span class="s1">: </span><span class="s2">'c++17'</span><span class="s1">,</span>
      <span class="s2">'MACOSX_DEPLOYMENT_TARGET'</span><span class="s1">: </span><span class="s2">'10.15'</span><span class="s1">,</span>
      <span class="s2">'GCC_ENABLE_CPP_EXCEPTIONS'</span><span class="s1">: </span><span class="s2">'YES'</span><span class="s1">,</span>
      <span class="s2">'GCC_ENABLE_CPP_RTTI'</span><span class="s1">: </span><span class="s2">'YES'</span><span class="s1">,</span>
      <span class="s2">'OTHER_CPLUSPLUSFLAGS'</span><span class="s1">: [</span>
        <span class="s2">'-fexceptions'</span><span class="s1">,</span>
        <span class="s2">'-Wall'</span><span class="s1">,</span>
        <span class="s2">'-Oz'</span>
      <span class="s1">]</span>
    <span class="s1">},</span>
    <span class="s2">'configurations'</span><span class="s1">: {</span>
      <span class="s2">'Release'</span><span class="s1">: {</span>
        <span class="s2">'conditions'</span><span class="s1">: [</span>
          <span class="s1">[</span><span class="s2">'target_arch == &quot;arm&quot;'</span><span class="s1">, {</span>
            <span class="s2">'cflags_cc'</span><span class="s1">: [</span>
              <span class="s2">'-Wno-psabi'</span>
            <span class="s1">]</span>
          <span class="s1">}],</span>
          <span class="s1">[</span><span class="s2">'OS == &quot;win&quot;'</span><span class="s1">, {</span>
            <span class="s2">'msvs_settings'</span><span class="s1">: {</span>
              <span class="s2">'VCCLCompilerTool'</span><span class="s1">: {</span>
                <span class="s2">&quot;AdditionalOptions&quot;</span><span class="s1">: [</span>
                  <span class="s2">&quot;/std:c++17&quot;</span>
                <span class="s1">],</span>
                <span class="s2">'ExceptionHandling'</span><span class="s1">: </span><span class="s4">1</span><span class="s1">,</span>
                <span class="s2">'Optimization'</span><span class="s1">: </span><span class="s4">1</span><span class="s1">,</span>
                <span class="s2">'WholeProgramOptimization'</span><span class="s1">: </span><span class="s2">'true'</span>
              <span class="s1">},</span>
              <span class="s2">'VCLibrarianTool'</span><span class="s1">: {</span>
                <span class="s2">'AdditionalOptions'</span><span class="s1">: [</span>
                  <span class="s2">'/LTCG:INCREMENTAL'</span>
                <span class="s1">]</span>
              <span class="s1">},</span>
              <span class="s2">'VCLinkerTool'</span><span class="s1">: {</span>
                <span class="s2">'ImageHasSafeExceptionHandlers'</span><span class="s1">: </span><span class="s2">'false'</span><span class="s1">,</span>
                <span class="s2">'OptimizeReferences'</span><span class="s1">: </span><span class="s4">2</span><span class="s1">,</span>
                <span class="s2">'EnableCOMDATFolding'</span><span class="s1">: </span><span class="s4">2</span><span class="s1">,</span>
                <span class="s2">'LinkIncremental'</span><span class="s1">: </span><span class="s4">1</span><span class="s1">,</span>
                <span class="s2">'AdditionalOptions'</span><span class="s1">: [</span>
                  <span class="s2">'/LTCG:INCREMENTAL'</span>
                <span class="s1">]</span>
              <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s2">'msvs_disabled_warnings'</span><span class="s1">: [</span>
              <span class="s4">4275</span>
            <span class="s1">]</span>
          <span class="s1">}]</span>
        <span class="s1">]</span>
      <span class="s1">}</span>
    <span class="s1">},</span>
  <span class="s1">}, {</span>
    <span class="s2">'target_name'</span><span class="s1">: </span><span class="s2">'copy-dll'</span><span class="s1">,</span>
    <span class="s2">'type'</span><span class="s1">: </span><span class="s2">'none'</span><span class="s1">,</span>
    <span class="s2">'dependencies'</span><span class="s1">: [</span>
      <span class="s2">'sharp-&lt;(platform_and_arch)'</span>
    <span class="s1">],</span>
    <span class="s2">'conditions'</span><span class="s1">: [</span>
      <span class="s1">[</span><span class="s2">'OS == &quot;win&quot;'</span><span class="s1">, {</span>
        <span class="s2">'copies'</span><span class="s1">: [{</span>
          <span class="s2">'destination'</span><span class="s1">: </span><span class="s2">'build/Release'</span><span class="s1">,</span>
          <span class="s2">'files'</span><span class="s1">: [</span>
            <span class="s2">'&lt;(sharp_libvips_lib_dir)/libvips-42.dll'</span>
          <span class="s1">]</span>
        <span class="s1">}]</span>
      <span class="s1">}]</span>
    <span class="s1">]</span>
  <span class="s1">}]</span>
<span class="s1">}</span>
</pre>
</body>
</html>