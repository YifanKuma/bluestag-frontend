<html>
<head>
<title>shared-cache-controls.external.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
shared-cache-controls.external.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/server/lib/incremental-cache/shared-cache-controls.external.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { PrerenderManifest } from '../../../build'</span><span class="s3">\n</span><span class="s1">import type { DeepReadonly } from '../../../shared/lib/deep-readonly'</span><span class="s3">\n</span><span class="s1">import type { CacheControl } from '../cache-control'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* A shared cache of cache controls for routes. This cache is used so we don't</span><span class="s3">\n </span><span class="s1">* have to modify the prerender manifest when we want to update the cache</span><span class="s3">\n </span><span class="s1">* control for a route.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class SharedCacheControls {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The in-memory cache of cache lives for routes. This cache is populated when</span><span class="s3">\n   </span><span class="s1">* the cache is updated with new cache lives.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">private static readonly cacheControls = new Map&lt;string, CacheControl&gt;()</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* The prerender manifest that contains the initial cache controls for</span><span class="s3">\n     </span><span class="s1">* routes.</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">private readonly prerenderManifest: DeepReadonly&lt;</span><span class="s3">\n      </span><span class="s1">Pick&lt;PrerenderManifest, 'routes' | 'dynamicRoutes'&gt;</span><span class="s3">\n    </span><span class="s1">&gt;</span><span class="s3">\n  </span><span class="s1">) {}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Try to get the cache control value for a route. This will first try to get</span><span class="s3">\n   </span><span class="s1">* the value from the in-memory cache. If the value is not present in the</span><span class="s3">\n   </span><span class="s1">* in-memory cache, it will be sourced from the prerender manifest.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param route the route to get the cache control for</span><span class="s3">\n   </span><span class="s1">* @returns the cache control for the route, or undefined if the values</span><span class="s3">\n   </span><span class="s1">*          are not present in the in-memory cache or the prerender manifest</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public get(route: string): CacheControl | undefined {</span><span class="s3">\n    </span><span class="s1">// This is a copy on write cache that is updated when the cache is updated.</span><span class="s3">\n    </span><span class="s1">// If the cache is never written to, then the values will be sourced from</span><span class="s3">\n    </span><span class="s1">// the prerender manifest.</span><span class="s3">\n    </span><span class="s1">let cacheControl = SharedCacheControls.cacheControls.get(route)</span><span class="s3">\n    </span><span class="s1">if (cacheControl) return cacheControl</span><span class="s3">\n\n    </span><span class="s1">let prerenderData = this.prerenderManifest.routes[route]</span><span class="s3">\n\n    </span><span class="s1">if (prerenderData) {</span><span class="s3">\n      </span><span class="s1">const { initialRevalidateSeconds, initialExpireSeconds } = prerenderData</span><span class="s3">\n\n      </span><span class="s1">if (typeof initialRevalidateSeconds !== 'undefined') {</span><span class="s3">\n        </span><span class="s1">return {</span><span class="s3">\n          </span><span class="s1">revalidate: initialRevalidateSeconds,</span><span class="s3">\n          </span><span class="s1">expire: initialExpireSeconds,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const dynamicPrerenderData = this.prerenderManifest.dynamicRoutes[route]</span><span class="s3">\n\n    </span><span class="s1">if (dynamicPrerenderData) {</span><span class="s3">\n      </span><span class="s1">const { fallbackRevalidate, fallbackExpire } = dynamicPrerenderData</span><span class="s3">\n\n      </span><span class="s1">if (typeof fallbackRevalidate !== 'undefined') {</span><span class="s3">\n        </span><span class="s1">return { revalidate: fallbackRevalidate, expire: fallbackExpire }</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return undefined</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Set the cache control for a route.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param route the route to set the cache control for</span><span class="s3">\n   </span><span class="s1">* @param cacheControl the cache control for the route</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public set(route: string, cacheControl: CacheControl) {</span><span class="s3">\n    </span><span class="s1">SharedCacheControls.cacheControls.set(route, cacheControl)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Clear the in-memory cache of cache controls for routes.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public clear() {</span><span class="s3">\n    </span><span class="s1">SharedCacheControls.cacheControls.clear()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;SharedCacheControls&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheControls&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheControl&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderData&quot;</span><span class="s0">,</span><span class="s1">&quot;routes&quot;</span><span class="s0">,</span><span class="s1">&quot;initialRevalidateSeconds&quot;</span><span class="s0">,</span><span class="s1">&quot;initialExpireSeconds&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;expire&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicPrerenderData&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackExpire&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;clear&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BASaA;;;eAAAA;;;AAAN,MAAMA;gBACX;;;GAGC,QACuBC,gBAAgB,IAAIC;IAE5CC,YACE;;;KAGC,GACD,AAAiBC,iBAEhB,CACD;aAHiBA,oBAAAA;IAGhB;IAEH;;;;;;;;GAQC,GACD,AAAOC,IAAIC,KAAa,EAA4B;QAClD,2EAA2E;QAC3E,yEAAyE;QACzE,0BAA0B;QAC1B,IAAIC,eAAeP,oBAAoBC,aAAa,CAACI,GAAG,CAACC;QACzD,IAAIC,cAAc,OAAOA;QAEzB,IAAIC,gBAAgB,IAAI,CAACJ,iBAAiB,CAACK,MAAM,CAACH,MAAM;QAExD,IAAIE,eAAe;YACjB,MAAM,EAAEE,wBAAwB,EAAEC,oBAAoB,EAAE,GAAGH;YAE3D,IAAI,OAAOE,6BAA6B,aAAa;gBACnD,OAAO;oBACLE,YAAYF;oBACZG,QAAQF;gBACV;YACF;QACF;QAEA,MAAMG,uBAAuB,IAAI,CAACV,iBAAiB,CAACW,aAAa,CAACT,MAAM;QAExE,IAAIQ,sBAAsB;YACxB,MAAM,EAAEE,kBAAkB,EAAEC,cAAc,EAAE,GAAGH;YAE/C,IAAI,OAAOE,uBAAuB,aAAa;gBAC7C,OAAO;oBAAEJ,YAAYI;oBAAoBH,QAAQI;gBAAe;YAClE;QACF;QAEA,OAAOC;IACT;IAEA;;;;;GAKC,GACD,AAAOC,IAAIb,KAAa,EAAEC,YAA0B,EAAE;QACpDP,oBAAoBC,aAAa,CAACkB,GAAG,CAACb,OAAOC;IAC/C;IAEA;;GAEC,GACD,AAAOa,QAAQ;QACbpB,oBAAoBC,aAAa,CAACmB,KAAK;IACzC;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>