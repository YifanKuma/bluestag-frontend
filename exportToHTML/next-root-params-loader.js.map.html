<html>
<head>
<title>next-root-params-loader.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
next-root-params-loader.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/build/webpack/loaders/next-root-params-loader.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { webpack } from 'next/dist/compiled/webpack/webpack'</span><span class="s3">\n</span><span class="s1">import * as path from 'node:path'</span><span class="s3">\n</span><span class="s1">import * as fs from 'node:fs/promises'</span><span class="s3">\n</span><span class="s1">import { normalizeAppPath } from '../../../shared/lib/router/utils/app-paths'</span><span class="s3">\n</span><span class="s1">import { ensureLeadingSlash } from '../../../shared/lib/page-path/ensure-leading-slash'</span><span class="s3">\n</span><span class="s1">import { getSegmentParam } from '../../../server/app-render/get-segment-param'</span><span class="s3">\n\n</span><span class="s1">export type RootParamsLoaderOpts = {</span><span class="s3">\n  </span><span class="s1">appDir: string</span><span class="s3">\n  </span><span class="s1">pageExtensions: string[]</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type CollectedRootParams = Set&lt;string&gt;</span><span class="s3">\n\n</span><span class="s1">const rootParamsLoader: webpack.LoaderDefinitionFunction&lt;RootParamsLoaderOpts&gt; =</span><span class="s3">\n  </span><span class="s1">async function () {</span><span class="s3">\n    </span><span class="s1">const { appDir, pageExtensions } = this.getOptions()</span><span class="s3">\n\n    </span><span class="s1">const allRootParams = await collectRootParamsFromFileSystem({</span><span class="s3">\n      </span><span class="s1">appDir,</span><span class="s3">\n      </span><span class="s1">pageExtensions,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">// invalidate the result whenever a file/directory is added/removed inside the app dir or its subdirectories,</span><span class="s3">\n    </span><span class="s1">// because that might mean that a root layout has been moved.</span><span class="s3">\n    </span><span class="s1">this.addContextDependency(appDir)</span><span class="s3">\n\n    </span><span class="s1">// If there's no root params, there's nothing to generate.</span><span class="s3">\n    </span><span class="s1">if (allRootParams.size === 0) {</span><span class="s3">\n      </span><span class="s1">return 'export {}'</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// Generate a getter for each root param we found.</span><span class="s3">\n    </span><span class="s1">const sortedRootParamNames = Array.from(allRootParams).sort()</span><span class="s3">\n    </span><span class="s1">const content = [</span><span class="s3">\n      </span><span class="s1">`import { getRootParam } from 'next/dist/server/request/root-params';`,</span><span class="s3">\n      </span><span class="s1">...sortedRootParamNames.map((paramName) =&gt; {</span><span class="s3">\n        </span><span class="s1">return `export function ${paramName}() { return getRootParam('${paramName}'); }`</span><span class="s3">\n      </span><span class="s1">}),</span><span class="s3">\n    </span><span class="s1">].join('</span><span class="s3">\\</span><span class="s1">n')</span><span class="s3">\n\n    </span><span class="s1">return content</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export default rootParamsLoader</span><span class="s3">\n\n</span><span class="s1">async function collectRootParamsFromFileSystem(</span><span class="s3">\n  </span><span class="s1">opts: Parameters&lt;typeof findRootLayouts&gt;[0]</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">return collectRootParams({</span><span class="s3">\n    </span><span class="s1">appDir: opts.appDir,</span><span class="s3">\n    </span><span class="s1">rootLayoutFilePaths: await findRootLayouts(opts),</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function collectRootParams({</span><span class="s3">\n  </span><span class="s1">rootLayoutFilePaths,</span><span class="s3">\n  </span><span class="s1">appDir,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">rootLayoutFilePaths: string[]</span><span class="s3">\n  </span><span class="s1">appDir: string</span><span class="s3">\n</span><span class="s1">}): CollectedRootParams {</span><span class="s3">\n  </span><span class="s1">const allRootParams: CollectedRootParams = new Set()</span><span class="s3">\n\n  </span><span class="s1">for (const rootLayoutFilePath of rootLayoutFilePaths) {</span><span class="s3">\n    </span><span class="s1">const params = getParamsFromLayoutFilePath({</span><span class="s3">\n      </span><span class="s1">appDir,</span><span class="s3">\n      </span><span class="s1">layoutFilePath: rootLayoutFilePath,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">for (const param of params) {</span><span class="s3">\n      </span><span class="s1">allRootParams.add(param)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return allRootParams</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">async function findRootLayouts({</span><span class="s3">\n  </span><span class="s1">appDir,</span><span class="s3">\n  </span><span class="s1">pageExtensions,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">appDir: string</span><span class="s3">\n  </span><span class="s1">pageExtensions: string[]</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">const layoutFilenameRegex = new RegExp(</span><span class="s3">\n    </span><span class="s1">`^layout</span><span class="s3">\\\\</span><span class="s1">.(?:${pageExtensions.join('|')})$`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">async function visit(directory: string): Promise&lt;string[]&gt; {</span><span class="s3">\n    </span><span class="s1">let dir: Awaited&lt;ReturnType&lt;(typeof fs)['readdir']&gt;&gt;</span><span class="s3">\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">dir = await fs.readdir(directory, { withFileTypes: true })</span><span class="s3">\n    </span><span class="s1">} catch (err) {</span><span class="s3">\n      </span><span class="s1">// If the directory was removed before we managed to read it, just ignore it.</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">err &amp;&amp;</span><span class="s3">\n        </span><span class="s1">typeof err === 'object' &amp;&amp;</span><span class="s3">\n        </span><span class="s1">'code' in err &amp;&amp;</span><span class="s3">\n        </span><span class="s1">err.code === 'ENOENT'</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">return []</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">throw err</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const subdirectories: string[] = []</span><span class="s3">\n    </span><span class="s1">for (const entry of dir) {</span><span class="s3">\n      </span><span class="s1">if (entry.isDirectory()) {</span><span class="s3">\n        </span><span class="s1">// Directories that start with an underscore are excluded from routing, so we shouldn't look for layouts inside.</span><span class="s3">\n        </span><span class="s1">if (entry.name[0] === '_') {</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">// Parallel routes cannot occur above a layout, so they can't contain a root layout.</span><span class="s3">\n        </span><span class="s1">if (entry.name[0] === '@') {</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const absolutePathname = path.join(directory, entry.name)</span><span class="s3">\n        </span><span class="s1">subdirectories.push(absolutePathname)</span><span class="s3">\n      </span><span class="s1">} else if (entry.isFile()) {</span><span class="s3">\n        </span><span class="s1">if (layoutFilenameRegex.test(entry.name)) {</span><span class="s3">\n          </span><span class="s1">// We found a root layout, so we're not going to recurse into subdirectories,</span><span class="s3">\n          </span><span class="s1">// meaning that we can skip the rest of the entries.</span><span class="s3">\n          </span><span class="s1">// Note that we don't need to track any of the subdirectories as dependencies --</span><span class="s3">\n          </span><span class="s1">// changes in the subdirectories will only become relevant if this root layout is (re)moved,</span><span class="s3">\n          </span><span class="s1">// in which case the loader will re-run, traverse deeper (because it no longer stops at this root layout)</span><span class="s3">\n          </span><span class="s1">// and then track those directories as needed.</span><span class="s3">\n          </span><span class="s1">const rootLayoutPath = path.join(directory, entry.name)</span><span class="s3">\n          </span><span class="s1">return [rootLayoutPath]</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (subdirectories.length === 0) {</span><span class="s3">\n      </span><span class="s1">return []</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const subdirectoryRootLayouts = await Promise.all(</span><span class="s3">\n      </span><span class="s1">subdirectories.map((subdirectory) =&gt; visit(subdirectory))</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">return subdirectoryRootLayouts.flat(1)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return visit(appDir)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getParamsFromLayoutFilePath({</span><span class="s3">\n  </span><span class="s1">appDir,</span><span class="s3">\n  </span><span class="s1">layoutFilePath,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">appDir: string</span><span class="s3">\n  </span><span class="s1">layoutFilePath: string</span><span class="s3">\n</span><span class="s1">}): string[] {</span><span class="s3">\n  </span><span class="s1">const rootLayoutPath = normalizeAppPath(</span><span class="s3">\n    </span><span class="s1">ensureLeadingSlash(path.dirname(path.relative(appDir, layoutFilePath)))</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">const segments = rootLayoutPath.split('/')</span><span class="s3">\n  </span><span class="s1">const paramNames: string[] = []</span><span class="s3">\n  </span><span class="s1">for (const segment of segments) {</span><span class="s3">\n    </span><span class="s1">const param = getSegmentParam(segment)</span><span class="s3">\n    </span><span class="s1">if (param !== null) {</span><span class="s3">\n      </span><span class="s1">paramNames.push(param.param)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return paramNames</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;rootParamsLoader&quot;</span><span class="s0">,</span><span class="s1">&quot;appDir&quot;</span><span class="s0">,</span><span class="s1">&quot;pageExtensions&quot;</span><span class="s0">,</span><span class="s1">&quot;getOptions&quot;</span><span class="s0">,</span><span class="s1">&quot;allRootParams&quot;</span><span class="s0">,</span><span class="s1">&quot;collectRootParamsFromFileSystem&quot;</span><span class="s0">,</span><span class="s1">&quot;addContextDependency&quot;</span><span class="s0">,</span><span class="s1">&quot;size&quot;</span><span class="s0">,</span><span class="s1">&quot;sortedRootParamNames&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;sort&quot;</span><span class="s0">,</span><span class="s1">&quot;content&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;paramName&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;opts&quot;</span><span class="s0">,</span><span class="s1">&quot;collectRootParams&quot;</span><span class="s0">,</span><span class="s1">&quot;rootLayoutFilePaths&quot;</span><span class="s0">,</span><span class="s1">&quot;findRootLayouts&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;rootLayoutFilePath&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;getParamsFromLayoutFilePath&quot;</span><span class="s0">,</span><span class="s1">&quot;layoutFilePath&quot;</span><span class="s0">,</span><span class="s1">&quot;param&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;layoutFilenameRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;visit&quot;</span><span class="s0">,</span><span class="s1">&quot;directory&quot;</span><span class="s0">,</span><span class="s1">&quot;dir&quot;</span><span class="s0">,</span><span class="s1">&quot;fs&quot;</span><span class="s0">,</span><span class="s1">&quot;readdir&quot;</span><span class="s0">,</span><span class="s1">&quot;withFileTypes&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;code&quot;</span><span class="s0">,</span><span class="s1">&quot;subdirectories&quot;</span><span class="s0">,</span><span class="s1">&quot;entry&quot;</span><span class="s0">,</span><span class="s1">&quot;isDirectory&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;absolutePathname&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;isFile&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;rootLayoutPath&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;subdirectoryRootLayouts&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;all&quot;</span><span class="s0">,</span><span class="s1">&quot;subdirectory&quot;</span><span class="s0">,</span><span class="s1">&quot;flat&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;ensureLeadingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;dirname&quot;</span><span class="s0">,</span><span class="s1">&quot;relative&quot;</span><span class="s0">,</span><span class="s1">&quot;segments&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;paramNames&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;getSegmentParam&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BA2CA;;;eAAA;;;kEA1CsB;kEACF;0BACa;oCACE;iCACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAShC,MAAMA,mBACJ;IACE,MAAM,EAAEC,MAAM,EAAEC,cAAc,EAAE,GAAG,IAAI,CAACC,UAAU;IAElD,MAAMC,gBAAgB,MAAMC,gCAAgC;QAC1DJ;QACAC;IACF;IACA,6GAA6G;IAC7G,6DAA6D;IAC7D,IAAI,CAACI,oBAAoB,CAACL;IAE1B,0DAA0D;IAC1D,IAAIG,cAAcG,IAAI,KAAK,GAAG;QAC5B,OAAO;IACT;IAEA,kDAAkD;IAClD,MAAMC,uBAAuBC,MAAMC,IAAI,CAACN,eAAeO,IAAI;IAC3D,MAAMC,UAAU;QACd,CAAC,oEAAoE,CAAC;WACnEJ,qBAAqBK,GAAG,CAAC,CAACC;YAC3B,OAAO,CAAC,gBAAgB,EAAEA,UAAU,0BAA0B,EAAEA,UAAU,KAAK,CAAC;QAClF;KACD,CAACC,IAAI,CAAC;IAEP,OAAOH;AACT;MAEF,WAAeZ;AAEf,eAAeK,gCACbW,IAA2C;IAE3C,OAAOC,kBAAkB;QACvBhB,QAAQe,KAAKf,MAAM;QACnBiB,qBAAqB,MAAMC,gBAAgBH;IAC7C;AACF;AAEA,SAASC,kBAAkB,EACzBC,mBAAmB,EACnBjB,MAAM,EAIP;IACC,MAAMG,gBAAqC,IAAIgB;IAE/C,KAAK,MAAMC,sBAAsBH,oBAAqB;QACpD,MAAMI,SAASC,4BAA4B;YACzCtB;YACAuB,gBAAgBH;QAClB;QACA,KAAK,MAAMI,SAASH,OAAQ;YAC1BlB,cAAcsB,GAAG,CAACD;QACpB;IACF;IAEA,OAAOrB;AACT;AAEA,eAAee,gBAAgB,EAC7BlB,MAAM,EACNC,cAAc,EAIf;IACC,MAAMyB,sBAAsB,IAAIC,OAC9B,CAAC,aAAa,EAAE1B,eAAea,IAAI,CAAC,KAAK,EAAE,CAAC;IAG9C,eAAec,MAAMC,SAAiB;QACpC,IAAIC;QACJ,IAAI;YACFA,MAAM,MAAMC,UAAGC,OAAO,CAACH,WAAW;gBAAEI,eAAe;YAAK;QAC1D,EAAE,OAAOC,KAAK;YACZ,6EAA6E;YAC7E,IACEA,OACA,OAAOA,QAAQ,YACf,UAAUA,OACVA,IAAIC,IAAI,KAAK,UACb;gBACA,OAAO,EAAE;YACX;YAEA,MAAMD;QACR;QAEA,MAAME,iBAA2B,EAAE;QACnC,KAAK,MAAMC,SAASP,IAAK;YACvB,IAAIO,MAAMC,WAAW,IAAI;gBACvB,gHAAgH;gBAChH,IAAID,MAAME,IAAI,CAAC,EAAE,KAAK,KAAK;oBACzB;gBACF;gBACA,oFAAoF;gBACpF,IAAIF,MAAME,IAAI,CAAC,EAAE,KAAK,KAAK;oBACzB;gBACF;gBAEA,MAAMC,mBAAmBC,UAAK3B,IAAI,CAACe,WAAWQ,MAAME,IAAI;gBACxDH,eAAeM,IAAI,CAACF;YACtB,OAAO,IAAIH,MAAMM,MAAM,IAAI;gBACzB,IAAIjB,oBAAoBkB,IAAI,CAACP,MAAME,IAAI,GAAG;oBACxC,6EAA6E;oBAC7E,oDAAoD;oBACpD,gFAAgF;oBAChF,4FAA4F;oBAC5F,yGAAyG;oBACzG,8CAA8C;oBAC9C,MAAMM,iBAAiBJ,UAAK3B,IAAI,CAACe,WAAWQ,MAAME,IAAI;oBACtD,OAAO;wBAACM;qBAAe;gBACzB;YACF;QACF;QAEA,IAAIT,eAAeU,MAAM,KAAK,GAAG;YAC/B,OAAO,EAAE;QACX;QAEA,MAAMC,0BAA0B,MAAMC,QAAQC,GAAG,CAC/Cb,eAAexB,GAAG,CAAC,CAACsC,eAAiBtB,MAAMsB;QAE7C,OAAOH,wBAAwBI,IAAI,CAAC;IACtC;IAEA,OAAOvB,MAAM5B;AACf;AAEA,SAASsB,4BAA4B,EACnCtB,MAAM,EACNuB,cAAc,EAIf;IACC,MAAMsB,iBAAiBO,IAAAA,0BAAgB,EACrCC,IAAAA,sCAAkB,EAACZ,UAAKa,OAAO,CAACb,UAAKc,QAAQ,CAACvD,QAAQuB;IAExD,MAAMiC,WAAWX,eAAeY,KAAK,CAAC;IACtC,MAAMC,aAAuB,EAAE;IAC/B,KAAK,MAAMC,WAAWH,SAAU;QAC9B,MAAMhC,QAAQoC,IAAAA,gCAAe,EAACD;QAC9B,IAAInC,UAAU,MAAM;YAClBkC,WAAWhB,IAAI,CAAClB,MAAMA,KAAK;QAC7B;IACF;IACA,OAAOkC;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>