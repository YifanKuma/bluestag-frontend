<html>
<head>
<title>AsYouType.test.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #8c8c8c; font-style: italic;}
.s4 { color: #0037a6;}
.s5 { color: #1750eb;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
AsYouType.test.js</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">metadata from </span><span class="s2">'../metadata.min.json' </span><span class="s0">with </span><span class="s1">{ type: </span><span class="s2">'json' </span><span class="s1">}</span>
<span class="s0">import </span><span class="s1">AsYouType_ from </span><span class="s2">'./AsYouType.js'</span>

<span class="s0">class </span><span class="s1">AsYouType </span><span class="s0">extends </span><span class="s1">AsYouType_ {</span>
	<span class="s1">constructor(country_code) {</span>
		<span class="s0">super</span><span class="s1">(country_code, metadata)</span>
	<span class="s1">}</span>
<span class="s1">}</span>

<span class="s0">const </span><span class="s1">USE_NON_GEOGRAPHIC_COUNTRY_CODE = </span><span class="s0">false</span>

<span class="s1">describe(</span><span class="s2">'AsYouType'</span><span class="s1">, () =&gt; {</span>
	<span class="s1">it(</span><span class="s2">'should use &quot;national_prefix_formatting_rule&quot;'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// With national prefix (full).</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">).input(</span><span class="s2">'88005553535'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (800) 555-35-35'</span><span class="s1">)</span>
		<span class="s3">// With national prefix (partial).</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">).input(</span><span class="s2">'880055535'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (800) 555-35'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should populate national number template (digit by digit)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s3">// formatter.formatter.template.should.equal('x (xxx) xxx-xxxx')</span>
		<span class="s1">expect(formatter.formatter.template).to.equal(</span><span class="s2">'x xxx-xxxx'</span><span class="s1">)</span>
		<span class="s3">// formatter.formatter.populatedNationalNumberTemplate.should.equal('1 (xxx) xxx-xxxx')</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.equal(</span><span class="s2">'1 xxx-xxxx'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'213'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.equal(</span><span class="s2">'1 (213) xxx-xxxx'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3734253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.equal(</span><span class="s2">'1 (213) 373-4253'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should populate international number template (digit by digit) (default country)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.be.undefined</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.be.undefined</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">''</span><span class="s1">)).to.equal(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.be.undefined</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.be.undefined</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'+'</span><span class="s1">)).to.equal(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'x'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.be.undefined</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.be.undefined</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xx'</span><span class="s1">)</span>
		<span class="s3">// Hasn't started formatting the phone number using the template yet.</span>
		<span class="s3">// formatter.formatter.template.should.equal('xx xxx xxx xxxx')</span>
		<span class="s1">expect(formatter.formatter.template).to.equal(</span><span class="s2">'xx xxx xxxx'</span><span class="s1">)</span>
		<span class="s3">// formatter.formatter.populatedNationalNumberTemplate.should.equal('xxx xxx xxxx')</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.equal(</span><span class="s2">'xxx xxxx'</span><span class="s1">)</span>
		<span class="s3">// Has some national number digits, starts formatting the phone number using the template.</span>
		<span class="s1">formatter.input(</span><span class="s2">'213'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.equal(</span><span class="s2">'213 xxx xxxx'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3734253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.equal(</span><span class="s2">'213 373 4253'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should populate international number template (digit by digit)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatter.formatter.template).to.be.undefined</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.be.undefined</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">''</span><span class="s1">)).to.equal(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.be.undefined</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.be.undefined</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'+'</span><span class="s1">)).to.equal(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.be.undefined</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.be.undefined</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s3">// formatter.formatter.template.should.equal('xx xxx xxx xxxx')</span>
		<span class="s1">expect(formatter.formatter.template).to.equal(</span><span class="s2">'xx xxx xxxx'</span><span class="s1">)</span>
		<span class="s3">// Hasn't yet started formatting the phone number using the template.</span>
		<span class="s3">// formatter.formatter.populatedNationalNumberTemplate.should.equal('xxx xxx xxxx')</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.equal(</span><span class="s2">'xxx xxxx'</span><span class="s1">)</span>
		<span class="s3">// Has some national number digits, starts formatting the phone number using the template.</span>
		<span class="s1">formatter.input(</span><span class="s2">'213'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.equal(</span><span class="s2">'213 xxx xxxx'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3734253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.equal(</span><span class="s2">'213 373 4253'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should populate national number template (attempt to format complete number)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'12133734253'</span><span class="s1">)).to.equal(</span><span class="s2">'1 (213) 373-4253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.equal(</span><span class="s2">'x (xxx) xxx-xxxx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.equal(</span><span class="s2">'1 (213) 373-4253'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse and format phone numbers as you type'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// International number test</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType().input(</span><span class="s2">'+12133734'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213 373 4'</span><span class="s1">)</span>
		<span class="s3">// Local number test</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">).input(</span><span class="s2">'2133734'</span><span class="s1">)).to.equal(</span><span class="s2">'(213) 373-4'</span><span class="s1">)</span>

		<span class="s3">// US national number retains national prefix.</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">).input(</span><span class="s2">'12133734'</span><span class="s1">)).to.equal(</span><span class="s2">'1 (213) 373-4'</span><span class="s1">)</span>

		<span class="s3">// US national number retains national prefix (full number).</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">).input(</span><span class="s2">'12133734253'</span><span class="s1">)).to.equal(</span><span class="s2">'1 (213) 373-4253'</span><span class="s1">)</span>

		<span class="s0">let </span><span class="s1">formatter</span>

		<span class="s3">// // Should discard national prefix from a &quot;complete&quot; phone number.</span>
		<span class="s3">// new AsYouType('RU').input('8800555353').should.equal('880 055-53-53')</span>

		<span class="s3">// Shouldn't extract national prefix when inputting in international format.</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">).input(</span><span class="s2">'+7800555353'</span><span class="s1">)).to.equal(</span><span class="s2">'+7 800 555 35 3'</span><span class="s1">)</span>

		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'CH'</span><span class="s1">).input(</span><span class="s2">'044-668-1'</span><span class="s1">)).to.equal(</span><span class="s2">'044 668 1'</span><span class="s1">)</span>

		<span class="s3">// Test International phone number (international)</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>

		<span class="s3">// formatter.valid.should.be.false</span>
		<span class="s1">expect(type(formatter.getCountry())).to.equal(</span><span class="s2">'undefined'</span><span class="s1">)</span>
		<span class="s1">expect(type(formatter.getCountryCallingCode())).to.equal(</span><span class="s2">'undefined'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">''</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'+'</span><span class="s1">)).to.equal(</span><span class="s2">'+'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.false</span>
		<span class="s1">expect(type(formatter.getCountry())).to.equal(</span><span class="s2">'undefined'</span><span class="s1">)</span>
		<span class="s1">expect(type(formatter.getCountryCallingCode())).to.equal(</span><span class="s2">'undefined'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'x'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.false</span>
		<span class="s1">expect(type(formatter.getCountry())).to.equal(</span><span class="s2">'undefined'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountryCallingCode()).to.equal(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xx'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'2'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 2'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xx x'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.false</span>
		<span class="s1">expect(type(formatter.getCountry())).to.equal(</span><span class="s2">'undefined'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 21'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">' '</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213 3'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213 33'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213 333'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'4'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213 333 4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'4'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213 333 44'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'4'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213 333 444'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.false</span>
		<span class="s1">expect(type(formatter.getCountry())).to.equal(</span><span class="s2">'undefined'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'4'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213 333 4444'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.true</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s3">// This one below contains &quot;punctuation spaces&quot;</span>
		<span class="s3">// along with the regular spaces</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xx xxx xxx xxxx'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'5'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 21333344445'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.false</span>
		<span class="s1">expect(formatter.getCountry()).to.be.undefined</span>
		<span class="s1">expect(formatter.getCountryCallingCode()).to.equal(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.be.undefined</span>

		<span class="s3">// Check that clearing an international formatter</span>
		<span class="s3">// also clears country metadata.</span>

		<span class="s1">formatter.reset()</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'+'</span><span class="s1">)).to.equal(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'7'</span><span class="s1">)).to.equal(</span><span class="s2">'+7'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'+7 9'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'99 111 22 33'</span><span class="s1">)).to.equal(</span><span class="s2">'+7 999 111 22 33'</span><span class="s1">)</span>

		<span class="s3">// Test Switzerland phone numbers</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'CH'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">' '</span><span class="s1">)).to.equal(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0'</span><span class="s1">)).to.equal(</span><span class="s2">'0'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'4'</span><span class="s1">)).to.equal(</span><span class="s2">'04'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">' '</span><span class="s1">)).to.equal(</span><span class="s2">'04'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'-'</span><span class="s1">)).to.equal(</span><span class="s2">'04'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'4'</span><span class="s1">)).to.equal(</span><span class="s2">'044'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'-'</span><span class="s1">)).to.equal(</span><span class="s2">'044'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'6'</span><span class="s1">)).to.equal(</span><span class="s2">'044 6'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'6'</span><span class="s1">)).to.equal(</span><span class="s2">'044 66'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'044 668'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'-'</span><span class="s1">)).to.equal(</span><span class="s2">'044 668'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'044 668 1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'044 668 18'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.false</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'CH'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.equal(</span><span class="s2">'xxx xxx xx xx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xxx xx'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">' 00'</span><span class="s1">)).to.equal(</span><span class="s2">'044 668 18 00'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.true</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'CH'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xxx xx xx'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'04466818009'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.false</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'CH'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.be.undefined</span>

		<span class="s3">// Kazakhstan (non-main country for +7 country phone code)</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>

		<span class="s1">formatter.input(</span><span class="s2">'+77172580659'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'KZ'</span><span class="s1">)</span>

		<span class="s3">// Brazil</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'BR'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'11987654321'</span><span class="s1">)).to.equal(</span><span class="s2">'(11) 98765-4321'</span><span class="s1">)</span>

		<span class="s3">// UK (Jersey) (non-main country for +44 country phone code)</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'+447700300000'</span><span class="s1">)).to.equal(</span><span class="s2">'+44 7700 300000'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xxxx xxxxxx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'JE'</span><span class="s1">)</span>

		<span class="s3">// Braces must be part of the template.</span>
		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'88005553535'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (800) 555-35-35'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'x (xxx) xxx-xx-xx'</span><span class="s1">)</span>

		<span class="s3">// Test Russian phone numbers</span>
		<span class="s3">// (with optional national prefix `8`)</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'8'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'8 9'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'8 99'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (999)'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'-'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (999)'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1234'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (999) 123-4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'567'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (999) 123-45-67'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'899912345678'</span><span class="s1">)</span>

		<span class="s3">// Shouldn't strip national prefix if it is optional</span>
		<span class="s3">// and if it's a valid phone number (international).</span>
		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s3">// formatter.input('8005553535').should.equal('(800) 555-35-35')</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'+78005553535'</span><span class="s1">)).to.equal(</span><span class="s2">'+7 800 555 35 35'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNationalNumber()).to.equal(</span><span class="s2">'8005553535'</span><span class="s1">)</span>

		<span class="s3">// Check that clearing an national formatter:</span>
		<span class="s3">//  * doesn't clear country metadata</span>
		<span class="s3">//  * clears all other things</span>

		<span class="s1">formatter.reset()</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'8'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'8 9'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'8 99'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (999)'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'-'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (999)'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1234'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (999) 123-4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'567'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (999) 123-45-67'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'899912345678'</span><span class="s1">)</span>

		<span class="s3">// National prefix should not be prepended</span>
		<span class="s3">// when formatting local NANPA phone numbers.</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">).input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">).input(</span><span class="s2">'12'</span><span class="s1">)).to.equal(</span><span class="s2">'1 2'</span><span class="s1">)</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">).input(</span><span class="s2">'123'</span><span class="s1">)).to.equal(</span><span class="s2">'1 23'</span><span class="s1">)</span>

		<span class="s3">// Bulgaria</span>
		<span class="s3">// (should not prepend national prefix `0`)</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'BG'</span><span class="s1">).input(</span><span class="s2">'111 222 3'</span><span class="s1">)).to.equal(</span><span class="s2">'1112223'</span><span class="s1">)</span>

		<span class="s3">// Deutchland</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType().input(</span><span class="s2">'+4915539898001'</span><span class="s1">)).to.equal(</span><span class="s2">'+49 15539 898001'</span><span class="s1">)</span>

		<span class="s3">// KZ detection</span>
		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">formatter.input(</span><span class="s2">'+7 702 211 1111'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'KZ'</span><span class="s1">)</span>
		<span class="s3">// formatter.valid.should.equal(true)</span>

		<span class="s3">// New Zealand formatting fix (issue #89)</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'NZ'</span><span class="s1">).input(</span><span class="s2">'0212'</span><span class="s1">)).to.equal(</span><span class="s2">'021 2'</span><span class="s1">)</span>

		<span class="s3">// South Korea</span>
		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'+82111111111'</span><span class="s1">)).to.equal(</span><span class="s2">'+82 11 111 1111'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xx xxx xxxx'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should filter out formats that require a national prefix and no national prefix has been input'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Afghanistan.</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'AF'</span><span class="s1">)</span>

		<span class="s3">// No national prefix, and national prefix is required in the format.</span>
		<span class="s3">// (not `&quot;national_prefix_is_optional_when_formatting&quot;: true`)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'44444444'</span><span class="s1">)).to.equal(</span><span class="s2">'44444444'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.be.undefined</span>

		<span class="s3">// With national prefix</span>
		<span class="s1">expect(formatter.reset().input(</span><span class="s2">'044444444'</span><span class="s1">)).to.equal(</span><span class="s2">'044 444 444'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.equal(</span><span class="s2">'xxx xxx xxxx'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work when a digit is not a national prefix but a part of a valid national number'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// In Russia, `8` could be both a valid national prefix</span>
		<span class="s3">// and a part of a valid national number.</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s3">// The formatter could try both variants:</span>
		<span class="s3">// with extracting national prefix</span>
		<span class="s3">// and without extracting it,</span>
		<span class="s3">// and then choose whichever way has `this.matchingFormats`.</span>
		<span class="s3">// Or there could be two instances of the formatter:</span>
		<span class="s3">// one that extracts national prefix and one that doesn't,</span>
		<span class="s3">// and then the one that has `this.matchingFormats` would be</span>
		<span class="s3">// used to format the phone number.</span>
		<span class="s3">// Something like an option `extractNationalPrefix: false`</span>
		<span class="s3">// and creating `this.withNationalPrefixFormatter = new AsYouType(this.defaultCountry || this.defaultCallingCode, { metadata, extractNationalPrefix: false })`</span>
		<span class="s3">// and something like `this.withNationalPrefixFormatter.input(nextDigits)` in `input(nextDigits)`.</span>
		<span class="s3">// But, for this specific case, it's not required:</span>
		<span class="s3">// in Russia, people are used to inputting `800` numbers with national prefix `8`:</span>
		<span class="s3">// `8 800 555 35 35`.</span>
		<span class="s3">// formatter.input('8005553535').should.equal('(800) 555-35-35')</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'8005553535'</span><span class="s1">)).to.equal(</span><span class="s2">'8005553535'</span><span class="s1">)</span>
		<span class="s1">formatter.reset()</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'+78005553535'</span><span class="s1">)).to.equal(</span><span class="s2">'+7 800 555 35 35'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should match formats that require a national prefix and no national prefix has been input (national prefix is mandatory for a format)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'FR'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'612345678'</span><span class="s1">)).to.equal(</span><span class="s2">'612345678'</span><span class="s1">)</span>
		<span class="s1">formatter.reset()</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0612345678'</span><span class="s1">)).to.equal(</span><span class="s2">'06 12 34 56 78'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should match formats that require a national prefix and no national prefix has been input (national prefix is not mandatory for a format)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s3">// Without national prefix.</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9991234567'</span><span class="s1">)).to.equal(</span><span class="s2">'999 123-45-67'</span><span class="s1">)</span>
		<span class="s1">formatter.reset()</span>
		<span class="s3">// With national prefix.</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'89991234567'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (999) 123-45-67'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should not use `national_prefix_formatting_rule` when formatting international phone numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Brazil.</span>
		<span class="s3">// `national_prefix_formatting_rule` is `($1)`.</span>
		<span class="s3">// Should not add braces around `12` when being input in international format.</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType().input(</span><span class="s2">'+55123456789'</span><span class="s1">)).to.equal(</span><span class="s2">'+55 12 3456 789'</span><span class="s1">)</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'BR'</span><span class="s1">).input(</span><span class="s2">'+55123456789'</span><span class="s1">)).to.equal(</span><span class="s2">'+55 12 3456 789'</span><span class="s1">)</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'BR'</span><span class="s1">).input(</span><span class="s2">'123456789'</span><span class="s1">)).to.equal(</span><span class="s2">'(12) 3456-789'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should support incorrectly entered international phone numbers (with a national prefix)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">let </span><span class="s1">formatter</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'+1 1 877 215 5230'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 1 877 215 5230'</span><span class="s1">)</span>
		<span class="s3">// formatter.input('+1 1 877 215 5230').should.equal('+1 1 8772155230')</span>
		<span class="s1">expect(formatter.getNationalNumber()).to.equal(</span><span class="s2">'8772155230'</span><span class="s1">)</span>

		<span class="s3">// They've added another number format that has `8` leading digit</span>
		<span class="s3">// and 14 digits. Maybe it's something related to Kazakhstan.</span>
		<span class="s3">// formatter = new AsYouType()</span>
		<span class="s3">// formatter.input('+78800555353').should.equal('+7 880 055 53 53')</span>
		<span class="s3">// formatter.input('5').should.equal('+7 8 800 555 35 35')</span>
		<span class="s3">// formatter.getNationalNumber().should.equal('8005553535')</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return a partial template for current value'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">asYouType = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">)</span>

		<span class="s1">expect(asYouType.input(</span><span class="s2">''</span><span class="s1">)).to.equal(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(asYouType.getTemplate()).to.equal(</span><span class="s2">''</span><span class="s1">)</span>

		<span class="s1">expect(asYouType.input(</span><span class="s2">'2'</span><span class="s1">)).to.equal(</span><span class="s2">'2'</span><span class="s1">)</span>
		<span class="s3">// asYouType.getTemplate().should.equal('x')</span>
		<span class="s3">// Doesn't format for a single digit.</span>
		<span class="s1">expect(asYouType.getTemplate()).to.equal(</span><span class="s2">'x'</span><span class="s1">)</span>

		<span class="s1">expect(asYouType.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'21'</span><span class="s1">)</span>
		<span class="s1">expect(asYouType.getTemplate()).to.equal(</span><span class="s2">'xx'</span><span class="s1">)</span>

		<span class="s1">expect(asYouType.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'(213)'</span><span class="s1">)</span>
		<span class="s1">expect(asYouType.getTemplate()).to.equal(</span><span class="s2">'(xxx)'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">`should fall back to the default country`</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'8'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'8 9'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'8 99'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (999)'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.false</span>
		<span class="s1">expect(formatter.formatter.template).to.equal(</span><span class="s2">'x (xxx) xxx-xx-xx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s3">// formatter.getCountryCallingCode().should.equal('7')</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'000000000000'</span><span class="s1">)).to.equal(</span><span class="s2">'8999000000000000'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.false</span>
		<span class="s1">expect(formatter.formatter.template).to.be.undefined</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s3">// formatter.getCountryCallingCode().should.equal('7')</span>

		<span class="s1">formatter.reset()</span>

		<span class="s3">// formatter.valid.should.be.false</span>
		<span class="s1">expect(formatter.formatter.template).to.be.undefined</span>
		<span class="s1">expect(formatter.getCountry()).to.be.undefined</span>
		<span class="s3">// formatter.getCountryCallingCode().should.equal('7')</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'+1-213-373-4253'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213 373 4253'</span><span class="s1">)</span>

		<span class="s3">// formatter.valid.should.be.true</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xx xxx xxx xxxx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountryCallingCode()).to.equal(</span><span class="s2">'1'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work in edge cases'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">let </span><span class="s1">formatter</span>
		<span class="s0">let </span><span class="s1">thrower</span>

		<span class="s3">// No metadata</span>
		<span class="s1">thrower = () =&gt; </span><span class="s0">new </span><span class="s1">AsYouType_(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">expect(thrower).to.throw(</span><span class="s2">'`metadata` argument not passed'</span><span class="s1">)</span>

		<span class="s3">// Second '+' sign</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'+'</span><span class="s1">)).to.equal(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'7'</span><span class="s1">)).to.equal(</span><span class="s2">'+7'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'+'</span><span class="s1">)).to.equal(</span><span class="s2">'+7'</span><span class="s1">)</span>

		<span class="s3">// Out-of-position '+' sign</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'8'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'+'</span><span class="s1">)).to.equal(</span><span class="s2">'8'</span><span class="s1">)</span>

		<span class="s3">// No format matched</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'88005553535'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (800) 555-35-35'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0'</span><span class="s1">)).to.equal(</span><span class="s2">'880055535350'</span><span class="s1">)</span>

		<span class="s3">// Invalid country phone code</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'+0123'</span><span class="s1">)).to.equal(</span><span class="s2">'+0123'</span><span class="s1">)</span>

		<span class="s3">// No country specified and not an international number</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'88005553535'</span><span class="s1">)).to.equal(</span><span class="s2">'88005553535'</span><span class="s1">)</span>

		<span class="s3">// Extract national prefix when no `national_prefix` is set</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'AD'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'155555'</span><span class="s1">)).to.equal(</span><span class="s2">'155 555'</span><span class="s1">)</span>

		<span class="s3">// Typing nonsense</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>

		<span class="s1">expect(formatter.input(</span><span class="s2">'+1abc2'</span><span class="s1">)).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>

		<span class="s3">// Should reset default country when explicitly</span>
		<span class="s3">// typing in an international phone number</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>

		<span class="s1">formatter.input(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(type(formatter.getCountry())).to.equal(</span><span class="s2">'undefined'</span><span class="s1">)</span>
		<span class="s1">expect(type(formatter.getCountryCallingCode())).to.equal(</span><span class="s2">'undefined'</span><span class="s1">)</span>

		<span class="s3">// Country not inferrable from the phone number,</span>
		<span class="s3">// while the phone number itself can already be formatted &quot;completely&quot;.</span>

		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>

		<span class="s1">formatter.input(</span><span class="s2">'+12223333333'</span><span class="s1">)</span>
		<span class="s1">expect(type(formatter.getCountry())).to.equal(</span><span class="s2">'undefined'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountryCallingCode()).to.equal(</span><span class="s2">'1'</span><span class="s1">)</span>

		<span class="s3">// Reset a chosen format when it no longer applies given the new leading digits.</span>
		<span class="s3">// If Google changes metadata for England then this test might not cover the case.</span>
		<span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'GB'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0845'</span><span class="s1">)).to.equal(</span><span class="s2">'0845'</span><span class="s1">)</span>
		<span class="s3">// New leading digits don't match the format previously chosen.</span>
		<span class="s3">// Reset the format.</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0'</span><span class="s1">)).to.equal(</span><span class="s2">'0845 0'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should choose between matching formats based on the absence or presence of a national prefix'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// The first matching format:</span>
		<span class="s3">// {</span>
		<span class="s3">//    &quot;pattern&quot;: &quot;(\\d{2})(\\d{5,6})&quot;,</span>
		<span class="s3">//    &quot;leading_digits_patterns&quot;: [</span>
		<span class="s3">//       &quot;(?:10|2[0-57-9])[19]&quot;,</span>
		<span class="s3">//       &quot;(?:10|2[0-57-9])(?:10|9[56])&quot;,</span>
		<span class="s3">//       &quot;(?:10|2[0-57-9])(?:100|9[56])&quot;</span>
		<span class="s3">//    ],</span>
		<span class="s3">//    &quot;national_prefix_formatting_rule&quot;: &quot;0$1&quot;,</span>
		<span class="s3">//    &quot;format&quot;: &quot;$1 $2&quot;,</span>
		<span class="s3">//    &quot;domestic_carrier_code_formatting_rule&quot;: &quot;$CC $FG&quot;</span>
		<span class="s3">// }</span>
		<span class="s3">//</span>
		<span class="s3">// The second matching format:</span>
		<span class="s3">// {</span>
		<span class="s3">//    &quot;pattern&quot;: &quot;(\\d{2})(\\d{4})(\\d{4})&quot;,</span>
		<span class="s3">//    &quot;leading_digits_patterns&quot;: [</span>
		<span class="s3">//       &quot;10|2(?:[02-57-9]|1[1-9])&quot;,</span>
		<span class="s3">//       &quot;10|2(?:[02-57-9]|1[1-9])&quot;,</span>
		<span class="s3">//       &quot;10[0-79]|2(?:[02-57-9]|1[1-79])|(?:10|21)8(?:0[1-9]|[1-9])&quot;</span>
		<span class="s3">//    ],</span>
		<span class="s3">//    &quot;national_prefix_formatting_rule&quot;: &quot;0$1&quot;,</span>
		<span class="s3">//    &quot;national_prefix_is_optional_when_formatting&quot;: true,</span>
		<span class="s3">//    &quot;format&quot;: &quot;$1 $2 $3&quot;,</span>
		<span class="s3">//    &quot;domestic_carrier_code_formatting_rule&quot;: &quot;$CC $FG&quot;</span>
		<span class="s3">// }</span>
		<span class="s3">//</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'CN'</span><span class="s1">)</span>
		<span class="s3">// National prefix has been input.</span>
		<span class="s3">// Chooses the first format.</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'01010000'</span><span class="s1">)).to.equal(</span><span class="s2">'010 10000'</span><span class="s1">)</span>
		<span class="s1">formatter.reset()</span>
		<span class="s3">// No national prefix has been input,</span>
		<span class="s3">// and `national_prefix_for_parsing` not matched.</span>
		<span class="s3">// The first format won't match, because it doesn't have</span>
		<span class="s3">// `&quot;national_prefix_is_optional_when_formatting&quot;: true`.</span>
		<span class="s3">// The second format will match, because it does have</span>
		<span class="s3">// `&quot;national_prefix_is_optional_when_formatting&quot;: true`.</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1010000'</span><span class="s1">)).to.equal(</span><span class="s2">'10 1000 0'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should not accept phone number extensions'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType().input(</span><span class="s2">'+1-213-373-4253 ext. 123'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 213 373 4253'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse non-European digits'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType().input(</span><span class="s2">'+'</span><span class="s1">)).to.equal(</span><span class="s2">'+1 212 232 3232'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return a PhoneNumber instance'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'BR'</span><span class="s1">)</span>

		<span class="s3">// No country calling code.</span>
		<span class="s1">expect(formatter.getNumber()).to.be.undefined</span>

		<span class="s1">formatter.input(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s3">// No national number digits.</span>
		<span class="s1">expect(formatter.getNumber()).to.be.undefined</span>

		<span class="s1">formatter.input(</span><span class="s2">'213-373-4253'</span><span class="s1">)</span>

		<span class="s0">let </span><span class="s1">phoneNumber = formatter.getNumber()</span>
		<span class="s1">expect(phoneNumber.country).to.equal(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.countryCallingCode).to.equal(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.number).to.equal(</span><span class="s2">'+12133734253'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.nationalNumber).to.equal(</span><span class="s2">'2133734253'</span><span class="s1">)</span>

		<span class="s1">formatter.reset()</span>
		<span class="s1">formatter.input(</span><span class="s2">'+1-113-373-4253'</span><span class="s1">)</span>

		<span class="s1">phoneNumber = formatter.getNumber()</span>
		<span class="s1">expect(phoneNumber.country).to.be.undefined</span>
		<span class="s1">expect(phoneNumber.countryCallingCode).to.equal(</span><span class="s2">'1'</span><span class="s1">)</span>

		<span class="s3">// An incorrect NANPA international phone number.</span>
		<span class="s3">// (contains national prefix in an international phone number)</span>

		<span class="s1">formatter.reset()</span>
		<span class="s1">formatter.input(</span><span class="s2">'+1-1'</span><span class="s1">)</span>

		<span class="s3">// Before leading digits &lt; 3 matching was implemented:</span>
		<span class="s3">//</span>
		<span class="s3">// phoneNumber = formatter.getNumber()</span>
		<span class="s3">// expect(phoneNumber).to.not.be.undefined</span>
		<span class="s3">//</span>
		<span class="s3">// formatter.input('1')</span>
		<span class="s3">// phoneNumber = formatter.getNumber()</span>
		<span class="s3">// expect(phoneNumber.country).to.be.undefined</span>
		<span class="s3">// phoneNumber.countryCallingCode.should.equal('1')</span>
		<span class="s3">// phoneNumber.number.should.equal('+111')</span>

		<span class="s3">// After leading digits &lt; 3 matching was implemented:</span>
		<span class="s3">//</span>
		<span class="s1">phoneNumber = formatter.getNumber()</span>
		<span class="s1">expect(phoneNumber).to.be.undefined</span>
		<span class="s3">//</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">phoneNumber = formatter.getNumber()</span>
		<span class="s1">expect(phoneNumber.country).to.be.undefined</span>
		<span class="s1">expect(phoneNumber.countryCallingCode).to.equal(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.number).to.equal(</span><span class="s2">'+11'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work with countries that add digits to national (significant) number'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// When formatting Argentinian mobile numbers in international format,</span>
		<span class="s3">// a `9` is prepended, when compared to national format.</span>
		<span class="s0">const </span><span class="s1">asYouType = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'AR'</span><span class="s1">)</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'+5493435551212'</span><span class="s1">)).to.equal(</span><span class="s2">'+54 9 3435 55 1212'</span><span class="s1">)</span>
		<span class="s1">asYouType.reset()</span>
		<span class="s3">// Digits shouldn't be changed when formatting in national format.</span>
		<span class="s3">// (no `9` is prepended).</span>
		<span class="s3">// First parses national (significant) number by prepending `9` to it</span>
		<span class="s3">// and stripping `15` from it.</span>
		<span class="s3">// Then uses `$2 15-$3-$4` format that strips the leading `9`</span>
		<span class="s3">// and adds `15`.</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'0343515551212'</span><span class="s1">)).to.equal(</span><span class="s2">'03435 15-55-1212'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return non-formatted phone number when no format matches and national (significant) number has digits added'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// When inputting &quot;0343515551212999&quot; Argentinian mobile number,</span>
		<span class="s3">// the parsed national (significant) number is &quot;93435551212999&quot;.</span>
		<span class="s3">// There, one can see how it stripped &quot;0&quot; national prefix and prepended a &quot;9&quot;,</span>
		<span class="s3">// because that's how it is instructed to do in Argentina's metadata.</span>
		<span class="s3">//</span>
		<span class="s3">// So in this case, national (significant) number doesn't match the input</span>
		<span class="s3">// and, therefore, `state.nationalSignificantNumberIsModified` flag is `true`.</span>
		<span class="s3">//</span>
		<span class="s0">const </span><span class="s1">asYouType = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'AR'</span><span class="s1">)</span>
		<span class="s3">// This line checks that the formatter didn't alter the output digits compared to the input digits.</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'0343515551212999'</span><span class="s1">)).to.equal(</span><span class="s2">'0343515551212999'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should format Argentina numbers (starting with 011) (digit by digit)'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Inputting a number digit-by-digit and as a whole a two different cases</span>
		<span class="s3">// in case of this library compared to Google's `libphonenumber`</span>
		<span class="s3">// that always inputs a number digit-by-digit.</span>
		<span class="s3">// https://gitlab.com/catamphetamine/libphonenumber-js/-/issues/23</span>
		<span class="s3">// nextDigits 0111523456789</span>
		<span class="s3">// nationalNumber 91123456789</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'AR'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0'</span><span class="s1">)).to.equal(</span><span class="s2">'0'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'x'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'01'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'011'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'011 1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx x'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'5'</span><span class="s1">)).to.equal(</span><span class="s2">'011 15'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'2'</span><span class="s1">)).to.equal(</span><span class="s2">'011 152'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xxx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'011 1523'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xxxx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'4'</span><span class="s1">)).to.equal(</span><span class="s2">'011 1523-4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xxxx-x'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'5'</span><span class="s1">)).to.equal(</span><span class="s2">'011 1523-45'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xxxx-xx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'6'</span><span class="s1">)).to.equal(</span><span class="s2">'011 1523-456'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xxxx-xxx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'7'</span><span class="s1">)).to.equal(</span><span class="s2">'011 1523-4567'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xxxx-xxxx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'011152345678'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxxxxxxxxxxx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'011 15-2345-6789'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xx-xxxx-xxxx'</span><span class="s1">)</span>
		<span class="s3">// Private property (not public API).</span>
		<span class="s1">expect(formatter.state.nationalSignificantNumber).to.equal(</span><span class="s2">'91123456789'</span><span class="s1">)</span>
		<span class="s3">// Private property (not public API).</span>
		<span class="s3">// `formatter.digits` is not always `formatter.nationalPrefix`</span>
		<span class="s3">// plus `formatter.nationalNumberDigits`.</span>
		<span class="s1">expect(formatter.state.nationalPrefix).to.equal(</span><span class="s2">'0'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isPossible()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isValid()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should format Argentina numbers (starting with 011)'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Inputting a number digit-by-digit and as a whole a two different cases</span>
		<span class="s3">// in case of this library compared to Google's `libphonenumber`</span>
		<span class="s3">// that always inputs a number digit-by-digit.</span>
		<span class="s3">// https://gitlab.com/catamphetamine/libphonenumber-js/-/issues/23</span>
		<span class="s3">// nextDigits 0111523456789</span>
		<span class="s3">// nationalNumber 91123456789</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'AR'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0111523456789'</span><span class="s1">)).to.equal(</span><span class="s2">'011 15-2345-6789'</span><span class="s1">)</span>
		<span class="s3">// Private property (not public API).</span>
		<span class="s1">expect(formatter.state.nationalSignificantNumber).to.equal(</span><span class="s2">'91123456789'</span><span class="s1">)</span>
		<span class="s3">// Private property (not public API).</span>
		<span class="s3">// `formatter.digits` is not always `formatter.nationalPrefix`</span>
		<span class="s3">// plus `formatter.nationalNumberDigits`.</span>
		<span class="s1">expect(formatter.state.nationalPrefix).to.equal(</span><span class="s2">'0'</span><span class="s1">)</span>
		<span class="s3">// expect(formatter.nationalPrefix).to.be.undefined</span>
		<span class="s1">expect(formatter.isPossible()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isValid()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s3">// https://gitlab.com/catamphetamine/react-phone-number-input/-/issues/93</span>
	<span class="s1">it(</span><span class="s2">'should format Indonesian numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'ID'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getChars()).to.equal(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s3">// Before leading digits &lt; 3 matching was implemented:</span>
		<span class="s3">// formatter.input('081').should.equal('(081)')</span>
		<span class="s3">// After leading digits &lt; 3 matching was implemented:</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'081'</span><span class="s1">)).to.equal(</span><span class="s2">'081'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should prepend `prefixBeforeNationalSignificantNumberThatIsNotNationalPrefix` (not a complete number)'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// A country having `national_prefix_for_parsing` with a &quot;capturing group&quot;.</span>
		<span class="s3">// National prefix is either not used in a format or is optional.</span>
		<span class="s3">// Input phone number without a national prefix.</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'AU'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1831130345678'</span><span class="s1">)).to.equal(</span><span class="s2">'1831 1303 456 78'</span><span class="s1">)</span>
		<span class="s3">// Private property (not public API).</span>
		<span class="s1">expect(formatter.state.nationalSignificantNumber).to.equal(</span><span class="s2">'130345678'</span><span class="s1">)</span>
		<span class="s3">// Private property (not public API).</span>
		<span class="s3">// `formatter.digits` is not always `formatter.nationalPrefix`</span>
		<span class="s3">// plus `formatter.nationalNumberDigits`.</span>
		<span class="s1">expect(formatter.state.nationalPrefix).to.be.undefined</span>
		<span class="s1">expect(formatter.state.prefixBeforeNationalSignificantNumberThatIsNotNationalPrefix).to.equal(</span><span class="s2">'1831'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should prepend `prefixBeforeNationalSignificantNumberThatIsNotNationalPrefix` (complete number)'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// A country having `national_prefix_for_parsing` with a &quot;capturing group&quot;.</span>
		<span class="s3">// National prefix is either not used in a format or is optional.</span>
		<span class="s3">// Input phone number without a national prefix.</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'AU'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'18311303456789'</span><span class="s1">)).to.equal(</span><span class="s2">'1831 1303 456 789'</span><span class="s1">)</span>
		<span class="s3">// Private property (not public API).</span>
		<span class="s1">expect(formatter.state.nationalSignificantNumber).to.equal(</span><span class="s2">'1303456789'</span><span class="s1">)</span>
		<span class="s3">// Private property (not public API).</span>
		<span class="s3">// `formatter.digits` is not always `formatter.nationalPrefix`</span>
		<span class="s3">// plus `formatter.nationalNumberDigits`.</span>
		<span class="s1">expect(formatter.state.nationalPrefix).to.be.undefined</span>
		<span class="s1">expect(formatter.state.prefixBeforeNationalSignificantNumberThatIsNotNationalPrefix).to.equal(</span><span class="s2">'1831'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work with Mexico numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">asYouType = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'MX'</span><span class="s1">)</span>

		<span class="s3">// Fixed line. International.</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'+52(449)978-000'</span><span class="s1">)).to.equal(</span><span class="s2">'+52 449 978 000'</span><span class="s1">)</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'+52 449 978 0001'</span><span class="s1">)</span>
		<span class="s1">asYouType.reset()</span>

		<span class="s3">// &quot;Dialling tokens 01, 02, 044, 045 and 1 are removed as they are</span>
		<span class="s3">//  no longer valid since August 2019.&quot;</span>
		<span class="s3">// // Fixed line. National. With national prefix &quot;01&quot;.</span>
		<span class="s3">// asYouType.input('01449978000').should.equal('01449 978 000')</span>
		<span class="s3">// asYouType.getTemplate().should.equal('xxxxx xxx xxx')</span>
		<span class="s3">// asYouType.input('1').should.equal('01449 978 0001')</span>
		<span class="s3">// asYouType.getTemplate().should.equal('xxxxx xxx xxxx')</span>
		<span class="s3">// asYouType.reset()</span>

		<span class="s3">// Fixed line. National. Without national prefix.</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'(449)978-000'</span><span class="s1">)).to.equal(</span><span class="s2">'449 978 000'</span><span class="s1">)</span>
		<span class="s1">expect(asYouType.getTemplate()).to.equal(</span><span class="s2">'xxx xxx xxx'</span><span class="s1">)</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'449 978 0001'</span><span class="s1">)</span>
		<span class="s1">expect(asYouType.getTemplate()).to.equal(</span><span class="s2">'xxx xxx xxxx'</span><span class="s1">)</span>
		<span class="s1">asYouType.reset()</span>

		<span class="s3">// Mobile.</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'+52331234567'</span><span class="s1">)).to.equal(</span><span class="s2">'+52 33 1234 567'</span><span class="s1">)</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'+52 33 1234 5678'</span><span class="s1">)</span>
		<span class="s1">asYouType.reset()</span>

		<span class="s3">// &quot;Dialling tokens 01, 02, 044, 045 and 1 are removed as they are</span>
		<span class="s3">//  no longer valid since August 2019.&quot;</span>
		<span class="s3">// // Mobile.</span>
		<span class="s3">// // With `1` prepended before area code to mobile numbers in international format.</span>
		<span class="s3">// asYouType.input('+521331234567').should.equal('+52 133 1234 567')</span>
		<span class="s3">// asYouType.getTemplate().should.equal('xxx xxx xxxx xxx')</span>
		<span class="s3">// // Google's `libphonenumber` seems to not able to format this type of number.</span>
		<span class="s3">// // https://issuetracker.google.com/issues/147938979</span>
		<span class="s3">// asYouType.input('8').should.equal('+52 133 1234 5678')</span>
		<span class="s3">// asYouType.getTemplate().should.equal('xxx xxx xxxx xxxx')</span>
		<span class="s3">// asYouType.reset()</span>
		<span class="s3">//</span>
		<span class="s3">// // Mobile. National. With &quot;044&quot; prefix.</span>
		<span class="s3">// asYouType.input('044331234567').should.equal('04433 1234 567')</span>
		<span class="s3">// asYouType.input('8').should.equal('04433 1234 5678')</span>
		<span class="s3">// asYouType.reset()</span>
		<span class="s3">//</span>
		<span class="s3">// // Mobile. National. With &quot;045&quot; prefix.</span>
		<span class="s3">// asYouType.input('045331234567').should.equal('04533 1234 567')</span>
		<span class="s3">// asYouType.input('8').should.equal('04533 1234 5678')</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should just prepend national prefix if national_prefix_formatting_rule does not produce a suitable number'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// &quot;national_prefix&quot;: &quot;8&quot;</span>
		<span class="s3">// &quot;national_prefix_for_parsing&quot;: &quot;0|80?&quot;</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'BY'</span><span class="s1">)</span>
		<span class="s3">// &quot;national_prefix_formatting_rule&quot;: &quot;8 $1&quot;</span>
		<span class="s3">// That `national_prefix_formatting_rule` isn't used</span>
		<span class="s3">// because the user didn't input national prefix `8`.</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0800123'</span><span class="s1">)).to.equal(</span><span class="s2">'0 800 123'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'x xxx xxx'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should not duplicate area code for certain countries'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// https://github.com/catamphetamine/libphonenumber-js/issues/318</span>
		<span class="s0">const </span><span class="s1">asYouType = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'VI'</span><span class="s1">)</span>
		<span class="s3">// Even though `parse(&quot;3406934&quot;)` would return a</span>
		<span class="s3">// &quot;(340) 340-6934&quot; national number, still</span>
		<span class="s3">// &quot;As You Type&quot; formatter should leave it as &quot;(340) 6934&quot;.</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'340693'</span><span class="s1">)).to.equal(</span><span class="s2">'(340) 693'</span><span class="s1">)</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'4'</span><span class="s1">)).to.equal(</span><span class="s2">'(340) 693-4'</span><span class="s1">)</span>
		<span class="s1">expect(asYouType.input(</span><span class="s2">'123'</span><span class="s1">)).to.equal(</span><span class="s2">'(340) 693-4123'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'shouldn</span><span class="s4">\'</span><span class="s2">t throw when passed a non-existent default country'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'XX'</span><span class="s1">).input(</span><span class="s2">'+78005553535'</span><span class="s1">)).to.equal(</span><span class="s2">'+7 800 555 35 35'</span><span class="s1">)</span>
		<span class="s1">expect(</span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'XX'</span><span class="s1">).input(</span><span class="s2">'88005553535'</span><span class="s1">)).to.equal(</span><span class="s2">'88005553535'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse carrier codes'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'BR'</span><span class="s1">)</span>

		<span class="s1">formatter.input(</span><span class="s2">'0 15 21 5555-5555'</span><span class="s1">)</span>
		<span class="s0">let </span><span class="s1">phoneNumber = formatter.getNumber()</span>
		<span class="s1">expect(phoneNumber.carrierCode).to.equal(</span><span class="s2">'15'</span><span class="s1">)</span>

		<span class="s1">formatter.reset()</span>
		<span class="s1">formatter.input(</span><span class="s2">'+1-213-373-4253'</span><span class="s1">)</span>
		<span class="s1">phoneNumber = formatter.getNumber()</span>
		<span class="s1">expect(phoneNumber.carrierCode).to.be.undefined</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should format when default country calling code is configured'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType({ defaultCallingCode: </span><span class="s2">'7' </span><span class="s1">})</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'88005553535'</span><span class="s1">)).to.equal(</span><span class="s2">'8 (800) 555-35-35'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().countryCallingCode).to.equal(</span><span class="s2">'7'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().country).to.equal(</span><span class="s2">'RU'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'shouldn</span><span class="s4">\'</span><span class="s2">t return PhoneNumber if country calling code hasn</span><span class="s4">\'</span><span class="s2">t been input yet'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">formatter.input(</span><span class="s2">'+80'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber()).to.be.undefined</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should format non-geographic numbering plan phone numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'+'</span><span class="s1">)).to.equal(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'+8'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'7'</span><span class="s1">)).to.equal(</span><span class="s2">'+87'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountry()).to.be.undefined</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0'</span><span class="s1">)).to.equal(</span><span class="s2">'+870'</span><span class="s1">)</span>
		<span class="s0">if </span><span class="s1">(USE_NON_GEOGRAPHIC_COUNTRY_CODE) {</span>
			<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'001'</span><span class="s1">)</span>
		<span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
			<span class="s1">expect(formatter.getCountry()).to.be.undefined</span>
		<span class="s1">}</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'7'</span><span class="s1">)).to.equal(</span><span class="s2">'+870 7'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'7'</span><span class="s1">)).to.equal(</span><span class="s2">'+870 77'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'+870 773'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'+870 773 1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'+870 773 11'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'+870 773 111'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'6'</span><span class="s1">)).to.equal(</span><span class="s2">'+870 773 111 6'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'+870 773 111 63'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'2'</span><span class="s1">)).to.equal(</span><span class="s2">'+870 773 111 632'</span><span class="s1">)</span>
		<span class="s0">if </span><span class="s1">(USE_NON_GEOGRAPHIC_COUNTRY_CODE) {</span>
			<span class="s1">expect(formatter.getNumber().country).to.equal(</span><span class="s2">'001'</span><span class="s1">)</span>
		<span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
			<span class="s1">expect(formatter.getCountry()).to.be.undefined</span>
		<span class="s1">}</span>
		<span class="s1">expect(formatter.getNumber().countryCallingCode).to.equal(</span><span class="s2">'870'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should format non-geographic numbering plan phone numbers (default country calling code)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType({ defaultCallingCode: </span><span class="s2">'870' </span><span class="s1">})</span>
		<span class="s0">if </span><span class="s1">(USE_NON_GEOGRAPHIC_COUNTRY_CODE) {</span>
			<span class="s1">expect(formatter.getNumber().country).to.equal(</span><span class="s2">'001'</span><span class="s1">)</span>
		<span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
			<span class="s1">expect(formatter.getCountry()).to.be.undefined</span>
		<span class="s1">}</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'7'</span><span class="s1">)).to.equal(</span><span class="s2">'7'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'7'</span><span class="s1">)).to.equal(</span><span class="s2">'77'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'773'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'773 1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'773 11'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'773 111'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'6'</span><span class="s1">)).to.equal(</span><span class="s2">'773 111 6'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'773 111 63'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'2'</span><span class="s1">)).to.equal(</span><span class="s2">'773 111 632'</span><span class="s1">)</span>
		<span class="s0">if </span><span class="s1">(USE_NON_GEOGRAPHIC_COUNTRY_CODE) {</span>
			<span class="s1">expect(formatter.getNumber().country).to.equal(</span><span class="s2">'001'</span><span class="s1">)</span>
		<span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
			<span class="s1">expect(formatter.getCountry()).to.be.undefined</span>
		<span class="s1">}</span>
		<span class="s1">expect(formatter.getNumber().countryCallingCode).to.equal(</span><span class="s2">'870'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should not format non-geographic numbering plan phone numbers (default country 001)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'001'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.defaultCountry).to.be.undefined</span>
		<span class="s1">expect(formatter.defaultCallingCode).to.be.undefined</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'7'</span><span class="s1">)).to.equal(</span><span class="s2">'7'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'7'</span><span class="s1">)).to.equal(</span><span class="s2">'77'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'773'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'7731'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'77311'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'773111'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'6'</span><span class="s1">)).to.equal(</span><span class="s2">'7731116'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'77311163'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'2'</span><span class="s1">)).to.equal(</span><span class="s2">'773111632'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountry()).to.be.undefined</span>
		<span class="s1">expect(formatter.getNumber()).to.be.undefined</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return PhoneNumber (should strip national prefix `1` in E.164 value)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'+1111'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().number).to.equal(</span><span class="s2">'+111'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return PhoneNumber with autocorrected international numbers without leading +'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// https://github.com/catamphetamine/libphonenumber-js/issues/316</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'FR'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'33612902554'</span><span class="s1">)).to.equal(</span><span class="s2">'33 6 12 90 25 54'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().country).to.equal(</span><span class="s2">'FR'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().nationalNumber).to.equal(</span><span class="s2">'612902554'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().number).to.equal(</span><span class="s2">'+33612902554'</span><span class="s1">)</span>
		<span class="s3">// Should also strip national prefix.</span>
		<span class="s1">formatter.reset()</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'330612902554'</span><span class="s1">)).to.equal(</span><span class="s2">'33 06 12 90 25 54'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().country).to.equal(</span><span class="s2">'FR'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().nationalNumber).to.equal(</span><span class="s2">'612902554'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().number).to.equal(</span><span class="s2">'+33612902554'</span><span class="s1">)</span>
		<span class="s3">// On second thought, this &quot;prepend default area code&quot; feature won't be added,</span>
		<span class="s3">// because when a user selects &quot;British Virgin Islands&quot; and inputs</span>
		<span class="s3">// &quot;2291234&quot;, then they see &quot;(229) 123-4&quot; which clearly indicates that</span>
		<span class="s3">// they should input the complete phone number (with area code).</span>
		<span class="s3">// So, unless a user completely doesn't understand what they're doing,</span>
		<span class="s3">// they'd input the complete phone number (with area code).</span>
		<span class="s3">// // Should prepend the default area code in British Virgin Islands.</span>
		<span class="s3">// // https://github.com/catamphetamine/react-phone-number-input/issues/335</span>
		<span class="s3">// const formatter2 = new AsYouType('VG')</span>
		<span class="s3">// formatter2.input('2291234').should.equal('(229) 123-4')</span>
		<span class="s3">// formatter2.getNumber().country.should.equal('VG')</span>
		<span class="s3">// formatter2.getNumber().nationalNumber.should.equal('2842291234')</span>
		<span class="s3">// formatter2.getNumber().number.should.equal('+12842291234')</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work with out-of-country dialing prefix (like 00)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'DE'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'00498911196611'</span><span class="s1">)).to.equal(</span><span class="s2">'00 49 89 11196611'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'DE'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.template).to.equal(</span><span class="s2">'xx xx xx xxxxxxxx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.populatedNationalNumberTemplate).to.equal(</span><span class="s2">'89 11196611'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xx xx xx xxxxxxxx'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().country).to.equal(</span><span class="s2">'DE'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().nationalNumber).to.equal(</span><span class="s2">'8911196611'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().number).to.equal(</span><span class="s2">'+498911196611'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'shouldn</span><span class="s4">\'</span><span class="s2">t choose a format when there</span><span class="s4">\'</span><span class="s2">re too many digits for any of them'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'89991112233'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.chosenFormat.format()).to.equal(</span><span class="s2">'$1 $2-$3-$4'</span><span class="s1">)</span>
		<span class="s1">formatter.reset()</span>
		<span class="s1">formatter.input(</span><span class="s2">'899911122334'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.chosenFormat).to.be.undefined</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should get separator after national prefix'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Russia.</span>
		<span class="s3">// Has separator after national prefix.</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s0">const </span><span class="s1">format = formatter.metadata.formats()[</span><span class="s5">0</span><span class="s1">]</span>
		<span class="s1">expect(format.nationalPrefixFormattingRule()).to.equal(</span><span class="s2">'8 ($1)'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.formatter.getSeparatorAfterNationalPrefix(format)).to.equal(</span><span class="s2">' '</span><span class="s1">)</span>
		<span class="s3">// Britain.</span>
		<span class="s3">// Has no separator after national prefix.</span>
		<span class="s0">const </span><span class="s1">formatter2 = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'GB'</span><span class="s1">)</span>
		<span class="s0">const </span><span class="s1">format2 = formatter2.metadata.formats()[</span><span class="s5">0</span><span class="s1">]</span>
		<span class="s1">expect(format2.nationalPrefixFormattingRule()).to.equal(</span><span class="s2">'0$1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter2.formatter.getSeparatorAfterNationalPrefix(format2)).to.equal(</span><span class="s2">''</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return if the number is possible'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// National. Russia.</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isPossible()).to.equal(</span><span class="s0">false</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'8'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isPossible()).to.equal(</span><span class="s0">false</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'8005553535'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isPossible()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'5'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isPossible()).to.equal(</span><span class="s0">false</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return if the number is valid'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// National. Russia.</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isValid()).to.equal(</span><span class="s0">false</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'88005553535'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isValid()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'5'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isValid()).to.equal(</span><span class="s0">false</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return if the number is international'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// National. Russia.</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isInternational()).to.equal(</span><span class="s0">false</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'88005553535'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.isInternational()).to.equal(</span><span class="s0">false</span><span class="s1">)</span>
		<span class="s3">// International. Russia.</span>
		<span class="s0">const </span><span class="s1">formatterInt = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatterInt.isInternational()).to.equal(</span><span class="s0">false</span><span class="s1">)</span>
		<span class="s1">formatterInt.input(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatterInt.isInternational()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">formatterInt.input(</span><span class="s2">'78005553535'</span><span class="s1">)</span>
		<span class="s1">expect(formatterInt.isInternational()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return country calling code part of the number'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// National. Russia.</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountryCallingCode()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'88005553535'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountryCallingCode()).to.be.undefined</span>
		<span class="s3">// International. Russia.</span>
		<span class="s0">const </span><span class="s1">formatterInt = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatterInt.getCountryCallingCode()).to.be.undefined</span>
		<span class="s1">formatterInt.input(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatterInt.getCountryCallingCode()).to.be.undefined</span>
		<span class="s1">formatterInt.input(</span><span class="s2">'7'</span><span class="s1">)</span>
		<span class="s1">expect(formatterInt.getCountryCallingCode()).to.equal(</span><span class="s2">'7'</span><span class="s1">)</span>
		<span class="s1">formatterInt.input(</span><span class="s2">'8005553535'</span><span class="s1">)</span>
		<span class="s1">expect(formatterInt.getCountryCallingCode()).to.equal(</span><span class="s2">'7'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return the country of the number'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// National. Russia.</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountry()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'8'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'8005553535'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getCountry()).to.equal(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s3">// International. Austria.</span>
		<span class="s0">const </span><span class="s1">formatterInt = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatterInt.getCountry()).to.be.undefined</span>
		<span class="s1">formatterInt.input(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatterInt.getCountry()).to.be.undefined</span>
		<span class="s1">formatterInt.input(</span><span class="s2">'43'</span><span class="s1">)</span>
		<span class="s1">expect(formatterInt.getCountry()).to.equal(</span><span class="s2">'AT'</span><span class="s1">)</span>
		<span class="s3">// International. USA.</span>
		<span class="s0">const </span><span class="s1">formatterIntRu = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatterIntRu.getCountry()).to.be.undefined</span>
		<span class="s1">formatterIntRu.input(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatterIntRu.getCountry()).to.be.undefined</span>
		<span class="s1">formatterIntRu.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatterIntRu.getCountry()).to.be.undefined</span>
		<span class="s1">formatterIntRu.input(</span><span class="s2">'2133734253'</span><span class="s1">)</span>
		<span class="s1">expect(formatterIntRu.getCountry()).to.equal(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">formatterIntRu.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatterIntRu.getCountry()).to.be.undefined</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse a long IDD prefix'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'AU'</span><span class="s1">)</span>
		<span class="s3">// `14880011` is a long IDD prefix in Australia.</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'4'</span><span class="s1">)).to.equal(</span><span class="s2">'14'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'148'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'8'</span><span class="s1">)).to.equal(</span><span class="s2">'1488'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0'</span><span class="s1">)).to.equal(</span><span class="s2">'14880'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0'</span><span class="s1">)).to.equal(</span><span class="s2">'148800'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'1488001'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'14880011'</span><span class="s1">)</span>
		<span class="s3">// As if were calling US using `14880011` IDD prefix,</span>
		<span class="s3">// though that prefix could mean something else.</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'14880011 1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'2'</span><span class="s1">)).to.equal(</span><span class="s2">'14880011 1 2'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'14880011 1 21'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'14880011 1 213'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return the phone number characters entered by the user'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getChars()).to.equal(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'+123'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getChars()).to.equal(</span><span class="s2">'+123'</span><span class="s1">)</span>
		<span class="s1">formatter.reset()</span>
		<span class="s1">formatter.input(</span><span class="s2">'123'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getChars()).to.equal(</span><span class="s2">'123'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s3">// A test confirming the case when input `&quot;11&quot;` for country `&quot;US&quot;`</span>
	<span class="s3">// produces `value` `&quot;+11&quot;`.</span>
	<span class="s3">// https://gitlab.com/catamphetamine/react-phone-number-input/-/issues/113</span>
	<span class="s1">it(</span><span class="s2">'should determine the national (significant) part correctly when input with national prefix in US'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s3">// As soon as the user has input `&quot;11&quot;`, no `format` matches</span>
		<span class="s3">// those &quot;national number&quot; digits in the `&quot;US&quot;` country metadata.</span>
		<span class="s3">// Since no `format` matches, the number doesn't seem like a valid one,</span>
		<span class="s3">// so it attempts to see if the user &quot;forgot&quot; to input a `&quot;+&quot;` at the start.</span>
		<span class="s3">// And it looks like they might've to.</span>
		<span class="s3">// So it acts as if the leading `&quot;+&quot;` is there,</span>
		<span class="s3">// as if the user's input is `&quot;+11&quot;`.</span>
		<span class="s3">// See `AsYouType.fixMissingPlus()` function.</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1 122 222 2222 3'</span><span class="s1">)).to.equal(</span><span class="s2">'1 1 222 222 2223'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().nationalNumber).to.equal(</span><span class="s2">'2222222223'</span><span class="s1">)</span>
	<span class="s1">})</span>
<span class="s1">})</span>

<span class="s1">describe(</span><span class="s2">'AsYouType.getNumberValue()'</span><span class="s1">, () =&gt; {</span>
	<span class="s1">it(</span><span class="s2">'should return E.164 number value (national number, with national prefix, default country: US)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'2'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1213'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'373-4253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12133734253'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121337342534'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return E.164 number value (national number, with national prefix, default calling code: 1)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType({ defaultCallingCode: </span><span class="s2">'1' </span><span class="s1">})</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'2'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1213'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'373-4253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12133734253'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121337342534'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return E.164 number value (national number, default country: US)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'2'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1213'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'373-4253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12133734253'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121337342534'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return E.164 number value (national number, default calling code: 1)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType({ defaultCallingCode: </span><span class="s2">'1' </span><span class="s1">})</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'2'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1213'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'373-4253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12133734253'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121337342534'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return E.164 number value (international number, not a valid calling code)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'2150'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+2150'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return E.164 number value (international number, default country: US)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'2'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1213'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'373-4253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12133734253'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121337342534'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return E.164 number value (international number, other default country: RU)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'RU'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'2'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1213'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'373-4253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12133734253'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121337342534'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return E.164 number value (international number, default calling code: 1)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">, { defaultCallingCode: </span><span class="s2">'1' </span><span class="s1">})</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'2'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1213'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'373-4253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12133734253'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121337342534'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return E.164 number value (international number, other default calling code: 7)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">, { defaultCallingCode: </span><span class="s2">'7' </span><span class="s1">})</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'2'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1213'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'373-4253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12133734253'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121337342534'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return E.164 number value (international number)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'+'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'2'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'3'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+1213'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'373-4253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+12133734253'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.equal(</span><span class="s2">'+121337342534'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should return E.164 number value (national number) (no default country or calling code)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType()</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'12'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'3'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'373-4253'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
		<span class="s1">formatter.input(</span><span class="s2">'4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumberValue()).to.be.undefined</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should not drop any input digits'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Test &quot;+529011234567&quot; number, proactively ensuring that no formatting is applied,</span>
		<span class="s3">// where a format is chosen that would otherwise have led to some digits being dropped.</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'MX'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'9'</span><span class="s1">)).to.equal(</span><span class="s2">'9'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'0'</span><span class="s1">)).to.equal(</span><span class="s2">'90'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'901'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'901 1'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'2'</span><span class="s1">)).to.equal(</span><span class="s2">'901 12'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'3'</span><span class="s1">)).to.equal(</span><span class="s2">'901 123'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'4'</span><span class="s1">)).to.equal(</span><span class="s2">'901 123 4'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'5'</span><span class="s1">)).to.equal(</span><span class="s2">'901 123 45'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'6'</span><span class="s1">)).to.equal(</span><span class="s2">'901 123 456'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'7'</span><span class="s1">)).to.equal(</span><span class="s2">'901 123 4567'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work for formats with no leading digits (`leadingDigitsPatternsCount === 0`)'</span><span class="s1">, </span><span class="s0">function</span><span class="s1">() {</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType({</span>
			<span class="s1">defaultCallingCode: </span><span class="s5">888</span>
		<span class="s1">})</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'1'</span><span class="s1">)).to.equal(</span><span class="s2">'1'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work for SK phone numbers'</span><span class="s1">, </span><span class="s0">function</span><span class="s1">() {</span>
		<span class="s3">// There was a bug: &quot;leading digits&quot; `&quot;2&quot;` matched &quot;leading digits pattern&quot; `&quot;90&quot;`.</span>
		<span class="s3">// The incorrect `.match()` function result was `{ oveflow: true }`</span>
		<span class="s3">// while it should've been `undefined`.</span>
		<span class="s3">// https://gitlab.com/catamphetamine/libphonenumber-js/-/issues/66</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'SK'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'090'</span><span class="s1">)).to.equal(</span><span class="s2">'090'</span><span class="s1">)</span>
		<span class="s1">formatter.reset()</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'080'</span><span class="s1">)).to.equal(</span><span class="s2">'080'</span><span class="s1">)</span>
		<span class="s1">formatter.reset()</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'059'</span><span class="s1">)).to.equal(</span><span class="s2">'059'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work for SK phone numbers (2)'</span><span class="s1">, </span><span class="s0">function</span><span class="s1">() {</span>
		<span class="s3">// https://gitlab.com/catamphetamine/libphonenumber-js/-/issues/69</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'SK'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.input(</span><span class="s2">'421901222333'</span><span class="s1">)).to.equal(</span><span class="s2">'421 901 222 333'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getTemplate()).to.equal(</span><span class="s2">'xxx xxx xxx xxx'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should not choose `defaultCountry` over the &quot;main&quot; one when both the `defaultCountry` and the &quot;main&quot; one match the phone number'</span><span class="s1">, </span><span class="s0">function</span><span class="s1">() {</span>
		<span class="s3">// This phone number matches both US and CA because they have the same</span>
		<span class="s3">// regular expression for some weird reason.</span>
		<span class="s3">// https://gitlab.com/catamphetamine/libphonenumber-js/-/issues/103</span>
		<span class="s0">const </span><span class="s1">formatter = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'CA'</span><span class="s1">)</span>
		<span class="s1">formatter.input(</span><span class="s2">'8004001000'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().country).not.to.equal(</span><span class="s2">'CA'</span><span class="s1">)</span>
		<span class="s1">expect(formatter.getNumber().country).to.equal(</span><span class="s2">'US'</span><span class="s1">)</span>

		<span class="s3">// This phone number is specific to CA.</span>
		<span class="s0">const </span><span class="s1">formatter2 = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">formatter2.input(</span><span class="s2">'4389999999'</span><span class="s1">)</span>
		<span class="s1">expect(formatter2.getNumber().country).to.equal(</span><span class="s2">'CA'</span><span class="s1">)</span>

		<span class="s3">// This phone number doesn't belong neither to CA nor to US.</span>
		<span class="s3">// In fact, it doesn't belong to any country from the &quot;NANPA&quot; zone.</span>
		<span class="s0">const </span><span class="s1">formatter3 = </span><span class="s0">new </span><span class="s1">AsYouType(</span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">formatter3.input(</span><span class="s2">'1111111111'</span><span class="s1">)</span>
		<span class="s1">expect(formatter3.getNumber().country).to.equal(</span><span class="s2">'US'</span><span class="s1">)</span>
	<span class="s1">})</span>
<span class="s1">})</span>

<span class="s0">function </span><span class="s1">type(something) {</span>
	<span class="s0">return typeof </span><span class="s1">something</span>
<span class="s1">}</span></pre>
</body>
</html>