<html>
<head>
<title>turbopack-utils.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
turbopack-utils.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../src/server/dev/turbopack-utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type {</span><span class="s3">\n  </span><span class="s1">ServerFields,</span><span class="s3">\n  </span><span class="s1">SetupOpts,</span><span class="s3">\n</span><span class="s1">} from '../lib/router-utils/setup-dev-bundler'</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">Issue,</span><span class="s3">\n  </span><span class="s1">TurbopackResult,</span><span class="s3">\n  </span><span class="s1">Endpoint,</span><span class="s3">\n  </span><span class="s1">RawEntrypoints,</span><span class="s3">\n  </span><span class="s1">Update as TurbopackUpdate,</span><span class="s3">\n  </span><span class="s1">WrittenEndpoint,</span><span class="s3">\n</span><span class="s1">} from '../../build/swc/types'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">type HMR_ACTION_TYPES,</span><span class="s3">\n  </span><span class="s1">HMR_ACTIONS_SENT_TO_BROWSER,</span><span class="s3">\n</span><span class="s1">} from './hot-reloader-types'</span><span class="s3">\n</span><span class="s1">import * as Log from '../../build/output/log'</span><span class="s3">\n</span><span class="s1">import type { PropagateToWorkersField } from '../lib/router-utils/types'</span><span class="s3">\n</span><span class="s1">import type { TurbopackManifestLoader } from '../../shared/lib/turbopack/manifest-loader'</span><span class="s3">\n</span><span class="s1">import type { AppRoute, Entrypoints, PageRoute } from '../../build/swc/types'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">type EntryKey,</span><span class="s3">\n  </span><span class="s1">getEntryKey,</span><span class="s3">\n  </span><span class="s1">splitEntryKey,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/turbopack/entry-key'</span><span class="s3">\n</span><span class="s1">import type ws from 'next/dist/compiled/ws'</span><span class="s3">\n</span><span class="s1">import { isMetadataRoute } from '../../lib/metadata/is-metadata-route'</span><span class="s3">\n</span><span class="s1">import type { CustomRoutes } from '../../lib/load-custom-routes'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">formatIssue,</span><span class="s3">\n  </span><span class="s1">getIssueKey,</span><span class="s3">\n  </span><span class="s1">isRelevantWarning,</span><span class="s3">\n  </span><span class="s1">processIssues,</span><span class="s3">\n  </span><span class="s1">renderStyledStringToErrorAnsi,</span><span class="s3">\n  </span><span class="s1">type EntryIssuesMap,</span><span class="s3">\n  </span><span class="s1">type TopLevelIssuesMap,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/turbopack/utils'</span><span class="s3">\n\n</span><span class="s1">const onceErrorSet = new Set()</span><span class="s3">\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Check if given issue is a warning to be display only once.</span><span class="s3">\n </span><span class="s1">* This mimics behavior of get-page-static-info's warnOnce.</span><span class="s3">\n </span><span class="s1">* @param issue</span><span class="s3">\n </span><span class="s1">* @returns</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function shouldEmitOnceWarning(issue: Issue): boolean {</span><span class="s3">\n  </span><span class="s1">const { severity, title, stage } = issue</span><span class="s3">\n  </span><span class="s1">if (severity === 'warning' &amp;&amp; title.value === 'Invalid page configuration') {</span><span class="s3">\n    </span><span class="s1">if (onceErrorSet.has(issue)) {</span><span class="s3">\n      </span><span class="s1">return false</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">onceErrorSet.add(issue)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">severity === 'warning' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">stage === 'config' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">renderStyledStringToErrorAnsi(issue.title).includes(</span><span class="s3">\&quot;</span><span class="s1">can't be external</span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">if (onceErrorSet.has(issue)) {</span><span class="s3">\n      </span><span class="s1">return false</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">onceErrorSet.add(issue)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return true</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/// Print out an issue to the console which should not block</span><span class="s3">\n</span><span class="s1">/// the build by throwing out or blocking error overlay.</span><span class="s3">\n</span><span class="s1">export function printNonFatalIssue(issue: Issue) {</span><span class="s3">\n  </span><span class="s1">if (isRelevantWarning(issue) &amp;&amp; shouldEmitOnceWarning(issue)) {</span><span class="s3">\n    </span><span class="s1">Log.warn(formatIssue(issue))</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function processTopLevelIssues(</span><span class="s3">\n  </span><span class="s1">currentTopLevelIssues: TopLevelIssuesMap,</span><span class="s3">\n  </span><span class="s1">result: TurbopackResult</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">currentTopLevelIssues.clear()</span><span class="s3">\n\n  </span><span class="s1">for (const issue of result.issues) {</span><span class="s3">\n    </span><span class="s1">const issueKey = getIssueKey(issue)</span><span class="s3">\n    </span><span class="s1">currentTopLevelIssues.set(issueKey, issue)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const MILLISECONDS_IN_NANOSECOND = BigInt(1_000_000)</span><span class="s3">\n\n</span><span class="s1">export function msToNs(ms: number): bigint {</span><span class="s3">\n  </span><span class="s1">return BigInt(Math.floor(ms)) * MILLISECONDS_IN_NANOSECOND</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type ChangeSubscriptions = Map&lt;</span><span class="s3">\n  </span><span class="s1">EntryKey,</span><span class="s3">\n  </span><span class="s1">Promise&lt;AsyncIterableIterator&lt;TurbopackResult&gt;&gt;</span><span class="s3">\n</span><span class="s1">&gt;</span><span class="s3">\n\n</span><span class="s1">export type HandleWrittenEndpoint = (</span><span class="s3">\n  </span><span class="s1">key: EntryKey,</span><span class="s3">\n  </span><span class="s1">result: TurbopackResult&lt;WrittenEndpoint&gt;,</span><span class="s3">\n  </span><span class="s1">forceDeleteCache: boolean</span><span class="s3">\n</span><span class="s1">) =&gt; boolean</span><span class="s3">\n\n</span><span class="s1">export type StartChangeSubscription = (</span><span class="s3">\n  </span><span class="s1">key: EntryKey,</span><span class="s3">\n  </span><span class="s1">includeIssues: boolean,</span><span class="s3">\n  </span><span class="s1">endpoint: Endpoint,</span><span class="s3">\n  </span><span class="s1">makePayload: (</span><span class="s3">\n    </span><span class="s1">change: TurbopackResult,</span><span class="s3">\n    </span><span class="s1">hash: string</span><span class="s3">\n  </span><span class="s1">) =&gt; Promise&lt;HMR_ACTION_TYPES&gt; | HMR_ACTION_TYPES | void,</span><span class="s3">\n  </span><span class="s1">onError?: (e: Error) =&gt; Promise&lt;HMR_ACTION_TYPES&gt; | HMR_ACTION_TYPES | void</span><span class="s3">\n</span><span class="s1">) =&gt; Promise&lt;void&gt;</span><span class="s3">\n\n</span><span class="s1">export type StopChangeSubscription = (key: EntryKey) =&gt; Promise&lt;void&gt;</span><span class="s3">\n\n</span><span class="s1">export type SendHmr = (id: string, payload: HMR_ACTION_TYPES) =&gt; void</span><span class="s3">\n\n</span><span class="s1">export type StartBuilding = (</span><span class="s3">\n  </span><span class="s1">id: string,</span><span class="s3">\n  </span><span class="s1">requestUrl: string | undefined,</span><span class="s3">\n  </span><span class="s1">forceRebuild: boolean</span><span class="s3">\n</span><span class="s1">) =&gt; () =&gt; void</span><span class="s3">\n\n</span><span class="s1">export type ReadyIds = Set&lt;string&gt;</span><span class="s3">\n\n</span><span class="s1">export type ClientState = {</span><span class="s3">\n  </span><span class="s1">clientIssues: EntryIssuesMap</span><span class="s3">\n  </span><span class="s1">hmrPayloads: Map&lt;string, HMR_ACTION_TYPES&gt;</span><span class="s3">\n  </span><span class="s1">turbopackUpdates: TurbopackUpdate[]</span><span class="s3">\n  </span><span class="s1">subscriptions: Map&lt;string, AsyncIterator&lt;any&gt;&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type ClientStateMap = WeakMap&lt;ws, ClientState&gt;</span><span class="s3">\n\n</span><span class="s1">// hooks only used by the dev server.</span><span class="s3">\n</span><span class="s1">type HandleRouteTypeHooks = {</span><span class="s3">\n  </span><span class="s1">handleWrittenEndpoint: HandleWrittenEndpoint</span><span class="s3">\n  </span><span class="s1">subscribeToChanges: StartChangeSubscription</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function handleRouteType({</span><span class="s3">\n  </span><span class="s1">dev,</span><span class="s3">\n  </span><span class="s1">page,</span><span class="s3">\n  </span><span class="s1">pathname,</span><span class="s3">\n  </span><span class="s1">route,</span><span class="s3">\n  </span><span class="s1">currentEntryIssues,</span><span class="s3">\n  </span><span class="s1">entrypoints,</span><span class="s3">\n  </span><span class="s1">manifestLoader,</span><span class="s3">\n  </span><span class="s1">readyIds,</span><span class="s3">\n  </span><span class="s1">devRewrites,</span><span class="s3">\n  </span><span class="s1">productionRewrites,</span><span class="s3">\n  </span><span class="s1">hooks,</span><span class="s3">\n  </span><span class="s1">logErrors,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">dev: boolean</span><span class="s3">\n  </span><span class="s1">page: string</span><span class="s3">\n  </span><span class="s1">pathname: string</span><span class="s3">\n  </span><span class="s1">route: PageRoute | AppRoute</span><span class="s3">\n\n  </span><span class="s1">currentEntryIssues: EntryIssuesMap</span><span class="s3">\n  </span><span class="s1">entrypoints: Entrypoints</span><span class="s3">\n  </span><span class="s1">manifestLoader: TurbopackManifestLoader</span><span class="s3">\n  </span><span class="s1">devRewrites: SetupOpts['fsChecker']['rewrites'] | undefined</span><span class="s3">\n  </span><span class="s1">productionRewrites: CustomRoutes['rewrites'] | undefined</span><span class="s3">\n  </span><span class="s1">logErrors: boolean</span><span class="s3">\n\n  </span><span class="s1">readyIds?: ReadyIds // dev</span><span class="s3">\n\n  </span><span class="s1">hooks?: HandleRouteTypeHooks // dev</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">const shouldCreateWebpackStats = process.env.TURBOPACK_STATS != null</span><span class="s3">\n\n  </span><span class="s1">switch (route.type) {</span><span class="s3">\n    </span><span class="s1">case 'page': {</span><span class="s3">\n      </span><span class="s1">const clientKey = getEntryKey('pages', 'client', page)</span><span class="s3">\n      </span><span class="s1">const serverKey = getEntryKey('pages', 'server', page)</span><span class="s3">\n\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">// In the best case scenario, Turbopack chunks document, app, page separately in that order,</span><span class="s3">\n        </span><span class="s1">// so it can happen that the chunks of document change, but the chunks of app and page</span><span class="s3">\n        </span><span class="s1">// don't. We still need to reload the page chunks in that case though, otherwise the version</span><span class="s3">\n        </span><span class="s1">// of the document or app component export from the pages template is stale.</span><span class="s3">\n        </span><span class="s1">let documentOrAppChanged = false</span><span class="s3">\n        </span><span class="s1">if (entrypoints.global.app) {</span><span class="s3">\n          </span><span class="s1">const key = getEntryKey('pages', 'server', '_app')</span><span class="s3">\n\n          </span><span class="s1">const writtenEndpoint = await entrypoints.global.app.writeToDisk()</span><span class="s3">\n          </span><span class="s1">documentOrAppChanged ||=</span><span class="s3">\n            </span><span class="s1">hooks?.handleWrittenEndpoint(key, writtenEndpoint, false) ?? false</span><span class="s3">\n          </span><span class="s1">processIssues(</span><span class="s3">\n            </span><span class="s1">currentEntryIssues,</span><span class="s3">\n            </span><span class="s1">key,</span><span class="s3">\n            </span><span class="s1">writtenEndpoint,</span><span class="s3">\n            </span><span class="s1">false,</span><span class="s3">\n            </span><span class="s1">logErrors</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">await manifestLoader.loadBuildManifest('_app')</span><span class="s3">\n        </span><span class="s1">await manifestLoader.loadPagesManifest('_app')</span><span class="s3">\n\n        </span><span class="s1">if (entrypoints.global.document) {</span><span class="s3">\n          </span><span class="s1">const key = getEntryKey('pages', 'server', '_document')</span><span class="s3">\n\n          </span><span class="s1">const writtenEndpoint =</span><span class="s3">\n            </span><span class="s1">await entrypoints.global.document.writeToDisk()</span><span class="s3">\n          </span><span class="s1">documentOrAppChanged ||=</span><span class="s3">\n            </span><span class="s1">hooks?.handleWrittenEndpoint(key, writtenEndpoint, false) ?? false</span><span class="s3">\n          </span><span class="s1">processIssues(</span><span class="s3">\n            </span><span class="s1">currentEntryIssues,</span><span class="s3">\n            </span><span class="s1">key,</span><span class="s3">\n            </span><span class="s1">writtenEndpoint,</span><span class="s3">\n            </span><span class="s1">false,</span><span class="s3">\n            </span><span class="s1">logErrors</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">await manifestLoader.loadPagesManifest('_document')</span><span class="s3">\n\n        </span><span class="s1">const writtenEndpoint = await route.htmlEndpoint.writeToDisk()</span><span class="s3">\n        </span><span class="s1">hooks?.handleWrittenEndpoint(</span><span class="s3">\n          </span><span class="s1">serverKey,</span><span class="s3">\n          </span><span class="s1">writtenEndpoint,</span><span class="s3">\n          </span><span class="s1">documentOrAppChanged</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">const type = writtenEndpoint?.type</span><span class="s3">\n\n        </span><span class="s1">await manifestLoader.loadClientBuildManifest(page)</span><span class="s3">\n        </span><span class="s1">await manifestLoader.loadBuildManifest(page)</span><span class="s3">\n        </span><span class="s1">await manifestLoader.loadPagesManifest(page)</span><span class="s3">\n        </span><span class="s1">if (type === 'edge') {</span><span class="s3">\n          </span><span class="s1">await manifestLoader.loadMiddlewareManifest(page, 'pages')</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">manifestLoader.deleteMiddlewareManifest(serverKey)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">await manifestLoader.loadFontManifest('/_app', 'pages')</span><span class="s3">\n        </span><span class="s1">await manifestLoader.loadFontManifest(page, 'pages')</span><span class="s3">\n\n        </span><span class="s1">if (shouldCreateWebpackStats) {</span><span class="s3">\n          </span><span class="s1">await manifestLoader.loadWebpackStats(page, 'pages')</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">await manifestLoader.writeManifests({</span><span class="s3">\n          </span><span class="s1">devRewrites,</span><span class="s3">\n          </span><span class="s1">productionRewrites,</span><span class="s3">\n          </span><span class="s1">entrypoints,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n\n        </span><span class="s1">processIssues(</span><span class="s3">\n          </span><span class="s1">currentEntryIssues,</span><span class="s3">\n          </span><span class="s1">serverKey,</span><span class="s3">\n          </span><span class="s1">writtenEndpoint,</span><span class="s3">\n          </span><span class="s1">false,</span><span class="s3">\n          </span><span class="s1">logErrors</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">} finally {</span><span class="s3">\n        </span><span class="s1">if (dev) {</span><span class="s3">\n          </span><span class="s1">// TODO subscriptions should only be caused by the WebSocket connections</span><span class="s3">\n          </span><span class="s1">// otherwise we don't known when to unsubscribe and this leaking</span><span class="s3">\n          </span><span class="s1">hooks?.subscribeToChanges(</span><span class="s3">\n            </span><span class="s1">serverKey,</span><span class="s3">\n            </span><span class="s1">false,</span><span class="s3">\n            </span><span class="s1">route.dataEndpoint,</span><span class="s3">\n            </span><span class="s1">() =&gt; {</span><span class="s3">\n              </span><span class="s1">// Report the next compilation again</span><span class="s3">\n              </span><span class="s1">readyIds?.delete(pathname)</span><span class="s3">\n              </span><span class="s1">return {</span><span class="s3">\n                </span><span class="s1">event: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_ONLY_CHANGES,</span><span class="s3">\n                </span><span class="s1">pages: [page],</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">},</span><span class="s3">\n            </span><span class="s1">(e) =&gt; {</span><span class="s3">\n              </span><span class="s1">return {</span><span class="s3">\n                </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,</span><span class="s3">\n                </span><span class="s1">data: `error in ${page} data subscription: ${e}`,</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">hooks?.subscribeToChanges(</span><span class="s3">\n            </span><span class="s1">clientKey,</span><span class="s3">\n            </span><span class="s1">false,</span><span class="s3">\n            </span><span class="s1">route.htmlEndpoint,</span><span class="s3">\n            </span><span class="s1">() =&gt; {</span><span class="s3">\n              </span><span class="s1">return {</span><span class="s3">\n                </span><span class="s1">event: HMR_ACTIONS_SENT_TO_BROWSER.CLIENT_CHANGES,</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">},</span><span class="s3">\n            </span><span class="s1">(e) =&gt; {</span><span class="s3">\n              </span><span class="s1">return {</span><span class="s3">\n                </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,</span><span class="s3">\n                </span><span class="s1">data: `error in ${page} html subscription: ${e}`,</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">if (entrypoints.global.document) {</span><span class="s3">\n            </span><span class="s1">hooks?.subscribeToChanges(</span><span class="s3">\n              </span><span class="s1">getEntryKey('pages', 'server', '_document'),</span><span class="s3">\n              </span><span class="s1">false,</span><span class="s3">\n              </span><span class="s1">entrypoints.global.document,</span><span class="s3">\n              </span><span class="s1">() =&gt; {</span><span class="s3">\n                </span><span class="s1">return {</span><span class="s3">\n                  </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,</span><span class="s3">\n                  </span><span class="s1">data: '_document has changed (page route)',</span><span class="s3">\n                </span><span class="s1">}</span><span class="s3">\n              </span><span class="s1">},</span><span class="s3">\n              </span><span class="s1">(e) =&gt; {</span><span class="s3">\n                </span><span class="s1">return {</span><span class="s3">\n                  </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,</span><span class="s3">\n                  </span><span class="s1">data: `error in _document subscription (page route): ${e}`,</span><span class="s3">\n                </span><span class="s1">}</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'page-api': {</span><span class="s3">\n      </span><span class="s1">const key = getEntryKey('pages', 'server', page)</span><span class="s3">\n\n      </span><span class="s1">const writtenEndpoint = await route.endpoint.writeToDisk()</span><span class="s3">\n      </span><span class="s1">hooks?.handleWrittenEndpoint(key, writtenEndpoint, false)</span><span class="s3">\n\n      </span><span class="s1">const type = writtenEndpoint.type</span><span class="s3">\n\n      </span><span class="s1">await manifestLoader.loadPagesManifest(page)</span><span class="s3">\n      </span><span class="s1">if (type === 'edge') {</span><span class="s3">\n        </span><span class="s1">await manifestLoader.loadMiddlewareManifest(page, 'pages')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">manifestLoader.deleteMiddlewareManifest(key)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">await manifestLoader.writeManifests({</span><span class="s3">\n        </span><span class="s1">devRewrites,</span><span class="s3">\n        </span><span class="s1">productionRewrites,</span><span class="s3">\n        </span><span class="s1">entrypoints,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n\n      </span><span class="s1">processIssues(currentEntryIssues, key, writtenEndpoint, true, logErrors)</span><span class="s3">\n\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'app-page': {</span><span class="s3">\n      </span><span class="s1">const key = getEntryKey('app', 'server', page)</span><span class="s3">\n\n      </span><span class="s1">const writtenEndpoint = await route.htmlEndpoint.writeToDisk()</span><span class="s3">\n      </span><span class="s1">hooks?.handleWrittenEndpoint(key, writtenEndpoint, false)</span><span class="s3">\n\n      </span><span class="s1">if (dev) {</span><span class="s3">\n        </span><span class="s1">// TODO subscriptions should only be caused by the WebSocket connections</span><span class="s3">\n        </span><span class="s1">// otherwise we don't known when to unsubscribe and this leaking</span><span class="s3">\n        </span><span class="s1">hooks?.subscribeToChanges(</span><span class="s3">\n          </span><span class="s1">key,</span><span class="s3">\n          </span><span class="s1">true,</span><span class="s3">\n          </span><span class="s1">route.rscEndpoint,</span><span class="s3">\n          </span><span class="s1">(change, hash) =&gt; {</span><span class="s3">\n            </span><span class="s1">if (change.issues.some((issue) =&gt; issue.severity === 'error')) {</span><span class="s3">\n              </span><span class="s1">// Ignore any updates that has errors</span><span class="s3">\n              </span><span class="s1">// There will be another update without errors eventually</span><span class="s3">\n              </span><span class="s1">return</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">// Report the next compilation again</span><span class="s3">\n            </span><span class="s1">readyIds?.delete(pathname)</span><span class="s3">\n            </span><span class="s1">return {</span><span class="s3">\n              </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES,</span><span class="s3">\n              </span><span class="s1">hash,</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">(e) =&gt; {</span><span class="s3">\n            </span><span class="s1">return {</span><span class="s3">\n              </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,</span><span class="s3">\n              </span><span class="s1">data: `error in ${page} app-page subscription: ${e}`,</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const type = writtenEndpoint.type</span><span class="s3">\n\n      </span><span class="s1">if (type === 'edge') {</span><span class="s3">\n        </span><span class="s1">await manifestLoader.loadMiddlewareManifest(page, 'app')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">manifestLoader.deleteMiddlewareManifest(key)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">await manifestLoader.loadAppBuildManifest(page)</span><span class="s3">\n      </span><span class="s1">await manifestLoader.loadBuildManifest(page, 'app')</span><span class="s3">\n      </span><span class="s1">await manifestLoader.loadAppPathsManifest(page)</span><span class="s3">\n      </span><span class="s1">await manifestLoader.loadActionManifest(page)</span><span class="s3">\n      </span><span class="s1">await manifestLoader.loadFontManifest(page, 'app')</span><span class="s3">\n\n      </span><span class="s1">if (shouldCreateWebpackStats) {</span><span class="s3">\n        </span><span class="s1">await manifestLoader.loadWebpackStats(page, 'app')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">await manifestLoader.writeManifests({</span><span class="s3">\n        </span><span class="s1">devRewrites,</span><span class="s3">\n        </span><span class="s1">productionRewrites,</span><span class="s3">\n        </span><span class="s1">entrypoints,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n\n      </span><span class="s1">processIssues(currentEntryIssues, key, writtenEndpoint, dev, logErrors)</span><span class="s3">\n\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'app-route': {</span><span class="s3">\n      </span><span class="s1">const key = getEntryKey('app', 'server', page)</span><span class="s3">\n\n      </span><span class="s1">const writtenEndpoint = await route.endpoint.writeToDisk()</span><span class="s3">\n      </span><span class="s1">hooks?.handleWrittenEndpoint(key, writtenEndpoint, false)</span><span class="s3">\n\n      </span><span class="s1">const type = writtenEndpoint.type</span><span class="s3">\n\n      </span><span class="s1">await manifestLoader.loadAppPathsManifest(page)</span><span class="s3">\n\n      </span><span class="s1">if (type === 'edge') {</span><span class="s3">\n        </span><span class="s1">await manifestLoader.loadMiddlewareManifest(page, 'app')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">manifestLoader.deleteMiddlewareManifest(key)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">await manifestLoader.writeManifests({</span><span class="s3">\n        </span><span class="s1">devRewrites,</span><span class="s3">\n        </span><span class="s1">productionRewrites,</span><span class="s3">\n        </span><span class="s1">entrypoints,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">processIssues(currentEntryIssues, key, writtenEndpoint, true, logErrors)</span><span class="s3">\n\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">default: {</span><span class="s3">\n      </span><span class="s1">throw new Error(`unknown route type ${(route as any).type} for ${page}`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Maintains a mapping between entrypoins and the corresponding client asset paths.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class AssetMapper {</span><span class="s3">\n  </span><span class="s1">private entryMap: Map&lt;EntryKey, Set&lt;string&gt;&gt; = new Map()</span><span class="s3">\n  </span><span class="s1">private assetMap: Map&lt;string, Set&lt;EntryKey&gt;&gt; = new Map()</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Overrides asset paths for a key and updates the mapping from path to key.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param key</span><span class="s3">\n   </span><span class="s1">* @param assetPaths asset paths relative to the .next directory</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">setPathsForKey(key: EntryKey, assetPaths: string[]): void {</span><span class="s3">\n    </span><span class="s1">this.delete(key)</span><span class="s3">\n\n    </span><span class="s1">const newAssetPaths = new Set(assetPaths)</span><span class="s3">\n    </span><span class="s1">this.entryMap.set(key, newAssetPaths)</span><span class="s3">\n\n    </span><span class="s1">for (const assetPath of newAssetPaths) {</span><span class="s3">\n      </span><span class="s1">let assetPathKeys = this.assetMap.get(assetPath)</span><span class="s3">\n      </span><span class="s1">if (!assetPathKeys) {</span><span class="s3">\n        </span><span class="s1">assetPathKeys = new Set()</span><span class="s3">\n        </span><span class="s1">this.assetMap.set(assetPath, assetPathKeys)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">assetPathKeys!.add(key)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Deletes the key and any asset only referenced by this key.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param key</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">delete(key: EntryKey) {</span><span class="s3">\n    </span><span class="s1">for (const assetPath of this.getAssetPathsByKey(key)) {</span><span class="s3">\n      </span><span class="s1">const assetPathKeys = this.assetMap.get(assetPath)</span><span class="s3">\n\n      </span><span class="s1">assetPathKeys?.delete(key)</span><span class="s3">\n\n      </span><span class="s1">if (!assetPathKeys?.size) {</span><span class="s3">\n        </span><span class="s1">this.assetMap.delete(assetPath)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">this.entryMap.delete(key)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">getAssetPathsByKey(key: EntryKey): string[] {</span><span class="s3">\n    </span><span class="s1">return Array.from(this.entryMap.get(key) ?? [])</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">getKeysByAsset(path: string): EntryKey[] {</span><span class="s3">\n    </span><span class="s1">return Array.from(this.assetMap.get(path) ?? [])</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">keys(): IterableIterator&lt;EntryKey&gt; {</span><span class="s3">\n    </span><span class="s1">return this.entryMap.keys()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function hasEntrypointForKey(</span><span class="s3">\n  </span><span class="s1">entrypoints: Entrypoints,</span><span class="s3">\n  </span><span class="s1">key: EntryKey,</span><span class="s3">\n  </span><span class="s1">assetMapper: AssetMapper | undefined</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">const { type, page } = splitEntryKey(key)</span><span class="s3">\n\n  </span><span class="s1">switch (type) {</span><span class="s3">\n    </span><span class="s1">case 'app':</span><span class="s3">\n      </span><span class="s1">return entrypoints.app.has(page)</span><span class="s3">\n    </span><span class="s1">case 'pages':</span><span class="s3">\n      </span><span class="s1">switch (page) {</span><span class="s3">\n        </span><span class="s1">case '_app':</span><span class="s3">\n          </span><span class="s1">return entrypoints.global.app != null</span><span class="s3">\n        </span><span class="s1">case '_document':</span><span class="s3">\n          </span><span class="s1">return entrypoints.global.document != null</span><span class="s3">\n        </span><span class="s1">case '_error':</span><span class="s3">\n          </span><span class="s1">return entrypoints.global.error != null</span><span class="s3">\n        </span><span class="s1">default:</span><span class="s3">\n          </span><span class="s1">return entrypoints.page.has(page)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'root':</span><span class="s3">\n      </span><span class="s1">switch (page) {</span><span class="s3">\n        </span><span class="s1">case 'middleware':</span><span class="s3">\n          </span><span class="s1">return entrypoints.global.middleware != null</span><span class="s3">\n        </span><span class="s1">case 'instrumentation':</span><span class="s3">\n          </span><span class="s1">return entrypoints.global.instrumentation != null</span><span class="s3">\n        </span><span class="s1">default:</span><span class="s3">\n          </span><span class="s1">return false</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'assets':</span><span class="s3">\n      </span><span class="s1">if (!assetMapper) {</span><span class="s3">\n        </span><span class="s1">return false</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return assetMapper</span><span class="s3">\n        </span><span class="s1">.getKeysByAsset(page)</span><span class="s3">\n        </span><span class="s1">.some((pageKey) =&gt;</span><span class="s3">\n          </span><span class="s1">hasEntrypointForKey(entrypoints, pageKey, assetMapper)</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">default: {</span><span class="s3">\n      </span><span class="s1">// validation that we covered all cases, this should never run.</span><span class="s3">\n      </span><span class="s1">// eslint-disable-next-line @typescript-eslint/no-unused-vars</span><span class="s3">\n      </span><span class="s1">const _: never = type</span><span class="s3">\n      </span><span class="s1">return false</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// hooks only used by the dev server.</span><span class="s3">\n</span><span class="s1">type HandleEntrypointsHooks = {</span><span class="s3">\n  </span><span class="s1">handleWrittenEndpoint: HandleWrittenEndpoint</span><span class="s3">\n  </span><span class="s1">propagateServerField: (</span><span class="s3">\n    </span><span class="s1">field: PropagateToWorkersField,</span><span class="s3">\n    </span><span class="s1">args: any</span><span class="s3">\n  </span><span class="s1">) =&gt; Promise&lt;void&gt;</span><span class="s3">\n  </span><span class="s1">sendHmr: SendHmr</span><span class="s3">\n  </span><span class="s1">startBuilding: StartBuilding</span><span class="s3">\n  </span><span class="s1">subscribeToChanges: StartChangeSubscription</span><span class="s3">\n  </span><span class="s1">unsubscribeFromChanges: StopChangeSubscription</span><span class="s3">\n  </span><span class="s1">unsubscribeFromHmrEvents: (client: ws, id: string) =&gt; void</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type HandleEntrypointsDevOpts = {</span><span class="s3">\n  </span><span class="s1">assetMapper: AssetMapper</span><span class="s3">\n  </span><span class="s1">changeSubscriptions: ChangeSubscriptions</span><span class="s3">\n  </span><span class="s1">clients: Set&lt;ws&gt;</span><span class="s3">\n  </span><span class="s1">clientStates: ClientStateMap</span><span class="s3">\n  </span><span class="s1">serverFields: ServerFields</span><span class="s3">\n\n  </span><span class="s1">hooks: HandleEntrypointsHooks</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function handleEntrypoints({</span><span class="s3">\n  </span><span class="s1">entrypoints,</span><span class="s3">\n\n  </span><span class="s1">currentEntrypoints,</span><span class="s3">\n\n  </span><span class="s1">currentEntryIssues,</span><span class="s3">\n  </span><span class="s1">manifestLoader,</span><span class="s3">\n  </span><span class="s1">devRewrites,</span><span class="s3">\n  </span><span class="s1">logErrors,</span><span class="s3">\n  </span><span class="s1">dev,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">entrypoints: TurbopackResult&lt;RawEntrypoints&gt;</span><span class="s3">\n\n  </span><span class="s1">currentEntrypoints: Entrypoints</span><span class="s3">\n\n  </span><span class="s1">currentEntryIssues: EntryIssuesMap</span><span class="s3">\n  </span><span class="s1">manifestLoader: TurbopackManifestLoader</span><span class="s3">\n  </span><span class="s1">devRewrites: SetupOpts['fsChecker']['rewrites'] | undefined</span><span class="s3">\n  </span><span class="s1">productionRewrites: CustomRoutes['rewrites'] | undefined</span><span class="s3">\n  </span><span class="s1">logErrors: boolean</span><span class="s3">\n\n  </span><span class="s1">dev: HandleEntrypointsDevOpts</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">currentEntrypoints.global.app = entrypoints.pagesAppEndpoint</span><span class="s3">\n  </span><span class="s1">currentEntrypoints.global.document = entrypoints.pagesDocumentEndpoint</span><span class="s3">\n  </span><span class="s1">currentEntrypoints.global.error = entrypoints.pagesErrorEndpoint</span><span class="s3">\n\n  </span><span class="s1">currentEntrypoints.global.instrumentation = entrypoints.instrumentation</span><span class="s3">\n\n  </span><span class="s1">currentEntrypoints.page.clear()</span><span class="s3">\n  </span><span class="s1">currentEntrypoints.app.clear()</span><span class="s3">\n\n  </span><span class="s1">for (const [pathname, route] of entrypoints.routes) {</span><span class="s3">\n    </span><span class="s1">switch (route.type) {</span><span class="s3">\n      </span><span class="s1">case 'page':</span><span class="s3">\n      </span><span class="s1">case 'page-api':</span><span class="s3">\n        </span><span class="s1">currentEntrypoints.page.set(pathname, route)</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">case 'app-page': {</span><span class="s3">\n        </span><span class="s1">route.pages.forEach((page) =&gt; {</span><span class="s3">\n          </span><span class="s1">currentEntrypoints.app.set(page.originalName, {</span><span class="s3">\n            </span><span class="s1">type: 'app-page',</span><span class="s3">\n            </span><span class="s1">...page,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">case 'app-route': {</span><span class="s3">\n        </span><span class="s1">currentEntrypoints.app.set(route.originalName, route)</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">case 'conflict':</span><span class="s3">\n        </span><span class="s1">Log.info(`skipping ${pathname} (${route.type})`)</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">route satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (dev) {</span><span class="s3">\n    </span><span class="s1">await handleEntrypointsDevCleanup({</span><span class="s3">\n      </span><span class="s1">currentEntryIssues,</span><span class="s3">\n      </span><span class="s1">currentEntrypoints,</span><span class="s3">\n\n      </span><span class="s1">...dev,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { middleware, instrumentation } = entrypoints</span><span class="s3">\n\n  </span><span class="s1">// We check for explicit true/false, since it's initialized to</span><span class="s3">\n  </span><span class="s1">// undefined during the first loop (middlewareChanges event is</span><span class="s3">\n  </span><span class="s1">// unnecessary during the first serve)</span><span class="s3">\n  </span><span class="s1">if (currentEntrypoints.global.middleware &amp;&amp; !middleware) {</span><span class="s3">\n    </span><span class="s1">const key = getEntryKey('root', 'server', 'middleware')</span><span class="s3">\n    </span><span class="s1">// Went from middleware to no middleware</span><span class="s3">\n    </span><span class="s1">await dev?.hooks.unsubscribeFromChanges(key)</span><span class="s3">\n    </span><span class="s1">currentEntryIssues.delete(key)</span><span class="s3">\n    </span><span class="s1">dev.hooks.sendHmr('middleware', {</span><span class="s3">\n      </span><span class="s1">event: HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">} else if (!currentEntrypoints.global.middleware &amp;&amp; middleware) {</span><span class="s3">\n    </span><span class="s1">// Went from no middleware to middleware</span><span class="s3">\n    </span><span class="s1">dev.hooks.sendHmr('middleware', {</span><span class="s3">\n      </span><span class="s1">event: HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">currentEntrypoints.global.middleware = middleware</span><span class="s3">\n\n  </span><span class="s1">if (instrumentation) {</span><span class="s3">\n    </span><span class="s1">const processInstrumentation = async (</span><span class="s3">\n      </span><span class="s1">name: string,</span><span class="s3">\n      </span><span class="s1">prop: 'nodeJs' | 'edge'</span><span class="s3">\n    </span><span class="s1">) =&gt; {</span><span class="s3">\n      </span><span class="s1">const prettyName = {</span><span class="s3">\n        </span><span class="s1">nodeJs: 'Node.js',</span><span class="s3">\n        </span><span class="s1">edge: 'Edge',</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">const finishBuilding = dev.hooks.startBuilding(</span><span class="s3">\n        </span><span class="s1">`instrumentation ${prettyName[prop]}`,</span><span class="s3">\n        </span><span class="s1">undefined,</span><span class="s3">\n        </span><span class="s1">true</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">const key = getEntryKey('root', 'server', name)</span><span class="s3">\n\n      </span><span class="s1">const writtenEndpoint = await instrumentation[prop].writeToDisk()</span><span class="s3">\n      </span><span class="s1">dev.hooks.handleWrittenEndpoint(key, writtenEndpoint, false)</span><span class="s3">\n      </span><span class="s1">processIssues(currentEntryIssues, key, writtenEndpoint, false, logErrors)</span><span class="s3">\n      </span><span class="s1">finishBuilding()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">await processInstrumentation('instrumentation.nodeJs', 'nodeJs')</span><span class="s3">\n    </span><span class="s1">await processInstrumentation('instrumentation.edge', 'edge')</span><span class="s3">\n    </span><span class="s1">await manifestLoader.loadMiddlewareManifest(</span><span class="s3">\n      </span><span class="s1">'instrumentation',</span><span class="s3">\n      </span><span class="s1">'instrumentation'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">await manifestLoader.writeManifests({</span><span class="s3">\n      </span><span class="s1">devRewrites,</span><span class="s3">\n      </span><span class="s1">productionRewrites: undefined,</span><span class="s3">\n      </span><span class="s1">entrypoints: currentEntrypoints,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n\n    </span><span class="s1">dev.serverFields.actualInstrumentationHookFile = '/instrumentation'</span><span class="s3">\n    </span><span class="s1">await dev.hooks.propagateServerField(</span><span class="s3">\n      </span><span class="s1">'actualInstrumentationHookFile',</span><span class="s3">\n      </span><span class="s1">dev.serverFields.actualInstrumentationHookFile</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">dev.serverFields.actualInstrumentationHookFile = undefined</span><span class="s3">\n    </span><span class="s1">await dev.hooks.propagateServerField(</span><span class="s3">\n      </span><span class="s1">'actualInstrumentationHookFile',</span><span class="s3">\n      </span><span class="s1">dev.serverFields.actualInstrumentationHookFile</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (middleware) {</span><span class="s3">\n    </span><span class="s1">const key = getEntryKey('root', 'server', 'middleware')</span><span class="s3">\n\n    </span><span class="s1">const endpoint = middleware.endpoint</span><span class="s3">\n\n    </span><span class="s1">async function processMiddleware() {</span><span class="s3">\n      </span><span class="s1">const finishBuilding = dev.hooks.startBuilding(</span><span class="s3">\n        </span><span class="s1">'middleware',</span><span class="s3">\n        </span><span class="s1">undefined,</span><span class="s3">\n        </span><span class="s1">true</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">const writtenEndpoint = await endpoint.writeToDisk()</span><span class="s3">\n      </span><span class="s1">dev.hooks.handleWrittenEndpoint(key, writtenEndpoint, false)</span><span class="s3">\n      </span><span class="s1">processIssues(currentEntryIssues, key, writtenEndpoint, false, logErrors)</span><span class="s3">\n      </span><span class="s1">await manifestLoader.loadMiddlewareManifest('middleware', 'middleware')</span><span class="s3">\n      </span><span class="s1">const middlewareConfig =</span><span class="s3">\n        </span><span class="s1">manifestLoader.getMiddlewareManifest(key)?.middleware['/']</span><span class="s3">\n\n      </span><span class="s1">if (dev &amp;&amp; middlewareConfig) {</span><span class="s3">\n        </span><span class="s1">dev.serverFields.middleware = {</span><span class="s3">\n          </span><span class="s1">match: null as any,</span><span class="s3">\n          </span><span class="s1">page: '/',</span><span class="s3">\n          </span><span class="s1">matchers: middlewareConfig.matchers,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">finishBuilding()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">await processMiddleware()</span><span class="s3">\n\n    </span><span class="s1">if (dev) {</span><span class="s3">\n      </span><span class="s1">dev?.hooks.subscribeToChanges(</span><span class="s3">\n        </span><span class="s1">key,</span><span class="s3">\n        </span><span class="s1">false,</span><span class="s3">\n        </span><span class="s1">endpoint,</span><span class="s3">\n        </span><span class="s1">async () =&gt; {</span><span class="s3">\n          </span><span class="s1">const finishBuilding = dev.hooks.startBuilding(</span><span class="s3">\n            </span><span class="s1">'middleware',</span><span class="s3">\n            </span><span class="s1">undefined,</span><span class="s3">\n            </span><span class="s1">true</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">await processMiddleware()</span><span class="s3">\n          </span><span class="s1">await dev.hooks.propagateServerField(</span><span class="s3">\n            </span><span class="s1">'actualMiddlewareFile',</span><span class="s3">\n            </span><span class="s1">dev.serverFields.actualMiddlewareFile</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">await dev.hooks.propagateServerField(</span><span class="s3">\n            </span><span class="s1">'middleware',</span><span class="s3">\n            </span><span class="s1">dev.serverFields.middleware</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">await manifestLoader.writeManifests({</span><span class="s3">\n            </span><span class="s1">devRewrites,</span><span class="s3">\n            </span><span class="s1">productionRewrites: undefined,</span><span class="s3">\n            </span><span class="s1">entrypoints: currentEntrypoints,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n\n          </span><span class="s1">finishBuilding?.()</span><span class="s3">\n          </span><span class="s1">return { event: HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES }</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">() =&gt; {</span><span class="s3">\n          </span><span class="s1">return {</span><span class="s3">\n            </span><span class="s1">event: HMR_ACTIONS_SENT_TO_BROWSER.MIDDLEWARE_CHANGES,</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">manifestLoader.deleteMiddlewareManifest(</span><span class="s3">\n      </span><span class="s1">getEntryKey('root', 'server', 'middleware')</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">dev.serverFields.actualMiddlewareFile = undefined</span><span class="s3">\n    </span><span class="s1">dev.serverFields.middleware = undefined</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">await dev.hooks.propagateServerField(</span><span class="s3">\n    </span><span class="s1">'actualMiddlewareFile',</span><span class="s3">\n    </span><span class="s1">dev.serverFields.actualMiddlewareFile</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">await dev.hooks.propagateServerField(</span><span class="s3">\n    </span><span class="s1">'middleware',</span><span class="s3">\n    </span><span class="s1">dev.serverFields.middleware</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">async function handleEntrypointsDevCleanup({</span><span class="s3">\n  </span><span class="s1">currentEntryIssues,</span><span class="s3">\n  </span><span class="s1">currentEntrypoints,</span><span class="s3">\n\n  </span><span class="s1">assetMapper,</span><span class="s3">\n  </span><span class="s1">changeSubscriptions,</span><span class="s3">\n  </span><span class="s1">clients,</span><span class="s3">\n  </span><span class="s1">clientStates,</span><span class="s3">\n\n  </span><span class="s1">hooks,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">currentEntrypoints: Entrypoints</span><span class="s3">\n  </span><span class="s1">currentEntryIssues: EntryIssuesMap</span><span class="s3">\n</span><span class="s1">} &amp; HandleEntrypointsDevOpts) {</span><span class="s3">\n  </span><span class="s1">// this needs to be first as `hasEntrypointForKey` uses the `assetMapper`</span><span class="s3">\n  </span><span class="s1">for (const key of assetMapper.keys()) {</span><span class="s3">\n    </span><span class="s1">if (!hasEntrypointForKey(currentEntrypoints, key, assetMapper)) {</span><span class="s3">\n      </span><span class="s1">assetMapper.delete(key)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">for (const key of changeSubscriptions.keys()) {</span><span class="s3">\n    </span><span class="s1">// middleware is handled separately</span><span class="s3">\n    </span><span class="s1">if (!hasEntrypointForKey(currentEntrypoints, key, assetMapper)) {</span><span class="s3">\n      </span><span class="s1">await hooks.unsubscribeFromChanges(key)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">for (const [key] of currentEntryIssues) {</span><span class="s3">\n    </span><span class="s1">if (!hasEntrypointForKey(currentEntrypoints, key, assetMapper)) {</span><span class="s3">\n      </span><span class="s1">currentEntryIssues.delete(key)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">for (const client of clients) {</span><span class="s3">\n    </span><span class="s1">const state = clientStates.get(client)</span><span class="s3">\n    </span><span class="s1">if (!state) {</span><span class="s3">\n      </span><span class="s1">continue</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">for (const key of state.clientIssues.keys()) {</span><span class="s3">\n      </span><span class="s1">if (!hasEntrypointForKey(currentEntrypoints, key, assetMapper)) {</span><span class="s3">\n        </span><span class="s1">state.clientIssues.delete(key)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">for (const id of state.subscriptions.keys()) {</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">!hasEntrypointForKey(</span><span class="s3">\n          </span><span class="s1">currentEntrypoints,</span><span class="s3">\n          </span><span class="s1">getEntryKey('assets', 'client', id),</span><span class="s3">\n          </span><span class="s1">assetMapper</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">hooks.unsubscribeFromHmrEvents(client, id)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function handlePagesErrorRoute({</span><span class="s3">\n  </span><span class="s1">currentEntryIssues,</span><span class="s3">\n  </span><span class="s1">entrypoints,</span><span class="s3">\n  </span><span class="s1">manifestLoader,</span><span class="s3">\n  </span><span class="s1">devRewrites,</span><span class="s3">\n  </span><span class="s1">productionRewrites,</span><span class="s3">\n  </span><span class="s1">logErrors,</span><span class="s3">\n  </span><span class="s1">hooks,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">currentEntryIssues: EntryIssuesMap</span><span class="s3">\n  </span><span class="s1">entrypoints: Entrypoints</span><span class="s3">\n  </span><span class="s1">manifestLoader: TurbopackManifestLoader</span><span class="s3">\n  </span><span class="s1">devRewrites: SetupOpts['fsChecker']['rewrites'] | undefined</span><span class="s3">\n  </span><span class="s1">productionRewrites: CustomRoutes['rewrites'] | undefined</span><span class="s3">\n  </span><span class="s1">logErrors: boolean</span><span class="s3">\n  </span><span class="s1">hooks: HandleRouteTypeHooks</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">if (entrypoints.global.app) {</span><span class="s3">\n    </span><span class="s1">const key = getEntryKey('pages', 'server', '_app')</span><span class="s3">\n\n    </span><span class="s1">const writtenEndpoint = await entrypoints.global.app.writeToDisk()</span><span class="s3">\n    </span><span class="s1">hooks.handleWrittenEndpoint(key, writtenEndpoint, false)</span><span class="s3">\n    </span><span class="s1">hooks.subscribeToChanges(</span><span class="s3">\n      </span><span class="s1">key,</span><span class="s3">\n      </span><span class="s1">false,</span><span class="s3">\n      </span><span class="s1">entrypoints.global.app,</span><span class="s3">\n      </span><span class="s1">() =&gt; {</span><span class="s3">\n        </span><span class="s1">// There's a special case for this in `../client/page-bootstrap.ts`.</span><span class="s3">\n        </span><span class="s1">// https://github.com/vercel/next.js/blob/08d7a7e5189a835f5dcb82af026174e587575c0e/packages/next/src/client/page-bootstrap.ts#L69-L71</span><span class="s3">\n        </span><span class="s1">return { event: HMR_ACTIONS_SENT_TO_BROWSER.CLIENT_CHANGES }</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">() =&gt; {</span><span class="s3">\n        </span><span class="s1">return {</span><span class="s3">\n          </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,</span><span class="s3">\n          </span><span class="s1">data: '_app has changed (error route)',</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">processIssues(currentEntryIssues, key, writtenEndpoint, false, logErrors)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">await manifestLoader.loadBuildManifest('_app')</span><span class="s3">\n  </span><span class="s1">await manifestLoader.loadPagesManifest('_app')</span><span class="s3">\n  </span><span class="s1">await manifestLoader.loadFontManifest('_app')</span><span class="s3">\n\n  </span><span class="s1">if (entrypoints.global.document) {</span><span class="s3">\n    </span><span class="s1">const key = getEntryKey('pages', 'server', '_document')</span><span class="s3">\n\n    </span><span class="s1">const writtenEndpoint = await entrypoints.global.document.writeToDisk()</span><span class="s3">\n    </span><span class="s1">hooks.handleWrittenEndpoint(key, writtenEndpoint, false)</span><span class="s3">\n    </span><span class="s1">hooks.subscribeToChanges(</span><span class="s3">\n      </span><span class="s1">key,</span><span class="s3">\n      </span><span class="s1">false,</span><span class="s3">\n      </span><span class="s1">entrypoints.global.document,</span><span class="s3">\n      </span><span class="s1">() =&gt; {</span><span class="s3">\n        </span><span class="s1">return {</span><span class="s3">\n          </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,</span><span class="s3">\n          </span><span class="s1">data: '_document has changed (error route)',</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">(e) =&gt; {</span><span class="s3">\n        </span><span class="s1">return {</span><span class="s3">\n          </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,</span><span class="s3">\n          </span><span class="s1">data: `error in _document subscription (error route): ${e}`,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">processIssues(currentEntryIssues, key, writtenEndpoint, false, logErrors)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">await manifestLoader.loadPagesManifest('_document')</span><span class="s3">\n\n  </span><span class="s1">if (entrypoints.global.error) {</span><span class="s3">\n    </span><span class="s1">const key = getEntryKey('pages', 'server', '_error')</span><span class="s3">\n\n    </span><span class="s1">const writtenEndpoint = await entrypoints.global.error.writeToDisk()</span><span class="s3">\n    </span><span class="s1">hooks.handleWrittenEndpoint(key, writtenEndpoint, false)</span><span class="s3">\n    </span><span class="s1">hooks.subscribeToChanges(</span><span class="s3">\n      </span><span class="s1">key,</span><span class="s3">\n      </span><span class="s1">false,</span><span class="s3">\n      </span><span class="s1">entrypoints.global.error,</span><span class="s3">\n      </span><span class="s1">() =&gt; {</span><span class="s3">\n        </span><span class="s1">// There's a special case for this in `../client/page-bootstrap.ts`.</span><span class="s3">\n        </span><span class="s1">// https://github.com/vercel/next.js/blob/08d7a7e5189a835f5dcb82af026174e587575c0e/packages/next/src/client/page-bootstrap.ts#L69-L71</span><span class="s3">\n        </span><span class="s1">return { event: HMR_ACTIONS_SENT_TO_BROWSER.CLIENT_CHANGES }</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">(e) =&gt; {</span><span class="s3">\n        </span><span class="s1">return {</span><span class="s3">\n          </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.RELOAD_PAGE,</span><span class="s3">\n          </span><span class="s1">data: `error in _error subscription: ${e}`,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">processIssues(currentEntryIssues, key, writtenEndpoint, false, logErrors)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">await manifestLoader.loadClientBuildManifest('_error')</span><span class="s3">\n  </span><span class="s1">await manifestLoader.loadBuildManifest('_error')</span><span class="s3">\n  </span><span class="s1">await manifestLoader.loadPagesManifest('_error')</span><span class="s3">\n  </span><span class="s1">await manifestLoader.loadFontManifest('_error')</span><span class="s3">\n\n  </span><span class="s1">await manifestLoader.writeManifests({</span><span class="s3">\n    </span><span class="s1">devRewrites,</span><span class="s3">\n    </span><span class="s1">productionRewrites,</span><span class="s3">\n    </span><span class="s1">entrypoints,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function removeRouteSuffix(route: string): string {</span><span class="s3">\n  </span><span class="s1">return route.replace(/</span><span class="s3">\\</span><span class="s1">/route$/, '')</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function addRouteSuffix(route: string): string {</span><span class="s3">\n  </span><span class="s1">return route + '/route'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function addMetadataIdToRoute(route: string): string {</span><span class="s3">\n  </span><span class="s1">return route + '/[__metadata_id__]'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Since turbopack will create app pages/route entries based on the structure,</span><span class="s3">\n</span><span class="s1">// which means the entry keys are based on file names.</span><span class="s3">\n</span><span class="s1">// But for special metadata conventions we'll change the page/pathname to a different path.</span><span class="s3">\n</span><span class="s1">// So we need this helper to map the new path back to original turbopack entry key.</span><span class="s3">\n</span><span class="s1">export function normalizedPageToTurbopackStructureRoute(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">ext: string | false</span><span class="s3">\n</span><span class="s1">): string {</span><span class="s3">\n  </span><span class="s1">let entrypointKey = route</span><span class="s3">\n  </span><span class="s1">if (isMetadataRoute(entrypointKey)) {</span><span class="s3">\n    </span><span class="s1">entrypointKey = entrypointKey.endsWith('/route')</span><span class="s3">\n      </span><span class="s1">? entrypointKey.slice(0, -'/route'.length)</span><span class="s3">\n      </span><span class="s1">: entrypointKey</span><span class="s3">\n\n    </span><span class="s1">if (ext) {</span><span class="s3">\n      </span><span class="s1">if (entrypointKey.endsWith('/[__metadata_id__]')) {</span><span class="s3">\n        </span><span class="s1">entrypointKey = entrypointKey.slice(0, -'/[__metadata_id__]'.length)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">if (entrypointKey.endsWith('/sitemap.xml') &amp;&amp; ext !== '.xml') {</span><span class="s3">\n        </span><span class="s1">// For dynamic sitemap route, remove the extension</span><span class="s3">\n        </span><span class="s1">entrypointKey = entrypointKey.slice(0, -'.xml'.length)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">entrypointKey = entrypointKey + '/route'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return entrypointKey</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;AssetMapper&quot;</span><span class="s0">,</span><span class="s1">&quot;addMetadataIdToRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;addRouteSuffix&quot;</span><span class="s0">,</span><span class="s1">&quot;handleEntrypoints&quot;</span><span class="s0">,</span><span class="s1">&quot;handlePagesErrorRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;handleRouteType&quot;</span><span class="s0">,</span><span class="s1">&quot;hasEntrypointForKey&quot;</span><span class="s0">,</span><span class="s1">&quot;msToNs&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizedPageToTurbopackStructureRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;printNonFatalIssue&quot;</span><span class="s0">,</span><span class="s1">&quot;processTopLevelIssues&quot;</span><span class="s0">,</span><span class="s1">&quot;removeRouteSuffix&quot;</span><span class="s0">,</span><span class="s1">&quot;onceErrorSet&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldEmitOnceWarning&quot;</span><span class="s0">,</span><span class="s1">&quot;issue&quot;</span><span class="s0">,</span><span class="s1">&quot;severity&quot;</span><span class="s0">,</span><span class="s1">&quot;title&quot;</span><span class="s0">,</span><span class="s1">&quot;stage&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;renderStyledStringToErrorAnsi&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;isRelevantWarning&quot;</span><span class="s0">,</span><span class="s1">&quot;Log&quot;</span><span class="s0">,</span><span class="s1">&quot;warn&quot;</span><span class="s0">,</span><span class="s1">&quot;formatIssue&quot;</span><span class="s0">,</span><span class="s1">&quot;currentTopLevelIssues&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;clear&quot;</span><span class="s0">,</span><span class="s1">&quot;issues&quot;</span><span class="s0">,</span><span class="s1">&quot;issueKey&quot;</span><span class="s0">,</span><span class="s1">&quot;getIssueKey&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;MILLISECONDS_IN_NANOSECOND&quot;</span><span class="s0">,</span><span class="s1">&quot;BigInt&quot;</span><span class="s0">,</span><span class="s1">&quot;ms&quot;</span><span class="s0">,</span><span class="s1">&quot;Math&quot;</span><span class="s0">,</span><span class="s1">&quot;floor&quot;</span><span class="s0">,</span><span class="s1">&quot;dev&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;currentEntryIssues&quot;</span><span class="s0">,</span><span class="s1">&quot;entrypoints&quot;</span><span class="s0">,</span><span class="s1">&quot;manifestLoader&quot;</span><span class="s0">,</span><span class="s1">&quot;readyIds&quot;</span><span class="s0">,</span><span class="s1">&quot;devRewrites&quot;</span><span class="s0">,</span><span class="s1">&quot;productionRewrites&quot;</span><span class="s0">,</span><span class="s1">&quot;hooks&quot;</span><span class="s0">,</span><span class="s1">&quot;logErrors&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldCreateWebpackStats&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;TURBOPACK_STATS&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;clientKey&quot;</span><span class="s0">,</span><span class="s1">&quot;getEntryKey&quot;</span><span class="s0">,</span><span class="s1">&quot;serverKey&quot;</span><span class="s0">,</span><span class="s1">&quot;documentOrAppChanged&quot;</span><span class="s0">,</span><span class="s1">&quot;global&quot;</span><span class="s0">,</span><span class="s1">&quot;app&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;writtenEndpoint&quot;</span><span class="s0">,</span><span class="s1">&quot;writeToDisk&quot;</span><span class="s0">,</span><span class="s1">&quot;handleWrittenEndpoint&quot;</span><span class="s0">,</span><span class="s1">&quot;processIssues&quot;</span><span class="s0">,</span><span class="s1">&quot;loadBuildManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;loadPagesManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;document&quot;</span><span class="s0">,</span><span class="s1">&quot;htmlEndpoint&quot;</span><span class="s0">,</span><span class="s1">&quot;loadClientBuildManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;loadMiddlewareManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;deleteMiddlewareManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;loadFontManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;loadWebpackStats&quot;</span><span class="s0">,</span><span class="s1">&quot;writeManifests&quot;</span><span class="s0">,</span><span class="s1">&quot;subscribeToChanges&quot;</span><span class="s0">,</span><span class="s1">&quot;dataEndpoint&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;event&quot;</span><span class="s0">,</span><span class="s1">&quot;HMR_ACTIONS_SENT_TO_BROWSER&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_ONLY_CHANGES&quot;</span><span class="s0">,</span><span class="s1">&quot;pages&quot;</span><span class="s0">,</span><span class="s1">&quot;e&quot;</span><span class="s0">,</span><span class="s1">&quot;action&quot;</span><span class="s0">,</span><span class="s1">&quot;RELOAD_PAGE&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;CLIENT_CHANGES&quot;</span><span class="s0">,</span><span class="s1">&quot;endpoint&quot;</span><span class="s0">,</span><span class="s1">&quot;rscEndpoint&quot;</span><span class="s0">,</span><span class="s1">&quot;change&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">,</span><span class="s1">&quot;some&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_COMPONENT_CHANGES&quot;</span><span class="s0">,</span><span class="s1">&quot;loadAppBuildManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;loadAppPathsManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;loadActionManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;setPathsForKey&quot;</span><span class="s0">,</span><span class="s1">&quot;assetPaths&quot;</span><span class="s0">,</span><span class="s1">&quot;newAssetPaths&quot;</span><span class="s0">,</span><span class="s1">&quot;entryMap&quot;</span><span class="s0">,</span><span class="s1">&quot;assetPath&quot;</span><span class="s0">,</span><span class="s1">&quot;assetPathKeys&quot;</span><span class="s0">,</span><span class="s1">&quot;assetMap&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;getAssetPathsByKey&quot;</span><span class="s0">,</span><span class="s1">&quot;size&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;getKeysByAsset&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;assetMapper&quot;</span><span class="s0">,</span><span class="s1">&quot;splitEntryKey&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;middleware&quot;</span><span class="s0">,</span><span class="s1">&quot;instrumentation&quot;</span><span class="s0">,</span><span class="s1">&quot;pageKey&quot;</span><span class="s0">,</span><span class="s1">&quot;_&quot;</span><span class="s0">,</span><span class="s1">&quot;currentEntrypoints&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesAppEndpoint&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesDocumentEndpoint&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesErrorEndpoint&quot;</span><span class="s0">,</span><span class="s1">&quot;routes&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;originalName&quot;</span><span class="s0">,</span><span class="s1">&quot;info&quot;</span><span class="s0">,</span><span class="s1">&quot;handleEntrypointsDevCleanup&quot;</span><span class="s0">,</span><span class="s1">&quot;unsubscribeFromChanges&quot;</span><span class="s0">,</span><span class="s1">&quot;sendHmr&quot;</span><span class="s0">,</span><span class="s1">&quot;MIDDLEWARE_CHANGES&quot;</span><span class="s0">,</span><span class="s1">&quot;processInstrumentation&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;prettyName&quot;</span><span class="s0">,</span><span class="s1">&quot;nodeJs&quot;</span><span class="s0">,</span><span class="s1">&quot;edge&quot;</span><span class="s0">,</span><span class="s1">&quot;finishBuilding&quot;</span><span class="s0">,</span><span class="s1">&quot;startBuilding&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;serverFields&quot;</span><span class="s0">,</span><span class="s1">&quot;actualInstrumentationHookFile&quot;</span><span class="s0">,</span><span class="s1">&quot;propagateServerField&quot;</span><span class="s0">,</span><span class="s1">&quot;processMiddleware&quot;</span><span class="s0">,</span><span class="s1">&quot;middlewareConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;getMiddlewareManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;match&quot;</span><span class="s0">,</span><span class="s1">&quot;matchers&quot;</span><span class="s0">,</span><span class="s1">&quot;actualMiddlewareFile&quot;</span><span class="s0">,</span><span class="s1">&quot;changeSubscriptions&quot;</span><span class="s0">,</span><span class="s1">&quot;clients&quot;</span><span class="s0">,</span><span class="s1">&quot;clientStates&quot;</span><span class="s0">,</span><span class="s1">&quot;client&quot;</span><span class="s0">,</span><span class="s1">&quot;state&quot;</span><span class="s0">,</span><span class="s1">&quot;clientIssues&quot;</span><span class="s0">,</span><span class="s1">&quot;id&quot;</span><span class="s0">,</span><span class="s1">&quot;subscriptions&quot;</span><span class="s0">,</span><span class="s1">&quot;unsubscribeFromHmrEvents&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;ext&quot;</span><span class="s0">,</span><span class="s1">&quot;entrypointKey&quot;</span><span class="s0">,</span><span class="s1">&quot;isMetadataRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;;;;;;;;;;;IAybaA,WAAW;eAAXA;;IA4gBGC,oBAAoB;eAApBA;;IAJAC,cAAc;eAAdA;;IApYMC,iBAAiB;eAAjBA;;IAuRAC,qBAAqB;eAArBA;;IAtsBAC,eAAe;eAAfA;;IAsWNC,mBAAmB;eAAnBA;;IA3ZAC,MAAM;eAANA;;IAo3BAC,uCAAuC;eAAvCA;;IAx4BAC,kBAAkB;eAAlBA;;IAMAC,qBAAqB;eAArBA;;IAk3BAC,iBAAiB;eAAjBA;;;kCA96BT;6DACc;0BAQd;iCAEyB;uBAUzB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEP,MAAMC,eAAe,IAAIC;AACzB;;;;;CAKC,GACD,SAASC,sBAAsBC,KAAY;IACzC,MAAM,EAAEC,QAAQ,EAAEC,KAAK,EAAEC,KAAK,EAAE,GAAGH;IACnC,IAAIC,aAAa,aAAaC,MAAME,KAAK,KAAK,8BAA8B;QAC1E,IAAIP,aAAaQ,GAAG,CAACL,QAAQ;YAC3B,OAAO;QACT;QACAH,aAAaS,GAAG,CAACN;IACnB;IACA,IACEC,aAAa,aACbE,UAAU,YACVI,IAAAA,oCAA6B,EAACP,MAAME,KAAK,EAAEM,QAAQ,CAAC,sBACpD;QACA,IAAIX,aAAaQ,GAAG,CAACL,QAAQ;YAC3B,OAAO;QACT;QACAH,aAAaS,GAAG,CAACN;IACnB;IAEA,OAAO;AACT;AAIO,SAASN,mBAAmBM,KAAY;IAC7C,IAAIS,IAAAA,wBAAiB,EAACT,UAAUD,sBAAsBC,QAAQ;QAC5DU,KAAIC,IAAI,CAACC,IAAAA,kBAAW,EAACZ;IACvB;AACF;AAEO,SAASL,sBACdkB,qBAAwC,EACxCC,MAAuB;IAEvBD,sBAAsBE,KAAK;IAE3B,KAAK,MAAMf,SAASc,OAAOE,MAAM,CAAE;QACjC,MAAMC,WAAWC,IAAAA,kBAAW,EAAClB;QAC7Ba,sBAAsBM,GAAG,CAACF,UAAUjB;IACtC;AACF;AAEA,MAAMoB,6BAA6BC,OAAO;AAEnC,SAAS7B,OAAO8B,EAAU;IAC/B,OAAOD,OAAOE,KAAKC,KAAK,CAACF,OAAOF;AAClC;AAmDO,eAAe9B,gBAAgB,EACpCmC,GAAG,EACHC,IAAI,EACJC,QAAQ,EACRC,KAAK,EACLC,kBAAkB,EAClBC,WAAW,EACXC,cAAc,EACdC,QAAQ,EACRC,WAAW,EACXC,kBAAkB,EAClBC,KAAK,EACLC,SAAS,EAiBV;IACC,MAAMC,2BAA2BC,QAAQC,GAAG,CAACC,eAAe,IAAI;IAEhE,OAAQZ,MAAMa,IAAI;QAChB,KAAK;YAAQ;gBACX,MAAMC,YAAYC,IAAAA,qBAAW,EAAC,SAAS,UAAUjB;gBACjD,MAAMkB,YAAYD,IAAAA,qBAAW,EAAC,SAAS,UAAUjB;gBAEjD,IAAI;oBACF,4FAA4F;oBAC5F,sFAAsF;oBACtF,4FAA4F;oBAC5F,4EAA4E;oBAC5E,IAAImB,uBAAuB;oBAC3B,IAAIf,YAAYgB,MAAM,CAACC,GAAG,EAAE;wBAC1B,MAAMC,MAAML,IAAAA,qBAAW,EAAC,SAAS,UAAU;wBAE3C,MAAMM,kBAAkB,MAAMnB,YAAYgB,MAAM,CAACC,GAAG,CAACG,WAAW;wBAChEL,yBACEV,CAAAA,yBAAAA,MAAOgB,qBAAqB,CAACH,KAAKC,iBAAiB,WAAU;wBAC/DG,IAAAA,oBAAa,EACXvB,oBACAmB,KACAC,iBACA,OACAb;oBAEJ;oBACA,MAAML,eAAesB,iBAAiB,CAAC;oBACvC,MAAMtB,eAAeuB,iBAAiB,CAAC;oBAEvC,IAAIxB,YAAYgB,MAAM,CAACS,QAAQ,EAAE;wBAC/B,MAAMP,MAAML,IAAAA,qBAAW,EAAC,SAAS,UAAU;wBAE3C,MAAMM,kBACJ,MAAMnB,YAAYgB,MAAM,CAACS,QAAQ,CAACL,WAAW;wBAC/CL,yBACEV,CAAAA,yBAAAA,MAAOgB,qBAAqB,CAACH,KAAKC,iBAAiB,WAAU;wBAC/DG,IAAAA,oBAAa,EACXvB,oBACAmB,KACAC,iBACA,OACAb;oBAEJ;oBACA,MAAML,eAAeuB,iBAAiB,CAAC;oBAEvC,MAAML,kBAAkB,MAAMrB,MAAM4B,YAAY,CAACN,WAAW;oBAC5Df,yBAAAA,MAAOgB,qBAAqB,CAC1BP,WACAK,iBACAJ;oBAGF,MAAMJ,OAAOQ,mCAAAA,gBAAiBR,IAAI;oBAElC,MAAMV,eAAe0B,uBAAuB,CAAC/B;oBAC7C,MAAMK,eAAesB,iBAAiB,CAAC3B;oBACvC,MAAMK,eAAeuB,iBAAiB,CAAC5B;oBACvC,IAAIe,SAAS,QAAQ;wBACnB,MAAMV,eAAe2B,sBAAsB,CAAChC,MAAM;oBACpD,OAAO;wBACLK,eAAe4B,wBAAwB,CAACf;oBAC1C;oBACA,MAAMb,eAAe6B,gBAAgB,CAAC,SAAS;oBAC/C,MAAM7B,eAAe6B,gBAAgB,CAAClC,MAAM;oBAE5C,IAAIW,0BAA0B;wBAC5B,MAAMN,eAAe8B,gBAAgB,CAACnC,MAAM;oBAC9C;oBAEA,MAAMK,eAAe+B,cAAc,CAAC;wBAClC7B;wBACAC;wBACAJ;oBACF;oBAEAsB,IAAAA,oBAAa,EACXvB,oBACAe,WACAK,iBACA,OACAb;gBAEJ,SAAU;oBACR,IAAIX,KAAK;wBACP,wEAAwE;wBACxE,gEAAgE;wBAChEU,yBAAAA,MAAO4B,kBAAkB,CACvBnB,WACA,OACAhB,MAAMoC,YAAY,EAClB;4BACE,oCAAoC;4BACpChC,4BAAAA,SAAUiC,MAAM,CAACtC;4BACjB,OAAO;gCACLuC,OAAOC,6CAA2B,CAACC,mBAAmB;gCACtDC,OAAO;oCAAC3C;iCAAK;4BACf;wBACF,GACA,CAAC4C;4BACC,OAAO;gCACLC,QAAQJ,6CAA2B,CAACK,WAAW;gCAC/CC,MAAM,CAAC,SAAS,EAAE/C,KAAK,oBAAoB,EAAE4C,GAAG;4BAClD;wBACF;wBAEFnC,yBAAAA,MAAO4B,kBAAkB,CACvBrB,WACA,OACAd,MAAM4B,YAAY,EAClB;4BACE,OAAO;gCACLU,OAAOC,6CAA2B,CAACO,cAAc;4BACnD;wBACF,GACA,CAACJ;4BACC,OAAO;gCACLC,QAAQJ,6CAA2B,CAACK,WAAW;gCAC/CC,MAAM,CAAC,SAAS,EAAE/C,KAAK,oBAAoB,EAAE4C,GAAG;4BAClD;wBACF;wBAEF,IAAIxC,YAAYgB,MAAM,CAACS,QAAQ,EAAE;4BAC/BpB,yBAAAA,MAAO4B,kBAAkB,CACvBpB,IAAAA,qBAAW,EAAC,SAAS,UAAU,cAC/B,OACAb,YAAYgB,MAAM,CAACS,QAAQ,EAC3B;gCACE,OAAO;oCACLgB,QAAQJ,6CAA2B,CAACK,WAAW;oCAC/CC,MAAM;gCACR;4BACF,GACA,CAACH;gCACC,OAAO;oCACLC,QAAQJ,6CAA2B,CAACK,WAAW;oCAC/CC,MAAM,CAAC,8CAA8C,EAAEH,GAAG;gCAC5D;4BACF;wBAEJ;oBACF;gBACF;gBAEA;YACF;QACA,KAAK;YAAY;gBACf,MAAMtB,MAAML,IAAAA,qBAAW,EAAC,SAAS,UAAUjB;gBAE3C,MAAMuB,kBAAkB,MAAMrB,MAAM+C,QAAQ,CAACzB,WAAW;gBACxDf,yBAAAA,MAAOgB,qBAAqB,CAACH,KAAKC,iBAAiB;gBAEnD,MAAMR,OAAOQ,gBAAgBR,IAAI;gBAEjC,MAAMV,eAAeuB,iBAAiB,CAAC5B;gBACvC,IAAIe,SAAS,QAAQ;oBACnB,MAAMV,eAAe2B,sBAAsB,CAAChC,MAAM;gBACpD,OAAO;oBACLK,eAAe4B,wBAAwB,CAACX;gBAC1C;gBAEA,MAAMjB,eAAe+B,cAAc,CAAC;oBAClC7B;oBACAC;oBACAJ;gBACF;gBAEAsB,IAAAA,oBAAa,EAACvB,oBAAoBmB,KAAKC,iBAAiB,MAAMb;gBAE9D;YACF;QACA,KAAK;YAAY;gBACf,MAAMY,MAAML,IAAAA,qBAAW,EAAC,OAAO,UAAUjB;gBAEzC,MAAMuB,kBAAkB,MAAMrB,MAAM4B,YAAY,CAACN,WAAW;gBAC5Df,yBAAAA,MAAOgB,qBAAqB,CAACH,KAAKC,iBAAiB;gBAEnD,IAAIxB,KAAK;oBACP,wEAAwE;oBACxE,gEAAgE;oBAChEU,yBAAAA,MAAO4B,kBAAkB,CACvBf,KACA,MACApB,MAAMgD,WAAW,EACjB,CAACC,QAAQC;wBACP,IAAID,OAAO7D,MAAM,CAAC+D,IAAI,CAAC,CAAC/E,QAAUA,MAAMC,QAAQ,KAAK,UAAU;4BAC7D,qCAAqC;4BACrC,yDAAyD;4BACzD;wBACF;wBACA,oCAAoC;wBACpC+B,4BAAAA,SAAUiC,MAAM,CAACtC;wBACjB,OAAO;4BACL4C,QAAQJ,6CAA2B,CAACa,wBAAwB;4BAC5DF;wBACF;oBACF,GACA,CAACR;wBACC,OAAO;4BACLC,QAAQJ,6CAA2B,CAACK,WAAW;4BAC/CC,MAAM,CAAC,SAAS,EAAE/C,KAAK,wBAAwB,EAAE4C,GAAG;wBACtD;oBACF;gBAEJ;gBAEA,MAAM7B,OAAOQ,gBAAgBR,IAAI;gBAEjC,IAAIA,SAAS,QAAQ;oBACnB,MAAMV,eAAe2B,sBAAsB,CAAChC,MAAM;gBACpD,OAAO;oBACLK,eAAe4B,wBAAwB,CAACX;gBAC1C;gBAEA,MAAMjB,eAAekD,oBAAoB,CAACvD;gBAC1C,MAAMK,eAAesB,iBAAiB,CAAC3B,MAAM;gBAC7C,MAAMK,eAAemD,oBAAoB,CAACxD;gBAC1C,MAAMK,eAAeoD,kBAAkB,CAACzD;gBACxC,MAAMK,eAAe6B,gBAAgB,CAAClC,MAAM;gBAE5C,IAAIW,0BAA0B;oBAC5B,MAAMN,eAAe8B,gBAAgB,CAACnC,MAAM;gBAC9C;gBAEA,MAAMK,eAAe+B,cAAc,CAAC;oBAClC7B;oBACAC;oBACAJ;gBACF;gBAEAsB,IAAAA,oBAAa,EAACvB,oBAAoBmB,KAAKC,iBAAiBxB,KAAKW;gBAE7D;YACF;QACA,KAAK;YAAa;gBAChB,MAAMY,MAAML,IAAAA,qBAAW,EAAC,OAAO,UAAUjB;gBAEzC,MAAMuB,kBAAkB,MAAMrB,MAAM+C,QAAQ,CAACzB,WAAW;gBACxDf,yBAAAA,MAAOgB,qBAAqB,CAACH,KAAKC,iBAAiB;gBAEnD,MAAMR,OAAOQ,gBAAgBR,IAAI;gBAEjC,MAAMV,eAAemD,oBAAoB,CAACxD;gBAE1C,IAAIe,SAAS,QAAQ;oBACnB,MAAMV,eAAe2B,sBAAsB,CAAChC,MAAM;gBACpD,OAAO;oBACLK,eAAe4B,wBAAwB,CAACX;gBAC1C;gBAEA,MAAMjB,eAAe+B,cAAc,CAAC;oBAClC7B;oBACAC;oBACAJ;gBACF;gBACAsB,IAAAA,oBAAa,EAACvB,oBAAoBmB,KAAKC,iBAAiB,MAAMb;gBAE9D;YACF;QACA;YAAS;gBACP,MAAM,qBAAkE,CAAlE,IAAIgD,MAAM,CAAC,mBAAmB,EAAE,AAACxD,MAAca,IAAI,CAAC,KAAK,EAAEf,MAAM,GAAjE,qBAAA;2BAAA;gCAAA;kCAAA;gBAAiE;YACzE;IACF;AACF;AAKO,MAAMzC;IAIX;;;;;GAKC,GACDoG,eAAerC,GAAa,EAAEsC,UAAoB,EAAQ;QACxD,IAAI,CAACrB,MAAM,CAACjB;QAEZ,MAAMuC,gBAAgB,IAAIzF,IAAIwF;QAC9B,IAAI,CAACE,QAAQ,CAACrE,GAAG,CAAC6B,KAAKuC;QAEvB,KAAK,MAAME,aAAaF,cAAe;YACrC,IAAIG,gBAAgB,IAAI,CAACC,QAAQ,CAACC,GAAG,CAACH;YACtC,IAAI,CAACC,eAAe;gBAClBA,gBAAgB,IAAI5F;gBACpB,IAAI,CAAC6F,QAAQ,CAACxE,GAAG,CAACsE,WAAWC;YAC/B;YAEAA,cAAepF,GAAG,CAAC0C;QACrB;IACF;IAEA;;;;GAIC,GACDiB,OAAOjB,GAAa,EAAE;QACpB,KAAK,MAAMyC,aAAa,IAAI,CAACI,kBAAkB,CAAC7C,KAAM;YACpD,MAAM0C,gBAAgB,IAAI,CAACC,QAAQ,CAACC,GAAG,CAACH;YAExCC,iCAAAA,cAAezB,MAAM,CAACjB;YAEtB,IAAI,EAAC0C,iCAAAA,cAAeI,IAAI,GAAE;gBACxB,IAAI,CAACH,QAAQ,CAAC1B,MAAM,CAACwB;YACvB;QACF;QAEA,IAAI,CAACD,QAAQ,CAACvB,MAAM,CAACjB;IACvB;IAEA6C,mBAAmB7C,GAAa,EAAY;QAC1C,OAAO+C,MAAMC,IAAI,CAAC,IAAI,CAACR,QAAQ,CAACI,GAAG,CAAC5C,QAAQ,EAAE;IAChD;IAEAiD,eAAeC,IAAY,EAAc;QACvC,OAAOH,MAAMC,IAAI,CAAC,IAAI,CAACL,QAAQ,CAACC,GAAG,CAACM,SAAS,EAAE;IACjD;IAEAC,OAAmC;QACjC,OAAO,IAAI,CAACX,QAAQ,CAACW,IAAI;IAC3B;;aAvDQX,WAAuC,IAAIY;aAC3CT,WAAuC,IAAIS;;AAuDrD;AAEO,SAAS7G,oBACduC,WAAwB,EACxBkB,GAAa,EACbqD,WAAoC;IAEpC,MAAM,EAAE5D,IAAI,EAAEf,IAAI,EAAE,GAAG4E,IAAAA,uBAAa,EAACtD;IAErC,OAAQP;QACN,KAAK;YACH,OAAOX,YAAYiB,GAAG,CAAC1C,GAAG,CAACqB;QAC7B,KAAK;YACH,OAAQA;gBACN,KAAK;oBACH,OAAOI,YAAYgB,MAAM,CAACC,GAAG,IAAI;gBACnC,KAAK;oBACH,OAAOjB,YAAYgB,MAAM,CAACS,QAAQ,IAAI;gBACxC,KAAK;oBACH,OAAOzB,YAAYgB,MAAM,CAACyD,KAAK,IAAI;gBACrC;oBACE,OAAOzE,YAAYJ,IAAI,CAACrB,GAAG,CAACqB;YAChC;QACF,KAAK;YACH,OAAQA;gBACN,KAAK;oBACH,OAAOI,YAAYgB,MAAM,CAAC0D,UAAU,IAAI;gBAC1C,KAAK;oBACH,OAAO1E,YAAYgB,MAAM,CAAC2D,eAAe,IAAI;gBAC/C;oBACE,OAAO;YACX;QACF,KAAK;YACH,IAAI,CAACJ,aAAa;gBAChB,OAAO;YACT;YAEA,OAAOA,YACJJ,cAAc,CAACvE,MACfqD,IAAI,CAAC,CAAC2B,UACLnH,oBAAoBuC,aAAa4E,SAASL;QAEhD;YAAS;gBACP,+DAA+D;gBAC/D,6DAA6D;gBAC7D,MAAMM,IAAWlE;gBACjB,OAAO;YACT;IACF;AACF;AA0BO,eAAerD,kBAAkB,EACtC0C,WAAW,EAEX8E,kBAAkB,EAElB/E,kBAAkB,EAClBE,cAAc,EACdE,WAAW,EACXG,SAAS,EACTX,GAAG,EAaJ;IACCmF,mBAAmB9D,MAAM,CAACC,GAAG,GAAGjB,YAAY+E,gBAAgB;IAC5DD,mBAAmB9D,MAAM,CAACS,QAAQ,GAAGzB,YAAYgF,qBAAqB;IACtEF,mBAAmB9D,MAAM,CAACyD,KAAK,GAAGzE,YAAYiF,kBAAkB;IAEhEH,mBAAmB9D,MAAM,CAAC2D,eAAe,GAAG3E,YAAY2E,eAAe;IAEvEG,mBAAmBlF,IAAI,CAACX,KAAK;IAC7B6F,mBAAmB7D,GAAG,CAAChC,KAAK;IAE5B,KAAK,MAAM,CAACY,UAAUC,MAAM,IAAIE,YAAYkF,MAAM,CAAE;QAClD,OAAQpF,MAAMa,IAAI;YAChB,KAAK;YACL,KAAK;gBACHmE,mBAAmBlF,IAAI,CAACP,GAAG,CAACQ,UAAUC;gBACtC;YACF,KAAK;gBAAY;oBACfA,MAAMyC,KAAK,CAAC4C,OAAO,CAAC,CAACvF;wBACnBkF,mBAAmB7D,GAAG,CAAC5B,GAAG,CAACO,KAAKwF,YAAY,EAAE;4BAC5CzE,MAAM;4BACN,GAAGf,IAAI;wBACT;oBACF;oBACA;gBACF;YACA,KAAK;gBAAa;oBAChBkF,mBAAmB7D,GAAG,CAAC5B,GAAG,CAACS,MAAMsF,YAAY,EAAEtF;oBAC/C;gBACF;YACA,KAAK;gBACHlB,KAAIyG,IAAI,CAAC,CAAC,SAAS,EAAExF,SAAS,EAAE,EAAEC,MAAMa,IAAI,CAAC,CAAC,CAAC;gBAC/C;YACF;gBACEb;QACJ;IACF;IAEA,IAAIH,KAAK;QACP,MAAM2F,4BAA4B;YAChCvF;YACA+E;YAEA,GAAGnF,GAAG;QACR;IACF;IAEA,MAAM,EAAE+E,UAAU,EAAEC,eAAe,EAAE,GAAG3E;IAExC,8DAA8D;IAC9D,8DAA8D;IAC9D,sCAAsC;IACtC,IAAI8E,mBAAmB9D,MAAM,CAAC0D,UAAU,IAAI,CAACA,YAAY;QACvD,MAAMxD,MAAML,IAAAA,qBAAW,EAAC,QAAQ,UAAU;QAC1C,wCAAwC;QACxC,OAAMlB,uBAAAA,IAAKU,KAAK,CAACkF,sBAAsB,CAACrE;QACxCnB,mBAAmBoC,MAAM,CAACjB;QAC1BvB,IAAIU,KAAK,CAACmF,OAAO,CAAC,cAAc;YAC9BpD,OAAOC,6CAA2B,CAACoD,kBAAkB;QACvD;IACF,OAAO,IAAI,CAACX,mBAAmB9D,MAAM,CAAC0D,UAAU,IAAIA,YAAY;QAC9D,wCAAwC;QACxC/E,IAAIU,KAAK,CAACmF,OAAO,CAAC,cAAc;YAC9BpD,OAAOC,6CAA2B,CAACoD,kBAAkB;QACvD;IACF;IAEAX,mBAAmB9D,MAAM,CAAC0D,UAAU,GAAGA;IAEvC,IAAIC,iBAAiB;QACnB,MAAMe,yBAAyB,OAC7BC,MACAC;YAEA,MAAMC,aAAa;gBACjBC,QAAQ;gBACRC,MAAM;YACR;YACA,MAAMC,iBAAiBrG,IAAIU,KAAK,CAAC4F,aAAa,CAC5C,CAAC,gBAAgB,EAAEJ,UAAU,CAACD,KAAK,EAAE,EACrCM,WACA;YAEF,MAAMhF,MAAML,IAAAA,qBAAW,EAAC,QAAQ,UAAU8E;YAE1C,MAAMxE,kBAAkB,MAAMwD,eAAe,CAACiB,KAAK,CAACxE,WAAW;YAC/DzB,IAAIU,KAAK,CAACgB,qBAAqB,CAACH,KAAKC,iBAAiB;YACtDG,IAAAA,oBAAa,EAACvB,oBAAoBmB,KAAKC,iBAAiB,OAAOb;YAC/D0F;QACF;QACA,MAAMN,uBAAuB,0BAA0B;QACvD,MAAMA,uBAAuB,wBAAwB;QACrD,MAAMzF,eAAe2B,sBAAsB,CACzC,mBACA;QAEF,MAAM3B,eAAe+B,cAAc,CAAC;YAClC7B;YACAC,oBAAoB8F;YACpBlG,aAAa8E;QACf;QAEAnF,IAAIwG,YAAY,CAACC,6BAA6B,GAAG;QACjD,MAAMzG,IAAIU,KAAK,CAACgG,oBAAoB,CAClC,iCACA1G,IAAIwG,YAAY,CAACC,6BAA6B;IAElD,OAAO;QACLzG,IAAIwG,YAAY,CAACC,6BAA6B,GAAGF;QACjD,MAAMvG,IAAIU,KAAK,CAACgG,oBAAoB,CAClC,iCACA1G,IAAIwG,YAAY,CAACC,6BAA6B;IAElD;IAEA,IAAI1B,YAAY;QACd,MAAMxD,MAAML,IAAAA,qBAAW,EAAC,QAAQ,UAAU;QAE1C,MAAMgC,WAAW6B,WAAW7B,QAAQ;QAEpC,eAAeyD;gBAWXrG;YAVF,MAAM+F,iBAAiBrG,IAAIU,KAAK,CAAC4F,aAAa,CAC5C,cACAC,WACA;YAEF,MAAM/E,kBAAkB,MAAM0B,SAASzB,WAAW;YAClDzB,IAAIU,KAAK,CAACgB,qBAAqB,CAACH,KAAKC,iBAAiB;YACtDG,IAAAA,oBAAa,EAACvB,oBAAoBmB,KAAKC,iBAAiB,OAAOb;YAC/D,MAAML,eAAe2B,sBAAsB,CAAC,cAAc;YAC1D,MAAM2E,oBACJtG,wCAAAA,eAAeuG,qBAAqB,CAACtF,yBAArCjB,sCAA2CyE,UAAU,CAAC,IAAI;YAE5D,IAAI/E,OAAO4G,kBAAkB;gBAC3B5G,IAAIwG,YAAY,CAACzB,UAAU,GAAG;oBAC5B+B,OAAO;oBACP7G,MAAM;oBACN8G,UAAUH,iBAAiBG,QAAQ;gBACrC;YACF;YACAV;QACF;QACA,MAAMM;QAEN,IAAI3G,KAAK;YACPA,uBAAAA,IAAKU,KAAK,CAAC4B,kBAAkB,CAC3Bf,KACA,OACA2B,UACA;gBACE,MAAMmD,iBAAiBrG,IAAIU,KAAK,CAAC4F,aAAa,CAC5C,cACAC,WACA;gBAEF,MAAMI;gBACN,MAAM3G,IAAIU,KAAK,CAACgG,oBAAoB,CAClC,wBACA1G,IAAIwG,YAAY,CAACQ,oBAAoB;gBAEvC,MAAMhH,IAAIU,KAAK,CAACgG,oBAAoB,CAClC,cACA1G,IAAIwG,YAAY,CAACzB,UAAU;gBAE7B,MAAMzE,eAAe+B,cAAc,CAAC;oBAClC7B;oBACAC,oBAAoB8F;oBACpBlG,aAAa8E;gBACf;gBAEAkB,kCAAAA;gBACA,OAAO;oBAAE5D,OAAOC,6CAA2B,CAACoD,kBAAkB;gBAAC;YACjE,GACA;gBACE,OAAO;oBACLrD,OAAOC,6CAA2B,CAACoD,kBAAkB;gBACvD;YACF;QAEJ;IACF,OAAO;QACLxF,eAAe4B,wBAAwB,CACrChB,IAAAA,qBAAW,EAAC,QAAQ,UAAU;QAEhClB,IAAIwG,YAAY,CAACQ,oBAAoB,GAAGT;QACxCvG,IAAIwG,YAAY,CAACzB,UAAU,GAAGwB;IAChC;IAEA,MAAMvG,IAAIU,KAAK,CAACgG,oBAAoB,CAClC,wBACA1G,IAAIwG,YAAY,CAACQ,oBAAoB;IAEvC,MAAMhH,IAAIU,KAAK,CAACgG,oBAAoB,CAClC,cACA1G,IAAIwG,YAAY,CAACzB,UAAU;AAE/B;AAEA,eAAeY,4BAA4B,EACzCvF,kBAAkB,EAClB+E,kBAAkB,EAElBP,WAAW,EACXqC,mBAAmB,EACnBC,OAAO,EACPC,YAAY,EAEZzG,KAAK,EAIqB;IAC1B,yEAAyE;IACzE,KAAK,MAAMa,OAAOqD,YAAYF,IAAI,GAAI;QACpC,IAAI,CAAC5G,oBAAoBqH,oBAAoB5D,KAAKqD,cAAc;YAC9DA,YAAYpC,MAAM,CAACjB;QACrB;IACF;IAEA,KAAK,MAAMA,OAAO0F,oBAAoBvC,IAAI,GAAI;QAC5C,mCAAmC;QACnC,IAAI,CAAC5G,oBAAoBqH,oBAAoB5D,KAAKqD,cAAc;YAC9D,MAAMlE,MAAMkF,sBAAsB,CAACrE;QACrC;IACF;IAEA,KAAK,MAAM,CAACA,IAAI,IAAInB,mBAAoB;QACtC,IAAI,CAACtC,oBAAoBqH,oBAAoB5D,KAAKqD,cAAc;YAC9DxE,mBAAmBoC,MAAM,CAACjB;QAC5B;IACF;IAEA,KAAK,MAAM6F,UAAUF,QAAS;QAC5B,MAAMG,QAAQF,aAAahD,GAAG,CAACiD;QAC/B,IAAI,CAACC,OAAO;YACV;QACF;QAEA,KAAK,MAAM9F,OAAO8F,MAAMC,YAAY,CAAC5C,IAAI,GAAI;YAC3C,IAAI,CAAC5G,oBAAoBqH,oBAAoB5D,KAAKqD,cAAc;gBAC9DyC,MAAMC,YAAY,CAAC9E,MAAM,CAACjB;YAC5B;QACF;QAEA,KAAK,MAAMgG,MAAMF,MAAMG,aAAa,CAAC9C,IAAI,GAAI;YAC3C,IACE,CAAC5G,oBACCqH,oBACAjE,IAAAA,qBAAW,EAAC,UAAU,UAAUqG,KAChC3C,cAEF;gBACAlE,MAAM+G,wBAAwB,CAACL,QAAQG;YACzC;QACF;IACF;AACF;AAEO,eAAe3J,sBAAsB,EAC1CwC,kBAAkB,EAClBC,WAAW,EACXC,cAAc,EACdE,WAAW,EACXC,kBAAkB,EAClBE,SAAS,EACTD,KAAK,EASN;IACC,IAAIL,YAAYgB,MAAM,CAACC,GAAG,EAAE;QAC1B,MAAMC,MAAML,IAAAA,qBAAW,EAAC,SAAS,UAAU;QAE3C,MAAMM,kBAAkB,MAAMnB,YAAYgB,MAAM,CAACC,GAAG,CAACG,WAAW;QAChEf,MAAMgB,qBAAqB,CAACH,KAAKC,iBAAiB;QAClDd,MAAM4B,kBAAkB,CACtBf,KACA,OACAlB,YAAYgB,MAAM,CAACC,GAAG,EACtB;YACE,oEAAoE;YACpE,qIAAqI;YACrI,OAAO;gBAAEmB,OAAOC,6CAA2B,CAACO,cAAc;YAAC;QAC7D,GACA;YACE,OAAO;gBACLH,QAAQJ,6CAA2B,CAACK,WAAW;gBAC/CC,MAAM;YACR;QACF;QAEFrB,IAAAA,oBAAa,EAACvB,oBAAoBmB,KAAKC,iBAAiB,OAAOb;IACjE;IACA,MAAML,eAAesB,iBAAiB,CAAC;IACvC,MAAMtB,eAAeuB,iBAAiB,CAAC;IACvC,MAAMvB,eAAe6B,gBAAgB,CAAC;IAEtC,IAAI9B,YAAYgB,MAAM,CAACS,QAAQ,EAAE;QAC/B,MAAMP,MAAML,IAAAA,qBAAW,EAAC,SAAS,UAAU;QAE3C,MAAMM,kBAAkB,MAAMnB,YAAYgB,MAAM,CAACS,QAAQ,CAACL,WAAW;QACrEf,MAAMgB,qBAAqB,CAACH,KAAKC,iBAAiB;QAClDd,MAAM4B,kBAAkB,CACtBf,KACA,OACAlB,YAAYgB,MAAM,CAACS,QAAQ,EAC3B;YACE,OAAO;gBACLgB,QAAQJ,6CAA2B,CAACK,WAAW;gBAC/CC,MAAM;YACR;QACF,GACA,CAACH;YACC,OAAO;gBACLC,QAAQJ,6CAA2B,CAACK,WAAW;gBAC/CC,MAAM,CAAC,+CAA+C,EAAEH,GAAG;YAC7D;QACF;QAEFlB,IAAAA,oBAAa,EAACvB,oBAAoBmB,KAAKC,iBAAiB,OAAOb;IACjE;IACA,MAAML,eAAeuB,iBAAiB,CAAC;IAEvC,IAAIxB,YAAYgB,MAAM,CAACyD,KAAK,EAAE;QAC5B,MAAMvD,MAAML,IAAAA,qBAAW,EAAC,SAAS,UAAU;QAE3C,MAAMM,kBAAkB,MAAMnB,YAAYgB,MAAM,CAACyD,KAAK,CAACrD,WAAW;QAClEf,MAAMgB,qBAAqB,CAACH,KAAKC,iBAAiB;QAClDd,MAAM4B,kBAAkB,CACtBf,KACA,OACAlB,YAAYgB,MAAM,CAACyD,KAAK,EACxB;YACE,oEAAoE;YACpE,qIAAqI;YACrI,OAAO;gBAAErC,OAAOC,6CAA2B,CAACO,cAAc;YAAC;QAC7D,GACA,CAACJ;YACC,OAAO;gBACLC,QAAQJ,6CAA2B,CAACK,WAAW;gBAC/CC,MAAM,CAAC,8BAA8B,EAAEH,GAAG;YAC5C;QACF;QAEFlB,IAAAA,oBAAa,EAACvB,oBAAoBmB,KAAKC,iBAAiB,OAAOb;IACjE;IACA,MAAML,eAAe0B,uBAAuB,CAAC;IAC7C,MAAM1B,eAAesB,iBAAiB,CAAC;IACvC,MAAMtB,eAAeuB,iBAAiB,CAAC;IACvC,MAAMvB,eAAe6B,gBAAgB,CAAC;IAEtC,MAAM7B,eAAe+B,cAAc,CAAC;QAClC7B;QACAC;QACAJ;IACF;AACF;AAEO,SAASlC,kBAAkBgC,KAAa;IAC7C,OAAOA,MAAMuH,OAAO,CAAC,YAAY;AACnC;AAEO,SAAShK,eAAeyC,KAAa;IAC1C,OAAOA,QAAQ;AACjB;AAEO,SAAS1C,qBAAqB0C,KAAa;IAChD,OAAOA,QAAQ;AACjB;AAMO,SAASnC,wCACdmC,KAAa,EACbwH,GAAmB;IAEnB,IAAIC,gBAAgBzH;IACpB,IAAI0H,IAAAA,gCAAe,EAACD,gBAAgB;QAClCA,gBAAgBA,cAAcE,QAAQ,CAAC,YACnCF,cAAcG,KAAK,CAAC,GAAG,CAAC,SAASC,MAAM,IACvCJ;QAEJ,IAAID,KAAK;YACP,IAAIC,cAAcE,QAAQ,CAAC,uBAAuB;gBAChDF,gBAAgBA,cAAcG,KAAK,CAAC,GAAG,CAAC,qBAAqBC,MAAM;YACrE;YACA,IAAIJ,cAAcE,QAAQ,CAAC,mBAAmBH,QAAQ,QAAQ;gBAC5D,kDAAkD;gBAClDC,gBAAgBA,cAAcG,KAAK,CAAC,GAAG,CAAC,OAAOC,MAAM;YACvD;QACF;QACAJ,gBAAgBA,gBAAgB;IAClC;IACA,OAAOA;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>