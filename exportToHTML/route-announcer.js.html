<html>
<head>
<title>route-announcer.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #1750eb;}
.s4 { color: #8c8c8c; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
route-announcer.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, {</span>
    <span class="s1">value: </span><span class="s2">true</span>
<span class="s1">});</span>
<span class="s3">0 </span><span class="s1">&amp;&amp; (module.exports = {</span>
    <span class="s1">RouteAnnouncer: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s2">default</span><span class="s1">: </span><span class="s2">null</span>
<span class="s1">});</span>
<span class="s2">function </span><span class="s1">_export(target, all) {</span>
    <span class="s2">for</span><span class="s1">(</span><span class="s2">var </span><span class="s1">name </span><span class="s2">in </span><span class="s1">all)Object.defineProperty(target, name, {</span>
        <span class="s1">enumerable: </span><span class="s2">true</span><span class="s1">,</span>
        <span class="s1">get: all[name]</span>
    <span class="s1">});</span>
<span class="s1">}</span>
<span class="s1">_export(exports, {</span>
    <span class="s1">RouteAnnouncer: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">RouteAnnouncer;</span>
    <span class="s1">},</span>
    <span class="s2">default</span><span class="s1">: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">_default;</span>
    <span class="s1">}</span>
<span class="s1">});</span>
<span class="s2">const </span><span class="s1">_interop_require_default = require(</span><span class="s0">&quot;@swc/helpers/_/_interop_require_default&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">_jsxruntime = require(</span><span class="s0">&quot;react/jsx-runtime&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">_react = </span><span class="s4">/*#__PURE__*/ </span><span class="s1">_interop_require_default._(require(</span><span class="s0">&quot;react&quot;</span><span class="s1">));</span>
<span class="s2">const </span><span class="s1">_router = require(</span><span class="s0">&quot;./router&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">nextjsRouteAnnouncerStyles = {</span>
    <span class="s1">border: </span><span class="s3">0</span><span class="s1">,</span>
    <span class="s1">clip: </span><span class="s0">'rect(0 0 0 0)'</span><span class="s1">,</span>
    <span class="s1">height: </span><span class="s0">'1px'</span><span class="s1">,</span>
    <span class="s1">margin: </span><span class="s0">'-1px'</span><span class="s1">,</span>
    <span class="s1">overflow: </span><span class="s0">'hidden'</span><span class="s1">,</span>
    <span class="s1">padding: </span><span class="s3">0</span><span class="s1">,</span>
    <span class="s1">position: </span><span class="s0">'absolute'</span><span class="s1">,</span>
    <span class="s1">top: </span><span class="s3">0</span><span class="s1">,</span>
    <span class="s1">width: </span><span class="s0">'1px'</span><span class="s1">,</span>
    <span class="s4">// https://medium.com/@jessebeach/beware-smushed-off-screen-accessible-text-5952a4c2cbfe</span>
    <span class="s1">whiteSpace: </span><span class="s0">'nowrap'</span><span class="s1">,</span>
    <span class="s1">wordWrap: </span><span class="s0">'normal'</span>
<span class="s1">};</span>
<span class="s2">const </span><span class="s1">RouteAnnouncer = ()=&gt;{</span>
    <span class="s2">const </span><span class="s1">{ asPath } = (</span><span class="s3">0</span><span class="s1">, _router.useRouter)();</span>
    <span class="s2">const </span><span class="s1">[routeAnnouncement, setRouteAnnouncement] = _react.default.useState(</span><span class="s0">''</span><span class="s1">);</span>
    <span class="s4">// Only announce the path change, but not for the first load because screen</span>
    <span class="s4">// reader will do that automatically.</span>
    <span class="s2">const </span><span class="s1">previouslyLoadedPath = _react.default.useRef(asPath);</span>
    <span class="s4">// Every time the path changes, announce the new page’s title following this</span>
    <span class="s4">// priority: first the document title (from head), otherwise the first h1, or</span>
    <span class="s4">// if none of these exist, then the pathname from the URL. This methodology is</span>
    <span class="s4">// inspired by Marcy Sutton’s accessible client routing user testing. More</span>
    <span class="s4">// information can be found here:</span>
    <span class="s4">// https://www.gatsbyjs.com/blog/2019-07-11-user-testing-accessible-client-routing/</span>
    <span class="s1">_react.default.useEffect(()=&gt;{</span>
        <span class="s4">// If the path hasn't change, we do nothing.</span>
        <span class="s2">if </span><span class="s1">(previouslyLoadedPath.current === asPath) </span><span class="s2">return</span><span class="s1">;</span>
        <span class="s1">previouslyLoadedPath.current = asPath;</span>
        <span class="s2">if </span><span class="s1">(document.title) {</span>
            <span class="s1">setRouteAnnouncement(document.title);</span>
        <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
            <span class="s2">const </span><span class="s1">pageHeader = document.querySelector(</span><span class="s0">'h1'</span><span class="s1">);</span>
            <span class="s2">var </span><span class="s1">_pageHeader_innerText;</span>
            <span class="s2">const </span><span class="s1">content = (_pageHeader_innerText = pageHeader == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: pageHeader.innerText) != </span><span class="s2">null </span><span class="s1">? _pageHeader_innerText : pageHeader == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: pageHeader.textContent;</span>
            <span class="s1">setRouteAnnouncement(content || asPath);</span>
        <span class="s1">}</span>
    <span class="s1">}, </span><span class="s4">// TODO: switch to pathname + query object of dynamic route requirements</span>
    <span class="s1">[</span>
        <span class="s1">asPath</span>
    <span class="s1">]);</span>
    <span class="s2">return </span><span class="s4">/*#__PURE__*/ </span><span class="s1">(</span><span class="s3">0</span><span class="s1">, _jsxruntime.jsx)(</span><span class="s0">&quot;p&quot;</span><span class="s1">, {</span>
        <span class="s0">&quot;aria-live&quot;</span><span class="s1">: </span><span class="s0">&quot;assertive&quot; </span><span class="s4">// Make the announcement immediately.</span>
        <span class="s1">,</span>
        <span class="s1">id: </span><span class="s0">&quot;__next-route-announcer__&quot;</span><span class="s1">,</span>
        <span class="s1">role: </span><span class="s0">&quot;alert&quot;</span><span class="s1">,</span>
        <span class="s1">style: nextjsRouteAnnouncerStyles,</span>
        <span class="s1">children: routeAnnouncement</span>
    <span class="s1">});</span>
<span class="s1">};</span>
<span class="s2">const </span><span class="s1">_default = RouteAnnouncer;</span>

<span class="s2">if </span><span class="s1">((</span><span class="s2">typeof </span><span class="s1">exports.default === </span><span class="s0">'function' </span><span class="s1">|| (</span><span class="s2">typeof </span><span class="s1">exports.default === </span><span class="s0">'object' </span><span class="s1">&amp;&amp; exports.default !== </span><span class="s2">null</span><span class="s1">)) &amp;&amp; </span><span class="s2">typeof </span><span class="s1">exports.default.__esModule === </span><span class="s0">'undefined'</span><span class="s1">) {</span>
  <span class="s1">Object.defineProperty(exports.default, </span><span class="s0">'__esModule'</span><span class="s1">, { value: </span><span class="s2">true </span><span class="s1">});</span>
  <span class="s1">Object.assign(exports.default, exports);</span>
  <span class="s1">module.exports = exports.default;</span>
<span class="s1">}</span>

<span class="s4">//# sourceMappingURL=route-announcer.js.map</span></pre>
</body>
</html>