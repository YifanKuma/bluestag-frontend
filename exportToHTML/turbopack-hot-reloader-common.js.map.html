<html>
<head>
<title>turbopack-hot-reloader-common.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
turbopack-hot-reloader-common.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/client/dev/hot-reloader/turbopack-hot-reloader-common.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { TurbopackMessageAction } from '../../../server/dev/hot-reloader-types'</span><span class="s3">\n</span><span class="s1">import type { Update as TurbopackUpdate } from '../../../build/swc/types'</span><span class="s3">\n\n</span><span class="s1">declare global {</span><span class="s3">\n  </span><span class="s1">interface Window {</span><span class="s3">\n    </span><span class="s1">__NEXT_HMR_TURBOPACK_REPORT_NOISY_NOOP_EVENTS: boolean | undefined</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// How long to wait before reporting the HMR start, used to suppress irrelevant</span><span class="s3">\n</span><span class="s1">// `BUILDING` events. Does not impact reported latency.</span><span class="s3">\n</span><span class="s1">const TURBOPACK_HMR_START_DELAY_MS = 100</span><span class="s3">\n\n</span><span class="s1">interface HmrUpdate {</span><span class="s3">\n  </span><span class="s1">hasUpdates: boolean</span><span class="s3">\n  </span><span class="s1">updatedModules: Set&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">startMsSinceEpoch: number</span><span class="s3">\n  </span><span class="s1">endMsSinceEpoch: number</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class TurbopackHmr {</span><span class="s3">\n  </span><span class="s1">#updatedModules: Set&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">#startMsSinceEpoch: number | undefined</span><span class="s3">\n  </span><span class="s1">#lastUpdateMsSinceEpoch: number | undefined</span><span class="s3">\n  </span><span class="s1">#deferredReportHmrStartId: ReturnType&lt;typeof setTimeout&gt; | undefined</span><span class="s3">\n  </span><span class="s1">#reportedHmrStart: boolean</span><span class="s3">\n\n  </span><span class="s1">constructor() {</span><span class="s3">\n    </span><span class="s1">this.#updatedModules = new Set()</span><span class="s3">\n    </span><span class="s1">this.#reportedHmrStart = false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// HACK: Turbopack tends to generate a lot of irrelevant </span><span class="s3">\&quot;</span><span class="s1">BUILDING</span><span class="s3">\&quot; </span><span class="s1">actions,</span><span class="s3">\n  </span><span class="s1">// as it reports *any* compilation, including fully no-op/cached compilations</span><span class="s3">\n  </span><span class="s1">// and those unrelated to HMR. Fixing this would require significant</span><span class="s3">\n  </span><span class="s1">// architectural changes.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// Work around this by deferring any </span><span class="s3">\&quot;</span><span class="s1">rebuilding</span><span class="s3">\&quot; </span><span class="s1">message by 100ms. If we get</span><span class="s3">\n  </span><span class="s1">// a BUILT event within that threshold and nothing has changed, just suppress</span><span class="s3">\n  </span><span class="s1">// the message entirely.</span><span class="s3">\n  </span><span class="s1">#runDeferredReportHmrStart() {</span><span class="s3">\n    </span><span class="s1">if (this.#deferredReportHmrStartId != null) {</span><span class="s3">\n      </span><span class="s1">console.log('[Fast Refresh] rebuilding')</span><span class="s3">\n      </span><span class="s1">this.#reportedHmrStart = true</span><span class="s3">\n      </span><span class="s1">this.#cancelDeferredReportHmrStart()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">#cancelDeferredReportHmrStart() {</span><span class="s3">\n    </span><span class="s1">clearTimeout(this.#deferredReportHmrStartId)</span><span class="s3">\n    </span><span class="s1">this.#deferredReportHmrStartId = undefined</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">onBuilding() {</span><span class="s3">\n    </span><span class="s1">this.#lastUpdateMsSinceEpoch = undefined</span><span class="s3">\n    </span><span class="s1">this.#cancelDeferredReportHmrStart()</span><span class="s3">\n    </span><span class="s1">this.#startMsSinceEpoch = Date.now()</span><span class="s3">\n\n    </span><span class="s1">// report the HMR start after a short delay</span><span class="s3">\n    </span><span class="s1">this.#deferredReportHmrStartId = setTimeout(</span><span class="s3">\n      </span><span class="s1">() =&gt; this.#runDeferredReportHmrStart(),</span><span class="s3">\n      </span><span class="s1">// debugging feature: don't defer/suppress noisy no-op HMR update messages</span><span class="s3">\n      </span><span class="s1">self.__NEXT_HMR_TURBOPACK_REPORT_NOISY_NOOP_EVENTS</span><span class="s3">\n        </span><span class="s1">? 0</span><span class="s3">\n        </span><span class="s1">: TURBOPACK_HMR_START_DELAY_MS</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/** Helper for other `onEvent` methods. */</span><span class="s3">\n  </span><span class="s1">#onUpdate() {</span><span class="s3">\n    </span><span class="s1">this.#runDeferredReportHmrStart()</span><span class="s3">\n    </span><span class="s1">this.#lastUpdateMsSinceEpoch = Date.now()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">onTurbopackMessage(msg: TurbopackMessageAction) {</span><span class="s3">\n    </span><span class="s1">this.#onUpdate()</span><span class="s3">\n    </span><span class="s1">const updatedModules = extractModulesFromTurbopackMessage(msg.data)</span><span class="s3">\n    </span><span class="s1">for (const module of updatedModules) {</span><span class="s3">\n      </span><span class="s1">this.#updatedModules.add(module)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">onServerComponentChanges() {</span><span class="s3">\n    </span><span class="s1">this.#onUpdate()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">onReloadPage() {</span><span class="s3">\n    </span><span class="s1">this.#onUpdate()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">onPageAddRemove() {</span><span class="s3">\n    </span><span class="s1">this.#onUpdate()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @returns `null` if the caller should ignore the update entirely. Returns an</span><span class="s3">\n   </span><span class="s1">*   object with `hasUpdates: false` if the caller should report the end of</span><span class="s3">\n   </span><span class="s1">*   the HMR in the browser console, but the HMR was a no-op.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">onBuilt(): HmrUpdate | null {</span><span class="s3">\n    </span><span class="s1">// Check that we got *any* `TurbopackMessageAction`, even if</span><span class="s3">\n    </span><span class="s1">// `updatedModules` is empty (not everything gets recorded there).</span><span class="s3">\n    </span><span class="s1">//</span><span class="s3">\n    </span><span class="s1">// There's also a case where `onBuilt` gets called before `onBuilding`,</span><span class="s3">\n    </span><span class="s1">// which can happen during initial page load. Ignore that too!</span><span class="s3">\n    </span><span class="s1">const hasUpdates =</span><span class="s3">\n      </span><span class="s1">this.#lastUpdateMsSinceEpoch != null &amp;&amp; this.#startMsSinceEpoch != null</span><span class="s3">\n    </span><span class="s1">if (!hasUpdates &amp;&amp; !this.#reportedHmrStart) {</span><span class="s3">\n      </span><span class="s1">// suppress the update entirely</span><span class="s3">\n      </span><span class="s1">this.#cancelDeferredReportHmrStart()</span><span class="s3">\n      </span><span class="s1">return null</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">this.#runDeferredReportHmrStart()</span><span class="s3">\n\n    </span><span class="s1">const result = {</span><span class="s3">\n      </span><span class="s1">hasUpdates,</span><span class="s3">\n      </span><span class="s1">updatedModules: this.#updatedModules,</span><span class="s3">\n      </span><span class="s1">startMsSinceEpoch: this.#startMsSinceEpoch!,</span><span class="s3">\n      </span><span class="s1">endMsSinceEpoch: this.#lastUpdateMsSinceEpoch ?? Date.now(),</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">this.#updatedModules = new Set()</span><span class="s3">\n    </span><span class="s1">this.#reportedHmrStart = false</span><span class="s3">\n    </span><span class="s1">return result</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function extractModulesFromTurbopackMessage(</span><span class="s3">\n  </span><span class="s1">data: TurbopackUpdate | TurbopackUpdate[]</span><span class="s3">\n</span><span class="s1">): Set&lt;string&gt; {</span><span class="s3">\n  </span><span class="s1">const updatedModules: Set&lt;string&gt; = new Set()</span><span class="s3">\n\n  </span><span class="s1">const updates = Array.isArray(data) ? data : [data]</span><span class="s3">\n  </span><span class="s1">for (const update of updates) {</span><span class="s3">\n    </span><span class="s1">// TODO this won't capture changes to CSS since they don't result in a </span><span class="s3">\&quot;</span><span class="s1">merged</span><span class="s3">\&quot; </span><span class="s1">update</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">update.type !== 'partial' ||</span><span class="s3">\n      </span><span class="s1">update.instruction.type !== 'ChunkListUpdate' ||</span><span class="s3">\n      </span><span class="s1">update.instruction.merged === undefined</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">continue</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">for (const mergedUpdate of update.instruction.merged) {</span><span class="s3">\n      </span><span class="s1">for (const name of Object.keys(mergedUpdate.entries)) {</span><span class="s3">\n        </span><span class="s1">const res = /(.*)</span><span class="s3">\\</span><span class="s1">s+</span><span class="s3">\\</span><span class="s1">[.*/.exec(name)</span><span class="s3">\n        </span><span class="s1">if (res === null) {</span><span class="s3">\n          </span><span class="s1">console.error(</span><span class="s3">\n            </span><span class="s1">'[Turbopack HMR] Expected module to match pattern: ' + name</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">updatedModules.add(res[1])</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return updatedModules</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;TurbopackHmr&quot;</span><span class="s0">,</span><span class="s1">&quot;TURBOPACK_HMR_START_DELAY_MS&quot;</span><span class="s0">,</span><span class="s1">&quot;onBuilding&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;Date&quot;</span><span class="s0">,</span><span class="s1">&quot;now&quot;</span><span class="s0">,</span><span class="s1">&quot;setTimeout&quot;</span><span class="s0">,</span><span class="s1">&quot;self&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_HMR_TURBOPACK_REPORT_NOISY_NOOP_EVENTS&quot;</span><span class="s0">,</span><span class="s1">&quot;onTurbopackMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;msg&quot;</span><span class="s0">,</span><span class="s1">&quot;updatedModules&quot;</span><span class="s0">,</span><span class="s1">&quot;extractModulesFromTurbopackMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;module&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;onServerComponentChanges&quot;</span><span class="s0">,</span><span class="s1">&quot;onReloadPage&quot;</span><span class="s0">,</span><span class="s1">&quot;onPageAddRemove&quot;</span><span class="s0">,</span><span class="s1">&quot;onBuilt&quot;</span><span class="s0">,</span><span class="s1">&quot;hasUpdates&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;startMsSinceEpoch&quot;</span><span class="s0">,</span><span class="s1">&quot;endMsSinceEpoch&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;log&quot;</span><span class="s0">,</span><span class="s1">&quot;clearTimeout&quot;</span><span class="s0">,</span><span class="s1">&quot;updates&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;update&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;instruction&quot;</span><span class="s0">,</span><span class="s1">&quot;merged&quot;</span><span class="s0">,</span><span class="s1">&quot;mergedUpdate&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;exec&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>