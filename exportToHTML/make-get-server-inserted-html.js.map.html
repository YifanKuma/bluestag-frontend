<html>
<head>
<title>make-get-server-inserted-html.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
make-get-server-inserted-html.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../src/server/app-render/make-get-server-inserted-html.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import React, { type JSX } from 'react'</span><span class="s3">\n</span><span class="s1">import { isHTTPAccessFallbackError } from '../../client/components/http-access-fallback/http-access-fallback'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">getURLFromRedirectError,</span><span class="s3">\n  </span><span class="s1">getRedirectStatusCodeFromError,</span><span class="s3">\n</span><span class="s1">} from '../../client/components/redirect'</span><span class="s3">\n</span><span class="s1">import { isRedirectError } from '../../client/components/redirect-error'</span><span class="s3">\n</span><span class="s1">import { renderToReadableStream } from 'react-dom/server'</span><span class="s3">\n</span><span class="s1">import { streamToString } from '../stream-utils/node-web-streams-helper'</span><span class="s3">\n</span><span class="s1">import { RedirectStatusCode } from '../../client/components/redirect-status-code'</span><span class="s3">\n</span><span class="s1">import { addPathPrefix } from '../../shared/lib/router/utils/add-path-prefix'</span><span class="s3">\n</span><span class="s1">import type { ClientTraceDataEntry } from '../lib/trace/tracer'</span><span class="s3">\n\n</span><span class="s1">export function makeGetServerInsertedHTML({</span><span class="s3">\n  </span><span class="s1">polyfills,</span><span class="s3">\n  </span><span class="s1">renderServerInsertedHTML,</span><span class="s3">\n  </span><span class="s1">serverCapturedErrors,</span><span class="s3">\n  </span><span class="s1">tracingMetadata,</span><span class="s3">\n  </span><span class="s1">basePath,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">polyfills: JSX.IntrinsicElements['script'][]</span><span class="s3">\n  </span><span class="s1">renderServerInsertedHTML: () =&gt; React.ReactNode</span><span class="s3">\n  </span><span class="s1">tracingMetadata: ClientTraceDataEntry[] | undefined</span><span class="s3">\n  </span><span class="s1">serverCapturedErrors: Array&lt;unknown&gt;</span><span class="s3">\n  </span><span class="s1">basePath: string</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">let flushedErrorMetaTagsUntilIndex = 0</span><span class="s3">\n  </span><span class="s1">// flag for static content that only needs to be flushed once</span><span class="s3">\n  </span><span class="s1">let hasFlushedInitially = false</span><span class="s3">\n\n  </span><span class="s1">const polyfillTags = polyfills.map((polyfill) =&gt; {</span><span class="s3">\n    </span><span class="s1">return &lt;script key={polyfill.src} {...polyfill} /&gt;</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">return async function getServerInsertedHTML() {</span><span class="s3">\n    </span><span class="s1">// Loop through all the errors that have been captured but not yet</span><span class="s3">\n    </span><span class="s1">// flushed.</span><span class="s3">\n    </span><span class="s1">const errorMetaTags = []</span><span class="s3">\n    </span><span class="s1">while (flushedErrorMetaTagsUntilIndex &lt; serverCapturedErrors.length) {</span><span class="s3">\n      </span><span class="s1">const error = serverCapturedErrors[flushedErrorMetaTagsUntilIndex]</span><span class="s3">\n      </span><span class="s1">flushedErrorMetaTagsUntilIndex++</span><span class="s3">\n\n      </span><span class="s1">if (isHTTPAccessFallbackError(error)) {</span><span class="s3">\n        </span><span class="s1">errorMetaTags.push(</span><span class="s3">\n          </span><span class="s1">&lt;meta name=</span><span class="s3">\&quot;</span><span class="s1">robots</span><span class="s3">\&quot; </span><span class="s1">content=</span><span class="s3">\&quot;</span><span class="s1">noindex</span><span class="s3">\&quot; </span><span class="s1">key={error.digest} /&gt;,</span><span class="s3">\n          </span><span class="s1">process.env.NODE_ENV === 'development' ? (</span><span class="s3">\n            </span><span class="s1">&lt;meta name=</span><span class="s3">\&quot;</span><span class="s1">next-error</span><span class="s3">\&quot; </span><span class="s1">content=</span><span class="s3">\&quot;</span><span class="s1">not-found</span><span class="s3">\&quot; </span><span class="s1">key=</span><span class="s3">\&quot;</span><span class="s1">next-error</span><span class="s3">\&quot; </span><span class="s1">/&gt;</span><span class="s3">\n          </span><span class="s1">) : null</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">} else if (isRedirectError(error)) {</span><span class="s3">\n        </span><span class="s1">const redirectUrl = addPathPrefix(</span><span class="s3">\n          </span><span class="s1">getURLFromRedirectError(error),</span><span class="s3">\n          </span><span class="s1">basePath</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">const statusCode = getRedirectStatusCodeFromError(error)</span><span class="s3">\n        </span><span class="s1">const isPermanent =</span><span class="s3">\n          </span><span class="s1">statusCode === RedirectStatusCode.PermanentRedirect ? true : false</span><span class="s3">\n        </span><span class="s1">if (redirectUrl) {</span><span class="s3">\n          </span><span class="s1">errorMetaTags.push(</span><span class="s3">\n            </span><span class="s1">&lt;meta</span><span class="s3">\n              </span><span class="s1">id=</span><span class="s3">\&quot;</span><span class="s1">__next-page-redirect</span><span class="s3">\&quot;\n              </span><span class="s1">httpEquiv=</span><span class="s3">\&quot;</span><span class="s1">refresh</span><span class="s3">\&quot;\n              </span><span class="s1">content={`${isPermanent ? 0 : 1};url=${redirectUrl}`}</span><span class="s3">\n              </span><span class="s1">key={error.digest}</span><span class="s3">\n            </span><span class="s1">/&gt;</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const traceMetaTags = (tracingMetadata || []).map(</span><span class="s3">\n      </span><span class="s1">({ key, value }, index) =&gt; (</span><span class="s3">\n        </span><span class="s1">&lt;meta key={`next-trace-data-${index}`} name={key} content={value} /&gt;</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">const serverInsertedHTML = renderServerInsertedHTML()</span><span class="s3">\n\n    </span><span class="s1">// Skip React rendering if we know the content is empty.</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">polyfillTags.length === 0 &amp;&amp;</span><span class="s3">\n      </span><span class="s1">traceMetaTags.length === 0 &amp;&amp;</span><span class="s3">\n      </span><span class="s1">errorMetaTags.length === 0 &amp;&amp;</span><span class="s3">\n      </span><span class="s1">Array.isArray(serverInsertedHTML) &amp;&amp;</span><span class="s3">\n      </span><span class="s1">serverInsertedHTML.length === 0</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return ''</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const stream = await renderToReadableStream(</span><span class="s3">\n      </span><span class="s1">&lt;&gt;</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">/* Insert the polyfills if they haven't been flushed yet. */</span><span class="s3">\n          </span><span class="s1">hasFlushedInitially ? null : polyfillTags</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">{serverInsertedHTML}</span><span class="s3">\n        </span><span class="s1">{hasFlushedInitially ? null : traceMetaTags}</span><span class="s3">\n        </span><span class="s1">{errorMetaTags}</span><span class="s3">\n      </span><span class="s1">&lt;/&gt;,</span><span class="s3">\n      </span><span class="s1">{</span><span class="s3">\n        </span><span class="s1">// Larger chunk because this isn't sent over the network.</span><span class="s3">\n        </span><span class="s1">// Let's set it to 1MB.</span><span class="s3">\n        </span><span class="s1">progressiveChunkSize: 1024 * 1024,</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">hasFlushedInitially = true</span><span class="s3">\n\n    </span><span class="s1">// There's no need to wait for the stream to be ready</span><span class="s3">\n    </span><span class="s1">// e.g. calling `await stream.allReady` because `streamToString` will</span><span class="s3">\n    </span><span class="s1">// wait and decode the stream progressively with better parallelism.</span><span class="s3">\n    </span><span class="s1">return streamToString(stream)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;makeGetServerInsertedHTML&quot;</span><span class="s0">,</span><span class="s1">&quot;polyfills&quot;</span><span class="s0">,</span><span class="s1">&quot;renderServerInsertedHTML&quot;</span><span class="s0">,</span><span class="s1">&quot;serverCapturedErrors&quot;</span><span class="s0">,</span><span class="s1">&quot;tracingMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;basePath&quot;</span><span class="s0">,</span><span class="s1">&quot;flushedErrorMetaTagsUntilIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;hasFlushedInitially&quot;</span><span class="s0">,</span><span class="s1">&quot;polyfillTags&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;polyfill&quot;</span><span class="s0">,</span><span class="s1">&quot;script&quot;</span><span class="s0">,</span><span class="s1">&quot;src&quot;</span><span class="s0">,</span><span class="s1">&quot;getServerInsertedHTML&quot;</span><span class="s0">,</span><span class="s1">&quot;errorMetaTags&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;isHTTPAccessFallbackError&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;meta&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;content&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;isRedirectError&quot;</span><span class="s0">,</span><span class="s1">&quot;redirectUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;addPathPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;getURLFromRedirectError&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;getRedirectStatusCodeFromError&quot;</span><span class="s0">,</span><span class="s1">&quot;isPermanent&quot;</span><span class="s0">,</span><span class="s1">&quot;RedirectStatusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;PermanentRedirect&quot;</span><span class="s0">,</span><span class="s1">&quot;id&quot;</span><span class="s0">,</span><span class="s1">&quot;httpEquiv&quot;</span><span class="s0">,</span><span class="s1">&quot;traceMetaTags&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;serverInsertedHTML&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;stream&quot;</span><span class="s0">,</span><span class="s1">&quot;renderToReadableStream&quot;</span><span class="s0">,</span><span class="s1">&quot;progressiveChunkSize&quot;</span><span class="s0">,</span><span class="s1">&quot;streamToString&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BAagBA;;;eAAAA;;;;8DAbgB;oCACU;0BAInC;+BACyB;wBACO;sCACR;oCACI;+BACL;;;;;;AAGvB,SAASA,0BAA0B,EACxCC,SAAS,EACTC,wBAAwB,EACxBC,oBAAoB,EACpBC,eAAe,EACfC,QAAQ,EAOT;IACC,IAAIC,iCAAiC;IACrC,6DAA6D;IAC7D,IAAIC,sBAAsB;IAE1B,MAAMC,eAAeP,UAAUQ,GAAG,CAAC,CAACC;QAClC,qBAAO,qBAACC;YAA2B,GAAGD,QAAQ;WAA1BA,SAASE,GAAG;IAClC;IAEA,OAAO,eAAeC;QACpB,kEAAkE;QAClE,WAAW;QACX,MAAMC,gBAAgB,EAAE;QACxB,MAAOR,iCAAiCH,qBAAqBY,MAAM,CAAE;YACnE,MAAMC,QAAQb,oBAAoB,CAACG,+BAA+B;YAClEA;YAEA,IAAIW,IAAAA,6CAAyB,EAACD,QAAQ;gBACpCF,cAAcI,IAAI,eAChB,qBAACC;oBAAKC,MAAK;oBAASC,SAAQ;mBAAeL,MAAMM,MAAM,GACvDC,QAAQC,GAAG,CAACC,QAAQ,KAAK,8BACvB,qBAACN;oBAAKC,MAAK;oBAAaC,SAAQ;mBAAgB,gBAC9C;YAER,OAAO,IAAIK,IAAAA,8BAAe,EAACV,QAAQ;gBACjC,MAAMW,cAAcC,IAAAA,4BAAa,EAC/BC,IAAAA,iCAAuB,EAACb,QACxBX;gBAEF,MAAMyB,aAAaC,IAAAA,wCAA8B,EAACf;gBAClD,MAAMgB,cACJF,eAAeG,sCAAkB,CAACC,iBAAiB,GAAG,OAAO;gBAC/D,IAAIP,aAAa;oBACfb,cAAcI,IAAI,eAChB,qBAACC;wBACCgB,IAAG;wBACHC,WAAU;wBACVf,SAAS,GAAGW,cAAc,IAAI,EAAE,KAAK,EAAEL,aAAa;uBAC/CX,MAAMM,MAAM;gBAGvB;YACF;QACF;QAEA,MAAMe,gBAAgB,AAACjC,CAAAA,mBAAmB,EAAE,AAAD,EAAGK,GAAG,CAC/C,CAAC,EAAE6B,GAAG,EAAEC,KAAK,EAAE,EAAEC,sBACf,qBAACrB;gBAAsCC,MAAMkB;gBAAKjB,SAASkB;eAAhD,CAAC,gBAAgB,EAAEC,OAAO;QAIzC,MAAMC,qBAAqBvC;QAE3B,wDAAwD;QACxD,IACEM,aAAaO,MAAM,KAAK,KACxBsB,cAActB,MAAM,KAAK,KACzBD,cAAcC,MAAM,KAAK,KACzB2B,MAAMC,OAAO,CAACF,uBACdA,mBAAmB1B,MAAM,KAAK,GAC9B;YACA,OAAO;QACT;QAEA,MAAM6B,SAAS,MAAMC,IAAAA,8BAAsB,gBACzC;;gBAEI,0DAA0D,GAC1DtC,sBAAsB,OAAOC;gBAE9BiC;gBACAlC,sBAAsB,OAAO8B;gBAC7BvB;;YAEH;YACE,yDAAyD;YACzD,uBAAuB;YACvBgC,sBAAsB,OAAO;QAC/B;QAGFvC,sBAAsB;QAEtB,qDAAqD;QACrD,qEAAqE;QACrE,oEAAoE;QACpE,OAAOwC,IAAAA,oCAAc,EAACH;IACxB;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>