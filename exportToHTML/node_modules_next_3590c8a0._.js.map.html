<html>
<head>
<title>node_modules_next_3590c8a0._.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
.s4 { color: #0033b3;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
node_modules_next_3590c8a0._.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span>
  <span class="s1">&quot;version&quot;</span><span class="s0">: </span><span class="s2">3</span><span class="s0">,</span>
  <span class="s1">&quot;sources&quot;</span><span class="s0">: [],</span>
  <span class="s1">&quot;sections&quot;</span><span class="s0">: [</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/route-modules/app-route/module.compiled.js&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n  </span><span class="s1">module.exports = require('next/dist/server/route-modules/app-route/module.js')</span><span class="s3">\n</span><span class="s1">} else {</span><span class="s3">\n  </span><span class="s1">if (process.env.__NEXT_EXPERIMENTAL_REACT) {</span><span class="s3">\n    </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-route-turbo-experimental.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-route-experimental.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-route-turbo-experimental.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-route-experimental.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-route-turbo.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-route.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-route-turbo.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-route.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;module&quot;</span><span class="s0">,</span><span class="s1">&quot;exports&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_EXPERIMENTAL_REACT&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;TURBOPACK&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">22</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/route-kind.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export const enum RouteKind {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* `PAGES` represents all the React pages that are under `pages/`.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">PAGES = 'PAGES',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* `PAGES_API` represents all the API routes under `pages/api/`.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">PAGES_API = 'PAGES_API',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* `APP_PAGE` represents all the React pages that are under `app/` with the</span><span class="s3">\n   </span><span class="s1">* filename of `page.{j,t}s{,x}`.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">APP_PAGE = 'APP_PAGE',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* `APP_ROUTE` represents all the API routes and metadata routes that are under `app/` with the</span><span class="s3">\n   </span><span class="s1">* filename of `route.{j,t}s{,x}`.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">APP_ROUTE = 'APP_ROUTE',</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* `IMAGE` represents all the images that are generated by `next/image`.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">IMAGE = 'IMAGE',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RouteKind&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,IAAWA,YAAAA,WAAAA,GAAAA,SAAAA,SAAAA;IAChB;;GAEC,GAAA,SAAA,CAAA,QAAA,GAAA;IAED;;GAEC,GAAA,SAAA,CAAA,YAAA,GAAA;IAED;;;GAGC,GAAA,SAAA,CAAA,WAAA,GAAA;IAED;;;GAGC,GAAA,SAAA,CAAA,YAAA,GAAA;IAGD;;GAEC,GAAA,SAAA,CAAA,QAAA,GAAA;WAtBeA;MAwBjB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">50</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/trace/constants.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Contains predefined constants for the trace span name in next/server.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Currently, next/server/tracer is internal implementation only for tracking</span><span class="s3">\n </span><span class="s1">* next.js's implementation only with known span names defined here.</span><span class="s3">\n </span><span class="s1">**/</span><span class="s3">\n\n</span><span class="s1">// eslint typescript has a bug with TS enums</span><span class="s3">\n</span><span class="s1">/* eslint-disable no-shadow */</span><span class="s3">\n\n</span><span class="s1">enum BaseServerSpan {</span><span class="s3">\n  </span><span class="s1">handleRequest = 'BaseServer.handleRequest',</span><span class="s3">\n  </span><span class="s1">run = 'BaseServer.run',</span><span class="s3">\n  </span><span class="s1">pipe = 'BaseServer.pipe',</span><span class="s3">\n  </span><span class="s1">getStaticHTML = 'BaseServer.getStaticHTML',</span><span class="s3">\n  </span><span class="s1">render = 'BaseServer.render',</span><span class="s3">\n  </span><span class="s1">renderToResponseWithComponents = 'BaseServer.renderToResponseWithComponents',</span><span class="s3">\n  </span><span class="s1">renderToResponse = 'BaseServer.renderToResponse',</span><span class="s3">\n  </span><span class="s1">renderToHTML = 'BaseServer.renderToHTML',</span><span class="s3">\n  </span><span class="s1">renderError = 'BaseServer.renderError',</span><span class="s3">\n  </span><span class="s1">renderErrorToResponse = 'BaseServer.renderErrorToResponse',</span><span class="s3">\n  </span><span class="s1">renderErrorToHTML = 'BaseServer.renderErrorToHTML',</span><span class="s3">\n  </span><span class="s1">render404 = 'BaseServer.render404',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">enum LoadComponentsSpan {</span><span class="s3">\n  </span><span class="s1">loadDefaultErrorComponents = 'LoadComponents.loadDefaultErrorComponents',</span><span class="s3">\n  </span><span class="s1">loadComponents = 'LoadComponents.loadComponents',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">enum NextServerSpan {</span><span class="s3">\n  </span><span class="s1">getRequestHandler = 'NextServer.getRequestHandler',</span><span class="s3">\n  </span><span class="s1">getServer = 'NextServer.getServer',</span><span class="s3">\n  </span><span class="s1">getServerRequestHandler = 'NextServer.getServerRequestHandler',</span><span class="s3">\n  </span><span class="s1">createServer = 'createServer.createServer',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">enum NextNodeServerSpan {</span><span class="s3">\n  </span><span class="s1">compression = 'NextNodeServer.compression',</span><span class="s3">\n  </span><span class="s1">getBuildId = 'NextNodeServer.getBuildId',</span><span class="s3">\n  </span><span class="s1">createComponentTree = 'NextNodeServer.createComponentTree',</span><span class="s3">\n  </span><span class="s1">clientComponentLoading = 'NextNodeServer.clientComponentLoading',</span><span class="s3">\n  </span><span class="s1">getLayoutOrPageModule = 'NextNodeServer.getLayoutOrPageModule',</span><span class="s3">\n  </span><span class="s1">generateStaticRoutes = 'NextNodeServer.generateStaticRoutes',</span><span class="s3">\n  </span><span class="s1">generateFsStaticRoutes = 'NextNodeServer.generateFsStaticRoutes',</span><span class="s3">\n  </span><span class="s1">generatePublicRoutes = 'NextNodeServer.generatePublicRoutes',</span><span class="s3">\n  </span><span class="s1">generateImageRoutes = 'NextNodeServer.generateImageRoutes.route',</span><span class="s3">\n  </span><span class="s1">sendRenderResult = 'NextNodeServer.sendRenderResult',</span><span class="s3">\n  </span><span class="s1">proxyRequest = 'NextNodeServer.proxyRequest',</span><span class="s3">\n  </span><span class="s1">runApi = 'NextNodeServer.runApi',</span><span class="s3">\n  </span><span class="s1">render = 'NextNodeServer.render',</span><span class="s3">\n  </span><span class="s1">renderHTML = 'NextNodeServer.renderHTML',</span><span class="s3">\n  </span><span class="s1">imageOptimizer = 'NextNodeServer.imageOptimizer',</span><span class="s3">\n  </span><span class="s1">getPagePath = 'NextNodeServer.getPagePath',</span><span class="s3">\n  </span><span class="s1">getRoutesManifest = 'NextNodeServer.getRoutesManifest',</span><span class="s3">\n  </span><span class="s1">findPageComponents = 'NextNodeServer.findPageComponents',</span><span class="s3">\n  </span><span class="s1">getFontManifest = 'NextNodeServer.getFontManifest',</span><span class="s3">\n  </span><span class="s1">getServerComponentManifest = 'NextNodeServer.getServerComponentManifest',</span><span class="s3">\n  </span><span class="s1">getRequestHandler = 'NextNodeServer.getRequestHandler',</span><span class="s3">\n  </span><span class="s1">renderToHTML = 'NextNodeServer.renderToHTML',</span><span class="s3">\n  </span><span class="s1">renderError = 'NextNodeServer.renderError',</span><span class="s3">\n  </span><span class="s1">renderErrorToHTML = 'NextNodeServer.renderErrorToHTML',</span><span class="s3">\n  </span><span class="s1">render404 = 'NextNodeServer.render404',</span><span class="s3">\n  </span><span class="s1">startResponse = 'NextNodeServer.startResponse',</span><span class="s3">\n\n  </span><span class="s1">// nested inner span, does not require parent scope name</span><span class="s3">\n  </span><span class="s1">route = 'route',</span><span class="s3">\n  </span><span class="s1">onProxyReq = 'onProxyReq',</span><span class="s3">\n  </span><span class="s1">apiResolver = 'apiResolver',</span><span class="s3">\n  </span><span class="s1">internalFetch = 'internalFetch',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">enum StartServerSpan {</span><span class="s3">\n  </span><span class="s1">startServer = 'startServer.startServer',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">enum RenderSpan {</span><span class="s3">\n  </span><span class="s1">getServerSideProps = 'Render.getServerSideProps',</span><span class="s3">\n  </span><span class="s1">getStaticProps = 'Render.getStaticProps',</span><span class="s3">\n  </span><span class="s1">renderToString = 'Render.renderToString',</span><span class="s3">\n  </span><span class="s1">renderDocument = 'Render.renderDocument',</span><span class="s3">\n  </span><span class="s1">createBodyResult = 'Render.createBodyResult',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">enum AppRenderSpan {</span><span class="s3">\n  </span><span class="s1">renderToString = 'AppRender.renderToString',</span><span class="s3">\n  </span><span class="s1">renderToReadableStream = 'AppRender.renderToReadableStream',</span><span class="s3">\n  </span><span class="s1">getBodyResult = 'AppRender.getBodyResult',</span><span class="s3">\n  </span><span class="s1">fetch = 'AppRender.fetch',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">enum RouterSpan {</span><span class="s3">\n  </span><span class="s1">executeRoute = 'Router.executeRoute',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">enum NodeSpan {</span><span class="s3">\n  </span><span class="s1">runHandler = 'Node.runHandler',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">enum AppRouteRouteHandlersSpan {</span><span class="s3">\n  </span><span class="s1">runHandler = 'AppRouteRouteHandlers.runHandler',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">enum ResolveMetadataSpan {</span><span class="s3">\n  </span><span class="s1">generateMetadata = 'ResolveMetadata.generateMetadata',</span><span class="s3">\n  </span><span class="s1">generateViewport = 'ResolveMetadata.generateViewport',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">enum MiddlewareSpan {</span><span class="s3">\n  </span><span class="s1">execute = 'Middleware.execute',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type SpanTypes =</span><span class="s3">\n  </span><span class="s1">| `${BaseServerSpan}`</span><span class="s3">\n  </span><span class="s1">| `${LoadComponentsSpan}`</span><span class="s3">\n  </span><span class="s1">| `${NextServerSpan}`</span><span class="s3">\n  </span><span class="s1">| `${StartServerSpan}`</span><span class="s3">\n  </span><span class="s1">| `${NextNodeServerSpan}`</span><span class="s3">\n  </span><span class="s1">| `${RenderSpan}`</span><span class="s3">\n  </span><span class="s1">| `${RouterSpan}`</span><span class="s3">\n  </span><span class="s1">| `${AppRenderSpan}`</span><span class="s3">\n  </span><span class="s1">| `${NodeSpan}`</span><span class="s3">\n  </span><span class="s1">| `${AppRouteRouteHandlersSpan}`</span><span class="s3">\n  </span><span class="s1">| `${ResolveMetadataSpan}`</span><span class="s3">\n  </span><span class="s1">| `${MiddlewareSpan}`</span><span class="s3">\n\n</span><span class="s1">// This list is used to filter out spans that are not relevant to the user</span><span class="s3">\n</span><span class="s1">export const NextVanillaSpanAllowlist = [</span><span class="s3">\n  </span><span class="s1">MiddlewareSpan.execute,</span><span class="s3">\n  </span><span class="s1">BaseServerSpan.handleRequest,</span><span class="s3">\n  </span><span class="s1">RenderSpan.getServerSideProps,</span><span class="s3">\n  </span><span class="s1">RenderSpan.getStaticProps,</span><span class="s3">\n  </span><span class="s1">AppRenderSpan.fetch,</span><span class="s3">\n  </span><span class="s1">AppRenderSpan.getBodyResult,</span><span class="s3">\n  </span><span class="s1">RenderSpan.renderDocument,</span><span class="s3">\n  </span><span class="s1">NodeSpan.runHandler,</span><span class="s3">\n  </span><span class="s1">AppRouteRouteHandlersSpan.runHandler,</span><span class="s3">\n  </span><span class="s1">ResolveMetadataSpan.generateMetadata,</span><span class="s3">\n  </span><span class="s1">ResolveMetadataSpan.generateViewport,</span><span class="s3">\n  </span><span class="s1">NextNodeServerSpan.createComponentTree,</span><span class="s3">\n  </span><span class="s1">NextNodeServerSpan.findPageComponents,</span><span class="s3">\n  </span><span class="s1">NextNodeServerSpan.getLayoutOrPageModule,</span><span class="s3">\n  </span><span class="s1">NextNodeServerSpan.startResponse,</span><span class="s3">\n  </span><span class="s1">NextNodeServerSpan.clientComponentLoading,</span><span class="s3">\n</span><span class="s1">]</span><span class="s3">\n\n</span><span class="s1">// These Spans are allowed to be always logged</span><span class="s3">\n</span><span class="s1">// when the otel log prefix env is set</span><span class="s3">\n</span><span class="s1">export const LogSpanAllowList = [</span><span class="s3">\n  </span><span class="s1">NextNodeServerSpan.findPageComponents,</span><span class="s3">\n  </span><span class="s1">NextNodeServerSpan.createComponentTree,</span><span class="s3">\n  </span><span class="s1">NextNodeServerSpan.clientComponentLoading,</span><span class="s3">\n</span><span class="s1">]</span><span class="s3">\n\n</span><span class="s1">export {</span><span class="s3">\n  </span><span class="s1">BaseServerSpan,</span><span class="s3">\n  </span><span class="s1">LoadComponentsSpan,</span><span class="s3">\n  </span><span class="s1">NextServerSpan,</span><span class="s3">\n  </span><span class="s1">NextNodeServerSpan,</span><span class="s3">\n  </span><span class="s1">StartServerSpan,</span><span class="s3">\n  </span><span class="s1">RenderSpan,</span><span class="s3">\n  </span><span class="s1">RouterSpan,</span><span class="s3">\n  </span><span class="s1">AppRenderSpan,</span><span class="s3">\n  </span><span class="s1">NodeSpan,</span><span class="s3">\n  </span><span class="s1">AppRouteRouteHandlersSpan,</span><span class="s3">\n  </span><span class="s1">ResolveMetadataSpan,</span><span class="s3">\n  </span><span class="s1">MiddlewareSpan,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type { SpanTypes }</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;BaseServerSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;LoadComponentsSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;NextServerSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;NextNodeServerSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;StartServerSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;RenderSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;AppRenderSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;RouterSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;AppRouteRouteHandlersSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;ResolveMetadataSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;MiddlewareSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;NextVanillaSpanAllowlist&quot;</span><span class="s0">,</span><span class="s1">&quot;LogSpanAllowList&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;;;EAKE,GAEF,4CAA4C;AAC5C,4BAA4B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE5B,IAAKA,iBAAAA,WAAAA,GAAAA,SAAAA,cAAAA;;;;;;;;;;;;;WAAAA;EAAAA,kBAAAA,CAAAA;AAeL,IAAKC,qBAAAA,WAAAA,GAAAA,SAAAA,kBAAAA;;;WAAAA;EAAAA,sBAAAA,CAAAA;AAKL,IAAKC,iBAAAA,WAAAA,GAAAA,SAAAA,cAAAA;;;;;WAAAA;EAAAA,kBAAAA,CAAAA;AAOL,IAAKC,qBAAAA,WAAAA,GAAAA,SAAAA,kBAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;IA4BH,wDAAwD;;;;;WA5BrDA;EAAAA,sBAAAA,CAAAA;AAmCL,IAAKC,kBAAAA,WAAAA,GAAAA,SAAAA,eAAAA;;WAAAA;EAAAA,mBAAAA,CAAAA;AAIL,IAAKC,aAAAA,WAAAA,GAAAA,SAAAA,UAAAA;;;;;;WAAAA;EAAAA,cAAAA,CAAAA;AAQL,IAAKC,gBAAAA,WAAAA,GAAAA,SAAAA,aAAAA;;;;;WAAAA;EAAAA,iBAAAA,CAAAA;AAOL,IAAKC,aAAAA,WAAAA,GAAAA,SAAAA,UAAAA;;WAAAA;EAAAA,cAAAA,CAAAA;AAIL,IAAKC,WAAAA,WAAAA,GAAAA,SAAAA,QAAAA;;WAAAA;EAAAA,YAAAA,CAAAA;AAIL,IAAKC,4BAAAA,WAAAA,GAAAA,SAAAA,yBAAAA;;WAAAA;EAAAA,6BAAAA,CAAAA;AAIL,IAAKC,sBAAAA,WAAAA,GAAAA,SAAAA,mBAAAA;;;WAAAA;EAAAA,uBAAAA,CAAAA;AAKL,IAAKC,iBAAAA,WAAAA,GAAAA,SAAAA,cAAAA;;WAAAA;EAAAA,kBAAAA,CAAAA;AAmBE,MAAMC,2BAA2B;;;;;;;;;;;;;;;;;CAiBvC,CAAA;AAIM,MAAMC,mBAAmB;;;;CAI/B,CAAA&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">216</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/is-thenable.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Check to see if a value is Thenable.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param promise the maybe-thenable value</span><span class="s3">\n </span><span class="s1">* @returns true if the value is thenable</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function isThenable&lt;T = unknown&gt;(</span><span class="s3">\n  </span><span class="s1">promise: Promise&lt;T&gt; | T</span><span class="s3">\n</span><span class="s1">): promise is Promise&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">promise !== null &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof promise === 'object' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">'then' in promise &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof promise.then === 'function'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isThenable&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;;;CAKC,GACD;;;;AAAO,SAASA,WACdC,OAAuB;IAEvB,OACEA,YAAY,QACZ,OAAOA,YAAY,YACnB,UAAUA,WACV,OAAOA,QAAQC,IAAI,KAAK;AAE5B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">231</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/compiled/%40opentelemetry/api/index.js&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;(()=&gt;{</span><span class="s3">\&quot;</span><span class="s1">use strict</span><span class="s3">\&quot;</span><span class="s1">;var e={491:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.ContextAPI=void 0;const n=r(223);const a=r(172);const o=r(930);const i=</span><span class="s3">\&quot;</span><span class="s1">context</span><span class="s3">\&quot;</span><span class="s1">;const c=new n.NoopContextManager;class ContextAPI{constructor(){}static getInstance(){if(!this._instance){this._instance=new ContextAPI}return this._instance}setGlobalContextManager(e){return(0,a.registerGlobal)(i,e,o.DiagAPI.instance())}active(){return this._getContextManager().active()}with(e,t,r,...n){return this._getContextManager().with(e,t,r,...n)}bind(e,t){return this._getContextManager().bind(e,t)}_getContextManager(){return(0,a.getGlobal)(i)||c}disable(){this._getContextManager().disable();(0,a.unregisterGlobal)(i,o.DiagAPI.instance())}}t.ContextAPI=ContextAPI},930:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.DiagAPI=void 0;const n=r(56);const a=r(912);const o=r(957);const i=r(172);const c=</span><span class="s3">\&quot;</span><span class="s1">diag</span><span class="s3">\&quot;</span><span class="s1">;class DiagAPI{constructor(){function _logProxy(e){return function(...t){const r=(0,i.getGlobal)(</span><span class="s3">\&quot;</span><span class="s1">diag</span><span class="s3">\&quot;</span><span class="s1">);if(!r)return;return r[e](...t)}}const e=this;const setLogger=(t,r={logLevel:o.DiagLogLevel.INFO})=&gt;{var n,c,s;if(t===e){const t=new Error(</span><span class="s3">\&quot;</span><span class="s1">Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation</span><span class="s3">\&quot;</span><span class="s1">);e.error((n=t.stack)!==null&amp;&amp;n!==void 0?n:t.message);return false}if(typeof r===</span><span class="s3">\&quot;</span><span class="s1">number</span><span class="s3">\&quot;</span><span class="s1">){r={logLevel:r}}const u=(0,i.getGlobal)(</span><span class="s3">\&quot;</span><span class="s1">diag</span><span class="s3">\&quot;</span><span class="s1">);const l=(0,a.createLogLevelDiagLogger)((c=r.logLevel)!==null&amp;&amp;c!==void 0?c:o.DiagLogLevel.INFO,t);if(u&amp;&amp;!r.suppressOverrideMessage){const e=(s=(new Error).stack)!==null&amp;&amp;s!==void 0?s:</span><span class="s3">\&quot;</span><span class="s1">&lt;failed to generate stacktrace&gt;</span><span class="s3">\&quot;</span><span class="s1">;u.warn(`Current logger will be overwritten from ${e}`);l.warn(`Current logger will overwrite one already registered from ${e}`)}return(0,i.registerGlobal)(</span><span class="s3">\&quot;</span><span class="s1">diag</span><span class="s3">\&quot;</span><span class="s1">,l,e,true)};e.setLogger=setLogger;e.disable=()=&gt;{(0,i.unregisterGlobal)(c,e)};e.createComponentLogger=e=&gt;new n.DiagComponentLogger(e);e.verbose=_logProxy(</span><span class="s3">\&quot;</span><span class="s1">verbose</span><span class="s3">\&quot;</span><span class="s1">);e.debug=_logProxy(</span><span class="s3">\&quot;</span><span class="s1">debug</span><span class="s3">\&quot;</span><span class="s1">);e.info=_logProxy(</span><span class="s3">\&quot;</span><span class="s1">info</span><span class="s3">\&quot;</span><span class="s1">);e.warn=_logProxy(</span><span class="s3">\&quot;</span><span class="s1">warn</span><span class="s3">\&quot;</span><span class="s1">);e.error=_logProxy(</span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">)}static instance(){if(!this._instance){this._instance=new DiagAPI}return this._instance}}t.DiagAPI=DiagAPI},653:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.MetricsAPI=void 0;const n=r(660);const a=r(172);const o=r(930);const i=</span><span class="s3">\&quot;</span><span class="s1">metrics</span><span class="s3">\&quot;</span><span class="s1">;class MetricsAPI{constructor(){}static getInstance(){if(!this._instance){this._instance=new MetricsAPI}return this._instance}setGlobalMeterProvider(e){return(0,a.registerGlobal)(i,e,o.DiagAPI.instance())}getMeterProvider(){return(0,a.getGlobal)(i)||n.NOOP_METER_PROVIDER}getMeter(e,t,r){return this.getMeterProvider().getMeter(e,t,r)}disable(){(0,a.unregisterGlobal)(i,o.DiagAPI.instance())}}t.MetricsAPI=MetricsAPI},181:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.PropagationAPI=void 0;const n=r(172);const a=r(874);const o=r(194);const i=r(277);const c=r(369);const s=r(930);const u=</span><span class="s3">\&quot;</span><span class="s1">propagation</span><span class="s3">\&quot;</span><span class="s1">;const l=new a.NoopTextMapPropagator;class PropagationAPI{constructor(){this.createBaggage=c.createBaggage;this.getBaggage=i.getBaggage;this.getActiveBaggage=i.getActiveBaggage;this.setBaggage=i.setBaggage;this.deleteBaggage=i.deleteBaggage}static getInstance(){if(!this._instance){this._instance=new PropagationAPI}return this._instance}setGlobalPropagator(e){return(0,n.registerGlobal)(u,e,s.DiagAPI.instance())}inject(e,t,r=o.defaultTextMapSetter){return this._getGlobalPropagator().inject(e,t,r)}extract(e,t,r=o.defaultTextMapGetter){return this._getGlobalPropagator().extract(e,t,r)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,n.unregisterGlobal)(u,s.DiagAPI.instance())}_getGlobalPropagator(){return(0,n.getGlobal)(u)||l}}t.PropagationAPI=PropagationAPI},997:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.TraceAPI=void 0;const n=r(172);const a=r(846);const o=r(139);const i=r(607);const c=r(930);const s=</span><span class="s3">\&quot;</span><span class="s1">trace</span><span class="s3">\&quot;</span><span class="s1">;class TraceAPI{constructor(){this._proxyTracerProvider=new a.ProxyTracerProvider;this.wrapSpanContext=o.wrapSpanContext;this.isSpanContextValid=o.isSpanContextValid;this.deleteSpan=i.deleteSpan;this.getSpan=i.getSpan;this.getActiveSpan=i.getActiveSpan;this.getSpanContext=i.getSpanContext;this.setSpan=i.setSpan;this.setSpanContext=i.setSpanContext}static getInstance(){if(!this._instance){this._instance=new TraceAPI}return this._instance}setGlobalTracerProvider(e){const t=(0,n.registerGlobal)(s,this._proxyTracerProvider,c.DiagAPI.instance());if(t){this._proxyTracerProvider.setDelegate(e)}return t}getTracerProvider(){return(0,n.getGlobal)(s)||this._proxyTracerProvider}getTracer(e,t){return this.getTracerProvider().getTracer(e,t)}disable(){(0,n.unregisterGlobal)(s,c.DiagAPI.instance());this._proxyTracerProvider=new a.ProxyTracerProvider}}t.TraceAPI=TraceAPI},277:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.deleteBaggage=t.setBaggage=t.getActiveBaggage=t.getBaggage=void 0;const n=r(491);const a=r(780);const o=(0,a.createContextKey)(</span><span class="s3">\&quot;</span><span class="s1">OpenTelemetry Baggage Key</span><span class="s3">\&quot;</span><span class="s1">);function getBaggage(e){return e.getValue(o)||undefined}t.getBaggage=getBaggage;function getActiveBaggage(){return getBaggage(n.ContextAPI.getInstance().active())}t.getActiveBaggage=getActiveBaggage;function setBaggage(e,t){return e.setValue(o,t)}t.setBaggage=setBaggage;function deleteBaggage(e){return e.deleteValue(o)}t.deleteBaggage=deleteBaggage},993:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.BaggageImpl=void 0;class BaggageImpl{constructor(e){this._entries=e?new Map(e):new Map}getEntry(e){const t=this._entries.get(e);if(!t){return undefined}return Object.assign({},t)}getAllEntries(){return Array.from(this._entries.entries()).map((([e,t])=&gt;[e,t]))}setEntry(e,t){const r=new BaggageImpl(this._entries);r._entries.set(e,t);return r}removeEntry(e){const t=new BaggageImpl(this._entries);t._entries.delete(e);return t}removeEntries(...e){const t=new BaggageImpl(this._entries);for(const r of e){t._entries.delete(r)}return t}clear(){return new BaggageImpl}}t.BaggageImpl=BaggageImpl},830:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.baggageEntryMetadataSymbol=void 0;t.baggageEntryMetadataSymbol=Symbol(</span><span class="s3">\&quot;</span><span class="s1">BaggageEntryMetadata</span><span class="s3">\&quot;</span><span class="s1">)},369:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.baggageEntryMetadataFromString=t.createBaggage=void 0;const n=r(930);const a=r(993);const o=r(830);const i=n.DiagAPI.instance();function createBaggage(e={}){return new a.BaggageImpl(new Map(Object.entries(e)))}t.createBaggage=createBaggage;function baggageEntryMetadataFromString(e){if(typeof e!==</span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">){i.error(`Cannot create baggage metadata from unknown type: ${typeof e}`);e=</span><span class="s3">\&quot;\&quot;</span><span class="s1">}return{__TYPE__:o.baggageEntryMetadataSymbol,toString(){return e}}}t.baggageEntryMetadataFromString=baggageEntryMetadataFromString},67:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.context=void 0;const n=r(491);t.context=n.ContextAPI.getInstance()},223:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.NoopContextManager=void 0;const n=r(780);class NoopContextManager{active(){return n.ROOT_CONTEXT}with(e,t,r,...n){return t.call(r,...n)}bind(e,t){return t}enable(){return this}disable(){return this}}t.NoopContextManager=NoopContextManager},780:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.ROOT_CONTEXT=t.createContextKey=void 0;function createContextKey(e){return Symbol.for(e)}t.createContextKey=createContextKey;class BaseContext{constructor(e){const t=this;t._currentContext=e?new Map(e):new Map;t.getValue=e=&gt;t._currentContext.get(e);t.setValue=(e,r)=&gt;{const n=new BaseContext(t._currentContext);n._currentContext.set(e,r);return n};t.deleteValue=e=&gt;{const r=new BaseContext(t._currentContext);r._currentContext.delete(e);return r}}}t.ROOT_CONTEXT=new BaseContext},506:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.diag=void 0;const n=r(930);t.diag=n.DiagAPI.instance()},56:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.DiagComponentLogger=void 0;const n=r(172);class DiagComponentLogger{constructor(e){this._namespace=e.namespace||</span><span class="s3">\&quot;</span><span class="s1">DiagComponentLogger</span><span class="s3">\&quot;</span><span class="s1">}debug(...e){return logProxy(</span><span class="s3">\&quot;</span><span class="s1">debug</span><span class="s3">\&quot;</span><span class="s1">,this._namespace,e)}error(...e){return logProxy(</span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">,this._namespace,e)}info(...e){return logProxy(</span><span class="s3">\&quot;</span><span class="s1">info</span><span class="s3">\&quot;</span><span class="s1">,this._namespace,e)}warn(...e){return logProxy(</span><span class="s3">\&quot;</span><span class="s1">warn</span><span class="s3">\&quot;</span><span class="s1">,this._namespace,e)}verbose(...e){return logProxy(</span><span class="s3">\&quot;</span><span class="s1">verbose</span><span class="s3">\&quot;</span><span class="s1">,this._namespace,e)}}t.DiagComponentLogger=DiagComponentLogger;function logProxy(e,t,r){const a=(0,n.getGlobal)(</span><span class="s3">\&quot;</span><span class="s1">diag</span><span class="s3">\&quot;</span><span class="s1">);if(!a){return}r.unshift(t);return a[e](...r)}},972:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.DiagConsoleLogger=void 0;const r=[{n:</span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">,c:</span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">},{n:</span><span class="s3">\&quot;</span><span class="s1">warn</span><span class="s3">\&quot;</span><span class="s1">,c:</span><span class="s3">\&quot;</span><span class="s1">warn</span><span class="s3">\&quot;</span><span class="s1">},{n:</span><span class="s3">\&quot;</span><span class="s1">info</span><span class="s3">\&quot;</span><span class="s1">,c:</span><span class="s3">\&quot;</span><span class="s1">info</span><span class="s3">\&quot;</span><span class="s1">},{n:</span><span class="s3">\&quot;</span><span class="s1">debug</span><span class="s3">\&quot;</span><span class="s1">,c:</span><span class="s3">\&quot;</span><span class="s1">debug</span><span class="s3">\&quot;</span><span class="s1">},{n:</span><span class="s3">\&quot;</span><span class="s1">verbose</span><span class="s3">\&quot;</span><span class="s1">,c:</span><span class="s3">\&quot;</span><span class="s1">trace</span><span class="s3">\&quot;</span><span class="s1">}];class DiagConsoleLogger{constructor(){function _consoleFunc(e){return function(...t){if(console){let r=console[e];if(typeof r!==</span><span class="s3">\&quot;</span><span class="s1">function</span><span class="s3">\&quot;</span><span class="s1">){r=console.log}if(typeof r===</span><span class="s3">\&quot;</span><span class="s1">function</span><span class="s3">\&quot;</span><span class="s1">){return r.apply(console,t)}}}}for(let e=0;e&lt;r.length;e++){this[r[e].n]=_consoleFunc(r[e].c)}}}t.DiagConsoleLogger=DiagConsoleLogger},912:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.createLogLevelDiagLogger=void 0;const n=r(957);function createLogLevelDiagLogger(e,t){if(e&lt;n.DiagLogLevel.NONE){e=n.DiagLogLevel.NONE}else if(e&gt;n.DiagLogLevel.ALL){e=n.DiagLogLevel.ALL}t=t||{};function _filterFunc(r,n){const a=t[r];if(typeof a===</span><span class="s3">\&quot;</span><span class="s1">function</span><span class="s3">\&quot;</span><span class="s1">&amp;&amp;e&gt;=n){return a.bind(t)}return function(){}}return{error:_filterFunc(</span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">,n.DiagLogLevel.ERROR),warn:_filterFunc(</span><span class="s3">\&quot;</span><span class="s1">warn</span><span class="s3">\&quot;</span><span class="s1">,n.DiagLogLevel.WARN),info:_filterFunc(</span><span class="s3">\&quot;</span><span class="s1">info</span><span class="s3">\&quot;</span><span class="s1">,n.DiagLogLevel.INFO),debug:_filterFunc(</span><span class="s3">\&quot;</span><span class="s1">debug</span><span class="s3">\&quot;</span><span class="s1">,n.DiagLogLevel.DEBUG),verbose:_filterFunc(</span><span class="s3">\&quot;</span><span class="s1">verbose</span><span class="s3">\&quot;</span><span class="s1">,n.DiagLogLevel.VERBOSE)}}t.createLogLevelDiagLogger=createLogLevelDiagLogger},957:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.DiagLogLevel=void 0;var r;(function(e){e[e[</span><span class="s3">\&quot;</span><span class="s1">NONE</span><span class="s3">\&quot;</span><span class="s1">]=0]=</span><span class="s3">\&quot;</span><span class="s1">NONE</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">ERROR</span><span class="s3">\&quot;</span><span class="s1">]=30]=</span><span class="s3">\&quot;</span><span class="s1">ERROR</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">WARN</span><span class="s3">\&quot;</span><span class="s1">]=50]=</span><span class="s3">\&quot;</span><span class="s1">WARN</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">INFO</span><span class="s3">\&quot;</span><span class="s1">]=60]=</span><span class="s3">\&quot;</span><span class="s1">INFO</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">DEBUG</span><span class="s3">\&quot;</span><span class="s1">]=70]=</span><span class="s3">\&quot;</span><span class="s1">DEBUG</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">VERBOSE</span><span class="s3">\&quot;</span><span class="s1">]=80]=</span><span class="s3">\&quot;</span><span class="s1">VERBOSE</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">ALL</span><span class="s3">\&quot;</span><span class="s1">]=9999]=</span><span class="s3">\&quot;</span><span class="s1">ALL</span><span class="s3">\&quot;</span><span class="s1">})(r=t.DiagLogLevel||(t.DiagLogLevel={}))},172:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.unregisterGlobal=t.getGlobal=t.registerGlobal=void 0;const n=r(200);const a=r(521);const o=r(130);const i=a.VERSION.split(</span><span class="s3">\&quot;</span><span class="s1">.</span><span class="s3">\&quot;</span><span class="s1">)[0];const c=Symbol.for(`opentelemetry.js.api.${i}`);const s=n._globalThis;function registerGlobal(e,t,r,n=false){var o;const i=s[c]=(o=s[c])!==null&amp;&amp;o!==void 0?o:{version:a.VERSION};if(!n&amp;&amp;i[e]){const t=new Error(`@opentelemetry/api: Attempted duplicate registration of API: ${e}`);r.error(t.stack||t.message);return false}if(i.version!==a.VERSION){const t=new Error(`@opentelemetry/api: Registration of version v${i.version} for ${e} does not match previously registered API v${a.VERSION}`);r.error(t.stack||t.message);return false}i[e]=t;r.debug(`@opentelemetry/api: Registered a global for ${e} v${a.VERSION}.`);return true}t.registerGlobal=registerGlobal;function getGlobal(e){var t,r;const n=(t=s[c])===null||t===void 0?void 0:t.version;if(!n||!(0,o.isCompatible)(n)){return}return(r=s[c])===null||r===void 0?void 0:r[e]}t.getGlobal=getGlobal;function unregisterGlobal(e,t){t.debug(`@opentelemetry/api: Unregistering a global for ${e} v${a.VERSION}.`);const r=s[c];if(r){delete r[e]}}t.unregisterGlobal=unregisterGlobal},130:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.isCompatible=t._makeCompatibilityCheck=void 0;const n=r(521);const a=/^(</span><span class="s3">\\</span><span class="s1">d+)</span><span class="s3">\\</span><span class="s1">.(</span><span class="s3">\\</span><span class="s1">d+)</span><span class="s3">\\</span><span class="s1">.(</span><span class="s3">\\</span><span class="s1">d+)(-(.+))?$/;function _makeCompatibilityCheck(e){const t=new Set([e]);const r=new Set;const n=e.match(a);if(!n){return()=&gt;false}const o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(o.prerelease!=null){return function isExactmatch(t){return t===e}}function _reject(e){r.add(e);return false}function _accept(e){t.add(e);return true}return function isCompatible(e){if(t.has(e)){return true}if(r.has(e)){return false}const n=e.match(a);if(!n){return _reject(e)}const i={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(i.prerelease!=null){return _reject(e)}if(o.major!==i.major){return _reject(e)}if(o.major===0){if(o.minor===i.minor&amp;&amp;o.patch&lt;=i.patch){return _accept(e)}return _reject(e)}if(o.minor&lt;=i.minor){return _accept(e)}return _reject(e)}}t._makeCompatibilityCheck=_makeCompatibilityCheck;t.isCompatible=_makeCompatibilityCheck(n.VERSION)},886:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.metrics=void 0;const n=r(653);t.metrics=n.MetricsAPI.getInstance()},901:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.ValueType=void 0;var r;(function(e){e[e[</span><span class="s3">\&quot;</span><span class="s1">INT</span><span class="s3">\&quot;</span><span class="s1">]=0]=</span><span class="s3">\&quot;</span><span class="s1">INT</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">DOUBLE</span><span class="s3">\&quot;</span><span class="s1">]=1]=</span><span class="s3">\&quot;</span><span class="s1">DOUBLE</span><span class="s3">\&quot;</span><span class="s1">})(r=t.ValueType||(t.ValueType={}))},102:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.createNoopMeter=t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=t.NOOP_OBSERVABLE_GAUGE_METRIC=t.NOOP_OBSERVABLE_COUNTER_METRIC=t.NOOP_UP_DOWN_COUNTER_METRIC=t.NOOP_HISTOGRAM_METRIC=t.NOOP_COUNTER_METRIC=t.NOOP_METER=t.NoopObservableUpDownCounterMetric=t.NoopObservableGaugeMetric=t.NoopObservableCounterMetric=t.NoopObservableMetric=t.NoopHistogramMetric=t.NoopUpDownCounterMetric=t.NoopCounterMetric=t.NoopMetric=t.NoopMeter=void 0;class NoopMeter{constructor(){}createHistogram(e,r){return t.NOOP_HISTOGRAM_METRIC}createCounter(e,r){return t.NOOP_COUNTER_METRIC}createUpDownCounter(e,r){return t.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(e,r){return t.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(e,r){return t.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(e,r){return t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(e,t){}removeBatchObservableCallback(e){}}t.NoopMeter=NoopMeter;class NoopMetric{}t.NoopMetric=NoopMetric;class NoopCounterMetric extends NoopMetric{add(e,t){}}t.NoopCounterMetric=NoopCounterMetric;class NoopUpDownCounterMetric extends NoopMetric{add(e,t){}}t.NoopUpDownCounterMetric=NoopUpDownCounterMetric;class NoopHistogramMetric extends NoopMetric{record(e,t){}}t.NoopHistogramMetric=NoopHistogramMetric;class NoopObservableMetric{addCallback(e){}removeCallback(e){}}t.NoopObservableMetric=NoopObservableMetric;class NoopObservableCounterMetric extends NoopObservableMetric{}t.NoopObservableCounterMetric=NoopObservableCounterMetric;class NoopObservableGaugeMetric extends NoopObservableMetric{}t.NoopObservableGaugeMetric=NoopObservableGaugeMetric;class NoopObservableUpDownCounterMetric extends NoopObservableMetric{}t.NoopObservableUpDownCounterMetric=NoopObservableUpDownCounterMetric;t.NOOP_METER=new NoopMeter;t.NOOP_COUNTER_METRIC=new NoopCounterMetric;t.NOOP_HISTOGRAM_METRIC=new NoopHistogramMetric;t.NOOP_UP_DOWN_COUNTER_METRIC=new NoopUpDownCounterMetric;t.NOOP_OBSERVABLE_COUNTER_METRIC=new NoopObservableCounterMetric;t.NOOP_OBSERVABLE_GAUGE_METRIC=new NoopObservableGaugeMetric;t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new NoopObservableUpDownCounterMetric;function createNoopMeter(){return t.NOOP_METER}t.createNoopMeter=createNoopMeter},660:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.NOOP_METER_PROVIDER=t.NoopMeterProvider=void 0;const n=r(102);class NoopMeterProvider{getMeter(e,t,r){return n.NOOP_METER}}t.NoopMeterProvider=NoopMeterProvider;t.NOOP_METER_PROVIDER=new NoopMeterProvider},200:function(e,t,r){var n=this&amp;&amp;this.__createBinding||(Object.create?function(e,t,r,n){if(n===undefined)n=r;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,n){if(n===undefined)n=r;e[n]=t[r]});var a=this&amp;&amp;this.__exportStar||function(e,t){for(var r in e)if(r!==</span><span class="s3">\&quot;</span><span class="s1">default</span><span class="s3">\&quot;</span><span class="s1">&amp;&amp;!Object.prototype.hasOwnProperty.call(t,r))n(t,e,r)};Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});a(r(46),t)},651:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t._globalThis=void 0;t._globalThis=typeof globalThis===</span><span class="s3">\&quot;</span><span class="s1">object</span><span class="s3">\&quot;</span><span class="s1">?globalThis:global},46:function(e,t,r){var n=this&amp;&amp;this.__createBinding||(Object.create?function(e,t,r,n){if(n===undefined)n=r;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,n){if(n===undefined)n=r;e[n]=t[r]});var a=this&amp;&amp;this.__exportStar||function(e,t){for(var r in e)if(r!==</span><span class="s3">\&quot;</span><span class="s1">default</span><span class="s3">\&quot;</span><span class="s1">&amp;&amp;!Object.prototype.hasOwnProperty.call(t,r))n(t,e,r)};Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});a(r(651),t)},939:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.propagation=void 0;const n=r(181);t.propagation=n.PropagationAPI.getInstance()},874:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.NoopTextMapPropagator=void 0;class NoopTextMapPropagator{inject(e,t){}extract(e,t){return e}fields(){return[]}}t.NoopTextMapPropagator=NoopTextMapPropagator},194:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.defaultTextMapSetter=t.defaultTextMapGetter=void 0;t.defaultTextMapGetter={get(e,t){if(e==null){return undefined}return e[t]},keys(e){if(e==null){return[]}return Object.keys(e)}};t.defaultTextMapSetter={set(e,t,r){if(e==null){return}e[t]=r}}},845:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.trace=void 0;const n=r(997);t.trace=n.TraceAPI.getInstance()},403:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.NonRecordingSpan=void 0;const n=r(476);class NonRecordingSpan{constructor(e=n.INVALID_SPAN_CONTEXT){this._spanContext=e}spanContext(){return this._spanContext}setAttribute(e,t){return this}setAttributes(e){return this}addEvent(e,t){return this}setStatus(e){return this}updateName(e){return this}end(e){}isRecording(){return false}recordException(e,t){}}t.NonRecordingSpan=NonRecordingSpan},614:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.NoopTracer=void 0;const n=r(491);const a=r(607);const o=r(403);const i=r(139);const c=n.ContextAPI.getInstance();class NoopTracer{startSpan(e,t,r=c.active()){const n=Boolean(t===null||t===void 0?void 0:t.root);if(n){return new o.NonRecordingSpan}const s=r&amp;&amp;(0,a.getSpanContext)(r);if(isSpanContext(s)&amp;&amp;(0,i.isSpanContextValid)(s)){return new o.NonRecordingSpan(s)}else{return new o.NonRecordingSpan}}startActiveSpan(e,t,r,n){let o;let i;let s;if(arguments.length&lt;2){return}else if(arguments.length===2){s=t}else if(arguments.length===3){o=t;s=r}else{o=t;i=r;s=n}const u=i!==null&amp;&amp;i!==void 0?i:c.active();const l=this.startSpan(e,o,u);const g=(0,a.setSpan)(u,l);return c.with(g,s,undefined,l)}}t.NoopTracer=NoopTracer;function isSpanContext(e){return typeof e===</span><span class="s3">\&quot;</span><span class="s1">object</span><span class="s3">\&quot;</span><span class="s1">&amp;&amp;typeof e[</span><span class="s3">\&quot;</span><span class="s1">spanId</span><span class="s3">\&quot;</span><span class="s1">]===</span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">&amp;&amp;typeof e[</span><span class="s3">\&quot;</span><span class="s1">traceId</span><span class="s3">\&quot;</span><span class="s1">]===</span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">&amp;&amp;typeof e[</span><span class="s3">\&quot;</span><span class="s1">traceFlags</span><span class="s3">\&quot;</span><span class="s1">]===</span><span class="s3">\&quot;</span><span class="s1">number</span><span class="s3">\&quot;</span><span class="s1">}},124:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.NoopTracerProvider=void 0;const n=r(614);class NoopTracerProvider{getTracer(e,t,r){return new n.NoopTracer}}t.NoopTracerProvider=NoopTracerProvider},125:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.ProxyTracer=void 0;const n=r(614);const a=new n.NoopTracer;class ProxyTracer{constructor(e,t,r,n){this._provider=e;this.name=t;this.version=r;this.options=n}startSpan(e,t,r){return this._getTracer().startSpan(e,t,r)}startActiveSpan(e,t,r,n){const a=this._getTracer();return Reflect.apply(a.startActiveSpan,a,arguments)}_getTracer(){if(this._delegate){return this._delegate}const e=this._provider.getDelegateTracer(this.name,this.version,this.options);if(!e){return a}this._delegate=e;return this._delegate}}t.ProxyTracer=ProxyTracer},846:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.ProxyTracerProvider=void 0;const n=r(125);const a=r(124);const o=new a.NoopTracerProvider;class ProxyTracerProvider{getTracer(e,t,r){var a;return(a=this.getDelegateTracer(e,t,r))!==null&amp;&amp;a!==void 0?a:new n.ProxyTracer(this,e,t,r)}getDelegate(){var e;return(e=this._delegate)!==null&amp;&amp;e!==void 0?e:o}setDelegate(e){this._delegate=e}getDelegateTracer(e,t,r){var n;return(n=this._delegate)===null||n===void 0?void 0:n.getTracer(e,t,r)}}t.ProxyTracerProvider=ProxyTracerProvider},996:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.SamplingDecision=void 0;var r;(function(e){e[e[</span><span class="s3">\&quot;</span><span class="s1">NOT_RECORD</span><span class="s3">\&quot;</span><span class="s1">]=0]=</span><span class="s3">\&quot;</span><span class="s1">NOT_RECORD</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">RECORD</span><span class="s3">\&quot;</span><span class="s1">]=1]=</span><span class="s3">\&quot;</span><span class="s1">RECORD</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">RECORD_AND_SAMPLED</span><span class="s3">\&quot;</span><span class="s1">]=2]=</span><span class="s3">\&quot;</span><span class="s1">RECORD_AND_SAMPLED</span><span class="s3">\&quot;</span><span class="s1">})(r=t.SamplingDecision||(t.SamplingDecision={}))},607:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.getSpanContext=t.setSpanContext=t.deleteSpan=t.setSpan=t.getActiveSpan=t.getSpan=void 0;const n=r(780);const a=r(403);const o=r(491);const i=(0,n.createContextKey)(</span><span class="s3">\&quot;</span><span class="s1">OpenTelemetry Context Key SPAN</span><span class="s3">\&quot;</span><span class="s1">);function getSpan(e){return e.getValue(i)||undefined}t.getSpan=getSpan;function getActiveSpan(){return getSpan(o.ContextAPI.getInstance().active())}t.getActiveSpan=getActiveSpan;function setSpan(e,t){return e.setValue(i,t)}t.setSpan=setSpan;function deleteSpan(e){return e.deleteValue(i)}t.deleteSpan=deleteSpan;function setSpanContext(e,t){return setSpan(e,new a.NonRecordingSpan(t))}t.setSpanContext=setSpanContext;function getSpanContext(e){var t;return(t=getSpan(e))===null||t===void 0?void 0:t.spanContext()}t.getSpanContext=getSpanContext},325:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.TraceStateImpl=void 0;const n=r(564);const a=32;const o=512;const i=</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">;const c=</span><span class="s3">\&quot;</span><span class="s1">=</span><span class="s3">\&quot;</span><span class="s1">;class TraceStateImpl{constructor(e){this._internalState=new Map;if(e)this._parse(e)}set(e,t){const r=this._clone();if(r._internalState.has(e)){r._internalState.delete(e)}r._internalState.set(e,t);return r}unset(e){const t=this._clone();t._internalState.delete(e);return t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce(((e,t)=&gt;{e.push(t+c+this.get(t));return e}),[]).join(i)}_parse(e){if(e.length&gt;o)return;this._internalState=e.split(i).reverse().reduce(((e,t)=&gt;{const r=t.trim();const a=r.indexOf(c);if(a!==-1){const o=r.slice(0,a);const i=r.slice(a+1,t.length);if((0,n.validateKey)(o)&amp;&amp;(0,n.validateValue)(i)){e.set(o,i)}else{}}return e}),new Map);if(this._internalState.size&gt;a){this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,a))}}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){const e=new TraceStateImpl;e._internalState=new Map(this._internalState);return e}}t.TraceStateImpl=TraceStateImpl},564:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.validateValue=t.validateKey=void 0;const r=</span><span class="s3">\&quot;</span><span class="s1">[_0-9a-z-*/]</span><span class="s3">\&quot;</span><span class="s1">;const n=`[a-z]${r}{0,255}`;const a=`[a-z0-9]${r}{0,240}@[a-z]${r}{0,13}`;const o=new RegExp(`^(?:${n}|${a})$`);const i=/^[ -~]{0,255}[!-~]$/;const c=/,|=/;function validateKey(e){return o.test(e)}t.validateKey=validateKey;function validateValue(e){return i.test(e)&amp;&amp;!c.test(e)}t.validateValue=validateValue},98:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.createTraceState=void 0;const n=r(325);function createTraceState(e){return new n.TraceStateImpl(e)}t.createTraceState=createTraceState},476:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.INVALID_SPAN_CONTEXT=t.INVALID_TRACEID=t.INVALID_SPANID=void 0;const n=r(475);t.INVALID_SPANID=</span><span class="s3">\&quot;</span><span class="s1">0000000000000000</span><span class="s3">\&quot;</span><span class="s1">;t.INVALID_TRACEID=</span><span class="s3">\&quot;</span><span class="s1">00000000000000000000000000000000</span><span class="s3">\&quot;</span><span class="s1">;t.INVALID_SPAN_CONTEXT={traceId:t.INVALID_TRACEID,spanId:t.INVALID_SPANID,traceFlags:n.TraceFlags.NONE}},357:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.SpanKind=void 0;var r;(function(e){e[e[</span><span class="s3">\&quot;</span><span class="s1">INTERNAL</span><span class="s3">\&quot;</span><span class="s1">]=0]=</span><span class="s3">\&quot;</span><span class="s1">INTERNAL</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">SERVER</span><span class="s3">\&quot;</span><span class="s1">]=1]=</span><span class="s3">\&quot;</span><span class="s1">SERVER</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">CLIENT</span><span class="s3">\&quot;</span><span class="s1">]=2]=</span><span class="s3">\&quot;</span><span class="s1">CLIENT</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">PRODUCER</span><span class="s3">\&quot;</span><span class="s1">]=3]=</span><span class="s3">\&quot;</span><span class="s1">PRODUCER</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">CONSUMER</span><span class="s3">\&quot;</span><span class="s1">]=4]=</span><span class="s3">\&quot;</span><span class="s1">CONSUMER</span><span class="s3">\&quot;</span><span class="s1">})(r=t.SpanKind||(t.SpanKind={}))},139:(e,t,r)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.wrapSpanContext=t.isSpanContextValid=t.isValidSpanId=t.isValidTraceId=void 0;const n=r(476);const a=r(403);const o=/^([0-9a-f]{32})$/i;const i=/^[0-9a-f]{16}$/i;function isValidTraceId(e){return o.test(e)&amp;&amp;e!==n.INVALID_TRACEID}t.isValidTraceId=isValidTraceId;function isValidSpanId(e){return i.test(e)&amp;&amp;e!==n.INVALID_SPANID}t.isValidSpanId=isValidSpanId;function isSpanContextValid(e){return isValidTraceId(e.traceId)&amp;&amp;isValidSpanId(e.spanId)}t.isSpanContextValid=isSpanContextValid;function wrapSpanContext(e){return new a.NonRecordingSpan(e)}t.wrapSpanContext=wrapSpanContext},847:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.SpanStatusCode=void 0;var r;(function(e){e[e[</span><span class="s3">\&quot;</span><span class="s1">UNSET</span><span class="s3">\&quot;</span><span class="s1">]=0]=</span><span class="s3">\&quot;</span><span class="s1">UNSET</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">OK</span><span class="s3">\&quot;</span><span class="s1">]=1]=</span><span class="s3">\&quot;</span><span class="s1">OK</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">ERROR</span><span class="s3">\&quot;</span><span class="s1">]=2]=</span><span class="s3">\&quot;</span><span class="s1">ERROR</span><span class="s3">\&quot;</span><span class="s1">})(r=t.SpanStatusCode||(t.SpanStatusCode={}))},475:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.TraceFlags=void 0;var r;(function(e){e[e[</span><span class="s3">\&quot;</span><span class="s1">NONE</span><span class="s3">\&quot;</span><span class="s1">]=0]=</span><span class="s3">\&quot;</span><span class="s1">NONE</span><span class="s3">\&quot;</span><span class="s1">;e[e[</span><span class="s3">\&quot;</span><span class="s1">SAMPLED</span><span class="s3">\&quot;</span><span class="s1">]=1]=</span><span class="s3">\&quot;</span><span class="s1">SAMPLED</span><span class="s3">\&quot;</span><span class="s1">})(r=t.TraceFlags||(t.TraceFlags={}))},521:(e,t)=&gt;{Object.defineProperty(t,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});t.VERSION=void 0;t.VERSION=</span><span class="s3">\&quot;</span><span class="s1">1.6.0</span><span class="s3">\&quot;</span><span class="s1">}};var t={};function __nccwpck_require__(r){var n=t[r];if(n!==undefined){return n.exports}var a=t[r]={exports:{}};var o=true;try{e[r].call(a.exports,a,a.exports,__nccwpck_require__);o=false}finally{if(o)delete t[r]}return a.exports}if(typeof __nccwpck_require__!==</span><span class="s3">\&quot;</span><span class="s1">undefined</span><span class="s3">\&quot;</span><span class="s1">)__nccwpck_require__.ab=__dirname+</span><span class="s3">\&quot;</span><span class="s1">/</span><span class="s3">\&quot;</span><span class="s1">;var r={};(()=&gt;{var e=r;Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">,{value:true});e.trace=e.propagation=e.metrics=e.diag=e.context=e.INVALID_SPAN_CONTEXT=e.INVALID_TRACEID=e.INVALID_SPANID=e.isValidSpanId=e.isValidTraceId=e.isSpanContextValid=e.createTraceState=e.TraceFlags=e.SpanStatusCode=e.SpanKind=e.SamplingDecision=e.ProxyTracerProvider=e.ProxyTracer=e.defaultTextMapSetter=e.defaultTextMapGetter=e.ValueType=e.createNoopMeter=e.DiagLogLevel=e.DiagConsoleLogger=e.ROOT_CONTEXT=e.createContextKey=e.baggageEntryMetadataFromString=void 0;var t=__nccwpck_require__(369);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">baggageEntryMetadataFromString</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return t.baggageEntryMetadataFromString}});var n=__nccwpck_require__(780);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">createContextKey</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return n.createContextKey}});Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">ROOT_CONTEXT</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return n.ROOT_CONTEXT}});var a=__nccwpck_require__(972);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">DiagConsoleLogger</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return a.DiagConsoleLogger}});var o=__nccwpck_require__(957);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">DiagLogLevel</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return o.DiagLogLevel}});var i=__nccwpck_require__(102);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">createNoopMeter</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return i.createNoopMeter}});var c=__nccwpck_require__(901);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">ValueType</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return c.ValueType}});var s=__nccwpck_require__(194);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">defaultTextMapGetter</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return s.defaultTextMapGetter}});Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">defaultTextMapSetter</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return s.defaultTextMapSetter}});var u=__nccwpck_require__(125);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">ProxyTracer</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return u.ProxyTracer}});var l=__nccwpck_require__(846);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">ProxyTracerProvider</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return l.ProxyTracerProvider}});var g=__nccwpck_require__(996);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">SamplingDecision</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return g.SamplingDecision}});var p=__nccwpck_require__(357);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">SpanKind</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return p.SpanKind}});var d=__nccwpck_require__(847);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">SpanStatusCode</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return d.SpanStatusCode}});var _=__nccwpck_require__(475);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">TraceFlags</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return _.TraceFlags}});var f=__nccwpck_require__(98);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">createTraceState</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return f.createTraceState}});var b=__nccwpck_require__(139);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">isSpanContextValid</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return b.isSpanContextValid}});Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">isValidTraceId</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return b.isValidTraceId}});Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">isValidSpanId</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return b.isValidSpanId}});var v=__nccwpck_require__(476);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">INVALID_SPANID</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return v.INVALID_SPANID}});Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">INVALID_TRACEID</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return v.INVALID_TRACEID}});Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">INVALID_SPAN_CONTEXT</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return v.INVALID_SPAN_CONTEXT}});const O=__nccwpck_require__(67);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">context</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return O.context}});const P=__nccwpck_require__(506);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">diag</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return P.diag}});const N=__nccwpck_require__(886);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">metrics</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return N.metrics}});const S=__nccwpck_require__(939);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">propagation</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return S.propagation}});const C=__nccwpck_require__(845);Object.defineProperty(e,</span><span class="s3">\&quot;</span><span class="s1">trace</span><span class="s3">\&quot;</span><span class="s1">,{enumerable:true,get:function(){return C.trace}});e[</span><span class="s3">\&quot;</span><span class="s1">default</span><span class="s3">\&quot;</span><span class="s1">]={context:O.context,diag:P.diag,metrics:N.metrics,propagation:S.propagation,trace:C.trace}})();module.exports=r})();&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1717</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/trace/tracer.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { FetchEventResult } from '../../web/types'</span><span class="s3">\n</span><span class="s1">import type { TextMapSetter } from '@opentelemetry/api'</span><span class="s3">\n</span><span class="s1">import type { SpanTypes } from './constants'</span><span class="s3">\n</span><span class="s1">import { LogSpanAllowList, NextVanillaSpanAllowlist } from './constants'</span><span class="s3">\n\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">ContextAPI,</span><span class="s3">\n  </span><span class="s1">Span,</span><span class="s3">\n  </span><span class="s1">SpanOptions,</span><span class="s3">\n  </span><span class="s1">Tracer,</span><span class="s3">\n  </span><span class="s1">AttributeValue,</span><span class="s3">\n  </span><span class="s1">TextMapGetter,</span><span class="s3">\n</span><span class="s1">} from 'next/dist/compiled/@opentelemetry/api'</span><span class="s3">\n</span><span class="s1">import { isThenable } from '../../../shared/lib/is-thenable'</span><span class="s3">\n\n</span><span class="s1">let api: typeof import('next/dist/compiled/@opentelemetry/api')</span><span class="s3">\n\n</span><span class="s1">// we want to allow users to use their own version of @opentelemetry/api if they</span><span class="s3">\n</span><span class="s1">// want to, so we try to require it first, and if it fails we fall back to the</span><span class="s3">\n</span><span class="s1">// version that is bundled with Next.js</span><span class="s3">\n</span><span class="s1">// this is because @opentelemetry/api has to be synced with the version of</span><span class="s3">\n</span><span class="s1">// @opentelemetry/tracing that is used, and we don't want to force users to use</span><span class="s3">\n</span><span class="s1">// the version that is bundled with Next.js.</span><span class="s3">\n</span><span class="s1">// the API is ~stable, so this should be fine</span><span class="s3">\n</span><span class="s1">if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n  </span><span class="s1">api = require('@opentelemetry/api') as typeof import('@opentelemetry/api')</span><span class="s3">\n</span><span class="s1">} else {</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">api = require('@opentelemetry/api') as typeof import('@opentelemetry/api')</span><span class="s3">\n  </span><span class="s1">} catch (err) {</span><span class="s3">\n    </span><span class="s1">api =</span><span class="s3">\n      </span><span class="s1">require('next/dist/compiled/@opentelemetry/api') as typeof import('next/dist/compiled/@opentelemetry/api')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const { context, propagation, trace, SpanStatusCode, SpanKind, ROOT_CONTEXT } =</span><span class="s3">\n  </span><span class="s1">api</span><span class="s3">\n\n</span><span class="s1">export class BubbledError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">public readonly bubble?: boolean,</span><span class="s3">\n    </span><span class="s1">public readonly result?: FetchEventResult</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">super()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isBubbledError(error: unknown): error is BubbledError {</span><span class="s3">\n  </span><span class="s1">if (typeof error !== 'object' || error === null) return false</span><span class="s3">\n  </span><span class="s1">return error instanceof BubbledError</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const closeSpanWithError = (span: Span, error?: Error) =&gt; {</span><span class="s3">\n  </span><span class="s1">if (isBubbledError(error) &amp;&amp; error.bubble) {</span><span class="s3">\n    </span><span class="s1">span.setAttribute('next.bubble', true)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">if (error) {</span><span class="s3">\n      </span><span class="s1">span.recordException(error)</span><span class="s3">\n      </span><span class="s1">span.setAttribute('error.type', error.name)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">span.setStatus({ code: SpanStatusCode.ERROR, message: error?.message })</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">span.end()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type TracerSpanOptions = Omit&lt;SpanOptions, 'attributes'&gt; &amp; {</span><span class="s3">\n  </span><span class="s1">parentSpan?: Span</span><span class="s3">\n  </span><span class="s1">spanName?: string</span><span class="s3">\n  </span><span class="s1">attributes?: Partial&lt;Record&lt;AttributeNames, AttributeValue | undefined&gt;&gt;</span><span class="s3">\n  </span><span class="s1">hideSpan?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface NextTracer {</span><span class="s3">\n  </span><span class="s1">getContext(): ContextAPI</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Instruments a function by automatically creating a span activated on its</span><span class="s3">\n   </span><span class="s1">* scope.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* The span will automatically be finished when one of these conditions is</span><span class="s3">\n   </span><span class="s1">* met:</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* * The function returns a promise, in which case the span will finish when</span><span class="s3">\n   </span><span class="s1">* the promise is resolved or rejected.</span><span class="s3">\n   </span><span class="s1">* * The function takes a callback as its second parameter, in which case the</span><span class="s3">\n   </span><span class="s1">* span will finish when that callback is called.</span><span class="s3">\n   </span><span class="s1">* * The function doesn't accept a callback and doesn't return a promise, in</span><span class="s3">\n   </span><span class="s1">* which case the span will finish at the end of the function execution.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">trace&lt;T&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">fn: (span?: Span, done?: (error?: Error) =&gt; any) =&gt; Promise&lt;T&gt;</span><span class="s3">\n  </span><span class="s1">): Promise&lt;T&gt;</span><span class="s3">\n  </span><span class="s1">trace&lt;T&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">fn: (span?: Span, done?: (error?: Error) =&gt; any) =&gt; T</span><span class="s3">\n  </span><span class="s1">): T</span><span class="s3">\n  </span><span class="s1">trace&lt;T&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">options: TracerSpanOptions,</span><span class="s3">\n    </span><span class="s1">fn: (span?: Span, done?: (error?: Error) =&gt; any) =&gt; Promise&lt;T&gt;</span><span class="s3">\n  </span><span class="s1">): Promise&lt;T&gt;</span><span class="s3">\n  </span><span class="s1">trace&lt;T&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">options: TracerSpanOptions,</span><span class="s3">\n    </span><span class="s1">fn: (span?: Span, done?: (error?: Error) =&gt; any) =&gt; T</span><span class="s3">\n  </span><span class="s1">): T</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Wrap a function to automatically create a span activated on its</span><span class="s3">\n   </span><span class="s1">* scope when it's called.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* The span will automatically be finished when one of these conditions is</span><span class="s3">\n   </span><span class="s1">* met:</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* * The function returns a promise, in which case the span will finish when</span><span class="s3">\n   </span><span class="s1">* the promise is resolved or rejected.</span><span class="s3">\n   </span><span class="s1">* * The function takes a callback as its last parameter, in which case the</span><span class="s3">\n   </span><span class="s1">* span will finish when that callback is called.</span><span class="s3">\n   </span><span class="s1">* * The function doesn't accept a callback and doesn't return a promise, in</span><span class="s3">\n   </span><span class="s1">* which case the span will finish at the end of the function execution.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">wrap&lt;T = (...args: Array&lt;any&gt;) =&gt; any&gt;(type: SpanTypes, fn: T): T</span><span class="s3">\n  </span><span class="s1">wrap&lt;T = (...args: Array&lt;any&gt;) =&gt; any&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">options: TracerSpanOptions,</span><span class="s3">\n    </span><span class="s1">fn: T</span><span class="s3">\n  </span><span class="s1">): T</span><span class="s3">\n  </span><span class="s1">wrap&lt;T = (...args: Array&lt;any&gt;) =&gt; any&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">options: (...args: any[]) =&gt; TracerSpanOptions,</span><span class="s3">\n    </span><span class="s1">fn: T</span><span class="s3">\n  </span><span class="s1">): T</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Starts and returns a new Span representing a logical unit of work.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* This method do NOT modify the current Context by default. In result, any inner span will not</span><span class="s3">\n   </span><span class="s1">* automatically set its parent context to the span created by this method unless manually activate</span><span class="s3">\n   </span><span class="s1">* context via `tracer.getContext().with`. `trace`, or `wrap` is generally recommended as it gracefully</span><span class="s3">\n   </span><span class="s1">* handles context activation. (ref: https://github.com/open-telemetry/opentelemetry-js/issues/1923)</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">startSpan(type: SpanTypes): Span</span><span class="s3">\n  </span><span class="s1">startSpan(type: SpanTypes, options: TracerSpanOptions): Span</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns currently activated span if current context is in the scope of the span.</span><span class="s3">\n   </span><span class="s1">* Returns undefined otherwise.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">getActiveScopeSpan(): Span | undefined</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns trace propagation data for the currently active context. The format is equal to data provided</span><span class="s3">\n   </span><span class="s1">* through the OpenTelemetry propagator API.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">getTracePropagationData(): ClientTraceDataEntry[]</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type NextAttributeNames =</span><span class="s3">\n  </span><span class="s1">| 'next.route'</span><span class="s3">\n  </span><span class="s1">| 'next.page'</span><span class="s3">\n  </span><span class="s1">| 'next.rsc'</span><span class="s3">\n  </span><span class="s1">| 'next.segment'</span><span class="s3">\n  </span><span class="s1">| 'next.span_name'</span><span class="s3">\n  </span><span class="s1">| 'next.span_type'</span><span class="s3">\n  </span><span class="s1">| 'next.clientComponentLoadCount'</span><span class="s3">\n</span><span class="s1">type OTELAttributeNames = `http.${string}` | `net.${string}`</span><span class="s3">\n</span><span class="s1">type AttributeNames = NextAttributeNames | OTELAttributeNames</span><span class="s3">\n\n</span><span class="s1">/** we use this map to propagate attributes from nested spans to the top span */</span><span class="s3">\n</span><span class="s1">const rootSpanAttributesStore = new Map&lt;</span><span class="s3">\n  </span><span class="s1">number,</span><span class="s3">\n  </span><span class="s1">Map&lt;AttributeNames, AttributeValue | undefined&gt;</span><span class="s3">\n</span><span class="s1">&gt;()</span><span class="s3">\n</span><span class="s1">const rootSpanIdKey = api.createContextKey('next.rootSpanId')</span><span class="s3">\n</span><span class="s1">let lastSpanId = 0</span><span class="s3">\n</span><span class="s1">const getSpanId = () =&gt; lastSpanId++</span><span class="s3">\n\n</span><span class="s1">export interface ClientTraceDataEntry {</span><span class="s3">\n  </span><span class="s1">key: string</span><span class="s3">\n  </span><span class="s1">value: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const clientTraceDataSetter: TextMapSetter&lt;ClientTraceDataEntry[]&gt; = {</span><span class="s3">\n  </span><span class="s1">set(carrier, key, value) {</span><span class="s3">\n    </span><span class="s1">carrier.push({</span><span class="s3">\n      </span><span class="s1">key,</span><span class="s3">\n      </span><span class="s1">value,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">class NextTracerImpl implements NextTracer {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns an instance to the trace with configured name.</span><span class="s3">\n   </span><span class="s1">* Since wrap / trace can be defined in any place prior to actual trace subscriber initialization,</span><span class="s3">\n   </span><span class="s1">* This should be lazily evaluated.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">private getTracerInstance(): Tracer {</span><span class="s3">\n    </span><span class="s1">return trace.getTracer('next.js', '0.0.1')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public getContext(): ContextAPI {</span><span class="s3">\n    </span><span class="s1">return context</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public getTracePropagationData(): ClientTraceDataEntry[] {</span><span class="s3">\n    </span><span class="s1">const activeContext = context.active()</span><span class="s3">\n    </span><span class="s1">const entries: ClientTraceDataEntry[] = []</span><span class="s3">\n    </span><span class="s1">propagation.inject(activeContext, entries, clientTraceDataSetter)</span><span class="s3">\n    </span><span class="s1">return entries</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public getActiveScopeSpan(): Span | undefined {</span><span class="s3">\n    </span><span class="s1">return trace.getSpan(context?.active())</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public withPropagatedContext&lt;T, C&gt;(</span><span class="s3">\n    </span><span class="s1">carrier: C,</span><span class="s3">\n    </span><span class="s1">fn: () =&gt; T,</span><span class="s3">\n    </span><span class="s1">getter?: TextMapGetter&lt;C&gt;</span><span class="s3">\n  </span><span class="s1">): T {</span><span class="s3">\n    </span><span class="s1">const activeContext = context.active()</span><span class="s3">\n    </span><span class="s1">if (trace.getSpanContext(activeContext)) {</span><span class="s3">\n      </span><span class="s1">// Active span is already set, too late to propagate.</span><span class="s3">\n      </span><span class="s1">return fn()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const remoteContext = propagation.extract(activeContext, carrier, getter)</span><span class="s3">\n    </span><span class="s1">return context.with(remoteContext, fn)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Trace, wrap implementation is inspired by datadog trace implementation</span><span class="s3">\n  </span><span class="s1">// (https://datadoghq.dev/dd-trace-js/interfaces/tracer.html#trace).</span><span class="s3">\n  </span><span class="s1">public trace&lt;T&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">fn: (span?: Span, done?: (error?: Error) =&gt; any) =&gt; Promise&lt;T&gt;</span><span class="s3">\n  </span><span class="s1">): Promise&lt;T&gt;</span><span class="s3">\n  </span><span class="s1">public trace&lt;T&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">fn: (span?: Span, done?: (error?: Error) =&gt; any) =&gt; T</span><span class="s3">\n  </span><span class="s1">): T</span><span class="s3">\n  </span><span class="s1">public trace&lt;T&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">options: TracerSpanOptions,</span><span class="s3">\n    </span><span class="s1">fn: (span?: Span, done?: (error?: Error) =&gt; any) =&gt; Promise&lt;T&gt;</span><span class="s3">\n  </span><span class="s1">): Promise&lt;T&gt;</span><span class="s3">\n  </span><span class="s1">public trace&lt;T&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">options: TracerSpanOptions,</span><span class="s3">\n    </span><span class="s1">fn: (span?: Span, done?: (error?: Error) =&gt; any) =&gt; T</span><span class="s3">\n  </span><span class="s1">): T</span><span class="s3">\n  </span><span class="s1">public trace&lt;T&gt;(...args: Array&lt;any&gt;) {</span><span class="s3">\n    </span><span class="s1">const [type, fnOrOptions, fnOrEmpty] = args</span><span class="s3">\n\n    </span><span class="s1">// coerce options form overload</span><span class="s3">\n    </span><span class="s1">const {</span><span class="s3">\n      </span><span class="s1">fn,</span><span class="s3">\n      </span><span class="s1">options,</span><span class="s3">\n    </span><span class="s1">}: {</span><span class="s3">\n      </span><span class="s1">fn: (span?: Span, done?: (error?: Error) =&gt; any) =&gt; T | Promise&lt;T&gt;</span><span class="s3">\n      </span><span class="s1">options: TracerSpanOptions</span><span class="s3">\n    </span><span class="s1">} =</span><span class="s3">\n      </span><span class="s1">typeof fnOrOptions === 'function'</span><span class="s3">\n        </span><span class="s1">? {</span><span class="s3">\n            </span><span class="s1">fn: fnOrOptions,</span><span class="s3">\n            </span><span class="s1">options: {},</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">: {</span><span class="s3">\n            </span><span class="s1">fn: fnOrEmpty,</span><span class="s3">\n            </span><span class="s1">options: { ...fnOrOptions },</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const spanName = options.spanName ?? type</span><span class="s3">\n\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">(!NextVanillaSpanAllowlist.includes(type) &amp;&amp;</span><span class="s3">\n        </span><span class="s1">process.env.NEXT_OTEL_VERBOSE !== '1') ||</span><span class="s3">\n      </span><span class="s1">options.hideSpan</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return fn()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// Trying to get active scoped span to assign parent. If option specifies parent span manually, will try to use it.</span><span class="s3">\n    </span><span class="s1">let spanContext = this.getSpanContext(</span><span class="s3">\n      </span><span class="s1">options?.parentSpan ?? this.getActiveScopeSpan()</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">let isRootSpan = false</span><span class="s3">\n\n    </span><span class="s1">if (!spanContext) {</span><span class="s3">\n      </span><span class="s1">spanContext = context?.active() ?? ROOT_CONTEXT</span><span class="s3">\n      </span><span class="s1">isRootSpan = true</span><span class="s3">\n    </span><span class="s1">} else if (trace.getSpanContext(spanContext)?.isRemote) {</span><span class="s3">\n      </span><span class="s1">isRootSpan = true</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const spanId = getSpanId()</span><span class="s3">\n\n    </span><span class="s1">options.attributes = {</span><span class="s3">\n      </span><span class="s1">'next.span_name': spanName,</span><span class="s3">\n      </span><span class="s1">'next.span_type': type,</span><span class="s3">\n      </span><span class="s1">...options.attributes,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return context.with(spanContext.setValue(rootSpanIdKey, spanId), () =&gt;</span><span class="s3">\n      </span><span class="s1">this.getTracerInstance().startActiveSpan(</span><span class="s3">\n        </span><span class="s1">spanName,</span><span class="s3">\n        </span><span class="s1">options,</span><span class="s3">\n        </span><span class="s1">(span: Span) =&gt; {</span><span class="s3">\n          </span><span class="s1">const startTime =</span><span class="s3">\n            </span><span class="s1">'performance' in globalThis &amp;&amp; 'measure' in performance</span><span class="s3">\n              </span><span class="s1">? globalThis.performance.now()</span><span class="s3">\n              </span><span class="s1">: undefined</span><span class="s3">\n\n          </span><span class="s1">const onCleanup = () =&gt; {</span><span class="s3">\n            </span><span class="s1">rootSpanAttributesStore.delete(spanId)</span><span class="s3">\n            </span><span class="s1">if (</span><span class="s3">\n              </span><span class="s1">startTime &amp;&amp;</span><span class="s3">\n              </span><span class="s1">process.env.NEXT_OTEL_PERFORMANCE_PREFIX &amp;&amp;</span><span class="s3">\n              </span><span class="s1">LogSpanAllowList.includes(type || ('' as any))</span><span class="s3">\n            </span><span class="s1">) {</span><span class="s3">\n              </span><span class="s1">performance.measure(</span><span class="s3">\n                </span><span class="s1">`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-${(</span><span class="s3">\n                  </span><span class="s1">type.split('.').pop() || ''</span><span class="s3">\n                </span><span class="s1">).replace(</span><span class="s3">\n                  </span><span class="s1">/[A-Z]/g,</span><span class="s3">\n                  </span><span class="s1">(match: string) =&gt; '-' + match.toLowerCase()</span><span class="s3">\n                </span><span class="s1">)}`,</span><span class="s3">\n                </span><span class="s1">{</span><span class="s3">\n                  </span><span class="s1">start: startTime,</span><span class="s3">\n                  </span><span class="s1">end: performance.now(),</span><span class="s3">\n                </span><span class="s1">}</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">if (isRootSpan) {</span><span class="s3">\n            </span><span class="s1">rootSpanAttributesStore.set(</span><span class="s3">\n              </span><span class="s1">spanId,</span><span class="s3">\n              </span><span class="s1">new Map(</span><span class="s3">\n                </span><span class="s1">Object.entries(options.attributes ?? {}) as [</span><span class="s3">\n                  </span><span class="s1">AttributeNames,</span><span class="s3">\n                  </span><span class="s1">AttributeValue | undefined,</span><span class="s3">\n                </span><span class="s1">][]</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">try {</span><span class="s3">\n            </span><span class="s1">if (fn.length &gt; 1) {</span><span class="s3">\n              </span><span class="s1">return fn(span, (err) =&gt; closeSpanWithError(span, err))</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">const result = fn(span)</span><span class="s3">\n            </span><span class="s1">if (isThenable(result)) {</span><span class="s3">\n              </span><span class="s1">// If there's error make sure it throws</span><span class="s3">\n              </span><span class="s1">return result</span><span class="s3">\n                </span><span class="s1">.then((res) =&gt; {</span><span class="s3">\n                  </span><span class="s1">span.end()</span><span class="s3">\n                  </span><span class="s1">// Need to pass down the promise result,</span><span class="s3">\n                  </span><span class="s1">// it could be react stream response with error { error, stream }</span><span class="s3">\n                  </span><span class="s1">return res</span><span class="s3">\n                </span><span class="s1">})</span><span class="s3">\n                </span><span class="s1">.catch((err) =&gt; {</span><span class="s3">\n                  </span><span class="s1">closeSpanWithError(span, err)</span><span class="s3">\n                  </span><span class="s1">throw err</span><span class="s3">\n                </span><span class="s1">})</span><span class="s3">\n                </span><span class="s1">.finally(onCleanup)</span><span class="s3">\n            </span><span class="s1">} else {</span><span class="s3">\n              </span><span class="s1">span.end()</span><span class="s3">\n              </span><span class="s1">onCleanup()</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">return result</span><span class="s3">\n          </span><span class="s1">} catch (err: any) {</span><span class="s3">\n            </span><span class="s1">closeSpanWithError(span, err)</span><span class="s3">\n            </span><span class="s1">onCleanup()</span><span class="s3">\n            </span><span class="s1">throw err</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public wrap&lt;T = (...args: Array&lt;any&gt;) =&gt; any&gt;(type: SpanTypes, fn: T): T</span><span class="s3">\n  </span><span class="s1">public wrap&lt;T = (...args: Array&lt;any&gt;) =&gt; any&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">options: TracerSpanOptions,</span><span class="s3">\n    </span><span class="s1">fn: T</span><span class="s3">\n  </span><span class="s1">): T</span><span class="s3">\n  </span><span class="s1">public wrap&lt;T = (...args: Array&lt;any&gt;) =&gt; any&gt;(</span><span class="s3">\n    </span><span class="s1">type: SpanTypes,</span><span class="s3">\n    </span><span class="s1">options: (...args: any[]) =&gt; TracerSpanOptions,</span><span class="s3">\n    </span><span class="s1">fn: T</span><span class="s3">\n  </span><span class="s1">): T</span><span class="s3">\n  </span><span class="s1">public wrap(...args: Array&lt;any&gt;) {</span><span class="s3">\n    </span><span class="s1">const tracer = this</span><span class="s3">\n    </span><span class="s1">const [name, options, fn] =</span><span class="s3">\n      </span><span class="s1">args.length === 3 ? args : [args[0], {}, args[1]]</span><span class="s3">\n\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">!NextVanillaSpanAllowlist.includes(name) &amp;&amp;</span><span class="s3">\n      </span><span class="s1">process.env.NEXT_OTEL_VERBOSE !== '1'</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return fn</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return function (this: any) {</span><span class="s3">\n      </span><span class="s1">let optionsObj = options</span><span class="s3">\n      </span><span class="s1">if (typeof optionsObj === 'function' &amp;&amp; typeof fn === 'function') {</span><span class="s3">\n        </span><span class="s1">optionsObj = optionsObj.apply(this, arguments)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const lastArgId = arguments.length - 1</span><span class="s3">\n      </span><span class="s1">const cb = arguments[lastArgId]</span><span class="s3">\n\n      </span><span class="s1">if (typeof cb === 'function') {</span><span class="s3">\n        </span><span class="s1">const scopeBoundCb = tracer.getContext().bind(context.active(), cb)</span><span class="s3">\n        </span><span class="s1">return tracer.trace(name, optionsObj, (_span, done) =&gt; {</span><span class="s3">\n          </span><span class="s1">arguments[lastArgId] = function (err: any) {</span><span class="s3">\n            </span><span class="s1">done?.(err)</span><span class="s3">\n            </span><span class="s1">return scopeBoundCb.apply(this, arguments)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">return fn.apply(this, arguments)</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">return tracer.trace(name, optionsObj, () =&gt; fn.apply(this, arguments))</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public startSpan(type: SpanTypes): Span</span><span class="s3">\n  </span><span class="s1">public startSpan(type: SpanTypes, options: TracerSpanOptions): Span</span><span class="s3">\n  </span><span class="s1">public startSpan(...args: Array&lt;any&gt;): Span {</span><span class="s3">\n    </span><span class="s1">const [type, options]: [string, TracerSpanOptions | undefined] = args as any</span><span class="s3">\n\n    </span><span class="s1">const spanContext = this.getSpanContext(</span><span class="s3">\n      </span><span class="s1">options?.parentSpan ?? this.getActiveScopeSpan()</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">return this.getTracerInstance().startSpan(type, options, spanContext)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private getSpanContext(parentSpan?: Span) {</span><span class="s3">\n    </span><span class="s1">const spanContext = parentSpan</span><span class="s3">\n      </span><span class="s1">? trace.setSpan(context.active(), parentSpan)</span><span class="s3">\n      </span><span class="s1">: undefined</span><span class="s3">\n\n    </span><span class="s1">return spanContext</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public getRootSpanAttributes() {</span><span class="s3">\n    </span><span class="s1">const spanId = context.active().getValue(rootSpanIdKey) as number</span><span class="s3">\n    </span><span class="s1">return rootSpanAttributesStore.get(spanId)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public setRootSpanAttribute(key: AttributeNames, value: AttributeValue) {</span><span class="s3">\n    </span><span class="s1">const spanId = context.active().getValue(rootSpanIdKey) as number</span><span class="s3">\n    </span><span class="s1">const attributes = rootSpanAttributesStore.get(spanId)</span><span class="s3">\n    </span><span class="s1">if (attributes) {</span><span class="s3">\n      </span><span class="s1">attributes.set(key, value)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const getTracer = (() =&gt; {</span><span class="s3">\n  </span><span class="s1">const tracer = new NextTracerImpl()</span><span class="s3">\n\n  </span><span class="s1">return () =&gt; tracer</span><span class="s3">\n</span><span class="s1">})()</span><span class="s3">\n\n</span><span class="s1">export { getTracer, SpanStatusCode, SpanKind }</span><span class="s3">\n</span><span class="s1">export type { NextTracer, Span, SpanOptions, ContextAPI, TracerSpanOptions }</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;LogSpanAllowList&quot;</span><span class="s0">,</span><span class="s1">&quot;NextVanillaSpanAllowlist&quot;</span><span class="s0">,</span><span class="s1">&quot;isThenable&quot;</span><span class="s0">,</span><span class="s1">&quot;api&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;context&quot;</span><span class="s0">,</span><span class="s1">&quot;propagation&quot;</span><span class="s0">,</span><span class="s1">&quot;trace&quot;</span><span class="s0">,</span><span class="s1">&quot;SpanStatusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;SpanKind&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_CONTEXT&quot;</span><span class="s0">,</span><span class="s1">&quot;BubbledError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;bubble&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;isBubbledError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;closeSpanWithError&quot;</span><span class="s0">,</span><span class="s1">&quot;span&quot;</span><span class="s0">,</span><span class="s1">&quot;setAttribute&quot;</span><span class="s0">,</span><span class="s1">&quot;recordException&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;setStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;code&quot;</span><span class="s0">,</span><span class="s1">&quot;ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;rootSpanAttributesStore&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;rootSpanIdKey&quot;</span><span class="s0">,</span><span class="s1">&quot;createContextKey&quot;</span><span class="s0">,</span><span class="s1">&quot;lastSpanId&quot;</span><span class="s0">,</span><span class="s1">&quot;getSpanId&quot;</span><span class="s0">,</span><span class="s1">&quot;clientTraceDataSetter&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;carrier&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;NextTracerImpl&quot;</span><span class="s0">,</span><span class="s1">&quot;getTracerInstance&quot;</span><span class="s0">,</span><span class="s1">&quot;getTracer&quot;</span><span class="s0">,</span><span class="s1">&quot;getContext&quot;</span><span class="s0">,</span><span class="s1">&quot;getTracePropagationData&quot;</span><span class="s0">,</span><span class="s1">&quot;activeContext&quot;</span><span class="s0">,</span><span class="s1">&quot;active&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;inject&quot;</span><span class="s0">,</span><span class="s1">&quot;getActiveScopeSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;getSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;withPropagatedContext&quot;</span><span class="s0">,</span><span class="s1">&quot;fn&quot;</span><span class="s0">,</span><span class="s1">&quot;getter&quot;</span><span class="s0">,</span><span class="s1">&quot;getSpanContext&quot;</span><span class="s0">,</span><span class="s1">&quot;remoteContext&quot;</span><span class="s0">,</span><span class="s1">&quot;extract&quot;</span><span class="s0">,</span><span class="s1">&quot;with&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;fnOrOptions&quot;</span><span class="s0">,</span><span class="s1">&quot;fnOrEmpty&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;spanName&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_OTEL_VERBOSE&quot;</span><span class="s0">,</span><span class="s1">&quot;hideSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;spanContext&quot;</span><span class="s0">,</span><span class="s1">&quot;parentSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;isRootSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;isRemote&quot;</span><span class="s0">,</span><span class="s1">&quot;spanId&quot;</span><span class="s0">,</span><span class="s1">&quot;attributes&quot;</span><span class="s0">,</span><span class="s1">&quot;setValue&quot;</span><span class="s0">,</span><span class="s1">&quot;startActiveSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;startTime&quot;</span><span class="s0">,</span><span class="s1">&quot;globalThis&quot;</span><span class="s0">,</span><span class="s1">&quot;performance&quot;</span><span class="s0">,</span><span class="s1">&quot;now&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;onCleanup&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_OTEL_PERFORMANCE_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;measure&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;pop&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;match&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;catch&quot;</span><span class="s0">,</span><span class="s1">&quot;finally&quot;</span><span class="s0">,</span><span class="s1">&quot;wrap&quot;</span><span class="s0">,</span><span class="s1">&quot;tracer&quot;</span><span class="s0">,</span><span class="s1">&quot;optionsObj&quot;</span><span class="s0">,</span><span class="s1">&quot;apply&quot;</span><span class="s0">,</span><span class="s1">&quot;arguments&quot;</span><span class="s0">,</span><span class="s1">&quot;lastArgId&quot;</span><span class="s0">,</span><span class="s1">&quot;cb&quot;</span><span class="s0">,</span><span class="s1">&quot;scopeBoundCb&quot;</span><span class="s0">,</span><span class="s1">&quot;bind&quot;</span><span class="s0">,</span><span class="s1">&quot;_span&quot;</span><span class="s0">,</span><span class="s1">&quot;done&quot;</span><span class="s0">,</span><span class="s1">&quot;startSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;setSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;getRootSpanAttributes&quot;</span><span class="s0">,</span><span class="s1">&quot;getValue&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;setRootSpanAttribute&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1952</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/lib/constants.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { ServerRuntime } from '../types'</span><span class="s3">\n\n</span><span class="s1">export const TEXT_PLAIN_CONTENT_TYPE_HEADER = 'text/plain'</span><span class="s3">\n</span><span class="s1">export const HTML_CONTENT_TYPE_HEADER = 'text/html; charset=utf-8'</span><span class="s3">\n</span><span class="s1">export const JSON_CONTENT_TYPE_HEADER = 'application/json; charset=utf-8'</span><span class="s3">\n</span><span class="s1">export const NEXT_QUERY_PARAM_PREFIX = 'nxtP'</span><span class="s3">\n</span><span class="s1">export const NEXT_INTERCEPTION_MARKER_PREFIX = 'nxtI'</span><span class="s3">\n\n</span><span class="s1">export const MATCHED_PATH_HEADER = 'x-matched-path'</span><span class="s3">\n</span><span class="s1">export const PRERENDER_REVALIDATE_HEADER = 'x-prerender-revalidate'</span><span class="s3">\n</span><span class="s1">export const PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER =</span><span class="s3">\n  </span><span class="s1">'x-prerender-revalidate-if-generated'</span><span class="s3">\n\n</span><span class="s1">export const RSC_PREFETCH_SUFFIX = '.prefetch.rsc'</span><span class="s3">\n</span><span class="s1">export const RSC_SEGMENTS_DIR_SUFFIX = '.segments'</span><span class="s3">\n</span><span class="s1">export const RSC_SEGMENT_SUFFIX = '.segment.rsc'</span><span class="s3">\n</span><span class="s1">export const RSC_SUFFIX = '.rsc'</span><span class="s3">\n</span><span class="s1">export const ACTION_SUFFIX = '.action'</span><span class="s3">\n</span><span class="s1">export const NEXT_DATA_SUFFIX = '.json'</span><span class="s3">\n</span><span class="s1">export const NEXT_META_SUFFIX = '.meta'</span><span class="s3">\n</span><span class="s1">export const NEXT_BODY_SUFFIX = '.body'</span><span class="s3">\n\n</span><span class="s1">export const NEXT_CACHE_TAGS_HEADER = 'x-next-cache-tags'</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_REVALIDATED_TAGS_HEADER = 'x-next-revalidated-tags'</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER =</span><span class="s3">\n  </span><span class="s1">'x-next-revalidate-tag-token'</span><span class="s3">\n\n</span><span class="s1">export const NEXT_RESUME_HEADER = 'next-resume'</span><span class="s3">\n\n</span><span class="s1">// if these change make sure we update the related</span><span class="s3">\n</span><span class="s1">// documentation as well</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_TAG_MAX_ITEMS = 128</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_TAG_MAX_LENGTH = 256</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_SOFT_TAG_MAX_LENGTH = 1024</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_IMPLICIT_TAG_ID = '_N_T_'</span><span class="s3">\n\n</span><span class="s1">// in seconds</span><span class="s3">\n</span><span class="s1">export const CACHE_ONE_YEAR = 31536000</span><span class="s3">\n\n</span><span class="s1">// in seconds, represents revalidate=false. I.e. never revaliate.</span><span class="s3">\n</span><span class="s1">// We use this value since it can be represented as a V8 SMI for optimal performance.</span><span class="s3">\n</span><span class="s1">// It can also be serialized as JSON if it ever leaks accidentally as an actual value.</span><span class="s3">\n</span><span class="s1">export const INFINITE_CACHE = 0xfffffffe</span><span class="s3">\n\n</span><span class="s1">// Patterns to detect middleware files</span><span class="s3">\n</span><span class="s1">export const MIDDLEWARE_FILENAME = 'middleware'</span><span class="s3">\n</span><span class="s1">export const MIDDLEWARE_LOCATION_REGEXP = `(?:src/)?${MIDDLEWARE_FILENAME}`</span><span class="s3">\n\n</span><span class="s1">// Pattern to detect instrumentation hooks file</span><span class="s3">\n</span><span class="s1">export const INSTRUMENTATION_HOOK_FILENAME = 'instrumentation'</span><span class="s3">\n\n</span><span class="s1">// Because on Windows absolute paths in the generated code can break because of numbers, eg 1 in the path,</span><span class="s3">\n</span><span class="s1">// we have to use a private alias</span><span class="s3">\n</span><span class="s1">export const PAGES_DIR_ALIAS = 'private-next-pages'</span><span class="s3">\n</span><span class="s1">export const DOT_NEXT_ALIAS = 'private-dot-next'</span><span class="s3">\n</span><span class="s1">export const ROOT_DIR_ALIAS = 'private-next-root-dir'</span><span class="s3">\n</span><span class="s1">export const APP_DIR_ALIAS = 'private-next-app-dir'</span><span class="s3">\n</span><span class="s1">export const RSC_MOD_REF_PROXY_ALIAS = 'private-next-rsc-mod-ref-proxy'</span><span class="s3">\n</span><span class="s1">export const RSC_ACTION_VALIDATE_ALIAS = 'private-next-rsc-action-validate'</span><span class="s3">\n</span><span class="s1">export const RSC_ACTION_PROXY_ALIAS = 'private-next-rsc-server-reference'</span><span class="s3">\n</span><span class="s1">export const RSC_CACHE_WRAPPER_ALIAS = 'private-next-rsc-cache-wrapper'</span><span class="s3">\n</span><span class="s1">export const RSC_DYNAMIC_IMPORT_WRAPPER_ALIAS =</span><span class="s3">\n  </span><span class="s1">'private-next-rsc-track-dynamic-import'</span><span class="s3">\n</span><span class="s1">export const RSC_ACTION_ENCRYPTION_ALIAS = 'private-next-rsc-action-encryption'</span><span class="s3">\n</span><span class="s1">export const RSC_ACTION_CLIENT_WRAPPER_ALIAS =</span><span class="s3">\n  </span><span class="s1">'private-next-rsc-action-client-wrapper'</span><span class="s3">\n\n</span><span class="s1">export const PUBLIC_DIR_MIDDLEWARE_CONFLICT = `You can not have a '_next' folder inside of your public folder. This conflicts with the internal '/_next' route. https://nextjs.org/docs/messages/public-next-folder-conflict`</span><span class="s3">\n\n</span><span class="s1">export const SSG_GET_INITIAL_PROPS_CONFLICT = `You can not use getInitialProps with getStaticProps. To use SSG, please remove your getInitialProps`</span><span class="s3">\n\n</span><span class="s1">export const SERVER_PROPS_GET_INIT_PROPS_CONFLICT = `You can not use getInitialProps with getServerSideProps. Please remove getInitialProps.`</span><span class="s3">\n\n</span><span class="s1">export const SERVER_PROPS_SSG_CONFLICT = `You can not use getStaticProps or getStaticPaths with getServerSideProps. To use SSG, please remove getServerSideProps`</span><span class="s3">\n\n</span><span class="s1">export const STATIC_STATUS_PAGE_GET_INITIAL_PROPS_ERROR = `can not have getInitialProps/getServerSideProps, https://nextjs.org/docs/messages/404-get-initial-props`</span><span class="s3">\n\n</span><span class="s1">export const SERVER_PROPS_EXPORT_ERROR = `pages with </span><span class="s3">\\</span><span class="s1">`getServerSideProps</span><span class="s3">\\</span><span class="s1">` can not be exported. See more info here: https://nextjs.org/docs/messages/gssp-export`</span><span class="s3">\n\n</span><span class="s1">export const GSP_NO_RETURNED_VALUE =</span><span class="s3">\n  </span><span class="s1">'Your `getStaticProps` function did not return an object. Did you forget to add a `return`?'</span><span class="s3">\n</span><span class="s1">export const GSSP_NO_RETURNED_VALUE =</span><span class="s3">\n  </span><span class="s1">'Your `getServerSideProps` function did not return an object. Did you forget to add a `return`?'</span><span class="s3">\n\n</span><span class="s1">export const UNSTABLE_REVALIDATE_RENAME_ERROR =</span><span class="s3">\n  </span><span class="s1">'The `unstable_revalidate` property is available for general use.</span><span class="s3">\\</span><span class="s1">n' +</span><span class="s3">\n  </span><span class="s1">'Please use `revalidate` instead.'</span><span class="s3">\n\n</span><span class="s1">export const GSSP_COMPONENT_MEMBER_ERROR = `can not be attached to a page's component and must be exported from the page. See more info here: https://nextjs.org/docs/messages/gssp-component-member`</span><span class="s3">\n\n</span><span class="s1">export const NON_STANDARD_NODE_ENV = `You are using a non-standard </span><span class="s3">\&quot;</span><span class="s1">NODE_ENV</span><span class="s3">\&quot; </span><span class="s1">value in your environment. This creates inconsistencies in the project and is strongly advised against. Read more: https://nextjs.org/docs/messages/non-standard-node-env`</span><span class="s3">\n\n</span><span class="s1">export const SSG_FALLBACK_EXPORT_ERROR = `Pages with </span><span class="s3">\\</span><span class="s1">`fallback</span><span class="s3">\\</span><span class="s1">` enabled in </span><span class="s3">\\</span><span class="s1">`getStaticPaths</span><span class="s3">\\</span><span class="s1">` can not be exported. See more info here: https://nextjs.org/docs/messages/ssg-fallback-true-export`</span><span class="s3">\n\n</span><span class="s1">export const ESLINT_DEFAULT_DIRS = ['app', 'pages', 'components', 'lib', 'src']</span><span class="s3">\n\n</span><span class="s1">export const SERVER_RUNTIME: Record&lt;string, ServerRuntime&gt; = {</span><span class="s3">\n  </span><span class="s1">edge: 'edge',</span><span class="s3">\n  </span><span class="s1">experimentalEdge: 'experimental-edge',</span><span class="s3">\n  </span><span class="s1">nodejs: 'nodejs',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* The names of the webpack layers. These layers are the primitives for the</span><span class="s3">\n </span><span class="s1">* webpack chunks.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">const WEBPACK_LAYERS_NAMES = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The layer for the shared code between the client and server bundles.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">shared: 'shared',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The layer for server-only runtime and picking up `react-server` export conditions.</span><span class="s3">\n   </span><span class="s1">* Including app router RSC pages and app router custom routes and metadata routes.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">reactServerComponents: 'rsc',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Server Side Rendering layer for app (ssr).</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">serverSideRendering: 'ssr',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The browser client bundle layer for actions.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">actionBrowser: 'action-browser',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The Node.js bundle layer for the API routes.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">apiNode: 'api-node',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The Edge Lite bundle layer for the API routes.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">apiEdge: 'api-edge',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The layer for the middleware code.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">middleware: 'middleware',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The layer for the instrumentation hooks.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">instrument: 'instrument',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The layer for assets on the edge.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">edgeAsset: 'edge-asset',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The browser client bundle layer for App directory.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">appPagesBrowser: 'app-pages-browser',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The browser client bundle layer for Pages directory.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pagesDirBrowser: 'pages-dir-browser',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The Edge Lite bundle layer for Pages directory.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pagesDirEdge: 'pages-dir-edge',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The Node.js bundle layer for Pages directory.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pagesDirNode: 'pages-dir-node',</span><span class="s3">\n</span><span class="s1">} as const</span><span class="s3">\n\n</span><span class="s1">export type WebpackLayerName =</span><span class="s3">\n  </span><span class="s1">(typeof WEBPACK_LAYERS_NAMES)[keyof typeof WEBPACK_LAYERS_NAMES]</span><span class="s3">\n\n</span><span class="s1">const WEBPACK_LAYERS = {</span><span class="s3">\n  </span><span class="s1">...WEBPACK_LAYERS_NAMES,</span><span class="s3">\n  </span><span class="s1">GROUP: {</span><span class="s3">\n    </span><span class="s1">builtinReact: [</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.reactServerComponents,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.actionBrowser,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n    </span><span class="s1">serverOnly: [</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.reactServerComponents,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.actionBrowser,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.instrument,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.middleware,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n    </span><span class="s1">neutralTarget: [</span><span class="s3">\n      </span><span class="s1">// pages api</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.apiNode,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.apiEdge,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n    </span><span class="s1">clientOnly: [</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.serverSideRendering,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.appPagesBrowser,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n    </span><span class="s1">bundled: [</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.reactServerComponents,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.actionBrowser,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.serverSideRendering,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.appPagesBrowser,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.shared,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.instrument,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.middleware,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n    </span><span class="s1">appPages: [</span><span class="s3">\n      </span><span class="s1">// app router pages and layouts</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.reactServerComponents,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.serverSideRendering,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.appPagesBrowser,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.actionBrowser,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const WEBPACK_RESOURCE_QUERIES = {</span><span class="s3">\n  </span><span class="s1">edgeSSREntry: '__next_edge_ssr_entry__',</span><span class="s3">\n  </span><span class="s1">metadata: '__next_metadata__',</span><span class="s3">\n  </span><span class="s1">metadataRoute: '__next_metadata_route__',</span><span class="s3">\n  </span><span class="s1">metadataImageMeta: '__next_metadata_image_meta__',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export { WEBPACK_LAYERS, WEBPACK_RESOURCE_QUERIES }</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;TEXT_PLAIN_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;HTML_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_QUERY_PARAM_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_INTERCEPTION_MARKER_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;MATCHED_PATH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;PRERENDER_REVALIDATE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_PREFETCH_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_SEGMENTS_DIR_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_SEGMENT_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;ACTION_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_DATA_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_META_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_BODY_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_TAGS_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_REVALIDATED_TAGS_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RESUME_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_TAG_MAX_ITEMS&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_TAG_MAX_LENGTH&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_SOFT_TAG_MAX_LENGTH&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_IMPLICIT_TAG_ID&quot;</span><span class="s0">,</span><span class="s1">&quot;CACHE_ONE_YEAR&quot;</span><span class="s0">,</span><span class="s1">&quot;INFINITE_CACHE&quot;</span><span class="s0">,</span><span class="s1">&quot;MIDDLEWARE_FILENAME&quot;</span><span class="s0">,</span><span class="s1">&quot;MIDDLEWARE_LOCATION_REGEXP&quot;</span><span class="s0">,</span><span class="s1">&quot;INSTRUMENTATION_HOOK_FILENAME&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGES_DIR_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;DOT_NEXT_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_DIR_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;APP_DIR_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_MOD_REF_PROXY_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_ACTION_VALIDATE_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_ACTION_PROXY_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_CACHE_WRAPPER_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_DYNAMIC_IMPORT_WRAPPER_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_ACTION_ENCRYPTION_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_ACTION_CLIENT_WRAPPER_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;PUBLIC_DIR_MIDDLEWARE_CONFLICT&quot;</span><span class="s0">,</span><span class="s1">&quot;SSG_GET_INITIAL_PROPS_CONFLICT&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_PROPS_GET_INIT_PROPS_CONFLICT&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_PROPS_SSG_CONFLICT&quot;</span><span class="s0">,</span><span class="s1">&quot;STATIC_STATUS_PAGE_GET_INITIAL_PROPS_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_PROPS_EXPORT_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;GSP_NO_RETURNED_VALUE&quot;</span><span class="s0">,</span><span class="s1">&quot;GSSP_NO_RETURNED_VALUE&quot;</span><span class="s0">,</span><span class="s1">&quot;UNSTABLE_REVALIDATE_RENAME_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;GSSP_COMPONENT_MEMBER_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;NON_STANDARD_NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;SSG_FALLBACK_EXPORT_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;ESLINT_DEFAULT_DIRS&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;edge&quot;</span><span class="s0">,</span><span class="s1">&quot;experimentalEdge&quot;</span><span class="s0">,</span><span class="s1">&quot;nodejs&quot;</span><span class="s0">,</span><span class="s1">&quot;WEBPACK_LAYERS_NAMES&quot;</span><span class="s0">,</span><span class="s1">&quot;shared&quot;</span><span class="s0">,</span><span class="s1">&quot;reactServerComponents&quot;</span><span class="s0">,</span><span class="s1">&quot;serverSideRendering&quot;</span><span class="s0">,</span><span class="s1">&quot;actionBrowser&quot;</span><span class="s0">,</span><span class="s1">&quot;apiNode&quot;</span><span class="s0">,</span><span class="s1">&quot;apiEdge&quot;</span><span class="s0">,</span><span class="s1">&quot;middleware&quot;</span><span class="s0">,</span><span class="s1">&quot;instrument&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeAsset&quot;</span><span class="s0">,</span><span class="s1">&quot;appPagesBrowser&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesDirBrowser&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesDirEdge&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesDirNode&quot;</span><span class="s0">,</span><span class="s1">&quot;WEBPACK_LAYERS&quot;</span><span class="s0">,</span><span class="s1">&quot;GROUP&quot;</span><span class="s0">,</span><span class="s1">&quot;builtinReact&quot;</span><span class="s0">,</span><span class="s1">&quot;serverOnly&quot;</span><span class="s0">,</span><span class="s1">&quot;neutralTarget&quot;</span><span class="s0">,</span><span class="s1">&quot;clientOnly&quot;</span><span class="s0">,</span><span class="s1">&quot;bundled&quot;</span><span class="s0">,</span><span class="s1">&quot;appPages&quot;</span><span class="s0">,</span><span class="s1">&quot;WEBPACK_RESOURCE_QUERIES&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeSSREntry&quot;</span><span class="s0">,</span><span class="s1">&quot;metadata&quot;</span><span class="s0">,</span><span class="s1">&quot;metadataRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;metadataImageMeta&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2227</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/route-modules/app-page/module.compiled.js&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n  </span><span class="s1">module.exports = require('next/dist/server/route-modules/app-page/module.js')</span><span class="s3">\n</span><span class="s1">} else {</span><span class="s3">\n  </span><span class="s1">if (process.env.__NEXT_EXPERIMENTAL_REACT) {</span><span class="s3">\n    </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;module&quot;</span><span class="s0">,</span><span class="s1">&quot;exports&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_EXPERIMENTAL_REACT&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;TURBOPACK&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2246</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/route-modules/app-page/vendored/rsc/react.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;module.exports = (</span><span class="s3">\n  </span><span class="s1">require('../../module.compiled') as typeof import('../../module.compiled')</span><span class="s3">\n</span><span class="s1">).vendored['react-rsc']!.React</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;module&quot;</span><span class="s0">,</span><span class="s1">&quot;exports&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;vendored&quot;</span><span class="s0">,</span><span class="s1">&quot;React&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAAA,OAAOC,OAAO,GACZC,QAAQ,8HACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2251</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/hooks-server-context.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const DYNAMIC_ERROR_CODE = 'DYNAMIC_SERVER_USAGE'</span><span class="s3">\n\n</span><span class="s1">export class DynamicServerError extends Error {</span><span class="s3">\n  </span><span class="s1">digest: typeof DYNAMIC_ERROR_CODE = DYNAMIC_ERROR_CODE</span><span class="s3">\n\n  </span><span class="s1">constructor(public readonly description: string) {</span><span class="s3">\n    </span><span class="s1">super(`Dynamic server usage: ${description}`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isDynamicServerError(err: unknown): err is DynamicServerError {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">typeof err !== 'object' ||</span><span class="s3">\n    </span><span class="s1">err === null ||</span><span class="s3">\n    </span><span class="s1">!('digest' in err) ||</span><span class="s3">\n    </span><span class="s1">typeof err.digest !== 'string'</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return err.digest === DYNAMIC_ERROR_CODE</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;DYNAMIC_ERROR_CODE&quot;</span><span class="s0">,</span><span class="s1">&quot;DynamicServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;description&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAAA,MAAMA,qBAAqB;AAEpB,MAAMC,2BAA2BC;IAGtCC,YAA4BC,WAAmB,CAAE;QAC/C,KAAK,CAAE,2BAAwBA,cAAAA,IAAAA,CADLA,WAAAA,GAAAA,aAAAA,IAAAA,CAF5BC,MAAAA,GAAoCL;IAIpC;AACF;AAEO,SAASM,qBAAqBC,GAAY;IAC/C,IACE,OAAOA,QAAQ,YACfA,QAAQ,QACR,CAAE,CAAA,YAAYA,GAAE,KAChB,OAAOA,IAAIF,MAAM,KAAK,UACtB;QACA,OAAO;IACT;IAEA,OAAOE,IAAIF,MAAM,KAAKL;AACxB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2273</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/static-generation-bailout.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const NEXT_STATIC_GEN_BAILOUT = 'NEXT_STATIC_GEN_BAILOUT'</span><span class="s3">\n\n</span><span class="s1">export class StaticGenBailoutError extends Error {</span><span class="s3">\n  </span><span class="s1">public readonly code = NEXT_STATIC_GEN_BAILOUT</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isStaticGenBailoutError(</span><span class="s3">\n  </span><span class="s1">error: unknown</span><span class="s3">\n</span><span class="s1">): error is StaticGenBailoutError {</span><span class="s3">\n  </span><span class="s1">if (typeof error !== 'object' || error === null || !('code' in error)) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return error.code === NEXT_STATIC_GEN_BAILOUT</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;NEXT_STATIC_GEN_BAILOUT&quot;</span><span class="s0">,</span><span class="s1">&quot;StaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;code&quot;</span><span class="s0">,</span><span class="s1">&quot;isStaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAAA,MAAMA,0BAA0B;AAEzB,MAAMC,8BAA8BC;;QAApC,KAAA,IAAA,OAAA,IAAA,CACWC,IAAAA,GAAOH;;AACzB;AAEO,SAASI,wBACdC,KAAc;IAEd,IAAI,OAAOA,UAAU,YAAYA,UAAU,QAAQ,CAAE,CAAA,UAAUA,KAAI,GAAI;QACrE,OAAO;IACT;IAEA,OAAOA,MAAMF,IAAI,KAAKH;AACxB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2295</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/dynamic-rendering-utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export function isHangingPromiseRejectionError(</span><span class="s3">\n  </span><span class="s1">err: unknown</span><span class="s3">\n</span><span class="s1">): err is HangingPromiseRejectionError {</span><span class="s3">\n  </span><span class="s1">if (typeof err !== 'object' || err === null || !('digest' in err)) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return err.digest === HANGING_PROMISE_REJECTION</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const HANGING_PROMISE_REJECTION = 'HANGING_PROMISE_REJECTION'</span><span class="s3">\n\n</span><span class="s1">class HangingPromiseRejectionError extends Error {</span><span class="s3">\n  </span><span class="s1">public readonly digest = HANGING_PROMISE_REJECTION</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">public readonly route: string,</span><span class="s3">\n    </span><span class="s1">public readonly expression: string</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">super(</span><span class="s3">\n      </span><span class="s1">`During prerendering, ${expression} rejects when the prerender is complete. Typically these errors are handled by React but if you move ${expression} to a different context by using </span><span class="s3">\\</span><span class="s1">`setTimeout</span><span class="s3">\\</span><span class="s1">`, </span><span class="s3">\\</span><span class="s1">`after</span><span class="s3">\\</span><span class="s1">`, or similar functions you may observe this error and you should handle it in that context. This occurred at route </span><span class="s3">\&quot;</span><span class="s1">${route}</span><span class="s3">\&quot;</span><span class="s1">.`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type AbortListeners = Array&lt;(err: unknown) =&gt; void&gt;</span><span class="s3">\n</span><span class="s1">const abortListenersBySignal = new WeakMap&lt;AbortSignal, AbortListeners&gt;()</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function constructs a promise that will never resolve. This is primarily</span><span class="s3">\n </span><span class="s1">* useful for cacheComponents where we use promise resolution timing to determine which</span><span class="s3">\n </span><span class="s1">* parts of a render can be included in a prerender.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function makeHangingPromise&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">signal: AbortSignal,</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">): Promise&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">if (signal.aborted) {</span><span class="s3">\n    </span><span class="s1">return Promise.reject(new HangingPromiseRejectionError(route, expression))</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">const hangingPromise = new Promise&lt;T&gt;((_, reject) =&gt; {</span><span class="s3">\n      </span><span class="s1">const boundRejection = reject.bind(</span><span class="s3">\n        </span><span class="s1">null,</span><span class="s3">\n        </span><span class="s1">new HangingPromiseRejectionError(route, expression)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">let currentListeners = abortListenersBySignal.get(signal)</span><span class="s3">\n      </span><span class="s1">if (currentListeners) {</span><span class="s3">\n        </span><span class="s1">currentListeners.push(boundRejection)</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">const listeners = [boundRejection]</span><span class="s3">\n        </span><span class="s1">abortListenersBySignal.set(signal, listeners)</span><span class="s3">\n        </span><span class="s1">signal.addEventListener(</span><span class="s3">\n          </span><span class="s1">'abort',</span><span class="s3">\n          </span><span class="s1">() =&gt; {</span><span class="s3">\n            </span><span class="s1">for (let i = 0; i &lt; listeners.length; i++) {</span><span class="s3">\n              </span><span class="s1">listeners[i]()</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">{ once: true }</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">// We are fine if no one actually awaits this promise. We shouldn't consider this an unhandled rejection so</span><span class="s3">\n    </span><span class="s1">// we attach a noop catch handler here to suppress this warning. If you actually await somewhere or construct</span><span class="s3">\n    </span><span class="s1">// your own promise out of it you'll need to ensure you handle the error when it rejects.</span><span class="s3">\n    </span><span class="s1">hangingPromise.catch(ignoreReject)</span><span class="s3">\n    </span><span class="s1">return hangingPromise</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function ignoreReject() {}</span><span class="s3">\n\n</span><span class="s1">export function makeDevtoolsIOAwarePromise&lt;T&gt;(underlying: T): Promise&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">// in React DevTools if we resolve in a setTimeout we will observe</span><span class="s3">\n  </span><span class="s1">// the promise resolution as something that can suspend a boundary or root.</span><span class="s3">\n  </span><span class="s1">return new Promise&lt;T&gt;((resolve) =&gt; {</span><span class="s3">\n    </span><span class="s1">// Must use setTimeout to be considered IO React DevTools. setImmediate will not work.</span><span class="s3">\n    </span><span class="s1">setTimeout(() =&gt; {</span><span class="s3">\n      </span><span class="s1">resolve(underlying)</span><span class="s3">\n    </span><span class="s1">}, 0)</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isHangingPromiseRejectionError&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;HANGING_PROMISE_REJECTION&quot;</span><span class="s0">,</span><span class="s1">&quot;HangingPromiseRejectionError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;abortListenersBySignal&quot;</span><span class="s0">,</span><span class="s1">&quot;WeakMap&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;aborted&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;reject&quot;</span><span class="s0">,</span><span class="s1">&quot;hangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;_&quot;</span><span class="s0">,</span><span class="s1">&quot;boundRejection&quot;</span><span class="s0">,</span><span class="s1">&quot;bind&quot;</span><span class="s0">,</span><span class="s1">&quot;currentListeners&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;listeners&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;addEventListener&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;once&quot;</span><span class="s0">,</span><span class="s1">&quot;catch&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreReject&quot;</span><span class="s0">,</span><span class="s1">&quot;makeDevtoolsIOAwarePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;underlying&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;setTimeout&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;AAAO,SAASA,+BACdC,GAAY;IAEZ,IAAI,OAAOA,QAAQ,YAAYA,QAAQ,QAAQ,CAAE,CAAA,YAAYA,GAAE,GAAI;QACjE,OAAO;IACT;IAEA,OAAOA,IAAIC,MAAM,KAAKC;AACxB;AAEA,MAAMA,4BAA4B;AAElC,MAAMC,qCAAqCC;IAGzCC,YACkBC,KAAa,EACbC,UAAkB,CAClC;QACA,KAAK,CACH,CAAC,qBAAqB,EAAEA,WAAW,qGAAqG,EAAEA,WAAW,8KAA8K,EAAED,MAAM,EAAE,CAAC,GAAA,IAAA,CAJhUA,KAAAA,GAAAA,OAAAA,IAAAA,CACAC,UAAAA,GAAAA,YAAAA,IAAAA,CAJFN,MAAAA,GAASC;IASzB;AACF;AAGA,MAAMM,yBAAyB,IAAIC;AAS5B,SAASC,mBACdC,MAAmB,EACnBL,KAAa,EACbC,UAAkB;IAElB,IAAII,OAAOC,OAAO,EAAE;QAClB,OAAOC,QAAQC,MAAM,CAAC,IAAIX,6BAA6BG,OAAOC;IAChE,OAAO;QACL,MAAMQ,iBAAiB,IAAIF,QAAW,CAACG,GAAGF;YACxC,MAAMG,iBAAiBH,OAAOI,IAAI,CAChC,MACA,IAAIf,6BAA6BG,OAAOC;YAE1C,IAAIY,mBAAmBX,uBAAuBY,GAAG,CAACT;YAClD,IAAIQ,kBAAkB;gBACpBA,iBAAiBE,IAAI,CAACJ;YACxB,OAAO;gBACL,MAAMK,YAAY;oBAACL;iBAAe;gBAClCT,uBAAuBe,GAAG,CAACZ,QAAQW;gBACnCX,OAAOa,gBAAgB,CACrB,SACA;oBACE,IAAK,IAAIC,IAAI,GAAGA,IAAIH,UAAUI,MAAM,EAAED,IAAK;wBACzCH,SAAS,CAACG,EAAE;oBACd;gBACF,GACA;oBAAEE,MAAM;gBAAK;YAEjB;QACF;QACA,2GAA2G;QAC3G,6GAA6G;QAC7G,yFAAyF;QACzFZ,eAAea,KAAK,CAACC;QACrB,OAAOd;IACT;AACF;AAEA,SAASc,gBAAgB;AAElB,SAASC,2BAA8BC,UAAa;IACzD,kEAAkE;IAClE,2EAA2E;IAC3E,OAAO,IAAIlB,QAAW,CAACmB;QACrB,sFAAsF;QACtFC,WAAW;YACTD,QAAQD;QACV,GAAG;IACL;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2361</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/lib/framework/boundary-constants.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export const METADATA_BOUNDARY_NAME = '__next_metadata_boundary__'</span><span class="s3">\n</span><span class="s1">export const VIEWPORT_BOUNDARY_NAME = '__next_viewport_boundary__'</span><span class="s3">\n</span><span class="s1">export const OUTLET_BOUNDARY_NAME = '__next_outlet_boundary__'</span><span class="s3">\n</span><span class="s1">export const ROOT_LAYOUT_BOUNDARY_NAME = '__next_root_layout_boundary__'</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;METADATA_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;VIEWPORT_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;OUTLET_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_LAYOUT_BOUNDARY_NAME&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;AAAO,MAAMA,yBAAyB,6BAA4B;AAC3D,MAAMC,yBAAyB,6BAA4B;AAC3D,MAAMC,uBAAuB,2BAA0B;AACvD,MAAMC,4BAA4B,gCAA+B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2379</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/lib/scheduler.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export type ScheduledFn&lt;T = void&gt; = () =&gt; T | PromiseLike&lt;T&gt;</span><span class="s3">\n</span><span class="s1">export type SchedulerFn&lt;T = void&gt; = (cb: ScheduledFn&lt;T&gt;) =&gt; void</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Schedules a function to be called on the next tick after the other promises</span><span class="s3">\n </span><span class="s1">* have been resolved.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param cb the function to schedule</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const scheduleOnNextTick = (cb: ScheduledFn&lt;void&gt;) =&gt; {</span><span class="s3">\n  </span><span class="s1">// We use Promise.resolve().then() here so that the operation is scheduled at</span><span class="s3">\n  </span><span class="s1">// the end of the promise job queue, we then add it to the next process tick</span><span class="s3">\n  </span><span class="s1">// to ensure it's evaluated afterwards.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// This was inspired by the implementation of the DataLoader interface: https://github.com/graphql/dataloader/blob/d336bd15282664e0be4b4a657cb796f09bafbc6b/src/index.js#L213-L255</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">Promise.resolve().then(() =&gt; {</span><span class="s3">\n    </span><span class="s1">if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n      </span><span class="s1">setTimeout(cb, 0)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">process.nextTick(cb)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Schedules a function to be called using `setImmediate` or `setTimeout` if</span><span class="s3">\n </span><span class="s1">* `setImmediate` is not available (like in the Edge runtime).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param cb the function to schedule</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const scheduleImmediate = (cb: ScheduledFn&lt;void&gt;): void =&gt; {</span><span class="s3">\n  </span><span class="s1">if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n    </span><span class="s1">setTimeout(cb, 0)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">setImmediate(cb)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* returns a promise than resolves in a future task. There is no guarantee that the task it resolves in</span><span class="s3">\n </span><span class="s1">* will be the next task but if you await it you can at least be sure that the current task is over and</span><span class="s3">\n </span><span class="s1">* most usefully that the entire microtask queue of the current task has been emptied.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function atLeastOneTask() {</span><span class="s3">\n  </span><span class="s1">return new Promise&lt;void&gt;((resolve) =&gt; scheduleImmediate(resolve))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This utility function is extracted to make it easier to find places where we are doing</span><span class="s3">\n </span><span class="s1">* specific timing tricks to try to schedule work after React has rendered. This is especially</span><span class="s3">\n </span><span class="s1">* important at the moment because Next.js uses the edge builds of React which use setTimeout to</span><span class="s3">\n </span><span class="s1">* schedule work when you might expect that something like setImmediate would do the trick.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Long term we should switch to the node versions of React rendering when possible and then</span><span class="s3">\n </span><span class="s1">* update this to use setImmediate rather than setTimeout</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function waitAtLeastOneReactRenderTask(): Promise&lt;void&gt; {</span><span class="s3">\n  </span><span class="s1">if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n    </span><span class="s1">return new Promise((r) =&gt; setTimeout(r, 0))</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">return new Promise((r) =&gt; setImmediate(r))</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;scheduleOnNextTick&quot;</span><span class="s0">,</span><span class="s1">&quot;cb&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;setTimeout&quot;</span><span class="s0">,</span><span class="s1">&quot;nextTick&quot;</span><span class="s0">,</span><span class="s1">&quot;scheduleImmediate&quot;</span><span class="s0">,</span><span class="s1">&quot;setImmediate&quot;</span><span class="s0">,</span><span class="s1">&quot;atLeastOneTask&quot;</span><span class="s0">,</span><span class="s1">&quot;waitAtLeastOneReactRenderTask&quot;</span><span class="s0">,</span><span class="s1">&quot;r&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAGA;;;;;CAKC,GACD;;;;;;;;;;AAAO,MAAMA,qBAAqB,CAACC;IACjC,6EAA6E;IAC7E,4EAA4E;IAC5E,uCAAuC;IACvC,EAAE;IACF,kLAAkL;IAClL,EAAE;IACFC,QAAQC,OAAO,GAAGC,IAAI,CAAC;QACrB,IAAIC,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;aAElC;YACLF,QAAQI,QAAQ,CAACR;QACnB;IACF;AACF,EAAC;AAQM,MAAMS,oBAAoB,CAACT;IAChC,IAAII,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;SAElC;QACLI,aAAaV;IACf;AACF,EAAC;AAOM,SAASW;IACd,OAAO,IAAIV,QAAc,CAACC,UAAYO,kBAAkBP;AAC1D;AAWO,SAASU;IACd,IAAIR,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;SAElC;QACL,OAAO,IAAIL,QAAQ,CAACY,IAAMH,aAAaG;IACzC;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2430</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/lazy-dynamic/bailout-to-csr.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// This has to be a shared module which is shared between client component error boundary and dynamic component</span><span class="s3">\n</span><span class="s1">const BAILOUT_TO_CSR = 'BAILOUT_TO_CLIENT_SIDE_RENDERING'</span><span class="s3">\n\n</span><span class="s1">/** An error that should be thrown when we want to bail out to client-side rendering. */</span><span class="s3">\n</span><span class="s1">export class BailoutToCSRError extends Error {</span><span class="s3">\n  </span><span class="s1">public readonly digest = BAILOUT_TO_CSR</span><span class="s3">\n\n  </span><span class="s1">constructor(public readonly reason: string) {</span><span class="s3">\n    </span><span class="s1">super(`Bail out to client-side rendering: ${reason}`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/** Checks if a passed argument is an error that is thrown if we want to bail out to client-side rendering. */</span><span class="s3">\n</span><span class="s1">export function isBailoutToCSRError(err: unknown): err is BailoutToCSRError {</span><span class="s3">\n  </span><span class="s1">if (typeof err !== 'object' || err === null || !('digest' in err)) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return err.digest === BAILOUT_TO_CSR</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;BAILOUT_TO_CSR&quot;</span><span class="s0">,</span><span class="s1">&quot;BailoutToCSRError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;reason&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;isBailoutToCSRError&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,+GAA+G;;;;;;;AAC/G,MAAMA,iBAAiB;AAGhB,MAAMC,0BAA0BC;IAGrCC,YAA4BC,MAAc,CAAE;QAC1C,KAAK,CAAE,wCAAqCA,SAAAA,IAAAA,CADlBA,MAAAA,GAAAA,QAAAA,IAAAA,CAFZC,MAAAA,GAASL;IAIzB;AACF;AAGO,SAASM,oBAAoBC,GAAY;IAC9C,IAAI,OAAOA,QAAQ,YAAYA,QAAQ,QAAQ,CAAE,CAAA,YAAYA,GAAE,GAAI;QACjE,OAAO;IACT;IAEA,OAAOA,IAAIF,MAAM,KAAKL;AACxB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2453</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/invariant-error.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export class InvariantError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor(message: string, options?: ErrorOptions) {</span><span class="s3">\n    </span><span class="s1">super(</span><span class="s3">\n      </span><span class="s1">`Invariant: ${message.endsWith('.') ? message : message + '.'} This is a bug in Next.js.`,</span><span class="s3">\n      </span><span class="s1">options</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">this.name = 'InvariantError'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,MAAMA,uBAAuBC;IAClCC,YAAYC,OAAe,EAAEC,OAAsB,CAAE;QACnD,KAAK,CACF,gBAAaD,CAAAA,QAAQE,QAAQ,CAAC,OAAOF,UAAUA,UAAU,GAAE,IAAE,8BAC9DC;QAEF,IAAI,CAACE,IAAI,GAAG;IACd;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2467</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/app-render/dynamic-rendering.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* The functions provided by this module are used to communicate certain properties</span><span class="s3">\n </span><span class="s1">* about the currently running code so that Next.js can make decisions on how to handle</span><span class="s3">\n </span><span class="s1">* the current execution in different rendering modes such as pre-rendering, resuming, and SSR.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Today Next.js treats all code as potentially static. Certain APIs may only make sense when dynamically rendering.</span><span class="s3">\n </span><span class="s1">* Traditionally this meant deopting the entire render to dynamic however with PPR we can now deopt parts</span><span class="s3">\n </span><span class="s1">* of a React tree as dynamic while still keeping other parts static. There are really two different kinds of</span><span class="s3">\n </span><span class="s1">* Dynamic indications.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* The first is simply an intention to be dynamic. unstable_noStore is an example of this where</span><span class="s3">\n </span><span class="s1">* the currently executing code simply declares that the current scope is dynamic but if you use it</span><span class="s3">\n </span><span class="s1">* inside unstable_cache it can still be cached. This type of indication can be removed if we ever</span><span class="s3">\n </span><span class="s1">* make the default dynamic to begin with because the only way you would ever be static is inside</span><span class="s3">\n </span><span class="s1">* a cache scope which this indication does not affect.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* The second is an indication that a dynamic data source was read. This is a stronger form of dynamic</span><span class="s3">\n </span><span class="s1">* because it means that it is inappropriate to cache this at all. using a dynamic data source inside</span><span class="s3">\n </span><span class="s1">* unstable_cache should error. If you want to use some dynamic data inside unstable_cache you should</span><span class="s3">\n </span><span class="s1">* read that data outside the cache and pass it in as an argument to the cached function.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">import type { WorkStore } from '../app-render/work-async-storage.external'</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">WorkUnitStore,</span><span class="s3">\n  </span><span class="s1">RequestStore,</span><span class="s3">\n  </span><span class="s1">PrerenderStoreLegacy,</span><span class="s3">\n  </span><span class="s1">PrerenderStoreModern,</span><span class="s3">\n  </span><span class="s1">PrerenderStoreModernRuntime,</span><span class="s3">\n</span><span class="s1">} from '../app-render/work-unit-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">// Once postpone is in stable we should switch to importing the postpone export directly</span><span class="s3">\n</span><span class="s1">import React from 'react'</span><span class="s3">\n\n</span><span class="s1">import { DynamicServerError } from '../../client/components/hooks-server-context'</span><span class="s3">\n</span><span class="s1">import { StaticGenBailoutError } from '../../client/components/static-generation-bailout'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">getRuntimeStagePromise,</span><span class="s3">\n  </span><span class="s1">workUnitAsyncStorage,</span><span class="s3">\n</span><span class="s1">} from './work-unit-async-storage.external'</span><span class="s3">\n</span><span class="s1">import { workAsyncStorage } from '../app-render/work-async-storage.external'</span><span class="s3">\n</span><span class="s1">import { makeHangingPromise } from '../dynamic-rendering-utils'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">METADATA_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">VIEWPORT_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">OUTLET_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">ROOT_LAYOUT_BOUNDARY_NAME,</span><span class="s3">\n</span><span class="s1">} from '../../lib/framework/boundary-constants'</span><span class="s3">\n</span><span class="s1">import { scheduleOnNextTick } from '../../lib/scheduler'</span><span class="s3">\n</span><span class="s1">import { BailoutToCSRError } from '../../shared/lib/lazy-dynamic/bailout-to-csr'</span><span class="s3">\n</span><span class="s1">import { InvariantError } from '../../shared/lib/invariant-error'</span><span class="s3">\n\n</span><span class="s1">const hasPostpone = typeof React.unstable_postpone === 'function'</span><span class="s3">\n\n</span><span class="s1">export type DynamicAccess = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If debugging, this will contain the stack trace of where the dynamic access</span><span class="s3">\n   </span><span class="s1">* occurred. This is used to provide more information to the user about why</span><span class="s3">\n   </span><span class="s1">* their page is being rendered dynamically.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">stack?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The expression that was accessed dynamically.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Stores dynamic reasons used during an RSC render.</span><span class="s3">\n</span><span class="s1">export type DynamicTrackingState = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* When true, stack information will also be tracked during dynamic access.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">readonly isDebugDynamicAccesses: boolean | undefined</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The dynamic accesses that occurred during the render.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">readonly dynamicAccesses: Array&lt;DynamicAccess&gt;</span><span class="s3">\n\n  </span><span class="s1">syncDynamicErrorWithStack: null | Error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Stores dynamic reasons used during an SSR render.</span><span class="s3">\n</span><span class="s1">export type DynamicValidationState = {</span><span class="s3">\n  </span><span class="s1">hasSuspenseAboveBody: boolean</span><span class="s3">\n  </span><span class="s1">hasDynamicMetadata: boolean</span><span class="s3">\n  </span><span class="s1">hasDynamicViewport: boolean</span><span class="s3">\n  </span><span class="s1">hasAllowedDynamic: boolean</span><span class="s3">\n  </span><span class="s1">dynamicErrors: Array&lt;Error&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createDynamicTrackingState(</span><span class="s3">\n  </span><span class="s1">isDebugDynamicAccesses: boolean | undefined</span><span class="s3">\n</span><span class="s1">): DynamicTrackingState {</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">isDebugDynamicAccesses,</span><span class="s3">\n    </span><span class="s1">dynamicAccesses: [],</span><span class="s3">\n    </span><span class="s1">syncDynamicErrorWithStack: null,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createDynamicValidationState(): DynamicValidationState {</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">hasSuspenseAboveBody: false,</span><span class="s3">\n    </span><span class="s1">hasDynamicMetadata: false,</span><span class="s3">\n    </span><span class="s1">hasDynamicViewport: false,</span><span class="s3">\n    </span><span class="s1">hasAllowedDynamic: false,</span><span class="s3">\n    </span><span class="s1">dynamicErrors: [],</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getFirstDynamicReason(</span><span class="s3">\n  </span><span class="s1">trackingState: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): undefined | string {</span><span class="s3">\n  </span><span class="s1">return trackingState.dynamicAccesses[0]?.expression</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function communicates that the current scope should be treated as dynamic.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* In most cases this function is a no-op but if called during</span><span class="s3">\n </span><span class="s1">* a PPR prerender it will postpone the current sub-tree and calling</span><span class="s3">\n </span><span class="s1">* it during a normal prerender will cause the entire prerender to abort</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function markCurrentScopeAsDynamic(</span><span class="s3">\n  </span><span class="s1">store: WorkStore,</span><span class="s3">\n  </span><span class="s1">workUnitStore: undefined | Exclude&lt;WorkUnitStore, PrerenderStoreModern&gt;,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">// Inside cache scopes, marking a scope as dynamic has no effect,</span><span class="s3">\n        </span><span class="s1">// because the outer cache scope creates a cache boundary. This is</span><span class="s3">\n        </span><span class="s1">// subtly different from reading a dynamic data source, which is</span><span class="s3">\n        </span><span class="s1">// forbidden inside a cache scope.</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n        </span><span class="s1">// A private cache scope is already dynamic by definition.</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If we're forcing dynamic rendering or we're forcing static rendering, we</span><span class="s3">\n  </span><span class="s1">// don't need to do anything here because the entire page is already dynamic</span><span class="s3">\n  </span><span class="s1">// or it's static and it should not throw or postpone here.</span><span class="s3">\n  </span><span class="s1">if (store.forceDynamic || store.forceStatic) return</span><span class="s3">\n\n  </span><span class="s1">if (store.dynamicShouldError) {</span><span class="s3">\n    </span><span class="s1">throw new StaticGenBailoutError(</span><span class="s3">\n      </span><span class="s1">`Route ${store.route} with </span><span class="s3">\\</span><span class="s1">`dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;\\</span><span class="s1">` couldn't be rendered statically because it used </span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n        </span><span class="s1">return postponeWithTracking(</span><span class="s3">\n          </span><span class="s1">store.route,</span><span class="s3">\n          </span><span class="s1">expression,</span><span class="s3">\n          </span><span class="s1">workUnitStore.dynamicTracking</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n        </span><span class="s1">workUnitStore.revalidate = 0</span><span class="s3">\n\n        </span><span class="s1">// We aren't prerendering, but we are generating a static page. We need</span><span class="s3">\n        </span><span class="s1">// to bail out of static generation.</span><span class="s3">\n        </span><span class="s1">const err = new DynamicServerError(</span><span class="s3">\n          </span><span class="s1">`Route ${store.route} couldn't be rendered statically because it used ${expression}. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">store.dynamicUsageDescription = expression</span><span class="s3">\n        </span><span class="s1">store.dynamicUsageStack = err.stack</span><span class="s3">\n\n        </span><span class="s1">throw err</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n          </span><span class="s1">workUnitStore.usedDynamic = true</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function is meant to be used when prerendering without cacheComponents or PPR.</span><span class="s3">\n </span><span class="s1">* When called during a build it will cause Next.js to consider the route as dynamic.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function throwToInterruptStaticGeneration(</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">store: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreLegacy</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">// We aren't prerendering but we are generating a static page. We need to bail out of static generation</span><span class="s3">\n  </span><span class="s1">const err = new DynamicServerError(</span><span class="s3">\n    </span><span class="s1">`Route ${store.route} couldn't be rendered statically because it used </span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">prerenderStore.revalidate = 0</span><span class="s3">\n\n  </span><span class="s1">store.dynamicUsageDescription = expression</span><span class="s3">\n  </span><span class="s1">store.dynamicUsageStack = err.stack</span><span class="s3">\n\n  </span><span class="s1">throw err</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function should be used to track whether something dynamic happened even when</span><span class="s3">\n </span><span class="s1">* we are in a dynamic render. This is useful for Dev where all renders are dynamic but</span><span class="s3">\n </span><span class="s1">* we still track whether dynamic APIs were accessed for helpful messaging</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function trackDynamicDataInDynamicRender(workUnitStore: WorkUnitStore) {</span><span class="s3">\n  </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'cache':</span><span class="s3">\n    </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n      </span><span class="s1">// Inside cache scopes, marking a scope as dynamic has no effect,</span><span class="s3">\n      </span><span class="s1">// because the outer cache scope creates a cache boundary. This is</span><span class="s3">\n      </span><span class="s1">// subtly different from reading a dynamic data source, which is</span><span class="s3">\n      </span><span class="s1">// forbidden inside a cache scope.</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">// A private cache scope is already dynamic by definition.</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">case 'prerender':</span><span class="s3">\n    </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n    </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">case 'request':</span><span class="s3">\n      </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n        </span><span class="s1">workUnitStore.usedDynamic = true</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function abortOnSynchronousDynamicDataAccess(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">const reason = `Route ${route} needs to bail out of prerendering at this point because it used ${expression}.`</span><span class="s3">\n\n  </span><span class="s1">const error = createPrerenderInterruptedError(reason)</span><span class="s3">\n\n  </span><span class="s1">prerenderStore.controller.abort(error)</span><span class="s3">\n\n  </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">dynamicTracking.dynamicAccesses.push({</span><span class="s3">\n      </span><span class="s1">// When we aren't debugging, we don't need to create another error for the</span><span class="s3">\n      </span><span class="s1">// stack trace.</span><span class="s3">\n      </span><span class="s1">stack: dynamicTracking.isDebugDynamicAccesses</span><span class="s3">\n        </span><span class="s1">? new Error().stack</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n      </span><span class="s1">expression,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function abortOnSynchronousPlatformIOAccess(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">errorWithStack: Error,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n  </span><span class="s1">abortOnSynchronousDynamicDataAccess(route, expression, prerenderStore)</span><span class="s3">\n  </span><span class="s1">// It is important that we set this tracking value after aborting. Aborts are executed</span><span class="s3">\n  </span><span class="s1">// synchronously except for the case where you abort during render itself. By setting this</span><span class="s3">\n  </span><span class="s1">// value late we can use it to determine if any of the aborted tasks are the task that</span><span class="s3">\n  </span><span class="s1">// called the sync IO expression in the first place.</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">if (dynamicTracking.syncDynamicErrorWithStack === null) {</span><span class="s3">\n      </span><span class="s1">dynamicTracking.syncDynamicErrorWithStack = errorWithStack</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function trackSynchronousPlatformIOAccessInDev(</span><span class="s3">\n  </span><span class="s1">requestStore: RequestStore</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">// We don't actually have a controller to abort but we do the semantic equivalent by</span><span class="s3">\n  </span><span class="s1">// advancing the request store out of prerender mode</span><span class="s3">\n  </span><span class="s1">requestStore.prerenderPhase = false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* use this function when prerendering with cacheComponents. If we are doing a</span><span class="s3">\n </span><span class="s1">* prospective prerender we don't actually abort because we want to discover</span><span class="s3">\n </span><span class="s1">* all caches for the shell. If this is the actual prerender we do abort.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This function accepts a prerenderStore but the caller should ensure we're</span><span class="s3">\n </span><span class="s1">* actually running in cacheComponents mode.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function abortAndThrowOnSynchronousRequestDataAccess(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">errorWithStack: Error,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">const prerenderSignal = prerenderStore.controller.signal</span><span class="s3">\n  </span><span class="s1">if (prerenderSignal.aborted === false) {</span><span class="s3">\n    </span><span class="s1">// TODO it would be better to move this aborted check into the callsite so we can avoid making</span><span class="s3">\n    </span><span class="s1">// the error object when it isn't relevant to the aborting of the prerender however</span><span class="s3">\n    </span><span class="s1">// since we need the throw semantics regardless of whether we abort it is easier to land</span><span class="s3">\n    </span><span class="s1">// this way. See how this was handled with `abortOnSynchronousPlatformIOAccess` for a closer</span><span class="s3">\n    </span><span class="s1">// to ideal implementation</span><span class="s3">\n    </span><span class="s1">abortOnSynchronousDynamicDataAccess(route, expression, prerenderStore)</span><span class="s3">\n    </span><span class="s1">// It is important that we set this tracking value after aborting. Aborts are executed</span><span class="s3">\n    </span><span class="s1">// synchronously except for the case where you abort during render itself. By setting this</span><span class="s3">\n    </span><span class="s1">// value late we can use it to determine if any of the aborted tasks are the task that</span><span class="s3">\n    </span><span class="s1">// called the sync IO expression in the first place.</span><span class="s3">\n    </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n    </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n      </span><span class="s1">if (dynamicTracking.syncDynamicErrorWithStack === null) {</span><span class="s3">\n        </span><span class="s1">dynamicTracking.syncDynamicErrorWithStack = errorWithStack</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">throw createPrerenderInterruptedError(</span><span class="s3">\n    </span><span class="s1">`Route ${route} needs to bail out of prerendering at this point because it used ${expression}.`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Use this function when dynamically prerendering with dynamicIO.</span><span class="s3">\n </span><span class="s1">* We don't want to error, because it's better to return something</span><span class="s3">\n </span><span class="s1">* (and we've already aborted the render at the point where the sync dynamic error occured),</span><span class="s3">\n </span><span class="s1">* but we should log an error server-side.</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function warnOnSyncDynamicError(dynamicTracking: DynamicTrackingState) {</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking.syncDynamicErrorWithStack) {</span><span class="s3">\n    </span><span class="s1">// the server did something sync dynamic, likely</span><span class="s3">\n    </span><span class="s1">// leading to an early termination of the prerender.</span><span class="s3">\n    </span><span class="s1">console.error(dynamicTracking.syncDynamicErrorWithStack)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// For now these implementations are the same so we just reexport</span><span class="s3">\n</span><span class="s1">export const trackSynchronousRequestDataAccessInDev =</span><span class="s3">\n  </span><span class="s1">trackSynchronousPlatformIOAccessInDev</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This component will call `React.postpone` that throws the postponed error.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">type PostponeProps = {</span><span class="s3">\n  </span><span class="s1">reason: string</span><span class="s3">\n  </span><span class="s1">route: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">export function Postpone({ reason, route }: PostponeProps): never {</span><span class="s3">\n  </span><span class="s1">const prerenderStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">const dynamicTracking =</span><span class="s3">\n    </span><span class="s1">prerenderStore &amp;&amp; prerenderStore.type === 'prerender-ppr'</span><span class="s3">\n      </span><span class="s1">? prerenderStore.dynamicTracking</span><span class="s3">\n      </span><span class="s1">: null</span><span class="s3">\n  </span><span class="s1">postponeWithTracking(route, reason, dynamicTracking)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function postponeWithTracking(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">dynamicTracking: null | DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">assertPostpone()</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">dynamicTracking.dynamicAccesses.push({</span><span class="s3">\n      </span><span class="s1">// When we aren't debugging, we don't need to create another error for the</span><span class="s3">\n      </span><span class="s1">// stack trace.</span><span class="s3">\n      </span><span class="s1">stack: dynamicTracking.isDebugDynamicAccesses</span><span class="s3">\n        </span><span class="s1">? new Error().stack</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n      </span><span class="s1">expression,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">React.unstable_postpone(createPostponeReason(route, expression))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createPostponeReason(route: string, expression: string) {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">`Route ${route} needs to bail out of prerendering at this point because it used ${expression}. ` +</span><span class="s3">\n    </span><span class="s1">`React throws this special object to indicate where. It should not be caught by ` +</span><span class="s3">\n    </span><span class="s1">`your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isDynamicPostpone(err: unknown) {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">typeof err === 'object' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">err !== null &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof (err as any).message === 'string'</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return isDynamicPostponeReason((err as any).message)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function isDynamicPostponeReason(reason: string) {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">reason.includes(</span><span class="s3">\n      </span><span class="s1">'needs to bail out of prerendering at this point because it used'</span><span class="s3">\n    </span><span class="s1">) &amp;&amp;</span><span class="s3">\n    </span><span class="s1">reason.includes(</span><span class="s3">\n      </span><span class="s1">'Learn more: https://nextjs.org/docs/messages/ppr-caught-error'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">if (isDynamicPostponeReason(createPostponeReason('%%%', '^^^')) === false) {</span><span class="s3">\n  </span><span class="s1">throw new Error(</span><span class="s3">\n    </span><span class="s1">'Invariant: isDynamicPostpone misidentified a postpone reason. This is a bug in Next.js'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const NEXT_PRERENDER_INTERRUPTED = 'NEXT_PRERENDER_INTERRUPTED'</span><span class="s3">\n\n</span><span class="s1">function createPrerenderInterruptedError(message: string): Error {</span><span class="s3">\n  </span><span class="s1">const error = new Error(message)</span><span class="s3">\n  </span><span class="s1">;(error as any).digest = NEXT_PRERENDER_INTERRUPTED</span><span class="s3">\n  </span><span class="s1">return error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type DigestError = Error &amp; {</span><span class="s3">\n  </span><span class="s1">digest: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isPrerenderInterruptedError(</span><span class="s3">\n  </span><span class="s1">error: unknown</span><span class="s3">\n</span><span class="s1">): error is DigestError {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">typeof error === 'object' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">error !== null &amp;&amp;</span><span class="s3">\n    </span><span class="s1">(error as any).digest === NEXT_PRERENDER_INTERRUPTED &amp;&amp;</span><span class="s3">\n    </span><span class="s1">'name' in error &amp;&amp;</span><span class="s3">\n    </span><span class="s1">'message' in error &amp;&amp;</span><span class="s3">\n    </span><span class="s1">error instanceof Error</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function accessedDynamicData(</span><span class="s3">\n  </span><span class="s1">dynamicAccesses: Array&lt;DynamicAccess&gt;</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">return dynamicAccesses.length &gt; 0</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function consumeDynamicAccess(</span><span class="s3">\n  </span><span class="s1">serverDynamic: DynamicTrackingState,</span><span class="s3">\n  </span><span class="s1">clientDynamic: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): DynamicTrackingState['dynamicAccesses'] {</span><span class="s3">\n  </span><span class="s1">// We mutate because we only call this once we are no longer writing</span><span class="s3">\n  </span><span class="s1">// to the dynamicTrackingState and it's more efficient than creating a new</span><span class="s3">\n  </span><span class="s1">// array.</span><span class="s3">\n  </span><span class="s1">serverDynamic.dynamicAccesses.push(...clientDynamic.dynamicAccesses)</span><span class="s3">\n  </span><span class="s1">return serverDynamic.dynamicAccesses</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function formatDynamicAPIAccesses(</span><span class="s3">\n  </span><span class="s1">dynamicAccesses: Array&lt;DynamicAccess&gt;</span><span class="s3">\n</span><span class="s1">): string[] {</span><span class="s3">\n  </span><span class="s1">return dynamicAccesses</span><span class="s3">\n    </span><span class="s1">.filter(</span><span class="s3">\n      </span><span class="s1">(access): access is Required&lt;DynamicAccess&gt; =&gt;</span><span class="s3">\n        </span><span class="s1">typeof access.stack === 'string' &amp;&amp; access.stack.length &gt; 0</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">.map(({ expression, stack }) =&gt; {</span><span class="s3">\n      </span><span class="s1">stack = stack</span><span class="s3">\n        </span><span class="s1">.split('</span><span class="s3">\\</span><span class="s1">n')</span><span class="s3">\n        </span><span class="s1">// Remove the </span><span class="s3">\&quot;</span><span class="s1">Error: </span><span class="s3">\&quot; </span><span class="s1">prefix from the first line of the stack trace as</span><span class="s3">\n        </span><span class="s1">// well as the first 4 lines of the stack trace which is the distance</span><span class="s3">\n        </span><span class="s1">// from the user code and the `new Error().stack` call.</span><span class="s3">\n        </span><span class="s1">.slice(4)</span><span class="s3">\n        </span><span class="s1">.filter((line) =&gt; {</span><span class="s3">\n          </span><span class="s1">// Exclude Next.js internals from the stack trace.</span><span class="s3">\n          </span><span class="s1">if (line.includes('node_modules/next/')) {</span><span class="s3">\n            </span><span class="s1">return false</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Exclude anonymous functions from the stack trace.</span><span class="s3">\n          </span><span class="s1">if (line.includes(' (&lt;anonymous&gt;)')) {</span><span class="s3">\n            </span><span class="s1">return false</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Exclude Node.js internals from the stack trace.</span><span class="s3">\n          </span><span class="s1">if (line.includes(' (node:')) {</span><span class="s3">\n            </span><span class="s1">return false</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">return true</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">.join('</span><span class="s3">\\</span><span class="s1">n')</span><span class="s3">\n      </span><span class="s1">return `Dynamic API Usage Debug - ${expression}:</span><span class="s3">\\</span><span class="s1">n${stack}`</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function assertPostpone() {</span><span class="s3">\n  </span><span class="s1">if (!hasPostpone) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This is a bit of a hack to allow us to abort a render using a Postpone instance instead of an Error which changes React's</span><span class="s3">\n </span><span class="s1">* abort semantics slightly.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function createRenderInBrowserAbortSignal(): AbortSignal {</span><span class="s3">\n  </span><span class="s1">const controller = new AbortController()</span><span class="s3">\n  </span><span class="s1">controller.abort(new BailoutToCSRError('Render in Browser'))</span><span class="s3">\n  </span><span class="s1">return controller.signal</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* In a prerender, we may end up with hanging Promises as inputs due them</span><span class="s3">\n </span><span class="s1">* stalling on connection() or because they're loading dynamic data. In that</span><span class="s3">\n </span><span class="s1">* case we need to abort the encoding of arguments since they'll never complete.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function createHangingInputAbortSignal(</span><span class="s3">\n  </span><span class="s1">workUnitStore: WorkUnitStore</span><span class="s3">\n</span><span class="s1">): AbortSignal | undefined {</span><span class="s3">\n  </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'prerender':</span><span class="s3">\n    </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n      </span><span class="s1">const controller = new AbortController()</span><span class="s3">\n\n      </span><span class="s1">if (workUnitStore.cacheSignal) {</span><span class="s3">\n        </span><span class="s1">// If we have a cacheSignal it means we're in a prospective render. If</span><span class="s3">\n        </span><span class="s1">// the input we're waiting on is coming from another cache, we do want</span><span class="s3">\n        </span><span class="s1">// to wait for it so that we can resolve this cache entry too.</span><span class="s3">\n        </span><span class="s1">workUnitStore.cacheSignal.inputReady().then(() =&gt; {</span><span class="s3">\n          </span><span class="s1">controller.abort()</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">// Otherwise we're in the final render and we should already have all</span><span class="s3">\n        </span><span class="s1">// our caches filled.</span><span class="s3">\n        </span><span class="s1">// If the prerender uses stages, we have wait until the runtime stage,</span><span class="s3">\n        </span><span class="s1">// at which point all runtime inputs will be resolved.</span><span class="s3">\n        </span><span class="s1">// (otherwise, a runtime prerender might consider `cookies()` hanging</span><span class="s3">\n        </span><span class="s1">//  even though they'd resolve in the next task.)</span><span class="s3">\n        </span><span class="s1">//</span><span class="s3">\n        </span><span class="s1">// We might still be waiting on some microtasks so we</span><span class="s3">\n        </span><span class="s1">// wait one tick before giving up. When we give up, we still want to</span><span class="s3">\n        </span><span class="s1">// render the content of this cache as deeply as we can so that we can</span><span class="s3">\n        </span><span class="s1">// suspend as deeply as possible in the tree or not at all if we don't</span><span class="s3">\n        </span><span class="s1">// end up waiting for the input.</span><span class="s3">\n        </span><span class="s1">const runtimeStagePromise = getRuntimeStagePromise(workUnitStore)</span><span class="s3">\n        </span><span class="s1">if (runtimeStagePromise) {</span><span class="s3">\n          </span><span class="s1">runtimeStagePromise.then(() =&gt;</span><span class="s3">\n            </span><span class="s1">scheduleOnNextTick(() =&gt; controller.abort())</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">scheduleOnNextTick(() =&gt; controller.abort())</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return controller.signal</span><span class="s3">\n    </span><span class="s1">case 'prerender-client':</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n    </span><span class="s1">case 'request':</span><span class="s3">\n    </span><span class="s1">case 'cache':</span><span class="s3">\n    </span><span class="s1">case 'private-cache':</span><span class="s3">\n    </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n      </span><span class="s1">return undefined</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function annotateDynamicAccess(</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">dynamicTracking.dynamicAccesses.push({</span><span class="s3">\n      </span><span class="s1">stack: dynamicTracking.isDebugDynamicAccesses</span><span class="s3">\n        </span><span class="s1">? new Error().stack</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n      </span><span class="s1">expression,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function useDynamicRouteParams(expression: string) {</span><span class="s3">\n  </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workStore &amp;&amp; workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender': {</span><span class="s3">\n        </span><span class="s1">const fallbackParams = workUnitStore.fallbackRouteParams</span><span class="s3">\n        </span><span class="s1">if (fallbackParams &amp;&amp; fallbackParams.size &gt; 0) {</span><span class="s3">\n          </span><span class="s1">// We are in a prerender with cacheComponents semantics. We are going to</span><span class="s3">\n          </span><span class="s1">// hang here and never resolve. This will cause the currently</span><span class="s3">\n          </span><span class="s1">// rendering component to effectively be a dynamic hole.</span><span class="s3">\n          </span><span class="s1">React.use(</span><span class="s3">\n            </span><span class="s1">makeHangingPromise(</span><span class="s3">\n              </span><span class="s1">workUnitStore.renderSignal,</span><span class="s3">\n              </span><span class="s1">workStore.route,</span><span class="s3">\n              </span><span class="s1">expression</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr': {</span><span class="s3">\n        </span><span class="s1">const fallbackParams = workUnitStore.fallbackRouteParams</span><span class="s3">\n        </span><span class="s1">if (fallbackParams &amp;&amp; fallbackParams.size &gt; 0) {</span><span class="s3">\n          </span><span class="s1">return postponeWithTracking(</span><span class="s3">\n            </span><span class="s1">workStore.route,</span><span class="s3">\n            </span><span class="s1">expression,</span><span class="s3">\n            </span><span class="s1">workUnitStore.dynamicTracking</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">` was called during a runtime prerender. Next.js should be preventing ${expression} from being included in server components statically, but did not in this case.`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">` was called inside a cache scope. Next.js should be preventing ${expression} from being included in server components statically, but did not in this case.`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const hasSuspenseRegex = /</span><span class="s3">\\</span><span class="s1">n</span><span class="s3">\\</span><span class="s1">s+at Suspense </span><span class="s3">\\</span><span class="s1">(&lt;anonymous&gt;</span><span class="s3">\\</span><span class="s1">)/</span><span class="s3">\n\n</span><span class="s1">// Common implicit body tags that React will treat as body when placed directly in html</span><span class="s3">\n</span><span class="s1">const bodyAndImplicitTags =</span><span class="s3">\n  </span><span class="s1">'body|div|main|section|article|aside|header|footer|nav|form|p|span|h1|h2|h3|h4|h5|h6'</span><span class="s3">\n\n</span><span class="s1">// Detects when RootLayoutBoundary (our framework marker component) appears</span><span class="s3">\n</span><span class="s1">// after Suspense in the component stack, indicating the root layout is wrapped</span><span class="s3">\n</span><span class="s1">// within a Suspense boundary. Ensures no body/html/implicit-body components are in between.</span><span class="s3">\n</span><span class="s1">//</span><span class="s3">\n</span><span class="s1">// Example matches:</span><span class="s3">\n</span><span class="s1">//   at Suspense (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//   at __next_root_layout_boundary__ (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//</span><span class="s3">\n</span><span class="s1">// Or with other components in between (but not body/html/implicit-body):</span><span class="s3">\n</span><span class="s1">//   at Suspense (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//   at SomeComponent (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//   at __next_root_layout_boundary__ (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">const hasSuspenseBeforeRootLayoutWithoutBodyOrImplicitBodyRegex = new RegExp(</span><span class="s3">\n  </span><span class="s1">`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at Suspense </span><span class="s3">\\\\</span><span class="s1">(&lt;anonymous&gt;</span><span class="s3">\\\\</span><span class="s1">)(?:(?!</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at (?:${bodyAndImplicitTags}) </span><span class="s3">\\\\</span><span class="s1">(&lt;anonymous&gt;</span><span class="s3">\\\\</span><span class="s1">))[</span><span class="s3">\\\\</span><span class="s1">s</span><span class="s3">\\\\</span><span class="s1">S])*?</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${ROOT_LAYOUT_BOUNDARY_NAME} </span><span class="s3">\\\\</span><span class="s1">([^</span><span class="s3">\\\\</span><span class="s1">n]*</span><span class="s3">\\\\</span><span class="s1">)`</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n\n</span><span class="s1">const hasMetadataRegex = new RegExp(</span><span class="s3">\n  </span><span class="s1">`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${METADATA_BOUNDARY_NAME}[</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s]`</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n</span><span class="s1">const hasViewportRegex = new RegExp(</span><span class="s3">\n  </span><span class="s1">`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${VIEWPORT_BOUNDARY_NAME}[</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s]`</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n</span><span class="s1">const hasOutletRegex = new RegExp(`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${OUTLET_BOUNDARY_NAME}[</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s]`)</span><span class="s3">\n\n</span><span class="s1">export function trackAllowedDynamicAccess(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">componentStack: string,</span><span class="s3">\n  </span><span class="s1">dynamicValidation: DynamicValidationState,</span><span class="s3">\n  </span><span class="s1">clientDynamic: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (hasOutletRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">// We don't need to track that this is dynamic. It is only so when something else is also dynamic.</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (hasMetadataRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasDynamicMetadata = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (hasViewportRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasDynamicViewport = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (</span><span class="s3">\n    </span><span class="s1">hasSuspenseBeforeRootLayoutWithoutBodyOrImplicitBodyRegex.test(</span><span class="s3">\n      </span><span class="s1">componentStack</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">// For Suspense within body, the prelude wouldn't be empty so it wouldn't violate the empty static shells rule.</span><span class="s3">\n    </span><span class="s1">// But if you have Suspense above body, the prelude is empty but we allow that because having Suspense</span><span class="s3">\n    </span><span class="s1">// is an explicit signal from the user that they acknowledge the empty shell and want dynamic rendering.</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasAllowedDynamic = true</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasSuspenseAboveBody = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (hasSuspenseRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">// this error had a Suspense boundary above it so we don't need to report it as a source</span><span class="s3">\n    </span><span class="s1">// of disallowed</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasAllowedDynamic = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (clientDynamic.syncDynamicErrorWithStack) {</span><span class="s3">\n    </span><span class="s1">// This task was the task that called the sync error.</span><span class="s3">\n    </span><span class="s1">dynamicValidation.dynamicErrors.push(</span><span class="s3">\n      </span><span class="s1">clientDynamic.syncDynamicErrorWithStack</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">const message = `Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot;</span><span class="s1">: A component accessed data, headers, params, searchParams, or a short-lived cache without a Suspense boundary nor a </span><span class="s3">\&quot;</span><span class="s1">use cache</span><span class="s3">\&quot; </span><span class="s1">above it. See more info: https://nextjs.org/docs/messages/next-prerender-missing-suspense`</span><span class="s3">\n    </span><span class="s1">const error = createErrorWithComponentOrOwnerStack(message, componentStack)</span><span class="s3">\n    </span><span class="s1">dynamicValidation.dynamicErrors.push(error)</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* In dev mode, we prefer using the owner stack, otherwise the provided</span><span class="s3">\n </span><span class="s1">* component stack is used.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function createErrorWithComponentOrOwnerStack(</span><span class="s3">\n  </span><span class="s1">message: string,</span><span class="s3">\n  </span><span class="s1">componentStack: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const ownerStack =</span><span class="s3">\n    </span><span class="s1">process.env.NODE_ENV !== 'production' &amp;&amp; React.captureOwnerStack</span><span class="s3">\n      </span><span class="s1">? React.captureOwnerStack()</span><span class="s3">\n      </span><span class="s1">: null</span><span class="s3">\n\n  </span><span class="s1">const error = new Error(message)</span><span class="s3">\n  </span><span class="s1">error.stack = error.name + ': ' + message + (ownerStack ?? componentStack)</span><span class="s3">\n  </span><span class="s1">return error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export enum PreludeState {</span><span class="s3">\n  </span><span class="s1">Full = 0,</span><span class="s3">\n  </span><span class="s1">Empty = 1,</span><span class="s3">\n  </span><span class="s1">Errored = 2,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function logDisallowedDynamicError(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">error: Error</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">console.error(error)</span><span class="s3">\n\n  </span><span class="s1">if (!workStore.dev) {</span><span class="s3">\n    </span><span class="s1">if (workStore.hasReadableErrorStacks) {</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running </span><span class="s3">\\</span><span class="s1">`next dev</span><span class="s3">\\</span><span class="s1">`, then open </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">in your browser to investigate the error.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">console.error(`To get a more detailed stack trace and pinpoint the issue, try one of the following:</span><span class="s3">\n  </span><span class="s1">- Start the app in development mode by running </span><span class="s3">\\</span><span class="s1">`next dev</span><span class="s3">\\</span><span class="s1">`, then open </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">in your browser to investigate the error.</span><span class="s3">\n  </span><span class="s1">- Rerun the production build with </span><span class="s3">\\</span><span class="s1">`next build --debug-prerender</span><span class="s3">\\</span><span class="s1">` to generate better stack traces.`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function throwIfDisallowedDynamic(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prelude: PreludeState,</span><span class="s3">\n  </span><span class="s1">dynamicValidation: DynamicValidationState,</span><span class="s3">\n  </span><span class="s1">serverDynamic: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">if (prelude !== PreludeState.Full) {</span><span class="s3">\n    </span><span class="s1">if (dynamicValidation.hasSuspenseAboveBody) {</span><span class="s3">\n      </span><span class="s1">// This route has opted into allowing fully dynamic rendering</span><span class="s3">\n      </span><span class="s1">// by including a Suspense boundary above the body. In this case</span><span class="s3">\n      </span><span class="s1">// a lack of a shell is not considered disallowed so we simply return</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (serverDynamic.syncDynamicErrorWithStack) {</span><span class="s3">\n      </span><span class="s1">// There is no shell and the server did something sync dynamic likely</span><span class="s3">\n      </span><span class="s1">// leading to an early termination of the prerender before the shell</span><span class="s3">\n      </span><span class="s1">// could be completed. We terminate the build/validating render.</span><span class="s3">\n      </span><span class="s1">logDisallowedDynamicError(</span><span class="s3">\n        </span><span class="s1">workStore,</span><span class="s3">\n        </span><span class="s1">serverDynamic.syncDynamicErrorWithStack</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// We didn't have any sync bailouts but there may be user code which</span><span class="s3">\n    </span><span class="s1">// blocked the root. We would have captured these during the prerender</span><span class="s3">\n    </span><span class="s1">// and can log them here and then terminate the build/validating render</span><span class="s3">\n    </span><span class="s1">const dynamicErrors = dynamicValidation.dynamicErrors</span><span class="s3">\n    </span><span class="s1">if (dynamicErrors.length &gt; 0) {</span><span class="s3">\n      </span><span class="s1">for (let i = 0; i &lt; dynamicErrors.length; i++) {</span><span class="s3">\n        </span><span class="s1">logDisallowedDynamicError(workStore, dynamicErrors[i])</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// If we got this far then the only other thing that could be blocking</span><span class="s3">\n    </span><span class="s1">// the root is dynamic Viewport. If this is dynamic then</span><span class="s3">\n    </span><span class="s1">// you need to opt into that by adding a Suspense boundary above the body</span><span class="s3">\n    </span><span class="s1">// to indicate your are ok with fully dynamic rendering.</span><span class="s3">\n    </span><span class="s1">if (dynamicValidation.hasDynamicViewport) {</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">has a </span><span class="s3">\\</span><span class="s1">`generateViewport</span><span class="s3">\\</span><span class="s1">` that depends on Request data (</span><span class="s3">\\</span><span class="s1">`cookies()</span><span class="s3">\\</span><span class="s1">`, etc...) or uncached external data (</span><span class="s3">\\</span><span class="s1">`fetch(...)</span><span class="s3">\\</span><span class="s1">`, etc...) without explicitly allowing fully dynamic rendering. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-viewport`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (prelude === PreludeState.Empty) {</span><span class="s3">\n      </span><span class="s1">// If we ever get this far then we messed up the tracking of invalid dynamic.</span><span class="s3">\n      </span><span class="s1">// We still adhere to the constraint that you must produce a shell but invite the</span><span class="s3">\n      </span><span class="s1">// user to report this as a bug in Next.js.</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">did not produce a static shell and Next.js was unable to determine a reason. This is a bug in Next.js.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">dynamicValidation.hasAllowedDynamic === false &amp;&amp;</span><span class="s3">\n      </span><span class="s1">dynamicValidation.hasDynamicMetadata</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">has a </span><span class="s3">\\</span><span class="s1">`generateMetadata</span><span class="s3">\\</span><span class="s1">` that depends on Request data (</span><span class="s3">\\</span><span class="s1">`cookies()</span><span class="s3">\\</span><span class="s1">`, etc...) or uncached external data (</span><span class="s3">\\</span><span class="s1">`fetch(...)</span><span class="s3">\\</span><span class="s1">`, etc...) when the rest of the route does not. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-metadata`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function delayUntilRuntimeStage&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModernRuntime,</span><span class="s3">\n  </span><span class="s1">result: Promise&lt;T&gt;</span><span class="s3">\n</span><span class="s1">): Promise&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">if (prerenderStore.runtimeStagePromise) {</span><span class="s3">\n    </span><span class="s1">return prerenderStore.runtimeStagePromise.then(() =&gt; result)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return result</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;React&quot;</span><span class="s0">,</span><span class="s1">&quot;DynamicServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;StaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;getRuntimeStagePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;METADATA_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;VIEWPORT_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;OUTLET_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_LAYOUT_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;scheduleOnNextTick&quot;</span><span class="s0">,</span><span class="s1">&quot;BailoutToCSRError&quot;</span><span class="s0">,</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;hasPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_postpone&quot;</span><span class="s0">,</span><span class="s1">&quot;createDynamicTrackingState&quot;</span><span class="s0">,</span><span class="s1">&quot;isDebugDynamicAccesses&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicAccesses&quot;</span><span class="s0">,</span><span class="s1">&quot;syncDynamicErrorWithStack&quot;</span><span class="s0">,</span><span class="s1">&quot;createDynamicValidationState&quot;</span><span class="s0">,</span><span class="s1">&quot;hasSuspenseAboveBody&quot;</span><span class="s0">,</span><span class="s1">&quot;hasDynamicMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;hasDynamicViewport&quot;</span><span class="s0">,</span><span class="s1">&quot;hasAllowedDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicErrors&quot;</span><span class="s0">,</span><span class="s1">&quot;getFirstDynamicReason&quot;</span><span class="s0">,</span><span class="s1">&quot;trackingState&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;markCurrentScopeAsDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;store&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitStore&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;forceDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;forceStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicShouldError&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;postponeWithTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicUsageDescription&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicUsageStack&quot;</span><span class="s0">,</span><span class="s1">&quot;stack&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;usedDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;throwToInterruptStaticGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderStore&quot;</span><span class="s0">,</span><span class="s1">&quot;trackDynamicDataInDynamicRender&quot;</span><span class="s0">,</span><span class="s1">&quot;abortOnSynchronousDynamicDataAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;reason&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;createPrerenderInterruptedError&quot;</span><span class="s0">,</span><span class="s1">&quot;controller&quot;</span><span class="s0">,</span><span class="s1">&quot;abort&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;abortOnSynchronousPlatformIOAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;errorWithStack&quot;</span><span class="s0">,</span><span class="s1">&quot;trackSynchronousPlatformIOAccessInDev&quot;</span><span class="s0">,</span><span class="s1">&quot;requestStore&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderPhase&quot;</span><span class="s0">,</span><span class="s1">&quot;abortAndThrowOnSynchronousRequestDataAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;aborted&quot;</span><span class="s0">,</span><span class="s1">&quot;warnOnSyncDynamicError&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;trackSynchronousRequestDataAccessInDev&quot;</span><span class="s0">,</span><span class="s1">&quot;Postpone&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;assertPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;createPostponeReason&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicPostponeReason&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_PRERENDER_INTERRUPTED&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;isPrerenderInterruptedError&quot;</span><span class="s0">,</span><span class="s1">&quot;accessedDynamicData&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;consumeDynamicAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;serverDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;clientDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;formatDynamicAPIAccesses&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;access&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;line&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;createRenderInBrowserAbortSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;AbortController&quot;</span><span class="s0">,</span><span class="s1">&quot;createHangingInputAbortSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;inputReady&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;runtimeStagePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;annotateDynamicAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;useDynamicRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackParams&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;size&quot;</span><span class="s0">,</span><span class="s1">&quot;use&quot;</span><span class="s0">,</span><span class="s1">&quot;renderSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;hasSuspenseRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;bodyAndImplicitTags&quot;</span><span class="s0">,</span><span class="s1">&quot;hasSuspenseBeforeRootLayoutWithoutBodyOrImplicitBodyRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;hasMetadataRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;hasViewportRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;hasOutletRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;trackAllowedDynamicAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;componentStack&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicValidation&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;createErrorWithComponentOrOwnerStack&quot;</span><span class="s0">,</span><span class="s1">&quot;ownerStack&quot;</span><span class="s0">,</span><span class="s1">&quot;captureOwnerStack&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;PreludeState&quot;</span><span class="s0">,</span><span class="s1">&quot;logDisallowedDynamicError&quot;</span><span class="s0">,</span><span class="s1">&quot;dev&quot;</span><span class="s0">,</span><span class="s1">&quot;hasReadableErrorStacks&quot;</span><span class="s0">,</span><span class="s1">&quot;throwIfDisallowedDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;prelude&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;delayUntilRuntimeStage&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3085</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/clone-response.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const noop = () =&gt; {}</span><span class="s3">\n\n</span><span class="s1">let registry: FinalizationRegistry&lt;WeakRef&lt;ReadableStream&gt;&gt; | undefined</span><span class="s3">\n\n</span><span class="s1">if (globalThis.FinalizationRegistry) {</span><span class="s3">\n  </span><span class="s1">registry = new FinalizationRegistry((weakRef: WeakRef&lt;ReadableStream&gt;) =&gt; {</span><span class="s3">\n    </span><span class="s1">const stream = weakRef.deref()</span><span class="s3">\n    </span><span class="s1">if (stream &amp;&amp; !stream.locked) {</span><span class="s3">\n      </span><span class="s1">stream.cancel('Response object has been garbage collected').then(noop)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Clones a response by teeing the body so we can return two independent</span><span class="s3">\n </span><span class="s1">* ReadableStreams from it. This avoids the bug in the undici library around</span><span class="s3">\n </span><span class="s1">* response cloning.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* After cloning, the original response's body will be consumed and closed.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @see https://github.com/vercel/next.js/pull/73274</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param original - The original response to clone.</span><span class="s3">\n </span><span class="s1">* @returns A tuple containing two independent clones of the original response.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function cloneResponse(original: Response): [Response, Response] {</span><span class="s3">\n  </span><span class="s1">// If the response has no body, then we can just return the original response</span><span class="s3">\n  </span><span class="s1">// twice because it's immutable.</span><span class="s3">\n  </span><span class="s1">if (!original.body) {</span><span class="s3">\n    </span><span class="s1">return [original, original]</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const [body1, body2] = original.body.tee()</span><span class="s3">\n\n  </span><span class="s1">const cloned1 = new Response(body1, {</span><span class="s3">\n    </span><span class="s1">status: original.status,</span><span class="s3">\n    </span><span class="s1">statusText: original.statusText,</span><span class="s3">\n    </span><span class="s1">headers: original.headers,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">Object.defineProperty(cloned1, 'url', {</span><span class="s3">\n    </span><span class="s1">value: original.url,</span><span class="s3">\n    </span><span class="s1">// How the original response.url behaves</span><span class="s3">\n    </span><span class="s1">configurable: true,</span><span class="s3">\n    </span><span class="s1">enumerable: true,</span><span class="s3">\n    </span><span class="s1">writable: false,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">// The Fetch Standard allows users to skip consuming the response body by</span><span class="s3">\n  </span><span class="s1">// relying on garbage collection to release connection resources.</span><span class="s3">\n  </span><span class="s1">// https://github.com/nodejs/undici?tab=readme-ov-file#garbage-collection</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// To cancel the stream you then need to cancel both resulting branches.</span><span class="s3">\n  </span><span class="s1">// Teeing a stream will generally lock it for the duration, preventing other</span><span class="s3">\n  </span><span class="s1">// readers from locking it.</span><span class="s3">\n  </span><span class="s1">// https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/tee</span><span class="s3">\n\n  </span><span class="s1">// cloned2 is stored in a react cache and cloned for subsequent requests.</span><span class="s3">\n  </span><span class="s1">// It is the original request, and is is garbage collected by a</span><span class="s3">\n  </span><span class="s1">// FinalizationRegistry in Undici, but since we're tee-ing the stream</span><span class="s3">\n  </span><span class="s1">// ourselves, we need to cancel clone1's stream (the response returned from</span><span class="s3">\n  </span><span class="s1">// our dedupe fetch) when clone1 is reclaimed, otherwise we leak memory.</span><span class="s3">\n  </span><span class="s1">if (registry &amp;&amp; cloned1.body) {</span><span class="s3">\n    </span><span class="s1">registry.register(cloned1, new WeakRef(cloned1.body))</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const cloned2 = new Response(body2, {</span><span class="s3">\n    </span><span class="s1">status: original.status,</span><span class="s3">\n    </span><span class="s1">statusText: original.statusText,</span><span class="s3">\n    </span><span class="s1">headers: original.headers,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">Object.defineProperty(cloned2, 'url', {</span><span class="s3">\n    </span><span class="s1">value: original.url,</span><span class="s3">\n    </span><span class="s1">// How the original response.url behaves</span><span class="s3">\n    </span><span class="s1">configurable: true,</span><span class="s3">\n    </span><span class="s1">enumerable: true,</span><span class="s3">\n    </span><span class="s1">writable: false,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">return [cloned1, cloned2]</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;noop&quot;</span><span class="s0">,</span><span class="s1">&quot;registry&quot;</span><span class="s0">,</span><span class="s1">&quot;globalThis&quot;</span><span class="s0">,</span><span class="s1">&quot;FinalizationRegistry&quot;</span><span class="s0">,</span><span class="s1">&quot;weakRef&quot;</span><span class="s0">,</span><span class="s1">&quot;stream&quot;</span><span class="s0">,</span><span class="s1">&quot;deref&quot;</span><span class="s0">,</span><span class="s1">&quot;locked&quot;</span><span class="s0">,</span><span class="s1">&quot;cancel&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;cloneResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;original&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;body1&quot;</span><span class="s0">,</span><span class="s1">&quot;body2&quot;</span><span class="s0">,</span><span class="s1">&quot;tee&quot;</span><span class="s0">,</span><span class="s1">&quot;cloned1&quot;</span><span class="s0">,</span><span class="s1">&quot;Response&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;statusText&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;defineProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;configurable&quot;</span><span class="s0">,</span><span class="s1">&quot;enumerable&quot;</span><span class="s0">,</span><span class="s1">&quot;writable&quot;</span><span class="s0">,</span><span class="s1">&quot;register&quot;</span><span class="s0">,</span><span class="s1">&quot;WeakRef&quot;</span><span class="s0">,</span><span class="s1">&quot;cloned2&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,MAAMA,OAAO,KAAO;AAEpB,IAAIC;AAEJ,IAAIC,WAAWC,oBAAoB,EAAE;IACnCF,WAAW,IAAIE,qBAAqB,CAACC;QACnC,MAAMC,SAASD,QAAQE,KAAK;QAC5B,IAAID,UAAU,CAACA,OAAOE,MAAM,EAAE;YAC5BF,OAAOG,MAAM,CAAC,8CAA8CC,IAAI,CAACT;QACnE;IACF;AACF;AAcO,SAASU,cAAcC,QAAkB;IAC9C,6EAA6E;IAC7E,gCAAgC;IAChC,IAAI,CAACA,SAASC,IAAI,EAAE;QAClB,OAAO;YAACD;YAAUA;SAAS;IAC7B;IAEA,MAAM,CAACE,OAAOC,MAAM,GAAGH,SAASC,IAAI,CAACG,GAAG;IAExC,MAAMC,UAAU,IAAIC,SAASJ,OAAO;QAClCK,QAAQP,SAASO,MAAM;QACvBC,YAAYR,SAASQ,UAAU;QAC/BC,SAAST,SAASS,OAAO;IAC3B;IAEAC,OAAOC,cAAc,CAACN,SAAS,OAAO;QACpCO,OAAOZ,SAASa,GAAG;QACnB,wCAAwC;QACxCC,cAAc;QACdC,YAAY;QACZC,UAAU;IACZ;IAEA,yEAAyE;IACzE,iEAAiE;IACjE,yEAAyE;IACzE,EAAE;IACF,wEAAwE;IACxE,4EAA4E;IAC5E,2BAA2B;IAC3B,sEAAsE;IAEtE,yEAAyE;IACzE,+DAA+D;IAC/D,qEAAqE;IACrE,2EAA2E;IAC3E,wEAAwE;IACxE,IAAI1B,YAAYe,QAAQJ,IAAI,EAAE;QAC5BX,SAAS2B,QAAQ,CAACZ,SAAS,IAAIa,QAAQb,QAAQJ,IAAI;IACrD;IAEA,MAAMkB,UAAU,IAAIb,SAASH,OAAO;QAClCI,QAAQP,SAASO,MAAM;QACvBC,YAAYR,SAASQ,UAAU;QAC/BC,SAAST,SAASS,OAAO;IAC3B;IAEAC,OAAOC,cAAc,CAACQ,SAAS,OAAO;QACpCP,OAAOZ,SAASa,GAAG;QACnB,wCAAwC;QACxCC,cAAc;QACdC,YAAY;QACZC,UAAU;IACZ;IAEA,OAAO;QAACX;QAASc;KAAQ;AAC3B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3158</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/dedupe-fetch.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Based on https://github.com/facebook/react/blob/d4e78c42a94be027b4dc7ed2659a5fddfbf9bd4e/packages/react/src/ReactFetch.js</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">import * as React from 'react'</span><span class="s3">\n</span><span class="s1">import { cloneResponse } from './clone-response'</span><span class="s3">\n</span><span class="s1">import { InvariantError } from '../../shared/lib/invariant-error'</span><span class="s3">\n\n</span><span class="s1">const simpleCacheKey = '[</span><span class="s3">\&quot;</span><span class="s1">GET</span><span class="s3">\&quot;</span><span class="s1">,[],null,</span><span class="s3">\&quot;</span><span class="s1">follow</span><span class="s3">\&quot;</span><span class="s1">,null,null,null,null]' // generateCacheKey(new Request('https://blank'));</span><span class="s3">\n\n</span><span class="s1">function generateCacheKey(request: Request): string {</span><span class="s3">\n  </span><span class="s1">// We pick the fields that goes into the key used to dedupe requests.</span><span class="s3">\n  </span><span class="s1">// We don't include the `cache` field, because we end up using whatever</span><span class="s3">\n  </span><span class="s1">// caching resulted from the first request.</span><span class="s3">\n  </span><span class="s1">// Notably we currently don't consider non-standard (or future) options.</span><span class="s3">\n  </span><span class="s1">// This might not be safe. TODO: warn for non-standard extensions differing.</span><span class="s3">\n  </span><span class="s1">// IF YOU CHANGE THIS UPDATE THE simpleCacheKey ABOVE.</span><span class="s3">\n  </span><span class="s1">return JSON.stringify([</span><span class="s3">\n    </span><span class="s1">request.method,</span><span class="s3">\n    </span><span class="s1">Array.from(request.headers.entries()),</span><span class="s3">\n    </span><span class="s1">request.mode,</span><span class="s3">\n    </span><span class="s1">request.redirect,</span><span class="s3">\n    </span><span class="s1">request.credentials,</span><span class="s3">\n    </span><span class="s1">request.referrer,</span><span class="s3">\n    </span><span class="s1">request.referrerPolicy,</span><span class="s3">\n    </span><span class="s1">request.integrity,</span><span class="s3">\n  </span><span class="s1">])</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type CacheEntry = [</span><span class="s3">\n  </span><span class="s1">key: string,</span><span class="s3">\n  </span><span class="s1">promise: Promise&lt;Response&gt;,</span><span class="s3">\n  </span><span class="s1">response: Response | null,</span><span class="s3">\n</span><span class="s1">]</span><span class="s3">\n\n</span><span class="s1">export function createDedupeFetch(originalFetch: typeof fetch) {</span><span class="s3">\n  </span><span class="s1">const getCacheEntries = React.cache(</span><span class="s3">\n    </span><span class="s1">// eslint-disable-next-line @typescript-eslint/no-unused-vars -- url is the cache key</span><span class="s3">\n    </span><span class="s1">(url: string): CacheEntry[] =&gt; []</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">return function dedupeFetch(</span><span class="s3">\n    </span><span class="s1">resource: URL | RequestInfo,</span><span class="s3">\n    </span><span class="s1">options?: RequestInit</span><span class="s3">\n  </span><span class="s1">): Promise&lt;Response&gt; {</span><span class="s3">\n    </span><span class="s1">if (options &amp;&amp; options.signal) {</span><span class="s3">\n      </span><span class="s1">// If we're passed a signal, then we assume that</span><span class="s3">\n      </span><span class="s1">// someone else controls the lifetime of this object and opts out of</span><span class="s3">\n      </span><span class="s1">// caching. It's effectively the opt-out mechanism.</span><span class="s3">\n      </span><span class="s1">// Ideally we should be able to check this on the Request but</span><span class="s3">\n      </span><span class="s1">// it always gets initialized with its own signal so we don't</span><span class="s3">\n      </span><span class="s1">// know if it's supposed to override - unless we also override the</span><span class="s3">\n      </span><span class="s1">// Request constructor.</span><span class="s3">\n      </span><span class="s1">return originalFetch(resource, options)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">// Normalize the Request</span><span class="s3">\n    </span><span class="s1">let url: string</span><span class="s3">\n    </span><span class="s1">let cacheKey: string</span><span class="s3">\n    </span><span class="s1">if (typeof resource === 'string' &amp;&amp; !options) {</span><span class="s3">\n      </span><span class="s1">// Fast path.</span><span class="s3">\n      </span><span class="s1">cacheKey = simpleCacheKey</span><span class="s3">\n      </span><span class="s1">url = resource</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">// Normalize the request.</span><span class="s3">\n      </span><span class="s1">// if resource is not a string or a URL (its an instance of Request)</span><span class="s3">\n      </span><span class="s1">// then do not instantiate a new Request but instead</span><span class="s3">\n      </span><span class="s1">// reuse the request as to not disturb the body in the event it's a ReadableStream.</span><span class="s3">\n      </span><span class="s1">const request =</span><span class="s3">\n        </span><span class="s1">typeof resource === 'string' || resource instanceof URL</span><span class="s3">\n          </span><span class="s1">? new Request(resource, options)</span><span class="s3">\n          </span><span class="s1">: resource</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">(request.method !== 'GET' &amp;&amp; request.method !== 'HEAD') ||</span><span class="s3">\n        </span><span class="s1">request.keepalive</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">// We currently don't dedupe requests that might have side-effects. Those</span><span class="s3">\n        </span><span class="s1">// have to be explicitly cached. We assume that the request doesn't have a</span><span class="s3">\n        </span><span class="s1">// body if it's GET or HEAD.</span><span class="s3">\n        </span><span class="s1">// keepalive gets treated the same as if you passed a custom cache signal.</span><span class="s3">\n        </span><span class="s1">return originalFetch(resource, options)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">cacheKey = generateCacheKey(request)</span><span class="s3">\n      </span><span class="s1">url = request.url</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const cacheEntries = getCacheEntries(url)</span><span class="s3">\n    </span><span class="s1">for (let i = 0, j = cacheEntries.length; i &lt; j; i += 1) {</span><span class="s3">\n      </span><span class="s1">const [key, promise] = cacheEntries[i]</span><span class="s3">\n      </span><span class="s1">if (key === cacheKey) {</span><span class="s3">\n        </span><span class="s1">return promise.then(() =&gt; {</span><span class="s3">\n          </span><span class="s1">const response = cacheEntries[i][2]</span><span class="s3">\n          </span><span class="s1">if (!response) throw new InvariantError('No cached response')</span><span class="s3">\n\n          </span><span class="s1">// We're cloning the response using this utility because there exists</span><span class="s3">\n          </span><span class="s1">// a bug in the undici library around response cloning. See the</span><span class="s3">\n          </span><span class="s1">// following pull request for more details:</span><span class="s3">\n          </span><span class="s1">// https://github.com/vercel/next.js/pull/73274</span><span class="s3">\n          </span><span class="s1">const [cloned1, cloned2] = cloneResponse(response)</span><span class="s3">\n          </span><span class="s1">cacheEntries[i][2] = cloned2</span><span class="s3">\n          </span><span class="s1">return cloned1</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// We pass the original arguments here in case normalizing the Request</span><span class="s3">\n    </span><span class="s1">// doesn't include all the options in this environment.</span><span class="s3">\n    </span><span class="s1">const promise = originalFetch(resource, options)</span><span class="s3">\n    </span><span class="s1">const entry: CacheEntry = [cacheKey, promise, null]</span><span class="s3">\n    </span><span class="s1">cacheEntries.push(entry)</span><span class="s3">\n\n    </span><span class="s1">return promise.then((response) =&gt; {</span><span class="s3">\n      </span><span class="s1">// We're cloning the response using this utility because there exists</span><span class="s3">\n      </span><span class="s1">// a bug in the undici library around response cloning. See the</span><span class="s3">\n      </span><span class="s1">// following pull request for more details:</span><span class="s3">\n      </span><span class="s1">// https://github.com/vercel/next.js/pull/73274</span><span class="s3">\n      </span><span class="s1">const [cloned1, cloned2] = cloneResponse(response)</span><span class="s3">\n      </span><span class="s1">entry[2] = cloned2</span><span class="s3">\n      </span><span class="s1">return cloned1</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;React&quot;</span><span class="s0">,</span><span class="s1">&quot;cloneResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;simpleCacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;generateCacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;mode&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;credentials&quot;</span><span class="s0">,</span><span class="s1">&quot;referrer&quot;</span><span class="s0">,</span><span class="s1">&quot;referrerPolicy&quot;</span><span class="s0">,</span><span class="s1">&quot;integrity&quot;</span><span class="s0">,</span><span class="s1">&quot;createDedupeFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;originalFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;getCacheEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;cache&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;dedupeFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;resource&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;Request&quot;</span><span class="s0">,</span><span class="s1">&quot;keepalive&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;j&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;cloned1&quot;</span><span class="s0">,</span><span class="s1">&quot;cloned2&quot;</span><span class="s0">,</span><span class="s1">&quot;entry&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3271</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/lib/detached-promise.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* A `Promise.withResolvers` implementation that exposes the `resolve` and</span><span class="s3">\n </span><span class="s1">* `reject` functions on a `Promise`.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @see https://tc39.es/proposal-promise-with-resolvers/</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class DetachedPromise&lt;T = any&gt; {</span><span class="s3">\n  </span><span class="s1">public readonly resolve: (value: T | PromiseLike&lt;T&gt;) =&gt; void</span><span class="s3">\n  </span><span class="s1">public readonly reject: (reason: any) =&gt; void</span><span class="s3">\n  </span><span class="s1">public readonly promise: Promise&lt;T&gt;</span><span class="s3">\n\n  </span><span class="s1">constructor() {</span><span class="s3">\n    </span><span class="s1">let resolve: (value: T | PromiseLike&lt;T&gt;) =&gt; void</span><span class="s3">\n    </span><span class="s1">let reject: (reason: any) =&gt; void</span><span class="s3">\n\n    </span><span class="s1">// Create the promise and assign the resolvers to the object.</span><span class="s3">\n    </span><span class="s1">this.promise = new Promise&lt;T&gt;((res, rej) =&gt; {</span><span class="s3">\n      </span><span class="s1">resolve = res</span><span class="s3">\n      </span><span class="s1">reject = rej</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n\n    </span><span class="s1">// We know that resolvers is defined because the Promise constructor runs</span><span class="s3">\n    </span><span class="s1">// synchronously.</span><span class="s3">\n    </span><span class="s1">this.resolve = resolve!</span><span class="s3">\n    </span><span class="s1">this.reject = reject!</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;DetachedPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;reject&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;rej&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;;;CAKC,GACD;;;;AAAO,MAAMA;IAKXC,aAAc;QACZ,IAAIC;QACJ,IAAIC;QAEJ,6DAA6D;QAC7D,IAAI,CAACC,OAAO,GAAG,IAAIC,QAAW,CAACC,KAAKC;YAClCL,UAAUI;YACVH,SAASI;QACX;QAEA,yEAAyE;QACzE,iBAAiB;QACjB,IAAI,CAACL,OAAO,GAAGA;QACf,IAAI,CAACC,MAAM,GAAGA;IAChB;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3299</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/lib/batcher.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { SchedulerFn } from './scheduler'</span><span class="s3">\n\n</span><span class="s1">import { DetachedPromise } from './detached-promise'</span><span class="s3">\n\n</span><span class="s1">type CacheKeyFn&lt;K, C extends string | number | null&gt; = (</span><span class="s3">\n  </span><span class="s1">key: K</span><span class="s3">\n</span><span class="s1">) =&gt; PromiseLike&lt;C&gt; | C</span><span class="s3">\n\n</span><span class="s1">type BatcherOptions&lt;K, C extends string | number | null&gt; = {</span><span class="s3">\n  </span><span class="s1">cacheKeyFn?: CacheKeyFn&lt;K, C&gt;</span><span class="s3">\n  </span><span class="s1">schedulerFn?: SchedulerFn&lt;void&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type WorkFn&lt;V, C&gt; = (</span><span class="s3">\n  </span><span class="s1">key: C,</span><span class="s3">\n  </span><span class="s1">resolve: (value: V | PromiseLike&lt;V&gt;) =&gt; void</span><span class="s3">\n</span><span class="s1">) =&gt; Promise&lt;V&gt;</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* A wrapper for a function that will only allow one call to the function to</span><span class="s3">\n </span><span class="s1">* execute at a time.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class Batcher&lt;K, V, C extends string | number | null&gt; {</span><span class="s3">\n  </span><span class="s1">private readonly pending = new Map&lt;C, Promise&lt;V&gt;&gt;()</span><span class="s3">\n\n  </span><span class="s1">protected constructor(</span><span class="s3">\n    </span><span class="s1">private readonly cacheKeyFn?: CacheKeyFn&lt;K, C&gt;,</span><span class="s3">\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* A function that will be called to schedule the wrapped function to be</span><span class="s3">\n     </span><span class="s1">* executed. This defaults to a function that will execute the function</span><span class="s3">\n     </span><span class="s1">* immediately.</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">private readonly schedulerFn: SchedulerFn&lt;void&gt; = (fn) =&gt; fn()</span><span class="s3">\n  </span><span class="s1">) {}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Creates a new instance of PendingWrapper. If the key extends a string or</span><span class="s3">\n   </span><span class="s1">* number, the key will be used as the cache key. If the key is an object, a</span><span class="s3">\n   </span><span class="s1">* cache key function must be provided.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public static create&lt;K extends string | number | null, V&gt;(</span><span class="s3">\n    </span><span class="s1">options?: BatcherOptions&lt;K, K&gt;</span><span class="s3">\n  </span><span class="s1">): Batcher&lt;K, V, K&gt;</span><span class="s3">\n  </span><span class="s1">public static create&lt;K, V, C extends string | number | null&gt;(</span><span class="s3">\n    </span><span class="s1">options: BatcherOptions&lt;K, C&gt; &amp;</span><span class="s3">\n      </span><span class="s1">Required&lt;Pick&lt;BatcherOptions&lt;K, C&gt;, 'cacheKeyFn'&gt;&gt;</span><span class="s3">\n  </span><span class="s1">): Batcher&lt;K, V, C&gt;</span><span class="s3">\n  </span><span class="s1">public static create&lt;K, V, C extends string | number | null&gt;(</span><span class="s3">\n    </span><span class="s1">options?: BatcherOptions&lt;K, C&gt;</span><span class="s3">\n  </span><span class="s1">): Batcher&lt;K, V, C&gt; {</span><span class="s3">\n    </span><span class="s1">return new Batcher&lt;K, V, C&gt;(options?.cacheKeyFn, options?.schedulerFn)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Wraps a function in a promise that will be resolved or rejected only once</span><span class="s3">\n   </span><span class="s1">* for a given key. This will allow multiple calls to the function to be</span><span class="s3">\n   </span><span class="s1">* made, but only one will be executed at a time. The result of the first</span><span class="s3">\n   </span><span class="s1">* call will be returned to all callers.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param key the key to use for the cache</span><span class="s3">\n   </span><span class="s1">* @param fn the function to wrap</span><span class="s3">\n   </span><span class="s1">* @returns a promise that resolves to the result of the function</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public async batch(key: K, fn: WorkFn&lt;V, C&gt;): Promise&lt;V&gt; {</span><span class="s3">\n    </span><span class="s1">const cacheKey = (this.cacheKeyFn ? await this.cacheKeyFn(key) : key) as C</span><span class="s3">\n    </span><span class="s1">if (cacheKey === null) {</span><span class="s3">\n      </span><span class="s1">return fn(cacheKey, Promise.resolve)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const pending = this.pending.get(cacheKey)</span><span class="s3">\n    </span><span class="s1">if (pending) return pending</span><span class="s3">\n\n    </span><span class="s1">const { promise, resolve, reject } = new DetachedPromise&lt;V&gt;()</span><span class="s3">\n    </span><span class="s1">this.pending.set(cacheKey, promise)</span><span class="s3">\n\n    </span><span class="s1">this.schedulerFn(async () =&gt; {</span><span class="s3">\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">const result = await fn(cacheKey, resolve)</span><span class="s3">\n\n        </span><span class="s1">// Resolving a promise multiple times is a no-op, so we can safely</span><span class="s3">\n        </span><span class="s1">// resolve all pending promises with the same result.</span><span class="s3">\n        </span><span class="s1">resolve(result)</span><span class="s3">\n      </span><span class="s1">} catch (err) {</span><span class="s3">\n        </span><span class="s1">reject(err)</span><span class="s3">\n      </span><span class="s1">} finally {</span><span class="s3">\n        </span><span class="s1">this.pending.delete(cacheKey)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n\n    </span><span class="s1">return promise</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;DetachedPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;Batcher&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheKeyFn&quot;</span><span class="s0">,</span><span class="s1">&quot;schedulerFn&quot;</span><span class="s0">,</span><span class="s1">&quot;fn&quot;</span><span class="s0">,</span><span class="s1">&quot;pending&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;create&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;batch&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;reject&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAEA,SAASA,eAAe,QAAQ,qBAAoB;;AAoB7C,MAAMC;IAGX,YACmBC,UAA6B,EAC9C;;;;KAIC,GACgBC,cAAiC,CAACC,KAAOA,IAAI,CAC9D;aAPiBF,UAAAA,GAAAA;aAMAC,WAAAA,GAAAA;aATFE,OAAAA,GAAU,IAAIC;IAU5B;IAcH,OAAcC,OACZC,OAA8B,EACZ;QAClB,OAAO,IAAIP,QAAiBO,WAAAA,OAAAA,KAAAA,IAAAA,QAASN,UAAU,EAAEM,WAAAA,OAAAA,KAAAA,IAAAA,QAASL,WAAW;IACvE;IAEA;;;;;;;;;GASC,GACD,MAAaM,MAAMC,GAAM,EAAEN,EAAgB,EAAc;QACvD,MAAMO,WAAY,IAAI,CAACT,UAAU,GAAG,MAAM,IAAI,CAACA,UAAU,CAACQ,OAAOA;QACjE,IAAIC,aAAa,MAAM;YACrB,OAAOP,GAAGO,UAAUC,QAAQC,OAAO;QACrC;QAEA,MAAMR,UAAU,IAAI,CAACA,OAAO,CAACS,GAAG,CAACH;QACjC,IAAIN,SAAS,OAAOA;QAEpB,MAAM,EAAEU,OAAO,EAAEF,OAAO,EAAEG,MAAM,EAAE,GAAG,IAAIhB,sLAAAA;QACzC,IAAI,CAACK,OAAO,CAACY,GAAG,CAACN,UAAUI;QAE3B,IAAI,CAACZ,WAAW,CAAC;YACf,IAAI;gBACF,MAAMe,SAAS,MAAMd,GAAGO,UAAUE;gBAElC,kEAAkE;gBAClE,qDAAqD;gBACrDA,QAAQK;YACV,EAAE,OAAOC,KAAK;gBACZH,OAAOG;YACT,SAAU;gBACR,IAAI,CAACd,OAAO,CAACe,MAAM,CAACT;YACtB;QACF;QAEA,OAAOI;IACT;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3355</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/response-cache/types.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { OutgoingHttpHeaders } from 'http'</span><span class="s3">\n</span><span class="s1">import type RenderResult from '../render-result'</span><span class="s3">\n</span><span class="s1">import type { CacheControl, Revalidate } from '../lib/cache-control'</span><span class="s3">\n</span><span class="s1">import type { RouteKind } from '../route-kind'</span><span class="s3">\n\n</span><span class="s1">export interface ResponseCacheBase {</span><span class="s3">\n  </span><span class="s1">get(</span><span class="s3">\n    </span><span class="s1">key: string | null,</span><span class="s3">\n    </span><span class="s1">responseGenerator: ResponseGenerator,</span><span class="s3">\n    </span><span class="s1">context: {</span><span class="s3">\n      </span><span class="s1">isOnDemandRevalidate?: boolean</span><span class="s3">\n      </span><span class="s1">isPrefetch?: boolean</span><span class="s3">\n      </span><span class="s1">incrementalCache: IncrementalCache</span><span class="s3">\n      </span><span class="s1">/**</span><span class="s3">\n       </span><span class="s1">* This is a hint to the cache to help it determine what kind of route</span><span class="s3">\n       </span><span class="s1">* this is so it knows where to look up the cache entry from. If not</span><span class="s3">\n       </span><span class="s1">* provided it will test the filesystem to check.</span><span class="s3">\n       </span><span class="s1">*/</span><span class="s3">\n      </span><span class="s1">routeKind: RouteKind</span><span class="s3">\n\n      </span><span class="s1">/**</span><span class="s3">\n       </span><span class="s1">* True if this is a fallback request.</span><span class="s3">\n       </span><span class="s1">*/</span><span class="s3">\n      </span><span class="s1">isFallback?: boolean</span><span class="s3">\n\n      </span><span class="s1">/**</span><span class="s3">\n       </span><span class="s1">* True if the route is enabled for PPR.</span><span class="s3">\n       </span><span class="s1">*/</span><span class="s3">\n      </span><span class="s1">isRoutePPREnabled?: boolean</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">): Promise&lt;ResponseCacheEntry | null&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// The server components HMR cache might store other data as well in the future,</span><span class="s3">\n</span><span class="s1">// at which point this should be refactored to a discriminated union type.</span><span class="s3">\n</span><span class="s1">export interface ServerComponentsHmrCache {</span><span class="s3">\n  </span><span class="s1">get(key: string): CachedFetchData | undefined</span><span class="s3">\n  </span><span class="s1">set(key: string, data: CachedFetchData): void</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type CachedFetchData = {</span><span class="s3">\n  </span><span class="s1">headers: Record&lt;string, string&gt;</span><span class="s3">\n  </span><span class="s1">body: string</span><span class="s3">\n  </span><span class="s1">url: string</span><span class="s3">\n  </span><span class="s1">status?: number</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const enum CachedRouteKind {</span><span class="s3">\n  </span><span class="s1">APP_PAGE = 'APP_PAGE',</span><span class="s3">\n  </span><span class="s1">APP_ROUTE = 'APP_ROUTE',</span><span class="s3">\n  </span><span class="s1">PAGES = 'PAGES',</span><span class="s3">\n  </span><span class="s1">FETCH = 'FETCH',</span><span class="s3">\n  </span><span class="s1">REDIRECT = 'REDIRECT',</span><span class="s3">\n  </span><span class="s1">IMAGE = 'IMAGE',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface CachedFetchValue {</span><span class="s3">\n  </span><span class="s1">kind: CachedRouteKind.FETCH</span><span class="s3">\n  </span><span class="s1">data: CachedFetchData</span><span class="s3">\n  </span><span class="s1">// tags are only present with file-system-cache</span><span class="s3">\n  </span><span class="s1">// fetch cache stores tags outside of cache entry</span><span class="s3">\n  </span><span class="s1">tags?: string[]</span><span class="s3">\n  </span><span class="s1">revalidate: number</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface CachedRedirectValue {</span><span class="s3">\n  </span><span class="s1">kind: CachedRouteKind.REDIRECT</span><span class="s3">\n  </span><span class="s1">props: Object</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface CachedAppPageValue {</span><span class="s3">\n  </span><span class="s1">kind: CachedRouteKind.APP_PAGE</span><span class="s3">\n  </span><span class="s1">// this needs to be a RenderResult so since renderResponse</span><span class="s3">\n  </span><span class="s1">// expects that type instead of a string</span><span class="s3">\n  </span><span class="s1">html: RenderResult</span><span class="s3">\n  </span><span class="s1">rscData: Buffer | undefined</span><span class="s3">\n  </span><span class="s1">status: number | undefined</span><span class="s3">\n  </span><span class="s1">postponed: string | undefined</span><span class="s3">\n  </span><span class="s1">headers: OutgoingHttpHeaders | undefined</span><span class="s3">\n  </span><span class="s1">segmentData: Map&lt;string, Buffer&gt; | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface CachedPageValue {</span><span class="s3">\n  </span><span class="s1">kind: CachedRouteKind.PAGES</span><span class="s3">\n  </span><span class="s1">// this needs to be a RenderResult so since renderResponse</span><span class="s3">\n  </span><span class="s1">// expects that type instead of a string</span><span class="s3">\n  </span><span class="s1">html: RenderResult</span><span class="s3">\n  </span><span class="s1">pageData: Object</span><span class="s3">\n  </span><span class="s1">status: number | undefined</span><span class="s3">\n  </span><span class="s1">headers: OutgoingHttpHeaders | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface CachedRouteValue {</span><span class="s3">\n  </span><span class="s1">kind: CachedRouteKind.APP_ROUTE</span><span class="s3">\n  </span><span class="s1">// this needs to be a RenderResult so since renderResponse</span><span class="s3">\n  </span><span class="s1">// expects that type instead of a string</span><span class="s3">\n  </span><span class="s1">body: Buffer</span><span class="s3">\n  </span><span class="s1">status: number</span><span class="s3">\n  </span><span class="s1">headers: OutgoingHttpHeaders</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface CachedImageValue {</span><span class="s3">\n  </span><span class="s1">kind: CachedRouteKind.IMAGE</span><span class="s3">\n  </span><span class="s1">etag: string</span><span class="s3">\n  </span><span class="s1">upstreamEtag: string</span><span class="s3">\n  </span><span class="s1">buffer: Buffer</span><span class="s3">\n  </span><span class="s1">extension: string</span><span class="s3">\n  </span><span class="s1">isMiss?: boolean</span><span class="s3">\n  </span><span class="s1">isStale?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface IncrementalCachedAppPageValue {</span><span class="s3">\n  </span><span class="s1">kind: CachedRouteKind.APP_PAGE</span><span class="s3">\n  </span><span class="s1">// this needs to be a string since the cache expects to store</span><span class="s3">\n  </span><span class="s1">// the string value</span><span class="s3">\n  </span><span class="s1">html: string</span><span class="s3">\n  </span><span class="s1">rscData: Buffer | undefined</span><span class="s3">\n  </span><span class="s1">headers: OutgoingHttpHeaders | undefined</span><span class="s3">\n  </span><span class="s1">postponed: string | undefined</span><span class="s3">\n  </span><span class="s1">status: number | undefined</span><span class="s3">\n  </span><span class="s1">segmentData: Map&lt;string, Buffer&gt; | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface IncrementalCachedPageValue {</span><span class="s3">\n  </span><span class="s1">kind: CachedRouteKind.PAGES</span><span class="s3">\n  </span><span class="s1">// this needs to be a string since the cache expects to store</span><span class="s3">\n  </span><span class="s1">// the string value</span><span class="s3">\n  </span><span class="s1">html: string</span><span class="s3">\n  </span><span class="s1">pageData: Object</span><span class="s3">\n  </span><span class="s1">headers: OutgoingHttpHeaders | undefined</span><span class="s3">\n  </span><span class="s1">status: number | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface IncrementalResponseCacheEntry {</span><span class="s3">\n  </span><span class="s1">cacheControl?: CacheControl</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* timestamp in milliseconds to revalidate after</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">revalidateAfter?: Revalidate</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* `-1` here dictates a blocking revalidate should be used</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">isStale?: boolean | -1</span><span class="s3">\n  </span><span class="s1">isMiss?: boolean</span><span class="s3">\n  </span><span class="s1">value: Exclude&lt;IncrementalCacheValue, CachedFetchValue&gt; | null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface IncrementalFetchCacheEntry {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* `-1` here dictates a blocking revalidate should be used</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">isStale?: boolean | -1</span><span class="s3">\n  </span><span class="s1">value: CachedFetchValue</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type IncrementalCacheEntry =</span><span class="s3">\n  </span><span class="s1">| IncrementalResponseCacheEntry</span><span class="s3">\n  </span><span class="s1">| IncrementalFetchCacheEntry</span><span class="s3">\n\n</span><span class="s1">export type IncrementalCacheValue =</span><span class="s3">\n  </span><span class="s1">| CachedRedirectValue</span><span class="s3">\n  </span><span class="s1">| IncrementalCachedPageValue</span><span class="s3">\n  </span><span class="s1">| IncrementalCachedAppPageValue</span><span class="s3">\n  </span><span class="s1">| CachedImageValue</span><span class="s3">\n  </span><span class="s1">| CachedFetchValue</span><span class="s3">\n  </span><span class="s1">| CachedRouteValue</span><span class="s3">\n\n</span><span class="s1">export type ResponseCacheValue =</span><span class="s3">\n  </span><span class="s1">| CachedRedirectValue</span><span class="s3">\n  </span><span class="s1">| CachedPageValue</span><span class="s3">\n  </span><span class="s1">| CachedAppPageValue</span><span class="s3">\n  </span><span class="s1">| CachedImageValue</span><span class="s3">\n  </span><span class="s1">| CachedRouteValue</span><span class="s3">\n\n</span><span class="s1">export type ResponseCacheEntry = {</span><span class="s3">\n  </span><span class="s1">cacheControl?: CacheControl</span><span class="s3">\n  </span><span class="s1">value: ResponseCacheValue | null</span><span class="s3">\n  </span><span class="s1">isStale?: boolean | -1</span><span class="s3">\n  </span><span class="s1">isMiss?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param hasResolved whether the responseGenerator has resolved it's promise</span><span class="s3">\n </span><span class="s1">* @param previousCacheEntry the previous cache entry if it exists or the current</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export type ResponseGenerator = (state: {</span><span class="s3">\n  </span><span class="s1">hasResolved: boolean</span><span class="s3">\n  </span><span class="s1">previousCacheEntry?: IncrementalResponseCacheEntry | null</span><span class="s3">\n  </span><span class="s1">isRevalidating?: boolean</span><span class="s3">\n  </span><span class="s1">span?: any</span><span class="s3">\n</span><span class="s1">}) =&gt; Promise&lt;ResponseCacheEntry | null&gt;</span><span class="s3">\n\n</span><span class="s1">export const enum IncrementalCacheKind {</span><span class="s3">\n  </span><span class="s1">APP_PAGE = 'APP_PAGE',</span><span class="s3">\n  </span><span class="s1">APP_ROUTE = 'APP_ROUTE',</span><span class="s3">\n  </span><span class="s1">PAGES = 'PAGES',</span><span class="s3">\n  </span><span class="s1">FETCH = 'FETCH',</span><span class="s3">\n  </span><span class="s1">IMAGE = 'IMAGE',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface GetIncrementalFetchCacheContext {</span><span class="s3">\n  </span><span class="s1">kind: IncrementalCacheKind.FETCH</span><span class="s3">\n  </span><span class="s1">revalidate?: Revalidate</span><span class="s3">\n  </span><span class="s1">fetchUrl?: string</span><span class="s3">\n  </span><span class="s1">fetchIdx?: number</span><span class="s3">\n  </span><span class="s1">tags?: string[]</span><span class="s3">\n  </span><span class="s1">softTags?: string[]</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface GetIncrementalResponseCacheContext {</span><span class="s3">\n  </span><span class="s1">kind: Exclude&lt;IncrementalCacheKind, IncrementalCacheKind.FETCH&gt;</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* True if the route is enabled for PPR.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">isRoutePPREnabled?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* True if this is a fallback request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">isFallback: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface SetIncrementalFetchCacheContext {</span><span class="s3">\n  </span><span class="s1">fetchCache: true</span><span class="s3">\n  </span><span class="s1">fetchUrl?: string</span><span class="s3">\n  </span><span class="s1">fetchIdx?: number</span><span class="s3">\n  </span><span class="s1">tags?: string[]</span><span class="s3">\n  </span><span class="s1">isImplicitBuildTimeCache?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface SetIncrementalResponseCacheContext {</span><span class="s3">\n  </span><span class="s1">fetchCache?: false</span><span class="s3">\n  </span><span class="s1">cacheControl?: CacheControl</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* True if the route is enabled for PPR.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">isRoutePPREnabled?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* True if this is a fallback request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">isFallback?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface IncrementalResponseCache {</span><span class="s3">\n  </span><span class="s1">get(</span><span class="s3">\n    </span><span class="s1">cacheKey: string,</span><span class="s3">\n    </span><span class="s1">ctx: GetIncrementalResponseCacheContext</span><span class="s3">\n  </span><span class="s1">): Promise&lt;IncrementalResponseCacheEntry | null&gt;</span><span class="s3">\n  </span><span class="s1">set(</span><span class="s3">\n    </span><span class="s1">key: string,</span><span class="s3">\n    </span><span class="s1">data: Exclude&lt;IncrementalCacheValue, CachedFetchValue&gt; | null,</span><span class="s3">\n    </span><span class="s1">ctx: SetIncrementalResponseCacheContext</span><span class="s3">\n  </span><span class="s1">): Promise&lt;void&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface IncrementalCache extends IncrementalResponseCache {</span><span class="s3">\n  </span><span class="s1">get(</span><span class="s3">\n    </span><span class="s1">cacheKey: string,</span><span class="s3">\n    </span><span class="s1">ctx: GetIncrementalFetchCacheContext</span><span class="s3">\n  </span><span class="s1">): Promise&lt;IncrementalFetchCacheEntry | null&gt;</span><span class="s3">\n  </span><span class="s1">get(</span><span class="s3">\n    </span><span class="s1">cacheKey: string,</span><span class="s3">\n    </span><span class="s1">ctx: GetIncrementalResponseCacheContext</span><span class="s3">\n  </span><span class="s1">): Promise&lt;IncrementalResponseCacheEntry | null&gt;</span><span class="s3">\n  </span><span class="s1">set(</span><span class="s3">\n    </span><span class="s1">key: string,</span><span class="s3">\n    </span><span class="s1">data: CachedFetchValue | null,</span><span class="s3">\n    </span><span class="s1">ctx: SetIncrementalFetchCacheContext</span><span class="s3">\n  </span><span class="s1">): Promise&lt;void&gt;</span><span class="s3">\n  </span><span class="s1">set(</span><span class="s3">\n    </span><span class="s1">key: string,</span><span class="s3">\n    </span><span class="s1">data: Exclude&lt;IncrementalCacheValue, CachedFetchValue&gt; | null,</span><span class="s3">\n    </span><span class="s1">ctx: SetIncrementalResponseCacheContext</span><span class="s3">\n  </span><span class="s1">): Promise&lt;void&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;CachedRouteKind&quot;</span><span class="s0">,</span><span class="s1">&quot;IncrementalCacheKind&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AA+CO,IAAWA,kBAAAA,WAAAA,GAAAA,SAAAA,eAAAA;;;;;;;WAAAA;MAOjB;AA0IM,IAAWC,uBAAAA,WAAAA,GAAAA,SAAAA,oBAAAA;;;;;;WAAAA;MAMjB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3382</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/stream-utils/encoded-tags.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export const ENCODED_TAGS = {</span><span class="s3">\n  </span><span class="s1">// opening tags do not have the closing `&gt;` since they can contain other attributes such as `&lt;body className=''&gt;`</span><span class="s3">\n  </span><span class="s1">OPENING: {</span><span class="s3">\n    </span><span class="s1">// &lt;html</span><span class="s3">\n    </span><span class="s1">HTML: new Uint8Array([60, 104, 116, 109, 108]),</span><span class="s3">\n    </span><span class="s1">// &lt;body</span><span class="s3">\n    </span><span class="s1">BODY: new Uint8Array([60, 98, 111, 100, 121]),</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">CLOSED: {</span><span class="s3">\n    </span><span class="s1">// &lt;/head&gt;</span><span class="s3">\n    </span><span class="s1">HEAD: new Uint8Array([60, 47, 104, 101, 97, 100, 62]),</span><span class="s3">\n    </span><span class="s1">// &lt;/body&gt;</span><span class="s3">\n    </span><span class="s1">BODY: new Uint8Array([60, 47, 98, 111, 100, 121, 62]),</span><span class="s3">\n    </span><span class="s1">// &lt;/html&gt;</span><span class="s3">\n    </span><span class="s1">HTML: new Uint8Array([60, 47, 104, 116, 109, 108, 62]),</span><span class="s3">\n    </span><span class="s1">// &lt;/body&gt;&lt;/html&gt;</span><span class="s3">\n    </span><span class="s1">BODY_AND_HTML: new Uint8Array([</span><span class="s3">\n      </span><span class="s1">60, 47, 98, 111, 100, 121, 62, 60, 47, 104, 116, 109, 108, 62,</span><span class="s3">\n    </span><span class="s1">]),</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">META: {</span><span class="s3">\n    </span><span class="s1">// Only the match the prefix cause the suffix can be different wether it's xml compatible or not </span><span class="s3">\&quot;</span><span class="s1">&gt;</span><span class="s3">\&quot; </span><span class="s1">or </span><span class="s3">\&quot;</span><span class="s1">/&gt;</span><span class="s3">\&quot;\n    </span><span class="s1">// &lt;meta name=</span><span class="s3">\&quot;</span><span class="s1">nxt-icon</span><span class="s3">\&quot;\n    </span><span class="s1">// This is a special mark that will be replaced by the icon insertion script tag.</span><span class="s3">\n    </span><span class="s1">ICON_MARK: new Uint8Array([</span><span class="s3">\n      </span><span class="s1">60, 109, 101, 116, 97, 32, 110, 97, 109, 101, 61, 34, 194, 171, 110, 120,</span><span class="s3">\n      </span><span class="s1">116, 45, 105, 99, 111, 110, 194, 187, 34,</span><span class="s3">\n    </span><span class="s1">]),</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n</span><span class="s1">} as const</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ENCODED_TAGS&quot;</span><span class="s0">,</span><span class="s1">&quot;OPENING&quot;</span><span class="s0">,</span><span class="s1">&quot;HTML&quot;</span><span class="s0">,</span><span class="s1">&quot;Uint8Array&quot;</span><span class="s0">,</span><span class="s1">&quot;BODY&quot;</span><span class="s0">,</span><span class="s1">&quot;CLOSED&quot;</span><span class="s0">,</span><span class="s1">&quot;HEAD&quot;</span><span class="s0">,</span><span class="s1">&quot;BODY_AND_HTML&quot;</span><span class="s0">,</span><span class="s1">&quot;META&quot;</span><span class="s0">,</span><span class="s1">&quot;ICON_MARK&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,MAAMA,eAAe;IAC1B,iHAAiH;IACjHC,SAAS;QACP,QAAQ;QACRC,MAAM,IAAIC,WAAW;YAAC;YAAI;YAAK;YAAK;YAAK;SAAI;QAC7C,QAAQ;QACRC,MAAM,IAAID,WAAW;YAAC;YAAI;YAAI;YAAK;YAAK;SAAI;IAC9C;IACAE,QAAQ;QACN,UAAU;QACVC,MAAM,IAAIH,WAAW;YAAC;YAAI;YAAI;YAAK;YAAK;YAAI;YAAK;SAAG;QACpD,UAAU;QACVC,MAAM,IAAID,WAAW;YAAC;YAAI;YAAI;YAAI;YAAK;YAAK;YAAK;SAAG;QACpD,UAAU;QACVD,MAAM,IAAIC,WAAW;YAAC;YAAI;YAAI;YAAK;YAAK;YAAK;YAAK;SAAG;QACrD,iBAAiB;QACjBI,eAAe,IAAIJ,WAAW;YAC5B;YAAI;YAAI;YAAI;YAAK;YAAK;YAAK;YAAI;YAAI;YAAI;YAAK;YAAK;YAAK;YAAK;SAC5D;IACH;IACAK,MAAM;QACJ,4GAA4G;QAC5G,0BAA0B;QAC1B,iFAAiF;QACjFC,WAAW,IAAIN,WAAW;YACxB;YAAI;YAAK;YAAK;YAAK;YAAI;YAAI;YAAK;YAAI;YAAK;YAAK;YAAI;YAAI;YAAK;YAAK;YAAK;YACrE;YAAK;YAAI;YAAK;YAAI;YAAK;YAAK;YAAK;YAAK;SACvC;IACH;AACF,EAAU&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3492</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/stream-utils/uint8array-helpers.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Find the starting index of Uint8Array `b` within Uint8Array `a`.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function indexOfUint8Array(a: Uint8Array, b: Uint8Array) {</span><span class="s3">\n  </span><span class="s1">if (b.length === 0) return 0</span><span class="s3">\n  </span><span class="s1">if (a.length === 0 || b.length &gt; a.length) return -1</span><span class="s3">\n\n  </span><span class="s1">// start iterating through `a`</span><span class="s3">\n  </span><span class="s1">for (let i = 0; i &lt;= a.length - b.length; i++) {</span><span class="s3">\n    </span><span class="s1">let completeMatch = true</span><span class="s3">\n    </span><span class="s1">// from index `i`, iterate through `b` and check for mismatch</span><span class="s3">\n    </span><span class="s1">for (let j = 0; j &lt; b.length; j++) {</span><span class="s3">\n      </span><span class="s1">// if the values do not match, then this isn't a complete match, exit `b` iteration early and iterate to next index of `a`.</span><span class="s3">\n      </span><span class="s1">if (a[i + j] !== b[j]) {</span><span class="s3">\n        </span><span class="s1">completeMatch = false</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (completeMatch) {</span><span class="s3">\n      </span><span class="s1">return i</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return -1</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Check if two Uint8Arrays are strictly equivalent.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function isEquivalentUint8Arrays(a: Uint8Array, b: Uint8Array) {</span><span class="s3">\n  </span><span class="s1">if (a.length !== b.length) return false</span><span class="s3">\n\n  </span><span class="s1">for (let i = 0; i &lt; a.length; i++) {</span><span class="s3">\n    </span><span class="s1">if (a[i] !== b[i]) return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return true</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Remove Uint8Array `b` from Uint8Array `a`.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* If `b` is not in `a`, `a` is returned unchanged.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Otherwise, the function returns a new Uint8Array instance with size `a.length - b.length`</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function removeFromUint8Array(a: Uint8Array, b: Uint8Array) {</span><span class="s3">\n  </span><span class="s1">const tagIndex = indexOfUint8Array(a, b)</span><span class="s3">\n  </span><span class="s1">if (tagIndex === 0) return a.subarray(b.length)</span><span class="s3">\n  </span><span class="s1">if (tagIndex &gt; -1) {</span><span class="s3">\n    </span><span class="s1">const removed = new Uint8Array(a.length - b.length)</span><span class="s3">\n    </span><span class="s1">removed.set(a.slice(0, tagIndex))</span><span class="s3">\n    </span><span class="s1">removed.set(a.slice(tagIndex + b.length), tagIndex)</span><span class="s3">\n    </span><span class="s1">return removed</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">return a</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;indexOfUint8Array&quot;</span><span class="s0">,</span><span class="s1">&quot;a&quot;</span><span class="s0">,</span><span class="s1">&quot;b&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;completeMatch&quot;</span><span class="s0">,</span><span class="s1">&quot;j&quot;</span><span class="s0">,</span><span class="s1">&quot;isEquivalentUint8Arrays&quot;</span><span class="s0">,</span><span class="s1">&quot;removeFromUint8Array&quot;</span><span class="s0">,</span><span class="s1">&quot;tagIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;subarray&quot;</span><span class="s0">,</span><span class="s1">&quot;removed&quot;</span><span class="s0">,</span><span class="s1">&quot;Uint8Array&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;CAEC,GACD;;;;;;;;AAAO,SAASA,kBAAkBC,CAAa,EAAEC,CAAa;IAC5D,IAAIA,EAAEC,MAAM,KAAK,GAAG,OAAO;IAC3B,IAAIF,EAAEE,MAAM,KAAK,KAAKD,EAAEC,MAAM,GAAGF,EAAEE,MAAM,EAAE,OAAO,CAAC;IAEnD,8BAA8B;IAC9B,IAAK,IAAIC,IAAI,GAAGA,KAAKH,EAAEE,MAAM,GAAGD,EAAEC,MAAM,EAAEC,IAAK;QAC7C,IAAIC,gBAAgB;QACpB,6DAA6D;QAC7D,IAAK,IAAIC,IAAI,GAAGA,IAAIJ,EAAEC,MAAM,EAAEG,IAAK;YACjC,2HAA2H;YAC3H,IAAIL,CAAC,CAACG,IAAIE,EAAE,KAAKJ,CAAC,CAACI,EAAE,EAAE;gBACrBD,gBAAgB;gBAChB;YACF;QACF;QAEA,IAAIA,eAAe;YACjB,OAAOD;QACT;IACF;IAEA,OAAO,CAAC;AACV;AAKO,SAASG,wBAAwBN,CAAa,EAAEC,CAAa;IAClE,IAAID,EAAEE,MAAM,KAAKD,EAAEC,MAAM,EAAE,OAAO;IAElC,IAAK,IAAIC,IAAI,GAAGA,IAAIH,EAAEE,MAAM,EAAEC,IAAK;QACjC,IAAIH,CAAC,CAACG,EAAE,KAAKF,CAAC,CAACE,EAAE,EAAE,OAAO;IAC5B;IAEA,OAAO;AACT;AASO,SAASI,qBAAqBP,CAAa,EAAEC,CAAa;IAC/D,MAAMO,WAAWT,kBAAkBC,GAAGC;IACtC,IAAIO,aAAa,GAAG,OAAOR,EAAES,QAAQ,CAACR,EAAEC,MAAM;IAC9C,IAAIM,WAAW,CAAC,GAAG;QACjB,MAAME,UAAU,IAAIC,WAAWX,EAAEE,MAAM,GAAGD,EAAEC,MAAM;QAClDQ,QAAQE,GAAG,CAACZ,EAAEa,KAAK,CAAC,GAAGL;QACvBE,QAAQE,GAAG,CAACZ,EAAEa,KAAK,CAACL,WAAWP,EAAEC,MAAM,GAAGM;QAC1C,OAAOE;IACT,OAAO;QACL,OAAOV;IACT;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3545</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/errors/constants.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export const MISSING_ROOT_TAGS_ERROR = 'NEXT_MISSING_ROOT_TAGS'</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;MISSING_ROOT_TAGS_ERROR&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,MAAMA,0BAA0B,yBAAwB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3554</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/segment-cache/output-export-prefetch-encoding.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// In output: export mode, the build id is added to the start of the HTML</span><span class="s3">\n</span><span class="s1">// document, directly after the doctype declaration. During a prefetch, the</span><span class="s3">\n</span><span class="s1">// client performs a range request to get the build id, so it can check whether</span><span class="s3">\n</span><span class="s1">// the target page belongs to the same build.</span><span class="s3">\n</span><span class="s1">//</span><span class="s3">\n</span><span class="s1">// The first 64 bytes of the document are requested. The exact number isn't</span><span class="s3">\n</span><span class="s1">// too important; it must be larger than the build id + doctype + closing and</span><span class="s3">\n</span><span class="s1">// ending comment markers, but it doesn't need to match the end of the</span><span class="s3">\n</span><span class="s1">// comment exactly.</span><span class="s3">\n</span><span class="s1">//</span><span class="s3">\n</span><span class="s1">// Build ids are 21 bytes long in the default implementation, though this</span><span class="s3">\n</span><span class="s1">// can be overridden in the Next.js config. For the purposes of this check,</span><span class="s3">\n</span><span class="s1">// it's OK to only match the start of the id, so we'll truncate it if exceeds</span><span class="s3">\n</span><span class="s1">// a certain length.</span><span class="s3">\n\n</span><span class="s1">const DOCTYPE_PREFIX = '&lt;!DOCTYPE html&gt;' // 15 bytes</span><span class="s3">\n</span><span class="s1">const MAX_BUILD_ID_LENGTH = 24</span><span class="s3">\n\n</span><span class="s1">// Request the first 64 bytes. The Range header is inclusive of the end value.</span><span class="s3">\n</span><span class="s1">export const DOC_PREFETCH_RANGE_HEADER_VALUE = 'bytes=0-63'</span><span class="s3">\n\n</span><span class="s1">function escapeBuildId(buildId: string) {</span><span class="s3">\n  </span><span class="s1">// If the build id is longer than the given limit, it's OK for our purposes</span><span class="s3">\n  </span><span class="s1">// to only match the beginning.</span><span class="s3">\n  </span><span class="s1">const truncated = buildId.slice(0, MAX_BUILD_ID_LENGTH)</span><span class="s3">\n  </span><span class="s1">// Replace hyphens with underscores so it doesn't break the HTML comment.</span><span class="s3">\n  </span><span class="s1">// (Unlikely, but if this did happen it would break the whole document.)</span><span class="s3">\n  </span><span class="s1">return truncated.replace(/-/g, '_')</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function insertBuildIdComment(originalHtml: string, buildId: string) {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">// Skip if the build id contains a closing comment marker.</span><span class="s3">\n    </span><span class="s1">buildId.includes('--&gt;') ||</span><span class="s3">\n    </span><span class="s1">// React always inserts a doctype at the start of the document. Skip if it</span><span class="s3">\n    </span><span class="s1">// isn't present. Shouldn't happen; suggests an issue elsewhere.</span><span class="s3">\n    </span><span class="s1">!originalHtml.startsWith(DOCTYPE_PREFIX)</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">// Return the original HTML unchanged. This means the document will not</span><span class="s3">\n    </span><span class="s1">// be prefetched.</span><span class="s3">\n    </span><span class="s1">// TODO: The build id comment is currently only used during prefetches, but</span><span class="s3">\n    </span><span class="s1">// if we eventually use this mechanism for regular navigations, we may need</span><span class="s3">\n    </span><span class="s1">// to error during build if we fail to insert it for some reason.</span><span class="s3">\n    </span><span class="s1">return originalHtml</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">// The comment must be inserted after the doctype.</span><span class="s3">\n  </span><span class="s1">return originalHtml.replace(</span><span class="s3">\n    </span><span class="s1">DOCTYPE_PREFIX,</span><span class="s3">\n    </span><span class="s1">DOCTYPE_PREFIX + '&lt;!--' + escapeBuildId(buildId) + '--&gt;'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function doesExportedHtmlMatchBuildId(</span><span class="s3">\n  </span><span class="s1">partialHtmlDocument: string,</span><span class="s3">\n  </span><span class="s1">buildId: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">// Check whether the document starts with the expected buildId.</span><span class="s3">\n  </span><span class="s1">return partialHtmlDocument.startsWith(</span><span class="s3">\n    </span><span class="s1">DOCTYPE_PREFIX + '&lt;!--' + escapeBuildId(buildId) + '--&gt;'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;DOCTYPE_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;MAX_BUILD_ID_LENGTH&quot;</span><span class="s0">,</span><span class="s1">&quot;DOC_PREFETCH_RANGE_HEADER_VALUE&quot;</span><span class="s0">,</span><span class="s1">&quot;escapeBuildId&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;truncated&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;insertBuildIdComment&quot;</span><span class="s0">,</span><span class="s1">&quot;originalHtml&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;doesExportedHtmlMatchBuildId&quot;</span><span class="s0">,</span><span class="s1">&quot;partialHtmlDocument&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,yEAAyE;AACzE,2EAA2E;AAC3E,+EAA+E;AAC/E,6CAA6C;AAC7C,EAAE;AACF,2EAA2E;AAC3E,6EAA6E;AAC7E,sEAAsE;AACtE,mBAAmB;AACnB,EAAE;AACF,yEAAyE;AACzE,2EAA2E;AAC3E,6EAA6E;AAC7E,oBAAoB;;;;;;;;;AAEpB,MAAMA,iBAAiB,kBAAkB,WAAW;;AACpD,MAAMC,sBAAsB;AAGrB,MAAMC,kCAAkC,aAAY;AAE3D,SAASC,cAAcC,OAAe;IACpC,2EAA2E;IAC3E,+BAA+B;IAC/B,MAAMC,YAAYD,QAAQE,KAAK,CAAC,GAAGL;IACnC,yEAAyE;IACzE,wEAAwE;IACxE,OAAOI,UAAUE,OAAO,CAAC,MAAM;AACjC;AAEO,SAASC,qBAAqBC,YAAoB,EAAEL,OAAe;IACxE,IAEEA,AADA,QACQM,QAAQ,CAAC,UACjB,+BAF0D,2CAEgB;IAC1E,gEAAgE;IAChE,CAACD,aAAaE,UAAU,CAACX,iBACzB;QACA,uEAAuE;QACvE,iBAAiB;QACjB,2EAA2E;QAC3E,2EAA2E;QAC3E,iEAAiE;QACjE,OAAOS;IACT;IACA,kDAAkD;IAClD,OAAOA,aAAaF,OAAO,CACzBP,gBACAA,iBAAiB,SAASG,cAAcC,WAAW;AAEvD;AAEO,SAASQ,6BACdC,mBAA2B,EAC3BT,OAAe;IAEf,+DAA+D;IAC/D,OAAOS,oBAAoBF,UAAU,CACnCX,iBAAiB,SAASG,cAAcC,WAAW;AAEvD&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3610</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/stream-utils/node-web-streams-helper.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { ReactDOMServerReadableStream } from 'react-dom/server'</span><span class="s3">\n</span><span class="s1">import { getTracer } from '../lib/trace/tracer'</span><span class="s3">\n</span><span class="s1">import { AppRenderSpan } from '../lib/trace/constants'</span><span class="s3">\n</span><span class="s1">import { DetachedPromise } from '../../lib/detached-promise'</span><span class="s3">\n</span><span class="s1">import { scheduleImmediate, atLeastOneTask } from '../../lib/scheduler'</span><span class="s3">\n</span><span class="s1">import { ENCODED_TAGS } from './encoded-tags'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">indexOfUint8Array,</span><span class="s3">\n  </span><span class="s1">isEquivalentUint8Arrays,</span><span class="s3">\n  </span><span class="s1">removeFromUint8Array,</span><span class="s3">\n</span><span class="s1">} from './uint8array-helpers'</span><span class="s3">\n</span><span class="s1">import { MISSING_ROOT_TAGS_ERROR } from '../../shared/lib/errors/constants'</span><span class="s3">\n</span><span class="s1">import { insertBuildIdComment } from '../../shared/lib/segment-cache/output-export-prefetch-encoding'</span><span class="s3">\n\n</span><span class="s1">function voidCatch() {</span><span class="s3">\n  </span><span class="s1">// this catcher is designed to be used with pipeTo where we expect the underlying</span><span class="s3">\n  </span><span class="s1">// pipe implementation to forward errors but we don't want the pipeTo promise to reject</span><span class="s3">\n  </span><span class="s1">// and be unhandled</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// We can share the same encoder instance everywhere</span><span class="s3">\n</span><span class="s1">// Notably we cannot do the same for TextDecoder because it is stateful</span><span class="s3">\n</span><span class="s1">// when handling streaming data</span><span class="s3">\n</span><span class="s1">const encoder = new TextEncoder()</span><span class="s3">\n\n</span><span class="s1">export function chainStreams&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">...streams: ReadableStream&lt;T&gt;[]</span><span class="s3">\n</span><span class="s1">): ReadableStream&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">// If we have no streams, return an empty stream. This behavior is</span><span class="s3">\n  </span><span class="s1">// intentional as we're now providing the `RenderResult.EMPTY` value.</span><span class="s3">\n  </span><span class="s1">if (streams.length === 0) {</span><span class="s3">\n    </span><span class="s1">return new ReadableStream&lt;T&gt;({</span><span class="s3">\n      </span><span class="s1">start(controller) {</span><span class="s3">\n        </span><span class="s1">controller.close()</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If we only have 1 stream we fast path it by returning just this stream</span><span class="s3">\n  </span><span class="s1">if (streams.length === 1) {</span><span class="s3">\n    </span><span class="s1">return streams[0]</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { readable, writable } = new TransformStream()</span><span class="s3">\n\n  </span><span class="s1">// We always initiate pipeTo immediately. We know we have at least 2 streams</span><span class="s3">\n  </span><span class="s1">// so we need to avoid closing the writable when this one finishes.</span><span class="s3">\n  </span><span class="s1">let promise = streams[0].pipeTo(writable, { preventClose: true })</span><span class="s3">\n\n  </span><span class="s1">let i = 1</span><span class="s3">\n  </span><span class="s1">for (; i &lt; streams.length - 1; i++) {</span><span class="s3">\n    </span><span class="s1">const nextStream = streams[i]</span><span class="s3">\n    </span><span class="s1">promise = promise.then(() =&gt;</span><span class="s3">\n      </span><span class="s1">nextStream.pipeTo(writable, { preventClose: true })</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// We can omit the length check because we halted before the last stream and there</span><span class="s3">\n  </span><span class="s1">// is at least two streams so the lastStream here will always be defined</span><span class="s3">\n  </span><span class="s1">const lastStream = streams[i]</span><span class="s3">\n  </span><span class="s1">promise = promise.then(() =&gt; lastStream.pipeTo(writable))</span><span class="s3">\n\n  </span><span class="s1">// Catch any errors from the streams and ignore them, they will be handled</span><span class="s3">\n  </span><span class="s1">// by whatever is consuming the readable stream.</span><span class="s3">\n  </span><span class="s1">promise.catch(voidCatch)</span><span class="s3">\n\n  </span><span class="s1">return readable</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function streamFromString(str: string): ReadableStream&lt;Uint8Array&gt; {</span><span class="s3">\n  </span><span class="s1">return new ReadableStream({</span><span class="s3">\n    </span><span class="s1">start(controller) {</span><span class="s3">\n      </span><span class="s1">controller.enqueue(encoder.encode(str))</span><span class="s3">\n      </span><span class="s1">controller.close()</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function streamFromBuffer(chunk: Buffer): ReadableStream&lt;Uint8Array&gt; {</span><span class="s3">\n  </span><span class="s1">return new ReadableStream({</span><span class="s3">\n    </span><span class="s1">start(controller) {</span><span class="s3">\n      </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n      </span><span class="s1">controller.close()</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function streamToBuffer(</span><span class="s3">\n  </span><span class="s1">stream: ReadableStream&lt;Uint8Array&gt;</span><span class="s3">\n</span><span class="s1">): Promise&lt;Buffer&gt; {</span><span class="s3">\n  </span><span class="s1">const reader = stream.getReader()</span><span class="s3">\n  </span><span class="s1">const chunks: Uint8Array[] = []</span><span class="s3">\n\n  </span><span class="s1">while (true) {</span><span class="s3">\n    </span><span class="s1">const { done, value } = await reader.read()</span><span class="s3">\n    </span><span class="s1">if (done) {</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">chunks.push(value)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return Buffer.concat(chunks)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function streamToString(</span><span class="s3">\n  </span><span class="s1">stream: ReadableStream&lt;Uint8Array&gt;,</span><span class="s3">\n  </span><span class="s1">signal?: AbortSignal</span><span class="s3">\n</span><span class="s1">): Promise&lt;string&gt; {</span><span class="s3">\n  </span><span class="s1">const decoder = new TextDecoder('utf-8', { fatal: true })</span><span class="s3">\n  </span><span class="s1">let string = ''</span><span class="s3">\n\n  </span><span class="s1">for await (const chunk of stream) {</span><span class="s3">\n    </span><span class="s1">if (signal?.aborted) {</span><span class="s3">\n      </span><span class="s1">return string</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">string += decoder.decode(chunk, { stream: true })</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">string += decoder.decode()</span><span class="s3">\n\n  </span><span class="s1">return string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createBufferedTransformStream(): TransformStream&lt;</span><span class="s3">\n  </span><span class="s1">Uint8Array,</span><span class="s3">\n  </span><span class="s1">Uint8Array</span><span class="s3">\n</span><span class="s1">&gt; {</span><span class="s3">\n  </span><span class="s1">let bufferedChunks: Array&lt;Uint8Array&gt; = []</span><span class="s3">\n  </span><span class="s1">let bufferByteLength: number = 0</span><span class="s3">\n  </span><span class="s1">let pending: DetachedPromise&lt;void&gt; | undefined</span><span class="s3">\n\n  </span><span class="s1">const flush = (controller: TransformStreamDefaultController) =&gt; {</span><span class="s3">\n    </span><span class="s1">// If we already have a pending flush, then return early.</span><span class="s3">\n    </span><span class="s1">if (pending) return</span><span class="s3">\n\n    </span><span class="s1">const detached = new DetachedPromise&lt;void&gt;()</span><span class="s3">\n    </span><span class="s1">pending = detached</span><span class="s3">\n\n    </span><span class="s1">scheduleImmediate(() =&gt; {</span><span class="s3">\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">const chunk = new Uint8Array(bufferByteLength)</span><span class="s3">\n        </span><span class="s1">let copiedBytes = 0</span><span class="s3">\n\n        </span><span class="s1">for (let i = 0; i &lt; bufferedChunks.length; i++) {</span><span class="s3">\n          </span><span class="s1">const bufferedChunk = bufferedChunks[i]</span><span class="s3">\n          </span><span class="s1">chunk.set(bufferedChunk, copiedBytes)</span><span class="s3">\n          </span><span class="s1">copiedBytes += bufferedChunk.byteLength</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">// We just wrote all the buffered chunks so we need to reset the bufferedChunks array</span><span class="s3">\n        </span><span class="s1">// and our bufferByteLength to prepare for the next round of buffered chunks</span><span class="s3">\n        </span><span class="s1">bufferedChunks.length = 0</span><span class="s3">\n        </span><span class="s1">bufferByteLength = 0</span><span class="s3">\n        </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n      </span><span class="s1">} catch {</span><span class="s3">\n        </span><span class="s1">// If an error occurs while enqueuing it can't be due to this</span><span class="s3">\n        </span><span class="s1">// transformers fault. It's likely due to the controller being</span><span class="s3">\n        </span><span class="s1">// errored due to the stream being cancelled.</span><span class="s3">\n      </span><span class="s1">} finally {</span><span class="s3">\n        </span><span class="s1">pending = undefined</span><span class="s3">\n        </span><span class="s1">detached.resolve()</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return new TransformStream({</span><span class="s3">\n    </span><span class="s1">transform(chunk, controller) {</span><span class="s3">\n      </span><span class="s1">// Combine the previous buffer with the new chunk.</span><span class="s3">\n      </span><span class="s1">bufferedChunks.push(chunk)</span><span class="s3">\n      </span><span class="s1">bufferByteLength += chunk.byteLength</span><span class="s3">\n\n      </span><span class="s1">// Flush the buffer to the controller.</span><span class="s3">\n      </span><span class="s1">flush(controller)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">flush() {</span><span class="s3">\n      </span><span class="s1">if (!pending) return</span><span class="s3">\n\n      </span><span class="s1">return pending.promise</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createPrefetchCommentStream(</span><span class="s3">\n  </span><span class="s1">isBuildTimePrerendering: boolean,</span><span class="s3">\n  </span><span class="s1">buildId: string</span><span class="s3">\n</span><span class="s1">): TransformStream&lt;Uint8Array, Uint8Array&gt; {</span><span class="s3">\n  </span><span class="s1">// Insert an extra comment at the beginning of the HTML document. This must</span><span class="s3">\n  </span><span class="s1">// come after the DOCTYPE, which is inserted by React.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// The first chunk sent by React will contain the doctype. After that, we can</span><span class="s3">\n  </span><span class="s1">// pass through the rest of the chunks as-is.</span><span class="s3">\n  </span><span class="s1">let didTransformFirstChunk = false</span><span class="s3">\n  </span><span class="s1">return new TransformStream({</span><span class="s3">\n    </span><span class="s1">transform(chunk, controller) {</span><span class="s3">\n      </span><span class="s1">if (isBuildTimePrerendering &amp;&amp; !didTransformFirstChunk) {</span><span class="s3">\n        </span><span class="s1">didTransformFirstChunk = true</span><span class="s3">\n        </span><span class="s1">const decoder = new TextDecoder('utf-8', { fatal: true })</span><span class="s3">\n        </span><span class="s1">const chunkStr = decoder.decode(chunk, {</span><span class="s3">\n          </span><span class="s1">stream: true,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">const updatedChunkStr = insertBuildIdComment(chunkStr, buildId)</span><span class="s3">\n        </span><span class="s1">controller.enqueue(encoder.encode(updatedChunkStr))</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function renderToInitialFizzStream({</span><span class="s3">\n  </span><span class="s1">ReactDOMServer,</span><span class="s3">\n  </span><span class="s1">element,</span><span class="s3">\n  </span><span class="s1">streamOptions,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">ReactDOMServer: {</span><span class="s3">\n    </span><span class="s1">renderToReadableStream: typeof import('react-dom/server').renderToReadableStream</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">element: React.ReactElement</span><span class="s3">\n  </span><span class="s1">streamOptions?: Parameters&lt;typeof ReactDOMServer.renderToReadableStream&gt;[1]</span><span class="s3">\n</span><span class="s1">}): Promise&lt;ReactDOMServerReadableStream&gt; {</span><span class="s3">\n  </span><span class="s1">return getTracer().trace(AppRenderSpan.renderToReadableStream, async () =&gt;</span><span class="s3">\n    </span><span class="s1">ReactDOMServer.renderToReadableStream(element, streamOptions)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createMetadataTransformStream(</span><span class="s3">\n  </span><span class="s1">insert: () =&gt; Promise&lt;string&gt; | string</span><span class="s3">\n</span><span class="s1">): TransformStream&lt;Uint8Array, Uint8Array&gt; {</span><span class="s3">\n  </span><span class="s1">let chunkIndex = -1</span><span class="s3">\n  </span><span class="s1">let isMarkRemoved = false</span><span class="s3">\n\n  </span><span class="s1">return new TransformStream({</span><span class="s3">\n    </span><span class="s1">async transform(chunk, controller) {</span><span class="s3">\n      </span><span class="s1">let iconMarkIndex = -1</span><span class="s3">\n      </span><span class="s1">let closedHeadIndex = -1</span><span class="s3">\n      </span><span class="s1">chunkIndex++</span><span class="s3">\n\n      </span><span class="s1">if (isMarkRemoved) {</span><span class="s3">\n        </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">let iconMarkLength = 0</span><span class="s3">\n      </span><span class="s1">// Only search for the closed head tag once</span><span class="s3">\n      </span><span class="s1">if (iconMarkIndex === -1) {</span><span class="s3">\n        </span><span class="s1">iconMarkIndex = indexOfUint8Array(chunk, ENCODED_TAGS.META.ICON_MARK)</span><span class="s3">\n        </span><span class="s1">if (iconMarkIndex === -1) {</span><span class="s3">\n          </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">// When we found the `&lt;meta name=</span><span class="s3">\&quot;</span><span class="s1">nxt-icon</span><span class="s3">\&quot;</span><span class="s1">` tag prefix, we will remove it from the chunk.</span><span class="s3">\n          </span><span class="s1">// Its close tag could either be `/&gt;` or `&gt;`, checking the next char to ensure we cover both cases.</span><span class="s3">\n          </span><span class="s1">iconMarkLength = ENCODED_TAGS.META.ICON_MARK.length</span><span class="s3">\n          </span><span class="s1">// Check if next char is /, this is for xml mode.</span><span class="s3">\n          </span><span class="s1">if (chunk[iconMarkIndex + iconMarkLength] === 47) {</span><span class="s3">\n            </span><span class="s1">iconMarkLength += 2</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">// The last char is `&gt;`</span><span class="s3">\n            </span><span class="s1">iconMarkLength++</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Check if icon mark is inside &lt;head&gt; tag in the first chunk.</span><span class="s3">\n      </span><span class="s1">if (chunkIndex === 0) {</span><span class="s3">\n        </span><span class="s1">closedHeadIndex = indexOfUint8Array(chunk, ENCODED_TAGS.CLOSED.HEAD)</span><span class="s3">\n        </span><span class="s1">if (iconMarkIndex !== -1) {</span><span class="s3">\n          </span><span class="s1">// The mark icon is located in the 1st chunk before the head tag.</span><span class="s3">\n          </span><span class="s1">// We do not need to insert the script tag in this case because it's in the head.</span><span class="s3">\n          </span><span class="s1">// Just remove the icon mark from the chunk.</span><span class="s3">\n          </span><span class="s1">if (iconMarkIndex &lt; closedHeadIndex) {</span><span class="s3">\n            </span><span class="s1">const replaced = new Uint8Array(chunk.length - iconMarkLength)</span><span class="s3">\n\n            </span><span class="s1">// Remove the icon mark from the chunk.</span><span class="s3">\n            </span><span class="s1">replaced.set(chunk.subarray(0, iconMarkIndex))</span><span class="s3">\n            </span><span class="s1">replaced.set(</span><span class="s3">\n              </span><span class="s1">chunk.subarray(iconMarkIndex + iconMarkLength),</span><span class="s3">\n              </span><span class="s1">iconMarkIndex</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">chunk = replaced</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">// The icon mark is after the head tag, replace and insert the script tag at that position.</span><span class="s3">\n            </span><span class="s1">const insertion = await insert()</span><span class="s3">\n            </span><span class="s1">const encodedInsertion = encoder.encode(insertion)</span><span class="s3">\n            </span><span class="s1">const insertionLength = encodedInsertion.length</span><span class="s3">\n            </span><span class="s1">const replaced = new Uint8Array(</span><span class="s3">\n              </span><span class="s1">chunk.length - iconMarkLength + insertionLength</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">replaced.set(chunk.subarray(0, iconMarkIndex))</span><span class="s3">\n            </span><span class="s1">replaced.set(encodedInsertion, iconMarkIndex)</span><span class="s3">\n            </span><span class="s1">replaced.set(</span><span class="s3">\n              </span><span class="s1">chunk.subarray(iconMarkIndex + iconMarkLength),</span><span class="s3">\n              </span><span class="s1">iconMarkIndex + insertionLength</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">chunk = replaced</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">isMarkRemoved = true</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">// If there's no icon mark located, it will be handled later when if present in the following chunks.</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">// When it's appeared in the following chunks, we'll need to</span><span class="s3">\n        </span><span class="s1">// remove the mark and then insert the script tag at that position.</span><span class="s3">\n        </span><span class="s1">const insertion = await insert()</span><span class="s3">\n        </span><span class="s1">const encodedInsertion = encoder.encode(insertion)</span><span class="s3">\n        </span><span class="s1">const insertionLength = encodedInsertion.length</span><span class="s3">\n        </span><span class="s1">// Replace the icon mark with the hoist script or empty string.</span><span class="s3">\n        </span><span class="s1">const replaced = new Uint8Array(</span><span class="s3">\n          </span><span class="s1">chunk.length - iconMarkLength + insertionLength</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">// Set the first part of the chunk, before the icon mark.</span><span class="s3">\n        </span><span class="s1">replaced.set(chunk.subarray(0, iconMarkIndex))</span><span class="s3">\n        </span><span class="s1">// Set the insertion after the icon mark.</span><span class="s3">\n        </span><span class="s1">replaced.set(encodedInsertion, iconMarkIndex)</span><span class="s3">\n\n        </span><span class="s1">// Set the rest of the chunk after the icon mark.</span><span class="s3">\n        </span><span class="s1">replaced.set(</span><span class="s3">\n          </span><span class="s1">chunk.subarray(iconMarkIndex + iconMarkLength),</span><span class="s3">\n          </span><span class="s1">iconMarkIndex + insertionLength</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">chunk = replaced</span><span class="s3">\n        </span><span class="s1">isMarkRemoved = true</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createHeadInsertionTransformStream(</span><span class="s3">\n  </span><span class="s1">insert: () =&gt; Promise&lt;string&gt;</span><span class="s3">\n</span><span class="s1">): TransformStream&lt;Uint8Array, Uint8Array&gt; {</span><span class="s3">\n  </span><span class="s1">let inserted = false</span><span class="s3">\n\n  </span><span class="s1">// We need to track if this transform saw any bytes because if it didn't</span><span class="s3">\n  </span><span class="s1">// we won't want to insert any server HTML at all</span><span class="s3">\n  </span><span class="s1">let hasBytes = false</span><span class="s3">\n\n  </span><span class="s1">return new TransformStream({</span><span class="s3">\n    </span><span class="s1">async transform(chunk, controller) {</span><span class="s3">\n      </span><span class="s1">hasBytes = true</span><span class="s3">\n\n      </span><span class="s1">const insertion = await insert()</span><span class="s3">\n      </span><span class="s1">if (inserted) {</span><span class="s3">\n        </span><span class="s1">if (insertion) {</span><span class="s3">\n          </span><span class="s1">const encodedInsertion = encoder.encode(insertion)</span><span class="s3">\n          </span><span class="s1">controller.enqueue(encodedInsertion)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">// TODO (@Ethan-Arrowood): Replace the generic `indexOfUint8Array` method with something finely tuned for the subset of things actually being checked for.</span><span class="s3">\n        </span><span class="s1">const index = indexOfUint8Array(chunk, ENCODED_TAGS.CLOSED.HEAD)</span><span class="s3">\n        </span><span class="s1">// In fully static rendering or non PPR rendering cases:</span><span class="s3">\n        </span><span class="s1">// `/head&gt;` will always be found in the chunk in first chunk rendering.</span><span class="s3">\n        </span><span class="s1">if (index !== -1) {</span><span class="s3">\n          </span><span class="s1">if (insertion) {</span><span class="s3">\n            </span><span class="s1">const encodedInsertion = encoder.encode(insertion)</span><span class="s3">\n            </span><span class="s1">// Get the total count of the bytes in the chunk and the insertion</span><span class="s3">\n            </span><span class="s1">// e.g.</span><span class="s3">\n            </span><span class="s1">// chunk = &lt;head&gt;&lt;meta charset=</span><span class="s3">\&quot;</span><span class="s1">utf-8</span><span class="s3">\&quot;</span><span class="s1">&gt;&lt;/head&gt;</span><span class="s3">\n            </span><span class="s1">// insertion = &lt;script&gt;...&lt;/script&gt;</span><span class="s3">\n            </span><span class="s1">// output = &lt;head&gt;&lt;meta charset=</span><span class="s3">\&quot;</span><span class="s1">utf-8</span><span class="s3">\&quot;</span><span class="s1">&gt; [ &lt;script&gt;...&lt;/script&gt; ] &lt;/head&gt;</span><span class="s3">\n            </span><span class="s1">const insertedHeadContent = new Uint8Array(</span><span class="s3">\n              </span><span class="s1">chunk.length + encodedInsertion.length</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">// Append the first part of the chunk, before the head tag</span><span class="s3">\n            </span><span class="s1">insertedHeadContent.set(chunk.slice(0, index))</span><span class="s3">\n            </span><span class="s1">// Append the server inserted content</span><span class="s3">\n            </span><span class="s1">insertedHeadContent.set(encodedInsertion, index)</span><span class="s3">\n            </span><span class="s1">// Append the rest of the chunk</span><span class="s3">\n            </span><span class="s1">insertedHeadContent.set(</span><span class="s3">\n              </span><span class="s1">chunk.slice(index),</span><span class="s3">\n              </span><span class="s1">index + encodedInsertion.length</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">controller.enqueue(insertedHeadContent)</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">inserted = true</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">// This will happens in PPR rendering during next start, when the page is partially rendered.</span><span class="s3">\n          </span><span class="s1">// When the page resumes, the head tag will be found in the middle of the chunk.</span><span class="s3">\n          </span><span class="s1">// Where we just need to append the insertion and chunk to the current stream.</span><span class="s3">\n          </span><span class="s1">// e.g.</span><span class="s3">\n          </span><span class="s1">// PPR-static: &lt;head&gt;...&lt;/head&gt;&lt;body&gt; [ resume content ] &lt;/body&gt;</span><span class="s3">\n          </span><span class="s1">// PPR-resume: [ insertion ] [ rest content ]</span><span class="s3">\n          </span><span class="s1">if (insertion) {</span><span class="s3">\n            </span><span class="s1">controller.enqueue(encoder.encode(insertion))</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n          </span><span class="s1">inserted = true</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">async flush(controller) {</span><span class="s3">\n      </span><span class="s1">// Check before closing if there's anything remaining to insert.</span><span class="s3">\n      </span><span class="s1">if (hasBytes) {</span><span class="s3">\n        </span><span class="s1">const insertion = await insert()</span><span class="s3">\n        </span><span class="s1">if (insertion) {</span><span class="s3">\n          </span><span class="s1">controller.enqueue(encoder.encode(insertion))</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Suffix after main body content - scripts before &lt;/body&gt;,</span><span class="s3">\n</span><span class="s1">// but wait for the major chunks to be enqueued.</span><span class="s3">\n</span><span class="s1">function createDeferredSuffixStream(</span><span class="s3">\n  </span><span class="s1">suffix: string</span><span class="s3">\n</span><span class="s1">): TransformStream&lt;Uint8Array, Uint8Array&gt; {</span><span class="s3">\n  </span><span class="s1">let flushed = false</span><span class="s3">\n  </span><span class="s1">let pending: DetachedPromise&lt;void&gt; | undefined</span><span class="s3">\n\n  </span><span class="s1">const flush = (controller: TransformStreamDefaultController) =&gt; {</span><span class="s3">\n    </span><span class="s1">const detached = new DetachedPromise&lt;void&gt;()</span><span class="s3">\n    </span><span class="s1">pending = detached</span><span class="s3">\n\n    </span><span class="s1">scheduleImmediate(() =&gt; {</span><span class="s3">\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">controller.enqueue(encoder.encode(suffix))</span><span class="s3">\n      </span><span class="s1">} catch {</span><span class="s3">\n        </span><span class="s1">// If an error occurs while enqueuing it can't be due to this</span><span class="s3">\n        </span><span class="s1">// transformers fault. It's likely due to the controller being</span><span class="s3">\n        </span><span class="s1">// errored due to the stream being cancelled.</span><span class="s3">\n      </span><span class="s1">} finally {</span><span class="s3">\n        </span><span class="s1">pending = undefined</span><span class="s3">\n        </span><span class="s1">detached.resolve()</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return new TransformStream({</span><span class="s3">\n    </span><span class="s1">transform(chunk, controller) {</span><span class="s3">\n      </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n\n      </span><span class="s1">// If we've already flushed, we're done.</span><span class="s3">\n      </span><span class="s1">if (flushed) return</span><span class="s3">\n\n      </span><span class="s1">// Schedule the flush to happen.</span><span class="s3">\n      </span><span class="s1">flushed = true</span><span class="s3">\n      </span><span class="s1">flush(controller)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">flush(controller) {</span><span class="s3">\n      </span><span class="s1">if (pending) return pending.promise</span><span class="s3">\n      </span><span class="s1">if (flushed) return</span><span class="s3">\n\n      </span><span class="s1">// Flush now.</span><span class="s3">\n      </span><span class="s1">controller.enqueue(encoder.encode(suffix))</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createFlightDataInjectionTransformStream(</span><span class="s3">\n  </span><span class="s1">stream: ReadableStream&lt;Uint8Array&gt;,</span><span class="s3">\n  </span><span class="s1">delayDataUntilFirstHtmlChunk: boolean</span><span class="s3">\n</span><span class="s1">): TransformStream&lt;Uint8Array, Uint8Array&gt; {</span><span class="s3">\n  </span><span class="s1">let htmlStreamFinished = false</span><span class="s3">\n\n  </span><span class="s1">let pull: Promise&lt;void&gt; | null = null</span><span class="s3">\n  </span><span class="s1">let donePulling = false</span><span class="s3">\n\n  </span><span class="s1">function startOrContinuePulling(</span><span class="s3">\n    </span><span class="s1">controller: TransformStreamDefaultController</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">if (!pull) {</span><span class="s3">\n      </span><span class="s1">pull = startPulling(controller)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return pull</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">async function startPulling(controller: TransformStreamDefaultController) {</span><span class="s3">\n    </span><span class="s1">const reader = stream.getReader()</span><span class="s3">\n\n    </span><span class="s1">if (delayDataUntilFirstHtmlChunk) {</span><span class="s3">\n      </span><span class="s1">// NOTE: streaming flush</span><span class="s3">\n      </span><span class="s1">// We are buffering here for the inlined data stream because the</span><span class="s3">\n      </span><span class="s1">// </span><span class="s3">\&quot;</span><span class="s1">shell</span><span class="s3">\&quot; </span><span class="s1">stream might be chunkenized again by the underlying stream</span><span class="s3">\n      </span><span class="s1">// implementation, e.g. with a specific high-water mark. To ensure it's</span><span class="s3">\n      </span><span class="s1">// the safe timing to pipe the data stream, this extra tick is</span><span class="s3">\n      </span><span class="s1">// necessary.</span><span class="s3">\n\n      </span><span class="s1">// We don't start reading until we've left the current Task to ensure</span><span class="s3">\n      </span><span class="s1">// that it's inserted after flushing the shell. Note that this implementation</span><span class="s3">\n      </span><span class="s1">// might get stale if impl details of Fizz change in the future.</span><span class="s3">\n      </span><span class="s1">await atLeastOneTask()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">while (true) {</span><span class="s3">\n        </span><span class="s1">const { done, value } = await reader.read()</span><span class="s3">\n        </span><span class="s1">if (done) {</span><span class="s3">\n          </span><span class="s1">donePulling = true</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// We want to prioritize HTML over RSC data.</span><span class="s3">\n        </span><span class="s1">// The SSR render is based on the same RSC stream, so when we get a new RSC chunk,</span><span class="s3">\n        </span><span class="s1">// we're likely to produce an HTML chunk as well, so give it a chance to flush first.</span><span class="s3">\n        </span><span class="s1">if (!delayDataUntilFirstHtmlChunk &amp;&amp; !htmlStreamFinished) {</span><span class="s3">\n          </span><span class="s1">await atLeastOneTask()</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">controller.enqueue(value)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} catch (err) {</span><span class="s3">\n      </span><span class="s1">controller.error(err)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return new TransformStream({</span><span class="s3">\n    </span><span class="s1">start(controller) {</span><span class="s3">\n      </span><span class="s1">if (!delayDataUntilFirstHtmlChunk) {</span><span class="s3">\n        </span><span class="s1">startOrContinuePulling(controller)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">transform(chunk, controller) {</span><span class="s3">\n      </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n\n      </span><span class="s1">// Start the streaming if it hasn't already been started yet.</span><span class="s3">\n      </span><span class="s1">if (delayDataUntilFirstHtmlChunk) {</span><span class="s3">\n        </span><span class="s1">startOrContinuePulling(controller)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">flush(controller) {</span><span class="s3">\n      </span><span class="s1">htmlStreamFinished = true</span><span class="s3">\n      </span><span class="s1">if (donePulling) {</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return startOrContinuePulling(controller)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const CLOSE_TAG = '&lt;/body&gt;&lt;/html&gt;'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This transform stream moves the suffix to the end of the stream, so results</span><span class="s3">\n </span><span class="s1">* like `&lt;/body&gt;&lt;/html&gt;&lt;script&gt;...&lt;/script&gt;` will be transformed to</span><span class="s3">\n </span><span class="s1">* `&lt;script&gt;...&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;`.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function createMoveSuffixStream(): TransformStream&lt;Uint8Array, Uint8Array&gt; {</span><span class="s3">\n  </span><span class="s1">let foundSuffix = false</span><span class="s3">\n\n  </span><span class="s1">return new TransformStream({</span><span class="s3">\n    </span><span class="s1">transform(chunk, controller) {</span><span class="s3">\n      </span><span class="s1">if (foundSuffix) {</span><span class="s3">\n        </span><span class="s1">return controller.enqueue(chunk)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const index = indexOfUint8Array(chunk, ENCODED_TAGS.CLOSED.BODY_AND_HTML)</span><span class="s3">\n      </span><span class="s1">if (index &gt; -1) {</span><span class="s3">\n        </span><span class="s1">foundSuffix = true</span><span class="s3">\n\n        </span><span class="s1">// If the whole chunk is the suffix, then don't write anything, it will</span><span class="s3">\n        </span><span class="s1">// be written in the flush.</span><span class="s3">\n        </span><span class="s1">if (chunk.length === ENCODED_TAGS.CLOSED.BODY_AND_HTML.length) {</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// Write out the part before the suffix.</span><span class="s3">\n        </span><span class="s1">const before = chunk.slice(0, index)</span><span class="s3">\n        </span><span class="s1">controller.enqueue(before)</span><span class="s3">\n\n        </span><span class="s1">// In the case where the suffix is in the middle of the chunk, we need</span><span class="s3">\n        </span><span class="s1">// to split the chunk into two parts.</span><span class="s3">\n        </span><span class="s1">if (chunk.length &gt; ENCODED_TAGS.CLOSED.BODY_AND_HTML.length + index) {</span><span class="s3">\n          </span><span class="s1">// Write out the part after the suffix.</span><span class="s3">\n          </span><span class="s1">const after = chunk.slice(</span><span class="s3">\n            </span><span class="s1">index + ENCODED_TAGS.CLOSED.BODY_AND_HTML.length</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">controller.enqueue(after)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">flush(controller) {</span><span class="s3">\n      </span><span class="s1">// Even if we didn't find the suffix, the HTML is not valid if we don't</span><span class="s3">\n      </span><span class="s1">// add it, so insert it at the end.</span><span class="s3">\n      </span><span class="s1">controller.enqueue(ENCODED_TAGS.CLOSED.BODY_AND_HTML)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createStripDocumentClosingTagsTransform(): TransformStream&lt;</span><span class="s3">\n  </span><span class="s1">Uint8Array,</span><span class="s3">\n  </span><span class="s1">Uint8Array</span><span class="s3">\n</span><span class="s1">&gt; {</span><span class="s3">\n  </span><span class="s1">return new TransformStream({</span><span class="s3">\n    </span><span class="s1">transform(chunk, controller) {</span><span class="s3">\n      </span><span class="s1">// We rely on the assumption that chunks will never break across a code unit.</span><span class="s3">\n      </span><span class="s1">// This is reasonable because we currently concat all of React's output from a single</span><span class="s3">\n      </span><span class="s1">// flush into one chunk before streaming it forward which means the chunk will represent</span><span class="s3">\n      </span><span class="s1">// a single coherent utf-8 string. This is not safe to use if we change our streaming to no</span><span class="s3">\n      </span><span class="s1">// longer do this large buffered chunk</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">isEquivalentUint8Arrays(chunk, ENCODED_TAGS.CLOSED.BODY_AND_HTML) ||</span><span class="s3">\n        </span><span class="s1">isEquivalentUint8Arrays(chunk, ENCODED_TAGS.CLOSED.BODY) ||</span><span class="s3">\n        </span><span class="s1">isEquivalentUint8Arrays(chunk, ENCODED_TAGS.CLOSED.HTML)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">// the entire chunk is the closing tags; return without enqueueing anything.</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// We assume these tags will go at together at the end of the document and that</span><span class="s3">\n      </span><span class="s1">// they won't appear anywhere else in the document. This is not really a safe assumption</span><span class="s3">\n      </span><span class="s1">// but until we revamp our streaming infra this is a performant way to string the tags</span><span class="s3">\n      </span><span class="s1">chunk = removeFromUint8Array(chunk, ENCODED_TAGS.CLOSED.BODY)</span><span class="s3">\n      </span><span class="s1">chunk = removeFromUint8Array(chunk, ENCODED_TAGS.CLOSED.HTML)</span><span class="s3">\n\n      </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/*</span><span class="s3">\n </span><span class="s1">* Checks if the root layout is missing the html or body tags</span><span class="s3">\n </span><span class="s1">* and if so, it will inject a script tag to throw an error in the browser, showing the user</span><span class="s3">\n </span><span class="s1">* the error message in the error overlay.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function createRootLayoutValidatorStream(): TransformStream&lt;</span><span class="s3">\n  </span><span class="s1">Uint8Array,</span><span class="s3">\n  </span><span class="s1">Uint8Array</span><span class="s3">\n</span><span class="s1">&gt; {</span><span class="s3">\n  </span><span class="s1">let foundHtml = false</span><span class="s3">\n  </span><span class="s1">let foundBody = false</span><span class="s3">\n  </span><span class="s1">return new TransformStream({</span><span class="s3">\n    </span><span class="s1">async transform(chunk, controller) {</span><span class="s3">\n      </span><span class="s1">// Peek into the streamed chunk to see if the tags are present.</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">!foundHtml &amp;&amp;</span><span class="s3">\n        </span><span class="s1">indexOfUint8Array(chunk, ENCODED_TAGS.OPENING.HTML) &gt; -1</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">foundHtml = true</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">!foundBody &amp;&amp;</span><span class="s3">\n        </span><span class="s1">indexOfUint8Array(chunk, ENCODED_TAGS.OPENING.BODY) &gt; -1</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">foundBody = true</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">controller.enqueue(chunk)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">flush(controller) {</span><span class="s3">\n      </span><span class="s1">const missingTags: ('html' | 'body')[] = []</span><span class="s3">\n      </span><span class="s1">if (!foundHtml) missingTags.push('html')</span><span class="s3">\n      </span><span class="s1">if (!foundBody) missingTags.push('body')</span><span class="s3">\n\n      </span><span class="s1">if (!missingTags.length) return</span><span class="s3">\n\n      </span><span class="s1">controller.enqueue(</span><span class="s3">\n        </span><span class="s1">encoder.encode(</span><span class="s3">\n          </span><span class="s1">`&lt;html id=</span><span class="s3">\&quot;</span><span class="s1">__next_error__</span><span class="s3">\&quot;</span><span class="s1">&gt;</span><span class="s3">\n            </span><span class="s1">&lt;template</span><span class="s3">\n              </span><span class="s1">data-next-error-message=</span><span class="s3">\&quot;</span><span class="s1">Missing ${missingTags</span><span class="s3">\n                </span><span class="s1">.map((c) =&gt; `&lt;${c}&gt;`)</span><span class="s3">\n                </span><span class="s1">.join(</span><span class="s3">\n                  </span><span class="s1">missingTags.length &gt; 1 ? ' and ' : ''</span><span class="s3">\n                </span><span class="s1">)} tags in the root layout.</span><span class="s3">\\</span><span class="s1">nRead more at https://nextjs.org/docs/messages/missing-root-layout-tags</span><span class="s3">\&quot;\n              </span><span class="s1">data-next-error-digest=</span><span class="s3">\&quot;</span><span class="s1">${MISSING_ROOT_TAGS_ERROR}</span><span class="s3">\&quot;\n              </span><span class="s1">data-next-error-stack=</span><span class="s3">\&quot;\&quot;\n            </span><span class="s1">&gt;&lt;/template&gt;</span><span class="s3">\n          </span><span class="s1">`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function chainTransformers&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">readable: ReadableStream&lt;T&gt;,</span><span class="s3">\n  </span><span class="s1">transformers: ReadonlyArray&lt;TransformStream&lt;T, T&gt; | null&gt;</span><span class="s3">\n</span><span class="s1">): ReadableStream&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">let stream = readable</span><span class="s3">\n  </span><span class="s1">for (const transformer of transformers) {</span><span class="s3">\n    </span><span class="s1">if (!transformer) continue</span><span class="s3">\n\n    </span><span class="s1">stream = stream.pipeThrough(transformer)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return stream</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type ContinueStreamOptions = {</span><span class="s3">\n  </span><span class="s1">inlinedDataStream: ReadableStream&lt;Uint8Array&gt; | undefined</span><span class="s3">\n  </span><span class="s1">isStaticGeneration: boolean</span><span class="s3">\n  </span><span class="s1">isBuildTimePrerendering: boolean</span><span class="s3">\n  </span><span class="s1">buildId: string</span><span class="s3">\n  </span><span class="s1">getServerInsertedHTML: () =&gt; Promise&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">getServerInsertedMetadata: () =&gt; Promise&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">validateRootLayout?: boolean</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Suffix to inject after the buffered data, but before the close tags.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">suffix?: string | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function continueFizzStream(</span><span class="s3">\n  </span><span class="s1">renderStream: ReactDOMServerReadableStream,</span><span class="s3">\n  </span><span class="s1">{</span><span class="s3">\n    </span><span class="s1">suffix,</span><span class="s3">\n    </span><span class="s1">inlinedDataStream,</span><span class="s3">\n    </span><span class="s1">isStaticGeneration,</span><span class="s3">\n    </span><span class="s1">isBuildTimePrerendering,</span><span class="s3">\n    </span><span class="s1">buildId,</span><span class="s3">\n    </span><span class="s1">getServerInsertedHTML,</span><span class="s3">\n    </span><span class="s1">getServerInsertedMetadata,</span><span class="s3">\n    </span><span class="s1">validateRootLayout,</span><span class="s3">\n  </span><span class="s1">}: ContinueStreamOptions</span><span class="s3">\n</span><span class="s1">): Promise&lt;ReadableStream&lt;Uint8Array&gt;&gt; {</span><span class="s3">\n  </span><span class="s1">// Suffix itself might contain close tags at the end, so we need to split it.</span><span class="s3">\n  </span><span class="s1">const suffixUnclosed = suffix ? suffix.split(CLOSE_TAG, 1)[0] : null</span><span class="s3">\n\n  </span><span class="s1">// If we're generating static HTML we need to wait for it to resolve before continuing.</span><span class="s3">\n  </span><span class="s1">if (isStaticGeneration) {</span><span class="s3">\n    </span><span class="s1">await renderStream.allReady</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return chainTransformers(renderStream, [</span><span class="s3">\n    </span><span class="s1">// Buffer everything to avoid flushing too frequently</span><span class="s3">\n    </span><span class="s1">createBufferedTransformStream(),</span><span class="s3">\n\n    </span><span class="s1">// Add build id comment to start of the HTML document (in export mode)</span><span class="s3">\n    </span><span class="s1">createPrefetchCommentStream(isBuildTimePrerendering, buildId),</span><span class="s3">\n\n    </span><span class="s1">// Transform metadata</span><span class="s3">\n    </span><span class="s1">createMetadataTransformStream(getServerInsertedMetadata),</span><span class="s3">\n\n    </span><span class="s1">// Insert suffix content</span><span class="s3">\n    </span><span class="s1">suffixUnclosed != null &amp;&amp; suffixUnclosed.length &gt; 0</span><span class="s3">\n      </span><span class="s1">? createDeferredSuffixStream(suffixUnclosed)</span><span class="s3">\n      </span><span class="s1">: null,</span><span class="s3">\n\n    </span><span class="s1">// Insert the inlined data (Flight data, form state, etc.) stream into the HTML</span><span class="s3">\n    </span><span class="s1">inlinedDataStream</span><span class="s3">\n      </span><span class="s1">? createFlightDataInjectionTransformStream(inlinedDataStream, true)</span><span class="s3">\n      </span><span class="s1">: null,</span><span class="s3">\n\n    </span><span class="s1">// Validate the root layout for missing html or body tags</span><span class="s3">\n    </span><span class="s1">validateRootLayout ? createRootLayoutValidatorStream() : null,</span><span class="s3">\n\n    </span><span class="s1">// Close tags should always be deferred to the end</span><span class="s3">\n    </span><span class="s1">createMoveSuffixStream(),</span><span class="s3">\n\n    </span><span class="s1">// Special head insertions</span><span class="s3">\n    </span><span class="s1">// TODO-APP: Insert server side html to end of head in app layout rendering, to avoid</span><span class="s3">\n    </span><span class="s1">// hydration errors. Remove this once it's ready to be handled by react itself.</span><span class="s3">\n    </span><span class="s1">createHeadInsertionTransformStream(getServerInsertedHTML),</span><span class="s3">\n  </span><span class="s1">])</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type ContinueDynamicPrerenderOptions = {</span><span class="s3">\n  </span><span class="s1">getServerInsertedHTML: () =&gt; Promise&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">getServerInsertedMetadata: () =&gt; Promise&lt;string&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function continueDynamicPrerender(</span><span class="s3">\n  </span><span class="s1">prerenderStream: ReadableStream&lt;Uint8Array&gt;,</span><span class="s3">\n  </span><span class="s1">{</span><span class="s3">\n    </span><span class="s1">getServerInsertedHTML,</span><span class="s3">\n    </span><span class="s1">getServerInsertedMetadata,</span><span class="s3">\n  </span><span class="s1">}: ContinueDynamicPrerenderOptions</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">prerenderStream</span><span class="s3">\n      </span><span class="s1">// Buffer everything to avoid flushing too frequently</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createBufferedTransformStream())</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createStripDocumentClosingTagsTransform())</span><span class="s3">\n      </span><span class="s1">// Insert generated tags to head</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createHeadInsertionTransformStream(getServerInsertedHTML))</span><span class="s3">\n      </span><span class="s1">// Transform metadata</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createMetadataTransformStream(getServerInsertedMetadata))</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type ContinueStaticPrerenderOptions = {</span><span class="s3">\n  </span><span class="s1">inlinedDataStream: ReadableStream&lt;Uint8Array&gt;</span><span class="s3">\n  </span><span class="s1">getServerInsertedHTML: () =&gt; Promise&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">getServerInsertedMetadata: () =&gt; Promise&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">isBuildTimePrerendering: boolean</span><span class="s3">\n  </span><span class="s1">buildId: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function continueStaticPrerender(</span><span class="s3">\n  </span><span class="s1">prerenderStream: ReadableStream&lt;Uint8Array&gt;,</span><span class="s3">\n  </span><span class="s1">{</span><span class="s3">\n    </span><span class="s1">inlinedDataStream,</span><span class="s3">\n    </span><span class="s1">getServerInsertedHTML,</span><span class="s3">\n    </span><span class="s1">getServerInsertedMetadata,</span><span class="s3">\n    </span><span class="s1">isBuildTimePrerendering,</span><span class="s3">\n    </span><span class="s1">buildId,</span><span class="s3">\n  </span><span class="s1">}: ContinueStaticPrerenderOptions</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">prerenderStream</span><span class="s3">\n      </span><span class="s1">// Buffer everything to avoid flushing too frequently</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createBufferedTransformStream())</span><span class="s3">\n      </span><span class="s1">// Add build id comment to start of the HTML document (in export mode)</span><span class="s3">\n      </span><span class="s1">.pipeThrough(</span><span class="s3">\n        </span><span class="s1">createPrefetchCommentStream(isBuildTimePrerendering, buildId)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">// Insert generated tags to head</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createHeadInsertionTransformStream(getServerInsertedHTML))</span><span class="s3">\n      </span><span class="s1">// Transform metadata</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createMetadataTransformStream(getServerInsertedMetadata))</span><span class="s3">\n      </span><span class="s1">// Insert the inlined data (Flight data, form state, etc.) stream into the HTML</span><span class="s3">\n      </span><span class="s1">.pipeThrough(</span><span class="s3">\n        </span><span class="s1">createFlightDataInjectionTransformStream(inlinedDataStream, true)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">// Close tags should always be deferred to the end</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createMoveSuffixStream())</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type ContinueResumeOptions = {</span><span class="s3">\n  </span><span class="s1">inlinedDataStream: ReadableStream&lt;Uint8Array&gt;</span><span class="s3">\n  </span><span class="s1">getServerInsertedHTML: () =&gt; Promise&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">getServerInsertedMetadata: () =&gt; Promise&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">delayDataUntilFirstHtmlChunk: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function continueDynamicHTMLResume(</span><span class="s3">\n  </span><span class="s1">renderStream: ReadableStream&lt;Uint8Array&gt;,</span><span class="s3">\n  </span><span class="s1">{</span><span class="s3">\n    </span><span class="s1">delayDataUntilFirstHtmlChunk,</span><span class="s3">\n    </span><span class="s1">inlinedDataStream,</span><span class="s3">\n    </span><span class="s1">getServerInsertedHTML,</span><span class="s3">\n    </span><span class="s1">getServerInsertedMetadata,</span><span class="s3">\n  </span><span class="s1">}: ContinueResumeOptions</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">renderStream</span><span class="s3">\n      </span><span class="s1">// Buffer everything to avoid flushing too frequently</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createBufferedTransformStream())</span><span class="s3">\n      </span><span class="s1">// Insert generated tags to head</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createHeadInsertionTransformStream(getServerInsertedHTML))</span><span class="s3">\n      </span><span class="s1">// Transform metadata</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createMetadataTransformStream(getServerInsertedMetadata))</span><span class="s3">\n      </span><span class="s1">// Insert the inlined data (Flight data, form state, etc.) stream into the HTML</span><span class="s3">\n      </span><span class="s1">.pipeThrough(</span><span class="s3">\n        </span><span class="s1">createFlightDataInjectionTransformStream(</span><span class="s3">\n          </span><span class="s1">inlinedDataStream,</span><span class="s3">\n          </span><span class="s1">delayDataUntilFirstHtmlChunk</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">// Close tags should always be deferred to the end</span><span class="s3">\n      </span><span class="s1">.pipeThrough(createMoveSuffixStream())</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createDocumentClosingStream(): ReadableStream&lt;Uint8Array&gt; {</span><span class="s3">\n  </span><span class="s1">return streamFromString(CLOSE_TAG)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getTracer&quot;</span><span class="s0">,</span><span class="s1">&quot;AppRenderSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;DetachedPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;scheduleImmediate&quot;</span><span class="s0">,</span><span class="s1">&quot;atLeastOneTask&quot;</span><span class="s0">,</span><span class="s1">&quot;ENCODED_TAGS&quot;</span><span class="s0">,</span><span class="s1">&quot;indexOfUint8Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isEquivalentUint8Arrays&quot;</span><span class="s0">,</span><span class="s1">&quot;removeFromUint8Array&quot;</span><span class="s0">,</span><span class="s1">&quot;MISSING_ROOT_TAGS_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;insertBuildIdComment&quot;</span><span class="s0">,</span><span class="s1">&quot;voidCatch&quot;</span><span class="s0">,</span><span class="s1">&quot;encoder&quot;</span><span class="s0">,</span><span class="s1">&quot;TextEncoder&quot;</span><span class="s0">,</span><span class="s1">&quot;chainStreams&quot;</span><span class="s0">,</span><span class="s1">&quot;streams&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;ReadableStream&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;controller&quot;</span><span class="s0">,</span><span class="s1">&quot;close&quot;</span><span class="s0">,</span><span class="s1">&quot;readable&quot;</span><span class="s0">,</span><span class="s1">&quot;writable&quot;</span><span class="s0">,</span><span class="s1">&quot;TransformStream&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;pipeTo&quot;</span><span class="s0">,</span><span class="s1">&quot;preventClose&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;nextStream&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;lastStream&quot;</span><span class="s0">,</span><span class="s1">&quot;catch&quot;</span><span class="s0">,</span><span class="s1">&quot;streamFromString&quot;</span><span class="s0">,</span><span class="s1">&quot;str&quot;</span><span class="s0">,</span><span class="s1">&quot;enqueue&quot;</span><span class="s0">,</span><span class="s1">&quot;encode&quot;</span><span class="s0">,</span><span class="s1">&quot;streamFromBuffer&quot;</span><span class="s0">,</span><span class="s1">&quot;chunk&quot;</span><span class="s0">,</span><span class="s1">&quot;streamToBuffer&quot;</span><span class="s0">,</span><span class="s1">&quot;stream&quot;</span><span class="s0">,</span><span class="s1">&quot;reader&quot;</span><span class="s0">,</span><span class="s1">&quot;getReader&quot;</span><span class="s0">,</span><span class="s1">&quot;chunks&quot;</span><span class="s0">,</span><span class="s1">&quot;done&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;read&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;Buffer&quot;</span><span class="s0">,</span><span class="s1">&quot;concat&quot;</span><span class="s0">,</span><span class="s1">&quot;streamToString&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;decoder&quot;</span><span class="s0">,</span><span class="s1">&quot;TextDecoder&quot;</span><span class="s0">,</span><span class="s1">&quot;fatal&quot;</span><span class="s0">,</span><span class="s1">&quot;string&quot;</span><span class="s0">,</span><span class="s1">&quot;aborted&quot;</span><span class="s0">,</span><span class="s1">&quot;decode&quot;</span><span class="s0">,</span><span class="s1">&quot;createBufferedTransformStream&quot;</span><span class="s0">,</span><span class="s1">&quot;bufferedChunks&quot;</span><span class="s0">,</span><span class="s1">&quot;bufferByteLength&quot;</span><span class="s0">,</span><span class="s1">&quot;pending&quot;</span><span class="s0">,</span><span class="s1">&quot;flush&quot;</span><span class="s0">,</span><span class="s1">&quot;detached&quot;</span><span class="s0">,</span><span class="s1">&quot;Uint8Array&quot;</span><span class="s0">,</span><span class="s1">&quot;copiedBytes&quot;</span><span class="s0">,</span><span class="s1">&quot;bufferedChunk&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;byteLength&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;transform&quot;</span><span class="s0">,</span><span class="s1">&quot;createPrefetchCommentStream&quot;</span><span class="s0">,</span><span class="s1">&quot;isBuildTimePrerendering&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;didTransformFirstChunk&quot;</span><span class="s0">,</span><span class="s1">&quot;chunkStr&quot;</span><span class="s0">,</span><span class="s1">&quot;updatedChunkStr&quot;</span><span class="s0">,</span><span class="s1">&quot;renderToInitialFizzStream&quot;</span><span class="s0">,</span><span class="s1">&quot;ReactDOMServer&quot;</span><span class="s0">,</span><span class="s1">&quot;element&quot;</span><span class="s0">,</span><span class="s1">&quot;streamOptions&quot;</span><span class="s0">,</span><span class="s1">&quot;trace&quot;</span><span class="s0">,</span><span class="s1">&quot;renderToReadableStream&quot;</span><span class="s0">,</span><span class="s1">&quot;createMetadataTransformStream&quot;</span><span class="s0">,</span><span class="s1">&quot;insert&quot;</span><span class="s0">,</span><span class="s1">&quot;chunkIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;isMarkRemoved&quot;</span><span class="s0">,</span><span class="s1">&quot;iconMarkIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;closedHeadIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;iconMarkLength&quot;</span><span class="s0">,</span><span class="s1">&quot;META&quot;</span><span class="s0">,</span><span class="s1">&quot;ICON_MARK&quot;</span><span class="s0">,</span><span class="s1">&quot;CLOSED&quot;</span><span class="s0">,</span><span class="s1">&quot;HEAD&quot;</span><span class="s0">,</span><span class="s1">&quot;replaced&quot;</span><span class="s0">,</span><span class="s1">&quot;subarray&quot;</span><span class="s0">,</span><span class="s1">&quot;insertion&quot;</span><span class="s0">,</span><span class="s1">&quot;encodedInsertion&quot;</span><span class="s0">,</span><span class="s1">&quot;insertionLength&quot;</span><span class="s0">,</span><span class="s1">&quot;createHeadInsertionTransformStream&quot;</span><span class="s0">,</span><span class="s1">&quot;inserted&quot;</span><span class="s0">,</span><span class="s1">&quot;hasBytes&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;insertedHeadContent&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;createDeferredSuffixStream&quot;</span><span class="s0">,</span><span class="s1">&quot;suffix&quot;</span><span class="s0">,</span><span class="s1">&quot;flushed&quot;</span><span class="s0">,</span><span class="s1">&quot;createFlightDataInjectionTransformStream&quot;</span><span class="s0">,</span><span class="s1">&quot;delayDataUntilFirstHtmlChunk&quot;</span><span class="s0">,</span><span class="s1">&quot;htmlStreamFinished&quot;</span><span class="s0">,</span><span class="s1">&quot;pull&quot;</span><span class="s0">,</span><span class="s1">&quot;donePulling&quot;</span><span class="s0">,</span><span class="s1">&quot;startOrContinuePulling&quot;</span><span class="s0">,</span><span class="s1">&quot;startPulling&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;CLOSE_TAG&quot;</span><span class="s0">,</span><span class="s1">&quot;createMoveSuffixStream&quot;</span><span class="s0">,</span><span class="s1">&quot;foundSuffix&quot;</span><span class="s0">,</span><span class="s1">&quot;BODY_AND_HTML&quot;</span><span class="s0">,</span><span class="s1">&quot;before&quot;</span><span class="s0">,</span><span class="s1">&quot;after&quot;</span><span class="s0">,</span><span class="s1">&quot;createStripDocumentClosingTagsTransform&quot;</span><span class="s0">,</span><span class="s1">&quot;BODY&quot;</span><span class="s0">,</span><span class="s1">&quot;HTML&quot;</span><span class="s0">,</span><span class="s1">&quot;createRootLayoutValidatorStream&quot;</span><span class="s0">,</span><span class="s1">&quot;foundHtml&quot;</span><span class="s0">,</span><span class="s1">&quot;foundBody&quot;</span><span class="s0">,</span><span class="s1">&quot;OPENING&quot;</span><span class="s0">,</span><span class="s1">&quot;missingTags&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;c&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;chainTransformers&quot;</span><span class="s0">,</span><span class="s1">&quot;transformers&quot;</span><span class="s0">,</span><span class="s1">&quot;transformer&quot;</span><span class="s0">,</span><span class="s1">&quot;pipeThrough&quot;</span><span class="s0">,</span><span class="s1">&quot;continueFizzStream&quot;</span><span class="s0">,</span><span class="s1">&quot;renderStream&quot;</span><span class="s0">,</span><span class="s1">&quot;inlinedDataStream&quot;</span><span class="s0">,</span><span class="s1">&quot;isStaticGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;getServerInsertedHTML&quot;</span><span class="s0">,</span><span class="s1">&quot;getServerInsertedMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;validateRootLayout&quot;</span><span class="s0">,</span><span class="s1">&quot;suffixUnclosed&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;allReady&quot;</span><span class="s0">,</span><span class="s1">&quot;continueDynamicPrerender&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderStream&quot;</span><span class="s0">,</span><span class="s1">&quot;continueStaticPrerender&quot;</span><span class="s0">,</span><span class="s1">&quot;continueDynamicHTMLResume&quot;</span><span class="s0">,</span><span class="s1">&quot;createDocumentClosingStream&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4224</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/request-meta.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/* eslint-disable no-redeclare */</span><span class="s3">\n</span><span class="s1">import type { IncomingMessage } from 'http'</span><span class="s3">\n</span><span class="s1">import type { ParsedUrlQuery } from 'querystring'</span><span class="s3">\n</span><span class="s1">import type { UrlWithParsedQuery } from 'url'</span><span class="s3">\n</span><span class="s1">import type { BaseNextRequest } from './base-http'</span><span class="s3">\n</span><span class="s1">import type { CloneableBody } from './body-streams'</span><span class="s3">\n</span><span class="s1">import type { RouteMatch } from './route-matches/route-match'</span><span class="s3">\n</span><span class="s1">import type { NEXT_RSC_UNION_QUERY } from '../client/components/app-router-headers'</span><span class="s3">\n</span><span class="s1">import type { ServerComponentsHmrCache } from './response-cache'</span><span class="s3">\n</span><span class="s1">import type { PagesDevOverlayBridgeType } from '../next-devtools/userspace/pages/pages-dev-overlay-setup'</span><span class="s3">\n\n</span><span class="s1">// FIXME: (wyattjoh) this is a temporary solution to allow us to pass data between bundled modules</span><span class="s3">\n</span><span class="s1">export const NEXT_REQUEST_META = Symbol.for('NextInternalRequestMeta')</span><span class="s3">\n\n</span><span class="s1">export type NextIncomingMessage = (BaseNextRequest | IncomingMessage) &amp; {</span><span class="s3">\n  </span><span class="s1">[NEXT_REQUEST_META]?: RequestMeta</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface RequestMeta {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The query that was used to make the request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">initQuery?: ParsedUrlQuery</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The URL that was used to make the request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">initURL?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The protocol that was used to make the request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">initProtocol?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The body that was read from the request. This is used to allow the body to</span><span class="s3">\n   </span><span class="s1">* be read multiple times.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">clonableBody?: CloneableBody</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* True when the request matched a locale domain that was configured in the</span><span class="s3">\n   </span><span class="s1">* next.config.js file.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">isLocaleDomain?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* True when the request had locale information stripped from the pathname</span><span class="s3">\n   </span><span class="s1">* part of the URL.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">didStripLocale?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If the request had it's URL rewritten, this is the URL it was rewritten to.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">rewroteURL?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The cookies that were added by middleware and were added to the response.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">middlewareCookie?: string[]</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The match on the request for a given route.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">match?: RouteMatch</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The incremental cache to use for the request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">incrementalCache?: any</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The server components HMR cache, only for dev.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">serverComponentsHmrCache?: ServerComponentsHmrCache</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Equals the segment path that was used for the prefetch RSC request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">segmentPrefetchRSCRequest?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* True when the request is for the prefetch flight data.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">isPrefetchRSCRequest?: true</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* True when the request is for the flight data.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">isRSCRequest?: true</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* A search param set by the Next.js client when performing RSC requests.</span><span class="s3">\n   </span><span class="s1">* Because some CDNs do not vary their cache entries on our custom headers,</span><span class="s3">\n   </span><span class="s1">* this search param represents a hash of the header values. For any cached</span><span class="s3">\n   </span><span class="s1">* RSC request, we should verify that the hash matches before responding.</span><span class="s3">\n   </span><span class="s1">* Otherwise this can lead to cache poisoning.</span><span class="s3">\n   </span><span class="s1">* TODO: Consider not using custom request headers at all, and instead encode</span><span class="s3">\n   </span><span class="s1">* everything into the search param.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">cacheBustingSearchParam?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* True when the request is for the `/_next/data` route using the pages</span><span class="s3">\n   </span><span class="s1">* router.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">isNextDataReq?: true</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Postponed state to use for resumption. If present it's assumed that the</span><span class="s3">\n   </span><span class="s1">* request is for a page that has postponed (there are no guarantees that the</span><span class="s3">\n   </span><span class="s1">* page actually has postponed though as it would incur an additional cache</span><span class="s3">\n   </span><span class="s1">* lookup).</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">postponed?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If provided, this will be called when a response cache entry was generated</span><span class="s3">\n   </span><span class="s1">* or looked up in the cache.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">onCacheEntry?: (</span><span class="s3">\n    </span><span class="s1">cacheEntry: any,</span><span class="s3">\n    </span><span class="s1">requestMeta: any</span><span class="s3">\n  </span><span class="s1">) =&gt; Promise&lt;boolean | void&gt; | boolean | void</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The previous revalidate before rendering 404 page for notFound: true</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">notFoundRevalidate?: number | false</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* In development, the original source page that returned a 404.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">developmentNotFoundSourcePage?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The path we routed to and should be invoked</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">invokePath?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The specific page output we should be matching</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">invokeOutput?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The status we are invoking the request with from routing</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">invokeStatus?: number</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The routing error we are invoking with</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">invokeError?: Error</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The query parsed for the invocation</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">invokeQuery?: Record&lt;string, undefined | string | string[]&gt;</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether the request is a middleware invocation</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">middlewareInvoke?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether the request should render the fallback shell or not.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">renderFallbackShell?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether the request is for the custom error page.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">customErrorRender?: true</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether to bubble up the NoFallbackError to the caller when a 404 is</span><span class="s3">\n   </span><span class="s1">* returned.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">bubbleNoFallback?: true</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* True when the request had locale information inferred from the default</span><span class="s3">\n   </span><span class="s1">* locale.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">localeInferredFromDefault?: true</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The locale that was inferred or explicitly set for the request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">locale?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The default locale that was inferred or explicitly set for the request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">defaultLocale?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The relative project dir the server is running in from project root</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">relativeProjectDir?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The dist directory the server is currently using</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">distDir?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The query after resolving routes</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">query?: ParsedUrlQuery</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The params after resolving routes</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">params?: ParsedUrlQuery</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The AMP validator to use in development</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">ampValidator?: (html: string, pathname: string) =&gt; Promise&lt;void&gt;</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* ErrorOverlay component to use in development for pages router</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">PagesErrorDebug?: PagesDevOverlayBridgeType</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether server is in minimal mode (this will be replaced with more</span><span class="s3">\n   </span><span class="s1">* specific flags in future)</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">minimalMode?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* DEV only: The fallback params that should be used when validating prerenders during dev</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">devValidatingFallbackParams?: Map&lt;string, string&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Gets the request metadata. If no key is provided, the entire metadata object</span><span class="s3">\n </span><span class="s1">* is returned.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param req the request to get the metadata from</span><span class="s3">\n </span><span class="s1">* @param key the key to get from the metadata (optional)</span><span class="s3">\n </span><span class="s1">* @returns the value for the key or the entire metadata object</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function getRequestMeta(</span><span class="s3">\n  </span><span class="s1">req: NextIncomingMessage,</span><span class="s3">\n  </span><span class="s1">key?: undefined</span><span class="s3">\n</span><span class="s1">): RequestMeta</span><span class="s3">\n</span><span class="s1">export function getRequestMeta&lt;K extends keyof RequestMeta&gt;(</span><span class="s3">\n  </span><span class="s1">req: NextIncomingMessage,</span><span class="s3">\n  </span><span class="s1">key: K</span><span class="s3">\n</span><span class="s1">): RequestMeta[K]</span><span class="s3">\n</span><span class="s1">export function getRequestMeta&lt;K extends keyof RequestMeta&gt;(</span><span class="s3">\n  </span><span class="s1">req: NextIncomingMessage,</span><span class="s3">\n  </span><span class="s1">key?: K</span><span class="s3">\n</span><span class="s1">): RequestMeta | RequestMeta[K] {</span><span class="s3">\n  </span><span class="s1">const meta = req[NEXT_REQUEST_META] || {}</span><span class="s3">\n  </span><span class="s1">return typeof key === 'string' ? meta[key] : meta</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Sets the request metadata.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param req the request to set the metadata on</span><span class="s3">\n </span><span class="s1">* @param meta the metadata to set</span><span class="s3">\n </span><span class="s1">* @returns the mutated request metadata</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function setRequestMeta(req: NextIncomingMessage, meta: RequestMeta) {</span><span class="s3">\n  </span><span class="s1">req[NEXT_REQUEST_META] = meta</span><span class="s3">\n  </span><span class="s1">return meta</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Adds a value to the request metadata.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param request the request to mutate</span><span class="s3">\n </span><span class="s1">* @param key the key to set</span><span class="s3">\n </span><span class="s1">* @param value the value to set</span><span class="s3">\n </span><span class="s1">* @returns the mutated request metadata</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function addRequestMeta&lt;K extends keyof RequestMeta&gt;(</span><span class="s3">\n  </span><span class="s1">request: NextIncomingMessage,</span><span class="s3">\n  </span><span class="s1">key: K,</span><span class="s3">\n  </span><span class="s1">value: RequestMeta[K]</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const meta = getRequestMeta(request)</span><span class="s3">\n  </span><span class="s1">meta[key] = value</span><span class="s3">\n  </span><span class="s1">return setRequestMeta(request, meta)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Removes a key from the request metadata.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param request the request to mutate</span><span class="s3">\n </span><span class="s1">* @param key the key to remove</span><span class="s3">\n </span><span class="s1">* @returns the mutated request metadata</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function removeRequestMeta&lt;K extends keyof RequestMeta&gt;(</span><span class="s3">\n  </span><span class="s1">request: NextIncomingMessage,</span><span class="s3">\n  </span><span class="s1">key: K</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const meta = getRequestMeta(request)</span><span class="s3">\n  </span><span class="s1">delete meta[key]</span><span class="s3">\n  </span><span class="s1">return setRequestMeta(request, meta)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type NextQueryMetadata = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The `_rsc` query parameter used for cache busting to ensure that the RSC</span><span class="s3">\n   </span><span class="s1">* requests do not get cached by the browser explicitly.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">[NEXT_RSC_UNION_QUERY]?: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type NextParsedUrlQuery = ParsedUrlQuery &amp;</span><span class="s3">\n  </span><span class="s1">NextQueryMetadata &amp; {</span><span class="s3">\n    </span><span class="s1">amp?: '1'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface NextUrlWithParsedQuery extends UrlWithParsedQuery {</span><span class="s3">\n  </span><span class="s1">query: NextParsedUrlQuery</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;NEXT_REQUEST_META&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;for&quot;</span><span class="s0">,</span><span class="s1">&quot;getRequestMeta&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;meta&quot;</span><span class="s0">,</span><span class="s1">&quot;setRequestMeta&quot;</span><span class="s0">,</span><span class="s1">&quot;addRequestMeta&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;removeRequestMeta&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,+BAA+B,GAW/B,kGAAkG;;;;;;;;;;;;;AAC3F,MAAMA,oBAAoBC,OAAOC,GAAG,CAAC,2BAA0B;AAoP/D,SAASC,eACdC,GAAwB,EACxBC,GAAO;IAEP,MAAMC,OAAOF,GAAG,CAACJ,kBAAkB,IAAI,CAAC;IACxC,OAAO,OAAOK,QAAQ,WAAWC,IAAI,CAACD,IAAI,GAAGC;AAC/C;AASO,SAASC,eAAeH,GAAwB,EAAEE,IAAiB;IACxEF,GAAG,CAACJ,kBAAkB,GAAGM;IACzB,OAAOA;AACT;AAUO,SAASE,eACdC,OAA4B,EAC5BJ,GAAM,EACNK,KAAqB;IAErB,MAAMJ,OAAOH,eAAeM;IAC5BH,IAAI,CAACD,IAAI,GAAGK;IACZ,OAAOH,eAAeE,SAASH;AACjC;AASO,SAASK,kBACdF,OAA4B,EAC5BJ,GAAM;IAEN,MAAMC,OAAOH,eAAeM;IAC5B,OAAOH,IAAI,CAACD,IAAI;IAChB,OAAOE,eAAeE,SAASH;AACjC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4260</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/web/utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { OutgoingHttpHeaders } from 'http'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">NEXT_INTERCEPTION_MARKER_PREFIX,</span><span class="s3">\n  </span><span class="s1">NEXT_QUERY_PARAM_PREFIX,</span><span class="s3">\n</span><span class="s1">} from '../../lib/constants'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Converts a Node.js IncomingHttpHeaders object to a Headers object. Any</span><span class="s3">\n </span><span class="s1">* headers with multiple values will be joined with a comma and space. Any</span><span class="s3">\n </span><span class="s1">* headers that have an undefined value will be ignored and others will be</span><span class="s3">\n </span><span class="s1">* coerced to strings.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param nodeHeaders the headers object to convert</span><span class="s3">\n </span><span class="s1">* @returns the converted headers object</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function fromNodeOutgoingHttpHeaders(</span><span class="s3">\n  </span><span class="s1">nodeHeaders: OutgoingHttpHeaders</span><span class="s3">\n</span><span class="s1">): Headers {</span><span class="s3">\n  </span><span class="s1">const headers = new Headers()</span><span class="s3">\n  </span><span class="s1">for (let [key, value] of Object.entries(nodeHeaders)) {</span><span class="s3">\n    </span><span class="s1">const values = Array.isArray(value) ? value : [value]</span><span class="s3">\n    </span><span class="s1">for (let v of values) {</span><span class="s3">\n      </span><span class="s1">if (typeof v === 'undefined') continue</span><span class="s3">\n      </span><span class="s1">if (typeof v === 'number') {</span><span class="s3">\n        </span><span class="s1">v = v.toString()</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">headers.append(key, v)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return headers</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/*</span><span class="s3">\n  </span><span class="s1">Set-Cookie header field-values are sometimes comma joined in one string. This splits them without choking on commas</span><span class="s3">\n  </span><span class="s1">that are within a single set-cookie field-value, such as in the Expires portion.</span><span class="s3">\n  </span><span class="s1">This is uncommon, but explicitly allowed - see https://tools.ietf.org/html/rfc2616#section-4.2</span><span class="s3">\n  </span><span class="s1">Node.js does this for every header *except* set-cookie - see https://github.com/nodejs/node/blob/d5e363b77ebaf1caf67cd7528224b651c86815c1/lib/_http_incoming.js#L128</span><span class="s3">\n  </span><span class="s1">React Native's fetch does this for *every* header, including set-cookie.</span><span class="s3">\n  \n  </span><span class="s1">Based on: https://github.com/google/j2objc/commit/16820fdbc8f76ca0c33472810ce0cb03d20efe25</span><span class="s3">\n  </span><span class="s1">Credits to: https://github.com/tomball for original and https://github.com/chrusart for JavaScript implementation</span><span class="s3">\n</span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function splitCookiesString(cookiesString: string) {</span><span class="s3">\n  </span><span class="s1">var cookiesStrings = []</span><span class="s3">\n  </span><span class="s1">var pos = 0</span><span class="s3">\n  </span><span class="s1">var start</span><span class="s3">\n  </span><span class="s1">var ch</span><span class="s3">\n  </span><span class="s1">var lastComma</span><span class="s3">\n  </span><span class="s1">var nextStart</span><span class="s3">\n  </span><span class="s1">var cookiesSeparatorFound</span><span class="s3">\n\n  </span><span class="s1">function skipWhitespace() {</span><span class="s3">\n    </span><span class="s1">while (pos &lt; cookiesString.length &amp;&amp; /</span><span class="s3">\\</span><span class="s1">s/.test(cookiesString.charAt(pos))) {</span><span class="s3">\n      </span><span class="s1">pos += 1</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return pos &lt; cookiesString.length</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">function notSpecialChar() {</span><span class="s3">\n    </span><span class="s1">ch = cookiesString.charAt(pos)</span><span class="s3">\n\n    </span><span class="s1">return ch !== '=' &amp;&amp; ch !== ';' &amp;&amp; ch !== ','</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">while (pos &lt; cookiesString.length) {</span><span class="s3">\n    </span><span class="s1">start = pos</span><span class="s3">\n    </span><span class="s1">cookiesSeparatorFound = false</span><span class="s3">\n\n    </span><span class="s1">while (skipWhitespace()) {</span><span class="s3">\n      </span><span class="s1">ch = cookiesString.charAt(pos)</span><span class="s3">\n      </span><span class="s1">if (ch === ',') {</span><span class="s3">\n        </span><span class="s1">// ',' is a cookie separator if we have later first '=', not ';' or ','</span><span class="s3">\n        </span><span class="s1">lastComma = pos</span><span class="s3">\n        </span><span class="s1">pos += 1</span><span class="s3">\n\n        </span><span class="s1">skipWhitespace()</span><span class="s3">\n        </span><span class="s1">nextStart = pos</span><span class="s3">\n\n        </span><span class="s1">while (pos &lt; cookiesString.length &amp;&amp; notSpecialChar()) {</span><span class="s3">\n          </span><span class="s1">pos += 1</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// currently special character</span><span class="s3">\n        </span><span class="s1">if (pos &lt; cookiesString.length &amp;&amp; cookiesString.charAt(pos) === '=') {</span><span class="s3">\n          </span><span class="s1">// we found cookies separator</span><span class="s3">\n          </span><span class="s1">cookiesSeparatorFound = true</span><span class="s3">\n          </span><span class="s1">// pos is inside the next cookie, so back up and return it.</span><span class="s3">\n          </span><span class="s1">pos = nextStart</span><span class="s3">\n          </span><span class="s1">cookiesStrings.push(cookiesString.substring(start, lastComma))</span><span class="s3">\n          </span><span class="s1">start = pos</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">// in param ',' or param separator ';',</span><span class="s3">\n          </span><span class="s1">// we continue from that comma</span><span class="s3">\n          </span><span class="s1">pos = lastComma + 1</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">pos += 1</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (!cookiesSeparatorFound || pos &gt;= cookiesString.length) {</span><span class="s3">\n      </span><span class="s1">cookiesStrings.push(cookiesString.substring(start, cookiesString.length))</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return cookiesStrings</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Converts a Headers object to a Node.js OutgoingHttpHeaders object. This is</span><span class="s3">\n </span><span class="s1">* required to support the set-cookie header, which may have multiple values.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param headers the headers object to convert</span><span class="s3">\n </span><span class="s1">* @returns the converted headers object</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function toNodeOutgoingHttpHeaders(</span><span class="s3">\n  </span><span class="s1">headers: Headers</span><span class="s3">\n</span><span class="s1">): OutgoingHttpHeaders {</span><span class="s3">\n  </span><span class="s1">const nodeHeaders: OutgoingHttpHeaders = {}</span><span class="s3">\n  </span><span class="s1">const cookies: string[] = []</span><span class="s3">\n  </span><span class="s1">if (headers) {</span><span class="s3">\n    </span><span class="s1">for (const [key, value] of headers.entries()) {</span><span class="s3">\n      </span><span class="s1">if (key.toLowerCase() === 'set-cookie') {</span><span class="s3">\n        </span><span class="s1">// We may have gotten a comma joined string of cookies, or multiple</span><span class="s3">\n        </span><span class="s1">// set-cookie headers. We need to merge them into one header array</span><span class="s3">\n        </span><span class="s1">// to represent all the cookies.</span><span class="s3">\n        </span><span class="s1">cookies.push(...splitCookiesString(value))</span><span class="s3">\n        </span><span class="s1">nodeHeaders[key] = cookies.length === 1 ? cookies[0] : cookies</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">nodeHeaders[key] = value</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return nodeHeaders</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Validate the correctness of a user-provided URL.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function validateURL(url: string | URL): string {</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">return String(new URL(String(url)))</span><span class="s3">\n  </span><span class="s1">} catch (error: any) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`URL is malformed </span><span class="s3">\&quot;</span><span class="s1">${String(</span><span class="s3">\n        </span><span class="s1">url</span><span class="s3">\n      </span><span class="s1">)}</span><span class="s3">\&quot;</span><span class="s1">. Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,</span><span class="s3">\n      </span><span class="s1">{ cause: error }</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Normalizes `nxtP` and `nxtI` query param values to remove the prefix.</span><span class="s3">\n </span><span class="s1">* This function does not mutate the input key.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeNextQueryParam(key: string): null | string {</span><span class="s3">\n  </span><span class="s1">const prefixes = [NEXT_QUERY_PARAM_PREFIX, NEXT_INTERCEPTION_MARKER_PREFIX]</span><span class="s3">\n  </span><span class="s1">for (const prefix of prefixes) {</span><span class="s3">\n    </span><span class="s1">if (key !== prefix &amp;&amp; key.startsWith(prefix)) {</span><span class="s3">\n      </span><span class="s1">return key.substring(prefix.length)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;NEXT_INTERCEPTION_MARKER_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_QUERY_PARAM_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;fromNodeOutgoingHttpHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;nodeHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;Headers&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;v&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;append&quot;</span><span class="s0">,</span><span class="s1">&quot;splitCookiesString&quot;</span><span class="s0">,</span><span class="s1">&quot;cookiesString&quot;</span><span class="s0">,</span><span class="s1">&quot;cookiesStrings&quot;</span><span class="s0">,</span><span class="s1">&quot;pos&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;ch&quot;</span><span class="s0">,</span><span class="s1">&quot;lastComma&quot;</span><span class="s0">,</span><span class="s1">&quot;nextStart&quot;</span><span class="s0">,</span><span class="s1">&quot;cookiesSeparatorFound&quot;</span><span class="s0">,</span><span class="s1">&quot;skipWhitespace&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;charAt&quot;</span><span class="s0">,</span><span class="s1">&quot;notSpecialChar&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;substring&quot;</span><span class="s0">,</span><span class="s1">&quot;toNodeOutgoingHttpHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;cookies&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;validateURL&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;cause&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeNextQueryParam&quot;</span><span class="s0">,</span><span class="s1">&quot;prefixes&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4392</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/i18n/detect-domain-locale.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { DomainLocale } from '../../../server/config-shared'</span><span class="s3">\n\n</span><span class="s1">export function detectDomainLocale(</span><span class="s3">\n  </span><span class="s1">domainItems?: readonly DomainLocale[],</span><span class="s3">\n  </span><span class="s1">hostname?: string,</span><span class="s3">\n  </span><span class="s1">detectedLocale?: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (!domainItems) return</span><span class="s3">\n\n  </span><span class="s1">if (detectedLocale) {</span><span class="s3">\n    </span><span class="s1">detectedLocale = detectedLocale.toLowerCase()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">for (const item of domainItems) {</span><span class="s3">\n    </span><span class="s1">// remove port if present</span><span class="s3">\n    </span><span class="s1">const domainHostname = item.domain?.split(':', 1)[0].toLowerCase()</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">hostname === domainHostname ||</span><span class="s3">\n      </span><span class="s1">detectedLocale === item.defaultLocale.toLowerCase() ||</span><span class="s3">\n      </span><span class="s1">item.locales?.some((locale) =&gt; locale.toLowerCase() === detectedLocale)</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return item</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;detectDomainLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;domainItems&quot;</span><span class="s0">,</span><span class="s1">&quot;hostname&quot;</span><span class="s0">,</span><span class="s1">&quot;detectedLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;item&quot;</span><span class="s0">,</span><span class="s1">&quot;domainHostname&quot;</span><span class="s0">,</span><span class="s1">&quot;domain&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;defaultLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;locales&quot;</span><span class="s0">,</span><span class="s1">&quot;some&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAEO,SAASA,mBACdC,WAAqC,EACrCC,QAAiB,EACjBC,cAAuB;IAEvB,IAAI,CAACF,aAAa;IAElB,IAAIE,gBAAgB;QAClBA,iBAAiBA,eAAeC,WAAW;IAC7C;IAEA,KAAK,MAAMC,QAAQJ,YAAa;YAEPI,cAIrBA;QALF,yBAAyB;QACzB,MAAMC,iBAAAA,CAAiBD,eAAAA,KAAKE,MAAM,KAAA,OAAA,KAAA,IAAXF,aAAaG,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE,CAACJ,WAAW;QAChE,IACEF,aAAaI,kBACbH,mBAAmBE,KAAKI,aAAa,CAACL,WAAW,MAAA,CAAA,CACjDC,gBAAAA,KAAKK,OAAO,KAAA,OAAA,KAAA,IAAZL,cAAcM,IAAI,CAAC,CAACC,SAAWA,OAAOR,WAAW,OAAOD,eAAAA,GACxD;YACA,OAAOE;QACT;IACF;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4414</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/remove-trailing-slash.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Removes the trailing slash for a given route or page path. Preserves the</span><span class="s3">\n </span><span class="s1">* root page. Examples:</span><span class="s3">\n </span><span class="s1">*   - `/foo/bar/` -&gt; `/foo/bar`</span><span class="s3">\n </span><span class="s1">*   - `/foo/bar` -&gt; `/foo/bar`</span><span class="s3">\n </span><span class="s1">*   - `/` -&gt; `/`</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function removeTrailingSlash(route: string) {</span><span class="s3">\n  </span><span class="s1">return route.replace(/</span><span class="s3">\\</span><span class="s1">/$/, '') || '/'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;removeTrailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;;;;CAMC,GACD;;;;AAAO,SAASA,oBAAoBC,KAAa;IAC/C,OAAOA,MAAMC,OAAO,CAAC,OAAO,OAAO;AACrC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4431</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/parse-path.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Given a path this function will find the pathname, query and hash and return</span><span class="s3">\n </span><span class="s1">* them. This is useful to parse full paths on the client side.</span><span class="s3">\n </span><span class="s1">* @param path A path to parse e.g. /foo/bar?id=1#hash</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function parsePath(path: string) {</span><span class="s3">\n  </span><span class="s1">const hashIndex = path.indexOf('#')</span><span class="s3">\n  </span><span class="s1">const queryIndex = path.indexOf('?')</span><span class="s3">\n  </span><span class="s1">const hasQuery = queryIndex &gt; -1 &amp;&amp; (hashIndex &lt; 0 || queryIndex &lt; hashIndex)</span><span class="s3">\n\n  </span><span class="s1">if (hasQuery || hashIndex &gt; -1) {</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">pathname: path.substring(0, hasQuery ? queryIndex : hashIndex),</span><span class="s3">\n      </span><span class="s1">query: hasQuery</span><span class="s3">\n        </span><span class="s1">? path.substring(queryIndex, hashIndex &gt; -1 ? hashIndex : undefined)</span><span class="s3">\n        </span><span class="s1">: '',</span><span class="s3">\n      </span><span class="s1">hash: hashIndex &gt; -1 ? path.slice(hashIndex) : '',</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return { pathname: path, query: '', hash: '' }</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;parsePath&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;hashIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;indexOf&quot;</span><span class="s0">,</span><span class="s1">&quot;queryIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;hasQuery&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;substring&quot;</span><span class="s0">,</span><span class="s1">&quot;query&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;;CAIC,GACD;;;;AAAO,SAASA,UAAUC,IAAY;IACpC,MAAMC,YAAYD,KAAKE,OAAO,CAAC;IAC/B,MAAMC,aAAaH,KAAKE,OAAO,CAAC;IAChC,MAAME,WAAWD,aAAa,CAAC,KAAMF,CAAAA,YAAY,KAAKE,aAAaF,SAAQ;IAE3E,IAAIG,YAAYH,YAAY,CAAC,GAAG;QAC9B,OAAO;YACLI,UAAUL,KAAKM,SAAS,CAAC,GAAGF,WAAWD,aAAaF;YACpDM,OAAOH,WACHJ,KAAKM,SAAS,CAACH,YAAYF,YAAY,CAAC,IAAIA,YAAYO,aACxD;YACJC,MAAMR,YAAY,CAAC,IAAID,KAAKU,KAAK,CAACT,aAAa;QACjD;IACF;IAEA,OAAO;QAAEI,UAAUL;QAAMO,OAAO;QAAIE,MAAM;IAAG;AAC/C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4460</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/add-path-prefix.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { parsePath } from './parse-path'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Adds the provided prefix to the given path. It first ensures that the path</span><span class="s3">\n </span><span class="s1">* is indeed starting with a slash.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function addPathPrefix(path: string, prefix?: string) {</span><span class="s3">\n  </span><span class="s1">if (!path.startsWith('/') || !prefix) {</span><span class="s3">\n    </span><span class="s1">return path</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { pathname, query, hash } = parsePath(path)</span><span class="s3">\n  </span><span class="s1">return `${prefix}${pathname}${query}${hash}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;parsePath&quot;</span><span class="s0">,</span><span class="s1">&quot;addPathPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;query&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,SAAS,QAAQ,eAAc;;AAMjC,SAASC,cAAcC,IAAY,EAAEC,MAAe;IACzD,IAAI,CAACD,KAAKE,UAAU,CAAC,QAAQ,CAACD,QAAQ;QACpC,OAAOD;IACT;IAEA,MAAM,EAAEG,QAAQ,EAAEC,KAAK,EAAEC,IAAI,EAAE,OAAGP,uMAAAA,EAAUE;IAC5C,OAAQ,KAAEC,SAASE,WAAWC,QAAQC;AACxC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4477</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/add-path-suffix.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { parsePath } from './parse-path'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Similarly to `addPathPrefix`, this function adds a suffix at the end on the</span><span class="s3">\n </span><span class="s1">* provided path. It also works only for paths ensuring the argument starts</span><span class="s3">\n </span><span class="s1">* with a slash.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function addPathSuffix(path: string, suffix?: string) {</span><span class="s3">\n  </span><span class="s1">if (!path.startsWith('/') || !suffix) {</span><span class="s3">\n    </span><span class="s1">return path</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { pathname, query, hash } = parsePath(path)</span><span class="s3">\n  </span><span class="s1">return `${pathname}${suffix}${query}${hash}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;parsePath&quot;</span><span class="s0">,</span><span class="s1">&quot;addPathSuffix&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;suffix&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;query&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,SAAS,QAAQ,eAAc;;AAOjC,SAASC,cAAcC,IAAY,EAAEC,MAAe;IACzD,IAAI,CAACD,KAAKE,UAAU,CAAC,QAAQ,CAACD,QAAQ;QACpC,OAAOD;IACT;IAEA,MAAM,EAAEG,QAAQ,EAAEC,KAAK,EAAEC,IAAI,EAAE,OAAGP,uMAAAA,EAAUE;IAC5C,OAAQ,KAAEG,WAAWF,SAASG,QAAQC;AACxC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4494</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/path-has-prefix.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { parsePath } from './parse-path'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Checks if a given path starts with a given prefix. It ensures it matches</span><span class="s3">\n </span><span class="s1">* exactly without containing extra chars. e.g. prefix /docs should replace</span><span class="s3">\n </span><span class="s1">* for /docs, /docs/, /docs/a but not /docsss</span><span class="s3">\n </span><span class="s1">* @param path The path to check.</span><span class="s3">\n </span><span class="s1">* @param prefix The prefix to check against.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function pathHasPrefix(path: string, prefix: string) {</span><span class="s3">\n  </span><span class="s1">if (typeof path !== 'string') {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { pathname } = parsePath(path)</span><span class="s3">\n  </span><span class="s1">return pathname === prefix || pathname.startsWith(prefix + '/')</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;parsePath&quot;</span><span class="s0">,</span><span class="s1">&quot;pathHasPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,SAAS,QAAQ,eAAc;;AASjC,SAASC,cAAcC,IAAY,EAAEC,MAAc;IACxD,IAAI,OAAOD,SAAS,UAAU;QAC5B,OAAO;IACT;IAEA,MAAM,EAAEE,QAAQ,EAAE,OAAGJ,uMAAAA,EAAUE;IAC/B,OAAOE,aAAaD,UAAUC,SAASC,UAAU,CAACF,SAAS;AAC7D&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4511</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/add-locale.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { addPathPrefix } from './add-path-prefix'</span><span class="s3">\n</span><span class="s1">import { pathHasPrefix } from './path-has-prefix'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* For a given path and a locale, if the locale is given, it will prefix the</span><span class="s3">\n </span><span class="s1">* locale. The path shouldn't be an API path. If a default locale is given the</span><span class="s3">\n </span><span class="s1">* prefix will be omitted if the locale is already the default locale.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function addLocale(</span><span class="s3">\n  </span><span class="s1">path: string,</span><span class="s3">\n  </span><span class="s1">locale?: string | false,</span><span class="s3">\n  </span><span class="s1">defaultLocale?: string,</span><span class="s3">\n  </span><span class="s1">ignorePrefix?: boolean</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">// If no locale was given or the locale is the default locale, we don't need</span><span class="s3">\n  </span><span class="s1">// to prefix the path.</span><span class="s3">\n  </span><span class="s1">if (!locale || locale === defaultLocale) return path</span><span class="s3">\n\n  </span><span class="s1">const lower = path.toLowerCase()</span><span class="s3">\n\n  </span><span class="s1">// If the path is an API path or the path already has the locale prefix, we</span><span class="s3">\n  </span><span class="s1">// don't need to prefix the path.</span><span class="s3">\n  </span><span class="s1">if (!ignorePrefix) {</span><span class="s3">\n    </span><span class="s1">if (pathHasPrefix(lower, '/api')) return path</span><span class="s3">\n    </span><span class="s1">if (pathHasPrefix(lower, `/${locale.toLowerCase()}`)) return path</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Add the locale prefix to the path.</span><span class="s3">\n  </span><span class="s1">return addPathPrefix(path, `/${locale}`)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;addPathPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;pathHasPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;addLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">,</span><span class="s1">&quot;defaultLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;ignorePrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;lower&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,aAAa,QAAQ,oBAAmB;AACjD,SAASC,aAAa,QAAQ,oBAAmB;;;AAO1C,SAASC,UACdC,IAAY,EACZC,MAAuB,EACvBC,aAAsB,EACtBC,YAAsB;IAEtB,4EAA4E;IAC5E,sBAAsB;IACtB,IAAI,CAACF,UAAUA,WAAWC,eAAe,OAAOF;IAEhD,MAAMI,QAAQJ,KAAKK,WAAW;IAE9B,2EAA2E;IAC3E,iCAAiC;IACjC,IAAI,CAACF,cAAc;QACjB,QAAIL,mNAAAA,EAAcM,OAAO,SAAS,OAAOJ;QACzC,QAAIF,mNAAAA,EAAcM,OAAQ,MAAGH,OAAOI,WAAW,KAAO,OAAOL;IAC/D;IAEA,qCAAqC;IACrC,WAAOH,mNAAAA,EAAcG,MAAO,MAAGC;AACjC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4537</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/format-next-pathname-info.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { NextPathnameInfo } from './get-next-pathname-info'</span><span class="s3">\n</span><span class="s1">import { removeTrailingSlash } from './remove-trailing-slash'</span><span class="s3">\n</span><span class="s1">import { addPathPrefix } from './add-path-prefix'</span><span class="s3">\n</span><span class="s1">import { addPathSuffix } from './add-path-suffix'</span><span class="s3">\n</span><span class="s1">import { addLocale } from './add-locale'</span><span class="s3">\n\n</span><span class="s1">interface ExtendedInfo extends NextPathnameInfo {</span><span class="s3">\n  </span><span class="s1">defaultLocale?: string</span><span class="s3">\n  </span><span class="s1">ignorePrefix?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function formatNextPathnameInfo(info: ExtendedInfo) {</span><span class="s3">\n  </span><span class="s1">let pathname = addLocale(</span><span class="s3">\n    </span><span class="s1">info.pathname,</span><span class="s3">\n    </span><span class="s1">info.locale,</span><span class="s3">\n    </span><span class="s1">info.buildId ? undefined : info.defaultLocale,</span><span class="s3">\n    </span><span class="s1">info.ignorePrefix</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">if (info.buildId || !info.trailingSlash) {</span><span class="s3">\n    </span><span class="s1">pathname = removeTrailingSlash(pathname)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (info.buildId) {</span><span class="s3">\n    </span><span class="s1">pathname = addPathSuffix(</span><span class="s3">\n      </span><span class="s1">addPathPrefix(pathname, `/_next/data/${info.buildId}`),</span><span class="s3">\n      </span><span class="s1">info.pathname === '/' ? 'index.json' : '.json'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">pathname = addPathPrefix(pathname, info.basePath)</span><span class="s3">\n  </span><span class="s1">return !info.buildId &amp;&amp; info.trailingSlash</span><span class="s3">\n    </span><span class="s1">? !pathname.endsWith('/')</span><span class="s3">\n      </span><span class="s1">? addPathSuffix(pathname, '/')</span><span class="s3">\n      </span><span class="s1">: pathname</span><span class="s3">\n    </span><span class="s1">: removeTrailingSlash(pathname)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;removeTrailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;addPathPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;addPathSuffix&quot;</span><span class="s0">,</span><span class="s1">&quot;addLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;formatNextPathnameInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;info&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;defaultLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;ignorePrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;trailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;basePath&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AACA,SAASA,mBAAmB,QAAQ,0BAAyB;AAC7D,SAASC,aAAa,QAAQ,oBAAmB;AACjD,SAASC,aAAa,QAAQ,oBAAmB;AACjD,SAASC,SAAS,QAAQ,eAAc;;;;;AAOjC,SAASC,uBAAuBC,IAAkB;IACvD,IAAIC,eAAWH,uMAAAA,EACbE,KAAKC,QAAQ,EACbD,KAAKE,MAAM,EACXF,KAAKG,OAAO,GAAGC,YAAYJ,KAAKK,aAAa,EAC7CL,KAAKM,YAAY;IAGnB,IAAIN,KAAKG,OAAO,IAAI,CAACH,KAAKO,aAAa,EAAE;QACvCN,eAAWN,+NAAAA,EAAoBM;IACjC;IAEA,IAAID,KAAKG,OAAO,EAAE;QAChBF,eAAWJ,mNAAAA,MACTD,mNAAAA,EAAcK,UAAW,iBAAcD,KAAKG,OAAO,GACnDH,KAAKC,QAAQ,KAAK,MAAM,eAAe;IAE3C;IAEAA,eAAWL,mNAAAA,EAAcK,UAAUD,KAAKQ,QAAQ;IAChD,OAAO,CAACR,KAAKG,OAAO,IAAIH,KAAKO,aAAa,GACtC,CAACN,SAASQ,QAAQ,CAAC,WACjBZ,mNAAAA,EAAcI,UAAU,OACxBA,eACFN,+NAAAA,EAAoBM;AAC1B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4564</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/get-hostname.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { OutgoingHttpHeaders } from 'http'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Takes an object with a hostname property (like a parsed URL) and some</span><span class="s3">\n </span><span class="s1">* headers that may contain Host and returns the preferred hostname.</span><span class="s3">\n </span><span class="s1">* @param parsed An object containing a hostname property.</span><span class="s3">\n </span><span class="s1">* @param headers A dictionary with headers containing a `host`.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function getHostname(</span><span class="s3">\n  </span><span class="s1">parsed: { hostname?: string | null },</span><span class="s3">\n  </span><span class="s1">headers?: OutgoingHttpHeaders</span><span class="s3">\n</span><span class="s1">): string | undefined {</span><span class="s3">\n  </span><span class="s1">// Get the hostname from the headers if it exists, otherwise use the parsed</span><span class="s3">\n  </span><span class="s1">// hostname.</span><span class="s3">\n  </span><span class="s1">let hostname: string</span><span class="s3">\n  </span><span class="s1">if (headers?.host &amp;&amp; !Array.isArray(headers.host)) {</span><span class="s3">\n    </span><span class="s1">hostname = headers.host.toString().split(':', 1)[0]</span><span class="s3">\n  </span><span class="s1">} else if (parsed.hostname) {</span><span class="s3">\n    </span><span class="s1">hostname = parsed.hostname</span><span class="s3">\n  </span><span class="s1">} else return</span><span class="s3">\n\n  </span><span class="s1">return hostname.toLowerCase()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getHostname&quot;</span><span class="s0">,</span><span class="s1">&quot;parsed&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;hostname&quot;</span><span class="s0">,</span><span class="s1">&quot;host&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAEA;;;;;CAKC,GACD;;;;AAAO,SAASA,YACdC,MAAoC,EACpCC,OAA6B;IAE7B,2EAA2E;IAC3E,YAAY;IACZ,IAAIC;IACJ,IAAID,CAAAA,WAAAA,OAAAA,KAAAA,IAAAA,QAASE,IAAI,KAAI,CAACC,MAAMC,OAAO,CAACJ,QAAQE,IAAI,GAAG;QACjDD,WAAWD,QAAQE,IAAI,CAACG,QAAQ,GAAGC,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE;IACrD,OAAO,IAAIP,OAAOE,QAAQ,EAAE;QAC1BA,WAAWF,OAAOE,QAAQ;IAC5B,OAAO;IAEP,OAAOA,SAASM,WAAW;AAC7B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4588</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/i18n/normalize-locale-path.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export interface PathLocale {</span><span class="s3">\n  </span><span class="s1">detectedLocale?: string</span><span class="s3">\n  </span><span class="s1">pathname: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* A cache of lowercased locales for each list of locales. This is stored as a</span><span class="s3">\n </span><span class="s1">* WeakMap so if the locales are garbage collected, the cache entry will be</span><span class="s3">\n </span><span class="s1">* removed as well.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">const cache = new WeakMap&lt;readonly string[], readonly string[]&gt;()</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* For a pathname that may include a locale from a list of locales, it</span><span class="s3">\n </span><span class="s1">* removes the locale from the pathname returning it alongside with the</span><span class="s3">\n </span><span class="s1">* detected locale.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param pathname A pathname that may include a locale.</span><span class="s3">\n </span><span class="s1">* @param locales A list of locales.</span><span class="s3">\n </span><span class="s1">* @returns The detected locale and pathname without locale</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeLocalePath(</span><span class="s3">\n  </span><span class="s1">pathname: string,</span><span class="s3">\n  </span><span class="s1">locales?: readonly string[]</span><span class="s3">\n</span><span class="s1">): PathLocale {</span><span class="s3">\n  </span><span class="s1">// If locales is undefined, return the pathname as is.</span><span class="s3">\n  </span><span class="s1">if (!locales) return { pathname }</span><span class="s3">\n\n  </span><span class="s1">// Get the cached lowercased locales or create a new cache entry.</span><span class="s3">\n  </span><span class="s1">let lowercasedLocales = cache.get(locales)</span><span class="s3">\n  </span><span class="s1">if (!lowercasedLocales) {</span><span class="s3">\n    </span><span class="s1">lowercasedLocales = locales.map((locale) =&gt; locale.toLowerCase())</span><span class="s3">\n    </span><span class="s1">cache.set(locales, lowercasedLocales)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let detectedLocale: string | undefined</span><span class="s3">\n\n  </span><span class="s1">// The first segment will be empty, because it has a leading `/`. If</span><span class="s3">\n  </span><span class="s1">// there is no further segment, there is no locale (or it's the default).</span><span class="s3">\n  </span><span class="s1">const segments = pathname.split('/', 2)</span><span class="s3">\n\n  </span><span class="s1">// If there's no second segment (ie, the pathname is just `/`), there's no</span><span class="s3">\n  </span><span class="s1">// locale.</span><span class="s3">\n  </span><span class="s1">if (!segments[1]) return { pathname }</span><span class="s3">\n\n  </span><span class="s1">// The second segment will contain the locale part if any.</span><span class="s3">\n  </span><span class="s1">const segment = segments[1].toLowerCase()</span><span class="s3">\n\n  </span><span class="s1">// See if the segment matches one of the locales. If it doesn't, there is</span><span class="s3">\n  </span><span class="s1">// no locale (or it's the default).</span><span class="s3">\n  </span><span class="s1">const index = lowercasedLocales.indexOf(segment)</span><span class="s3">\n  </span><span class="s1">if (index &lt; 0) return { pathname }</span><span class="s3">\n\n  </span><span class="s1">// Return the case-sensitive locale.</span><span class="s3">\n  </span><span class="s1">detectedLocale = locales[index]</span><span class="s3">\n\n  </span><span class="s1">// Remove the `/${locale}` part of the pathname.</span><span class="s3">\n  </span><span class="s1">pathname = pathname.slice(detectedLocale.length + 1) || '/'</span><span class="s3">\n\n  </span><span class="s1">return { pathname, detectedLocale }</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;cache&quot;</span><span class="s0">,</span><span class="s1">&quot;WeakMap&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeLocalePath&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;locales&quot;</span><span class="s0">,</span><span class="s1">&quot;lowercasedLocales&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;detectedLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;segments&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;indexOf&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAKA;;;;CAIC;;;;AACD,MAAMA,QAAQ,IAAIC;AAWX,SAASC,oBACdC,QAAgB,EAChBC,OAA2B;IAE3B,sDAAsD;IACtD,IAAI,CAACA,SAAS,OAAO;QAAED;IAAS;IAEhC,iEAAiE;IACjE,IAAIE,oBAAoBL,MAAMM,GAAG,CAACF;IAClC,IAAI,CAACC,mBAAmB;QACtBA,oBAAoBD,QAAQG,GAAG,CAAC,CAACC,SAAWA,OAAOC,WAAW;QAC9DT,MAAMU,GAAG,CAACN,SAASC;IACrB;IAEA,IAAIM;IAEJ,oEAAoE;IACpE,yEAAyE;IACzE,MAAMC,WAAWT,SAASU,KAAK,CAAC,KAAK;IAErC,0EAA0E;IAC1E,UAAU;IACV,IAAI,CAACD,QAAQ,CAAC,EAAE,EAAE,OAAO;QAAET;IAAS;IAEpC,0DAA0D;IAC1D,MAAMW,UAAUF,QAAQ,CAAC,EAAE,CAACH,WAAW;IAEvC,yEAAyE;IACzE,mCAAmC;IACnC,MAAMM,QAAQV,kBAAkBW,OAAO,CAACF;IACxC,IAAIC,QAAQ,GAAG,OAAO;QAAEZ;IAAS;IAEjC,oCAAoC;IACpCQ,iBAAiBP,OAAO,CAACW,MAAM;IAE/B,gDAAgD;IAChDZ,WAAWA,SAASc,KAAK,CAACN,eAAeO,MAAM,GAAG,MAAM;IAExD,OAAO;QAAEf;QAAUQ;IAAe;AACpC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4638</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/remove-path-prefix.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { pathHasPrefix } from './path-has-prefix'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Given a path and a prefix it will remove the prefix when it exists in the</span><span class="s3">\n </span><span class="s1">* given path. It ensures it matches exactly without containing extra chars</span><span class="s3">\n </span><span class="s1">* and if the prefix is not there it will be noop.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param path The path to remove the prefix from.</span><span class="s3">\n </span><span class="s1">* @param prefix The prefix to be removed.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function removePathPrefix(path: string, prefix: string): string {</span><span class="s3">\n  </span><span class="s1">// If the path doesn't start with the prefix we can return it as is. This</span><span class="s3">\n  </span><span class="s1">// protects us from situations where the prefix is a substring of the path</span><span class="s3">\n  </span><span class="s1">// prefix such as:</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// For prefix: /blog</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">//   /blog -&gt; true</span><span class="s3">\n  </span><span class="s1">//   /blog/ -&gt; true</span><span class="s3">\n  </span><span class="s1">//   /blog/1 -&gt; true</span><span class="s3">\n  </span><span class="s1">//   /blogging -&gt; false</span><span class="s3">\n  </span><span class="s1">//   /blogging/ -&gt; false</span><span class="s3">\n  </span><span class="s1">//   /blogging/1 -&gt; false</span><span class="s3">\n  </span><span class="s1">if (!pathHasPrefix(path, prefix)) {</span><span class="s3">\n    </span><span class="s1">return path</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Remove the prefix from the path via slicing.</span><span class="s3">\n  </span><span class="s1">const withoutPrefix = path.slice(prefix.length)</span><span class="s3">\n\n  </span><span class="s1">// If the path without the prefix starts with a `/` we can return it as is.</span><span class="s3">\n  </span><span class="s1">if (withoutPrefix.startsWith('/')) {</span><span class="s3">\n    </span><span class="s1">return withoutPrefix</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If the path without the prefix doesn't start with a `/` we need to add it</span><span class="s3">\n  </span><span class="s1">// back to the path to make sure it's a valid path.</span><span class="s3">\n  </span><span class="s1">return `/${withoutPrefix}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;pathHasPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;removePathPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;withoutPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,aAAa,QAAQ,oBAAmB;;AAU1C,SAASC,iBAAiBC,IAAY,EAAEC,MAAc;IAC3D,yEAAyE;IACzE,0EAA0E;IAC1E,kBAAkB;IAClB,EAAE;IACF,oBAAoB;IACpB,EAAE;IACF,kBAAkB;IAClB,mBAAmB;IACnB,oBAAoB;IACpB,uBAAuB;IACvB,wBAAwB;IACxB,yBAAyB;IACzB,IAAI,KAACH,mNAAAA,EAAcE,MAAMC,SAAS;QAChC,OAAOD;IACT;IAEA,+CAA+C;IAC/C,MAAME,gBAAgBF,KAAKG,KAAK,CAACF,OAAOG,MAAM;IAE9C,2EAA2E;IAC3E,IAAIF,cAAcG,UAAU,CAAC,MAAM;QACjC,OAAOH;IACT;IAEA,4EAA4E;IAC5E,mDAAmD;IACnD,OAAQ,MAAGA;AACb&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4674</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/get-next-pathname-info.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { normalizeLocalePath } from '../../i18n/normalize-locale-path'</span><span class="s3">\n</span><span class="s1">import { removePathPrefix } from './remove-path-prefix'</span><span class="s3">\n</span><span class="s1">import { pathHasPrefix } from './path-has-prefix'</span><span class="s3">\n</span><span class="s1">import type { I18NProvider } from '../../../../server/lib/i18n-provider'</span><span class="s3">\n\n</span><span class="s1">export interface NextPathnameInfo {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The base path in case the pathname included it.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">basePath?: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The buildId for when the parsed URL is a data URL. Parsing it can be</span><span class="s3">\n   </span><span class="s1">* disabled with the `parseData` option.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">buildId?: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If there was a locale in the pathname, this will hold its value.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">locale?: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The processed pathname without a base path, locale, or data URL elements</span><span class="s3">\n   </span><span class="s1">* when parsing it is enabled.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pathname: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* A boolean telling if the pathname had a trailingSlash. This can be only</span><span class="s3">\n   </span><span class="s1">* true if trailingSlash is enabled.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">trailingSlash?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface Options {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* When passed to true, this function will also parse Nextjs data URLs.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">parseData?: boolean</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* A partial of the Next.js configuration to parse the URL.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">nextConfig?: {</span><span class="s3">\n    </span><span class="s1">basePath?: string</span><span class="s3">\n    </span><span class="s1">i18n?: { locales?: readonly string[] } | null</span><span class="s3">\n    </span><span class="s1">trailingSlash?: boolean</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If provided, this normalizer will be used to detect the locale instead of</span><span class="s3">\n   </span><span class="s1">* the default locale detection.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">i18nProvider?: I18NProvider</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getNextPathnameInfo(</span><span class="s3">\n  </span><span class="s1">pathname: string,</span><span class="s3">\n  </span><span class="s1">options: Options</span><span class="s3">\n</span><span class="s1">): NextPathnameInfo {</span><span class="s3">\n  </span><span class="s1">const { basePath, i18n, trailingSlash } = options.nextConfig ?? {}</span><span class="s3">\n  </span><span class="s1">const info: NextPathnameInfo = {</span><span class="s3">\n    </span><span class="s1">pathname,</span><span class="s3">\n    </span><span class="s1">trailingSlash: pathname !== '/' ? pathname.endsWith('/') : trailingSlash,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (basePath &amp;&amp; pathHasPrefix(info.pathname, basePath)) {</span><span class="s3">\n    </span><span class="s1">info.pathname = removePathPrefix(info.pathname, basePath)</span><span class="s3">\n    </span><span class="s1">info.basePath = basePath</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">let pathnameNoDataPrefix = info.pathname</span><span class="s3">\n\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">info.pathname.startsWith('/_next/data/') &amp;&amp;</span><span class="s3">\n    </span><span class="s1">info.pathname.endsWith('.json')</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">const paths = info.pathname</span><span class="s3">\n      </span><span class="s1">.replace(/^</span><span class="s3">\\</span><span class="s1">/_next</span><span class="s3">\\</span><span class="s1">/data</span><span class="s3">\\</span><span class="s1">//, '')</span><span class="s3">\n      </span><span class="s1">.replace(/</span><span class="s3">\\</span><span class="s1">.json$/, '')</span><span class="s3">\n      </span><span class="s1">.split('/')</span><span class="s3">\n\n    </span><span class="s1">const buildId = paths[0]</span><span class="s3">\n    </span><span class="s1">info.buildId = buildId</span><span class="s3">\n    </span><span class="s1">pathnameNoDataPrefix =</span><span class="s3">\n      </span><span class="s1">paths[1] !== 'index' ? `/${paths.slice(1).join('/')}` : '/'</span><span class="s3">\n\n    </span><span class="s1">// update pathname with normalized if enabled although</span><span class="s3">\n    </span><span class="s1">// we use normalized to populate locale info still</span><span class="s3">\n    </span><span class="s1">if (options.parseData === true) {</span><span class="s3">\n      </span><span class="s1">info.pathname = pathnameNoDataPrefix</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If provided, use the locale route normalizer to detect the locale instead</span><span class="s3">\n  </span><span class="s1">// of the function below.</span><span class="s3">\n  </span><span class="s1">if (i18n) {</span><span class="s3">\n    </span><span class="s1">let result = options.i18nProvider</span><span class="s3">\n      </span><span class="s1">? options.i18nProvider.analyze(info.pathname)</span><span class="s3">\n      </span><span class="s1">: normalizeLocalePath(info.pathname, i18n.locales)</span><span class="s3">\n\n    </span><span class="s1">info.locale = result.detectedLocale</span><span class="s3">\n    </span><span class="s1">info.pathname = result.pathname ?? info.pathname</span><span class="s3">\n\n    </span><span class="s1">if (!result.detectedLocale &amp;&amp; info.buildId) {</span><span class="s3">\n      </span><span class="s1">result = options.i18nProvider</span><span class="s3">\n        </span><span class="s1">? options.i18nProvider.analyze(pathnameNoDataPrefix)</span><span class="s3">\n        </span><span class="s1">: normalizeLocalePath(pathnameNoDataPrefix, i18n.locales)</span><span class="s3">\n\n      </span><span class="s1">if (result.detectedLocale) {</span><span class="s3">\n        </span><span class="s1">info.locale = result.detectedLocale</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return info</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;normalizeLocalePath&quot;</span><span class="s0">,</span><span class="s1">&quot;removePathPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;pathHasPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;getNextPathnameInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;basePath&quot;</span><span class="s0">,</span><span class="s1">&quot;i18n&quot;</span><span class="s0">,</span><span class="s1">&quot;trailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;info&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;pathnameNoDataPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;paths&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;parseData&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;i18nProvider&quot;</span><span class="s0">,</span><span class="s1">&quot;analyze&quot;</span><span class="s0">,</span><span class="s1">&quot;locales&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">,</span><span class="s1">&quot;detectedLocale&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,mBAAmB,QAAQ,mCAAkC;AACtE,SAASC,gBAAgB,QAAQ,uBAAsB;AACvD,SAASC,aAAa,QAAQ,oBAAmB;;;;AAkD1C,SAASC,oBACdC,QAAgB,EAChBC,OAAgB;QAE0BA;IAA1C,MAAM,EAAEC,QAAQ,EAAEC,IAAI,EAAEC,aAAa,EAAE,GAAGH,CAAAA,sBAAAA,QAAQI,UAAU,KAAA,OAAlBJ,sBAAsB,CAAC;IACjE,MAAMK,OAAyB;QAC7BN;QACAI,eAAeJ,aAAa,MAAMA,SAASO,QAAQ,CAAC,OAAOH;IAC7D;IAEA,IAAIF,gBAAYJ,mNAAAA,EAAcQ,KAAKN,QAAQ,EAAEE,WAAW;QACtDI,KAAKN,QAAQ,OAAGH,yNAAAA,EAAiBS,KAAKN,QAAQ,EAAEE;QAChDI,KAAKJ,QAAQ,GAAGA;IAClB;IACA,IAAIM,uBAAuBF,KAAKN,QAAQ;IAExC,IACEM,KAAKN,QAAQ,CAACS,UAAU,CAAC,mBACzBH,KAAKN,QAAQ,CAACO,QAAQ,CAAC,UACvB;QACA,MAAMG,QAAQJ,KAAKN,QAAQ,CACxBW,OAAO,CAAC,oBAAoB,IAC5BA,OAAO,CAAC,WAAW,IACnBC,KAAK,CAAC;QAET,MAAMC,UAAUH,KAAK,CAAC,EAAE;QACxBJ,KAAKO,OAAO,GAAGA;QACfL,uBACEE,KAAK,CAAC,EAAE,KAAK,UAAW,MAAGA,MAAMI,KAAK,CAAC,GAAGC,IAAI,CAAC,OAAS;QAE1D,sDAAsD;QACtD,kDAAkD;QAClD,IAAId,QAAQe,SAAS,KAAK,MAAM;YAC9BV,KAAKN,QAAQ,GAAGQ;QAClB;IACF;IAEA,4EAA4E;IAC5E,yBAAyB;IACzB,IAAIL,MAAM;QACR,IAAIc,SAAShB,QAAQiB,YAAY,GAC7BjB,QAAQiB,YAAY,CAACC,OAAO,CAACb,KAAKN,QAAQ,QAC1CJ,oNAAAA,EAAoBU,KAAKN,QAAQ,EAAEG,KAAKiB,OAAO;QAEnDd,KAAKe,MAAM,GAAGJ,OAAOK,cAAc;YACnBL;QAAhBX,KAAKN,QAAQ,GAAGiB,CAAAA,mBAAAA,OAAOjB,QAAQ,KAAA,OAAfiB,mBAAmBX,KAAKN,QAAQ;QAEhD,IAAI,CAACiB,OAAOK,cAAc,IAAIhB,KAAKO,OAAO,EAAE;YAC1CI,SAAShB,QAAQiB,YAAY,GACzBjB,QAAQiB,YAAY,CAACC,OAAO,CAACX,4BAC7BZ,oNAAAA,EAAoBY,sBAAsBL,KAAKiB,OAAO;YAE1D,IAAIH,OAAOK,cAAc,EAAE;gBACzBhB,KAAKe,MAAM,GAAGJ,OAAOK,cAAc;YACrC;QACF;IACF;IACA,OAAOhB;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4727</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/web/next-url.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { OutgoingHttpHeaders } from 'http'</span><span class="s3">\n</span><span class="s1">import type { DomainLocale, I18NConfig } from '../config-shared'</span><span class="s3">\n</span><span class="s1">import type { I18NProvider } from '../lib/i18n-provider'</span><span class="s3">\n\n</span><span class="s1">import { detectDomainLocale } from '../../shared/lib/i18n/detect-domain-locale'</span><span class="s3">\n</span><span class="s1">import { formatNextPathnameInfo } from '../../shared/lib/router/utils/format-next-pathname-info'</span><span class="s3">\n</span><span class="s1">import { getHostname } from '../../shared/lib/get-hostname'</span><span class="s3">\n</span><span class="s1">import { getNextPathnameInfo } from '../../shared/lib/router/utils/get-next-pathname-info'</span><span class="s3">\n\n</span><span class="s1">interface Options {</span><span class="s3">\n  </span><span class="s1">base?: string | URL</span><span class="s3">\n  </span><span class="s1">headers?: OutgoingHttpHeaders</span><span class="s3">\n  </span><span class="s1">forceLocale?: boolean</span><span class="s3">\n  </span><span class="s1">nextConfig?: {</span><span class="s3">\n    </span><span class="s1">basePath?: string</span><span class="s3">\n    </span><span class="s1">i18n?: I18NConfig | null</span><span class="s3">\n    </span><span class="s1">trailingSlash?: boolean</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">i18nProvider?: I18NProvider</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const REGEX_LOCALHOST_HOSTNAME =</span><span class="s3">\n  </span><span class="s1">/(?!^https?:</span><span class="s3">\\</span><span class="s1">/</span><span class="s3">\\</span><span class="s1">/)(127(?:</span><span class="s3">\\</span><span class="s1">.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|</span><span class="s3">\\</span><span class="s1">[::1</span><span class="s3">\\</span><span class="s1">]|localhost)/</span><span class="s3">\n\n</span><span class="s1">function parseURL(url: string | URL, base?: string | URL) {</span><span class="s3">\n  </span><span class="s1">return new URL(</span><span class="s3">\n    </span><span class="s1">String(url).replace(REGEX_LOCALHOST_HOSTNAME, 'localhost'),</span><span class="s3">\n    </span><span class="s1">base &amp;&amp; String(base).replace(REGEX_LOCALHOST_HOSTNAME, 'localhost')</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const Internal = Symbol('NextURLInternal')</span><span class="s3">\n\n</span><span class="s1">export class NextURL {</span><span class="s3">\n  </span><span class="s1">private [Internal]: {</span><span class="s3">\n    </span><span class="s1">basePath: string</span><span class="s3">\n    </span><span class="s1">buildId?: string</span><span class="s3">\n    </span><span class="s1">flightSearchParameters?: Record&lt;string, string&gt;</span><span class="s3">\n    </span><span class="s1">defaultLocale?: string</span><span class="s3">\n    </span><span class="s1">domainLocale?: DomainLocale</span><span class="s3">\n    </span><span class="s1">locale?: string</span><span class="s3">\n    </span><span class="s1">options: Options</span><span class="s3">\n    </span><span class="s1">trailingSlash?: boolean</span><span class="s3">\n    </span><span class="s1">url: URL</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">constructor(input: string | URL, base?: string | URL, opts?: Options)</span><span class="s3">\n  </span><span class="s1">constructor(input: string | URL, opts?: Options)</span><span class="s3">\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">input: string | URL,</span><span class="s3">\n    </span><span class="s1">baseOrOpts?: string | URL | Options,</span><span class="s3">\n    </span><span class="s1">opts?: Options</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">let base: undefined | string | URL</span><span class="s3">\n    </span><span class="s1">let options: Options</span><span class="s3">\n\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">(typeof baseOrOpts === 'object' &amp;&amp; 'pathname' in baseOrOpts) ||</span><span class="s3">\n      </span><span class="s1">typeof baseOrOpts === 'string'</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">base = baseOrOpts</span><span class="s3">\n      </span><span class="s1">options = opts || {}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">options = opts || baseOrOpts || {}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">this[Internal] = {</span><span class="s3">\n      </span><span class="s1">url: parseURL(input, base ?? options.base),</span><span class="s3">\n      </span><span class="s1">options: options,</span><span class="s3">\n      </span><span class="s1">basePath: '',</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">this.analyze()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private analyze() {</span><span class="s3">\n    </span><span class="s1">const info = getNextPathnameInfo(this[Internal].url.pathname, {</span><span class="s3">\n      </span><span class="s1">nextConfig: this[Internal].options.nextConfig,</span><span class="s3">\n      </span><span class="s1">parseData: !process.env.__NEXT_NO_MIDDLEWARE_URL_NORMALIZE,</span><span class="s3">\n      </span><span class="s1">i18nProvider: this[Internal].options.i18nProvider,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n\n    </span><span class="s1">const hostname = getHostname(</span><span class="s3">\n      </span><span class="s1">this[Internal].url,</span><span class="s3">\n      </span><span class="s1">this[Internal].options.headers</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">this[Internal].domainLocale = this[Internal].options.i18nProvider</span><span class="s3">\n      </span><span class="s1">? this[Internal].options.i18nProvider.detectDomainLocale(hostname)</span><span class="s3">\n      </span><span class="s1">: detectDomainLocale(</span><span class="s3">\n          </span><span class="s1">this[Internal].options.nextConfig?.i18n?.domains,</span><span class="s3">\n          </span><span class="s1">hostname</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">const defaultLocale =</span><span class="s3">\n      </span><span class="s1">this[Internal].domainLocale?.defaultLocale ||</span><span class="s3">\n      </span><span class="s1">this[Internal].options.nextConfig?.i18n?.defaultLocale</span><span class="s3">\n\n    </span><span class="s1">this[Internal].url.pathname = info.pathname</span><span class="s3">\n    </span><span class="s1">this[Internal].defaultLocale = defaultLocale</span><span class="s3">\n    </span><span class="s1">this[Internal].basePath = info.basePath ?? ''</span><span class="s3">\n    </span><span class="s1">this[Internal].buildId = info.buildId</span><span class="s3">\n    </span><span class="s1">this[Internal].locale = info.locale ?? defaultLocale</span><span class="s3">\n    </span><span class="s1">this[Internal].trailingSlash = info.trailingSlash</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private formatPathname() {</span><span class="s3">\n    </span><span class="s1">return formatNextPathnameInfo({</span><span class="s3">\n      </span><span class="s1">basePath: this[Internal].basePath,</span><span class="s3">\n      </span><span class="s1">buildId: this[Internal].buildId,</span><span class="s3">\n      </span><span class="s1">defaultLocale: !this[Internal].options.forceLocale</span><span class="s3">\n        </span><span class="s1">? this[Internal].defaultLocale</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n      </span><span class="s1">locale: this[Internal].locale,</span><span class="s3">\n      </span><span class="s1">pathname: this[Internal].url.pathname,</span><span class="s3">\n      </span><span class="s1">trailingSlash: this[Internal].trailingSlash,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private formatSearch() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.search</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get buildId() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].buildId</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public set buildId(buildId: string | undefined) {</span><span class="s3">\n    </span><span class="s1">this[Internal].buildId = buildId</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get locale() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].locale ?? ''</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public set locale(locale: string) {</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">!this[Internal].locale ||</span><span class="s3">\n      </span><span class="s1">!this[Internal].options.nextConfig?.i18n?.locales.includes(locale)</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">throw new TypeError(</span><span class="s3">\n        </span><span class="s1">`The NextURL configuration includes no locale </span><span class="s3">\&quot;</span><span class="s1">${locale}</span><span class="s3">\&quot;</span><span class="s1">`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">this[Internal].locale = locale</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get defaultLocale() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].defaultLocale</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get domainLocale() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].domainLocale</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get searchParams() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.searchParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get host() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.host</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set host(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.host = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get hostname() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.hostname</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set hostname(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.hostname = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get port() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.port</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set port(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.port = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get protocol() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.protocol</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set protocol(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.protocol = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get href() {</span><span class="s3">\n    </span><span class="s1">const pathname = this.formatPathname()</span><span class="s3">\n    </span><span class="s1">const search = this.formatSearch()</span><span class="s3">\n    </span><span class="s1">return `${this.protocol}//${this.host}${pathname}${search}${this.hash}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set href(url: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url = parseURL(url)</span><span class="s3">\n    </span><span class="s1">this.analyze()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get origin() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.origin</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get pathname() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.pathname</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set pathname(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.pathname = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get hash() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.hash</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set hash(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.hash = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get search() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.search</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set search(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.search = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get password() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.password</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set password(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.password = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get username() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.username</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set username(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.username = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get basePath() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].basePath</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set basePath(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].basePath = value.startsWith('/') ? value : `/${value}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">toString() {</span><span class="s3">\n    </span><span class="s1">return this.href</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">toJSON() {</span><span class="s3">\n    </span><span class="s1">return this.href</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">[Symbol.for('edge-runtime.inspect.custom')]() {</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">href: this.href,</span><span class="s3">\n      </span><span class="s1">origin: this.origin,</span><span class="s3">\n      </span><span class="s1">protocol: this.protocol,</span><span class="s3">\n      </span><span class="s1">username: this.username,</span><span class="s3">\n      </span><span class="s1">password: this.password,</span><span class="s3">\n      </span><span class="s1">host: this.host,</span><span class="s3">\n      </span><span class="s1">hostname: this.hostname,</span><span class="s3">\n      </span><span class="s1">port: this.port,</span><span class="s3">\n      </span><span class="s1">pathname: this.pathname,</span><span class="s3">\n      </span><span class="s1">search: this.search,</span><span class="s3">\n      </span><span class="s1">searchParams: this.searchParams,</span><span class="s3">\n      </span><span class="s1">hash: this.hash,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">clone() {</span><span class="s3">\n    </span><span class="s1">return new NextURL(String(this), this[Internal].options)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;detectDomainLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;formatNextPathnameInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;getHostname&quot;</span><span class="s0">,</span><span class="s1">&quot;getNextPathnameInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;REGEX_LOCALHOST_HOSTNAME&quot;</span><span class="s0">,</span><span class="s1">&quot;parseURL&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;base&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;Internal&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;NextURL&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;input&quot;</span><span class="s0">,</span><span class="s1">&quot;baseOrOpts&quot;</span><span class="s0">,</span><span class="s1">&quot;opts&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;basePath&quot;</span><span class="s0">,</span><span class="s1">&quot;analyze&quot;</span><span class="s0">,</span><span class="s1">&quot;info&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;parseData&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_NO_MIDDLEWARE_URL_NORMALIZE&quot;</span><span class="s0">,</span><span class="s1">&quot;i18nProvider&quot;</span><span class="s0">,</span><span class="s1">&quot;hostname&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;domainLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;i18n&quot;</span><span class="s0">,</span><span class="s1">&quot;domains&quot;</span><span class="s0">,</span><span class="s1">&quot;defaultLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">,</span><span class="s1">&quot;trailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;formatPathname&quot;</span><span class="s0">,</span><span class="s1">&quot;forceLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;formatSearch&quot;</span><span class="s0">,</span><span class="s1">&quot;search&quot;</span><span class="s0">,</span><span class="s1">&quot;locales&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;TypeError&quot;</span><span class="s0">,</span><span class="s1">&quot;searchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;host&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;port&quot;</span><span class="s0">,</span><span class="s1">&quot;protocol&quot;</span><span class="s0">,</span><span class="s1">&quot;href&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">,</span><span class="s1">&quot;origin&quot;</span><span class="s0">,</span><span class="s1">&quot;password&quot;</span><span class="s0">,</span><span class="s1">&quot;username&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;toJSON&quot;</span><span class="s0">,</span><span class="s1">&quot;for&quot;</span><span class="s0">,</span><span class="s1">&quot;clone&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAIA,SAASA,kBAAkB,QAAQ,6CAA4C;AAC/E,SAASC,sBAAsB,QAAQ,0DAAyD;AAChG,SAASC,WAAW,QAAQ,gCAA+B;AAC3D,SAASC,mBAAmB,QAAQ,uDAAsD;;;;;AAc1F,MAAMC,2BACJ;AAEF,SAASC,SAASC,GAAiB,EAAEC,IAAmB;IACtD,OAAO,IAAIC,IACTC,OAAOH,KAAKI,OAAO,CAACN,0BAA0B,cAC9CG,QAAQE,OAAOF,MAAMG,OAAO,CAACN,0BAA0B;AAE3D;AAEA,MAAMO,WAAWC,OAAO;AAEjB,MAAMC;IAeXC,YACEC,KAAmB,EACnBC,UAAmC,EACnCC,IAAc,CACd;QACA,IAAIV;QACJ,IAAIW;QAEJ,IACG,OAAOF,eAAe,YAAY,cAAcA,cACjD,OAAOA,eAAe,UACtB;YACAT,OAAOS;YACPE,UAAUD,QAAQ,CAAC;QACrB,OAAO;YACLC,UAAUD,QAAQD,cAAc,CAAC;QACnC;QAEA,IAAI,CAACL,SAAS,GAAG;YACfL,KAAKD,SAASU,OAAOR,QAAQW,QAAQX,IAAI;YACzCW,SAASA;YACTC,UAAU;QACZ;QAEA,IAAI,CAACC,OAAO;IACd;IAEQA,UAAU;YAcV,wCAAA,mCAKJ,6BACA,yCAAA;QAnBF,MAAMC,WAAOlB,mOAAAA,EAAoB,IAAI,CAACQ,SAAS,CAACL,GAAG,CAACgB,QAAQ,EAAE;YAC5DC,YAAY,IAAI,CAACZ,SAAS,CAACO,OAAO,CAACK,UAAU;YAC7CC,WAAW,CAACC,QAAQC,GAAG,CAACC,kCAAkC;YAC1DC,cAAc,IAAI,CAACjB,SAAS,CAACO,OAAO,CAACU,YAAY;QACnD;QAEA,MAAMC,eAAW3B,wLAAAA,EACf,IAAI,CAACS,SAAS,CAACL,GAAG,EAClB,IAAI,CAACK,SAAS,CAACO,OAAO,CAACY,OAAO;QAEhC,IAAI,CAACnB,SAAS,CAACoB,YAAY,GAAG,IAAI,CAACpB,SAAS,CAACO,OAAO,CAACU,YAAY,GAC7D,IAAI,CAACjB,SAAS,CAACO,OAAO,CAACU,YAAY,CAAC5B,kBAAkB,CAAC6B,gBACvD7B,kNAAAA,EAAAA,CACE,oCAAA,IAAI,CAACW,SAAS,CAACO,OAAO,CAACK,UAAU,KAAA,OAAA,KAAA,IAAA,CAAjC,yCAAA,kCAAmCS,IAAI,KAAA,OAAA,KAAA,IAAvC,uCAAyCC,OAAO,EAChDJ;QAGN,MAAMK,gBACJ,CAAA,CAAA,8BAAA,IAAI,CAACvB,SAAS,CAACoB,YAAY,KAAA,OAAA,KAAA,IAA3B,4BAA6BG,aAAa,KAAA,CAAA,CAC1C,qCAAA,IAAI,CAACvB,SAAS,CAACO,OAAO,CAACK,UAAU,KAAA,OAAA,KAAA,IAAA,CAAjC,0CAAA,mCAAmCS,IAAI,KAAA,OAAA,KAAA,IAAvC,wCAAyCE,aAAa;QAExD,IAAI,CAACvB,SAAS,CAACL,GAAG,CAACgB,QAAQ,GAAGD,KAAKC,QAAQ;QAC3C,IAAI,CAACX,SAAS,CAACuB,aAAa,GAAGA;QAC/B,IAAI,CAACvB,SAAS,CAACQ,QAAQ,GAAGE,KAAKF,QAAQ,IAAI;QAC3C,IAAI,CAACR,SAAS,CAACwB,OAAO,GAAGd,KAAKc,OAAO;QACrC,IAAI,CAACxB,SAAS,CAACyB,MAAM,GAAGf,KAAKe,MAAM,IAAIF;QACvC,IAAI,CAACvB,SAAS,CAAC0B,aAAa,GAAGhB,KAAKgB,aAAa;IACnD;IAEQC,iBAAiB;QACvB,WAAOrC,yOAAAA,EAAuB;YAC5BkB,UAAU,IAAI,CAACR,SAAS,CAACQ,QAAQ;YACjCgB,SAAS,IAAI,CAACxB,SAAS,CAACwB,OAAO;YAC/BD,eAAe,CAAC,IAAI,CAACvB,SAAS,CAACO,OAAO,CAACqB,WAAW,GAC9C,IAAI,CAAC5B,SAAS,CAACuB,aAAa,GAC5BM;YACJJ,QAAQ,IAAI,CAACzB,SAAS,CAACyB,MAAM;YAC7Bd,UAAU,IAAI,CAACX,SAAS,CAACL,GAAG,CAACgB,QAAQ;YACrCe,eAAe,IAAI,CAAC1B,SAAS,CAAC0B,aAAa;QAC7C;IACF;IAEQI,eAAe;QACrB,OAAO,IAAI,CAAC9B,SAAS,CAACL,GAAG,CAACoC,MAAM;IAClC;IAEA,IAAWP,UAAU;QACnB,OAAO,IAAI,CAACxB,SAAS,CAACwB,OAAO;IAC/B;IAEA,IAAWA,QAAQA,OAA2B,EAAE;QAC9C,IAAI,CAACxB,SAAS,CAACwB,OAAO,GAAGA;IAC3B;IAEA,IAAWC,SAAS;QAClB,OAAO,IAAI,CAACzB,SAAS,CAACyB,MAAM,IAAI;IAClC;IAEA,IAAWA,OAAOA,MAAc,EAAE;YAG7B,wCAAA;QAFH,IACE,CAAC,IAAI,CAACzB,SAAS,CAACyB,MAAM,IACtB,CAAA,CAAA,CAAC,oCAAA,IAAI,CAACzB,SAAS,CAACO,OAAO,CAACK,UAAU,KAAA,OAAA,KAAA,IAAA,CAAjC,yCAAA,kCAAmCS,IAAI,KAAA,OAAA,KAAA,IAAvC,uCAAyCW,OAAO,CAACC,QAAQ,CAACR,OAAAA,GAC3D;YACA,MAAM,OAAA,cAEL,CAFK,IAAIS,UACR,CAAC,8CAA8C,EAAET,OAAO,CAAC,CAAC,GADtD,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;QAEA,IAAI,CAACzB,SAAS,CAACyB,MAAM,GAAGA;IAC1B;IAEA,IAAIF,gBAAgB;QAClB,OAAO,IAAI,CAACvB,SAAS,CAACuB,aAAa;IACrC;IAEA,IAAIH,eAAe;QACjB,OAAO,IAAI,CAACpB,SAAS,CAACoB,YAAY;IACpC;IAEA,IAAIe,eAAe;QACjB,OAAO,IAAI,CAACnC,SAAS,CAACL,GAAG,CAACwC,YAAY;IACxC;IAEA,IAAIC,OAAO;QACT,OAAO,IAAI,CAACpC,SAAS,CAACL,GAAG,CAACyC,IAAI;IAChC;IAEA,IAAIA,KAAKC,KAAa,EAAE;QACtB,IAAI,CAACrC,SAAS,CAACL,GAAG,CAACyC,IAAI,GAAGC;IAC5B;IAEA,IAAInB,WAAW;QACb,OAAO,IAAI,CAAClB,SAAS,CAACL,GAAG,CAACuB,QAAQ;IACpC;IAEA,IAAIA,SAASmB,KAAa,EAAE;QAC1B,IAAI,CAACrC,SAAS,CAACL,GAAG,CAACuB,QAAQ,GAAGmB;IAChC;IAEA,IAAIC,OAAO;QACT,OAAO,IAAI,CAACtC,SAAS,CAACL,GAAG,CAAC2C,IAAI;IAChC;IAEA,IAAIA,KAAKD,KAAa,EAAE;QACtB,IAAI,CAACrC,SAAS,CAACL,GAAG,CAAC2C,IAAI,GAAGD;IAC5B;IAEA,IAAIE,WAAW;QACb,OAAO,IAAI,CAACvC,SAAS,CAACL,GAAG,CAAC4C,QAAQ;IACpC;IAEA,IAAIA,SAASF,KAAa,EAAE;QAC1B,IAAI,CAACrC,SAAS,CAACL,GAAG,CAAC4C,QAAQ,GAAGF;IAChC;IAEA,IAAIG,OAAO;QACT,MAAM7B,WAAW,IAAI,CAACgB,cAAc;QACpC,MAAMI,SAAS,IAAI,CAACD,YAAY;QAChC,OAAO,GAAG,IAAI,CAACS,QAAQ,CAAC,EAAE,EAAE,IAAI,CAACH,IAAI,GAAGzB,WAAWoB,SAAS,IAAI,CAACU,IAAI,EAAE;IACzE;IAEA,IAAID,KAAK7C,GAAW,EAAE;QACpB,IAAI,CAACK,SAAS,CAACL,GAAG,GAAGD,SAASC;QAC9B,IAAI,CAACc,OAAO;IACd;IAEA,IAAIiC,SAAS;QACX,OAAO,IAAI,CAAC1C,SAAS,CAACL,GAAG,CAAC+C,MAAM;IAClC;IAEA,IAAI/B,WAAW;QACb,OAAO,IAAI,CAACX,SAAS,CAACL,GAAG,CAACgB,QAAQ;IACpC;IAEA,IAAIA,SAAS0B,KAAa,EAAE;QAC1B,IAAI,CAACrC,SAAS,CAACL,GAAG,CAACgB,QAAQ,GAAG0B;IAChC;IAEA,IAAII,OAAO;QACT,OAAO,IAAI,CAACzC,SAAS,CAACL,GAAG,CAAC8C,IAAI;IAChC;IAEA,IAAIA,KAAKJ,KAAa,EAAE;QACtB,IAAI,CAACrC,SAAS,CAACL,GAAG,CAAC8C,IAAI,GAAGJ;IAC5B;IAEA,IAAIN,SAAS;QACX,OAAO,IAAI,CAAC/B,SAAS,CAACL,GAAG,CAACoC,MAAM;IAClC;IAEA,IAAIA,OAAOM,KAAa,EAAE;QACxB,IAAI,CAACrC,SAAS,CAACL,GAAG,CAACoC,MAAM,GAAGM;IAC9B;IAEA,IAAIM,WAAW;QACb,OAAO,IAAI,CAAC3C,SAAS,CAACL,GAAG,CAACgD,QAAQ;IACpC;IAEA,IAAIA,SAASN,KAAa,EAAE;QAC1B,IAAI,CAACrC,SAAS,CAACL,GAAG,CAACgD,QAAQ,GAAGN;IAChC;IAEA,IAAIO,WAAW;QACb,OAAO,IAAI,CAAC5C,SAAS,CAACL,GAAG,CAACiD,QAAQ;IACpC;IAEA,IAAIA,SAASP,KAAa,EAAE;QAC1B,IAAI,CAACrC,SAAS,CAACL,GAAG,CAACiD,QAAQ,GAAGP;IAChC;IAEA,IAAI7B,WAAW;QACb,OAAO,IAAI,CAACR,SAAS,CAACQ,QAAQ;IAChC;IAEA,IAAIA,SAAS6B,KAAa,EAAE;QAC1B,IAAI,CAACrC,SAAS,CAACQ,QAAQ,GAAG6B,MAAMQ,UAAU,CAAC,OAAOR,QAAQ,CAAC,CAAC,EAAEA,OAAO;IACvE;IAEAS,WAAW;QACT,OAAO,IAAI,CAACN,IAAI;IAClB;IAEAO,SAAS;QACP,OAAO,IAAI,CAACP,IAAI;IAClB;IAEA,CAACvC,OAAO+C,GAAG,CAAC,+BAA+B,GAAG;QAC5C,OAAO;YACLR,MAAM,IAAI,CAACA,IAAI;YACfE,QAAQ,IAAI,CAACA,MAAM;YACnBH,UAAU,IAAI,CAACA,QAAQ;YACvBK,UAAU,IAAI,CAACA,QAAQ;YACvBD,UAAU,IAAI,CAACA,QAAQ;YACvBP,MAAM,IAAI,CAACA,IAAI;YACflB,UAAU,IAAI,CAACA,QAAQ;YACvBoB,MAAM,IAAI,CAACA,IAAI;YACf3B,UAAU,IAAI,CAACA,QAAQ;YACvBoB,QAAQ,IAAI,CAACA,MAAM;YACnBI,cAAc,IAAI,CAACA,YAAY;YAC/BM,MAAM,IAAI,CAACA,IAAI;QACjB;IACF;IAEAQ,QAAQ;QACN,OAAO,IAAI/C,QAAQJ,OAAO,IAAI,GAAG,IAAI,CAACE,SAAS,CAACO,OAAO;IACzD;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4922</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/web/error.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export class PageSignatureError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor({ page }: { page: string }) {</span><span class="s3">\n    </span><span class="s1">super(`The middleware </span><span class="s3">\&quot;</span><span class="s1">${page}</span><span class="s3">\&quot; </span><span class="s1">accepts an async API directly with the form:</span><span class="s3">\n  \n  </span><span class="s1">export function middleware(request, event) {</span><span class="s3">\n    </span><span class="s1">return NextResponse.redirect('/new-location')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  \n  </span><span class="s1">Read more: https://nextjs.org/docs/messages/middleware-new-signature</span><span class="s3">\n  </span><span class="s1">`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class RemovedPageError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor() {</span><span class="s3">\n    </span><span class="s1">super(`The request.page has been deprecated in favour of </span><span class="s3">\\</span><span class="s1">`URLPattern</span><span class="s3">\\</span><span class="s1">`.</span><span class="s3">\n  </span><span class="s1">Read more: https://nextjs.org/docs/messages/middleware-request-page</span><span class="s3">\n  </span><span class="s1">`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class RemovedUAError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor() {</span><span class="s3">\n    </span><span class="s1">super(`The request.ua has been removed in favour of </span><span class="s3">\\</span><span class="s1">`userAgent</span><span class="s3">\\</span><span class="s1">` function.</span><span class="s3">\n  </span><span class="s1">Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent</span><span class="s3">\n  </span><span class="s1">`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;PageSignatureError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;RemovedPageError&quot;</span><span class="s0">,</span><span class="s1">&quot;RemovedUAError&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;AAAO,MAAMA,2BAA2BC;IACtCC,YAAY,EAAEC,IAAI,EAAoB,CAAE;QACtC,KAAK,CAAC,CAAC,gBAAgB,EAAEA,KAAK;;;;;;;EAOhC,CAAC;IACD;AACF;AAEO,MAAMC,yBAAyBH;IACpCC,aAAc;QACZ,KAAK,CAAC,CAAC;;EAET,CAAC;IACD;AACF;AAEO,MAAMG,uBAAuBJ;IAClCC,aAAc;QACZ,KAAK,CAAC,CAAC;;EAET,CAAC;IACD;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4960</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/compiled/%40edge-runtime/cookies/index.js&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;</span><span class="s3">\&quot;</span><span class="s1">use strict</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">var __defProp = Object.defineProperty;</span><span class="s3">\n</span><span class="s1">var __getOwnPropDesc = Object.getOwnPropertyDescriptor;</span><span class="s3">\n</span><span class="s1">var __getOwnPropNames = Object.getOwnPropertyNames;</span><span class="s3">\n</span><span class="s1">var __hasOwnProp = Object.prototype.hasOwnProperty;</span><span class="s3">\n</span><span class="s1">var __export = (target, all) =&gt; {</span><span class="s3">\n  </span><span class="s1">for (var name in all)</span><span class="s3">\n    </span><span class="s1">__defProp(target, name, { get: all[name], enumerable: true });</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">var __copyProps = (to, from, except, desc) =&gt; {</span><span class="s3">\n  </span><span class="s1">if (from &amp;&amp; typeof from === </span><span class="s3">\&quot;</span><span class="s1">object</span><span class="s3">\&quot; </span><span class="s1">|| typeof from === </span><span class="s3">\&quot;</span><span class="s1">function</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">for (let key of __getOwnPropNames(from))</span><span class="s3">\n      </span><span class="s1">if (!__hasOwnProp.call(to, key) &amp;&amp; key !== except)</span><span class="s3">\n        </span><span class="s1">__defProp(to, key, { get: () =&gt; from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return to;</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">var __toCommonJS = (mod) =&gt; __copyProps(__defProp({}, </span><span class="s3">\&quot;</span><span class="s1">__esModule</span><span class="s3">\&quot;</span><span class="s1">, { value: true }), mod);</span><span class="s3">\n\n</span><span class="s1">// src/index.ts</span><span class="s3">\n</span><span class="s1">var src_exports = {};</span><span class="s3">\n</span><span class="s1">__export(src_exports, {</span><span class="s3">\n  </span><span class="s1">RequestCookies: () =&gt; RequestCookies,</span><span class="s3">\n  </span><span class="s1">ResponseCookies: () =&gt; ResponseCookies,</span><span class="s3">\n  </span><span class="s1">parseCookie: () =&gt; parseCookie,</span><span class="s3">\n  </span><span class="s1">parseSetCookie: () =&gt; parseSetCookie,</span><span class="s3">\n  </span><span class="s1">stringifyCookie: () =&gt; stringifyCookie</span><span class="s3">\n</span><span class="s1">});</span><span class="s3">\n</span><span class="s1">module.exports = __toCommonJS(src_exports);</span><span class="s3">\n\n</span><span class="s1">// src/serialize.ts</span><span class="s3">\n</span><span class="s1">function stringifyCookie(c) {</span><span class="s3">\n  </span><span class="s1">var _a;</span><span class="s3">\n  </span><span class="s1">const attrs = [</span><span class="s3">\n    \&quot;</span><span class="s1">path</span><span class="s3">\&quot; </span><span class="s1">in c &amp;&amp; c.path &amp;&amp; `Path=${c.path}`,</span><span class="s3">\n    \&quot;</span><span class="s1">expires</span><span class="s3">\&quot; </span><span class="s1">in c &amp;&amp; (c.expires || c.expires === 0) &amp;&amp; `Expires=${(typeof c.expires === </span><span class="s3">\&quot;</span><span class="s1">number</span><span class="s3">\&quot; </span><span class="s1">? new Date(c.expires) : c.expires).toUTCString()}`,</span><span class="s3">\n    \&quot;</span><span class="s1">maxAge</span><span class="s3">\&quot; </span><span class="s1">in c &amp;&amp; typeof c.maxAge === </span><span class="s3">\&quot;</span><span class="s1">number</span><span class="s3">\&quot; </span><span class="s1">&amp;&amp; `Max-Age=${c.maxAge}`,</span><span class="s3">\n    \&quot;</span><span class="s1">domain</span><span class="s3">\&quot; </span><span class="s1">in c &amp;&amp; c.domain &amp;&amp; `Domain=${c.domain}`,</span><span class="s3">\n    \&quot;</span><span class="s1">secure</span><span class="s3">\&quot; </span><span class="s1">in c &amp;&amp; c.secure &amp;&amp; </span><span class="s3">\&quot;</span><span class="s1">Secure</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    \&quot;</span><span class="s1">httpOnly</span><span class="s3">\&quot; </span><span class="s1">in c &amp;&amp; c.httpOnly &amp;&amp; </span><span class="s3">\&quot;</span><span class="s1">HttpOnly</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    \&quot;</span><span class="s1">sameSite</span><span class="s3">\&quot; </span><span class="s1">in c &amp;&amp; c.sameSite &amp;&amp; `SameSite=${c.sameSite}`,</span><span class="s3">\n    \&quot;</span><span class="s1">partitioned</span><span class="s3">\&quot; </span><span class="s1">in c &amp;&amp; c.partitioned &amp;&amp; </span><span class="s3">\&quot;</span><span class="s1">Partitioned</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    \&quot;</span><span class="s1">priority</span><span class="s3">\&quot; </span><span class="s1">in c &amp;&amp; c.priority &amp;&amp; `Priority=${c.priority}`</span><span class="s3">\n  </span><span class="s1">].filter(Boolean);</span><span class="s3">\n  </span><span class="s1">const stringified = `${c.name}=${encodeURIComponent((_a = c.value) != null ? _a : </span><span class="s3">\&quot;\&quot;</span><span class="s1">)}`;</span><span class="s3">\n  </span><span class="s1">return attrs.length === 0 ? stringified : `${stringified}; ${attrs.join(</span><span class="s3">\&quot;</span><span class="s1">; </span><span class="s3">\&quot;</span><span class="s1">)}`;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">function parseCookie(cookie) {</span><span class="s3">\n  </span><span class="s1">const map = /* @__PURE__ */ new Map();</span><span class="s3">\n  </span><span class="s1">for (const pair of cookie.split(/; */)) {</span><span class="s3">\n    </span><span class="s1">if (!pair)</span><span class="s3">\n      </span><span class="s1">continue;</span><span class="s3">\n    </span><span class="s1">const splitAt = pair.indexOf(</span><span class="s3">\&quot;</span><span class="s1">=</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">if (splitAt === -1) {</span><span class="s3">\n      </span><span class="s1">map.set(pair, </span><span class="s3">\&quot;</span><span class="s1">true</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">continue;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const [key, value] = [pair.slice(0, splitAt), pair.slice(splitAt + 1)];</span><span class="s3">\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">map.set(key, decodeURIComponent(value != null ? value : </span><span class="s3">\&quot;</span><span class="s1">true</span><span class="s3">\&quot;</span><span class="s1">));</span><span class="s3">\n    </span><span class="s1">} catch {</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return map;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">function parseSetCookie(setCookie) {</span><span class="s3">\n  </span><span class="s1">if (!setCookie) {</span><span class="s3">\n    </span><span class="s1">return void 0;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const [[name, value], ...attributes] = parseCookie(setCookie);</span><span class="s3">\n  </span><span class="s1">const {</span><span class="s3">\n    </span><span class="s1">domain,</span><span class="s3">\n    </span><span class="s1">expires,</span><span class="s3">\n    </span><span class="s1">httponly,</span><span class="s3">\n    </span><span class="s1">maxage,</span><span class="s3">\n    </span><span class="s1">path,</span><span class="s3">\n    </span><span class="s1">samesite,</span><span class="s3">\n    </span><span class="s1">secure,</span><span class="s3">\n    </span><span class="s1">partitioned,</span><span class="s3">\n    </span><span class="s1">priority</span><span class="s3">\n  </span><span class="s1">} = Object.fromEntries(</span><span class="s3">\n    </span><span class="s1">attributes.map(([key, value2]) =&gt; [</span><span class="s3">\n      </span><span class="s1">key.toLowerCase().replace(/-/g, </span><span class="s3">\&quot;\&quot;</span><span class="s1">),</span><span class="s3">\n      </span><span class="s1">value2</span><span class="s3">\n    </span><span class="s1">])</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">const cookie = {</span><span class="s3">\n    </span><span class="s1">name,</span><span class="s3">\n    </span><span class="s1">value: decodeURIComponent(value),</span><span class="s3">\n    </span><span class="s1">domain,</span><span class="s3">\n    </span><span class="s1">...expires &amp;&amp; { expires: new Date(expires) },</span><span class="s3">\n    </span><span class="s1">...httponly &amp;&amp; { httpOnly: true },</span><span class="s3">\n    </span><span class="s1">...typeof maxage === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot; </span><span class="s1">&amp;&amp; { maxAge: Number(maxage) },</span><span class="s3">\n    </span><span class="s1">path,</span><span class="s3">\n    </span><span class="s1">...samesite &amp;&amp; { sameSite: parseSameSite(samesite) },</span><span class="s3">\n    </span><span class="s1">...secure &amp;&amp; { secure: true },</span><span class="s3">\n    </span><span class="s1">...priority &amp;&amp; { priority: parsePriority(priority) },</span><span class="s3">\n    </span><span class="s1">...partitioned &amp;&amp; { partitioned: true }</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">return compact(cookie);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">function compact(t) {</span><span class="s3">\n  </span><span class="s1">const newT = {};</span><span class="s3">\n  </span><span class="s1">for (const key in t) {</span><span class="s3">\n    </span><span class="s1">if (t[key]) {</span><span class="s3">\n      </span><span class="s1">newT[key] = t[key];</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return newT;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">var SAME_SITE = [</span><span class="s3">\&quot;</span><span class="s1">strict</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">lax</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">none</span><span class="s3">\&quot;</span><span class="s1">];</span><span class="s3">\n</span><span class="s1">function parseSameSite(string) {</span><span class="s3">\n  </span><span class="s1">string = string.toLowerCase();</span><span class="s3">\n  </span><span class="s1">return SAME_SITE.includes(string) ? string : void 0;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">var PRIORITY = [</span><span class="s3">\&quot;</span><span class="s1">low</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">medium</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">high</span><span class="s3">\&quot;</span><span class="s1">];</span><span class="s3">\n</span><span class="s1">function parsePriority(string) {</span><span class="s3">\n  </span><span class="s1">string = string.toLowerCase();</span><span class="s3">\n  </span><span class="s1">return PRIORITY.includes(string) ? string : void 0;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">function splitCookiesString(cookiesString) {</span><span class="s3">\n  </span><span class="s1">if (!cookiesString)</span><span class="s3">\n    </span><span class="s1">return [];</span><span class="s3">\n  </span><span class="s1">var cookiesStrings = [];</span><span class="s3">\n  </span><span class="s1">var pos = 0;</span><span class="s3">\n  </span><span class="s1">var start;</span><span class="s3">\n  </span><span class="s1">var ch;</span><span class="s3">\n  </span><span class="s1">var lastComma;</span><span class="s3">\n  </span><span class="s1">var nextStart;</span><span class="s3">\n  </span><span class="s1">var cookiesSeparatorFound;</span><span class="s3">\n  </span><span class="s1">function skipWhitespace() {</span><span class="s3">\n    </span><span class="s1">while (pos &lt; cookiesString.length &amp;&amp; /</span><span class="s3">\\</span><span class="s1">s/.test(cookiesString.charAt(pos))) {</span><span class="s3">\n      </span><span class="s1">pos += 1;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return pos &lt; cookiesString.length;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">function notSpecialChar() {</span><span class="s3">\n    </span><span class="s1">ch = cookiesString.charAt(pos);</span><span class="s3">\n    </span><span class="s1">return ch !== </span><span class="s3">\&quot;</span><span class="s1">=</span><span class="s3">\&quot; </span><span class="s1">&amp;&amp; ch !== </span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\&quot; </span><span class="s1">&amp;&amp; ch !== </span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">while (pos &lt; cookiesString.length) {</span><span class="s3">\n    </span><span class="s1">start = pos;</span><span class="s3">\n    </span><span class="s1">cookiesSeparatorFound = false;</span><span class="s3">\n    </span><span class="s1">while (skipWhitespace()) {</span><span class="s3">\n      </span><span class="s1">ch = cookiesString.charAt(pos);</span><span class="s3">\n      </span><span class="s1">if (ch === </span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">lastComma = pos;</span><span class="s3">\n        </span><span class="s1">pos += 1;</span><span class="s3">\n        </span><span class="s1">skipWhitespace();</span><span class="s3">\n        </span><span class="s1">nextStart = pos;</span><span class="s3">\n        </span><span class="s1">while (pos &lt; cookiesString.length &amp;&amp; notSpecialChar()) {</span><span class="s3">\n          </span><span class="s1">pos += 1;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">if (pos &lt; cookiesString.length &amp;&amp; cookiesString.charAt(pos) === </span><span class="s3">\&quot;</span><span class="s1">=</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">cookiesSeparatorFound = true;</span><span class="s3">\n          </span><span class="s1">pos = nextStart;</span><span class="s3">\n          </span><span class="s1">cookiesStrings.push(cookiesString.substring(start, lastComma));</span><span class="s3">\n          </span><span class="s1">start = pos;</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">pos = lastComma + 1;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">pos += 1;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">if (!cookiesSeparatorFound || pos &gt;= cookiesString.length) {</span><span class="s3">\n      </span><span class="s1">cookiesStrings.push(cookiesString.substring(start, cookiesString.length));</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return cookiesStrings;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// src/request-cookies.ts</span><span class="s3">\n</span><span class="s1">var RequestCookies = class {</span><span class="s3">\n  </span><span class="s1">constructor(requestHeaders) {</span><span class="s3">\n    </span><span class="s1">/** @internal */</span><span class="s3">\n    </span><span class="s1">this._parsed = /* @__PURE__ */ new Map();</span><span class="s3">\n    </span><span class="s1">this._headers = requestHeaders;</span><span class="s3">\n    </span><span class="s1">const header = requestHeaders.get(</span><span class="s3">\&quot;</span><span class="s1">cookie</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">if (header) {</span><span class="s3">\n      </span><span class="s1">const parsed = parseCookie(header);</span><span class="s3">\n      </span><span class="s1">for (const [name, value] of parsed) {</span><span class="s3">\n        </span><span class="s1">this._parsed.set(name, { name, value });</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">[Symbol.iterator]() {</span><span class="s3">\n    </span><span class="s1">return this._parsed[Symbol.iterator]();</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The amount of cookies received from the client</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">get size() {</span><span class="s3">\n    </span><span class="s1">return this._parsed.size;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">get(...args) {</span><span class="s3">\n    </span><span class="s1">const name = typeof args[0] === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot; </span><span class="s1">? args[0] : args[0].name;</span><span class="s3">\n    </span><span class="s1">return this._parsed.get(name);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">getAll(...args) {</span><span class="s3">\n    </span><span class="s1">var _a;</span><span class="s3">\n    </span><span class="s1">const all = Array.from(this._parsed);</span><span class="s3">\n    </span><span class="s1">if (!args.length) {</span><span class="s3">\n      </span><span class="s1">return all.map(([_, value]) =&gt; value);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const name = typeof args[0] === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot; </span><span class="s1">? args[0] : (_a = args[0]) == null ? void 0 : _a.name;</span><span class="s3">\n    </span><span class="s1">return all.filter(([n]) =&gt; n === name).map(([_, value]) =&gt; value);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">has(name) {</span><span class="s3">\n    </span><span class="s1">return this._parsed.has(name);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">set(...args) {</span><span class="s3">\n    </span><span class="s1">const [name, value] = args.length === 1 ? [args[0].name, args[0].value] : args;</span><span class="s3">\n    </span><span class="s1">const map = this._parsed;</span><span class="s3">\n    </span><span class="s1">map.set(name, { name, value });</span><span class="s3">\n    </span><span class="s1">this._headers.set(</span><span class="s3">\n      \&quot;</span><span class="s1">cookie</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n      </span><span class="s1">Array.from(map).map(([_, value2]) =&gt; stringifyCookie(value2)).join(</span><span class="s3">\&quot;</span><span class="s1">; </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">return this;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Delete the cookies matching the passed name or names in the request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">delete(names) {</span><span class="s3">\n    </span><span class="s1">const map = this._parsed;</span><span class="s3">\n    </span><span class="s1">const result = !Array.isArray(names) ? map.delete(names) : names.map((name) =&gt; map.delete(name));</span><span class="s3">\n    </span><span class="s1">this._headers.set(</span><span class="s3">\n      \&quot;</span><span class="s1">cookie</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n      </span><span class="s1">Array.from(map).map(([_, value]) =&gt; stringifyCookie(value)).join(</span><span class="s3">\&quot;</span><span class="s1">; </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">return result;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Delete all the cookies in the cookies in the request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">clear() {</span><span class="s3">\n    </span><span class="s1">this.delete(Array.from(this._parsed.keys()));</span><span class="s3">\n    </span><span class="s1">return this;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Format the cookies in the request as a string for logging</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">[Symbol.for(</span><span class="s3">\&quot;</span><span class="s1">edge-runtime.inspect.custom</span><span class="s3">\&quot;</span><span class="s1">)]() {</span><span class="s3">\n    </span><span class="s1">return `RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">toString() {</span><span class="s3">\n    </span><span class="s1">return [...this._parsed.values()].map((v) =&gt; `${v.name}=${encodeURIComponent(v.value)}`).join(</span><span class="s3">\&quot;</span><span class="s1">; </span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">// src/response-cookies.ts</span><span class="s3">\n</span><span class="s1">var ResponseCookies = class {</span><span class="s3">\n  </span><span class="s1">constructor(responseHeaders) {</span><span class="s3">\n    </span><span class="s1">/** @internal */</span><span class="s3">\n    </span><span class="s1">this._parsed = /* @__PURE__ */ new Map();</span><span class="s3">\n    </span><span class="s1">var _a, _b, _c;</span><span class="s3">\n    </span><span class="s1">this._headers = responseHeaders;</span><span class="s3">\n    </span><span class="s1">const setCookie = (_c = (_b = (_a = responseHeaders.getSetCookie) == null ? void 0 : _a.call(responseHeaders)) != null ? _b : responseHeaders.get(</span><span class="s3">\&quot;</span><span class="s1">set-cookie</span><span class="s3">\&quot;</span><span class="s1">)) != null ? _c : [];</span><span class="s3">\n    </span><span class="s1">const cookieStrings = Array.isArray(setCookie) ? setCookie : splitCookiesString(setCookie);</span><span class="s3">\n    </span><span class="s1">for (const cookieString of cookieStrings) {</span><span class="s3">\n      </span><span class="s1">const parsed = parseSetCookie(cookieString);</span><span class="s3">\n      </span><span class="s1">if (parsed)</span><span class="s3">\n        </span><span class="s1">this._parsed.set(parsed.name, parsed);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* {@link https://wicg.github.io/cookie-store/#CookieStore-get CookieStore#get} without the Promise.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">get(...args) {</span><span class="s3">\n    </span><span class="s1">const key = typeof args[0] === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot; </span><span class="s1">? args[0] : args[0].name;</span><span class="s3">\n    </span><span class="s1">return this._parsed.get(key);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* {@link https://wicg.github.io/cookie-store/#CookieStore-getAll CookieStore#getAll} without the Promise.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">getAll(...args) {</span><span class="s3">\n    </span><span class="s1">var _a;</span><span class="s3">\n    </span><span class="s1">const all = Array.from(this._parsed.values());</span><span class="s3">\n    </span><span class="s1">if (!args.length) {</span><span class="s3">\n      </span><span class="s1">return all;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const key = typeof args[0] === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot; </span><span class="s1">? args[0] : (_a = args[0]) == null ? void 0 : _a.name;</span><span class="s3">\n    </span><span class="s1">return all.filter((c) =&gt; c.name === key);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">has(name) {</span><span class="s3">\n    </span><span class="s1">return this._parsed.has(name);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* {@link https://wicg.github.io/cookie-store/#CookieStore-set CookieStore#set} without the Promise.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">set(...args) {</span><span class="s3">\n    </span><span class="s1">const [name, value, cookie] = args.length === 1 ? [args[0].name, args[0].value, args[0]] : args;</span><span class="s3">\n    </span><span class="s1">const map = this._parsed;</span><span class="s3">\n    </span><span class="s1">map.set(name, normalizeCookie({ name, value, ...cookie }));</span><span class="s3">\n    </span><span class="s1">replace(map, this._headers);</span><span class="s3">\n    </span><span class="s1">return this;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* {@link https://wicg.github.io/cookie-store/#CookieStore-delete CookieStore#delete} without the Promise.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">delete(...args) {</span><span class="s3">\n    </span><span class="s1">const [name, options] = typeof args[0] === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot; </span><span class="s1">? [args[0]] : [args[0].name, args[0]];</span><span class="s3">\n    </span><span class="s1">return this.set({ ...options, name, value: </span><span class="s3">\&quot;\&quot;</span><span class="s1">, expires: /* @__PURE__ */ new Date(0) });</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">[Symbol.for(</span><span class="s3">\&quot;</span><span class="s1">edge-runtime.inspect.custom</span><span class="s3">\&quot;</span><span class="s1">)]() {</span><span class="s3">\n    </span><span class="s1">return `ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">toString() {</span><span class="s3">\n    </span><span class="s1">return [...this._parsed.values()].map(stringifyCookie).join(</span><span class="s3">\&quot;</span><span class="s1">; </span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">function replace(bag, headers) {</span><span class="s3">\n  </span><span class="s1">headers.delete(</span><span class="s3">\&quot;</span><span class="s1">set-cookie</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">for (const [, value] of bag) {</span><span class="s3">\n    </span><span class="s1">const serialized = stringifyCookie(value);</span><span class="s3">\n    </span><span class="s1">headers.append(</span><span class="s3">\&quot;</span><span class="s1">set-cookie</span><span class="s3">\&quot;</span><span class="s1">, serialized);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">function normalizeCookie(cookie = { name: </span><span class="s3">\&quot;\&quot;</span><span class="s1">, value: </span><span class="s3">\&quot;\&quot; </span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">if (typeof cookie.expires === </span><span class="s3">\&quot;</span><span class="s1">number</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">cookie.expires = new Date(cookie.expires);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (cookie.maxAge) {</span><span class="s3">\n    </span><span class="s1">cookie.expires = new Date(Date.now() + cookie.maxAge * 1e3);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (cookie.path === null || cookie.path === void 0) {</span><span class="s3">\n    </span><span class="s1">cookie.path = </span><span class="s3">\&quot;</span><span class="s1">/</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return cookie;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">// Annotate the CommonJS export names for ESM import in node:</span><span class="s3">\n</span><span class="s1">0 &amp;&amp; (module.exports = {</span><span class="s3">\n  </span><span class="s1">RequestCookies,</span><span class="s3">\n  </span><span class="s1">ResponseCookies,</span><span class="s3">\n  </span><span class="s1">parseCookie,</span><span class="s3">\n  </span><span class="s1">parseSetCookie,</span><span class="s3">\n  </span><span class="s1">stringifyCookie</span><span class="s3">\n</span><span class="s1">});</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5330</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/web/spec-extension/cookies.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export {</span><span class="s3">\n  </span><span class="s1">RequestCookies,</span><span class="s3">\n  </span><span class="s1">ResponseCookies,</span><span class="s3">\n  </span><span class="s1">stringifyCookie,</span><span class="s3">\n</span><span class="s1">} from 'next/dist/compiled/@edge-runtime/cookies'</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RequestCookies&quot;</span><span class="s0">,</span><span class="s1">&quot;ResponseCookies&quot;</span><span class="s0">,</span><span class="s1">&quot;stringifyCookie&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;AAAA,SACEA,cAAc,EACdC,eAAe,EACfC,eAAe,QACV,2CAA0C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5337</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/web/spec-extension/request.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { I18NConfig } from '../../config-shared'</span><span class="s3">\n</span><span class="s1">import { NextURL } from '../next-url'</span><span class="s3">\n</span><span class="s1">import { toNodeOutgoingHttpHeaders, validateURL } from '../utils'</span><span class="s3">\n</span><span class="s1">import { RemovedUAError, RemovedPageError } from '../error'</span><span class="s3">\n</span><span class="s1">import { RequestCookies } from './cookies'</span><span class="s3">\n\n</span><span class="s1">export const INTERNALS = Symbol('internal request')</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This class extends the [Web `Request` API](https://developer.mozilla.org/docs/Web/API/Request) with additional convenience methods.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `NextRequest`](https://nextjs.org/docs/app/api-reference/functions/next-request)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class NextRequest extends Request {</span><span class="s3">\n  </span><span class="s1">/** @internal */</span><span class="s3">\n  </span><span class="s1">[INTERNALS]: {</span><span class="s3">\n    </span><span class="s1">cookies: RequestCookies</span><span class="s3">\n    </span><span class="s1">url: string</span><span class="s3">\n    </span><span class="s1">nextUrl: NextURL</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">constructor(input: URL | RequestInfo, init: RequestInit = {}) {</span><span class="s3">\n    </span><span class="s1">const url =</span><span class="s3">\n      </span><span class="s1">typeof input !== 'string' &amp;&amp; 'url' in input ? input.url : String(input)</span><span class="s3">\n\n    </span><span class="s1">validateURL(url)</span><span class="s3">\n\n    </span><span class="s1">// node Request instance requires duplex option when a body</span><span class="s3">\n    </span><span class="s1">// is present or it errors, we don't handle this for</span><span class="s3">\n    </span><span class="s1">// Request being passed in since it would have already</span><span class="s3">\n    </span><span class="s1">// errored if this wasn't configured</span><span class="s3">\n    </span><span class="s1">if (process.env.NEXT_RUNTIME !== 'edge') {</span><span class="s3">\n      </span><span class="s1">if (init.body &amp;&amp; init.duplex !== 'half') {</span><span class="s3">\n        </span><span class="s1">init.duplex = 'half'</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (input instanceof Request) super(input, init)</span><span class="s3">\n    </span><span class="s1">else super(url, init)</span><span class="s3">\n\n    </span><span class="s1">const nextUrl = new NextURL(url, {</span><span class="s3">\n      </span><span class="s1">headers: toNodeOutgoingHttpHeaders(this.headers),</span><span class="s3">\n      </span><span class="s1">nextConfig: init.nextConfig,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">this[INTERNALS] = {</span><span class="s3">\n      </span><span class="s1">cookies: new RequestCookies(this.headers),</span><span class="s3">\n      </span><span class="s1">nextUrl,</span><span class="s3">\n      </span><span class="s1">url: process.env.__NEXT_NO_MIDDLEWARE_URL_NORMALIZE</span><span class="s3">\n        </span><span class="s1">? url</span><span class="s3">\n        </span><span class="s1">: nextUrl.toString(),</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">[Symbol.for('edge-runtime.inspect.custom')]() {</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">cookies: this.cookies,</span><span class="s3">\n      </span><span class="s1">nextUrl: this.nextUrl,</span><span class="s3">\n      </span><span class="s1">url: this.url,</span><span class="s3">\n      </span><span class="s1">// rest of props come from Request</span><span class="s3">\n      </span><span class="s1">bodyUsed: this.bodyUsed,</span><span class="s3">\n      </span><span class="s1">cache: this.cache,</span><span class="s3">\n      </span><span class="s1">credentials: this.credentials,</span><span class="s3">\n      </span><span class="s1">destination: this.destination,</span><span class="s3">\n      </span><span class="s1">headers: Object.fromEntries(this.headers),</span><span class="s3">\n      </span><span class="s1">integrity: this.integrity,</span><span class="s3">\n      </span><span class="s1">keepalive: this.keepalive,</span><span class="s3">\n      </span><span class="s1">method: this.method,</span><span class="s3">\n      </span><span class="s1">mode: this.mode,</span><span class="s3">\n      </span><span class="s1">redirect: this.redirect,</span><span class="s3">\n      </span><span class="s1">referrer: this.referrer,</span><span class="s3">\n      </span><span class="s1">referrerPolicy: this.referrerPolicy,</span><span class="s3">\n      </span><span class="s1">signal: this.signal,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get cookies() {</span><span class="s3">\n    </span><span class="s1">return this[INTERNALS].cookies</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get nextUrl() {</span><span class="s3">\n    </span><span class="s1">return this[INTERNALS].nextUrl</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @deprecated</span><span class="s3">\n   </span><span class="s1">* `page` has been deprecated in favour of `URLPattern`.</span><span class="s3">\n   </span><span class="s1">* Read more: https://nextjs.org/docs/messages/middleware-request-page</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public get page() {</span><span class="s3">\n    </span><span class="s1">throw new RemovedPageError()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @deprecated</span><span class="s3">\n   </span><span class="s1">* `ua` has been removed in favour of </span><span class="s3">\\</span><span class="s1">`userAgent</span><span class="s3">\\</span><span class="s1">` function.</span><span class="s3">\n   </span><span class="s1">* Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public get ua() {</span><span class="s3">\n    </span><span class="s1">throw new RemovedUAError()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get url() {</span><span class="s3">\n    </span><span class="s1">return this[INTERNALS].url</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface RequestInit extends globalThis.RequestInit {</span><span class="s3">\n  </span><span class="s1">nextConfig?: {</span><span class="s3">\n    </span><span class="s1">basePath?: string</span><span class="s3">\n    </span><span class="s1">i18n?: I18NConfig | null</span><span class="s3">\n    </span><span class="s1">trailingSlash?: boolean</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">signal?: AbortSignal</span><span class="s3">\n  </span><span class="s1">// see https://github.com/whatwg/fetch/pull/1457</span><span class="s3">\n  </span><span class="s1">duplex?: 'half'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;NextURL&quot;</span><span class="s0">,</span><span class="s1">&quot;toNodeOutgoingHttpHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;validateURL&quot;</span><span class="s0">,</span><span class="s1">&quot;RemovedUAError&quot;</span><span class="s0">,</span><span class="s1">&quot;RemovedPageError&quot;</span><span class="s0">,</span><span class="s1">&quot;RequestCookies&quot;</span><span class="s0">,</span><span class="s1">&quot;INTERNALS&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;NextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;Request&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;input&quot;</span><span class="s0">,</span><span class="s1">&quot;init&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;duplex&quot;</span><span class="s0">,</span><span class="s1">&quot;nextUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;cookies&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_NO_MIDDLEWARE_URL_NORMALIZE&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;for&quot;</span><span class="s0">,</span><span class="s1">&quot;bodyUsed&quot;</span><span class="s0">,</span><span class="s1">&quot;cache&quot;</span><span class="s0">,</span><span class="s1">&quot;credentials&quot;</span><span class="s0">,</span><span class="s1">&quot;destination&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;fromEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;integrity&quot;</span><span class="s0">,</span><span class="s1">&quot;keepalive&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;mode&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;referrer&quot;</span><span class="s0">,</span><span class="s1">&quot;referrerPolicy&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;ua&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AACA,SAASA,OAAO,QAAQ,cAAa;AACrC,SAASC,yBAAyB,EAAEC,WAAW,QAAQ,WAAU;AACjE,SAASC,cAAc,EAAEC,gBAAgB,QAAQ,WAAU;;AAC3D,SAASC,cAAc,QAAQ,YAAW;;;;;AAEnC,MAAMC,YAAYC,OAAO,oBAAmB;AAO5C,MAAMC,oBAAoBC;IAQ/BC,YAAYC,KAAwB,EAAEC,OAAoB,CAAC,CAAC,CAAE;QAC5D,MAAMC,MACJ,OAAOF,UAAU,YAAY,SAASA,QAAQA,MAAME,GAAG,GAAGC,OAAOH;YAEnET,8KAAAA,EAAYW;QAEZ,2DAA2D;QAC3D,oDAAoD;QACpD,sDAAsD;QACtD,oCAAoC;QACpC,IAAIE,QAAQC,GAAG,CAACC,YAAY,KAAK,OAAQ;YACvC,IAAIL,KAAKM,IAAI,IAAIN,KAAKO,MAAM,KAAK,QAAQ;gBACvCP,KAAKO,MAAM,GAAG;YAChB;QACF;QAEA,IAAIR,iBAAiBF,SAAS,KAAK,CAACE,OAAOC;aACtC,KAAK,CAACC,KAAKD;QAEhB,MAAMQ,UAAU,IAAIpB,gLAAAA,CAAQa,KAAK;YAC/BQ,aAASpB,4LAAAA,EAA0B,IAAI,CAACoB,OAAO;YAC/CC,YAAYV,KAAKU,UAAU;QAC7B;QACA,IAAI,CAAChB,UAAU,GAAG;YAChBiB,SAAS,IAAIlB,qMAAAA,CAAe,IAAI,CAACgB,OAAO;YACxCD;YACAP,KAAKE,QAAQC,GAAG,CAACQ,0BACbX,QAD+C,kBAE/CO,QAAQK,QAAQ;QACtB;IACF;IAEA,CAAClB,OAAOmB,GAAG,CAAC,+BAA+B,GAAG;QAC5C,OAAO;YACLH,SAAS,IAAI,CAACA,OAAO;YACrBH,SAAS,IAAI,CAACA,OAAO;YACrBP,KAAK,IAAI,CAACA,GAAG;YACb,kCAAkC;YAClCc,UAAU,IAAI,CAACA,QAAQ;YACvBC,OAAO,IAAI,CAACA,KAAK;YACjBC,aAAa,IAAI,CAACA,WAAW;YAC7BC,aAAa,IAAI,CAACA,WAAW;YAC7BT,SAASU,OAAOC,WAAW,CAAC,IAAI,CAACX,OAAO;YACxCY,WAAW,IAAI,CAACA,SAAS;YACzBC,WAAW,IAAI,CAACA,SAAS;YACzBC,QAAQ,IAAI,CAACA,MAAM;YACnBC,MAAM,IAAI,CAACA,IAAI;YACfC,UAAU,IAAI,CAACA,QAAQ;YACvBC,UAAU,IAAI,CAACA,QAAQ;YACvBC,gBAAgB,IAAI,CAACA,cAAc;YACnCC,QAAQ,IAAI,CAACA,MAAM;QACrB;IACF;IAEA,IAAWjB,UAAU;QACnB,OAAO,IAAI,CAACjB,UAAU,CAACiB,OAAO;IAChC;IAEA,IAAWH,UAAU;QACnB,OAAO,IAAI,CAACd,UAAU,CAACc,OAAO;IAChC;IAEA;;;;GAIC,GACD,IAAWqB,OAAO;QAChB,MAAM,IAAIrC,mLAAAA;IACZ;IAEA;;;;GAIC,GACD,IAAWsC,KAAK;QACd,MAAM,IAAIvC,iLAAAA;IACZ;IAEA,IAAWU,MAAM;QACf,OAAO,IAAI,CAACP,UAAU,CAACO,GAAG;IAC5B;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5427</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/base-http/helpers.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { BaseNextRequest, BaseNextResponse } from './'</span><span class="s3">\n</span><span class="s1">import type { NodeNextRequest, NodeNextResponse } from './node'</span><span class="s3">\n</span><span class="s1">import type { WebNextRequest, WebNextResponse } from './web'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This file provides some helpers that should be used in conjunction with</span><span class="s3">\n </span><span class="s1">* explicit environment checks. When combined with the environment checks, it</span><span class="s3">\n </span><span class="s1">* will ensure that the correct typings are used as well as enable code</span><span class="s3">\n </span><span class="s1">* elimination.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Type guard to determine if a request is a WebNextRequest. This does not</span><span class="s3">\n </span><span class="s1">* actually check the type of the request, but rather the runtime environment.</span><span class="s3">\n </span><span class="s1">* It's expected that when the runtime environment is the edge runtime, that any</span><span class="s3">\n </span><span class="s1">* base request is a WebNextRequest.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const isWebNextRequest = (req: BaseNextRequest): req is WebNextRequest =&gt;</span><span class="s3">\n  </span><span class="s1">process.env.NEXT_RUNTIME === 'edge'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Type guard to determine if a response is a WebNextResponse. This does not</span><span class="s3">\n </span><span class="s1">* actually check the type of the response, but rather the runtime environment.</span><span class="s3">\n </span><span class="s1">* It's expected that when the runtime environment is the edge runtime, that any</span><span class="s3">\n </span><span class="s1">* base response is a WebNextResponse.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const isWebNextResponse = (</span><span class="s3">\n  </span><span class="s1">res: BaseNextResponse</span><span class="s3">\n</span><span class="s1">): res is WebNextResponse =&gt; process.env.NEXT_RUNTIME === 'edge'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Type guard to determine if a request is a NodeNextRequest. This does not</span><span class="s3">\n </span><span class="s1">* actually check the type of the request, but rather the runtime environment.</span><span class="s3">\n </span><span class="s1">* It's expected that when the runtime environment is the node runtime, that any</span><span class="s3">\n </span><span class="s1">* base request is a NodeNextRequest.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const isNodeNextRequest = (</span><span class="s3">\n  </span><span class="s1">req: BaseNextRequest</span><span class="s3">\n</span><span class="s1">): req is NodeNextRequest =&gt; process.env.NEXT_RUNTIME !== 'edge'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Type guard to determine if a response is a NodeNextResponse. This does not</span><span class="s3">\n </span><span class="s1">* actually check the type of the response, but rather the runtime environment.</span><span class="s3">\n </span><span class="s1">* It's expected that when the runtime environment is the node runtime, that any</span><span class="s3">\n </span><span class="s1">* base response is a NodeNextResponse.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const isNodeNextResponse = (</span><span class="s3">\n  </span><span class="s1">res: BaseNextResponse</span><span class="s3">\n</span><span class="s1">): res is NodeNextResponse =&gt; process.env.NEXT_RUNTIME !== 'edge'</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isWebNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;isWebNextResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;isNodeNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;isNodeNextResponse&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAIA;;;;;CAKC,GAED;;;;;CAKC,GACD;;;;;;;;;;AAAO,MAAMA,mBAAmB,CAACC,MAC/BC,QAAQC,GAAG,CAACC,YAAY,uBAAK,OAAM;AAQ9B,MAAMC,oBAAoB,CAC/BC,MAC2BJ,QAAQC,GAAG,CAACC,YAAY,uBAAK,OAAM;AAQzD,MAAMG,oBAAoB,CAC/BN,MAC2BC,QAAQC,GAAG,CAACC,YAAY,uBAAK,OAAM;AAQzD,MAAMI,qBAAqB,CAChCF,MAC4BJ,QAAQC,GAAG,CAACC,YAAY,uBAAK,OAAM&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5455</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/web/spec-extension/adapters/next-request.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { BaseNextRequest } from '../../../base-http'</span><span class="s3">\n</span><span class="s1">import type { NodeNextRequest } from '../../../base-http/node'</span><span class="s3">\n</span><span class="s1">import type { WebNextRequest } from '../../../base-http/web'</span><span class="s3">\n</span><span class="s1">import type { Writable } from 'node:stream'</span><span class="s3">\n\n</span><span class="s1">import { getRequestMeta } from '../../../request-meta'</span><span class="s3">\n</span><span class="s1">import { fromNodeOutgoingHttpHeaders } from '../../utils'</span><span class="s3">\n</span><span class="s1">import { NextRequest } from '../request'</span><span class="s3">\n</span><span class="s1">import { isNodeNextRequest, isWebNextRequest } from '../../../base-http/helpers'</span><span class="s3">\n\n</span><span class="s1">export const ResponseAbortedName = 'ResponseAborted'</span><span class="s3">\n</span><span class="s1">export class ResponseAborted extends Error {</span><span class="s3">\n  </span><span class="s1">public readonly name = ResponseAbortedName</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Creates an AbortController tied to the closing of a ServerResponse (or other</span><span class="s3">\n </span><span class="s1">* appropriate Writable).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* If the `close` event is fired before the `finish` event, then we'll send the</span><span class="s3">\n </span><span class="s1">* `abort` signal.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function createAbortController(response: Writable): AbortController {</span><span class="s3">\n  </span><span class="s1">const controller = new AbortController()</span><span class="s3">\n\n  </span><span class="s1">// If `finish` fires first, then `res.end()` has been called and the close is</span><span class="s3">\n  </span><span class="s1">// just us finishing the stream on our side. If `close` fires first, then we</span><span class="s3">\n  </span><span class="s1">// know the client disconnected before we finished.</span><span class="s3">\n  </span><span class="s1">response.once('close', () =&gt; {</span><span class="s3">\n    </span><span class="s1">if (response.writableFinished) return</span><span class="s3">\n\n    </span><span class="s1">controller.abort(new ResponseAborted())</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">return controller</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Creates an AbortSignal tied to the closing of a ServerResponse (or other</span><span class="s3">\n </span><span class="s1">* appropriate Writable).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This cannot be done with the request (IncomingMessage or Readable) because</span><span class="s3">\n </span><span class="s1">* the `abort` event will not fire if to data has been fully read (because that</span><span class="s3">\n </span><span class="s1">* will </span><span class="s3">\&quot;</span><span class="s1">close</span><span class="s3">\&quot; </span><span class="s1">the readable stream and nothing fires after that).</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function signalFromNodeResponse(response: Writable): AbortSignal {</span><span class="s3">\n  </span><span class="s1">const { errored, destroyed } = response</span><span class="s3">\n  </span><span class="s1">if (errored || destroyed) {</span><span class="s3">\n    </span><span class="s1">return AbortSignal.abort(errored ?? new ResponseAborted())</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { signal } = createAbortController(response)</span><span class="s3">\n  </span><span class="s1">return signal</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class NextRequestAdapter {</span><span class="s3">\n  </span><span class="s1">public static fromBaseNextRequest(</span><span class="s3">\n    </span><span class="s1">request: BaseNextRequest,</span><span class="s3">\n    </span><span class="s1">signal: AbortSignal</span><span class="s3">\n  </span><span class="s1">): NextRequest {</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">// The type check here ensures that `req` is correctly typed, and the</span><span class="s3">\n      </span><span class="s1">// environment variable check provides dead code elimination.</span><span class="s3">\n      </span><span class="s1">process.env.NEXT_RUNTIME === 'edge' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">isWebNextRequest(request)</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return NextRequestAdapter.fromWebNextRequest(request)</span><span class="s3">\n    </span><span class="s1">} else if (</span><span class="s3">\n      </span><span class="s1">// The type check here ensures that `req` is correctly typed, and the</span><span class="s3">\n      </span><span class="s1">// environment variable check provides dead code elimination.</span><span class="s3">\n      </span><span class="s1">process.env.NEXT_RUNTIME !== 'edge' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">isNodeNextRequest(request)</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return NextRequestAdapter.fromNodeNextRequest(request, signal)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">throw new Error('Invariant: Unsupported NextRequest type')</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public static fromNodeNextRequest(</span><span class="s3">\n    </span><span class="s1">request: NodeNextRequest,</span><span class="s3">\n    </span><span class="s1">signal: AbortSignal</span><span class="s3">\n  </span><span class="s1">): NextRequest {</span><span class="s3">\n    </span><span class="s1">// HEAD and GET requests can not have a body.</span><span class="s3">\n    </span><span class="s1">let body: BodyInit | null = null</span><span class="s3">\n    </span><span class="s1">if (request.method !== 'GET' &amp;&amp; request.method !== 'HEAD' &amp;&amp; request.body) {</span><span class="s3">\n      </span><span class="s1">// @ts-expect-error - this is handled by undici, when streams/web land use it instead</span><span class="s3">\n      </span><span class="s1">body = request.body</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">let url: URL</span><span class="s3">\n    </span><span class="s1">if (request.url.startsWith('http')) {</span><span class="s3">\n      </span><span class="s1">url = new URL(request.url)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">// Grab the full URL from the request metadata.</span><span class="s3">\n      </span><span class="s1">const base = getRequestMeta(request, 'initURL')</span><span class="s3">\n      </span><span class="s1">if (!base || !base.startsWith('http')) {</span><span class="s3">\n        </span><span class="s1">// Because the URL construction relies on the fact that the URL provided</span><span class="s3">\n        </span><span class="s1">// is absolute, we need to provide a base URL. We can't use the request</span><span class="s3">\n        </span><span class="s1">// URL because it's relative, so we use a dummy URL instead.</span><span class="s3">\n        </span><span class="s1">url = new URL(request.url, 'http://n')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">url = new URL(request.url, base)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return new NextRequest(url, {</span><span class="s3">\n      </span><span class="s1">method: request.method,</span><span class="s3">\n      </span><span class="s1">headers: fromNodeOutgoingHttpHeaders(request.headers),</span><span class="s3">\n      </span><span class="s1">duplex: 'half',</span><span class="s3">\n      </span><span class="s1">signal,</span><span class="s3">\n      </span><span class="s1">// geo</span><span class="s3">\n      </span><span class="s1">// ip</span><span class="s3">\n      </span><span class="s1">// nextConfig</span><span class="s3">\n\n      </span><span class="s1">// body can not be passed if request was aborted</span><span class="s3">\n      </span><span class="s1">// or we get a Request body was disturbed error</span><span class="s3">\n      </span><span class="s1">...(signal.aborted</span><span class="s3">\n        </span><span class="s1">? {}</span><span class="s3">\n        </span><span class="s1">: {</span><span class="s3">\n            </span><span class="s1">body,</span><span class="s3">\n          </span><span class="s1">}),</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public static fromWebNextRequest(request: WebNextRequest): NextRequest {</span><span class="s3">\n    </span><span class="s1">// HEAD and GET requests can not have a body.</span><span class="s3">\n    </span><span class="s1">let body: ReadableStream | null = null</span><span class="s3">\n    </span><span class="s1">if (request.method !== 'GET' &amp;&amp; request.method !== 'HEAD') {</span><span class="s3">\n      </span><span class="s1">body = request.body</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return new NextRequest(request.url, {</span><span class="s3">\n      </span><span class="s1">method: request.method,</span><span class="s3">\n      </span><span class="s1">headers: fromNodeOutgoingHttpHeaders(request.headers),</span><span class="s3">\n      </span><span class="s1">duplex: 'half',</span><span class="s3">\n      </span><span class="s1">signal: request.request.signal,</span><span class="s3">\n      </span><span class="s1">// geo</span><span class="s3">\n      </span><span class="s1">// ip</span><span class="s3">\n      </span><span class="s1">// nextConfig</span><span class="s3">\n\n      </span><span class="s1">// body can not be passed if request was aborted</span><span class="s3">\n      </span><span class="s1">// or we get a Request body was disturbed error</span><span class="s3">\n      </span><span class="s1">...(request.request.signal.aborted</span><span class="s3">\n        </span><span class="s1">? {}</span><span class="s3">\n        </span><span class="s1">: {</span><span class="s3">\n            </span><span class="s1">body,</span><span class="s3">\n          </span><span class="s1">}),</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getRequestMeta&quot;</span><span class="s0">,</span><span class="s1">&quot;fromNodeOutgoingHttpHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;NextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;isNodeNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;isWebNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;ResponseAbortedName&quot;</span><span class="s0">,</span><span class="s1">&quot;ResponseAborted&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;createAbortController&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;controller&quot;</span><span class="s0">,</span><span class="s1">&quot;AbortController&quot;</span><span class="s0">,</span><span class="s1">&quot;once&quot;</span><span class="s0">,</span><span class="s1">&quot;writableFinished&quot;</span><span class="s0">,</span><span class="s1">&quot;abort&quot;</span><span class="s0">,</span><span class="s1">&quot;signalFromNodeResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;errored&quot;</span><span class="s0">,</span><span class="s1">&quot;destroyed&quot;</span><span class="s0">,</span><span class="s1">&quot;AbortSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;NextRequestAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;fromBaseNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;fromWebNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;fromNodeNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;base&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;duplex&quot;</span><span class="s0">,</span><span class="s1">&quot;aborted&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5579</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/client-component-renderer-logger.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { AppPageModule } from './route-modules/app-page/module'</span><span class="s3">\n\n</span><span class="s1">// Combined load times for loading client components</span><span class="s3">\n</span><span class="s1">let clientComponentLoadStart = 0</span><span class="s3">\n</span><span class="s1">let clientComponentLoadTimes = 0</span><span class="s3">\n</span><span class="s1">let clientComponentLoadCount = 0</span><span class="s3">\n\n</span><span class="s1">export function wrapClientComponentLoader(</span><span class="s3">\n  </span><span class="s1">ComponentMod: AppPageModule</span><span class="s3">\n</span><span class="s1">): AppPageModule['__next_app__'] {</span><span class="s3">\n  </span><span class="s1">if (!('performance' in globalThis)) {</span><span class="s3">\n    </span><span class="s1">return ComponentMod.__next_app__</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">require: (...args) =&gt; {</span><span class="s3">\n      </span><span class="s1">const startTime = performance.now()</span><span class="s3">\n\n      </span><span class="s1">if (clientComponentLoadStart === 0) {</span><span class="s3">\n        </span><span class="s1">clientComponentLoadStart = startTime</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">clientComponentLoadCount += 1</span><span class="s3">\n        </span><span class="s1">return ComponentMod.__next_app__.require(...args)</span><span class="s3">\n      </span><span class="s1">} finally {</span><span class="s3">\n        </span><span class="s1">clientComponentLoadTimes += performance.now() - startTime</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">loadChunk: (...args) =&gt; {</span><span class="s3">\n      </span><span class="s1">const startTime = performance.now()</span><span class="s3">\n      </span><span class="s1">const result = ComponentMod.__next_app__.loadChunk(...args)</span><span class="s3">\n      </span><span class="s1">// Avoid wrapping `loadChunk`'s result in an extra promise in case something like React depends on its identity.</span><span class="s3">\n      </span><span class="s1">// We only need to know when it's settled.</span><span class="s3">\n      </span><span class="s1">result.finally(() =&gt; {</span><span class="s3">\n        </span><span class="s1">clientComponentLoadTimes += performance.now() - startTime</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">return result</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getClientComponentLoaderMetrics(</span><span class="s3">\n  </span><span class="s1">options: { reset?: boolean } = {}</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const metrics =</span><span class="s3">\n    </span><span class="s1">clientComponentLoadStart === 0</span><span class="s3">\n      </span><span class="s1">? undefined</span><span class="s3">\n      </span><span class="s1">: {</span><span class="s3">\n          </span><span class="s1">clientComponentLoadStart,</span><span class="s3">\n          </span><span class="s1">clientComponentLoadTimes,</span><span class="s3">\n          </span><span class="s1">clientComponentLoadCount,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (options.reset) {</span><span class="s3">\n    </span><span class="s1">clientComponentLoadStart = 0</span><span class="s3">\n    </span><span class="s1">clientComponentLoadTimes = 0</span><span class="s3">\n    </span><span class="s1">clientComponentLoadCount = 0</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return metrics</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;clientComponentLoadStart&quot;</span><span class="s0">,</span><span class="s1">&quot;clientComponentLoadTimes&quot;</span><span class="s0">,</span><span class="s1">&quot;clientComponentLoadCount&quot;</span><span class="s0">,</span><span class="s1">&quot;wrapClientComponentLoader&quot;</span><span class="s0">,</span><span class="s1">&quot;ComponentMod&quot;</span><span class="s0">,</span><span class="s1">&quot;globalThis&quot;</span><span class="s0">,</span><span class="s1">&quot;__next_app__&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;startTime&quot;</span><span class="s0">,</span><span class="s1">&quot;performance&quot;</span><span class="s0">,</span><span class="s1">&quot;now&quot;</span><span class="s0">,</span><span class="s1">&quot;loadChunk&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;finally&quot;</span><span class="s0">,</span><span class="s1">&quot;getClientComponentLoaderMetrics&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;metrics&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;reset&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAEA,oDAAoD;;;;;;;AACpD,IAAIA,2BAA2B;AAC/B,IAAIC,2BAA2B;AAC/B,IAAIC,2BAA2B;AAExB,SAASC,0BACdC,YAA2B;IAE3B,IAAI,CAAE,CAAA,iBAAiBC,UAAS,GAAI;QAClC,OAAOD,aAAaE,YAAY;IAClC;IAEA,OAAO;QACLC,SAAS,CAAC,GAAGC;YACX,MAAMC,YAAYC,YAAYC,GAAG;YAEjC,IAAIX,6BAA6B,GAAG;gBAClCA,2BAA2BS;YAC7B;YAEA,IAAI;gBACFP,4BAA4B;gBAC5B,OAAOE,aAAaE,YAAY,CAACC,OAAO,IAAIC;YAC9C,SAAU;gBACRP,4BAA4BS,YAAYC,GAAG,KAAKF;YAClD;QACF;QACAG,WAAW,CAAC,GAAGJ;YACb,MAAMC,YAAYC,YAAYC,GAAG;YACjC,MAAME,SAAST,aAAaE,YAAY,CAACM,SAAS,IAAIJ;YACtD,gHAAgH;YAChH,0CAA0C;YAC1CK,OAAOC,OAAO,CAAC;gBACbb,4BAA4BS,YAAYC,GAAG,KAAKF;YAClD;YACA,OAAOI;QACT;IACF;AACF;AAEO,SAASE,gCACdC,UAA+B,CAAC,CAAC;IAEjC,MAAMC,UACJjB,6BAA6B,IACzBkB,YACA;QACElB;QACAC;QACAC;IACF;IAEN,IAAIc,QAAQG,KAAK,EAAE;QACjBnB,2BAA2B;QAC3BC,2BAA2B;QAC3BC,2BAA2B;IAC7B;IAEA,OAAOe;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5635</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/pipe-readable.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { ServerResponse } from 'node:http'</span><span class="s3">\n\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">ResponseAbortedName,</span><span class="s3">\n  </span><span class="s1">createAbortController,</span><span class="s3">\n</span><span class="s1">} from './web/spec-extension/adapters/next-request'</span><span class="s3">\n</span><span class="s1">import { DetachedPromise } from '../lib/detached-promise'</span><span class="s3">\n</span><span class="s1">import { getTracer } from './lib/trace/tracer'</span><span class="s3">\n</span><span class="s1">import { NextNodeServerSpan } from './lib/trace/constants'</span><span class="s3">\n</span><span class="s1">import { getClientComponentLoaderMetrics } from './client-component-renderer-logger'</span><span class="s3">\n\n</span><span class="s1">export function isAbortError(e: any): e is Error &amp; { name: 'AbortError' } {</span><span class="s3">\n  </span><span class="s1">return e?.name === 'AbortError' || e?.name === ResponseAbortedName</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createWriterFromResponse(</span><span class="s3">\n  </span><span class="s1">res: ServerResponse,</span><span class="s3">\n  </span><span class="s1">waitUntilForEnd?: Promise&lt;unknown&gt;</span><span class="s3">\n</span><span class="s1">): WritableStream&lt;Uint8Array&gt; {</span><span class="s3">\n  </span><span class="s1">let started = false</span><span class="s3">\n\n  </span><span class="s1">// Create a promise that will resolve once the response has drained. See</span><span class="s3">\n  </span><span class="s1">// https://nodejs.org/api/stream.html#stream_event_drain</span><span class="s3">\n  </span><span class="s1">let drained = new DetachedPromise&lt;void&gt;()</span><span class="s3">\n  </span><span class="s1">function onDrain() {</span><span class="s3">\n    </span><span class="s1">drained.resolve()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">res.on('drain', onDrain)</span><span class="s3">\n\n  </span><span class="s1">// If the finish event fires, it means we shouldn't block and wait for the</span><span class="s3">\n  </span><span class="s1">// drain event.</span><span class="s3">\n  </span><span class="s1">res.once('close', () =&gt; {</span><span class="s3">\n    </span><span class="s1">res.off('drain', onDrain)</span><span class="s3">\n    </span><span class="s1">drained.resolve()</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">// Create a promise that will resolve once the response has finished. See</span><span class="s3">\n  </span><span class="s1">// https://nodejs.org/api/http.html#event-finish_1</span><span class="s3">\n  </span><span class="s1">const finished = new DetachedPromise&lt;void&gt;()</span><span class="s3">\n  </span><span class="s1">res.once('finish', () =&gt; {</span><span class="s3">\n    </span><span class="s1">finished.resolve()</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">// Create a writable stream that will write to the response.</span><span class="s3">\n  </span><span class="s1">return new WritableStream&lt;Uint8Array&gt;({</span><span class="s3">\n    </span><span class="s1">write: async (chunk) =&gt; {</span><span class="s3">\n      </span><span class="s1">// You'd think we'd want to use `start` instead of placing this in `write`</span><span class="s3">\n      </span><span class="s1">// but this ensures that we don't actually flush the headers until we've</span><span class="s3">\n      </span><span class="s1">// started writing chunks.</span><span class="s3">\n      </span><span class="s1">if (!started) {</span><span class="s3">\n        </span><span class="s1">started = true</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">'performance' in globalThis &amp;&amp;</span><span class="s3">\n          </span><span class="s1">process.env.NEXT_OTEL_PERFORMANCE_PREFIX</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">const metrics = getClientComponentLoaderMetrics()</span><span class="s3">\n          </span><span class="s1">if (metrics) {</span><span class="s3">\n            </span><span class="s1">performance.measure(</span><span class="s3">\n              </span><span class="s1">`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-client-component-loading`,</span><span class="s3">\n              </span><span class="s1">{</span><span class="s3">\n                </span><span class="s1">start: metrics.clientComponentLoadStart,</span><span class="s3">\n                </span><span class="s1">end:</span><span class="s3">\n                  </span><span class="s1">metrics.clientComponentLoadStart +</span><span class="s3">\n                  </span><span class="s1">metrics.clientComponentLoadTimes,</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">res.flushHeaders()</span><span class="s3">\n        </span><span class="s1">getTracer().trace(</span><span class="s3">\n          </span><span class="s1">NextNodeServerSpan.startResponse,</span><span class="s3">\n          </span><span class="s1">{</span><span class="s3">\n            </span><span class="s1">spanName: 'start response',</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">() =&gt; undefined</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">const ok = res.write(chunk)</span><span class="s3">\n\n        </span><span class="s1">// Added by the `compression` middleware, this is a function that will</span><span class="s3">\n        </span><span class="s1">// flush the partially-compressed response to the client.</span><span class="s3">\n        </span><span class="s1">if ('flush' in res &amp;&amp; typeof res.flush === 'function') {</span><span class="s3">\n          </span><span class="s1">res.flush()</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// If the write returns false, it means there's some backpressure, so</span><span class="s3">\n        </span><span class="s1">// wait until it's streamed before continuing.</span><span class="s3">\n        </span><span class="s1">if (!ok) {</span><span class="s3">\n          </span><span class="s1">await drained.promise</span><span class="s3">\n\n          </span><span class="s1">// Reset the drained promise so that we can wait for the next drain event.</span><span class="s3">\n          </span><span class="s1">drained = new DetachedPromise&lt;void&gt;()</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} catch (err) {</span><span class="s3">\n        </span><span class="s1">res.end()</span><span class="s3">\n        </span><span class="s1">throw new Error('failed to write chunk to response', { cause: err })</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">abort: (err) =&gt; {</span><span class="s3">\n      </span><span class="s1">if (res.writableFinished) return</span><span class="s3">\n\n      </span><span class="s1">res.destroy(err)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">close: async () =&gt; {</span><span class="s3">\n      </span><span class="s1">// if a waitUntil promise was passed, wait for it to resolve before</span><span class="s3">\n      </span><span class="s1">// ending the response.</span><span class="s3">\n      </span><span class="s1">if (waitUntilForEnd) {</span><span class="s3">\n        </span><span class="s1">await waitUntilForEnd</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (res.writableFinished) return</span><span class="s3">\n\n      </span><span class="s1">res.end()</span><span class="s3">\n      </span><span class="s1">return finished.promise</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function pipeToNodeResponse(</span><span class="s3">\n  </span><span class="s1">readable: ReadableStream&lt;Uint8Array&gt;,</span><span class="s3">\n  </span><span class="s1">res: ServerResponse,</span><span class="s3">\n  </span><span class="s1">waitUntilForEnd?: Promise&lt;unknown&gt;</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">// If the response has already errored, then just return now.</span><span class="s3">\n    </span><span class="s1">const { errored, destroyed } = res</span><span class="s3">\n    </span><span class="s1">if (errored || destroyed) return</span><span class="s3">\n\n    </span><span class="s1">// Create a new AbortController so that we can abort the readable if the</span><span class="s3">\n    </span><span class="s1">// client disconnects.</span><span class="s3">\n    </span><span class="s1">const controller = createAbortController(res)</span><span class="s3">\n\n    </span><span class="s1">const writer = createWriterFromResponse(res, waitUntilForEnd)</span><span class="s3">\n\n    </span><span class="s1">await readable.pipeTo(writer, { signal: controller.signal })</span><span class="s3">\n  </span><span class="s1">} catch (err: any) {</span><span class="s3">\n    </span><span class="s1">// If this isn't related to an abort error, re-throw it.</span><span class="s3">\n    </span><span class="s1">if (isAbortError(err)) return</span><span class="s3">\n\n    </span><span class="s1">throw new Error('failed to pipe response', { cause: err })</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ResponseAbortedName&quot;</span><span class="s0">,</span><span class="s1">&quot;createAbortController&quot;</span><span class="s0">,</span><span class="s1">&quot;DetachedPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;getTracer&quot;</span><span class="s0">,</span><span class="s1">&quot;NextNodeServerSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;getClientComponentLoaderMetrics&quot;</span><span class="s0">,</span><span class="s1">&quot;isAbortError&quot;</span><span class="s0">,</span><span class="s1">&quot;e&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;createWriterFromResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;waitUntilForEnd&quot;</span><span class="s0">,</span><span class="s1">&quot;started&quot;</span><span class="s0">,</span><span class="s1">&quot;drained&quot;</span><span class="s0">,</span><span class="s1">&quot;onDrain&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;on&quot;</span><span class="s0">,</span><span class="s1">&quot;once&quot;</span><span class="s0">,</span><span class="s1">&quot;off&quot;</span><span class="s0">,</span><span class="s1">&quot;finished&quot;</span><span class="s0">,</span><span class="s1">&quot;WritableStream&quot;</span><span class="s0">,</span><span class="s1">&quot;write&quot;</span><span class="s0">,</span><span class="s1">&quot;chunk&quot;</span><span class="s0">,</span><span class="s1">&quot;globalThis&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_OTEL_PERFORMANCE_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;metrics&quot;</span><span class="s0">,</span><span class="s1">&quot;performance&quot;</span><span class="s0">,</span><span class="s1">&quot;measure&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;clientComponentLoadStart&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;clientComponentLoadTimes&quot;</span><span class="s0">,</span><span class="s1">&quot;flushHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;trace&quot;</span><span class="s0">,</span><span class="s1">&quot;startResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;spanName&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;ok&quot;</span><span class="s0">,</span><span class="s1">&quot;flush&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;cause&quot;</span><span class="s0">,</span><span class="s1">&quot;abort&quot;</span><span class="s0">,</span><span class="s1">&quot;writableFinished&quot;</span><span class="s0">,</span><span class="s1">&quot;destroy&quot;</span><span class="s0">,</span><span class="s1">&quot;close&quot;</span><span class="s0">,</span><span class="s1">&quot;pipeToNodeResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;readable&quot;</span><span class="s0">,</span><span class="s1">&quot;errored&quot;</span><span class="s0">,</span><span class="s1">&quot;destroyed&quot;</span><span class="s0">,</span><span class="s1">&quot;controller&quot;</span><span class="s0">,</span><span class="s1">&quot;writer&quot;</span><span class="s0">,</span><span class="s1">&quot;pipeTo&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5766</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/render-result.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { OutgoingHttpHeaders, ServerResponse } from 'http'</span><span class="s3">\n</span><span class="s1">import type { CacheControl } from './lib/cache-control'</span><span class="s3">\n</span><span class="s1">import type { FetchMetrics } from './base-http'</span><span class="s3">\n\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">chainStreams,</span><span class="s3">\n  </span><span class="s1">streamFromBuffer,</span><span class="s3">\n  </span><span class="s1">streamFromString,</span><span class="s3">\n  </span><span class="s1">streamToString,</span><span class="s3">\n</span><span class="s1">} from './stream-utils/node-web-streams-helper'</span><span class="s3">\n</span><span class="s1">import { isAbortError, pipeToNodeResponse } from './pipe-readable'</span><span class="s3">\n</span><span class="s1">import type { RenderResumeDataCache } from './resume-data-cache/resume-data-cache'</span><span class="s3">\n</span><span class="s1">import { InvariantError } from '../shared/lib/invariant-error'</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">HTML_CONTENT_TYPE_HEADER,</span><span class="s3">\n  </span><span class="s1">JSON_CONTENT_TYPE_HEADER,</span><span class="s3">\n  </span><span class="s1">TEXT_PLAIN_CONTENT_TYPE_HEADER,</span><span class="s3">\n</span><span class="s1">} from '../lib/constants'</span><span class="s3">\n</span><span class="s1">import type { RSC_CONTENT_TYPE_HEADER } from '../client/components/app-router-headers'</span><span class="s3">\n\n</span><span class="s1">type ContentTypeOption =</span><span class="s3">\n  </span><span class="s1">| typeof RSC_CONTENT_TYPE_HEADER // For App Page RSC responses</span><span class="s3">\n  </span><span class="s1">| typeof HTML_CONTENT_TYPE_HEADER // For App Page, Pages HTML responses</span><span class="s3">\n  </span><span class="s1">| typeof JSON_CONTENT_TYPE_HEADER // For API routes, Next.js data requests</span><span class="s3">\n  </span><span class="s1">| typeof TEXT_PLAIN_CONTENT_TYPE_HEADER // For simplified errors</span><span class="s3">\n\n</span><span class="s1">export type AppPageRenderResultMetadata = {</span><span class="s3">\n  </span><span class="s1">flightData?: Buffer</span><span class="s3">\n  </span><span class="s1">cacheControl?: CacheControl</span><span class="s3">\n  </span><span class="s1">staticBailoutInfo?: {</span><span class="s3">\n    </span><span class="s1">stack?: string</span><span class="s3">\n    </span><span class="s1">description?: string</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The postponed state if the render had postponed and needs to be resumed.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">postponed?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The headers to set on the response that were added by the render.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">headers?: OutgoingHttpHeaders</span><span class="s3">\n  </span><span class="s1">statusCode?: number</span><span class="s3">\n  </span><span class="s1">fetchTags?: string</span><span class="s3">\n  </span><span class="s1">fetchMetrics?: FetchMetrics</span><span class="s3">\n\n  </span><span class="s1">segmentData?: Map&lt;string, Buffer&gt;</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* In development, the resume data cache is warmed up before the render. This</span><span class="s3">\n   </span><span class="s1">* is attached to the metadata so that it can be used during the render. When</span><span class="s3">\n   </span><span class="s1">* prerendering, the filled resume data cache is also attached to the metadata</span><span class="s3">\n   </span><span class="s1">* so that it can be used when prerendering matching fallback shells.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">renderResumeDataCache?: RenderResumeDataCache</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type PagesRenderResultMetadata = {</span><span class="s3">\n  </span><span class="s1">pageData?: any</span><span class="s3">\n  </span><span class="s1">cacheControl?: CacheControl</span><span class="s3">\n  </span><span class="s1">assetQueryString?: string</span><span class="s3">\n  </span><span class="s1">isNotFound?: boolean</span><span class="s3">\n  </span><span class="s1">isRedirect?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type StaticRenderResultMetadata = {}</span><span class="s3">\n\n</span><span class="s1">export type RenderResultMetadata = AppPageRenderResultMetadata &amp;</span><span class="s3">\n  </span><span class="s1">PagesRenderResultMetadata &amp;</span><span class="s3">\n  </span><span class="s1">StaticRenderResultMetadata</span><span class="s3">\n\n</span><span class="s1">export type RenderResultResponse =</span><span class="s3">\n  </span><span class="s1">| ReadableStream&lt;Uint8Array&gt;[]</span><span class="s3">\n  </span><span class="s1">| ReadableStream&lt;Uint8Array&gt;</span><span class="s3">\n  </span><span class="s1">| string</span><span class="s3">\n  </span><span class="s1">| Buffer</span><span class="s3">\n  </span><span class="s1">| null</span><span class="s3">\n\n</span><span class="s1">export type RenderResultOptions&lt;</span><span class="s3">\n  </span><span class="s1">Metadata extends RenderResultMetadata = RenderResultMetadata,</span><span class="s3">\n</span><span class="s1">&gt; = {</span><span class="s3">\n  </span><span class="s1">contentType: ContentTypeOption | null</span><span class="s3">\n  </span><span class="s1">waitUntil?: Promise&lt;unknown&gt;</span><span class="s3">\n  </span><span class="s1">metadata: Metadata</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export default class RenderResult&lt;</span><span class="s3">\n  </span><span class="s1">Metadata extends RenderResultMetadata = RenderResultMetadata,</span><span class="s3">\n</span><span class="s1">&gt; {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The detected content type for the response. This is used to set the</span><span class="s3">\n   </span><span class="s1">* `Content-Type` header.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public readonly contentType: ContentTypeOption | null</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The metadata for the response. This is used to set the revalidation times</span><span class="s3">\n   </span><span class="s1">* and other metadata.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public readonly metadata: Readonly&lt;Metadata&gt;</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The response itself. This can be a string, a stream, or null. If it's a</span><span class="s3">\n   </span><span class="s1">* string, then it's a static response. If it's a stream, then it's a</span><span class="s3">\n   </span><span class="s1">* dynamic response. If it's null, then the response was not found or was</span><span class="s3">\n   </span><span class="s1">* already sent.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">private response: RenderResultResponse</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* A render result that represents an empty response. This is used to</span><span class="s3">\n   </span><span class="s1">* represent a response that was not found or was already sent.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public static readonly EMPTY = new RenderResult&lt;StaticRenderResultMetadata&gt;(</span><span class="s3">\n    </span><span class="s1">null,</span><span class="s3">\n    </span><span class="s1">{ metadata: {}, contentType: null }</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Creates a new RenderResult instance from a static response.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param value the static response value</span><span class="s3">\n   </span><span class="s1">* @param contentType the content type of the response</span><span class="s3">\n   </span><span class="s1">* @returns a new RenderResult instance</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public static fromStatic(</span><span class="s3">\n    </span><span class="s1">value: string | Buffer,</span><span class="s3">\n    </span><span class="s1">contentType: ContentTypeOption</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return new RenderResult&lt;StaticRenderResultMetadata&gt;(value, {</span><span class="s3">\n      </span><span class="s1">metadata: {},</span><span class="s3">\n      </span><span class="s1">contentType,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private readonly waitUntil?: Promise&lt;unknown&gt;</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">response: RenderResultResponse,</span><span class="s3">\n    </span><span class="s1">{ contentType, waitUntil, metadata }: RenderResultOptions&lt;Metadata&gt;</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">this.response = response</span><span class="s3">\n    </span><span class="s1">this.contentType = contentType</span><span class="s3">\n    </span><span class="s1">this.metadata = metadata</span><span class="s3">\n    </span><span class="s1">this.waitUntil = waitUntil</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public assignMetadata(metadata: Metadata) {</span><span class="s3">\n    </span><span class="s1">Object.assign(this.metadata, metadata)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns true if the response is null. It can be null if the response was</span><span class="s3">\n   </span><span class="s1">* not found or was already sent.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public get isNull(): boolean {</span><span class="s3">\n    </span><span class="s1">return this.response === null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns false if the response is a string. It can be a string if the page</span><span class="s3">\n   </span><span class="s1">* was prerendered. If it's not, then it was generated dynamically.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public get isDynamic(): boolean {</span><span class="s3">\n    </span><span class="s1">return typeof this.response !== 'string'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns the response if it is a string. If the page was dynamic, this will</span><span class="s3">\n   </span><span class="s1">* return a promise if the `stream` option is true, or it will throw an error.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param stream Whether or not to return a promise if the response is dynamic</span><span class="s3">\n   </span><span class="s1">* @returns The response as a string</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public toUnchunkedString(stream?: false): string</span><span class="s3">\n  </span><span class="s1">public toUnchunkedString(stream: true): Promise&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">public toUnchunkedString(stream = false): Promise&lt;string&gt; | string {</span><span class="s3">\n    </span><span class="s1">if (this.response === null) {</span><span class="s3">\n      </span><span class="s1">// If the response is null, return an empty string. This behavior is</span><span class="s3">\n      </span><span class="s1">// intentional as we're now providing the `RenderResult.EMPTY` value.</span><span class="s3">\n      </span><span class="s1">return ''</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (typeof this.response !== 'string') {</span><span class="s3">\n      </span><span class="s1">if (!stream) {</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">'dynamic responses cannot be unchunked. This is a bug in Next.js'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return streamToString(this.readable)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return this.response</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns a readable stream of the response.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">private get readable(): ReadableStream&lt;Uint8Array&gt; {</span><span class="s3">\n    </span><span class="s1">if (this.response === null) {</span><span class="s3">\n      </span><span class="s1">// If the response is null, return an empty stream. This behavior is</span><span class="s3">\n      </span><span class="s1">// intentional as we're now providing the `RenderResult.EMPTY` value.</span><span class="s3">\n      </span><span class="s1">return new ReadableStream&lt;Uint8Array&gt;({</span><span class="s3">\n        </span><span class="s1">start(controller) {</span><span class="s3">\n          </span><span class="s1">controller.close()</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (typeof this.response === 'string') {</span><span class="s3">\n      </span><span class="s1">return streamFromString(this.response)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (Buffer.isBuffer(this.response)) {</span><span class="s3">\n      </span><span class="s1">return streamFromBuffer(this.response)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// If the response is an array of streams, then chain them together.</span><span class="s3">\n    </span><span class="s1">if (Array.isArray(this.response)) {</span><span class="s3">\n      </span><span class="s1">return chainStreams(...this.response)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return this.response</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Coerces the response to an array of streams. This will convert the response</span><span class="s3">\n   </span><span class="s1">* to an array of streams if it is not already one.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @returns An array of streams</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">private coerce(): ReadableStream&lt;Uint8Array&gt;[] {</span><span class="s3">\n    </span><span class="s1">if (this.response === null) {</span><span class="s3">\n      </span><span class="s1">// If the response is null, return an empty stream. This behavior is</span><span class="s3">\n      </span><span class="s1">// intentional as we're now providing the `RenderResult.EMPTY` value.</span><span class="s3">\n      </span><span class="s1">return []</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (typeof this.response === 'string') {</span><span class="s3">\n      </span><span class="s1">return [streamFromString(this.response)]</span><span class="s3">\n    </span><span class="s1">} else if (Array.isArray(this.response)) {</span><span class="s3">\n      </span><span class="s1">return this.response</span><span class="s3">\n    </span><span class="s1">} else if (Buffer.isBuffer(this.response)) {</span><span class="s3">\n      </span><span class="s1">return [streamFromBuffer(this.response)]</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">return [this.response]</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Unshifts a new stream to the response. This will convert the response to an</span><span class="s3">\n   </span><span class="s1">* array of streams if it is not already one and will add the new stream to</span><span class="s3">\n   </span><span class="s1">* the start of the array. When this response is piped, all of the streams</span><span class="s3">\n   </span><span class="s1">* will be piped one after the other.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param readable The new stream to unshift</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public unshift(readable: ReadableStream&lt;Uint8Array&gt;): void {</span><span class="s3">\n    </span><span class="s1">// Coerce the response to an array of streams.</span><span class="s3">\n    </span><span class="s1">this.response = this.coerce()</span><span class="s3">\n\n    </span><span class="s1">// Add the new stream to the start of the array.</span><span class="s3">\n    </span><span class="s1">this.response.unshift(readable)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Chains a new stream to the response. This will convert the response to an</span><span class="s3">\n   </span><span class="s1">* array of streams if it is not already one and will add the new stream to</span><span class="s3">\n   </span><span class="s1">* the end. When this response is piped, all of the streams will be piped</span><span class="s3">\n   </span><span class="s1">* one after the other.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param readable The new stream to chain</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public push(readable: ReadableStream&lt;Uint8Array&gt;): void {</span><span class="s3">\n    </span><span class="s1">// Coerce the response to an array of streams.</span><span class="s3">\n    </span><span class="s1">this.response = this.coerce()</span><span class="s3">\n\n    </span><span class="s1">// Add the new stream to the end of the array.</span><span class="s3">\n    </span><span class="s1">this.response.push(readable)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Pipes the response to a writable stream. This will close/cancel the</span><span class="s3">\n   </span><span class="s1">* writable stream if an error is encountered. If this doesn't throw, then</span><span class="s3">\n   </span><span class="s1">* the writable stream will be closed or aborted.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param writable Writable stream to pipe the response to</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public async pipeTo(writable: WritableStream&lt;Uint8Array&gt;): Promise&lt;void&gt; {</span><span class="s3">\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">await this.readable.pipeTo(writable, {</span><span class="s3">\n        </span><span class="s1">// We want to close the writable stream ourselves so that we can wait</span><span class="s3">\n        </span><span class="s1">// for the waitUntil promise to resolve before closing it. If an error</span><span class="s3">\n        </span><span class="s1">// is encountered, we'll abort the writable stream if we swallowed the</span><span class="s3">\n        </span><span class="s1">// error.</span><span class="s3">\n        </span><span class="s1">preventClose: true,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n\n      </span><span class="s1">// If there is a waitUntil promise, wait for it to resolve before</span><span class="s3">\n      </span><span class="s1">// closing the writable stream.</span><span class="s3">\n      </span><span class="s1">if (this.waitUntil) await this.waitUntil</span><span class="s3">\n\n      </span><span class="s1">// Close the writable stream.</span><span class="s3">\n      </span><span class="s1">await writable.close()</span><span class="s3">\n    </span><span class="s1">} catch (err) {</span><span class="s3">\n      </span><span class="s1">// If this is an abort error, we should abort the writable stream (as we</span><span class="s3">\n      </span><span class="s1">// took ownership of it when we started piping). We don't need to re-throw</span><span class="s3">\n      </span><span class="s1">// because we handled the error.</span><span class="s3">\n      </span><span class="s1">if (isAbortError(err)) {</span><span class="s3">\n        </span><span class="s1">// Abort the writable stream if an error is encountered.</span><span class="s3">\n        </span><span class="s1">await writable.abort(err)</span><span class="s3">\n\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// We're not aborting the writer here as when this method throws it's not</span><span class="s3">\n      </span><span class="s1">// clear as to how so the caller should assume it's their responsibility</span><span class="s3">\n      </span><span class="s1">// to clean up the writer.</span><span class="s3">\n      </span><span class="s1">throw err</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Pipes the response to a node response. This will close/cancel the node</span><span class="s3">\n   </span><span class="s1">* response if an error is encountered.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param res</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public async pipeToNodeResponse(res: ServerResponse) {</span><span class="s3">\n    </span><span class="s1">await pipeToNodeResponse(this.readable, res, this.waitUntil)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;chainStreams&quot;</span><span class="s0">,</span><span class="s1">&quot;streamFromBuffer&quot;</span><span class="s0">,</span><span class="s1">&quot;streamFromString&quot;</span><span class="s0">,</span><span class="s1">&quot;streamToString&quot;</span><span class="s0">,</span><span class="s1">&quot;isAbortError&quot;</span><span class="s0">,</span><span class="s1">&quot;pipeToNodeResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;RenderResult&quot;</span><span class="s0">,</span><span class="s1">&quot;EMPTY&quot;</span><span class="s0">,</span><span class="s1">&quot;metadata&quot;</span><span class="s0">,</span><span class="s1">&quot;contentType&quot;</span><span class="s0">,</span><span class="s1">&quot;fromStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;waitUntil&quot;</span><span class="s0">,</span><span class="s1">&quot;assignMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;assign&quot;</span><span class="s0">,</span><span class="s1">&quot;isNull&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;toUnchunkedString&quot;</span><span class="s0">,</span><span class="s1">&quot;stream&quot;</span><span class="s0">,</span><span class="s1">&quot;readable&quot;</span><span class="s0">,</span><span class="s1">&quot;ReadableStream&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;controller&quot;</span><span class="s0">,</span><span class="s1">&quot;close&quot;</span><span class="s0">,</span><span class="s1">&quot;Buffer&quot;</span><span class="s0">,</span><span class="s1">&quot;isBuffer&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;coerce&quot;</span><span class="s0">,</span><span class="s1">&quot;unshift&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;pipeTo&quot;</span><span class="s0">,</span><span class="s1">&quot;writable&quot;</span><span class="s0">,</span><span class="s1">&quot;preventClose&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;abort&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5960</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/response-cache/utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">CachedRouteKind,</span><span class="s3">\n  </span><span class="s1">IncrementalCacheKind,</span><span class="s3">\n  </span><span class="s1">type CachedAppPageValue,</span><span class="s3">\n  </span><span class="s1">type CachedPageValue,</span><span class="s3">\n  </span><span class="s1">type IncrementalResponseCacheEntry,</span><span class="s3">\n  </span><span class="s1">type ResponseCacheEntry,</span><span class="s3">\n</span><span class="s1">} from './types'</span><span class="s3">\n\n</span><span class="s1">import RenderResult from '../render-result'</span><span class="s3">\n</span><span class="s1">import { RouteKind } from '../route-kind'</span><span class="s3">\n</span><span class="s1">import { HTML_CONTENT_TYPE_HEADER } from '../../lib/constants'</span><span class="s3">\n\n</span><span class="s1">export async function fromResponseCacheEntry(</span><span class="s3">\n  </span><span class="s1">cacheEntry: ResponseCacheEntry</span><span class="s3">\n</span><span class="s1">): Promise&lt;IncrementalResponseCacheEntry&gt; {</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">...cacheEntry,</span><span class="s3">\n    </span><span class="s1">value:</span><span class="s3">\n      </span><span class="s1">cacheEntry.value?.kind === CachedRouteKind.PAGES</span><span class="s3">\n        </span><span class="s1">? {</span><span class="s3">\n            </span><span class="s1">kind: CachedRouteKind.PAGES,</span><span class="s3">\n            </span><span class="s1">html: await cacheEntry.value.html.toUnchunkedString(true),</span><span class="s3">\n            </span><span class="s1">pageData: cacheEntry.value.pageData,</span><span class="s3">\n            </span><span class="s1">headers: cacheEntry.value.headers,</span><span class="s3">\n            </span><span class="s1">status: cacheEntry.value.status,</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">: cacheEntry.value?.kind === CachedRouteKind.APP_PAGE</span><span class="s3">\n          </span><span class="s1">? {</span><span class="s3">\n              </span><span class="s1">kind: CachedRouteKind.APP_PAGE,</span><span class="s3">\n              </span><span class="s1">html: await cacheEntry.value.html.toUnchunkedString(true),</span><span class="s3">\n              </span><span class="s1">postponed: cacheEntry.value.postponed,</span><span class="s3">\n              </span><span class="s1">rscData: cacheEntry.value.rscData,</span><span class="s3">\n              </span><span class="s1">headers: cacheEntry.value.headers,</span><span class="s3">\n              </span><span class="s1">status: cacheEntry.value.status,</span><span class="s3">\n              </span><span class="s1">segmentData: cacheEntry.value.segmentData,</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">: cacheEntry.value,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function toResponseCacheEntry(</span><span class="s3">\n  </span><span class="s1">response: IncrementalResponseCacheEntry | null</span><span class="s3">\n</span><span class="s1">): Promise&lt;ResponseCacheEntry | null&gt; {</span><span class="s3">\n  </span><span class="s1">if (!response) return null</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">isMiss: response.isMiss,</span><span class="s3">\n    </span><span class="s1">isStale: response.isStale,</span><span class="s3">\n    </span><span class="s1">cacheControl: response.cacheControl,</span><span class="s3">\n    </span><span class="s1">value:</span><span class="s3">\n      </span><span class="s1">response.value?.kind === CachedRouteKind.PAGES</span><span class="s3">\n        </span><span class="s1">? ({</span><span class="s3">\n            </span><span class="s1">kind: CachedRouteKind.PAGES,</span><span class="s3">\n            </span><span class="s1">html: RenderResult.fromStatic(</span><span class="s3">\n              </span><span class="s1">response.value.html,</span><span class="s3">\n              </span><span class="s1">HTML_CONTENT_TYPE_HEADER</span><span class="s3">\n            </span><span class="s1">),</span><span class="s3">\n            </span><span class="s1">pageData: response.value.pageData,</span><span class="s3">\n            </span><span class="s1">headers: response.value.headers,</span><span class="s3">\n            </span><span class="s1">status: response.value.status,</span><span class="s3">\n          </span><span class="s1">} satisfies CachedPageValue)</span><span class="s3">\n        </span><span class="s1">: response.value?.kind === CachedRouteKind.APP_PAGE</span><span class="s3">\n          </span><span class="s1">? ({</span><span class="s3">\n              </span><span class="s1">kind: CachedRouteKind.APP_PAGE,</span><span class="s3">\n              </span><span class="s1">html: RenderResult.fromStatic(</span><span class="s3">\n                </span><span class="s1">response.value.html,</span><span class="s3">\n                </span><span class="s1">HTML_CONTENT_TYPE_HEADER</span><span class="s3">\n              </span><span class="s1">),</span><span class="s3">\n              </span><span class="s1">rscData: response.value.rscData,</span><span class="s3">\n              </span><span class="s1">headers: response.value.headers,</span><span class="s3">\n              </span><span class="s1">status: response.value.status,</span><span class="s3">\n              </span><span class="s1">postponed: response.value.postponed,</span><span class="s3">\n              </span><span class="s1">segmentData: response.value.segmentData,</span><span class="s3">\n            </span><span class="s1">} satisfies CachedAppPageValue)</span><span class="s3">\n          </span><span class="s1">: response.value,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function routeKindToIncrementalCacheKind(</span><span class="s3">\n  </span><span class="s1">routeKind: RouteKind</span><span class="s3">\n</span><span class="s1">): Exclude&lt;IncrementalCacheKind, IncrementalCacheKind.FETCH&gt; {</span><span class="s3">\n  </span><span class="s1">switch (routeKind) {</span><span class="s3">\n    </span><span class="s1">case RouteKind.PAGES:</span><span class="s3">\n      </span><span class="s1">return IncrementalCacheKind.PAGES</span><span class="s3">\n    </span><span class="s1">case RouteKind.APP_PAGE:</span><span class="s3">\n      </span><span class="s1">return IncrementalCacheKind.APP_PAGE</span><span class="s3">\n    </span><span class="s1">case RouteKind.IMAGE:</span><span class="s3">\n      </span><span class="s1">return IncrementalCacheKind.IMAGE</span><span class="s3">\n    </span><span class="s1">case RouteKind.APP_ROUTE:</span><span class="s3">\n      </span><span class="s1">return IncrementalCacheKind.APP_ROUTE</span><span class="s3">\n    </span><span class="s1">case RouteKind.PAGES_API:</span><span class="s3">\n      </span><span class="s1">// Pages Router API routes are not cached in the incremental cache.</span><span class="s3">\n      </span><span class="s1">throw new Error(`Unexpected route kind ${routeKind}`)</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">return routeKind satisfies never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;CachedRouteKind&quot;</span><span class="s0">,</span><span class="s1">&quot;IncrementalCacheKind&quot;</span><span class="s0">,</span><span class="s1">&quot;RenderResult&quot;</span><span class="s0">,</span><span class="s1">&quot;RouteKind&quot;</span><span class="s0">,</span><span class="s1">&quot;HTML_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;fromResponseCacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;kind&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGES&quot;</span><span class="s0">,</span><span class="s1">&quot;html&quot;</span><span class="s0">,</span><span class="s1">&quot;toUnchunkedString&quot;</span><span class="s0">,</span><span class="s1">&quot;pageData&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;APP_PAGE&quot;</span><span class="s0">,</span><span class="s1">&quot;postponed&quot;</span><span class="s0">,</span><span class="s1">&quot;rscData&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentData&quot;</span><span class="s0">,</span><span class="s1">&quot;toResponseCacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;isMiss&quot;</span><span class="s0">,</span><span class="s1">&quot;isStale&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheControl&quot;</span><span class="s0">,</span><span class="s1">&quot;fromStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;routeKindToIncrementalCacheKind&quot;</span><span class="s0">,</span><span class="s1">&quot;routeKind&quot;</span><span class="s0">,</span><span class="s1">&quot;IMAGE&quot;</span><span class="s0">,</span><span class="s1">&quot;APP_ROUTE&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGES_API&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">6046</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/response-cache/index.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type {</span><span class="s3">\n  </span><span class="s1">ResponseCacheEntry,</span><span class="s3">\n  </span><span class="s1">ResponseGenerator,</span><span class="s3">\n  </span><span class="s1">ResponseCacheBase,</span><span class="s3">\n  </span><span class="s1">IncrementalResponseCacheEntry,</span><span class="s3">\n  </span><span class="s1">IncrementalResponseCache,</span><span class="s3">\n</span><span class="s1">} from './types'</span><span class="s3">\n\n</span><span class="s1">import { Batcher } from '../../lib/batcher'</span><span class="s3">\n</span><span class="s1">import { scheduleOnNextTick } from '../../lib/scheduler'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">fromResponseCacheEntry,</span><span class="s3">\n  </span><span class="s1">routeKindToIncrementalCacheKind,</span><span class="s3">\n  </span><span class="s1">toResponseCacheEntry,</span><span class="s3">\n</span><span class="s1">} from './utils'</span><span class="s3">\n</span><span class="s1">import type { RouteKind } from '../route-kind'</span><span class="s3">\n\n</span><span class="s1">export * from './types'</span><span class="s3">\n\n</span><span class="s1">export default class ResponseCache implements ResponseCacheBase {</span><span class="s3">\n  </span><span class="s1">private readonly batcher = Batcher.create&lt;</span><span class="s3">\n    </span><span class="s1">{ key: string; isOnDemandRevalidate: boolean },</span><span class="s3">\n    </span><span class="s1">IncrementalResponseCacheEntry | null,</span><span class="s3">\n    </span><span class="s1">string</span><span class="s3">\n  </span><span class="s1">&gt;({</span><span class="s3">\n    </span><span class="s1">// Ensure on-demand revalidate doesn't block normal requests, it should be</span><span class="s3">\n    </span><span class="s1">// safe to run an on-demand revalidate for the same key as a normal request.</span><span class="s3">\n    </span><span class="s1">cacheKeyFn: ({ key, isOnDemandRevalidate }) =&gt;</span><span class="s3">\n      </span><span class="s1">`${key}-${isOnDemandRevalidate ? '1' : '0'}`,</span><span class="s3">\n    </span><span class="s1">// We wait to do any async work until after we've added our promise to</span><span class="s3">\n    </span><span class="s1">// `pendingResponses` to ensure that any any other calls will reuse the</span><span class="s3">\n    </span><span class="s1">// same promise until we've fully finished our work.</span><span class="s3">\n    </span><span class="s1">schedulerFn: scheduleOnNextTick,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">private previousCacheItem?: {</span><span class="s3">\n    </span><span class="s1">key: string</span><span class="s3">\n    </span><span class="s1">entry: IncrementalResponseCacheEntry | null</span><span class="s3">\n    </span><span class="s1">expiresAt: number</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// we don't use minimal_mode name here as this.minimal_mode is</span><span class="s3">\n  </span><span class="s1">// statically replace for server runtimes but we need it to</span><span class="s3">\n  </span><span class="s1">// be dynamic here</span><span class="s3">\n  </span><span class="s1">private minimal_mode?: boolean</span><span class="s3">\n\n  </span><span class="s1">constructor(minimal_mode: boolean) {</span><span class="s3">\n    </span><span class="s1">this.minimal_mode = minimal_mode</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public async get(</span><span class="s3">\n    </span><span class="s1">key: string | null,</span><span class="s3">\n    </span><span class="s1">responseGenerator: ResponseGenerator,</span><span class="s3">\n    </span><span class="s1">context: {</span><span class="s3">\n      </span><span class="s1">routeKind: RouteKind</span><span class="s3">\n      </span><span class="s1">isOnDemandRevalidate?: boolean</span><span class="s3">\n      </span><span class="s1">isPrefetch?: boolean</span><span class="s3">\n      </span><span class="s1">incrementalCache: IncrementalResponseCache</span><span class="s3">\n      </span><span class="s1">isRoutePPREnabled?: boolean</span><span class="s3">\n      </span><span class="s1">isFallback?: boolean</span><span class="s3">\n      </span><span class="s1">waitUntil?: (prom: Promise&lt;any&gt;) =&gt; void</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">): Promise&lt;ResponseCacheEntry | null&gt; {</span><span class="s3">\n    </span><span class="s1">// If there is no key for the cache, we can't possibly look this up in the</span><span class="s3">\n    </span><span class="s1">// cache so just return the result of the response generator.</span><span class="s3">\n    </span><span class="s1">if (!key) {</span><span class="s3">\n      </span><span class="s1">return responseGenerator({ hasResolved: false, previousCacheEntry: null })</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const {</span><span class="s3">\n      </span><span class="s1">incrementalCache,</span><span class="s3">\n      </span><span class="s1">isOnDemandRevalidate = false,</span><span class="s3">\n      </span><span class="s1">isFallback = false,</span><span class="s3">\n      </span><span class="s1">isRoutePPREnabled = false,</span><span class="s3">\n      </span><span class="s1">waitUntil,</span><span class="s3">\n    </span><span class="s1">} = context</span><span class="s3">\n\n    </span><span class="s1">const response = await this.batcher.batch(</span><span class="s3">\n      </span><span class="s1">{ key, isOnDemandRevalidate },</span><span class="s3">\n      </span><span class="s1">(cacheKey, resolve) =&gt; {</span><span class="s3">\n        </span><span class="s1">const prom = (async () =&gt; {</span><span class="s3">\n          </span><span class="s1">// We keep the previous cache entry around to leverage when the</span><span class="s3">\n          </span><span class="s1">// incremental cache is disabled in minimal mode.</span><span class="s3">\n          </span><span class="s1">if (</span><span class="s3">\n            </span><span class="s1">this.minimal_mode &amp;&amp;</span><span class="s3">\n            </span><span class="s1">this.previousCacheItem?.key === cacheKey &amp;&amp;</span><span class="s3">\n            </span><span class="s1">this.previousCacheItem.expiresAt &gt; Date.now()</span><span class="s3">\n          </span><span class="s1">) {</span><span class="s3">\n            </span><span class="s1">return this.previousCacheItem.entry</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Coerce the kindHint into a given kind for the incremental cache.</span><span class="s3">\n          </span><span class="s1">const kind = routeKindToIncrementalCacheKind(context.routeKind)</span><span class="s3">\n\n          </span><span class="s1">let resolved = false</span><span class="s3">\n          </span><span class="s1">let cachedResponse: IncrementalResponseCacheEntry | null = null</span><span class="s3">\n          </span><span class="s1">try {</span><span class="s3">\n            </span><span class="s1">cachedResponse = !this.minimal_mode</span><span class="s3">\n              </span><span class="s1">? await incrementalCache.get(key, {</span><span class="s3">\n                  </span><span class="s1">kind,</span><span class="s3">\n                  </span><span class="s1">isRoutePPREnabled: context.isRoutePPREnabled,</span><span class="s3">\n                  </span><span class="s1">isFallback,</span><span class="s3">\n                </span><span class="s1">})</span><span class="s3">\n              </span><span class="s1">: null</span><span class="s3">\n\n            </span><span class="s1">if (cachedResponse &amp;&amp; !isOnDemandRevalidate) {</span><span class="s3">\n              </span><span class="s1">resolve(cachedResponse)</span><span class="s3">\n              </span><span class="s1">resolved = true</span><span class="s3">\n\n              </span><span class="s1">if (!cachedResponse.isStale || context.isPrefetch) {</span><span class="s3">\n                </span><span class="s1">// The cached value is still valid, so we don't need</span><span class="s3">\n                </span><span class="s1">// to update it yet.</span><span class="s3">\n                </span><span class="s1">return null</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">const cacheEntry = await responseGenerator({</span><span class="s3">\n              </span><span class="s1">hasResolved: resolved,</span><span class="s3">\n              </span><span class="s1">previousCacheEntry: cachedResponse,</span><span class="s3">\n              </span><span class="s1">isRevalidating: true,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n\n            </span><span class="s1">// If the cache entry couldn't be generated, we don't want to cache</span><span class="s3">\n            </span><span class="s1">// the result.</span><span class="s3">\n            </span><span class="s1">if (!cacheEntry) {</span><span class="s3">\n              </span><span class="s1">// Unset the previous cache item if it was set.</span><span class="s3">\n              </span><span class="s1">if (this.minimal_mode) this.previousCacheItem = undefined</span><span class="s3">\n              </span><span class="s1">return null</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">const resolveValue = await fromResponseCacheEntry({</span><span class="s3">\n              </span><span class="s1">...cacheEntry,</span><span class="s3">\n              </span><span class="s1">isMiss: !cachedResponse,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n            </span><span class="s1">if (!resolveValue) {</span><span class="s3">\n              </span><span class="s1">// Unset the previous cache item if it was set.</span><span class="s3">\n              </span><span class="s1">if (this.minimal_mode) this.previousCacheItem = undefined</span><span class="s3">\n              </span><span class="s1">return null</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">// For on-demand revalidate wait to resolve until cache is set.</span><span class="s3">\n            </span><span class="s1">// Otherwise resolve now.</span><span class="s3">\n            </span><span class="s1">if (!isOnDemandRevalidate &amp;&amp; !resolved) {</span><span class="s3">\n              </span><span class="s1">resolve(resolveValue)</span><span class="s3">\n              </span><span class="s1">resolved = true</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">// We want to persist the result only if it has a cache control value</span><span class="s3">\n            </span><span class="s1">// defined.</span><span class="s3">\n            </span><span class="s1">if (resolveValue.cacheControl) {</span><span class="s3">\n              </span><span class="s1">if (this.minimal_mode) {</span><span class="s3">\n                </span><span class="s1">this.previousCacheItem = {</span><span class="s3">\n                  </span><span class="s1">key: cacheKey,</span><span class="s3">\n                  </span><span class="s1">entry: resolveValue,</span><span class="s3">\n                  </span><span class="s1">expiresAt: Date.now() + 1000,</span><span class="s3">\n                </span><span class="s1">}</span><span class="s3">\n              </span><span class="s1">} else {</span><span class="s3">\n                </span><span class="s1">await incrementalCache.set(key, resolveValue.value, {</span><span class="s3">\n                  </span><span class="s1">cacheControl: resolveValue.cacheControl,</span><span class="s3">\n                  </span><span class="s1">isRoutePPREnabled,</span><span class="s3">\n                  </span><span class="s1">isFallback,</span><span class="s3">\n                </span><span class="s1">})</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">return resolveValue</span><span class="s3">\n          </span><span class="s1">} catch (err) {</span><span class="s3">\n            </span><span class="s1">// When a path is erroring we automatically re-set the existing cache</span><span class="s3">\n            </span><span class="s1">// with new revalidate and expire times to prevent non-stop retrying.</span><span class="s3">\n            </span><span class="s1">if (cachedResponse?.cacheControl) {</span><span class="s3">\n              </span><span class="s1">const newRevalidate = Math.min(</span><span class="s3">\n                </span><span class="s1">Math.max(cachedResponse.cacheControl.revalidate || 3, 3),</span><span class="s3">\n                </span><span class="s1">30</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n\n              </span><span class="s1">const newExpire =</span><span class="s3">\n                </span><span class="s1">cachedResponse.cacheControl.expire === undefined</span><span class="s3">\n                  </span><span class="s1">? undefined</span><span class="s3">\n                  </span><span class="s1">: Math.max(</span><span class="s3">\n                      </span><span class="s1">newRevalidate + 3,</span><span class="s3">\n                      </span><span class="s1">cachedResponse.cacheControl.expire</span><span class="s3">\n                    </span><span class="s1">)</span><span class="s3">\n\n              </span><span class="s1">await incrementalCache.set(key, cachedResponse.value, {</span><span class="s3">\n                </span><span class="s1">cacheControl: { revalidate: newRevalidate, expire: newExpire },</span><span class="s3">\n                </span><span class="s1">isRoutePPREnabled,</span><span class="s3">\n                </span><span class="s1">isFallback,</span><span class="s3">\n              </span><span class="s1">})</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">// While revalidating in the background we can't reject as we already</span><span class="s3">\n            </span><span class="s1">// resolved the cache entry so log the error here.</span><span class="s3">\n            </span><span class="s1">if (resolved) {</span><span class="s3">\n              </span><span class="s1">console.error(err)</span><span class="s3">\n              </span><span class="s1">return null</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">// We haven't resolved yet, so let's throw to indicate an error.</span><span class="s3">\n            </span><span class="s1">throw err</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">})()</span><span class="s3">\n\n        </span><span class="s1">// we need to ensure background revalidates are</span><span class="s3">\n        </span><span class="s1">// passed to waitUntil</span><span class="s3">\n        </span><span class="s1">if (waitUntil) {</span><span class="s3">\n          </span><span class="s1">waitUntil(prom)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">return prom</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">return toResponseCacheEntry(response)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;Batcher&quot;</span><span class="s0">,</span><span class="s1">&quot;scheduleOnNextTick&quot;</span><span class="s0">,</span><span class="s1">&quot;fromResponseCacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;routeKindToIncrementalCacheKind&quot;</span><span class="s0">,</span><span class="s1">&quot;toResponseCacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;ResponseCache&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;minimal_mode&quot;</span><span class="s0">,</span><span class="s1">&quot;batcher&quot;</span><span class="s0">,</span><span class="s1">&quot;create&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheKeyFn&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;isOnDemandRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;schedulerFn&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;responseGenerator&quot;</span><span class="s0">,</span><span class="s1">&quot;context&quot;</span><span class="s0">,</span><span class="s1">&quot;hasResolved&quot;</span><span class="s0">,</span><span class="s1">&quot;previousCacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;incrementalCache&quot;</span><span class="s0">,</span><span class="s1">&quot;isFallback&quot;</span><span class="s0">,</span><span class="s1">&quot;isRoutePPREnabled&quot;</span><span class="s0">,</span><span class="s1">&quot;waitUntil&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;batch&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;prom&quot;</span><span class="s0">,</span><span class="s1">&quot;previousCacheItem&quot;</span><span class="s0">,</span><span class="s1">&quot;expiresAt&quot;</span><span class="s0">,</span><span class="s1">&quot;Date&quot;</span><span class="s0">,</span><span class="s1">&quot;now&quot;</span><span class="s0">,</span><span class="s1">&quot;entry&quot;</span><span class="s0">,</span><span class="s1">&quot;kind&quot;</span><span class="s0">,</span><span class="s1">&quot;routeKind&quot;</span><span class="s0">,</span><span class="s1">&quot;resolved&quot;</span><span class="s0">,</span><span class="s1">&quot;cachedResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;isStale&quot;</span><span class="s0">,</span><span class="s1">&quot;isPrefetch&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;isRevalidating&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;resolveValue&quot;</span><span class="s0">,</span><span class="s1">&quot;isMiss&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheControl&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;newRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;Math&quot;</span><span class="s0">,</span><span class="s1">&quot;min&quot;</span><span class="s0">,</span><span class="s1">&quot;max&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;newExpire&quot;</span><span class="s0">,</span><span class="s1">&quot;expire&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">6195</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/patch-fetch.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type {</span><span class="s3">\n  </span><span class="s1">WorkAsyncStorage,</span><span class="s3">\n  </span><span class="s1">WorkStore,</span><span class="s3">\n</span><span class="s1">} from '../app-render/work-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">import { AppRenderSpan, NextNodeServerSpan } from './trace/constants'</span><span class="s3">\n</span><span class="s1">import { getTracer, SpanKind } from './trace/tracer'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">CACHE_ONE_YEAR,</span><span class="s3">\n  </span><span class="s1">INFINITE_CACHE,</span><span class="s3">\n  </span><span class="s1">NEXT_CACHE_TAG_MAX_ITEMS,</span><span class="s3">\n  </span><span class="s1">NEXT_CACHE_TAG_MAX_LENGTH,</span><span class="s3">\n</span><span class="s1">} from '../../lib/constants'</span><span class="s3">\n</span><span class="s1">import { markCurrentScopeAsDynamic } from '../app-render/dynamic-rendering'</span><span class="s3">\n</span><span class="s1">import { makeHangingPromise } from '../dynamic-rendering-utils'</span><span class="s3">\n</span><span class="s1">import type { FetchMetric } from '../base-http'</span><span class="s3">\n</span><span class="s1">import { createDedupeFetch } from './dedupe-fetch'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">getCacheSignal,</span><span class="s3">\n  </span><span class="s1">type RevalidateStore,</span><span class="s3">\n  </span><span class="s1">type WorkUnitAsyncStorage,</span><span class="s3">\n</span><span class="s1">} from '../app-render/work-unit-async-storage.external'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">CachedRouteKind,</span><span class="s3">\n  </span><span class="s1">IncrementalCacheKind,</span><span class="s3">\n  </span><span class="s1">type CachedFetchData,</span><span class="s3">\n  </span><span class="s1">type ServerComponentsHmrCache,</span><span class="s3">\n  </span><span class="s1">type SetIncrementalFetchCacheContext,</span><span class="s3">\n</span><span class="s1">} from '../response-cache'</span><span class="s3">\n</span><span class="s1">import { waitAtLeastOneReactRenderTask } from '../../lib/scheduler'</span><span class="s3">\n</span><span class="s1">import { cloneResponse } from './clone-response'</span><span class="s3">\n</span><span class="s1">import type { IncrementalCache } from './incremental-cache'</span><span class="s3">\n\n</span><span class="s1">const isEdgeRuntime = process.env.NEXT_RUNTIME === 'edge'</span><span class="s3">\n\n</span><span class="s1">type Fetcher = typeof fetch</span><span class="s3">\n\n</span><span class="s1">type PatchedFetcher = Fetcher &amp; {</span><span class="s3">\n  </span><span class="s1">readonly __nextPatched: true</span><span class="s3">\n  </span><span class="s1">readonly __nextGetStaticStore: () =&gt; WorkAsyncStorage</span><span class="s3">\n  </span><span class="s1">readonly _nextOriginalFetch: Fetcher</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const NEXT_PATCH_SYMBOL = Symbol.for('next-patch')</span><span class="s3">\n\n</span><span class="s1">function isFetchPatched() {</span><span class="s3">\n  </span><span class="s1">return (globalThis as Record&lt;symbol, unknown&gt;)[NEXT_PATCH_SYMBOL] === true</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function validateRevalidate(</span><span class="s3">\n  </span><span class="s1">revalidateVal: unknown,</span><span class="s3">\n  </span><span class="s1">route: string</span><span class="s3">\n</span><span class="s1">): undefined | number {</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">let normalizedRevalidate: number | undefined = undefined</span><span class="s3">\n\n    </span><span class="s1">if (revalidateVal === false) {</span><span class="s3">\n      </span><span class="s1">normalizedRevalidate = INFINITE_CACHE</span><span class="s3">\n    </span><span class="s1">} else if (</span><span class="s3">\n      </span><span class="s1">typeof revalidateVal === 'number' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">!isNaN(revalidateVal) &amp;&amp;</span><span class="s3">\n      </span><span class="s1">revalidateVal &gt; -1</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">normalizedRevalidate = revalidateVal</span><span class="s3">\n    </span><span class="s1">} else if (typeof revalidateVal !== 'undefined') {</span><span class="s3">\n      </span><span class="s1">throw new Error(</span><span class="s3">\n        </span><span class="s1">`Invalid revalidate value </span><span class="s3">\&quot;</span><span class="s1">${revalidateVal}</span><span class="s3">\&quot; </span><span class="s1">on </span><span class="s3">\&quot;</span><span class="s1">${route}</span><span class="s3">\&quot;</span><span class="s1">, must be a non-negative number or false`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return normalizedRevalidate</span><span class="s3">\n  </span><span class="s1">} catch (err: any) {</span><span class="s3">\n    </span><span class="s1">// handle client component error from attempting to check revalidate value</span><span class="s3">\n    </span><span class="s1">if (err instanceof Error &amp;&amp; err.message.includes('Invalid revalidate')) {</span><span class="s3">\n      </span><span class="s1">throw err</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return undefined</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function validateTags(tags: any[], description: string) {</span><span class="s3">\n  </span><span class="s1">const validTags: string[] = []</span><span class="s3">\n  </span><span class="s1">const invalidTags: Array&lt;{</span><span class="s3">\n    </span><span class="s1">tag: any</span><span class="s3">\n    </span><span class="s1">reason: string</span><span class="s3">\n  </span><span class="s1">}&gt; = []</span><span class="s3">\n\n  </span><span class="s1">for (let i = 0; i &lt; tags.length; i++) {</span><span class="s3">\n    </span><span class="s1">const tag = tags[i]</span><span class="s3">\n\n    </span><span class="s1">if (typeof tag !== 'string') {</span><span class="s3">\n      </span><span class="s1">invalidTags.push({ tag, reason: 'invalid type, must be a string' })</span><span class="s3">\n    </span><span class="s1">} else if (tag.length &gt; NEXT_CACHE_TAG_MAX_LENGTH) {</span><span class="s3">\n      </span><span class="s1">invalidTags.push({</span><span class="s3">\n        </span><span class="s1">tag,</span><span class="s3">\n        </span><span class="s1">reason: `exceeded max length of ${NEXT_CACHE_TAG_MAX_LENGTH}`,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">validTags.push(tag)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (validTags.length &gt; NEXT_CACHE_TAG_MAX_ITEMS) {</span><span class="s3">\n      </span><span class="s1">console.warn(</span><span class="s3">\n        </span><span class="s1">`Warning: exceeded max tag count for ${description}, dropped tags:`,</span><span class="s3">\n        </span><span class="s1">tags.slice(i).join(', ')</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (invalidTags.length &gt; 0) {</span><span class="s3">\n    </span><span class="s1">console.warn(`Warning: invalid tags passed to ${description}: `)</span><span class="s3">\n\n    </span><span class="s1">for (const { tag, reason } of invalidTags) {</span><span class="s3">\n      </span><span class="s1">console.log(`tag: </span><span class="s3">\&quot;</span><span class="s1">${tag}</span><span class="s3">\&quot; </span><span class="s1">${reason}`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return validTags</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function trackFetchMetric(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">ctx: Omit&lt;FetchMetric, 'end' | 'idx'&gt;</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (!workStore.shouldTrackFetchMetrics) {</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">workStore.fetchMetrics ??= []</span><span class="s3">\n\n  </span><span class="s1">workStore.fetchMetrics.push({</span><span class="s3">\n    </span><span class="s1">...ctx,</span><span class="s3">\n    </span><span class="s1">end: performance.timeOrigin + performance.now(),</span><span class="s3">\n    </span><span class="s1">idx: workStore.nextFetchId || 0,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">async function createCachedPrerenderResponse(</span><span class="s3">\n  </span><span class="s1">res: Response,</span><span class="s3">\n  </span><span class="s1">cacheKey: string,</span><span class="s3">\n  </span><span class="s1">incrementalCacheContext: SetIncrementalFetchCacheContext | undefined,</span><span class="s3">\n  </span><span class="s1">incrementalCache: IncrementalCache,</span><span class="s3">\n  </span><span class="s1">revalidate: number,</span><span class="s3">\n  </span><span class="s1">handleUnlock: () =&gt; Promise&lt;void&gt; | void</span><span class="s3">\n</span><span class="s1">): Promise&lt;Response&gt; {</span><span class="s3">\n  </span><span class="s1">// We are prerendering at build time or revalidate time with cacheComponents so we</span><span class="s3">\n  </span><span class="s1">// need to buffer the response so we can guarantee it can be read in a</span><span class="s3">\n  </span><span class="s1">// microtask.</span><span class="s3">\n  </span><span class="s1">const bodyBuffer = await res.arrayBuffer()</span><span class="s3">\n\n  </span><span class="s1">const fetchedData = {</span><span class="s3">\n    </span><span class="s1">headers: Object.fromEntries(res.headers.entries()),</span><span class="s3">\n    </span><span class="s1">body: Buffer.from(bodyBuffer).toString('base64'),</span><span class="s3">\n    </span><span class="s1">status: res.status,</span><span class="s3">\n    </span><span class="s1">url: res.url,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// We can skip setting the serverComponentsHmrCache because we aren't in dev</span><span class="s3">\n  </span><span class="s1">// mode.</span><span class="s3">\n\n  </span><span class="s1">if (incrementalCacheContext) {</span><span class="s3">\n    </span><span class="s1">await incrementalCache.set(</span><span class="s3">\n      </span><span class="s1">cacheKey,</span><span class="s3">\n      </span><span class="s1">{ kind: CachedRouteKind.FETCH, data: fetchedData, revalidate },</span><span class="s3">\n      </span><span class="s1">incrementalCacheContext</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">await handleUnlock()</span><span class="s3">\n\n  </span><span class="s1">// We return a new Response to the caller.</span><span class="s3">\n  </span><span class="s1">return new Response(bodyBuffer, {</span><span class="s3">\n    </span><span class="s1">headers: res.headers,</span><span class="s3">\n    </span><span class="s1">status: res.status,</span><span class="s3">\n    </span><span class="s1">statusText: res.statusText,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">async function createCachedDynamicResponse(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">res: Response,</span><span class="s3">\n  </span><span class="s1">cacheKey: string,</span><span class="s3">\n  </span><span class="s1">incrementalCacheContext: SetIncrementalFetchCacheContext | undefined,</span><span class="s3">\n  </span><span class="s1">incrementalCache: IncrementalCache,</span><span class="s3">\n  </span><span class="s1">serverComponentsHmrCache: ServerComponentsHmrCache | undefined,</span><span class="s3">\n  </span><span class="s1">revalidate: number,</span><span class="s3">\n  </span><span class="s1">input: RequestInfo | URL,</span><span class="s3">\n  </span><span class="s1">handleUnlock: () =&gt; Promise&lt;void&gt; | void</span><span class="s3">\n</span><span class="s1">): Promise&lt;Response&gt; {</span><span class="s3">\n  </span><span class="s1">// We're cloning the response using this utility because there exists a bug in</span><span class="s3">\n  </span><span class="s1">// the undici library around response cloning. See the following pull request</span><span class="s3">\n  </span><span class="s1">// for more details: https://github.com/vercel/next.js/pull/73274</span><span class="s3">\n  </span><span class="s1">const [cloned1, cloned2] = cloneResponse(res)</span><span class="s3">\n\n  </span><span class="s1">// We are dynamically rendering including dev mode. We want to return the</span><span class="s3">\n  </span><span class="s1">// response to the caller as soon as possible because it might stream over a</span><span class="s3">\n  </span><span class="s1">// very long time.</span><span class="s3">\n  </span><span class="s1">const cacheSetPromise = cloned1</span><span class="s3">\n    </span><span class="s1">.arrayBuffer()</span><span class="s3">\n    </span><span class="s1">.then(async (arrayBuffer) =&gt; {</span><span class="s3">\n      </span><span class="s1">const bodyBuffer = Buffer.from(arrayBuffer)</span><span class="s3">\n\n      </span><span class="s1">const fetchedData = {</span><span class="s3">\n        </span><span class="s1">headers: Object.fromEntries(cloned1.headers.entries()),</span><span class="s3">\n        </span><span class="s1">body: bodyBuffer.toString('base64'),</span><span class="s3">\n        </span><span class="s1">status: cloned1.status,</span><span class="s3">\n        </span><span class="s1">url: cloned1.url,</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">serverComponentsHmrCache?.set(cacheKey, fetchedData)</span><span class="s3">\n\n      </span><span class="s1">if (incrementalCacheContext) {</span><span class="s3">\n        </span><span class="s1">await incrementalCache.set(</span><span class="s3">\n          </span><span class="s1">cacheKey,</span><span class="s3">\n          </span><span class="s1">{ kind: CachedRouteKind.FETCH, data: fetchedData, revalidate },</span><span class="s3">\n          </span><span class="s1">incrementalCacheContext</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">.catch((error) =&gt; console.warn(`Failed to set fetch cache`, input, error))</span><span class="s3">\n    </span><span class="s1">.finally(handleUnlock)</span><span class="s3">\n\n  </span><span class="s1">const pendingRevalidateKey = `cache-set-${cacheKey}`</span><span class="s3">\n  </span><span class="s1">workStore.pendingRevalidates ??= {}</span><span class="s3">\n\n  </span><span class="s1">if (pendingRevalidateKey in workStore.pendingRevalidates) {</span><span class="s3">\n    </span><span class="s1">// there is already a pending revalidate entry that we need to await to</span><span class="s3">\n    </span><span class="s1">// avoid race conditions</span><span class="s3">\n    </span><span class="s1">await workStore.pendingRevalidates[pendingRevalidateKey]</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">workStore.pendingRevalidates[pendingRevalidateKey] = cacheSetPromise.finally(</span><span class="s3">\n    </span><span class="s1">() =&gt; {</span><span class="s3">\n      </span><span class="s1">// If the pending revalidate is not present in the store, then we have</span><span class="s3">\n      </span><span class="s1">// nothing to delete.</span><span class="s3">\n      </span><span class="s1">if (!workStore.pendingRevalidates?.[pendingRevalidateKey]) {</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">delete workStore.pendingRevalidates[pendingRevalidateKey]</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">return cloned2</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface PatchableModule {</span><span class="s3">\n  </span><span class="s1">workAsyncStorage: WorkAsyncStorage</span><span class="s3">\n  </span><span class="s1">workUnitAsyncStorage: WorkUnitAsyncStorage</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createPatchedFetcher(</span><span class="s3">\n  </span><span class="s1">originFetch: Fetcher,</span><span class="s3">\n  </span><span class="s1">{ workAsyncStorage, workUnitAsyncStorage }: PatchableModule</span><span class="s3">\n</span><span class="s1">): PatchedFetcher {</span><span class="s3">\n  </span><span class="s1">// Create the patched fetch function.</span><span class="s3">\n  </span><span class="s1">const patched = async function fetch(</span><span class="s3">\n    </span><span class="s1">input: RequestInfo | URL,</span><span class="s3">\n    </span><span class="s1">init: RequestInit | undefined</span><span class="s3">\n  </span><span class="s1">): Promise&lt;Response&gt; {</span><span class="s3">\n    </span><span class="s1">let url: URL | undefined</span><span class="s3">\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">url = new URL(input instanceof Request ? input.url : input)</span><span class="s3">\n      </span><span class="s1">url.username = ''</span><span class="s3">\n      </span><span class="s1">url.password = ''</span><span class="s3">\n    </span><span class="s1">} catch {</span><span class="s3">\n      </span><span class="s1">// Error caused by malformed URL should be handled by native fetch</span><span class="s3">\n      </span><span class="s1">url = undefined</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const fetchUrl = url?.href ?? ''</span><span class="s3">\n    </span><span class="s1">const method = init?.method?.toUpperCase() || 'GET'</span><span class="s3">\n\n    </span><span class="s1">// Do create a new span trace for internal fetches in the</span><span class="s3">\n    </span><span class="s1">// non-verbose mode.</span><span class="s3">\n    </span><span class="s1">const isInternal = (init?.next as any)?.internal === true</span><span class="s3">\n    </span><span class="s1">const hideSpan = process.env.NEXT_OTEL_FETCH_DISABLED === '1'</span><span class="s3">\n    </span><span class="s1">// We don't track fetch metrics for internal fetches</span><span class="s3">\n    </span><span class="s1">// so it's not critical that we have a start time, as it won't be recorded.</span><span class="s3">\n    </span><span class="s1">// This is to workaround a flaky issue where performance APIs might</span><span class="s3">\n    </span><span class="s1">// not be available and will require follow-up investigation.</span><span class="s3">\n    </span><span class="s1">const fetchStart: number | undefined = isInternal</span><span class="s3">\n      </span><span class="s1">? undefined</span><span class="s3">\n      </span><span class="s1">: performance.timeOrigin + performance.now()</span><span class="s3">\n\n    </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n    </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n\n    </span><span class="s1">// During static generation we track cache reads so we can reason about when they fill</span><span class="s3">\n    </span><span class="s1">let cacheSignal = workUnitStore ? getCacheSignal(workUnitStore) : null</span><span class="s3">\n    </span><span class="s1">if (cacheSignal) {</span><span class="s3">\n      </span><span class="s1">cacheSignal.beginRead()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const result = getTracer().trace(</span><span class="s3">\n      </span><span class="s1">isInternal ? NextNodeServerSpan.internalFetch : AppRenderSpan.fetch,</span><span class="s3">\n      </span><span class="s1">{</span><span class="s3">\n        </span><span class="s1">hideSpan,</span><span class="s3">\n        </span><span class="s1">kind: SpanKind.CLIENT,</span><span class="s3">\n        </span><span class="s1">spanName: ['fetch', method, fetchUrl].filter(Boolean).join(' '),</span><span class="s3">\n        </span><span class="s1">attributes: {</span><span class="s3">\n          </span><span class="s1">'http.url': fetchUrl,</span><span class="s3">\n          </span><span class="s1">'http.method': method,</span><span class="s3">\n          </span><span class="s1">'net.peer.name': url?.hostname,</span><span class="s3">\n          </span><span class="s1">'net.peer.port': url?.port || undefined,</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">async () =&gt; {</span><span class="s3">\n        </span><span class="s1">// If this is an internal fetch, we should not do any special treatment.</span><span class="s3">\n        </span><span class="s1">if (isInternal) {</span><span class="s3">\n          </span><span class="s1">return originFetch(input, init)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// If the workStore is not available, we can't do any</span><span class="s3">\n        </span><span class="s1">// special treatment of fetch, therefore fallback to the original</span><span class="s3">\n        </span><span class="s1">// fetch implementation.</span><span class="s3">\n        </span><span class="s1">if (!workStore) {</span><span class="s3">\n          </span><span class="s1">return originFetch(input, init)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// We should also fallback to the original fetch implementation if we</span><span class="s3">\n        </span><span class="s1">// are in draft mode, it does not constitute a static generation.</span><span class="s3">\n        </span><span class="s1">if (workStore.isDraftMode) {</span><span class="s3">\n          </span><span class="s1">return originFetch(input, init)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const isRequestInput =</span><span class="s3">\n          </span><span class="s1">input &amp;&amp;</span><span class="s3">\n          </span><span class="s1">typeof input === 'object' &amp;&amp;</span><span class="s3">\n          </span><span class="s1">typeof (input as Request).method === 'string'</span><span class="s3">\n\n        </span><span class="s1">const getRequestMeta = (field: string) =&gt; {</span><span class="s3">\n          </span><span class="s1">// If request input is present but init is not, retrieve from input first.</span><span class="s3">\n          </span><span class="s1">const value = (init as any)?.[field]</span><span class="s3">\n          </span><span class="s1">return value || (isRequestInput ? (input as any)[field] : null)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">let finalRevalidate: number | undefined = undefined</span><span class="s3">\n        </span><span class="s1">const getNextField = (field: 'revalidate' | 'tags') =&gt; {</span><span class="s3">\n          </span><span class="s1">return typeof init?.next?.[field] !== 'undefined'</span><span class="s3">\n            </span><span class="s1">? init?.next?.[field]</span><span class="s3">\n            </span><span class="s1">: isRequestInput</span><span class="s3">\n              </span><span class="s1">? (input as any).next?.[field]</span><span class="s3">\n              </span><span class="s1">: undefined</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">// RequestInit doesn't keep extra fields e.g. next so it's</span><span class="s3">\n        </span><span class="s1">// only available if init is used separate</span><span class="s3">\n        </span><span class="s1">const originalFetchRevalidate = getNextField('revalidate')</span><span class="s3">\n        </span><span class="s1">let currentFetchRevalidate = originalFetchRevalidate</span><span class="s3">\n        </span><span class="s1">const tags: string[] = validateTags(</span><span class="s3">\n          </span><span class="s1">getNextField('tags') || [],</span><span class="s3">\n          </span><span class="s1">`fetch ${input.toString()}`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">let revalidateStore: RevalidateStore | undefined</span><span class="s3">\n\n        </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n          </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n            </span><span class="s1">case 'prerender':</span><span class="s3">\n            </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n            </span><span class="s1">// TODO: Stop accumulating tags in client prerender. (fallthrough)</span><span class="s3">\n            </span><span class="s1">case 'prerender-client':</span><span class="s3">\n            </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n            </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n            </span><span class="s1">case 'cache':</span><span class="s3">\n            </span><span class="s1">case 'private-cache':</span><span class="s3">\n              </span><span class="s1">revalidateStore = workUnitStore</span><span class="s3">\n              </span><span class="s1">break</span><span class="s3">\n            </span><span class="s1">case 'request':</span><span class="s3">\n            </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n              </span><span class="s1">break</span><span class="s3">\n            </span><span class="s1">default:</span><span class="s3">\n              </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (revalidateStore) {</span><span class="s3">\n          </span><span class="s1">if (Array.isArray(tags)) {</span><span class="s3">\n            </span><span class="s1">// Collect tags onto parent caches or parent prerenders.</span><span class="s3">\n            </span><span class="s1">const collectedTags =</span><span class="s3">\n              </span><span class="s1">revalidateStore.tags ?? (revalidateStore.tags = [])</span><span class="s3">\n            </span><span class="s1">for (const tag of tags) {</span><span class="s3">\n              </span><span class="s1">if (!collectedTags.includes(tag)) {</span><span class="s3">\n                </span><span class="s1">collectedTags.push(tag)</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const implicitTags = workUnitStore?.implicitTags</span><span class="s3">\n\n        </span><span class="s1">let pageFetchCacheMode = workStore.fetchCache</span><span class="s3">\n\n        </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n          </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n            </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n              </span><span class="s1">// Inside unstable-cache we treat it the same as force-no-store on</span><span class="s3">\n              </span><span class="s1">// the page.</span><span class="s3">\n              </span><span class="s1">pageFetchCacheMode = 'force-no-store'</span><span class="s3">\n              </span><span class="s1">break</span><span class="s3">\n            </span><span class="s1">case 'prerender':</span><span class="s3">\n            </span><span class="s1">case 'prerender-client':</span><span class="s3">\n            </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n            </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n            </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n            </span><span class="s1">case 'request':</span><span class="s3">\n            </span><span class="s1">case 'cache':</span><span class="s3">\n            </span><span class="s1">case 'private-cache':</span><span class="s3">\n              </span><span class="s1">break</span><span class="s3">\n            </span><span class="s1">default:</span><span class="s3">\n              </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const isUsingNoStore = !!workStore.isUnstableNoStore</span><span class="s3">\n\n        </span><span class="s1">let currentFetchCacheConfig = getRequestMeta('cache')</span><span class="s3">\n        </span><span class="s1">let cacheReason = ''</span><span class="s3">\n        </span><span class="s1">let cacheWarning: string | undefined</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">typeof currentFetchCacheConfig === 'string' &amp;&amp;</span><span class="s3">\n          </span><span class="s1">typeof currentFetchRevalidate !== 'undefined'</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">// If the revalidate value conflicts with the cache value, we should warn the user and unset the conflicting values.</span><span class="s3">\n          </span><span class="s1">const isConflictingRevalidate =</span><span class="s3">\n            </span><span class="s1">// revalidate: 0 and cache: force-cache</span><span class="s3">\n            </span><span class="s1">(currentFetchCacheConfig === 'force-cache' &amp;&amp;</span><span class="s3">\n              </span><span class="s1">currentFetchRevalidate === 0) ||</span><span class="s3">\n            </span><span class="s1">// revalidate: &gt;0 or revalidate: false and cache: no-store</span><span class="s3">\n            </span><span class="s1">(currentFetchCacheConfig === 'no-store' &amp;&amp;</span><span class="s3">\n              </span><span class="s1">(currentFetchRevalidate &gt; 0 || currentFetchRevalidate === false))</span><span class="s3">\n\n          </span><span class="s1">if (isConflictingRevalidate) {</span><span class="s3">\n            </span><span class="s1">cacheWarning = `Specified </span><span class="s3">\&quot;</span><span class="s1">cache: ${currentFetchCacheConfig}</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">revalidate: ${currentFetchRevalidate}</span><span class="s3">\&quot;</span><span class="s1">, only one should be specified.`</span><span class="s3">\n            </span><span class="s1">currentFetchCacheConfig = undefined</span><span class="s3">\n            </span><span class="s1">currentFetchRevalidate = undefined</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const hasExplicitFetchCacheOptOut =</span><span class="s3">\n          </span><span class="s1">// fetch config itself signals not to cache</span><span class="s3">\n          </span><span class="s1">currentFetchCacheConfig === 'no-cache' ||</span><span class="s3">\n          </span><span class="s1">currentFetchCacheConfig === 'no-store' ||</span><span class="s3">\n          </span><span class="s1">// the fetch isn't explicitly caching and the segment level cache config signals not to cache</span><span class="s3">\n          </span><span class="s1">// note: `pageFetchCacheMode` is also set by being in an unstable_cache context.</span><span class="s3">\n          </span><span class="s1">pageFetchCacheMode === 'force-no-store' ||</span><span class="s3">\n          </span><span class="s1">pageFetchCacheMode === 'only-no-store'</span><span class="s3">\n\n        </span><span class="s1">// If no explicit fetch cache mode is set, but dynamic = `force-dynamic` is set,</span><span class="s3">\n        </span><span class="s1">// we shouldn't consider caching the fetch. This is because the `dynamic` cache</span><span class="s3">\n        </span><span class="s1">// is considered a </span><span class="s3">\&quot;</span><span class="s1">top-level</span><span class="s3">\&quot; </span><span class="s1">cache mode, whereas something like `fetchCache` is more</span><span class="s3">\n        </span><span class="s1">// fine-grained. Top-level modes are responsible for setting reasonable defaults for the</span><span class="s3">\n        </span><span class="s1">// other configurations.</span><span class="s3">\n        </span><span class="s1">const noFetchConfigAndForceDynamic =</span><span class="s3">\n          </span><span class="s1">!pageFetchCacheMode &amp;&amp;</span><span class="s3">\n          </span><span class="s1">!currentFetchCacheConfig &amp;&amp;</span><span class="s3">\n          </span><span class="s1">!currentFetchRevalidate &amp;&amp;</span><span class="s3">\n          </span><span class="s1">workStore.forceDynamic</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">// force-cache was specified without a revalidate value. We set the revalidate value to false</span><span class="s3">\n          </span><span class="s1">// which will signal the cache to not revalidate</span><span class="s3">\n          </span><span class="s1">currentFetchCacheConfig === 'force-cache' &amp;&amp;</span><span class="s3">\n          </span><span class="s1">typeof currentFetchRevalidate === 'undefined'</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">currentFetchRevalidate = false</span><span class="s3">\n        </span><span class="s1">} else if (</span><span class="s3">\n          </span><span class="s1">hasExplicitFetchCacheOptOut ||</span><span class="s3">\n          </span><span class="s1">noFetchConfigAndForceDynamic</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">currentFetchRevalidate = 0</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">currentFetchCacheConfig === 'no-cache' ||</span><span class="s3">\n          </span><span class="s1">currentFetchCacheConfig === 'no-store'</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">cacheReason = `cache: ${currentFetchCacheConfig}`</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">finalRevalidate = validateRevalidate(</span><span class="s3">\n          </span><span class="s1">currentFetchRevalidate,</span><span class="s3">\n          </span><span class="s1">workStore.route</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">const _headers = getRequestMeta('headers')</span><span class="s3">\n        </span><span class="s1">const initHeaders: Headers =</span><span class="s3">\n          </span><span class="s1">typeof _headers?.get === 'function'</span><span class="s3">\n            </span><span class="s1">? _headers</span><span class="s3">\n            </span><span class="s1">: new Headers(_headers || {})</span><span class="s3">\n\n        </span><span class="s1">const hasUnCacheableHeader =</span><span class="s3">\n          </span><span class="s1">initHeaders.get('authorization') || initHeaders.get('cookie')</span><span class="s3">\n\n        </span><span class="s1">const isUnCacheableMethod = !['get', 'head'].includes(</span><span class="s3">\n          </span><span class="s1">getRequestMeta('method')?.toLowerCase() || 'get'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">/**</span><span class="s3">\n         </span><span class="s1">* We automatically disable fetch caching under the following conditions:</span><span class="s3">\n         </span><span class="s1">* - Fetch cache configs are not set. Specifically:</span><span class="s3">\n         </span><span class="s1">*    - A page fetch cache mode is not set (export const fetchCache=...)</span><span class="s3">\n         </span><span class="s1">*    - A fetch cache mode is not set in the fetch call (fetch(url, { cache: ... }))</span><span class="s3">\n         </span><span class="s1">*      or the fetch cache mode is set to 'default'</span><span class="s3">\n         </span><span class="s1">*    - A fetch revalidate value is not set in the fetch call (fetch(url, { revalidate: ... }))</span><span class="s3">\n         </span><span class="s1">* - OR the fetch comes after a configuration that triggered dynamic rendering (e.g., reading cookies())</span><span class="s3">\n         </span><span class="s1">*   and the fetch was considered uncacheable (e.g., POST method or has authorization headers)</span><span class="s3">\n         </span><span class="s1">*/</span><span class="s3">\n        </span><span class="s1">const hasNoExplicitCacheConfig =</span><span class="s3">\n          </span><span class="s1">// eslint-disable-next-line eqeqeq</span><span class="s3">\n          </span><span class="s1">pageFetchCacheMode == undefined &amp;&amp;</span><span class="s3">\n          </span><span class="s1">// eslint-disable-next-line eqeqeq</span><span class="s3">\n          </span><span class="s1">(currentFetchCacheConfig == undefined ||</span><span class="s3">\n            </span><span class="s1">// when considering whether to opt into the default </span><span class="s3">\&quot;</span><span class="s1">no-cache</span><span class="s3">\&quot; </span><span class="s1">fetch semantics,</span><span class="s3">\n            </span><span class="s1">// a </span><span class="s3">\&quot;</span><span class="s1">default</span><span class="s3">\&quot; </span><span class="s1">cache config should be treated the same as no cache config</span><span class="s3">\n            </span><span class="s1">currentFetchCacheConfig === 'default') &amp;&amp;</span><span class="s3">\n          </span><span class="s1">// eslint-disable-next-line eqeqeq</span><span class="s3">\n          </span><span class="s1">currentFetchRevalidate == undefined</span><span class="s3">\n\n        </span><span class="s1">let autoNoCache = Boolean(</span><span class="s3">\n          </span><span class="s1">(hasUnCacheableHeader || isUnCacheableMethod) &amp;&amp;</span><span class="s3">\n            </span><span class="s1">revalidateStore?.revalidate === 0</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">let isImplicitBuildTimeCache = false</span><span class="s3">\n\n        </span><span class="s1">if (!autoNoCache &amp;&amp; hasNoExplicitCacheConfig) {</span><span class="s3">\n          </span><span class="s1">// We don't enable automatic no-cache behavior during build-time</span><span class="s3">\n          </span><span class="s1">// prerendering so that we can still leverage the fetch cache between</span><span class="s3">\n          </span><span class="s1">// export workers.</span><span class="s3">\n          </span><span class="s1">if (workStore.isBuildTimePrerendering) {</span><span class="s3">\n            </span><span class="s1">isImplicitBuildTimeCache = true</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">autoNoCache = true</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// If we have no cache config, and we're in Dynamic I/O prerendering,</span><span class="s3">\n        </span><span class="s1">// it'll be a dynamic call. We don't have to issue that dynamic call.</span><span class="s3">\n        </span><span class="s1">if (hasNoExplicitCacheConfig &amp;&amp; workUnitStore !== undefined) {</span><span class="s3">\n          </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n            </span><span class="s1">case 'prerender':</span><span class="s3">\n            </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n            </span><span class="s1">// While we don't want to do caching in the client scope we know the</span><span class="s3">\n            </span><span class="s1">// fetch will be dynamic for cacheComponents so we may as well avoid the</span><span class="s3">\n            </span><span class="s1">// call here. (fallthrough)</span><span class="s3">\n            </span><span class="s1">case 'prerender-client':</span><span class="s3">\n              </span><span class="s1">if (cacheSignal) {</span><span class="s3">\n                </span><span class="s1">cacheSignal.endRead()</span><span class="s3">\n                </span><span class="s1">cacheSignal = null</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n\n              </span><span class="s1">return makeHangingPromise&lt;Response&gt;(</span><span class="s3">\n                </span><span class="s1">workUnitStore.renderSignal,</span><span class="s3">\n                </span><span class="s1">workStore.route,</span><span class="s3">\n                </span><span class="s1">'fetch()'</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n            </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n            </span><span class="s1">case 'request':</span><span class="s3">\n            </span><span class="s1">case 'cache':</span><span class="s3">\n            </span><span class="s1">case 'private-cache':</span><span class="s3">\n            </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n              </span><span class="s1">break</span><span class="s3">\n            </span><span class="s1">default:</span><span class="s3">\n              </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">switch (pageFetchCacheMode) {</span><span class="s3">\n          </span><span class="s1">case 'force-no-store': {</span><span class="s3">\n            </span><span class="s1">cacheReason = 'fetchCache = force-no-store'</span><span class="s3">\n            </span><span class="s1">break</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">case 'only-no-store': {</span><span class="s3">\n            </span><span class="s1">if (</span><span class="s3">\n              </span><span class="s1">currentFetchCacheConfig === 'force-cache' ||</span><span class="s3">\n              </span><span class="s1">(typeof finalRevalidate !== 'undefined' &amp;&amp; finalRevalidate &gt; 0)</span><span class="s3">\n            </span><span class="s1">) {</span><span class="s3">\n              </span><span class="s1">throw new Error(</span><span class="s3">\n                </span><span class="s1">`cache: 'force-cache' used on fetch for ${fetchUrl} with 'export const fetchCache = 'only-no-store'`</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">cacheReason = 'fetchCache = only-no-store'</span><span class="s3">\n            </span><span class="s1">break</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">case 'only-cache': {</span><span class="s3">\n            </span><span class="s1">if (currentFetchCacheConfig === 'no-store') {</span><span class="s3">\n              </span><span class="s1">throw new Error(</span><span class="s3">\n                </span><span class="s1">`cache: 'no-store' used on fetch for ${fetchUrl} with 'export const fetchCache = 'only-cache'`</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">break</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">case 'force-cache': {</span><span class="s3">\n            </span><span class="s1">if (</span><span class="s3">\n              </span><span class="s1">typeof currentFetchRevalidate === 'undefined' ||</span><span class="s3">\n              </span><span class="s1">currentFetchRevalidate === 0</span><span class="s3">\n            </span><span class="s1">) {</span><span class="s3">\n              </span><span class="s1">cacheReason = 'fetchCache = force-cache'</span><span class="s3">\n              </span><span class="s1">finalRevalidate = INFINITE_CACHE</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">break</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">case 'default-cache':</span><span class="s3">\n          </span><span class="s1">case 'default-no-store':</span><span class="s3">\n          </span><span class="s1">case 'auto':</span><span class="s3">\n          </span><span class="s1">case undefined:</span><span class="s3">\n            </span><span class="s1">// sometimes we won't match the above cases. the reason we don't move</span><span class="s3">\n            </span><span class="s1">// everything to this switch is the use of autoNoCache which is not a fetchCacheMode</span><span class="s3">\n            </span><span class="s1">// I suspect this could be unified with fetchCacheMode however in which case we could</span><span class="s3">\n            </span><span class="s1">// simplify the switch case and ensure we have an exhaustive switch handling all modes</span><span class="s3">\n            </span><span class="s1">break</span><span class="s3">\n          </span><span class="s1">default:</span><span class="s3">\n            </span><span class="s1">pageFetchCacheMode satisfies never</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (typeof finalRevalidate === 'undefined') {</span><span class="s3">\n          </span><span class="s1">if (pageFetchCacheMode === 'default-cache' &amp;&amp; !isUsingNoStore) {</span><span class="s3">\n            </span><span class="s1">finalRevalidate = INFINITE_CACHE</span><span class="s3">\n            </span><span class="s1">cacheReason = 'fetchCache = default-cache'</span><span class="s3">\n          </span><span class="s1">} else if (pageFetchCacheMode === 'default-no-store') {</span><span class="s3">\n            </span><span class="s1">finalRevalidate = 0</span><span class="s3">\n            </span><span class="s1">cacheReason = 'fetchCache = default-no-store'</span><span class="s3">\n          </span><span class="s1">} else if (isUsingNoStore) {</span><span class="s3">\n            </span><span class="s1">finalRevalidate = 0</span><span class="s3">\n            </span><span class="s1">cacheReason = 'noStore call'</span><span class="s3">\n          </span><span class="s1">} else if (autoNoCache) {</span><span class="s3">\n            </span><span class="s1">finalRevalidate = 0</span><span class="s3">\n            </span><span class="s1">cacheReason = 'auto no cache'</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">// TODO: should we consider this case an invariant?</span><span class="s3">\n            </span><span class="s1">cacheReason = 'auto cache'</span><span class="s3">\n            </span><span class="s1">finalRevalidate = revalidateStore</span><span class="s3">\n              </span><span class="s1">? revalidateStore.revalidate</span><span class="s3">\n              </span><span class="s1">: INFINITE_CACHE</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">} else if (!cacheReason) {</span><span class="s3">\n          </span><span class="s1">cacheReason = `revalidate: ${finalRevalidate}`</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">// when force static is configured we don't bail from</span><span class="s3">\n          </span><span class="s1">// `revalidate: 0` values</span><span class="s3">\n          </span><span class="s1">!(workStore.forceStatic &amp;&amp; finalRevalidate === 0) &amp;&amp;</span><span class="s3">\n          </span><span class="s1">// we don't consider autoNoCache to switch to dynamic for ISR</span><span class="s3">\n          </span><span class="s1">!autoNoCache &amp;&amp;</span><span class="s3">\n          </span><span class="s1">// If the revalidate value isn't currently set or the value is less</span><span class="s3">\n          </span><span class="s1">// than the current revalidate value, we should update the revalidate</span><span class="s3">\n          </span><span class="s1">// value.</span><span class="s3">\n          </span><span class="s1">revalidateStore &amp;&amp;</span><span class="s3">\n          </span><span class="s1">finalRevalidate &lt; revalidateStore.revalidate</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">// If we were setting the revalidate value to 0, we should try to</span><span class="s3">\n          </span><span class="s1">// postpone instead first.</span><span class="s3">\n          </span><span class="s1">if (finalRevalidate === 0) {</span><span class="s3">\n            </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n              </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n                </span><span class="s1">case 'prerender':</span><span class="s3">\n                </span><span class="s1">case 'prerender-client':</span><span class="s3">\n                </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n                  </span><span class="s1">if (cacheSignal) {</span><span class="s3">\n                    </span><span class="s1">cacheSignal.endRead()</span><span class="s3">\n                    </span><span class="s1">cacheSignal = null</span><span class="s3">\n                  </span><span class="s1">}</span><span class="s3">\n                  </span><span class="s1">return makeHangingPromise&lt;Response&gt;(</span><span class="s3">\n                    </span><span class="s1">workUnitStore.renderSignal,</span><span class="s3">\n                    </span><span class="s1">workStore.route,</span><span class="s3">\n                    </span><span class="s1">'fetch()'</span><span class="s3">\n                  </span><span class="s1">)</span><span class="s3">\n                </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n                </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n                </span><span class="s1">case 'request':</span><span class="s3">\n                </span><span class="s1">case 'cache':</span><span class="s3">\n                </span><span class="s1">case 'private-cache':</span><span class="s3">\n                </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n                  </span><span class="s1">break</span><span class="s3">\n                </span><span class="s1">default:</span><span class="s3">\n                  </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">markCurrentScopeAsDynamic(</span><span class="s3">\n              </span><span class="s1">workStore,</span><span class="s3">\n              </span><span class="s1">workUnitStore,</span><span class="s3">\n              </span><span class="s1">`revalidate: 0 fetch ${input} ${workStore.route}`</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// We only want to set the revalidate store's revalidate time if it</span><span class="s3">\n          </span><span class="s1">// was explicitly set for the fetch call, i.e.</span><span class="s3">\n          </span><span class="s1">// originalFetchRevalidate.</span><span class="s3">\n          </span><span class="s1">if (revalidateStore &amp;&amp; originalFetchRevalidate === finalRevalidate) {</span><span class="s3">\n            </span><span class="s1">revalidateStore.revalidate = finalRevalidate</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const isCacheableRevalidate =</span><span class="s3">\n          </span><span class="s1">typeof finalRevalidate === 'number' &amp;&amp; finalRevalidate &gt; 0</span><span class="s3">\n\n        </span><span class="s1">let cacheKey: string | undefined</span><span class="s3">\n        </span><span class="s1">const { incrementalCache } = workStore</span><span class="s3">\n        </span><span class="s1">let isHmrRefresh = false</span><span class="s3">\n        </span><span class="s1">let serverComponentsHmrCache: ServerComponentsHmrCache | undefined</span><span class="s3">\n\n        </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n          </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n            </span><span class="s1">case 'request':</span><span class="s3">\n            </span><span class="s1">case 'cache':</span><span class="s3">\n            </span><span class="s1">case 'private-cache':</span><span class="s3">\n              </span><span class="s1">isHmrRefresh = workUnitStore.isHmrRefresh ?? false</span><span class="s3">\n              </span><span class="s1">serverComponentsHmrCache = workUnitStore.serverComponentsHmrCache</span><span class="s3">\n              </span><span class="s1">break</span><span class="s3">\n            </span><span class="s1">case 'prerender':</span><span class="s3">\n            </span><span class="s1">case 'prerender-client':</span><span class="s3">\n            </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n            </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n            </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n            </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n              </span><span class="s1">break</span><span class="s3">\n            </span><span class="s1">default:</span><span class="s3">\n              </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">incrementalCache &amp;&amp;</span><span class="s3">\n          </span><span class="s1">(isCacheableRevalidate || serverComponentsHmrCache)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">try {</span><span class="s3">\n            </span><span class="s1">cacheKey = await incrementalCache.generateCacheKey(</span><span class="s3">\n              </span><span class="s1">fetchUrl,</span><span class="s3">\n              </span><span class="s1">isRequestInput ? (input as RequestInit) : init</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">} catch (err) {</span><span class="s3">\n            </span><span class="s1">console.error(`Failed to generate cache key for`, input)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const fetchIdx = workStore.nextFetchId ?? 1</span><span class="s3">\n        </span><span class="s1">workStore.nextFetchId = fetchIdx + 1</span><span class="s3">\n\n        </span><span class="s1">let handleUnlock: () =&gt; Promise&lt;void&gt; | void = () =&gt; {}</span><span class="s3">\n\n        </span><span class="s1">const doOriginalFetch = async (</span><span class="s3">\n          </span><span class="s1">isStale?: boolean,</span><span class="s3">\n          </span><span class="s1">cacheReasonOverride?: string</span><span class="s3">\n        </span><span class="s1">) =&gt; {</span><span class="s3">\n          </span><span class="s1">const requestInputFields = [</span><span class="s3">\n            </span><span class="s1">'cache',</span><span class="s3">\n            </span><span class="s1">'credentials',</span><span class="s3">\n            </span><span class="s1">'headers',</span><span class="s3">\n            </span><span class="s1">'integrity',</span><span class="s3">\n            </span><span class="s1">'keepalive',</span><span class="s3">\n            </span><span class="s1">'method',</span><span class="s3">\n            </span><span class="s1">'mode',</span><span class="s3">\n            </span><span class="s1">'redirect',</span><span class="s3">\n            </span><span class="s1">'referrer',</span><span class="s3">\n            </span><span class="s1">'referrerPolicy',</span><span class="s3">\n            </span><span class="s1">'window',</span><span class="s3">\n            </span><span class="s1">'duplex',</span><span class="s3">\n\n            </span><span class="s1">// don't pass through signal when revalidating</span><span class="s3">\n            </span><span class="s1">...(isStale ? [] : ['signal']),</span><span class="s3">\n          </span><span class="s1">]</span><span class="s3">\n\n          </span><span class="s1">if (isRequestInput) {</span><span class="s3">\n            </span><span class="s1">const reqInput: Request = input as any</span><span class="s3">\n            </span><span class="s1">const reqOptions: RequestInit = {</span><span class="s3">\n              </span><span class="s1">body: (reqInput as any)._ogBody || reqInput.body,</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">for (const field of requestInputFields) {</span><span class="s3">\n              </span><span class="s1">// @ts-expect-error custom fields</span><span class="s3">\n              </span><span class="s1">reqOptions[field] = reqInput[field]</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">input = new Request(reqInput.url, reqOptions)</span><span class="s3">\n          </span><span class="s1">} else if (init) {</span><span class="s3">\n            </span><span class="s1">const { _ogBody, body, signal, ...otherInput } =</span><span class="s3">\n              </span><span class="s1">init as RequestInit &amp; { _ogBody?: any }</span><span class="s3">\n            </span><span class="s1">init = {</span><span class="s3">\n              </span><span class="s1">...otherInput,</span><span class="s3">\n              </span><span class="s1">body: _ogBody || body,</span><span class="s3">\n              </span><span class="s1">signal: isStale ? undefined : signal,</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// add metadata to init without editing the original</span><span class="s3">\n          </span><span class="s1">const clonedInit = {</span><span class="s3">\n            </span><span class="s1">...init,</span><span class="s3">\n            </span><span class="s1">next: { ...init?.next, fetchType: 'origin', fetchIdx },</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">return originFetch(input, clonedInit)</span><span class="s3">\n            </span><span class="s1">.then(async (res) =&gt; {</span><span class="s3">\n              </span><span class="s1">if (!isStale &amp;&amp; fetchStart) {</span><span class="s3">\n                </span><span class="s1">trackFetchMetric(workStore, {</span><span class="s3">\n                  </span><span class="s1">start: fetchStart,</span><span class="s3">\n                  </span><span class="s1">url: fetchUrl,</span><span class="s3">\n                  </span><span class="s1">cacheReason: cacheReasonOverride || cacheReason,</span><span class="s3">\n                  </span><span class="s1">cacheStatus:</span><span class="s3">\n                    </span><span class="s1">finalRevalidate === 0 || cacheReasonOverride</span><span class="s3">\n                      </span><span class="s1">? 'skip'</span><span class="s3">\n                      </span><span class="s1">: 'miss',</span><span class="s3">\n                  </span><span class="s1">cacheWarning,</span><span class="s3">\n                  </span><span class="s1">status: res.status,</span><span class="s3">\n                  </span><span class="s1">method: clonedInit.method || 'GET',</span><span class="s3">\n                </span><span class="s1">})</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n              </span><span class="s1">if (</span><span class="s3">\n                </span><span class="s1">res.status === 200 &amp;&amp;</span><span class="s3">\n                </span><span class="s1">incrementalCache &amp;&amp;</span><span class="s3">\n                </span><span class="s1">cacheKey &amp;&amp;</span><span class="s3">\n                </span><span class="s1">(isCacheableRevalidate || serverComponentsHmrCache)</span><span class="s3">\n              </span><span class="s1">) {</span><span class="s3">\n                </span><span class="s1">const normalizedRevalidate =</span><span class="s3">\n                  </span><span class="s1">finalRevalidate &gt;= INFINITE_CACHE</span><span class="s3">\n                    </span><span class="s1">? CACHE_ONE_YEAR</span><span class="s3">\n                    </span><span class="s1">: finalRevalidate</span><span class="s3">\n\n                </span><span class="s1">const incrementalCacheConfig:</span><span class="s3">\n                  </span><span class="s1">| SetIncrementalFetchCacheContext</span><span class="s3">\n                  </span><span class="s1">| undefined = isCacheableRevalidate</span><span class="s3">\n                  </span><span class="s1">? {</span><span class="s3">\n                      </span><span class="s1">fetchCache: true,</span><span class="s3">\n                      </span><span class="s1">fetchUrl,</span><span class="s3">\n                      </span><span class="s1">fetchIdx,</span><span class="s3">\n                      </span><span class="s1">tags,</span><span class="s3">\n                      </span><span class="s1">isImplicitBuildTimeCache,</span><span class="s3">\n                    </span><span class="s1">}</span><span class="s3">\n                  </span><span class="s1">: undefined</span><span class="s3">\n\n                </span><span class="s1">switch (workUnitStore?.type) {</span><span class="s3">\n                  </span><span class="s1">case 'prerender':</span><span class="s3">\n                  </span><span class="s1">case 'prerender-client':</span><span class="s3">\n                  </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n                    </span><span class="s1">return createCachedPrerenderResponse(</span><span class="s3">\n                      </span><span class="s1">res,</span><span class="s3">\n                      </span><span class="s1">cacheKey,</span><span class="s3">\n                      </span><span class="s1">incrementalCacheConfig,</span><span class="s3">\n                      </span><span class="s1">incrementalCache,</span><span class="s3">\n                      </span><span class="s1">normalizedRevalidate,</span><span class="s3">\n                      </span><span class="s1">handleUnlock</span><span class="s3">\n                    </span><span class="s1">)</span><span class="s3">\n                  </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n                  </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n                  </span><span class="s1">case 'request':</span><span class="s3">\n                  </span><span class="s1">case 'cache':</span><span class="s3">\n                  </span><span class="s1">case 'private-cache':</span><span class="s3">\n                  </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n                  </span><span class="s1">case undefined:</span><span class="s3">\n                    </span><span class="s1">return createCachedDynamicResponse(</span><span class="s3">\n                      </span><span class="s1">workStore,</span><span class="s3">\n                      </span><span class="s1">res,</span><span class="s3">\n                      </span><span class="s1">cacheKey,</span><span class="s3">\n                      </span><span class="s1">incrementalCacheConfig,</span><span class="s3">\n                      </span><span class="s1">incrementalCache,</span><span class="s3">\n                      </span><span class="s1">serverComponentsHmrCache,</span><span class="s3">\n                      </span><span class="s1">normalizedRevalidate,</span><span class="s3">\n                      </span><span class="s1">input,</span><span class="s3">\n                      </span><span class="s1">handleUnlock</span><span class="s3">\n                    </span><span class="s1">)</span><span class="s3">\n                  </span><span class="s1">default:</span><span class="s3">\n                    </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n                </span><span class="s1">}</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n\n              </span><span class="s1">// we had response that we determined shouldn't be cached so we return it</span><span class="s3">\n              </span><span class="s1">// and don't cache it. This also needs to unlock the cache lock we acquired.</span><span class="s3">\n              </span><span class="s1">await handleUnlock()</span><span class="s3">\n\n              </span><span class="s1">return res</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n            </span><span class="s1">.catch((error) =&gt; {</span><span class="s3">\n              </span><span class="s1">handleUnlock()</span><span class="s3">\n              </span><span class="s1">throw error</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">let cacheReasonOverride</span><span class="s3">\n        </span><span class="s1">let isForegroundRevalidate = false</span><span class="s3">\n        </span><span class="s1">let isHmrRefreshCache = false</span><span class="s3">\n\n        </span><span class="s1">if (cacheKey &amp;&amp; incrementalCache) {</span><span class="s3">\n          </span><span class="s1">let cachedFetchData: CachedFetchData | undefined</span><span class="s3">\n\n          </span><span class="s1">if (isHmrRefresh &amp;&amp; serverComponentsHmrCache) {</span><span class="s3">\n            </span><span class="s1">cachedFetchData = serverComponentsHmrCache.get(cacheKey)</span><span class="s3">\n            </span><span class="s1">isHmrRefreshCache = true</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">if (isCacheableRevalidate &amp;&amp; !cachedFetchData) {</span><span class="s3">\n            </span><span class="s1">handleUnlock = await incrementalCache.lock(cacheKey)</span><span class="s3">\n            </span><span class="s1">const entry = workStore.isOnDemandRevalidate</span><span class="s3">\n              </span><span class="s1">? null</span><span class="s3">\n              </span><span class="s1">: await incrementalCache.get(cacheKey, {</span><span class="s3">\n                  </span><span class="s1">kind: IncrementalCacheKind.FETCH,</span><span class="s3">\n                  </span><span class="s1">revalidate: finalRevalidate,</span><span class="s3">\n                  </span><span class="s1">fetchUrl,</span><span class="s3">\n                  </span><span class="s1">fetchIdx,</span><span class="s3">\n                  </span><span class="s1">tags,</span><span class="s3">\n                  </span><span class="s1">softTags: implicitTags?.tags,</span><span class="s3">\n                </span><span class="s1">})</span><span class="s3">\n\n            </span><span class="s1">if (hasNoExplicitCacheConfig &amp;&amp; workUnitStore) {</span><span class="s3">\n              </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n                </span><span class="s1">case 'prerender':</span><span class="s3">\n                </span><span class="s1">case 'prerender-client':</span><span class="s3">\n                </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n                  </span><span class="s1">// We sometimes use the cache to dedupe fetches that do not</span><span class="s3">\n                  </span><span class="s1">// specify a cache configuration. In these cases we want to</span><span class="s3">\n                  </span><span class="s1">// make sure we still exclude them from prerenders if</span><span class="s3">\n                  </span><span class="s1">// cacheComponents is on so we introduce an artificial task boundary</span><span class="s3">\n                  </span><span class="s1">// here.</span><span class="s3">\n                  </span><span class="s1">await waitAtLeastOneReactRenderTask()</span><span class="s3">\n                  </span><span class="s1">break</span><span class="s3">\n                </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n                </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n                </span><span class="s1">case 'request':</span><span class="s3">\n                </span><span class="s1">case 'cache':</span><span class="s3">\n                </span><span class="s1">case 'private-cache':</span><span class="s3">\n                </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n                  </span><span class="s1">break</span><span class="s3">\n                </span><span class="s1">default:</span><span class="s3">\n                  </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">if (entry) {</span><span class="s3">\n              </span><span class="s1">await handleUnlock()</span><span class="s3">\n            </span><span class="s1">} else {</span><span class="s3">\n              </span><span class="s1">// in dev, incremental cache response will be null in case the browser adds `cache-control: no-cache` in the request headers</span><span class="s3">\n              </span><span class="s1">cacheReasonOverride = 'cache-control: no-cache (hard refresh)'</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">if (entry?.value &amp;&amp; entry.value.kind === CachedRouteKind.FETCH) {</span><span class="s3">\n              </span><span class="s1">// when stale and is revalidating we wait for fresh data</span><span class="s3">\n              </span><span class="s1">// so the revalidated entry has the updated data</span><span class="s3">\n              </span><span class="s1">if (workStore.isRevalidate &amp;&amp; entry.isStale) {</span><span class="s3">\n                </span><span class="s1">isForegroundRevalidate = true</span><span class="s3">\n              </span><span class="s1">} else {</span><span class="s3">\n                </span><span class="s1">if (entry.isStale) {</span><span class="s3">\n                  </span><span class="s1">workStore.pendingRevalidates ??= {}</span><span class="s3">\n                  </span><span class="s1">if (!workStore.pendingRevalidates[cacheKey]) {</span><span class="s3">\n                    </span><span class="s1">const pendingRevalidate = doOriginalFetch(true)</span><span class="s3">\n                      </span><span class="s1">.then(async (response) =&gt; ({</span><span class="s3">\n                        </span><span class="s1">body: await response.arrayBuffer(),</span><span class="s3">\n                        </span><span class="s1">headers: response.headers,</span><span class="s3">\n                        </span><span class="s1">status: response.status,</span><span class="s3">\n                        </span><span class="s1">statusText: response.statusText,</span><span class="s3">\n                      </span><span class="s1">}))</span><span class="s3">\n                      </span><span class="s1">.finally(() =&gt; {</span><span class="s3">\n                        </span><span class="s1">workStore.pendingRevalidates ??= {}</span><span class="s3">\n                        </span><span class="s1">delete workStore.pendingRevalidates[cacheKey || '']</span><span class="s3">\n                      </span><span class="s1">})</span><span class="s3">\n\n                    </span><span class="s1">// Attach the empty catch here so we don't get a </span><span class="s3">\&quot;</span><span class="s1">unhandled</span><span class="s3">\n                    </span><span class="s1">// promise rejection</span><span class="s3">\&quot; </span><span class="s1">warning.</span><span class="s3">\n                    </span><span class="s1">pendingRevalidate.catch(console.error)</span><span class="s3">\n\n                    </span><span class="s1">workStore.pendingRevalidates[cacheKey] = pendingRevalidate</span><span class="s3">\n                  </span><span class="s1">}</span><span class="s3">\n                </span><span class="s1">}</span><span class="s3">\n\n                </span><span class="s1">cachedFetchData = entry.value.data</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">if (cachedFetchData) {</span><span class="s3">\n            </span><span class="s1">if (fetchStart) {</span><span class="s3">\n              </span><span class="s1">trackFetchMetric(workStore, {</span><span class="s3">\n                </span><span class="s1">start: fetchStart,</span><span class="s3">\n                </span><span class="s1">url: fetchUrl,</span><span class="s3">\n                </span><span class="s1">cacheReason,</span><span class="s3">\n                </span><span class="s1">cacheStatus: isHmrRefreshCache ? 'hmr' : 'hit',</span><span class="s3">\n                </span><span class="s1">cacheWarning,</span><span class="s3">\n                </span><span class="s1">status: cachedFetchData.status || 200,</span><span class="s3">\n                </span><span class="s1">method: init?.method || 'GET',</span><span class="s3">\n              </span><span class="s1">})</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">const response = new Response(</span><span class="s3">\n              </span><span class="s1">Buffer.from(cachedFetchData.body, 'base64'),</span><span class="s3">\n              </span><span class="s1">{</span><span class="s3">\n                </span><span class="s1">headers: cachedFetchData.headers,</span><span class="s3">\n                </span><span class="s1">status: cachedFetchData.status,</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n\n            </span><span class="s1">Object.defineProperty(response, 'url', {</span><span class="s3">\n              </span><span class="s1">value: cachedFetchData.url,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n\n            </span><span class="s1">return response</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (workStore.isStaticGeneration &amp;&amp; init &amp;&amp; typeof init === 'object') {</span><span class="s3">\n          </span><span class="s1">const { cache } = init</span><span class="s3">\n\n          </span><span class="s1">// Delete `cache` property as Cloudflare Workers will throw an error</span><span class="s3">\n          </span><span class="s1">if (isEdgeRuntime) delete init.cache</span><span class="s3">\n\n          </span><span class="s1">if (cache === 'no-store') {</span><span class="s3">\n            </span><span class="s1">// If enabled, we should bail out of static generation.</span><span class="s3">\n            </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n              </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n                </span><span class="s1">case 'prerender':</span><span class="s3">\n                </span><span class="s1">case 'prerender-client':</span><span class="s3">\n                </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n                  </span><span class="s1">if (cacheSignal) {</span><span class="s3">\n                    </span><span class="s1">cacheSignal.endRead()</span><span class="s3">\n                    </span><span class="s1">cacheSignal = null</span><span class="s3">\n                  </span><span class="s1">}</span><span class="s3">\n                  </span><span class="s1">return makeHangingPromise&lt;Response&gt;(</span><span class="s3">\n                    </span><span class="s1">workUnitStore.renderSignal,</span><span class="s3">\n                    </span><span class="s1">workStore.route,</span><span class="s3">\n                    </span><span class="s1">'fetch()'</span><span class="s3">\n                  </span><span class="s1">)</span><span class="s3">\n                </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n                </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n                </span><span class="s1">case 'request':</span><span class="s3">\n                </span><span class="s1">case 'cache':</span><span class="s3">\n                </span><span class="s1">case 'private-cache':</span><span class="s3">\n                </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n                  </span><span class="s1">break</span><span class="s3">\n                </span><span class="s1">default:</span><span class="s3">\n                  </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">markCurrentScopeAsDynamic(</span><span class="s3">\n              </span><span class="s1">workStore,</span><span class="s3">\n              </span><span class="s1">workUnitStore,</span><span class="s3">\n              </span><span class="s1">`no-store fetch ${input} ${workStore.route}`</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">const hasNextConfig = 'next' in init</span><span class="s3">\n          </span><span class="s1">const { next = {} } = init</span><span class="s3">\n          </span><span class="s1">if (</span><span class="s3">\n            </span><span class="s1">typeof next.revalidate === 'number' &amp;&amp;</span><span class="s3">\n            </span><span class="s1">revalidateStore &amp;&amp;</span><span class="s3">\n            </span><span class="s1">next.revalidate &lt; revalidateStore.revalidate</span><span class="s3">\n          </span><span class="s1">) {</span><span class="s3">\n            </span><span class="s1">if (next.revalidate === 0) {</span><span class="s3">\n              </span><span class="s1">// If enabled, we should bail out of static generation.</span><span class="s3">\n              </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n                </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n                  </span><span class="s1">case 'prerender':</span><span class="s3">\n                  </span><span class="s1">case 'prerender-client':</span><span class="s3">\n                  </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n                    </span><span class="s1">return makeHangingPromise&lt;Response&gt;(</span><span class="s3">\n                      </span><span class="s1">workUnitStore.renderSignal,</span><span class="s3">\n                      </span><span class="s1">workStore.route,</span><span class="s3">\n                      </span><span class="s1">'fetch()'</span><span class="s3">\n                    </span><span class="s1">)</span><span class="s3">\n                  </span><span class="s1">case 'request':</span><span class="s3">\n                  </span><span class="s1">case 'cache':</span><span class="s3">\n                  </span><span class="s1">case 'private-cache':</span><span class="s3">\n                  </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n                  </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n                  </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n                    </span><span class="s1">break</span><span class="s3">\n                  </span><span class="s1">default:</span><span class="s3">\n                    </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n                </span><span class="s1">}</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n              </span><span class="s1">markCurrentScopeAsDynamic(</span><span class="s3">\n                </span><span class="s1">workStore,</span><span class="s3">\n                </span><span class="s1">workUnitStore,</span><span class="s3">\n                </span><span class="s1">`revalidate: 0 fetch ${input} ${workStore.route}`</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">if (!workStore.forceStatic || next.revalidate !== 0) {</span><span class="s3">\n              </span><span class="s1">revalidateStore.revalidate = next.revalidate</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">if (hasNextConfig) delete init.next</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// if we are revalidating the whole page via time or on-demand and</span><span class="s3">\n        </span><span class="s1">// the fetch cache entry is stale we should still de-dupe the</span><span class="s3">\n        </span><span class="s1">// origin hit if it's a cache-able entry</span><span class="s3">\n        </span><span class="s1">if (cacheKey &amp;&amp; isForegroundRevalidate) {</span><span class="s3">\n          </span><span class="s1">const pendingRevalidateKey = cacheKey</span><span class="s3">\n          </span><span class="s1">workStore.pendingRevalidates ??= {}</span><span class="s3">\n          </span><span class="s1">let pendingRevalidate =</span><span class="s3">\n            </span><span class="s1">workStore.pendingRevalidates[pendingRevalidateKey]</span><span class="s3">\n\n          </span><span class="s1">if (pendingRevalidate) {</span><span class="s3">\n            </span><span class="s1">const revalidatedResult: {</span><span class="s3">\n              </span><span class="s1">body: ArrayBuffer</span><span class="s3">\n              </span><span class="s1">headers: Headers</span><span class="s3">\n              </span><span class="s1">status: number</span><span class="s3">\n              </span><span class="s1">statusText: string</span><span class="s3">\n            </span><span class="s1">} = await pendingRevalidate</span><span class="s3">\n            </span><span class="s1">return new Response(revalidatedResult.body, {</span><span class="s3">\n              </span><span class="s1">headers: revalidatedResult.headers,</span><span class="s3">\n              </span><span class="s1">status: revalidatedResult.status,</span><span class="s3">\n              </span><span class="s1">statusText: revalidatedResult.statusText,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// We used to just resolve the Response and clone it however for</span><span class="s3">\n          </span><span class="s1">// static generation with cacheComponents we need the response to be able to</span><span class="s3">\n          </span><span class="s1">// be resolved in a microtask and cloning the response will never have</span><span class="s3">\n          </span><span class="s1">// a body that can resolve in a microtask in node (as observed through</span><span class="s3">\n          </span><span class="s1">// experimentation) So instead we await the body and then when it is</span><span class="s3">\n          </span><span class="s1">// available we construct manually cloned Response objects with the</span><span class="s3">\n          </span><span class="s1">// body as an ArrayBuffer. This will be resolvable in a microtask</span><span class="s3">\n          </span><span class="s1">// making it compatible with cacheComponents.</span><span class="s3">\n          </span><span class="s1">const pendingResponse = doOriginalFetch(true, cacheReasonOverride)</span><span class="s3">\n            </span><span class="s1">// We're cloning the response using this utility because there</span><span class="s3">\n            </span><span class="s1">// exists a bug in the undici library around response cloning.</span><span class="s3">\n            </span><span class="s1">// See the following pull request for more details:</span><span class="s3">\n            </span><span class="s1">// https://github.com/vercel/next.js/pull/73274</span><span class="s3">\n            </span><span class="s1">.then(cloneResponse)</span><span class="s3">\n\n          </span><span class="s1">pendingRevalidate = pendingResponse</span><span class="s3">\n            </span><span class="s1">.then(async (responses) =&gt; {</span><span class="s3">\n              </span><span class="s1">const response = responses[0]</span><span class="s3">\n              </span><span class="s1">return {</span><span class="s3">\n                </span><span class="s1">body: await response.arrayBuffer(),</span><span class="s3">\n                </span><span class="s1">headers: response.headers,</span><span class="s3">\n                </span><span class="s1">status: response.status,</span><span class="s3">\n                </span><span class="s1">statusText: response.statusText,</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n            </span><span class="s1">.finally(() =&gt; {</span><span class="s3">\n              </span><span class="s1">// If the pending revalidate is not present in the store, then</span><span class="s3">\n              </span><span class="s1">// we have nothing to delete.</span><span class="s3">\n              </span><span class="s1">if (!workStore.pendingRevalidates?.[pendingRevalidateKey]) {</span><span class="s3">\n                </span><span class="s1">return</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n\n              </span><span class="s1">delete workStore.pendingRevalidates[pendingRevalidateKey]</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n\n          </span><span class="s1">// Attach the empty catch here so we don't get a </span><span class="s3">\&quot;</span><span class="s1">unhandled promise</span><span class="s3">\n          </span><span class="s1">// rejection</span><span class="s3">\&quot; </span><span class="s1">warning</span><span class="s3">\n          </span><span class="s1">pendingRevalidate.catch(() =&gt; {})</span><span class="s3">\n\n          </span><span class="s1">workStore.pendingRevalidates[pendingRevalidateKey] = pendingRevalidate</span><span class="s3">\n\n          </span><span class="s1">return pendingResponse.then((responses) =&gt; responses[1])</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">return doOriginalFetch(false, cacheReasonOverride)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">if (cacheSignal) {</span><span class="s3">\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">return await result</span><span class="s3">\n      </span><span class="s1">} finally {</span><span class="s3">\n        </span><span class="s1">if (cacheSignal) {</span><span class="s3">\n          </span><span class="s1">cacheSignal.endRead()</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return result</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Attach the necessary properties to the patched fetch function.</span><span class="s3">\n  </span><span class="s1">// We don't use this to determine if the fetch function has been patched,</span><span class="s3">\n  </span><span class="s1">// but for external consumers to determine if the fetch function has been</span><span class="s3">\n  </span><span class="s1">// patched.</span><span class="s3">\n  </span><span class="s1">patched.__nextPatched = true as const</span><span class="s3">\n  </span><span class="s1">patched.__nextGetStaticStore = () =&gt; workAsyncStorage</span><span class="s3">\n  </span><span class="s1">patched._nextOriginalFetch = originFetch</span><span class="s3">\n  </span><span class="s1">;(globalThis as Record&lt;symbol, unknown&gt;)[NEXT_PATCH_SYMBOL] = true</span><span class="s3">\n\n  </span><span class="s1">// Assign the function name also as a name property, so that it's preserved</span><span class="s3">\n  </span><span class="s1">// even when mangling is enabled.</span><span class="s3">\n  </span><span class="s1">Object.defineProperty(patched, 'name', { value: 'fetch', writable: false })</span><span class="s3">\n\n  </span><span class="s1">return patched</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// we patch fetch to collect cache information used for</span><span class="s3">\n</span><span class="s1">// determining if a page is static or not</span><span class="s3">\n</span><span class="s1">export function patchFetch(options: PatchableModule) {</span><span class="s3">\n  </span><span class="s1">// If we've already patched fetch, we should not patch it again.</span><span class="s3">\n  </span><span class="s1">if (isFetchPatched()) return</span><span class="s3">\n\n  </span><span class="s1">// Grab the original fetch function. We'll attach this so we can use it in</span><span class="s3">\n  </span><span class="s1">// the patched fetch function.</span><span class="s3">\n  </span><span class="s1">const original = createDedupeFetch(globalThis.fetch)</span><span class="s3">\n\n  </span><span class="s1">// Set the global fetch to the patched fetch.</span><span class="s3">\n  </span><span class="s1">globalThis.fetch = createPatchedFetcher(original, options)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;AppRenderSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;NextNodeServerSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;getTracer&quot;</span><span class="s0">,</span><span class="s1">&quot;SpanKind&quot;</span><span class="s0">,</span><span class="s1">&quot;CACHE_ONE_YEAR&quot;</span><span class="s0">,</span><span class="s1">&quot;INFINITE_CACHE&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_TAG_MAX_ITEMS&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_TAG_MAX_LENGTH&quot;</span><span class="s0">,</span><span class="s1">&quot;markCurrentScopeAsDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;createDedupeFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;getCacheSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;CachedRouteKind&quot;</span><span class="s0">,</span><span class="s1">&quot;IncrementalCacheKind&quot;</span><span class="s0">,</span><span class="s1">&quot;waitAtLeastOneReactRenderTask&quot;</span><span class="s0">,</span><span class="s1">&quot;cloneResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;isEdgeRuntime&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_PATCH_SYMBOL&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;for&quot;</span><span class="s0">,</span><span class="s1">&quot;isFetchPatched&quot;</span><span class="s0">,</span><span class="s1">&quot;globalThis&quot;</span><span class="s0">,</span><span class="s1">&quot;validateRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidateVal&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizedRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;isNaN&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;validateTags&quot;</span><span class="s0">,</span><span class="s1">&quot;tags&quot;</span><span class="s0">,</span><span class="s1">&quot;description&quot;</span><span class="s0">,</span><span class="s1">&quot;validTags&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidTags&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;tag&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;reason&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;warn&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;log&quot;</span><span class="s0">,</span><span class="s1">&quot;trackFetchMetric&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;ctx&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldTrackFetchMetrics&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchMetrics&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;performance&quot;</span><span class="s0">,</span><span class="s1">&quot;timeOrigin&quot;</span><span class="s0">,</span><span class="s1">&quot;now&quot;</span><span class="s0">,</span><span class="s1">&quot;idx&quot;</span><span class="s0">,</span><span class="s1">&quot;nextFetchId&quot;</span><span class="s0">,</span><span class="s1">&quot;createCachedPrerenderResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;incrementalCacheContext&quot;</span><span class="s0">,</span><span class="s1">&quot;incrementalCache&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;handleUnlock&quot;</span><span class="s0">,</span><span class="s1">&quot;bodyBuffer&quot;</span><span class="s0">,</span><span class="s1">&quot;arrayBuffer&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchedData&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;fromEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;Buffer&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;kind&quot;</span><span class="s0">,</span><span class="s1">&quot;FETCH&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;Response&quot;</span><span class="s0">,</span><span class="s1">&quot;statusText&quot;</span><span class="s0">,</span><span class="s1">&quot;createCachedDynamicResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;serverComponentsHmrCache&quot;</span><span class="s0">,</span><span class="s1">&quot;input&quot;</span><span class="s0">,</span><span class="s1">&quot;cloned1&quot;</span><span class="s0">,</span><span class="s1">&quot;cloned2&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheSetPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;catch&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;finally&quot;</span><span class="s0">,</span><span class="s1">&quot;pendingRevalidateKey&quot;</span><span class="s0">,</span><span class="s1">&quot;pendingRevalidates&quot;</span><span class="s0">,</span><span class="s1">&quot;createPatchedFetcher&quot;</span><span class="s0">,</span><span class="s1">&quot;originFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;patched&quot;</span><span class="s0">,</span><span class="s1">&quot;fetch&quot;</span><span class="s0">,</span><span class="s1">&quot;init&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;Request&quot;</span><span class="s0">,</span><span class="s1">&quot;username&quot;</span><span class="s0">,</span><span class="s1">&quot;password&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;href&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;toUpperCase&quot;</span><span class="s0">,</span><span class="s1">&quot;isInternal&quot;</span><span class="s0">,</span><span class="s1">&quot;next&quot;</span><span class="s0">,</span><span class="s1">&quot;internal&quot;</span><span class="s0">,</span><span class="s1">&quot;hideSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_OTEL_FETCH_DISABLED&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchStart&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitStore&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;beginRead&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;trace&quot;</span><span class="s0">,</span><span class="s1">&quot;internalFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;CLIENT&quot;</span><span class="s0">,</span><span class="s1">&quot;spanName&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;Boolean&quot;</span><span class="s0">,</span><span class="s1">&quot;attributes&quot;</span><span class="s0">,</span><span class="s1">&quot;hostname&quot;</span><span class="s0">,</span><span class="s1">&quot;port&quot;</span><span class="s0">,</span><span class="s1">&quot;getRequestMeta&quot;</span><span class="s0">,</span><span class="s1">&quot;isDraftMode&quot;</span><span class="s0">,</span><span class="s1">&quot;isRequestInput&quot;</span><span class="s0">,</span><span class="s1">&quot;field&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;finalRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;getNextField&quot;</span><span class="s0">,</span><span class="s1">&quot;originalFetchRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;currentFetchRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidateStore&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;collectedTags&quot;</span><span class="s0">,</span><span class="s1">&quot;implicitTags&quot;</span><span class="s0">,</span><span class="s1">&quot;pageFetchCacheMode&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchCache&quot;</span><span class="s0">,</span><span class="s1">&quot;isUsingNoStore&quot;</span><span class="s0">,</span><span class="s1">&quot;isUnstableNoStore&quot;</span><span class="s0">,</span><span class="s1">&quot;currentFetchCacheConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheReason&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheWarning&quot;</span><span class="s0">,</span><span class="s1">&quot;isConflictingRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;hasExplicitFetchCacheOptOut&quot;</span><span class="s0">,</span><span class="s1">&quot;noFetchConfigAndForceDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;forceDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;_headers&quot;</span><span class="s0">,</span><span class="s1">&quot;initHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;Headers&quot;</span><span class="s0">,</span><span class="s1">&quot;hasUnCacheableHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;isUnCacheableMethod&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;hasNoExplicitCacheConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;autoNoCache&quot;</span><span class="s0">,</span><span class="s1">&quot;isImplicitBuildTimeCache&quot;</span><span class="s0">,</span><span class="s1">&quot;isBuildTimePrerendering&quot;</span><span class="s0">,</span><span class="s1">&quot;endRead&quot;</span><span class="s0">,</span><span class="s1">&quot;renderSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;forceStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;isCacheableRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;isHmrRefresh&quot;</span><span class="s0">,</span><span class="s1">&quot;generateCacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchIdx&quot;</span><span class="s0">,</span><span class="s1">&quot;doOriginalFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;isStale&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheReasonOverride&quot;</span><span class="s0">,</span><span class="s1">&quot;requestInputFields&quot;</span><span class="s0">,</span><span class="s1">&quot;reqInput&quot;</span><span class="s0">,</span><span class="s1">&quot;reqOptions&quot;</span><span class="s0">,</span><span class="s1">&quot;_ogBody&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;otherInput&quot;</span><span class="s0">,</span><span class="s1">&quot;clonedInit&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchType&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;incrementalCacheConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;isForegroundRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;isHmrRefreshCache&quot;</span><span class="s0">,</span><span class="s1">&quot;cachedFetchData&quot;</span><span class="s0">,</span><span class="s1">&quot;lock&quot;</span><span class="s0">,</span><span class="s1">&quot;entry&quot;</span><span class="s0">,</span><span class="s1">&quot;isOnDemandRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;softTags&quot;</span><span class="s0">,</span><span class="s1">&quot;isRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;pendingRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;defineProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;isStaticGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;cache&quot;</span><span class="s0">,</span><span class="s1">&quot;hasNextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidatedResult&quot;</span><span class="s0">,</span><span class="s1">&quot;pendingResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;responses&quot;</span><span class="s0">,</span><span class="s1">&quot;__nextPatched&quot;</span><span class="s0">,</span><span class="s1">&quot;__nextGetStaticStore&quot;</span><span class="s0">,</span><span class="s1">&quot;_nextOriginalFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;writable&quot;</span><span class="s0">,</span><span class="s1">&quot;patchFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;original&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7076</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/page-path/ensure-leading-slash.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* For a given page path, this function ensures that there is a leading slash.</span><span class="s3">\n </span><span class="s1">* If there is not a leading slash, one is added, otherwise it is noop.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function ensureLeadingSlash(path: string) {</span><span class="s3">\n  </span><span class="s1">return path.startsWith('/') ? path : `/${path}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ensureLeadingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;CAGC,GACD;;;;AAAO,SAASA,mBAAmBC,IAAY;IAC7C,OAAOA,KAAKC,UAAU,CAAC,OAAOD,OAAQ,MAAGA;AAC3C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7090</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/segment.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { Segment } from '../../server/app-render/types'</span><span class="s3">\n\n</span><span class="s1">export function isGroupSegment(segment: string) {</span><span class="s3">\n  </span><span class="s1">// Use array[0] for performant purpose</span><span class="s3">\n  </span><span class="s1">return segment[0] === '(' &amp;&amp; segment.endsWith(')')</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isParallelRouteSegment(segment: string) {</span><span class="s3">\n  </span><span class="s1">return segment.startsWith('@') &amp;&amp; segment !== '@children'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function addSearchParamsIfPageSegment(</span><span class="s3">\n  </span><span class="s1">segment: Segment,</span><span class="s3">\n  </span><span class="s1">searchParams: Record&lt;string, string | string[] | undefined&gt;</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const isPageSegment = segment.includes(PAGE_SEGMENT_KEY)</span><span class="s3">\n\n  </span><span class="s1">if (isPageSegment) {</span><span class="s3">\n    </span><span class="s1">const stringifiedQuery = JSON.stringify(searchParams)</span><span class="s3">\n    </span><span class="s1">return stringifiedQuery !== '{}'</span><span class="s3">\n      </span><span class="s1">? PAGE_SEGMENT_KEY + '?' + stringifiedQuery</span><span class="s3">\n      </span><span class="s1">: PAGE_SEGMENT_KEY</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return segment</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const PAGE_SEGMENT_KEY = '__PAGE__'</span><span class="s3">\n</span><span class="s1">export const DEFAULT_SEGMENT_KEY = '__DEFAULT__'</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isGroupSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;isParallelRouteSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;addSearchParamsIfPageSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;searchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;isPageSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGE_SEGMENT_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;stringifiedQuery&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;DEFAULT_SEGMENT_KEY&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;AAEO,SAASA,eAAeC,OAAe;IAC5C,sCAAsC;IACtC,OAAOA,OAAO,CAAC,EAAE,KAAK,OAAOA,QAAQC,QAAQ,CAAC;AAChD;AAEO,SAASC,uBAAuBF,OAAe;IACpD,OAAOA,QAAQG,UAAU,CAAC,QAAQH,YAAY;AAChD;AAEO,SAASI,6BACdJ,OAAgB,EAChBK,YAA2D;IAE3D,MAAMC,gBAAgBN,QAAQO,QAAQ,CAACC;IAEvC,IAAIF,eAAe;QACjB,MAAMG,mBAAmBC,KAAKC,SAAS,CAACN;QACxC,OAAOI,qBAAqB,OACxBD,mBAAmB,MAAMC,mBACzBD;IACN;IAEA,OAAOR;AACT;AAEO,MAAMQ,mBAAmB,WAAU;AACnC,MAAMI,sBAAsB,cAAa&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7123</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/app-paths.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { ensureLeadingSlash } from '../../page-path/ensure-leading-slash'</span><span class="s3">\n</span><span class="s1">import { isGroupSegment } from '../../segment'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Normalizes an app route so it represents the actual request path. Essentially</span><span class="s3">\n </span><span class="s1">* performing the following transformations:</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/user/[id]/page` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/account/page` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/user/[id]/page` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/account/page` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/page` to `/`</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/user/[id]/route` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/account/route` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/user/[id]/route` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/account/route` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/route` to `/`</span><span class="s3">\n </span><span class="s1">* - `/` to `/`</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param route the app route to normalize</span><span class="s3">\n </span><span class="s1">* @returns the normalized pathname</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeAppPath(route: string) {</span><span class="s3">\n  </span><span class="s1">return ensureLeadingSlash(</span><span class="s3">\n    </span><span class="s1">route.split('/').reduce((pathname, segment, index, segments) =&gt; {</span><span class="s3">\n      </span><span class="s1">// Empty segments are ignored.</span><span class="s3">\n      </span><span class="s1">if (!segment) {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Groups are ignored.</span><span class="s3">\n      </span><span class="s1">if (isGroupSegment(segment)) {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Parallel segments are ignored.</span><span class="s3">\n      </span><span class="s1">if (segment[0] === '@') {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// The last segment (if it's a leaf) should be ignored.</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">(segment === 'page' || segment === 'route') &amp;&amp;</span><span class="s3">\n        </span><span class="s1">index === segments.length - 1</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return `${pathname}/${segment}`</span><span class="s3">\n    </span><span class="s1">}, '')</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Strips the `.rsc` extension if it's in the pathname.</span><span class="s3">\n </span><span class="s1">* Since this function is used on full urls it checks `?` for searchParams handling.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeRscURL(url: string) {</span><span class="s3">\n  </span><span class="s1">return url.replace(</span><span class="s3">\n    </span><span class="s1">/</span><span class="s3">\\</span><span class="s1">.rsc($|</span><span class="s3">\\</span><span class="s1">?)/,</span><span class="s3">\n    </span><span class="s1">// $1 ensures `?` is preserved</span><span class="s3">\n    </span><span class="s1">'$1'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ensureLeadingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;isGroupSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;reduce&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;segments&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeRscURL&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAAA,SAASA,kBAAkB,QAAQ,uCAAsC;AACzE,SAASC,cAAc,QAAQ,gBAAe;;;AAqBvC,SAASC,iBAAiBC,KAAa;IAC5C,WAAOH,0NAAAA,EACLG,MAAMC,KAAK,CAAC,KAAKC,MAAM,CAAC,CAACC,UAAUC,SAASC,OAAOC;QACjD,8BAA8B;QAC9B,IAAI,CAACF,SAAS;YACZ,OAAOD;QACT;QAEA,sBAAsB;QACtB,QAAIL,mLAAAA,EAAeM,UAAU;YAC3B,OAAOD;QACT;QAEA,iCAAiC;QACjC,IAAIC,OAAO,CAAC,EAAE,KAAK,KAAK;YACtB,OAAOD;QACT;QAEA,uDAAuD;QACvD,IACGC,CAAAA,YAAY,UAAUA,YAAY,OAAM,KACzCC,UAAUC,SAASC,MAAM,GAAG,GAC5B;YACA,OAAOJ;QACT;QAEA,OAAUA,WAAS,MAAGC;IACxB,GAAG;AAEP;AAMO,SAASI,gBAAgBC,GAAW;IACzC,OAAOA,IAAIC,OAAO,CAChB,eACA,AACA,8BAD8B;AAGlC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7161</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/web/spec-extension/adapters/reflect.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export class ReflectAdapter {</span><span class="s3">\n  </span><span class="s1">static get&lt;T extends object&gt;(</span><span class="s3">\n    </span><span class="s1">target: T,</span><span class="s3">\n    </span><span class="s1">prop: string | symbol,</span><span class="s3">\n    </span><span class="s1">receiver: unknown</span><span class="s3">\n  </span><span class="s1">): any {</span><span class="s3">\n    </span><span class="s1">const value = Reflect.get(target, prop, receiver)</span><span class="s3">\n    </span><span class="s1">if (typeof value === 'function') {</span><span class="s3">\n      </span><span class="s1">return value.bind(target)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static set&lt;T extends object&gt;(</span><span class="s3">\n    </span><span class="s1">target: T,</span><span class="s3">\n    </span><span class="s1">prop: string | symbol,</span><span class="s3">\n    </span><span class="s1">value: any,</span><span class="s3">\n    </span><span class="s1">receiver: any</span><span class="s3">\n  </span><span class="s1">): boolean {</span><span class="s3">\n    </span><span class="s1">return Reflect.set(target, prop, value, receiver)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static has&lt;T extends object&gt;(target: T, prop: string | symbol): boolean {</span><span class="s3">\n    </span><span class="s1">return Reflect.has(target, prop)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static deleteProperty&lt;T extends object&gt;(</span><span class="s3">\n    </span><span class="s1">target: T,</span><span class="s3">\n    </span><span class="s1">prop: string | symbol</span><span class="s3">\n  </span><span class="s1">): boolean {</span><span class="s3">\n    </span><span class="s1">return Reflect.deleteProperty(target, prop)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ReflectAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;receiver&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;Reflect&quot;</span><span class="s0">,</span><span class="s1">&quot;bind&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;deleteProperty&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,MAAMA;IACX,OAAOC,IACLC,MAAS,EACTC,IAAqB,EACrBC,QAAiB,EACZ;QACL,MAAMC,QAAQC,QAAQL,GAAG,CAACC,QAAQC,MAAMC;QACxC,IAAI,OAAOC,UAAU,YAAY;YAC/B,OAAOA,MAAME,IAAI,CAACL;QACpB;QAEA,OAAOG;IACT;IAEA,OAAOG,IACLN,MAAS,EACTC,IAAqB,EACrBE,KAAU,EACVD,QAAa,EACJ;QACT,OAAOE,QAAQE,GAAG,CAACN,QAAQC,MAAME,OAAOD;IAC1C;IAEA,OAAOK,IAAsBP,MAAS,EAAEC,IAAqB,EAAW;QACtE,OAAOG,QAAQG,GAAG,CAACP,QAAQC;IAC7B;IAEA,OAAOO,eACLR,MAAS,EACTC,IAAqB,EACZ;QACT,OAAOG,QAAQI,cAAc,CAACR,QAAQC;IACxC;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7187</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/web/spec-extension/adapters/headers.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { IncomingHttpHeaders } from 'http'</span><span class="s3">\n\n</span><span class="s1">import { ReflectAdapter } from './reflect'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class ReadonlyHeadersError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor() {</span><span class="s3">\n    </span><span class="s1">super(</span><span class="s3">\n      </span><span class="s1">'Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public static callable() {</span><span class="s3">\n    </span><span class="s1">throw new ReadonlyHeadersError()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type ReadonlyHeaders = Headers &amp; {</span><span class="s3">\n  </span><span class="s1">/** @deprecated Method unavailable on `ReadonlyHeaders`. Read more: https://nextjs.org/docs/app/api-reference/functions/headers */</span><span class="s3">\n  </span><span class="s1">append(...args: any[]): void</span><span class="s3">\n  </span><span class="s1">/** @deprecated Method unavailable on `ReadonlyHeaders`. Read more: https://nextjs.org/docs/app/api-reference/functions/headers */</span><span class="s3">\n  </span><span class="s1">set(...args: any[]): void</span><span class="s3">\n  </span><span class="s1">/** @deprecated Method unavailable on `ReadonlyHeaders`. Read more: https://nextjs.org/docs/app/api-reference/functions/headers */</span><span class="s3">\n  </span><span class="s1">delete(...args: any[]): void</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">export class HeadersAdapter extends Headers {</span><span class="s3">\n  </span><span class="s1">private readonly headers: IncomingHttpHeaders</span><span class="s3">\n\n  </span><span class="s1">constructor(headers: IncomingHttpHeaders) {</span><span class="s3">\n    </span><span class="s1">// We've already overridden the methods that would be called, so we're just</span><span class="s3">\n    </span><span class="s1">// calling the super constructor to ensure that the instanceof check works.</span><span class="s3">\n    </span><span class="s1">super()</span><span class="s3">\n\n    </span><span class="s1">this.headers = new Proxy(headers, {</span><span class="s3">\n      </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n        </span><span class="s1">// Because this is just an object, we expect that all </span><span class="s3">\&quot;</span><span class="s1">get</span><span class="s3">\&quot; </span><span class="s1">operations</span><span class="s3">\n        </span><span class="s1">// are for properties. If it's a </span><span class="s3">\&quot;</span><span class="s1">get</span><span class="s3">\&quot; </span><span class="s1">for a symbol, we'll just return</span><span class="s3">\n        </span><span class="s1">// the symbol.</span><span class="s3">\n        </span><span class="s1">if (typeof prop === 'symbol') {</span><span class="s3">\n          </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const lowercased = prop.toLowerCase()</span><span class="s3">\n\n        </span><span class="s1">// Let's find the original casing of the key. This assumes that there is</span><span class="s3">\n        </span><span class="s1">// no mixed case keys (e.g. </span><span class="s3">\&quot;</span><span class="s1">Content-Type</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">content-type</span><span class="s3">\&quot;</span><span class="s1">) in the</span><span class="s3">\n        </span><span class="s1">// headers object.</span><span class="s3">\n        </span><span class="s1">const original = Object.keys(headers).find(</span><span class="s3">\n          </span><span class="s1">(o) =&gt; o.toLowerCase() === lowercased</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">// If the original casing doesn't exist, return undefined.</span><span class="s3">\n        </span><span class="s1">if (typeof original === 'undefined') return</span><span class="s3">\n\n        </span><span class="s1">// If the original casing exists, return the value.</span><span class="s3">\n        </span><span class="s1">return ReflectAdapter.get(target, original, receiver)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">set(target, prop, value, receiver) {</span><span class="s3">\n        </span><span class="s1">if (typeof prop === 'symbol') {</span><span class="s3">\n          </span><span class="s1">return ReflectAdapter.set(target, prop, value, receiver)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const lowercased = prop.toLowerCase()</span><span class="s3">\n\n        </span><span class="s1">// Let's find the original casing of the key. This assumes that there is</span><span class="s3">\n        </span><span class="s1">// no mixed case keys (e.g. </span><span class="s3">\&quot;</span><span class="s1">Content-Type</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">content-type</span><span class="s3">\&quot;</span><span class="s1">) in the</span><span class="s3">\n        </span><span class="s1">// headers object.</span><span class="s3">\n        </span><span class="s1">const original = Object.keys(headers).find(</span><span class="s3">\n          </span><span class="s1">(o) =&gt; o.toLowerCase() === lowercased</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">// If the original casing doesn't exist, use the prop as the key.</span><span class="s3">\n        </span><span class="s1">return ReflectAdapter.set(target, original ?? prop, value, receiver)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">has(target, prop) {</span><span class="s3">\n        </span><span class="s1">if (typeof prop === 'symbol') return ReflectAdapter.has(target, prop)</span><span class="s3">\n\n        </span><span class="s1">const lowercased = prop.toLowerCase()</span><span class="s3">\n\n        </span><span class="s1">// Let's find the original casing of the key. This assumes that there is</span><span class="s3">\n        </span><span class="s1">// no mixed case keys (e.g. </span><span class="s3">\&quot;</span><span class="s1">Content-Type</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">content-type</span><span class="s3">\&quot;</span><span class="s1">) in the</span><span class="s3">\n        </span><span class="s1">// headers object.</span><span class="s3">\n        </span><span class="s1">const original = Object.keys(headers).find(</span><span class="s3">\n          </span><span class="s1">(o) =&gt; o.toLowerCase() === lowercased</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">// If the original casing doesn't exist, return false.</span><span class="s3">\n        </span><span class="s1">if (typeof original === 'undefined') return false</span><span class="s3">\n\n        </span><span class="s1">// If the original casing exists, return true.</span><span class="s3">\n        </span><span class="s1">return ReflectAdapter.has(target, original)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">deleteProperty(target, prop) {</span><span class="s3">\n        </span><span class="s1">if (typeof prop === 'symbol')</span><span class="s3">\n          </span><span class="s1">return ReflectAdapter.deleteProperty(target, prop)</span><span class="s3">\n\n        </span><span class="s1">const lowercased = prop.toLowerCase()</span><span class="s3">\n\n        </span><span class="s1">// Let's find the original casing of the key. This assumes that there is</span><span class="s3">\n        </span><span class="s1">// no mixed case keys (e.g. </span><span class="s3">\&quot;</span><span class="s1">Content-Type</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">content-type</span><span class="s3">\&quot;</span><span class="s1">) in the</span><span class="s3">\n        </span><span class="s1">// headers object.</span><span class="s3">\n        </span><span class="s1">const original = Object.keys(headers).find(</span><span class="s3">\n          </span><span class="s1">(o) =&gt; o.toLowerCase() === lowercased</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">// If the original casing doesn't exist, return true.</span><span class="s3">\n        </span><span class="s1">if (typeof original === 'undefined') return true</span><span class="s3">\n\n        </span><span class="s1">// If the original casing exists, delete the property.</span><span class="s3">\n        </span><span class="s1">return ReflectAdapter.deleteProperty(target, original)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Seals a Headers instance to prevent modification by throwing an error when</span><span class="s3">\n   </span><span class="s1">* any mutating method is called.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public static seal(headers: Headers): ReadonlyHeaders {</span><span class="s3">\n    </span><span class="s1">return new Proxy&lt;ReadonlyHeaders&gt;(headers, {</span><span class="s3">\n      </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n        </span><span class="s1">switch (prop) {</span><span class="s3">\n          </span><span class="s1">case 'append':</span><span class="s3">\n          </span><span class="s1">case 'delete':</span><span class="s3">\n          </span><span class="s1">case 'set':</span><span class="s3">\n            </span><span class="s1">return ReadonlyHeadersError.callable</span><span class="s3">\n          </span><span class="s1">default:</span><span class="s3">\n            </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Merges a header value into a string. This stores multiple values as an</span><span class="s3">\n   </span><span class="s1">* array, so we need to merge them into a string.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param value a header value</span><span class="s3">\n   </span><span class="s1">* @returns a merged header value (a string)</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">private merge(value: string | string[]): string {</span><span class="s3">\n    </span><span class="s1">if (Array.isArray(value)) return value.join(', ')</span><span class="s3">\n\n    </span><span class="s1">return value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Creates a Headers instance from a plain object or a Headers instance.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param headers a plain object or a Headers instance</span><span class="s3">\n   </span><span class="s1">* @returns a headers instance</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public static from(headers: IncomingHttpHeaders | Headers): Headers {</span><span class="s3">\n    </span><span class="s1">if (headers instanceof Headers) return headers</span><span class="s3">\n\n    </span><span class="s1">return new HeadersAdapter(headers)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public append(name: string, value: string): void {</span><span class="s3">\n    </span><span class="s1">const existing = this.headers[name]</span><span class="s3">\n    </span><span class="s1">if (typeof existing === 'string') {</span><span class="s3">\n      </span><span class="s1">this.headers[name] = [existing, value]</span><span class="s3">\n    </span><span class="s1">} else if (Array.isArray(existing)) {</span><span class="s3">\n      </span><span class="s1">existing.push(value)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">this.headers[name] = value</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public delete(name: string): void {</span><span class="s3">\n    </span><span class="s1">delete this.headers[name]</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get(name: string): string | null {</span><span class="s3">\n    </span><span class="s1">const value = this.headers[name]</span><span class="s3">\n    </span><span class="s1">if (typeof value !== 'undefined') return this.merge(value)</span><span class="s3">\n\n    </span><span class="s1">return null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public has(name: string): boolean {</span><span class="s3">\n    </span><span class="s1">return typeof this.headers[name] !== 'undefined'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public set(name: string, value: string): void {</span><span class="s3">\n    </span><span class="s1">this.headers[name] = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public forEach(</span><span class="s3">\n    </span><span class="s1">callbackfn: (value: string, name: string, parent: Headers) =&gt; void,</span><span class="s3">\n    </span><span class="s1">thisArg?: any</span><span class="s3">\n  </span><span class="s1">): void {</span><span class="s3">\n    </span><span class="s1">for (const [name, value] of this.entries()) {</span><span class="s3">\n      </span><span class="s1">callbackfn.call(thisArg, value, name, this)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public *entries(): HeadersIterator&lt;[string, string]&gt; {</span><span class="s3">\n    </span><span class="s1">for (const key of Object.keys(this.headers)) {</span><span class="s3">\n      </span><span class="s1">const name = key.toLowerCase()</span><span class="s3">\n      </span><span class="s1">// We assert here that this is a string because we got it from the</span><span class="s3">\n      </span><span class="s1">// Object.keys() call above.</span><span class="s3">\n      </span><span class="s1">const value = this.get(name) as string</span><span class="s3">\n\n      </span><span class="s1">yield [name, value] as [string, string]</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public *keys(): HeadersIterator&lt;string&gt; {</span><span class="s3">\n    </span><span class="s1">for (const key of Object.keys(this.headers)) {</span><span class="s3">\n      </span><span class="s1">const name = key.toLowerCase()</span><span class="s3">\n      </span><span class="s1">yield name</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public *values(): HeadersIterator&lt;string&gt; {</span><span class="s3">\n    </span><span class="s1">for (const key of Object.keys(this.headers)) {</span><span class="s3">\n      </span><span class="s1">// We assert here that this is a string because we got it from the</span><span class="s3">\n      </span><span class="s1">// Object.keys() call above.</span><span class="s3">\n      </span><span class="s1">const value = this.get(key) as string</span><span class="s3">\n\n      </span><span class="s1">yield value</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public [Symbol.iterator](): HeadersIterator&lt;[string, string]&gt; {</span><span class="s3">\n    </span><span class="s1">return this.entries()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ReflectAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;ReadonlyHeadersError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;callable&quot;</span><span class="s0">,</span><span class="s1">&quot;HeadersAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;Headers&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;Proxy&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;receiver&quot;</span><span class="s0">,</span><span class="s1">&quot;lowercased&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;original&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;find&quot;</span><span class="s0">,</span><span class="s1">&quot;o&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;deleteProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;seal&quot;</span><span class="s0">,</span><span class="s1">&quot;merge&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;append&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;existing&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;callbackfn&quot;</span><span class="s0">,</span><span class="s1">&quot;thisArg&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;call&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;iterator&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7365</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/compiled/cookie/index.js&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;(()=&gt;{</span><span class="s3">\&quot;</span><span class="s1">use strict</span><span class="s3">\&quot;</span><span class="s1">;if(typeof __nccwpck_require__!==</span><span class="s3">\&quot;</span><span class="s1">undefined</span><span class="s3">\&quot;</span><span class="s1">)__nccwpck_require__.ab=__dirname+</span><span class="s3">\&quot;</span><span class="s1">/</span><span class="s3">\&quot;</span><span class="s1">;var e={};(()=&gt;{var r=e;</span><span class="s3">\n</span><span class="s1">/*!</span><span class="s3">\n </span><span class="s1">* cookie</span><span class="s3">\n </span><span class="s1">* Copyright(c) 2012-2014 Roman Shtylman</span><span class="s3">\n </span><span class="s1">* Copyright(c) 2015 Douglas Christopher Wilson</span><span class="s3">\n </span><span class="s1">* MIT Licensed</span><span class="s3">\n </span><span class="s1">*/r.parse=parse;r.serialize=serialize;var i=decodeURIComponent;var t=encodeURIComponent;var a=/; */;var n=/^[</span><span class="s3">\\</span><span class="s1">u0009</span><span class="s3">\\</span><span class="s1">u0020-</span><span class="s3">\\</span><span class="s1">u007e</span><span class="s3">\\</span><span class="s1">u0080-</span><span class="s3">\\</span><span class="s1">u00ff]+$/;function parse(e,r){if(typeof e!==</span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">){throw new TypeError(</span><span class="s3">\&quot;</span><span class="s1">argument str must be a string</span><span class="s3">\&quot;</span><span class="s1">)}var t={};var n=r||{};var o=e.split(a);var s=n.decode||i;for(var p=0;p&lt;o.length;p++){var f=o[p];var u=f.indexOf(</span><span class="s3">\&quot;</span><span class="s1">=</span><span class="s3">\&quot;</span><span class="s1">);if(u&lt;0){continue}var v=f.substr(0,u).trim();var c=f.substr(++u,f.length).trim();if('</span><span class="s3">\&quot;</span><span class="s1">'==c[0]){c=c.slice(1,-1)}if(undefined==t[v]){t[v]=tryDecode(c,s)}}return t}function serialize(e,r,i){var a=i||{};var o=a.encode||t;if(typeof o!==</span><span class="s3">\&quot;</span><span class="s1">function</span><span class="s3">\&quot;</span><span class="s1">){throw new TypeError(</span><span class="s3">\&quot;</span><span class="s1">option encode is invalid</span><span class="s3">\&quot;</span><span class="s1">)}if(!n.test(e)){throw new TypeError(</span><span class="s3">\&quot;</span><span class="s1">argument name is invalid</span><span class="s3">\&quot;</span><span class="s1">)}var s=o(r);if(s&amp;&amp;!n.test(s)){throw new TypeError(</span><span class="s3">\&quot;</span><span class="s1">argument val is invalid</span><span class="s3">\&quot;</span><span class="s1">)}var p=e+</span><span class="s3">\&quot;</span><span class="s1">=</span><span class="s3">\&quot;</span><span class="s1">+s;if(null!=a.maxAge){var f=a.maxAge-0;if(isNaN(f)||!isFinite(f)){throw new TypeError(</span><span class="s3">\&quot;</span><span class="s1">option maxAge is invalid</span><span class="s3">\&quot;</span><span class="s1">)}p+=</span><span class="s3">\&quot;</span><span class="s1">; Max-Age=</span><span class="s3">\&quot;</span><span class="s1">+Math.floor(f)}if(a.domain){if(!n.test(a.domain)){throw new TypeError(</span><span class="s3">\&quot;</span><span class="s1">option domain is invalid</span><span class="s3">\&quot;</span><span class="s1">)}p+=</span><span class="s3">\&quot;</span><span class="s1">; Domain=</span><span class="s3">\&quot;</span><span class="s1">+a.domain}if(a.path){if(!n.test(a.path)){throw new TypeError(</span><span class="s3">\&quot;</span><span class="s1">option path is invalid</span><span class="s3">\&quot;</span><span class="s1">)}p+=</span><span class="s3">\&quot;</span><span class="s1">; Path=</span><span class="s3">\&quot;</span><span class="s1">+a.path}if(a.expires){if(typeof a.expires.toUTCString!==</span><span class="s3">\&quot;</span><span class="s1">function</span><span class="s3">\&quot;</span><span class="s1">){throw new TypeError(</span><span class="s3">\&quot;</span><span class="s1">option expires is invalid</span><span class="s3">\&quot;</span><span class="s1">)}p+=</span><span class="s3">\&quot;</span><span class="s1">; Expires=</span><span class="s3">\&quot;</span><span class="s1">+a.expires.toUTCString()}if(a.httpOnly){p+=</span><span class="s3">\&quot;</span><span class="s1">; HttpOnly</span><span class="s3">\&quot;</span><span class="s1">}if(a.secure){p+=</span><span class="s3">\&quot;</span><span class="s1">; Secure</span><span class="s3">\&quot;</span><span class="s1">}if(a.sameSite){var u=typeof a.sameSite===</span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">?a.sameSite.toLowerCase():a.sameSite;switch(u){case true:p+=</span><span class="s3">\&quot;</span><span class="s1">; SameSite=Strict</span><span class="s3">\&quot;</span><span class="s1">;break;case</span><span class="s3">\&quot;</span><span class="s1">lax</span><span class="s3">\&quot;</span><span class="s1">:p+=</span><span class="s3">\&quot;</span><span class="s1">; SameSite=Lax</span><span class="s3">\&quot;</span><span class="s1">;break;case</span><span class="s3">\&quot;</span><span class="s1">strict</span><span class="s3">\&quot;</span><span class="s1">:p+=</span><span class="s3">\&quot;</span><span class="s1">; SameSite=Strict</span><span class="s3">\&quot;</span><span class="s1">;break;case</span><span class="s3">\&quot;</span><span class="s1">none</span><span class="s3">\&quot;</span><span class="s1">:p+=</span><span class="s3">\&quot;</span><span class="s1">; SameSite=None</span><span class="s3">\&quot;</span><span class="s1">;break;default:throw new TypeError(</span><span class="s3">\&quot;</span><span class="s1">option sameSite is invalid</span><span class="s3">\&quot;</span><span class="s1">)}}return p}function tryDecode(e,r){try{return r(e)}catch(r){return e}}})();module.exports=e})();&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7487</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/api-utils/index.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { IncomingMessage } from 'http'</span><span class="s3">\n</span><span class="s1">import type { BaseNextRequest } from '../base-http'</span><span class="s3">\n</span><span class="s1">import type { CookieSerializeOptions } from 'next/dist/compiled/cookie'</span><span class="s3">\n</span><span class="s1">import type { NextApiResponse } from '../../shared/lib/utils'</span><span class="s3">\n\n</span><span class="s1">import { HeadersAdapter } from '../web/spec-extension/adapters/headers'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">PRERENDER_REVALIDATE_HEADER,</span><span class="s3">\n  </span><span class="s1">PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER,</span><span class="s3">\n</span><span class="s1">} from '../../lib/constants'</span><span class="s3">\n</span><span class="s1">import { getTracer } from '../lib/trace/tracer'</span><span class="s3">\n</span><span class="s1">import { NodeSpan } from '../lib/trace/constants'</span><span class="s3">\n\n</span><span class="s1">export type NextApiRequestCookies = Partial&lt;{ [key: string]: string }&gt;</span><span class="s3">\n</span><span class="s1">export type NextApiRequestQuery = Partial&lt;{ [key: string]: string | string[] }&gt;</span><span class="s3">\n\n</span><span class="s1">export type __ApiPreviewProps = {</span><span class="s3">\n  </span><span class="s1">previewModeId: string</span><span class="s3">\n  </span><span class="s1">previewModeEncryptionKey: string</span><span class="s3">\n  </span><span class="s1">previewModeSigningKey: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function wrapApiHandler&lt;T extends (...args: any[]) =&gt; any&gt;(</span><span class="s3">\n  </span><span class="s1">page: string,</span><span class="s3">\n  </span><span class="s1">handler: T</span><span class="s3">\n</span><span class="s1">): T {</span><span class="s3">\n  </span><span class="s1">return ((...args) =&gt; {</span><span class="s3">\n    </span><span class="s1">getTracer().setRootSpanAttribute('next.route', page)</span><span class="s3">\n    </span><span class="s1">// Call API route method</span><span class="s3">\n    </span><span class="s1">return getTracer().trace(</span><span class="s3">\n      </span><span class="s1">NodeSpan.runHandler,</span><span class="s3">\n      </span><span class="s1">{</span><span class="s3">\n        </span><span class="s1">spanName: `executing api route (pages) ${page}`,</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">() =&gt; handler(...args)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}) as T</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param res response object</span><span class="s3">\n </span><span class="s1">* @param statusCode `HTTP` status code of response</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function sendStatusCode(</span><span class="s3">\n  </span><span class="s1">res: NextApiResponse,</span><span class="s3">\n  </span><span class="s1">statusCode: number</span><span class="s3">\n</span><span class="s1">): NextApiResponse&lt;any&gt; {</span><span class="s3">\n  </span><span class="s1">res.statusCode = statusCode</span><span class="s3">\n  </span><span class="s1">return res</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param res response object</span><span class="s3">\n </span><span class="s1">* @param [statusOrUrl] `HTTP` status code of redirect</span><span class="s3">\n </span><span class="s1">* @param url URL of redirect</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function redirect(</span><span class="s3">\n  </span><span class="s1">res: NextApiResponse,</span><span class="s3">\n  </span><span class="s1">statusOrUrl: string | number,</span><span class="s3">\n  </span><span class="s1">url?: string</span><span class="s3">\n</span><span class="s1">): NextApiResponse&lt;any&gt; {</span><span class="s3">\n  </span><span class="s1">if (typeof statusOrUrl === 'string') {</span><span class="s3">\n    </span><span class="s1">url = statusOrUrl</span><span class="s3">\n    </span><span class="s1">statusOrUrl = 307</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (typeof statusOrUrl !== 'number' || typeof url !== 'string') {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Invalid redirect arguments. Please use a single argument URL, e.g. res.redirect('/destination') or use a status code and URL, e.g. res.redirect(307, '/destination').`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">res.writeHead(statusOrUrl, { Location: url })</span><span class="s3">\n  </span><span class="s1">res.write(url)</span><span class="s3">\n  </span><span class="s1">res.end()</span><span class="s3">\n  </span><span class="s1">return res</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function checkIsOnDemandRevalidate(</span><span class="s3">\n  </span><span class="s1">req: Request | IncomingMessage | BaseNextRequest,</span><span class="s3">\n  </span><span class="s1">previewProps: __ApiPreviewProps</span><span class="s3">\n</span><span class="s1">): {</span><span class="s3">\n  </span><span class="s1">isOnDemandRevalidate: boolean</span><span class="s3">\n  </span><span class="s1">revalidateOnlyGenerated: boolean</span><span class="s3">\n</span><span class="s1">} {</span><span class="s3">\n  </span><span class="s1">const headers = HeadersAdapter.from(req.headers)</span><span class="s3">\n\n  </span><span class="s1">const previewModeId = headers.get(PRERENDER_REVALIDATE_HEADER)</span><span class="s3">\n  </span><span class="s1">const isOnDemandRevalidate = previewModeId === previewProps.previewModeId</span><span class="s3">\n\n  </span><span class="s1">const revalidateOnlyGenerated = headers.has(</span><span class="s3">\n    </span><span class="s1">PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">return { isOnDemandRevalidate, revalidateOnlyGenerated }</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const COOKIE_NAME_PRERENDER_BYPASS = `__prerender_bypass`</span><span class="s3">\n</span><span class="s1">export const COOKIE_NAME_PRERENDER_DATA = `__next_preview_data`</span><span class="s3">\n\n</span><span class="s1">export const RESPONSE_LIMIT_DEFAULT = 4 * 1024 * 1024</span><span class="s3">\n\n</span><span class="s1">export const SYMBOL_PREVIEW_DATA = Symbol(COOKIE_NAME_PRERENDER_DATA)</span><span class="s3">\n</span><span class="s1">export const SYMBOL_CLEARED_COOKIES = Symbol(COOKIE_NAME_PRERENDER_BYPASS)</span><span class="s3">\n\n</span><span class="s1">export function clearPreviewData&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">res: NextApiResponse&lt;T&gt;,</span><span class="s3">\n  </span><span class="s1">options: {</span><span class="s3">\n    </span><span class="s1">path?: string</span><span class="s3">\n  </span><span class="s1">} = {}</span><span class="s3">\n</span><span class="s1">): NextApiResponse&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">if (SYMBOL_CLEARED_COOKIES in res) {</span><span class="s3">\n    </span><span class="s1">return res</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { serialize } =</span><span class="s3">\n    </span><span class="s1">require('next/dist/compiled/cookie') as typeof import('next/dist/compiled/cookie')</span><span class="s3">\n  </span><span class="s1">const previous = res.getHeader('Set-Cookie')</span><span class="s3">\n  </span><span class="s1">res.setHeader(`Set-Cookie`, [</span><span class="s3">\n    </span><span class="s1">...(typeof previous === 'string'</span><span class="s3">\n      </span><span class="s1">? [previous]</span><span class="s3">\n      </span><span class="s1">: Array.isArray(previous)</span><span class="s3">\n        </span><span class="s1">? previous</span><span class="s3">\n        </span><span class="s1">: []),</span><span class="s3">\n    </span><span class="s1">serialize(COOKIE_NAME_PRERENDER_BYPASS, '', {</span><span class="s3">\n      </span><span class="s1">// To delete a cookie, set `expires` to a date in the past:</span><span class="s3">\n      </span><span class="s1">// https://tools.ietf.org/html/rfc6265#section-4.1.1</span><span class="s3">\n      </span><span class="s1">// `Max-Age: 0` is not valid, thus ignored, and the cookie is persisted.</span><span class="s3">\n      </span><span class="s1">expires: new Date(0),</span><span class="s3">\n      </span><span class="s1">httpOnly: true,</span><span class="s3">\n      </span><span class="s1">sameSite: process.env.NODE_ENV !== 'development' ? 'none' : 'lax',</span><span class="s3">\n      </span><span class="s1">secure: process.env.NODE_ENV !== 'development',</span><span class="s3">\n      </span><span class="s1">path: '/',</span><span class="s3">\n      </span><span class="s1">...(options.path !== undefined</span><span class="s3">\n        </span><span class="s1">? ({ path: options.path } as CookieSerializeOptions)</span><span class="s3">\n        </span><span class="s1">: undefined),</span><span class="s3">\n    </span><span class="s1">}),</span><span class="s3">\n    </span><span class="s1">serialize(COOKIE_NAME_PRERENDER_DATA, '', {</span><span class="s3">\n      </span><span class="s1">// To delete a cookie, set `expires` to a date in the past:</span><span class="s3">\n      </span><span class="s1">// https://tools.ietf.org/html/rfc6265#section-4.1.1</span><span class="s3">\n      </span><span class="s1">// `Max-Age: 0` is not valid, thus ignored, and the cookie is persisted.</span><span class="s3">\n      </span><span class="s1">expires: new Date(0),</span><span class="s3">\n      </span><span class="s1">httpOnly: true,</span><span class="s3">\n      </span><span class="s1">sameSite: process.env.NODE_ENV !== 'development' ? 'none' : 'lax',</span><span class="s3">\n      </span><span class="s1">secure: process.env.NODE_ENV !== 'development',</span><span class="s3">\n      </span><span class="s1">path: '/',</span><span class="s3">\n      </span><span class="s1">...(options.path !== undefined</span><span class="s3">\n        </span><span class="s1">? ({ path: options.path } as CookieSerializeOptions)</span><span class="s3">\n        </span><span class="s1">: undefined),</span><span class="s3">\n    </span><span class="s1">}),</span><span class="s3">\n  </span><span class="s1">])</span><span class="s3">\n\n  </span><span class="s1">Object.defineProperty(res, SYMBOL_CLEARED_COOKIES, {</span><span class="s3">\n    </span><span class="s1">value: true,</span><span class="s3">\n    </span><span class="s1">enumerable: false,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">return res</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Custom error class</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class ApiError extends Error {</span><span class="s3">\n  </span><span class="s1">readonly statusCode: number</span><span class="s3">\n\n  </span><span class="s1">constructor(statusCode: number, message: string) {</span><span class="s3">\n    </span><span class="s1">super(message)</span><span class="s3">\n    </span><span class="s1">this.statusCode = statusCode</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Sends error in `response`</span><span class="s3">\n </span><span class="s1">* @param res response object</span><span class="s3">\n </span><span class="s1">* @param statusCode of response</span><span class="s3">\n </span><span class="s1">* @param message of response</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function sendError(</span><span class="s3">\n  </span><span class="s1">res: NextApiResponse,</span><span class="s3">\n  </span><span class="s1">statusCode: number,</span><span class="s3">\n  </span><span class="s1">message: string</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">res.statusCode = statusCode</span><span class="s3">\n  </span><span class="s1">res.statusMessage = message</span><span class="s3">\n  </span><span class="s1">res.end(message)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface LazyProps {</span><span class="s3">\n  </span><span class="s1">req: IncomingMessage</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Execute getter function only if its needed</span><span class="s3">\n </span><span class="s1">* @param LazyProps `req` and `params` for lazyProp</span><span class="s3">\n </span><span class="s1">* @param prop name of property</span><span class="s3">\n </span><span class="s1">* @param getter function to get data</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function setLazyProp&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">{ req }: LazyProps,</span><span class="s3">\n  </span><span class="s1">prop: string,</span><span class="s3">\n  </span><span class="s1">getter: () =&gt; T</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">const opts = { configurable: true, enumerable: true }</span><span class="s3">\n  </span><span class="s1">const optsReset = { ...opts, writable: true }</span><span class="s3">\n\n  </span><span class="s1">Object.defineProperty(req, prop, {</span><span class="s3">\n    </span><span class="s1">...opts,</span><span class="s3">\n    </span><span class="s1">get: () =&gt; {</span><span class="s3">\n      </span><span class="s1">const value = getter()</span><span class="s3">\n      </span><span class="s1">// we set the property on the object to avoid recalculating it</span><span class="s3">\n      </span><span class="s1">Object.defineProperty(req, prop, { ...optsReset, value })</span><span class="s3">\n      </span><span class="s1">return value</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">set: (value) =&gt; {</span><span class="s3">\n      </span><span class="s1">Object.defineProperty(req, prop, { ...optsReset, value })</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;HeadersAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;PRERENDER_REVALIDATE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;getTracer&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;wrapApiHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;handler&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;setRootSpanAttribute&quot;</span><span class="s0">,</span><span class="s1">&quot;trace&quot;</span><span class="s0">,</span><span class="s1">&quot;runHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;spanName&quot;</span><span class="s0">,</span><span class="s1">&quot;sendStatusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;statusOrUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;writeHead&quot;</span><span class="s0">,</span><span class="s1">&quot;Location&quot;</span><span class="s0">,</span><span class="s1">&quot;write&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;checkIsOnDemandRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;previewProps&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;previewModeId&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;isOnDemandRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidateOnlyGenerated&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;COOKIE_NAME_PRERENDER_BYPASS&quot;</span><span class="s0">,</span><span class="s1">&quot;COOKIE_NAME_PRERENDER_DATA&quot;</span><span class="s0">,</span><span class="s1">&quot;RESPONSE_LIMIT_DEFAULT&quot;</span><span class="s0">,</span><span class="s1">&quot;SYMBOL_PREVIEW_DATA&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;SYMBOL_CLEARED_COOKIES&quot;</span><span class="s0">,</span><span class="s1">&quot;clearPreviewData&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;serialize&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;previous&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;setHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;expires&quot;</span><span class="s0">,</span><span class="s1">&quot;Date&quot;</span><span class="s0">,</span><span class="s1">&quot;httpOnly&quot;</span><span class="s0">,</span><span class="s1">&quot;sameSite&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;secure&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;defineProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;enumerable&quot;</span><span class="s0">,</span><span class="s1">&quot;ApiError&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;sendError&quot;</span><span class="s0">,</span><span class="s1">&quot;statusMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;setLazyProp&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;getter&quot;</span><span class="s0">,</span><span class="s1">&quot;opts&quot;</span><span class="s0">,</span><span class="s1">&quot;configurable&quot;</span><span class="s0">,</span><span class="s1">&quot;optsReset&quot;</span><span class="s0">,</span><span class="s1">&quot;writable&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7656</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/redirect-status-code.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export enum RedirectStatusCode {</span><span class="s3">\n  </span><span class="s1">SeeOther = 303,</span><span class="s3">\n  </span><span class="s1">TemporaryRedirect = 307,</span><span class="s3">\n  </span><span class="s1">PermanentRedirect = 308,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RedirectStatusCode&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,IAAKA,qBAAAA,WAAAA,GAAAA,SAAAA,kBAAAA;;;;WAAAA;MAIX&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7670</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/api-utils/get-cookie-parser.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { NextApiRequestCookies } from '.'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Parse cookies from the `headers` of request</span><span class="s3">\n </span><span class="s1">* @param req request object</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">export function getCookieParser(headers: {</span><span class="s3">\n  </span><span class="s1">[key: string]: string | string[] | null | undefined</span><span class="s3">\n</span><span class="s1">}): () =&gt; NextApiRequestCookies {</span><span class="s3">\n  </span><span class="s1">return function parseCookie(): NextApiRequestCookies {</span><span class="s3">\n    </span><span class="s1">const { cookie } = headers</span><span class="s3">\n\n    </span><span class="s1">if (!cookie) {</span><span class="s3">\n      </span><span class="s1">return {}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const { parse: parseCookieFn } =</span><span class="s3">\n      </span><span class="s1">require('next/dist/compiled/cookie') as typeof import('next/dist/compiled/cookie')</span><span class="s3">\n    </span><span class="s1">return parseCookieFn(Array.isArray(cookie) ? cookie.join('; ') : cookie)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getCookieParser&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;parseCookie&quot;</span><span class="s0">,</span><span class="s1">&quot;cookie&quot;</span><span class="s0">,</span><span class="s1">&quot;parse&quot;</span><span class="s0">,</span><span class="s1">&quot;parseCookieFn&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAEA;;;CAGC,GAED;;;;AAAO,SAASA,gBAAgBC,OAE/B;IACC,OAAO,SAASC;QACd,MAAM,EAAEC,MAAM,EAAE,GAAGF;QAEnB,IAAI,CAACE,QAAQ;YACX,OAAO,CAAC;QACV;QAEA,MAAM,EAAEC,OAAOC,aAAa,EAAE,GAC5BC,QAAQ;QACV,OAAOD,cAAcE,MAAMC,OAAO,CAACL,UAAUA,OAAOM,IAAI,CAAC,QAAQN;IACnE;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7691</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/base-http/index.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { IncomingHttpHeaders, OutgoingHttpHeaders } from 'http'</span><span class="s3">\n</span><span class="s1">import type { I18NConfig } from '../config-shared'</span><span class="s3">\n\n</span><span class="s1">import { RedirectStatusCode } from '../../client/components/redirect-status-code'</span><span class="s3">\n</span><span class="s1">import type { NextApiRequestCookies } from '../api-utils'</span><span class="s3">\n</span><span class="s1">import { getCookieParser } from '../api-utils/get-cookie-parser'</span><span class="s3">\n\n</span><span class="s1">export interface BaseNextRequestConfig {</span><span class="s3">\n  </span><span class="s1">basePath: string | undefined</span><span class="s3">\n  </span><span class="s1">i18n?: I18NConfig</span><span class="s3">\n  </span><span class="s1">trailingSlash?: boolean | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type FetchMetric = {</span><span class="s3">\n  </span><span class="s1">url: string</span><span class="s3">\n  </span><span class="s1">idx: number</span><span class="s3">\n  </span><span class="s1">end: number</span><span class="s3">\n  </span><span class="s1">start: number</span><span class="s3">\n  </span><span class="s1">method: string</span><span class="s3">\n  </span><span class="s1">status: number</span><span class="s3">\n  </span><span class="s1">cacheReason: string</span><span class="s3">\n  </span><span class="s1">cacheStatus: 'hit' | 'miss' | 'skip' | 'hmr'</span><span class="s3">\n  </span><span class="s1">cacheWarning?: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type FetchMetrics = Array&lt;FetchMetric&gt;</span><span class="s3">\n\n</span><span class="s1">export abstract class BaseNextRequest&lt;Body = any&gt; {</span><span class="s3">\n  </span><span class="s1">protected _cookies: NextApiRequestCookies | undefined</span><span class="s3">\n  </span><span class="s1">public abstract headers: IncomingHttpHeaders</span><span class="s3">\n  </span><span class="s1">public abstract fetchMetrics: FetchMetric[] | undefined</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">public method: string,</span><span class="s3">\n    </span><span class="s1">public url: string,</span><span class="s3">\n    </span><span class="s1">public body: Body</span><span class="s3">\n  </span><span class="s1">) {}</span><span class="s3">\n\n  </span><span class="s1">// Utils implemented using the abstract methods above</span><span class="s3">\n\n  </span><span class="s1">public get cookies() {</span><span class="s3">\n    </span><span class="s1">if (this._cookies) return this._cookies</span><span class="s3">\n    </span><span class="s1">return (this._cookies = getCookieParser(this.headers)())</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export abstract class BaseNextResponse&lt;Destination = any&gt; {</span><span class="s3">\n  </span><span class="s1">abstract statusCode: number | undefined</span><span class="s3">\n  </span><span class="s1">abstract statusMessage: string | undefined</span><span class="s3">\n  </span><span class="s1">abstract get sent(): boolean</span><span class="s3">\n\n  </span><span class="s1">constructor(public destination: Destination) {}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Sets a value for the header overwriting existing values</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">abstract setHeader(name: string, value: string | string[]): this</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Removes a header</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">abstract removeHeader(name: string): this</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Appends value for the given header name</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">abstract appendHeader(name: string, value: string): this</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Get all values for a header as an array or undefined if no value is present</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">abstract getHeaderValues(name: string): string[] | undefined</span><span class="s3">\n\n  </span><span class="s1">abstract hasHeader(name: string): boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Get values for a header concatenated using `,` or undefined if no value is present</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">abstract getHeader(name: string): string | undefined</span><span class="s3">\n\n  </span><span class="s1">abstract getHeaders(): OutgoingHttpHeaders</span><span class="s3">\n\n  </span><span class="s1">abstract body(value: string): this</span><span class="s3">\n\n  </span><span class="s1">abstract send(): void</span><span class="s3">\n\n  </span><span class="s1">abstract onClose(callback: () =&gt; void): void</span><span class="s3">\n\n  </span><span class="s1">// Utils implemented using the abstract methods above</span><span class="s3">\n\n  </span><span class="s1">public redirect(destination: string, statusCode: number) {</span><span class="s3">\n    </span><span class="s1">this.setHeader('Location', destination)</span><span class="s3">\n    </span><span class="s1">this.statusCode = statusCode</span><span class="s3">\n\n    </span><span class="s1">// Since IE11 doesn't support the 308 header add backwards</span><span class="s3">\n    </span><span class="s1">// compatibility using refresh header</span><span class="s3">\n    </span><span class="s1">if (statusCode === RedirectStatusCode.PermanentRedirect) {</span><span class="s3">\n      </span><span class="s1">this.setHeader('Refresh', `0;url=${destination}`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return this</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RedirectStatusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;getCookieParser&quot;</span><span class="s0">,</span><span class="s1">&quot;BaseNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;cookies&quot;</span><span class="s0">,</span><span class="s1">&quot;_cookies&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;BaseNextResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;destination&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;setHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;PermanentRedirect&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAGA,SAASA,kBAAkB,QAAQ,+CAA8C;AAEjF,SAASC,eAAe,QAAQ,iCAAgC;;;AAsBzD,MAAeC;IAKpBC,YACSC,MAAc,EACdC,GAAW,EACXC,IAAU,CACjB;aAHOF,MAAAA,GAAAA;aACAC,GAAAA,GAAAA;aACAC,IAAAA,GAAAA;IACN;IAEH,qDAAqD;IAErD,IAAWC,UAAU;QACnB,IAAI,IAAI,CAACC,QAAQ,EAAE,OAAO,IAAI,CAACA,QAAQ;QACvC,OAAQ,IAAI,CAACA,QAAQ,OAAGP,6MAAAA,EAAgB,IAAI,CAACQ,OAAO;IACtD;AACF;AAEO,MAAeC;IAKpBP,YAAmBQ,WAAwB,CAAE;aAA1BA,WAAAA,GAAAA;IAA2B;IAqC9C,qDAAqD;IAE9CC,SAASD,WAAmB,EAAEE,UAAkB,EAAE;QACvD,IAAI,CAACC,SAAS,CAAC,YAAYH;QAC3B,IAAI,CAACE,UAAU,GAAGA;QAElB,0DAA0D;QAC1D,qCAAqC;QACrC,IAAIA,eAAeb,iNAAAA,CAAmBe,iBAAiB,EAAE;YACvD,IAAI,CAACD,SAAS,CAAC,WAAW,CAAC,MAAM,EAAEH,aAAa;QAClD;QAEA,OAAO,IAAI;IACb;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7733</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/base-http/node.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { ServerResponse, IncomingMessage } from 'http'</span><span class="s3">\n</span><span class="s1">import type { Writable, Readable } from 'stream'</span><span class="s3">\n\n</span><span class="s1">import { SYMBOL_CLEARED_COOKIES } from '../api-utils'</span><span class="s3">\n</span><span class="s1">import type { NextApiRequestCookies } from '../api-utils'</span><span class="s3">\n\n</span><span class="s1">import { NEXT_REQUEST_META } from '../request-meta'</span><span class="s3">\n</span><span class="s1">import type { RequestMeta } from '../request-meta'</span><span class="s3">\n\n</span><span class="s1">import { BaseNextRequest, BaseNextResponse, type FetchMetric } from './index'</span><span class="s3">\n</span><span class="s1">import type { OutgoingHttpHeaders } from 'node:http'</span><span class="s3">\n\n</span><span class="s1">type Req = IncomingMessage &amp; {</span><span class="s3">\n  </span><span class="s1">[NEXT_REQUEST_META]?: RequestMeta</span><span class="s3">\n  </span><span class="s1">cookies?: NextApiRequestCookies</span><span class="s3">\n  </span><span class="s1">fetchMetrics?: FetchMetric[]</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class NodeNextRequest extends BaseNextRequest&lt;Readable&gt; {</span><span class="s3">\n  </span><span class="s1">public headers = this._req.headers</span><span class="s3">\n  </span><span class="s1">public fetchMetrics: FetchMetric[] | undefined = this._req?.fetchMetrics;</span><span class="s3">\n\n  </span><span class="s1">[NEXT_REQUEST_META]: RequestMeta = this._req[NEXT_REQUEST_META] || {}</span><span class="s3">\n\n  </span><span class="s1">constructor(private _req: Req) {</span><span class="s3">\n    </span><span class="s1">super(_req.method!.toUpperCase(), _req.url!, _req)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get originalRequest() {</span><span class="s3">\n    </span><span class="s1">// Need to mimic these changes to the original req object for places where we use it:</span><span class="s3">\n    </span><span class="s1">// render.tsx, api/ssg requests</span><span class="s3">\n    </span><span class="s1">this._req[NEXT_REQUEST_META] = this[NEXT_REQUEST_META]</span><span class="s3">\n    </span><span class="s1">this._req.url = this.url</span><span class="s3">\n    </span><span class="s1">this._req.cookies = this.cookies</span><span class="s3">\n    </span><span class="s1">return this._req</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set originalRequest(value: Req) {</span><span class="s3">\n    </span><span class="s1">this._req = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private streaming = false</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns the request body as a Web Readable Stream. The body here can only</span><span class="s3">\n   </span><span class="s1">* be read once as the body will start flowing as soon as the data handler</span><span class="s3">\n   </span><span class="s1">* is attached.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @internal</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public stream() {</span><span class="s3">\n    </span><span class="s1">if (this.streaming) {</span><span class="s3">\n      </span><span class="s1">throw new Error(</span><span class="s3">\n        </span><span class="s1">'Invariant: NodeNextRequest.stream() can only be called once'</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">this.streaming = true</span><span class="s3">\n\n    </span><span class="s1">return new ReadableStream({</span><span class="s3">\n      </span><span class="s1">start: (controller) =&gt; {</span><span class="s3">\n        </span><span class="s1">this._req.on('data', (chunk) =&gt; {</span><span class="s3">\n          </span><span class="s1">controller.enqueue(new Uint8Array(chunk))</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">this._req.on('end', () =&gt; {</span><span class="s3">\n          </span><span class="s1">controller.close()</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">this._req.on('error', (err) =&gt; {</span><span class="s3">\n          </span><span class="s1">controller.error(err)</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class NodeNextResponse extends BaseNextResponse&lt;Writable&gt; {</span><span class="s3">\n  </span><span class="s1">private textBody: string | undefined = undefined</span><span class="s3">\n\n  </span><span class="s1">public [SYMBOL_CLEARED_COOKIES]?: boolean</span><span class="s3">\n\n  </span><span class="s1">get originalResponse() {</span><span class="s3">\n    </span><span class="s1">if (SYMBOL_CLEARED_COOKIES in this) {</span><span class="s3">\n      </span><span class="s1">this._res[SYMBOL_CLEARED_COOKIES] = this[SYMBOL_CLEARED_COOKIES]</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return this._res</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">private _res: ServerResponse &amp; { [SYMBOL_CLEARED_COOKIES]?: boolean }</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">super(_res)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get sent() {</span><span class="s3">\n    </span><span class="s1">return this._res.finished || this._res.headersSent</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get statusCode() {</span><span class="s3">\n    </span><span class="s1">return this._res.statusCode</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set statusCode(value: number) {</span><span class="s3">\n    </span><span class="s1">this._res.statusCode = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get statusMessage() {</span><span class="s3">\n    </span><span class="s1">return this._res.statusMessage</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set statusMessage(value: string) {</span><span class="s3">\n    </span><span class="s1">this._res.statusMessage = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">setHeader(name: string, value: string | string[]): this {</span><span class="s3">\n    </span><span class="s1">this._res.setHeader(name, value)</span><span class="s3">\n    </span><span class="s1">return this</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">removeHeader(name: string): this {</span><span class="s3">\n    </span><span class="s1">this._res.removeHeader(name)</span><span class="s3">\n    </span><span class="s1">return this</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">getHeaderValues(name: string): string[] | undefined {</span><span class="s3">\n    </span><span class="s1">const values = this._res.getHeader(name)</span><span class="s3">\n\n    </span><span class="s1">if (values === undefined) return undefined</span><span class="s3">\n\n    </span><span class="s1">return (Array.isArray(values) ? values : [values]).map((value) =&gt;</span><span class="s3">\n      </span><span class="s1">value.toString()</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">hasHeader(name: string): boolean {</span><span class="s3">\n    </span><span class="s1">return this._res.hasHeader(name)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">getHeader(name: string): string | undefined {</span><span class="s3">\n    </span><span class="s1">const values = this.getHeaderValues(name)</span><span class="s3">\n    </span><span class="s1">return Array.isArray(values) ? values.join(',') : undefined</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">getHeaders(): OutgoingHttpHeaders {</span><span class="s3">\n    </span><span class="s1">return this._res.getHeaders()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">appendHeader(name: string, value: string): this {</span><span class="s3">\n    </span><span class="s1">const currentValues = this.getHeaderValues(name) ?? []</span><span class="s3">\n\n    </span><span class="s1">if (!currentValues.includes(value)) {</span><span class="s3">\n      </span><span class="s1">this._res.setHeader(name, [...currentValues, value])</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return this</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">body(value: string) {</span><span class="s3">\n    </span><span class="s1">this.textBody = value</span><span class="s3">\n    </span><span class="s1">return this</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">send() {</span><span class="s3">\n    </span><span class="s1">this._res.end(this.textBody)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public onClose(callback: () =&gt; void) {</span><span class="s3">\n    </span><span class="s1">this.originalResponse.on('close', callback)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;SYMBOL_CLEARED_COOKIES&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_REQUEST_META&quot;</span><span class="s0">,</span><span class="s1">&quot;BaseNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;BaseNextResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;_req&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;toUpperCase&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchMetrics&quot;</span><span class="s0">,</span><span class="s1">&quot;streaming&quot;</span><span class="s0">,</span><span class="s1">&quot;originalRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;cookies&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;stream&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;ReadableStream&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;controller&quot;</span><span class="s0">,</span><span class="s1">&quot;on&quot;</span><span class="s0">,</span><span class="s1">&quot;chunk&quot;</span><span class="s0">,</span><span class="s1">&quot;enqueue&quot;</span><span class="s0">,</span><span class="s1">&quot;Uint8Array&quot;</span><span class="s0">,</span><span class="s1">&quot;close&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeNextResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;originalResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;_res&quot;</span><span class="s0">,</span><span class="s1">&quot;textBody&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;sent&quot;</span><span class="s0">,</span><span class="s1">&quot;finished&quot;</span><span class="s0">,</span><span class="s1">&quot;headersSent&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;statusMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;setHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;removeHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeaderValues&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;hasHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;appendHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;currentValues&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;send&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;onClose&quot;</span><span class="s0">,</span><span class="s1">&quot;callback&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7869</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/instrumentation/utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export function getRevalidateReason(params: {</span><span class="s3">\n  </span><span class="s1">isOnDemandRevalidate?: boolean</span><span class="s3">\n  </span><span class="s1">isRevalidate?: boolean</span><span class="s3">\n</span><span class="s1">}): 'on-demand' | 'stale' | undefined {</span><span class="s3">\n  </span><span class="s1">if (params.isOnDemandRevalidate) {</span><span class="s3">\n    </span><span class="s1">return 'on-demand'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (params.isRevalidate) {</span><span class="s3">\n    </span><span class="s1">return 'stale'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getRevalidateReason&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;isOnDemandRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;isRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,SAASA,oBAAoBC,MAGnC;IACC,IAAIA,OAAOC,oBAAoB,EAAE;QAC/B,OAAO;IACT;IACA,IAAID,OAAOE,YAAY,EAAE;QACvB,OAAO;IACT;IACA,OAAOC;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7886</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/send-response.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { BaseNextRequest, BaseNextResponse } from './base-http'</span><span class="s3">\n</span><span class="s1">import { isNodeNextResponse } from './base-http/helpers'</span><span class="s3">\n\n</span><span class="s1">import { pipeToNodeResponse } from './pipe-readable'</span><span class="s3">\n</span><span class="s1">import { splitCookiesString } from './web/utils'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Sends the response on the underlying next response object.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param req the underlying request object</span><span class="s3">\n </span><span class="s1">* @param res the underlying response object</span><span class="s3">\n </span><span class="s1">* @param response the response to send</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export async function sendResponse(</span><span class="s3">\n  </span><span class="s1">req: BaseNextRequest,</span><span class="s3">\n  </span><span class="s1">res: BaseNextResponse,</span><span class="s3">\n  </span><span class="s1">response: Response,</span><span class="s3">\n  </span><span class="s1">waitUntil?: Promise&lt;unknown&gt;</span><span class="s3">\n</span><span class="s1">): Promise&lt;void&gt; {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">// The type check here ensures that `req` is correctly typed, and the</span><span class="s3">\n    </span><span class="s1">// environment variable check provides dead code elimination.</span><span class="s3">\n    </span><span class="s1">process.env.NEXT_RUNTIME !== 'edge' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">isNodeNextResponse(res)</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">// Copy over the response status.</span><span class="s3">\n    </span><span class="s1">res.statusCode = response.status</span><span class="s3">\n    </span><span class="s1">res.statusMessage = response.statusText</span><span class="s3">\n\n    </span><span class="s1">// TODO: this is not spec-compliant behavior and we should not restrict</span><span class="s3">\n    </span><span class="s1">// headers that are allowed to appear many times.</span><span class="s3">\n    </span><span class="s1">//</span><span class="s3">\n    </span><span class="s1">// See:</span><span class="s3">\n    </span><span class="s1">// https://github.com/vercel/next.js/pull/70127</span><span class="s3">\n    </span><span class="s1">const headersWithMultipleValuesAllowed = [</span><span class="s3">\n      </span><span class="s1">// can add more headers to this list if needed</span><span class="s3">\n      </span><span class="s1">'set-cookie',</span><span class="s3">\n      </span><span class="s1">'www-authenticate',</span><span class="s3">\n      </span><span class="s1">'proxy-authenticate',</span><span class="s3">\n      </span><span class="s1">'vary',</span><span class="s3">\n    </span><span class="s1">]</span><span class="s3">\n\n    </span><span class="s1">// Copy over the response headers.</span><span class="s3">\n    </span><span class="s1">response.headers?.forEach((value, name) =&gt; {</span><span class="s3">\n      </span><span class="s1">// `x-middleware-set-cookie` is an internal header not needed for the response</span><span class="s3">\n      </span><span class="s1">if (name.toLowerCase() === 'x-middleware-set-cookie') {</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// The append handling is special cased for `set-cookie`.</span><span class="s3">\n      </span><span class="s1">if (name.toLowerCase() === 'set-cookie') {</span><span class="s3">\n        </span><span class="s1">// TODO: (wyattjoh) replace with native response iteration when we can upgrade undici</span><span class="s3">\n        </span><span class="s1">for (const cookie of splitCookiesString(value)) {</span><span class="s3">\n          </span><span class="s1">res.appendHeader(name, cookie)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">// only append the header if it is either not present in the outbound response</span><span class="s3">\n        </span><span class="s1">// or if the header supports multiple values</span><span class="s3">\n        </span><span class="s1">const isHeaderPresent = typeof res.getHeader(name) !== 'undefined'</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">headersWithMultipleValuesAllowed.includes(name.toLowerCase()) ||</span><span class="s3">\n          </span><span class="s1">!isHeaderPresent</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">res.appendHeader(name, value)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* The response can't be directly piped to the underlying response. The</span><span class="s3">\n     </span><span class="s1">* following is duplicated from the edge runtime handler.</span><span class="s3">\n     </span><span class="s1">*</span><span class="s3">\n     </span><span class="s1">* See packages/next/server/next-server.ts</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n\n    </span><span class="s1">const { originalResponse } = res</span><span class="s3">\n\n    </span><span class="s1">// A response body must not be sent for HEAD requests. See https://httpwg.org/specs/rfc9110.html#HEAD</span><span class="s3">\n    </span><span class="s1">if (response.body &amp;&amp; req.method !== 'HEAD') {</span><span class="s3">\n      </span><span class="s1">await pipeToNodeResponse(response.body, originalResponse, waitUntil)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">originalResponse.end()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isNodeNextResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;pipeToNodeResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;splitCookiesString&quot;</span><span class="s0">,</span><span class="s1">&quot;sendResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;waitUntil&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;statusMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;statusText&quot;</span><span class="s0">,</span><span class="s1">&quot;headersWithMultipleValuesAllowed&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;cookie&quot;</span><span class="s0">,</span><span class="s1">&quot;appendHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;isHeaderPresent&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;originalResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AACA,SAASA,kBAAkB,QAAQ,sBAAqB;AAExD,SAASC,kBAAkB,QAAQ,kBAAiB;AACpD,SAASC,kBAAkB,QAAQ,cAAa;;;;AASzC,eAAeC,aACpBC,GAAoB,EACpBC,GAAqB,EACrBC,QAAkB,EAClBC,SAA4B;IAE5B,IACE,AACA,6DAA6D,QADQ;IAErEC,QAAQC,GAAG,CAACC,YAAY,uBAAK,cAC7BV,gMAAAA,EAAmBK,MACnB;YAkBA,AACAC,kCADkC;QAjBlC,iCAAiC;QACjCD,IAAIM,UAAU,GAAGL,SAASM,MAAM;QAChCP,IAAIQ,aAAa,GAAGP,SAASQ,UAAU;QAEvC,uEAAuE;QACvE,iDAAiD;QACjD,EAAE;QACF,OAAO;QACP,+CAA+C;QAC/C,MAAMC,mCAAmC;YACvC,8CAA8C;YAC9C;YACA;YACA;YACA;SACD;SAGDT,oBAAAA,SAASU,OAAO,KAAA,OAAA,KAAA,IAAhBV,kBAAkBW,OAAO,CAAC,CAACC,OAAOC;YAChC,8EAA8E;YAC9E,IAAIA,KAAKC,WAAW,OAAO,2BAA2B;gBACpD;YACF;YAEA,yDAAyD;YACzD,IAAID,KAAKC,WAAW,OAAO,cAAc;gBACvC,qFAAqF;gBACrF,KAAK,MAAMC,cAAUnB,qLAAAA,EAAmBgB,OAAQ;oBAC9Cb,IAAIiB,YAAY,CAACH,MAAME;gBACzB;YACF,OAAO;gBACL,8EAA8E;gBAC9E,4CAA4C;gBAC5C,MAAME,kBAAkB,OAAOlB,IAAImB,SAAS,CAACL,UAAU;gBACvD,IACEJ,iCAAiCU,QAAQ,CAACN,KAAKC,WAAW,OAC1D,CAACG,iBACD;oBACAlB,IAAIiB,YAAY,CAACH,MAAMD;gBACzB;YACF;QACF;QAEA;;;;;KAKC,GAED,MAAM,EAAEQ,gBAAgB,EAAE,GAAGrB;QAE7B,qGAAqG;QACrG,IAAIC,SAASqB,IAAI,IAAIvB,IAAIwB,MAAM,KAAK,QAAQ;YAC1C,UAAM3B,yLAAAA,EAAmBK,SAASqB,IAAI,EAAED,kBAAkBnB;QAC5D,OAAO;YACLmB,iBAAiBG,GAAG;QACtB;IACF;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7953</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/cache-control.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { CACHE_ONE_YEAR } from '../../lib/constants'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* The revalidate option used internally for pages. A value of `false` means</span><span class="s3">\n </span><span class="s1">* that the page should not be revalidated. A number means that the page</span><span class="s3">\n </span><span class="s1">* should be revalidated after the given number of seconds (this also includes</span><span class="s3">\n </span><span class="s1">* `1` which means to revalidate after 1 second). A value of `0` is not a valid</span><span class="s3">\n </span><span class="s1">* value for this option.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export type Revalidate = number | false</span><span class="s3">\n\n</span><span class="s1">export interface CacheControl {</span><span class="s3">\n  </span><span class="s1">revalidate: Revalidate</span><span class="s3">\n  </span><span class="s1">expire: number | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getCacheControlHeader({</span><span class="s3">\n  </span><span class="s1">revalidate,</span><span class="s3">\n  </span><span class="s1">expire,</span><span class="s3">\n</span><span class="s1">}: CacheControl): string {</span><span class="s3">\n  </span><span class="s1">const swrHeader =</span><span class="s3">\n    </span><span class="s1">typeof revalidate === 'number' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">expire !== undefined &amp;&amp;</span><span class="s3">\n    </span><span class="s1">revalidate &lt; expire</span><span class="s3">\n      </span><span class="s1">? `, stale-while-revalidate=${expire - revalidate}`</span><span class="s3">\n      </span><span class="s1">: ''</span><span class="s3">\n\n  </span><span class="s1">if (revalidate === 0) {</span><span class="s3">\n    </span><span class="s1">return 'private, no-cache, no-store, max-age=0, must-revalidate'</span><span class="s3">\n  </span><span class="s1">} else if (typeof revalidate === 'number') {</span><span class="s3">\n    </span><span class="s1">return `s-maxage=${revalidate}${swrHeader}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return `s-maxage=${CACHE_ONE_YEAR}${swrHeader}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;CACHE_ONE_YEAR&quot;</span><span class="s0">,</span><span class="s1">&quot;getCacheControlHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;expire&quot;</span><span class="s0">,</span><span class="s1">&quot;swrHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,cAAc,QAAQ,sBAAqB;;AAgB7C,SAASC,sBAAsB,EACpCC,UAAU,EACVC,MAAM,EACO;IACb,MAAMC,YACJ,OAAOF,eAAe,YACtBC,WAAWE,aACXH,aAAaC,SACT,CAAC,yBAAyB,EAAEA,SAASD,YAAY,GACjD;IAEN,IAAIA,eAAe,GAAG;QACpB,OAAO;IACT,OAAO,IAAI,OAAOA,eAAe,UAAU;QACzC,OAAO,CAAC,SAAS,EAAEA,aAAaE,WAAW;IAC7C;IAEA,OAAO,CAAC,SAAS,EAAEJ,2KAAAA,GAAiBI,WAAW;AACjD&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7972</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/i18n/detect-domain-locale.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { DomainLocale } from '../../../server/config-shared'</span><span class="s3">\n\n</span><span class="s1">export function detectDomainLocale(</span><span class="s3">\n  </span><span class="s1">domainItems?: readonly DomainLocale[],</span><span class="s3">\n  </span><span class="s1">hostname?: string,</span><span class="s3">\n  </span><span class="s1">detectedLocale?: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (!domainItems) return</span><span class="s3">\n\n  </span><span class="s1">if (detectedLocale) {</span><span class="s3">\n    </span><span class="s1">detectedLocale = detectedLocale.toLowerCase()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">for (const item of domainItems) {</span><span class="s3">\n    </span><span class="s1">// remove port if present</span><span class="s3">\n    </span><span class="s1">const domainHostname = item.domain?.split(':', 1)[0].toLowerCase()</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">hostname === domainHostname ||</span><span class="s3">\n      </span><span class="s1">detectedLocale === item.defaultLocale.toLowerCase() ||</span><span class="s3">\n      </span><span class="s1">item.locales?.some((locale) =&gt; locale.toLowerCase() === detectedLocale)</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return item</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;detectDomainLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;domainItems&quot;</span><span class="s0">,</span><span class="s1">&quot;hostname&quot;</span><span class="s0">,</span><span class="s1">&quot;detectedLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;item&quot;</span><span class="s0">,</span><span class="s1">&quot;domainHostname&quot;</span><span class="s0">,</span><span class="s1">&quot;domain&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;defaultLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;locales&quot;</span><span class="s0">,</span><span class="s1">&quot;some&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAEgBA,sBAAAA;;;eAAAA;;;AAAT,SAASA,mBACdC,WAAqC,EACrCC,QAAiB,EACjBC,cAAuB;IAEvB,IAAI,CAACF,aAAa;IAElB,IAAIE,gBAAgB;QAClBA,iBAAiBA,eAAeC,WAAW;IAC7C;IAEA,KAAK,MAAMC,QAAQJ,YAAa;YAEPI,cAIrBA;QALF,yBAAyB;QACzB,MAAMC,iBAAAA,CAAiBD,eAAAA,KAAKE,MAAM,KAAA,OAAA,KAAA,IAAXF,aAAaG,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE,CAACJ,WAAW;QAChE,IACEF,aAAaI,kBACbH,mBAAmBE,KAAKI,aAAa,CAACL,WAAW,MAAA,CAAA,CACjDC,gBAAAA,KAAKK,OAAO,KAAA,OAAA,KAAA,IAAZL,cAAcM,IAAI,CAAC,CAACC,SAAWA,OAAOR,WAAW,OAAOD,eAAAA,GACxD;YACA,OAAOE;QACT;IACF;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">7999</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/router/utils/remove-trailing-slash.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Removes the trailing slash for a given route or page path. Preserves the</span><span class="s3">\n </span><span class="s1">* root page. Examples:</span><span class="s3">\n </span><span class="s1">*   - `/foo/bar/` -&gt; `/foo/bar`</span><span class="s3">\n </span><span class="s1">*   - `/foo/bar` -&gt; `/foo/bar`</span><span class="s3">\n </span><span class="s1">*   - `/` -&gt; `/`</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function removeTrailingSlash(route: string) {</span><span class="s3">\n  </span><span class="s1">return route.replace(/</span><span class="s3">\\</span><span class="s1">/$/, '') || '/'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;removeTrailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;;;;CAMC;;;+BACeA,uBAAAA;;;eAAAA;;;AAAT,SAASA,oBAAoBC,KAAa;IAC/C,OAAOA,MAAMC,OAAO,CAAC,OAAO,OAAO;AACrC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8021</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/router/utils/parse-path.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Given a path this function will find the pathname, query and hash and return</span><span class="s3">\n </span><span class="s1">* them. This is useful to parse full paths on the client side.</span><span class="s3">\n </span><span class="s1">* @param path A path to parse e.g. /foo/bar?id=1#hash</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function parsePath(path: string) {</span><span class="s3">\n  </span><span class="s1">const hashIndex = path.indexOf('#')</span><span class="s3">\n  </span><span class="s1">const queryIndex = path.indexOf('?')</span><span class="s3">\n  </span><span class="s1">const hasQuery = queryIndex &gt; -1 &amp;&amp; (hashIndex &lt; 0 || queryIndex &lt; hashIndex)</span><span class="s3">\n\n  </span><span class="s1">if (hasQuery || hashIndex &gt; -1) {</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">pathname: path.substring(0, hasQuery ? queryIndex : hashIndex),</span><span class="s3">\n      </span><span class="s1">query: hasQuery</span><span class="s3">\n        </span><span class="s1">? path.substring(queryIndex, hashIndex &gt; -1 ? hashIndex : undefined)</span><span class="s3">\n        </span><span class="s1">: '',</span><span class="s3">\n      </span><span class="s1">hash: hashIndex &gt; -1 ? path.slice(hashIndex) : '',</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return { pathname: path, query: '', hash: '' }</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;parsePath&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;hashIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;indexOf&quot;</span><span class="s0">,</span><span class="s1">&quot;queryIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;hasQuery&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;substring&quot;</span><span class="s0">,</span><span class="s1">&quot;query&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;;CAIC;;;+BACeA,aAAAA;;;eAAAA;;;AAAT,SAASA,UAAUC,IAAY;IACpC,MAAMC,YAAYD,KAAKE,OAAO,CAAC;IAC/B,MAAMC,aAAaH,KAAKE,OAAO,CAAC;IAChC,MAAME,WAAWD,aAAa,CAAC,KAAMF,CAAAA,YAAY,KAAKE,aAAaF,SAAQ;IAE3E,IAAIG,YAAYH,YAAY,CAAC,GAAG;QAC9B,OAAO;YACLI,UAAUL,KAAKM,SAAS,CAAC,GAAGF,WAAWD,aAAaF;YACpDM,OAAOH,WACHJ,KAAKM,SAAS,CAACH,YAAYF,YAAY,CAAC,IAAIA,YAAYO,aACxD;YACJC,MAAMR,YAAY,CAAC,IAAID,KAAKU,KAAK,CAACT,aAAa;QACjD;IACF;IAEA,OAAO;QAAEI,UAAUL;QAAMO,OAAO;QAAIE,MAAM;IAAG;AAC/C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8055</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/router/utils/add-path-prefix.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { parsePath } from './parse-path'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Adds the provided prefix to the given path. It first ensures that the path</span><span class="s3">\n </span><span class="s1">* is indeed starting with a slash.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function addPathPrefix(path: string, prefix?: string) {</span><span class="s3">\n  </span><span class="s1">if (!path.startsWith('/') || !prefix) {</span><span class="s3">\n    </span><span class="s1">return path</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { pathname, query, hash } = parsePath(path)</span><span class="s3">\n  </span><span class="s1">return `${prefix}${pathname}${query}${hash}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;addPathPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;query&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">,</span><span class="s1">&quot;parsePath&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAMgBA,iBAAAA;;;eAAAA;;;2BANU;AAMnB,SAASA,cAAcC,IAAY,EAAEC,MAAe;IACzD,IAAI,CAACD,KAAKE,UAAU,CAAC,QAAQ,CAACD,QAAQ;QACpC,OAAOD;IACT;IAEA,MAAM,EAAEG,QAAQ,EAAEC,KAAK,EAAEC,IAAI,EAAE,GAAGC,CAAAA,GAAAA,WAAAA,SAAS,EAACN;IAC5C,OAAQ,KAAEC,SAASE,WAAWC,QAAQC;AACxC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8076</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/router/utils/add-path-suffix.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { parsePath } from './parse-path'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Similarly to `addPathPrefix`, this function adds a suffix at the end on the</span><span class="s3">\n </span><span class="s1">* provided path. It also works only for paths ensuring the argument starts</span><span class="s3">\n </span><span class="s1">* with a slash.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function addPathSuffix(path: string, suffix?: string) {</span><span class="s3">\n  </span><span class="s1">if (!path.startsWith('/') || !suffix) {</span><span class="s3">\n    </span><span class="s1">return path</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { pathname, query, hash } = parsePath(path)</span><span class="s3">\n  </span><span class="s1">return `${pathname}${suffix}${query}${hash}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;addPathSuffix&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;suffix&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;query&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">,</span><span class="s1">&quot;parsePath&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAOgBA,iBAAAA;;;eAAAA;;;2BAPU;AAOnB,SAASA,cAAcC,IAAY,EAAEC,MAAe;IACzD,IAAI,CAACD,KAAKE,UAAU,CAAC,QAAQ,CAACD,QAAQ;QACpC,OAAOD;IACT;IAEA,MAAM,EAAEG,QAAQ,EAAEC,KAAK,EAAEC,IAAI,EAAE,GAAGC,CAAAA,GAAAA,WAAAA,SAAS,EAACN;IAC5C,OAAQ,KAAEG,WAAWF,SAASG,QAAQC;AACxC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8097</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/router/utils/path-has-prefix.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { parsePath } from './parse-path'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Checks if a given path starts with a given prefix. It ensures it matches</span><span class="s3">\n </span><span class="s1">* exactly without containing extra chars. e.g. prefix /docs should replace</span><span class="s3">\n </span><span class="s1">* for /docs, /docs/, /docs/a but not /docsss</span><span class="s3">\n </span><span class="s1">* @param path The path to check.</span><span class="s3">\n </span><span class="s1">* @param prefix The prefix to check against.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function pathHasPrefix(path: string, prefix: string) {</span><span class="s3">\n  </span><span class="s1">if (typeof path !== 'string') {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { pathname } = parsePath(path)</span><span class="s3">\n  </span><span class="s1">return pathname === prefix || pathname.startsWith(prefix + '/')</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;pathHasPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;parsePath&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BASgBA,iBAAAA;;;eAAAA;;;2BATU;AASnB,SAASA,cAAcC,IAAY,EAAEC,MAAc;IACxD,IAAI,OAAOD,SAAS,UAAU;QAC5B,OAAO;IACT;IAEA,MAAM,EAAEE,QAAQ,EAAE,GAAGC,CAAAA,GAAAA,WAAAA,SAAS,EAACH;IAC/B,OAAOE,aAAaD,UAAUC,SAASE,UAAU,CAACH,SAAS;AAC7D&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8118</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/router/utils/add-locale.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { addPathPrefix } from './add-path-prefix'</span><span class="s3">\n</span><span class="s1">import { pathHasPrefix } from './path-has-prefix'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* For a given path and a locale, if the locale is given, it will prefix the</span><span class="s3">\n </span><span class="s1">* locale. The path shouldn't be an API path. If a default locale is given the</span><span class="s3">\n </span><span class="s1">* prefix will be omitted if the locale is already the default locale.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function addLocale(</span><span class="s3">\n  </span><span class="s1">path: string,</span><span class="s3">\n  </span><span class="s1">locale?: string | false,</span><span class="s3">\n  </span><span class="s1">defaultLocale?: string,</span><span class="s3">\n  </span><span class="s1">ignorePrefix?: boolean</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">// If no locale was given or the locale is the default locale, we don't need</span><span class="s3">\n  </span><span class="s1">// to prefix the path.</span><span class="s3">\n  </span><span class="s1">if (!locale || locale === defaultLocale) return path</span><span class="s3">\n\n  </span><span class="s1">const lower = path.toLowerCase()</span><span class="s3">\n\n  </span><span class="s1">// If the path is an API path or the path already has the locale prefix, we</span><span class="s3">\n  </span><span class="s1">// don't need to prefix the path.</span><span class="s3">\n  </span><span class="s1">if (!ignorePrefix) {</span><span class="s3">\n    </span><span class="s1">if (pathHasPrefix(lower, '/api')) return path</span><span class="s3">\n    </span><span class="s1">if (pathHasPrefix(lower, `/${locale.toLowerCase()}`)) return path</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Add the locale prefix to the path.</span><span class="s3">\n  </span><span class="s1">return addPathPrefix(path, `/${locale}`)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;addLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">,</span><span class="s1">&quot;defaultLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;ignorePrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;lower&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;pathHasPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;addPathPrefix&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAQgBA,aAAAA;;;eAAAA;;;+BARc;+BACA;AAOvB,SAASA,UACdC,IAAY,EACZC,MAAuB,EACvBC,aAAsB,EACtBC,YAAsB;IAEtB,4EAA4E;IAC5E,sBAAsB;IACtB,IAAI,CAACF,UAAUA,WAAWC,eAAe,OAAOF;IAEhD,MAAMI,QAAQJ,KAAKK,WAAW;IAE9B,2EAA2E;IAC3E,iCAAiC;IACjC,IAAI,CAACF,cAAc;QACjB,IAAIG,CAAAA,GAAAA,eAAAA,aAAa,EAACF,OAAO,SAAS,OAAOJ;QACzC,IAAIM,CAAAA,GAAAA,eAAAA,aAAa,EAACF,OAAQ,MAAGH,OAAOI,WAAW,KAAO,OAAOL;IAC/D;IAEA,qCAAqC;IACrC,OAAOO,CAAAA,GAAAA,eAAAA,aAAa,EAACP,MAAO,MAAGC;AACjC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8147</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/router/utils/format-next-pathname-info.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { NextPathnameInfo } from './get-next-pathname-info'</span><span class="s3">\n</span><span class="s1">import { removeTrailingSlash } from './remove-trailing-slash'</span><span class="s3">\n</span><span class="s1">import { addPathPrefix } from './add-path-prefix'</span><span class="s3">\n</span><span class="s1">import { addPathSuffix } from './add-path-suffix'</span><span class="s3">\n</span><span class="s1">import { addLocale } from './add-locale'</span><span class="s3">\n\n</span><span class="s1">interface ExtendedInfo extends NextPathnameInfo {</span><span class="s3">\n  </span><span class="s1">defaultLocale?: string</span><span class="s3">\n  </span><span class="s1">ignorePrefix?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function formatNextPathnameInfo(info: ExtendedInfo) {</span><span class="s3">\n  </span><span class="s1">let pathname = addLocale(</span><span class="s3">\n    </span><span class="s1">info.pathname,</span><span class="s3">\n    </span><span class="s1">info.locale,</span><span class="s3">\n    </span><span class="s1">info.buildId ? undefined : info.defaultLocale,</span><span class="s3">\n    </span><span class="s1">info.ignorePrefix</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">if (info.buildId || !info.trailingSlash) {</span><span class="s3">\n    </span><span class="s1">pathname = removeTrailingSlash(pathname)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (info.buildId) {</span><span class="s3">\n    </span><span class="s1">pathname = addPathSuffix(</span><span class="s3">\n      </span><span class="s1">addPathPrefix(pathname, `/_next/data/${info.buildId}`),</span><span class="s3">\n      </span><span class="s1">info.pathname === '/' ? 'index.json' : '.json'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">pathname = addPathPrefix(pathname, info.basePath)</span><span class="s3">\n  </span><span class="s1">return !info.buildId &amp;&amp; info.trailingSlash</span><span class="s3">\n    </span><span class="s1">? !pathname.endsWith('/')</span><span class="s3">\n      </span><span class="s1">? addPathSuffix(pathname, '/')</span><span class="s3">\n      </span><span class="s1">: pathname</span><span class="s3">\n    </span><span class="s1">: removeTrailingSlash(pathname)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;formatNextPathnameInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;info&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;addLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;defaultLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;ignorePrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;trailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;removeTrailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;addPathSuffix&quot;</span><span class="s0">,</span><span class="s1">&quot;addPathPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;basePath&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAWgBA,0BAAAA;;;eAAAA;;;qCAVoB;+BACN;+BACA;2BACJ;AAOnB,SAASA,uBAAuBC,IAAkB;IACvD,IAAIC,WAAWC,CAAAA,GAAAA,WAAAA,SAAS,EACtBF,KAAKC,QAAQ,EACbD,KAAKG,MAAM,EACXH,KAAKI,OAAO,GAAGC,YAAYL,KAAKM,aAAa,EAC7CN,KAAKO,YAAY;IAGnB,IAAIP,KAAKI,OAAO,IAAI,CAACJ,KAAKQ,aAAa,EAAE;QACvCP,WAAWQ,CAAAA,GAAAA,qBAAAA,mBAAmB,EAACR;IACjC;IAEA,IAAID,KAAKI,OAAO,EAAE;QAChBH,WAAWS,CAAAA,GAAAA,eAAAA,aAAa,EACtBC,CAAAA,GAAAA,eAAAA,aAAa,EAACV,UAAW,iBAAcD,KAAKI,OAAO,GACnDJ,KAAKC,QAAQ,KAAK,MAAM,eAAe;IAE3C;IAEAA,WAAWU,CAAAA,GAAAA,eAAAA,aAAa,EAACV,UAAUD,KAAKY,QAAQ;IAChD,OAAO,CAACZ,KAAKI,OAAO,IAAIJ,KAAKQ,aAAa,GACtC,CAACP,SAASY,QAAQ,CAAC,OACjBH,CAAAA,GAAAA,eAAAA,aAAa,EAACT,UAAU,OACxBA,WACFQ,CAAAA,GAAAA,qBAAAA,mBAAmB,EAACR;AAC1B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8175</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/get-hostname.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { OutgoingHttpHeaders } from 'http'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Takes an object with a hostname property (like a parsed URL) and some</span><span class="s3">\n </span><span class="s1">* headers that may contain Host and returns the preferred hostname.</span><span class="s3">\n </span><span class="s1">* @param parsed An object containing a hostname property.</span><span class="s3">\n </span><span class="s1">* @param headers A dictionary with headers containing a `host`.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function getHostname(</span><span class="s3">\n  </span><span class="s1">parsed: { hostname?: string | null },</span><span class="s3">\n  </span><span class="s1">headers?: OutgoingHttpHeaders</span><span class="s3">\n</span><span class="s1">): string | undefined {</span><span class="s3">\n  </span><span class="s1">// Get the hostname from the headers if it exists, otherwise use the parsed</span><span class="s3">\n  </span><span class="s1">// hostname.</span><span class="s3">\n  </span><span class="s1">let hostname: string</span><span class="s3">\n  </span><span class="s1">if (headers?.host &amp;&amp; !Array.isArray(headers.host)) {</span><span class="s3">\n    </span><span class="s1">hostname = headers.host.toString().split(':', 1)[0]</span><span class="s3">\n  </span><span class="s1">} else if (parsed.hostname) {</span><span class="s3">\n    </span><span class="s1">hostname = parsed.hostname</span><span class="s3">\n  </span><span class="s1">} else return</span><span class="s3">\n\n  </span><span class="s1">return hostname.toLowerCase()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getHostname&quot;</span><span class="s0">,</span><span class="s1">&quot;parsed&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;hostname&quot;</span><span class="s0">,</span><span class="s1">&quot;host&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAQgBA,eAAAA;;;eAAAA;;;AAAT,SAASA,YACdC,MAAoC,EACpCC,OAA6B;IAE7B,2EAA2E;IAC3E,YAAY;IACZ,IAAIC;IACJ,IAAID,CAAAA,WAAAA,OAAAA,KAAAA,IAAAA,QAASE,IAAI,KAAI,CAACC,MAAMC,OAAO,CAACJ,QAAQE,IAAI,GAAG;QACjDD,WAAWD,QAAQE,IAAI,CAACG,QAAQ,GAAGC,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE;IACrD,OAAO,IAAIP,OAAOE,QAAQ,EAAE;QAC1BA,WAAWF,OAAOE,QAAQ;IAC5B,OAAO;IAEP,OAAOA,SAASM,WAAW;AAC7B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8199</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/i18n/normalize-locale-path.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export interface PathLocale {</span><span class="s3">\n  </span><span class="s1">detectedLocale?: string</span><span class="s3">\n  </span><span class="s1">pathname: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* A cache of lowercased locales for each list of locales. This is stored as a</span><span class="s3">\n </span><span class="s1">* WeakMap so if the locales are garbage collected, the cache entry will be</span><span class="s3">\n </span><span class="s1">* removed as well.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">const cache = new WeakMap&lt;readonly string[], readonly string[]&gt;()</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* For a pathname that may include a locale from a list of locales, it</span><span class="s3">\n </span><span class="s1">* removes the locale from the pathname returning it alongside with the</span><span class="s3">\n </span><span class="s1">* detected locale.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param pathname A pathname that may include a locale.</span><span class="s3">\n </span><span class="s1">* @param locales A list of locales.</span><span class="s3">\n </span><span class="s1">* @returns The detected locale and pathname without locale</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeLocalePath(</span><span class="s3">\n  </span><span class="s1">pathname: string,</span><span class="s3">\n  </span><span class="s1">locales?: readonly string[]</span><span class="s3">\n</span><span class="s1">): PathLocale {</span><span class="s3">\n  </span><span class="s1">// If locales is undefined, return the pathname as is.</span><span class="s3">\n  </span><span class="s1">if (!locales) return { pathname }</span><span class="s3">\n\n  </span><span class="s1">// Get the cached lowercased locales or create a new cache entry.</span><span class="s3">\n  </span><span class="s1">let lowercasedLocales = cache.get(locales)</span><span class="s3">\n  </span><span class="s1">if (!lowercasedLocales) {</span><span class="s3">\n    </span><span class="s1">lowercasedLocales = locales.map((locale) =&gt; locale.toLowerCase())</span><span class="s3">\n    </span><span class="s1">cache.set(locales, lowercasedLocales)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let detectedLocale: string | undefined</span><span class="s3">\n\n  </span><span class="s1">// The first segment will be empty, because it has a leading `/`. If</span><span class="s3">\n  </span><span class="s1">// there is no further segment, there is no locale (or it's the default).</span><span class="s3">\n  </span><span class="s1">const segments = pathname.split('/', 2)</span><span class="s3">\n\n  </span><span class="s1">// If there's no second segment (ie, the pathname is just `/`), there's no</span><span class="s3">\n  </span><span class="s1">// locale.</span><span class="s3">\n  </span><span class="s1">if (!segments[1]) return { pathname }</span><span class="s3">\n\n  </span><span class="s1">// The second segment will contain the locale part if any.</span><span class="s3">\n  </span><span class="s1">const segment = segments[1].toLowerCase()</span><span class="s3">\n\n  </span><span class="s1">// See if the segment matches one of the locales. If it doesn't, there is</span><span class="s3">\n  </span><span class="s1">// no locale (or it's the default).</span><span class="s3">\n  </span><span class="s1">const index = lowercasedLocales.indexOf(segment)</span><span class="s3">\n  </span><span class="s1">if (index &lt; 0) return { pathname }</span><span class="s3">\n\n  </span><span class="s1">// Return the case-sensitive locale.</span><span class="s3">\n  </span><span class="s1">detectedLocale = locales[index]</span><span class="s3">\n\n  </span><span class="s1">// Remove the `/${locale}` part of the pathname.</span><span class="s3">\n  </span><span class="s1">pathname = pathname.slice(detectedLocale.length + 1) || '/'</span><span class="s3">\n\n  </span><span class="s1">return { pathname, detectedLocale }</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;normalizeLocalePath&quot;</span><span class="s0">,</span><span class="s1">&quot;cache&quot;</span><span class="s0">,</span><span class="s1">&quot;WeakMap&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;locales&quot;</span><span class="s0">,</span><span class="s1">&quot;lowercasedLocales&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;detectedLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;segments&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;indexOf&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAqBgBA,uBAAAA;;;eAAAA;;;AAhBhB;;;;CAIC,GACD,MAAMC,QAAQ,IAAIC;AAWX,SAASF,oBACdG,QAAgB,EAChBC,OAA2B;IAE3B,sDAAsD;IACtD,IAAI,CAACA,SAAS,OAAO;QAAED;IAAS;IAEhC,iEAAiE;IACjE,IAAIE,oBAAoBJ,MAAMK,GAAG,CAACF;IAClC,IAAI,CAACC,mBAAmB;QACtBA,oBAAoBD,QAAQG,GAAG,CAAC,CAACC,SAAWA,OAAOC,WAAW;QAC9DR,MAAMS,GAAG,CAACN,SAASC;IACrB;IAEA,IAAIM;IAEJ,oEAAoE;IACpE,yEAAyE;IACzE,MAAMC,WAAWT,SAASU,KAAK,CAAC,KAAK;IAErC,0EAA0E;IAC1E,UAAU;IACV,IAAI,CAACD,QAAQ,CAAC,EAAE,EAAE,OAAO;QAAET;IAAS;IAEpC,0DAA0D;IAC1D,MAAMW,UAAUF,QAAQ,CAAC,EAAE,CAACH,WAAW;IAEvC,yEAAyE;IACzE,mCAAmC;IACnC,MAAMM,QAAQV,kBAAkBW,OAAO,CAACF;IACxC,IAAIC,QAAQ,GAAG,OAAO;QAAEZ;IAAS;IAEjC,oCAAoC;IACpCQ,iBAAiBP,OAAO,CAACW,MAAM;IAE/B,gDAAgD;IAChDZ,WAAWA,SAASc,KAAK,CAACN,eAAeO,MAAM,GAAG,MAAM;IAExD,OAAO;QAAEf;QAAUQ;IAAe;AACpC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8254</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/router/utils/remove-path-prefix.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { pathHasPrefix } from './path-has-prefix'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Given a path and a prefix it will remove the prefix when it exists in the</span><span class="s3">\n </span><span class="s1">* given path. It ensures it matches exactly without containing extra chars</span><span class="s3">\n </span><span class="s1">* and if the prefix is not there it will be noop.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param path The path to remove the prefix from.</span><span class="s3">\n </span><span class="s1">* @param prefix The prefix to be removed.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function removePathPrefix(path: string, prefix: string): string {</span><span class="s3">\n  </span><span class="s1">// If the path doesn't start with the prefix we can return it as is. This</span><span class="s3">\n  </span><span class="s1">// protects us from situations where the prefix is a substring of the path</span><span class="s3">\n  </span><span class="s1">// prefix such as:</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// For prefix: /blog</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">//   /blog -&gt; true</span><span class="s3">\n  </span><span class="s1">//   /blog/ -&gt; true</span><span class="s3">\n  </span><span class="s1">//   /blog/1 -&gt; true</span><span class="s3">\n  </span><span class="s1">//   /blogging -&gt; false</span><span class="s3">\n  </span><span class="s1">//   /blogging/ -&gt; false</span><span class="s3">\n  </span><span class="s1">//   /blogging/1 -&gt; false</span><span class="s3">\n  </span><span class="s1">if (!pathHasPrefix(path, prefix)) {</span><span class="s3">\n    </span><span class="s1">return path</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Remove the prefix from the path via slicing.</span><span class="s3">\n  </span><span class="s1">const withoutPrefix = path.slice(prefix.length)</span><span class="s3">\n\n  </span><span class="s1">// If the path without the prefix starts with a `/` we can return it as is.</span><span class="s3">\n  </span><span class="s1">if (withoutPrefix.startsWith('/')) {</span><span class="s3">\n    </span><span class="s1">return withoutPrefix</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If the path without the prefix doesn't start with a `/` we need to add it</span><span class="s3">\n  </span><span class="s1">// back to the path to make sure it's a valid path.</span><span class="s3">\n  </span><span class="s1">return `/${withoutPrefix}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;removePathPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;pathHasPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;withoutPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAUgBA,oBAAAA;;;eAAAA;;;+BAVc;AAUvB,SAASA,iBAAiBC,IAAY,EAAEC,MAAc;IAC3D,yEAAyE;IACzE,0EAA0E;IAC1E,kBAAkB;IAClB,EAAE;IACF,oBAAoB;IACpB,EAAE;IACF,kBAAkB;IAClB,mBAAmB;IACnB,oBAAoB;IACpB,uBAAuB;IACvB,wBAAwB;IACxB,yBAAyB;IACzB,IAAI,CAACC,CAAAA,GAAAA,eAAAA,aAAa,EAACF,MAAMC,SAAS;QAChC,OAAOD;IACT;IAEA,+CAA+C;IAC/C,MAAMG,gBAAgBH,KAAKI,KAAK,CAACH,OAAOI,MAAM;IAE9C,2EAA2E;IAC3E,IAAIF,cAAcG,UAAU,CAAC,MAAM;QACjC,OAAOH;IACT;IAEA,4EAA4E;IAC5E,mDAAmD;IACnD,OAAQ,MAAGA;AACb&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8294</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/router/utils/get-next-pathname-info.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { normalizeLocalePath } from '../../i18n/normalize-locale-path'</span><span class="s3">\n</span><span class="s1">import { removePathPrefix } from './remove-path-prefix'</span><span class="s3">\n</span><span class="s1">import { pathHasPrefix } from './path-has-prefix'</span><span class="s3">\n</span><span class="s1">import type { I18NProvider } from '../../../../server/lib/i18n-provider'</span><span class="s3">\n\n</span><span class="s1">export interface NextPathnameInfo {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The base path in case the pathname included it.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">basePath?: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The buildId for when the parsed URL is a data URL. Parsing it can be</span><span class="s3">\n   </span><span class="s1">* disabled with the `parseData` option.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">buildId?: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If there was a locale in the pathname, this will hold its value.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">locale?: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The processed pathname without a base path, locale, or data URL elements</span><span class="s3">\n   </span><span class="s1">* when parsing it is enabled.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pathname: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* A boolean telling if the pathname had a trailingSlash. This can be only</span><span class="s3">\n   </span><span class="s1">* true if trailingSlash is enabled.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">trailingSlash?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface Options {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* When passed to true, this function will also parse Nextjs data URLs.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">parseData?: boolean</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* A partial of the Next.js configuration to parse the URL.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">nextConfig?: {</span><span class="s3">\n    </span><span class="s1">basePath?: string</span><span class="s3">\n    </span><span class="s1">i18n?: { locales?: readonly string[] } | null</span><span class="s3">\n    </span><span class="s1">trailingSlash?: boolean</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If provided, this normalizer will be used to detect the locale instead of</span><span class="s3">\n   </span><span class="s1">* the default locale detection.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">i18nProvider?: I18NProvider</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getNextPathnameInfo(</span><span class="s3">\n  </span><span class="s1">pathname: string,</span><span class="s3">\n  </span><span class="s1">options: Options</span><span class="s3">\n</span><span class="s1">): NextPathnameInfo {</span><span class="s3">\n  </span><span class="s1">const { basePath, i18n, trailingSlash } = options.nextConfig ?? {}</span><span class="s3">\n  </span><span class="s1">const info: NextPathnameInfo = {</span><span class="s3">\n    </span><span class="s1">pathname,</span><span class="s3">\n    </span><span class="s1">trailingSlash: pathname !== '/' ? pathname.endsWith('/') : trailingSlash,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (basePath &amp;&amp; pathHasPrefix(info.pathname, basePath)) {</span><span class="s3">\n    </span><span class="s1">info.pathname = removePathPrefix(info.pathname, basePath)</span><span class="s3">\n    </span><span class="s1">info.basePath = basePath</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">let pathnameNoDataPrefix = info.pathname</span><span class="s3">\n\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">info.pathname.startsWith('/_next/data/') &amp;&amp;</span><span class="s3">\n    </span><span class="s1">info.pathname.endsWith('.json')</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">const paths = info.pathname</span><span class="s3">\n      </span><span class="s1">.replace(/^</span><span class="s3">\\</span><span class="s1">/_next</span><span class="s3">\\</span><span class="s1">/data</span><span class="s3">\\</span><span class="s1">//, '')</span><span class="s3">\n      </span><span class="s1">.replace(/</span><span class="s3">\\</span><span class="s1">.json$/, '')</span><span class="s3">\n      </span><span class="s1">.split('/')</span><span class="s3">\n\n    </span><span class="s1">const buildId = paths[0]</span><span class="s3">\n    </span><span class="s1">info.buildId = buildId</span><span class="s3">\n    </span><span class="s1">pathnameNoDataPrefix =</span><span class="s3">\n      </span><span class="s1">paths[1] !== 'index' ? `/${paths.slice(1).join('/')}` : '/'</span><span class="s3">\n\n    </span><span class="s1">// update pathname with normalized if enabled although</span><span class="s3">\n    </span><span class="s1">// we use normalized to populate locale info still</span><span class="s3">\n    </span><span class="s1">if (options.parseData === true) {</span><span class="s3">\n      </span><span class="s1">info.pathname = pathnameNoDataPrefix</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If provided, use the locale route normalizer to detect the locale instead</span><span class="s3">\n  </span><span class="s1">// of the function below.</span><span class="s3">\n  </span><span class="s1">if (i18n) {</span><span class="s3">\n    </span><span class="s1">let result = options.i18nProvider</span><span class="s3">\n      </span><span class="s1">? options.i18nProvider.analyze(info.pathname)</span><span class="s3">\n      </span><span class="s1">: normalizeLocalePath(info.pathname, i18n.locales)</span><span class="s3">\n\n    </span><span class="s1">info.locale = result.detectedLocale</span><span class="s3">\n    </span><span class="s1">info.pathname = result.pathname ?? info.pathname</span><span class="s3">\n\n    </span><span class="s1">if (!result.detectedLocale &amp;&amp; info.buildId) {</span><span class="s3">\n      </span><span class="s1">result = options.i18nProvider</span><span class="s3">\n        </span><span class="s1">? options.i18nProvider.analyze(pathnameNoDataPrefix)</span><span class="s3">\n        </span><span class="s1">: normalizeLocalePath(pathnameNoDataPrefix, i18n.locales)</span><span class="s3">\n\n      </span><span class="s1">if (result.detectedLocale) {</span><span class="s3">\n        </span><span class="s1">info.locale = result.detectedLocale</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return info</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getNextPathnameInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;basePath&quot;</span><span class="s0">,</span><span class="s1">&quot;i18n&quot;</span><span class="s0">,</span><span class="s1">&quot;trailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;info&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;pathHasPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;removePathPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;pathnameNoDataPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;paths&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;parseData&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;i18nProvider&quot;</span><span class="s0">,</span><span class="s1">&quot;analyze&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeLocalePath&quot;</span><span class="s0">,</span><span class="s1">&quot;locales&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">,</span><span class="s1">&quot;detectedLocale&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAoDgBA,uBAAAA;;;eAAAA;;;qCApDoB;kCACH;+BACH;AAkDvB,SAASA,oBACdC,QAAgB,EAChBC,OAAgB;QAE0BA;IAA1C,MAAM,EAAEC,QAAQ,EAAEC,IAAI,EAAEC,aAAa,EAAE,GAAGH,CAAAA,sBAAAA,QAAQI,UAAU,KAAA,OAAlBJ,sBAAsB,CAAC;IACjE,MAAMK,OAAyB;QAC7BN;QACAI,eAAeJ,aAAa,MAAMA,SAASO,QAAQ,CAAC,OAAOH;IAC7D;IAEA,IAAIF,YAAYM,CAAAA,GAAAA,eAAAA,aAAa,EAACF,KAAKN,QAAQ,EAAEE,WAAW;QACtDI,KAAKN,QAAQ,GAAGS,CAAAA,GAAAA,kBAAAA,gBAAgB,EAACH,KAAKN,QAAQ,EAAEE;QAChDI,KAAKJ,QAAQ,GAAGA;IAClB;IACA,IAAIQ,uBAAuBJ,KAAKN,QAAQ;IAExC,IACEM,KAAKN,QAAQ,CAACW,UAAU,CAAC,mBACzBL,KAAKN,QAAQ,CAACO,QAAQ,CAAC,UACvB;QACA,MAAMK,QAAQN,KAAKN,QAAQ,CACxBa,OAAO,CAAC,oBAAoB,IAC5BA,OAAO,CAAC,WAAW,IACnBC,KAAK,CAAC;QAET,MAAMC,UAAUH,KAAK,CAAC,EAAE;QACxBN,KAAKS,OAAO,GAAGA;QACfL,uBACEE,KAAK,CAAC,EAAE,KAAK,UAAW,MAAGA,MAAMI,KAAK,CAAC,GAAGC,IAAI,CAAC,OAAS;QAE1D,sDAAsD;QACtD,kDAAkD;QAClD,IAAIhB,QAAQiB,SAAS,KAAK,MAAM;YAC9BZ,KAAKN,QAAQ,GAAGU;QAClB;IACF;IAEA,4EAA4E;IAC5E,yBAAyB;IACzB,IAAIP,MAAM;QACR,IAAIgB,SAASlB,QAAQmB,YAAY,GAC7BnB,QAAQmB,YAAY,CAACC,OAAO,CAACf,KAAKN,QAAQ,IAC1CsB,CAAAA,GAAAA,qBAAAA,mBAAmB,EAAChB,KAAKN,QAAQ,EAAEG,KAAKoB,OAAO;QAEnDjB,KAAKkB,MAAM,GAAGL,OAAOM,cAAc;YACnBN;QAAhBb,KAAKN,QAAQ,GAAGmB,CAAAA,mBAAAA,OAAOnB,QAAQ,KAAA,OAAfmB,mBAAmBb,KAAKN,QAAQ;QAEhD,IAAI,CAACmB,OAAOM,cAAc,IAAInB,KAAKS,OAAO,EAAE;YAC1CI,SAASlB,QAAQmB,YAAY,GACzBnB,QAAQmB,YAAY,CAACC,OAAO,CAACX,wBAC7BY,CAAAA,GAAAA,qBAAAA,mBAAmB,EAACZ,sBAAsBP,KAAKoB,OAAO;YAE1D,IAAIJ,OAAOM,cAAc,EAAE;gBACzBnB,KAAKkB,MAAM,GAAGL,OAAOM,cAAc;YACrC;QACF;IACF;IACA,OAAOnB;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8349</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/web/next-url.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { OutgoingHttpHeaders } from 'http'</span><span class="s3">\n</span><span class="s1">import type { DomainLocale, I18NConfig } from '../config-shared'</span><span class="s3">\n</span><span class="s1">import type { I18NProvider } from '../lib/i18n-provider'</span><span class="s3">\n\n</span><span class="s1">import { detectDomainLocale } from '../../shared/lib/i18n/detect-domain-locale'</span><span class="s3">\n</span><span class="s1">import { formatNextPathnameInfo } from '../../shared/lib/router/utils/format-next-pathname-info'</span><span class="s3">\n</span><span class="s1">import { getHostname } from '../../shared/lib/get-hostname'</span><span class="s3">\n</span><span class="s1">import { getNextPathnameInfo } from '../../shared/lib/router/utils/get-next-pathname-info'</span><span class="s3">\n\n</span><span class="s1">interface Options {</span><span class="s3">\n  </span><span class="s1">base?: string | URL</span><span class="s3">\n  </span><span class="s1">headers?: OutgoingHttpHeaders</span><span class="s3">\n  </span><span class="s1">forceLocale?: boolean</span><span class="s3">\n  </span><span class="s1">nextConfig?: {</span><span class="s3">\n    </span><span class="s1">basePath?: string</span><span class="s3">\n    </span><span class="s1">i18n?: I18NConfig | null</span><span class="s3">\n    </span><span class="s1">trailingSlash?: boolean</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">i18nProvider?: I18NProvider</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const REGEX_LOCALHOST_HOSTNAME =</span><span class="s3">\n  </span><span class="s1">/(?!^https?:</span><span class="s3">\\</span><span class="s1">/</span><span class="s3">\\</span><span class="s1">/)(127(?:</span><span class="s3">\\</span><span class="s1">.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|</span><span class="s3">\\</span><span class="s1">[::1</span><span class="s3">\\</span><span class="s1">]|localhost)/</span><span class="s3">\n\n</span><span class="s1">function parseURL(url: string | URL, base?: string | URL) {</span><span class="s3">\n  </span><span class="s1">return new URL(</span><span class="s3">\n    </span><span class="s1">String(url).replace(REGEX_LOCALHOST_HOSTNAME, 'localhost'),</span><span class="s3">\n    </span><span class="s1">base &amp;&amp; String(base).replace(REGEX_LOCALHOST_HOSTNAME, 'localhost')</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const Internal = Symbol('NextURLInternal')</span><span class="s3">\n\n</span><span class="s1">export class NextURL {</span><span class="s3">\n  </span><span class="s1">private [Internal]: {</span><span class="s3">\n    </span><span class="s1">basePath: string</span><span class="s3">\n    </span><span class="s1">buildId?: string</span><span class="s3">\n    </span><span class="s1">flightSearchParameters?: Record&lt;string, string&gt;</span><span class="s3">\n    </span><span class="s1">defaultLocale?: string</span><span class="s3">\n    </span><span class="s1">domainLocale?: DomainLocale</span><span class="s3">\n    </span><span class="s1">locale?: string</span><span class="s3">\n    </span><span class="s1">options: Options</span><span class="s3">\n    </span><span class="s1">trailingSlash?: boolean</span><span class="s3">\n    </span><span class="s1">url: URL</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">constructor(input: string | URL, base?: string | URL, opts?: Options)</span><span class="s3">\n  </span><span class="s1">constructor(input: string | URL, opts?: Options)</span><span class="s3">\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">input: string | URL,</span><span class="s3">\n    </span><span class="s1">baseOrOpts?: string | URL | Options,</span><span class="s3">\n    </span><span class="s1">opts?: Options</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">let base: undefined | string | URL</span><span class="s3">\n    </span><span class="s1">let options: Options</span><span class="s3">\n\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">(typeof baseOrOpts === 'object' &amp;&amp; 'pathname' in baseOrOpts) ||</span><span class="s3">\n      </span><span class="s1">typeof baseOrOpts === 'string'</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">base = baseOrOpts</span><span class="s3">\n      </span><span class="s1">options = opts || {}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">options = opts || baseOrOpts || {}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">this[Internal] = {</span><span class="s3">\n      </span><span class="s1">url: parseURL(input, base ?? options.base),</span><span class="s3">\n      </span><span class="s1">options: options,</span><span class="s3">\n      </span><span class="s1">basePath: '',</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">this.analyze()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private analyze() {</span><span class="s3">\n    </span><span class="s1">const info = getNextPathnameInfo(this[Internal].url.pathname, {</span><span class="s3">\n      </span><span class="s1">nextConfig: this[Internal].options.nextConfig,</span><span class="s3">\n      </span><span class="s1">parseData: !process.env.__NEXT_NO_MIDDLEWARE_URL_NORMALIZE,</span><span class="s3">\n      </span><span class="s1">i18nProvider: this[Internal].options.i18nProvider,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n\n    </span><span class="s1">const hostname = getHostname(</span><span class="s3">\n      </span><span class="s1">this[Internal].url,</span><span class="s3">\n      </span><span class="s1">this[Internal].options.headers</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">this[Internal].domainLocale = this[Internal].options.i18nProvider</span><span class="s3">\n      </span><span class="s1">? this[Internal].options.i18nProvider.detectDomainLocale(hostname)</span><span class="s3">\n      </span><span class="s1">: detectDomainLocale(</span><span class="s3">\n          </span><span class="s1">this[Internal].options.nextConfig?.i18n?.domains,</span><span class="s3">\n          </span><span class="s1">hostname</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">const defaultLocale =</span><span class="s3">\n      </span><span class="s1">this[Internal].domainLocale?.defaultLocale ||</span><span class="s3">\n      </span><span class="s1">this[Internal].options.nextConfig?.i18n?.defaultLocale</span><span class="s3">\n\n    </span><span class="s1">this[Internal].url.pathname = info.pathname</span><span class="s3">\n    </span><span class="s1">this[Internal].defaultLocale = defaultLocale</span><span class="s3">\n    </span><span class="s1">this[Internal].basePath = info.basePath ?? ''</span><span class="s3">\n    </span><span class="s1">this[Internal].buildId = info.buildId</span><span class="s3">\n    </span><span class="s1">this[Internal].locale = info.locale ?? defaultLocale</span><span class="s3">\n    </span><span class="s1">this[Internal].trailingSlash = info.trailingSlash</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private formatPathname() {</span><span class="s3">\n    </span><span class="s1">return formatNextPathnameInfo({</span><span class="s3">\n      </span><span class="s1">basePath: this[Internal].basePath,</span><span class="s3">\n      </span><span class="s1">buildId: this[Internal].buildId,</span><span class="s3">\n      </span><span class="s1">defaultLocale: !this[Internal].options.forceLocale</span><span class="s3">\n        </span><span class="s1">? this[Internal].defaultLocale</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n      </span><span class="s1">locale: this[Internal].locale,</span><span class="s3">\n      </span><span class="s1">pathname: this[Internal].url.pathname,</span><span class="s3">\n      </span><span class="s1">trailingSlash: this[Internal].trailingSlash,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private formatSearch() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.search</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get buildId() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].buildId</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public set buildId(buildId: string | undefined) {</span><span class="s3">\n    </span><span class="s1">this[Internal].buildId = buildId</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get locale() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].locale ?? ''</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public set locale(locale: string) {</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">!this[Internal].locale ||</span><span class="s3">\n      </span><span class="s1">!this[Internal].options.nextConfig?.i18n?.locales.includes(locale)</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">throw new TypeError(</span><span class="s3">\n        </span><span class="s1">`The NextURL configuration includes no locale </span><span class="s3">\&quot;</span><span class="s1">${locale}</span><span class="s3">\&quot;</span><span class="s1">`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">this[Internal].locale = locale</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get defaultLocale() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].defaultLocale</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get domainLocale() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].domainLocale</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get searchParams() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.searchParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get host() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.host</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set host(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.host = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get hostname() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.hostname</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set hostname(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.hostname = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get port() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.port</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set port(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.port = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get protocol() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.protocol</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set protocol(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.protocol = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get href() {</span><span class="s3">\n    </span><span class="s1">const pathname = this.formatPathname()</span><span class="s3">\n    </span><span class="s1">const search = this.formatSearch()</span><span class="s3">\n    </span><span class="s1">return `${this.protocol}//${this.host}${pathname}${search}${this.hash}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set href(url: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url = parseURL(url)</span><span class="s3">\n    </span><span class="s1">this.analyze()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get origin() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.origin</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get pathname() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.pathname</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set pathname(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.pathname = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get hash() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.hash</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set hash(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.hash = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get search() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.search</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set search(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.search = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get password() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.password</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set password(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.password = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get username() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].url.username</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set username(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].url.username = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get basePath() {</span><span class="s3">\n    </span><span class="s1">return this[Internal].basePath</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set basePath(value: string) {</span><span class="s3">\n    </span><span class="s1">this[Internal].basePath = value.startsWith('/') ? value : `/${value}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">toString() {</span><span class="s3">\n    </span><span class="s1">return this.href</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">toJSON() {</span><span class="s3">\n    </span><span class="s1">return this.href</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">[Symbol.for('edge-runtime.inspect.custom')]() {</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">href: this.href,</span><span class="s3">\n      </span><span class="s1">origin: this.origin,</span><span class="s3">\n      </span><span class="s1">protocol: this.protocol,</span><span class="s3">\n      </span><span class="s1">username: this.username,</span><span class="s3">\n      </span><span class="s1">password: this.password,</span><span class="s3">\n      </span><span class="s1">host: this.host,</span><span class="s3">\n      </span><span class="s1">hostname: this.hostname,</span><span class="s3">\n      </span><span class="s1">port: this.port,</span><span class="s3">\n      </span><span class="s1">pathname: this.pathname,</span><span class="s3">\n      </span><span class="s1">search: this.search,</span><span class="s3">\n      </span><span class="s1">searchParams: this.searchParams,</span><span class="s3">\n      </span><span class="s1">hash: this.hash,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">clone() {</span><span class="s3">\n    </span><span class="s1">return new NextURL(String(this), this[Internal].options)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;NextURL&quot;</span><span class="s0">,</span><span class="s1">&quot;REGEX_LOCALHOST_HOSTNAME&quot;</span><span class="s0">,</span><span class="s1">&quot;parseURL&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;base&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;Internal&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;input&quot;</span><span class="s0">,</span><span class="s1">&quot;baseOrOpts&quot;</span><span class="s0">,</span><span class="s1">&quot;opts&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;basePath&quot;</span><span class="s0">,</span><span class="s1">&quot;analyze&quot;</span><span class="s0">,</span><span class="s1">&quot;info&quot;</span><span class="s0">,</span><span class="s1">&quot;getNextPathnameInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;parseData&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_NO_MIDDLEWARE_URL_NORMALIZE&quot;</span><span class="s0">,</span><span class="s1">&quot;i18nProvider&quot;</span><span class="s0">,</span><span class="s1">&quot;hostname&quot;</span><span class="s0">,</span><span class="s1">&quot;getHostname&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;domainLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;detectDomainLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;i18n&quot;</span><span class="s0">,</span><span class="s1">&quot;domains&quot;</span><span class="s0">,</span><span class="s1">&quot;defaultLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;locale&quot;</span><span class="s0">,</span><span class="s1">&quot;trailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;formatPathname&quot;</span><span class="s0">,</span><span class="s1">&quot;formatNextPathnameInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;forceLocale&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;formatSearch&quot;</span><span class="s0">,</span><span class="s1">&quot;search&quot;</span><span class="s0">,</span><span class="s1">&quot;locales&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;TypeError&quot;</span><span class="s0">,</span><span class="s1">&quot;searchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;host&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;port&quot;</span><span class="s0">,</span><span class="s1">&quot;protocol&quot;</span><span class="s0">,</span><span class="s1">&quot;href&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">,</span><span class="s1">&quot;origin&quot;</span><span class="s0">,</span><span class="s1">&quot;password&quot;</span><span class="s0">,</span><span class="s1">&quot;username&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;toJSON&quot;</span><span class="s0">,</span><span class="s1">&quot;for&quot;</span><span class="s0">,</span><span class="s1">&quot;clone&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAiCaA,WAAAA;;;eAAAA;;;oCA7BsB;wCACI;6BACX;qCACQ;AAcpC,MAAMC,2BACJ;AAEF,SAASC,SAASC,GAAiB,EAAEC,IAAmB;IACtD,OAAO,IAAIC,IACTC,OAAOH,KAAKI,OAAO,CAACN,0BAA0B,cAC9CG,QAAQE,OAAOF,MAAMG,OAAO,CAACN,0BAA0B;AAE3D;AAEA,MAAMO,WAAWC,OAAO;AAEjB,MAAMT;IAeXU,YACEC,KAAmB,EACnBC,UAAmC,EACnCC,IAAc,CACd;QACA,IAAIT;QACJ,IAAIU;QAEJ,IACG,OAAOF,eAAe,YAAY,cAAcA,cACjD,OAAOA,eAAe,UACtB;YACAR,OAAOQ;YACPE,UAAUD,QAAQ,CAAC;QACrB,OAAO;YACLC,UAAUD,QAAQD,cAAc,CAAC;QACnC;QAEA,IAAI,CAACJ,SAAS,GAAG;YACfL,KAAKD,SAASS,OAAOP,QAAQU,QAAQV,IAAI;YACzCU,SAASA;YACTC,UAAU;QACZ;QAEA,IAAI,CAACC,OAAO;IACd;IAEQA,UAAU;YAcV,wCAAA,mCAKJ,6BACA,yCAAA;QAnBF,MAAMC,OAAOC,CAAAA,GAAAA,qBAAAA,mBAAmB,EAAC,IAAI,CAACV,SAAS,CAACL,GAAG,CAACgB,QAAQ,EAAE;YAC5DC,YAAY,IAAI,CAACZ,SAAS,CAACM,OAAO,CAACM,UAAU;YAC7CC,WAAW,CAACC,QAAQC,GAAG,CAACC,kCAAkC;YAC1DC,cAAc,IAAI,CAACjB,SAAS,CAACM,OAAO,CAACW,YAAY;QACnD;QAEA,MAAMC,WAAWC,CAAAA,GAAAA,aAAAA,WAAW,EAC1B,IAAI,CAACnB,SAAS,CAACL,GAAG,EAClB,IAAI,CAACK,SAAS,CAACM,OAAO,CAACc,OAAO;QAEhC,IAAI,CAACpB,SAAS,CAACqB,YAAY,GAAG,IAAI,CAACrB,SAAS,CAACM,OAAO,CAACW,YAAY,GAC7D,IAAI,CAACjB,SAAS,CAACM,OAAO,CAACW,YAAY,CAACK,kBAAkB,CAACJ,YACvDI,CAAAA,GAAAA,oBAAAA,kBAAkB,EAAA,CAChB,oCAAA,IAAI,CAACtB,SAAS,CAACM,OAAO,CAACM,UAAU,KAAA,OAAA,KAAA,IAAA,CAAjC,yCAAA,kCAAmCW,IAAI,KAAA,OAAA,KAAA,IAAvC,uCAAyCC,OAAO,EAChDN;QAGN,MAAMO,gBACJ,CAAA,CAAA,8BAAA,IAAI,CAACzB,SAAS,CAACqB,YAAY,KAAA,OAAA,KAAA,IAA3B,4BAA6BI,aAAa,KAAA,CAAA,CAC1C,qCAAA,IAAI,CAACzB,SAAS,CAACM,OAAO,CAACM,UAAU,KAAA,OAAA,KAAA,IAAA,CAAjC,0CAAA,mCAAmCW,IAAI,KAAA,OAAA,KAAA,IAAvC,wCAAyCE,aAAa;QAExD,IAAI,CAACzB,SAAS,CAACL,GAAG,CAACgB,QAAQ,GAAGF,KAAKE,QAAQ;QAC3C,IAAI,CAACX,SAAS,CAACyB,aAAa,GAAGA;QAC/B,IAAI,CAACzB,SAAS,CAACO,QAAQ,GAAGE,KAAKF,QAAQ,IAAI;QAC3C,IAAI,CAACP,SAAS,CAAC0B,OAAO,GAAGjB,KAAKiB,OAAO;QACrC,IAAI,CAAC1B,SAAS,CAAC2B,MAAM,GAAGlB,KAAKkB,MAAM,IAAIF;QACvC,IAAI,CAACzB,SAAS,CAAC4B,aAAa,GAAGnB,KAAKmB,aAAa;IACnD;IAEQC,iBAAiB;QACvB,OAAOC,CAAAA,GAAAA,wBAAAA,sBAAsB,EAAC;YAC5BvB,UAAU,IAAI,CAACP,SAAS,CAACO,QAAQ;YACjCmB,SAAS,IAAI,CAAC1B,SAAS,CAAC0B,OAAO;YAC/BD,eAAe,CAAC,IAAI,CAACzB,SAAS,CAACM,OAAO,CAACyB,WAAW,GAC9C,IAAI,CAAC/B,SAAS,CAACyB,aAAa,GAC5BO;YACJL,QAAQ,IAAI,CAAC3B,SAAS,CAAC2B,MAAM;YAC7BhB,UAAU,IAAI,CAACX,SAAS,CAACL,GAAG,CAACgB,QAAQ;YACrCiB,eAAe,IAAI,CAAC5B,SAAS,CAAC4B,aAAa;QAC7C;IACF;IAEQK,eAAe;QACrB,OAAO,IAAI,CAACjC,SAAS,CAACL,GAAG,CAACuC,MAAM;IAClC;IAEA,IAAWR,UAAU;QACnB,OAAO,IAAI,CAAC1B,SAAS,CAAC0B,OAAO;IAC/B;IAEA,IAAWA,QAAQA,OAA2B,EAAE;QAC9C,IAAI,CAAC1B,SAAS,CAAC0B,OAAO,GAAGA;IAC3B;IAEA,IAAWC,SAAS;QAClB,OAAO,IAAI,CAAC3B,SAAS,CAAC2B,MAAM,IAAI;IAClC;IAEA,IAAWA,OAAOA,MAAc,EAAE;YAG7B,wCAAA;QAFH,IACE,CAAC,IAAI,CAAC3B,SAAS,CAAC2B,MAAM,IACtB,CAAA,CAAA,CAAC,oCAAA,IAAI,CAAC3B,SAAS,CAACM,OAAO,CAACM,UAAU,KAAA,OAAA,KAAA,IAAA,CAAjC,yCAAA,kCAAmCW,IAAI,KAAA,OAAA,KAAA,IAAvC,uCAAyCY,OAAO,CAACC,QAAQ,CAACT,OAAAA,GAC3D;YACA,MAAM,OAAA,cAEL,CAFK,IAAIU,UACR,CAAC,8CAA8C,EAAEV,OAAO,CAAC,CAAC,GADtD,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;QAEA,IAAI,CAAC3B,SAAS,CAAC2B,MAAM,GAAGA;IAC1B;IAEA,IAAIF,gBAAgB;QAClB,OAAO,IAAI,CAACzB,SAAS,CAACyB,aAAa;IACrC;IAEA,IAAIJ,eAAe;QACjB,OAAO,IAAI,CAACrB,SAAS,CAACqB,YAAY;IACpC;IAEA,IAAIiB,eAAe;QACjB,OAAO,IAAI,CAACtC,SAAS,CAACL,GAAG,CAAC2C,YAAY;IACxC;IAEA,IAAIC,OAAO;QACT,OAAO,IAAI,CAACvC,SAAS,CAACL,GAAG,CAAC4C,IAAI;IAChC;IAEA,IAAIA,KAAKC,KAAa,EAAE;QACtB,IAAI,CAACxC,SAAS,CAACL,GAAG,CAAC4C,IAAI,GAAGC;IAC5B;IAEA,IAAItB,WAAW;QACb,OAAO,IAAI,CAAClB,SAAS,CAACL,GAAG,CAACuB,QAAQ;IACpC;IAEA,IAAIA,SAASsB,KAAa,EAAE;QAC1B,IAAI,CAACxC,SAAS,CAACL,GAAG,CAACuB,QAAQ,GAAGsB;IAChC;IAEA,IAAIC,OAAO;QACT,OAAO,IAAI,CAACzC,SAAS,CAACL,GAAG,CAAC8C,IAAI;IAChC;IAEA,IAAIA,KAAKD,KAAa,EAAE;QACtB,IAAI,CAACxC,SAAS,CAACL,GAAG,CAAC8C,IAAI,GAAGD;IAC5B;IAEA,IAAIE,WAAW;QACb,OAAO,IAAI,CAAC1C,SAAS,CAACL,GAAG,CAAC+C,QAAQ;IACpC;IAEA,IAAIA,SAASF,KAAa,EAAE;QAC1B,IAAI,CAACxC,SAAS,CAACL,GAAG,CAAC+C,QAAQ,GAAGF;IAChC;IAEA,IAAIG,OAAO;QACT,MAAMhC,WAAW,IAAI,CAACkB,cAAc;QACpC,MAAMK,SAAS,IAAI,CAACD,YAAY;QAChC,OAAO,GAAG,IAAI,CAACS,QAAQ,CAAC,EAAE,EAAE,IAAI,CAACH,IAAI,GAAG5B,WAAWuB,SAAS,IAAI,CAACU,IAAI,EAAE;IACzE;IAEA,IAAID,KAAKhD,GAAW,EAAE;QACpB,IAAI,CAACK,SAAS,CAACL,GAAG,GAAGD,SAASC;QAC9B,IAAI,CAACa,OAAO;IACd;IAEA,IAAIqC,SAAS;QACX,OAAO,IAAI,CAAC7C,SAAS,CAACL,GAAG,CAACkD,MAAM;IAClC;IAEA,IAAIlC,WAAW;QACb,OAAO,IAAI,CAACX,SAAS,CAACL,GAAG,CAACgB,QAAQ;IACpC;IAEA,IAAIA,SAAS6B,KAAa,EAAE;QAC1B,IAAI,CAACxC,SAAS,CAACL,GAAG,CAACgB,QAAQ,GAAG6B;IAChC;IAEA,IAAII,OAAO;QACT,OAAO,IAAI,CAAC5C,SAAS,CAACL,GAAG,CAACiD,IAAI;IAChC;IAEA,IAAIA,KAAKJ,KAAa,EAAE;QACtB,IAAI,CAACxC,SAAS,CAACL,GAAG,CAACiD,IAAI,GAAGJ;IAC5B;IAEA,IAAIN,SAAS;QACX,OAAO,IAAI,CAAClC,SAAS,CAACL,GAAG,CAACuC,MAAM;IAClC;IAEA,IAAIA,OAAOM,KAAa,EAAE;QACxB,IAAI,CAACxC,SAAS,CAACL,GAAG,CAACuC,MAAM,GAAGM;IAC9B;IAEA,IAAIM,WAAW;QACb,OAAO,IAAI,CAAC9C,SAAS,CAACL,GAAG,CAACmD,QAAQ;IACpC;IAEA,IAAIA,SAASN,KAAa,EAAE;QAC1B,IAAI,CAACxC,SAAS,CAACL,GAAG,CAACmD,QAAQ,GAAGN;IAChC;IAEA,IAAIO,WAAW;QACb,OAAO,IAAI,CAAC/C,SAAS,CAACL,GAAG,CAACoD,QAAQ;IACpC;IAEA,IAAIA,SAASP,KAAa,EAAE;QAC1B,IAAI,CAACxC,SAAS,CAACL,GAAG,CAACoD,QAAQ,GAAGP;IAChC;IAEA,IAAIjC,WAAW;QACb,OAAO,IAAI,CAACP,SAAS,CAACO,QAAQ;IAChC;IAEA,IAAIA,SAASiC,KAAa,EAAE;QAC1B,IAAI,CAACxC,SAAS,CAACO,QAAQ,GAAGiC,MAAMQ,UAAU,CAAC,OAAOR,QAAQ,CAAC,CAAC,EAAEA,OAAO;IACvE;IAEAS,WAAW;QACT,OAAO,IAAI,CAACN,IAAI;IAClB;IAEAO,SAAS;QACP,OAAO,IAAI,CAACP,IAAI;IAClB;IAEA,CAAC1C,OAAOkD,GAAG,CAAC,+BAA+B,GAAG;QAC5C,OAAO;YACLR,MAAM,IAAI,CAACA,IAAI;YACfE,QAAQ,IAAI,CAACA,MAAM;YACnBH,UAAU,IAAI,CAACA,QAAQ;YACvBK,UAAU,IAAI,CAACA,QAAQ;YACvBD,UAAU,IAAI,CAACA,QAAQ;YACvBP,MAAM,IAAI,CAACA,IAAI;YACfrB,UAAU,IAAI,CAACA,QAAQ;YACvBuB,MAAM,IAAI,CAACA,IAAI;YACf9B,UAAU,IAAI,CAACA,QAAQ;YACvBuB,QAAQ,IAAI,CAACA,MAAM;YACnBI,cAAc,IAAI,CAACA,YAAY;YAC/BM,MAAM,IAAI,CAACA,IAAI;QACjB;IACF;IAEAQ,QAAQ;QACN,OAAO,IAAI5D,QAAQM,OAAO,IAAI,GAAG,IAAI,CAACE,SAAS,CAACM,OAAO;IACzD;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8545</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/lib/constants.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { ServerRuntime } from '../types'</span><span class="s3">\n\n</span><span class="s1">export const TEXT_PLAIN_CONTENT_TYPE_HEADER = 'text/plain'</span><span class="s3">\n</span><span class="s1">export const HTML_CONTENT_TYPE_HEADER = 'text/html; charset=utf-8'</span><span class="s3">\n</span><span class="s1">export const JSON_CONTENT_TYPE_HEADER = 'application/json; charset=utf-8'</span><span class="s3">\n</span><span class="s1">export const NEXT_QUERY_PARAM_PREFIX = 'nxtP'</span><span class="s3">\n</span><span class="s1">export const NEXT_INTERCEPTION_MARKER_PREFIX = 'nxtI'</span><span class="s3">\n\n</span><span class="s1">export const MATCHED_PATH_HEADER = 'x-matched-path'</span><span class="s3">\n</span><span class="s1">export const PRERENDER_REVALIDATE_HEADER = 'x-prerender-revalidate'</span><span class="s3">\n</span><span class="s1">export const PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER =</span><span class="s3">\n  </span><span class="s1">'x-prerender-revalidate-if-generated'</span><span class="s3">\n\n</span><span class="s1">export const RSC_PREFETCH_SUFFIX = '.prefetch.rsc'</span><span class="s3">\n</span><span class="s1">export const RSC_SEGMENTS_DIR_SUFFIX = '.segments'</span><span class="s3">\n</span><span class="s1">export const RSC_SEGMENT_SUFFIX = '.segment.rsc'</span><span class="s3">\n</span><span class="s1">export const RSC_SUFFIX = '.rsc'</span><span class="s3">\n</span><span class="s1">export const ACTION_SUFFIX = '.action'</span><span class="s3">\n</span><span class="s1">export const NEXT_DATA_SUFFIX = '.json'</span><span class="s3">\n</span><span class="s1">export const NEXT_META_SUFFIX = '.meta'</span><span class="s3">\n</span><span class="s1">export const NEXT_BODY_SUFFIX = '.body'</span><span class="s3">\n\n</span><span class="s1">export const NEXT_CACHE_TAGS_HEADER = 'x-next-cache-tags'</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_REVALIDATED_TAGS_HEADER = 'x-next-revalidated-tags'</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER =</span><span class="s3">\n  </span><span class="s1">'x-next-revalidate-tag-token'</span><span class="s3">\n\n</span><span class="s1">export const NEXT_RESUME_HEADER = 'next-resume'</span><span class="s3">\n\n</span><span class="s1">// if these change make sure we update the related</span><span class="s3">\n</span><span class="s1">// documentation as well</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_TAG_MAX_ITEMS = 128</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_TAG_MAX_LENGTH = 256</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_SOFT_TAG_MAX_LENGTH = 1024</span><span class="s3">\n</span><span class="s1">export const NEXT_CACHE_IMPLICIT_TAG_ID = '_N_T_'</span><span class="s3">\n\n</span><span class="s1">// in seconds</span><span class="s3">\n</span><span class="s1">export const CACHE_ONE_YEAR = 31536000</span><span class="s3">\n\n</span><span class="s1">// in seconds, represents revalidate=false. I.e. never revaliate.</span><span class="s3">\n</span><span class="s1">// We use this value since it can be represented as a V8 SMI for optimal performance.</span><span class="s3">\n</span><span class="s1">// It can also be serialized as JSON if it ever leaks accidentally as an actual value.</span><span class="s3">\n</span><span class="s1">export const INFINITE_CACHE = 0xfffffffe</span><span class="s3">\n\n</span><span class="s1">// Patterns to detect middleware files</span><span class="s3">\n</span><span class="s1">export const MIDDLEWARE_FILENAME = 'middleware'</span><span class="s3">\n</span><span class="s1">export const MIDDLEWARE_LOCATION_REGEXP = `(?:src/)?${MIDDLEWARE_FILENAME}`</span><span class="s3">\n\n</span><span class="s1">// Pattern to detect instrumentation hooks file</span><span class="s3">\n</span><span class="s1">export const INSTRUMENTATION_HOOK_FILENAME = 'instrumentation'</span><span class="s3">\n\n</span><span class="s1">// Because on Windows absolute paths in the generated code can break because of numbers, eg 1 in the path,</span><span class="s3">\n</span><span class="s1">// we have to use a private alias</span><span class="s3">\n</span><span class="s1">export const PAGES_DIR_ALIAS = 'private-next-pages'</span><span class="s3">\n</span><span class="s1">export const DOT_NEXT_ALIAS = 'private-dot-next'</span><span class="s3">\n</span><span class="s1">export const ROOT_DIR_ALIAS = 'private-next-root-dir'</span><span class="s3">\n</span><span class="s1">export const APP_DIR_ALIAS = 'private-next-app-dir'</span><span class="s3">\n</span><span class="s1">export const RSC_MOD_REF_PROXY_ALIAS = 'private-next-rsc-mod-ref-proxy'</span><span class="s3">\n</span><span class="s1">export const RSC_ACTION_VALIDATE_ALIAS = 'private-next-rsc-action-validate'</span><span class="s3">\n</span><span class="s1">export const RSC_ACTION_PROXY_ALIAS = 'private-next-rsc-server-reference'</span><span class="s3">\n</span><span class="s1">export const RSC_CACHE_WRAPPER_ALIAS = 'private-next-rsc-cache-wrapper'</span><span class="s3">\n</span><span class="s1">export const RSC_DYNAMIC_IMPORT_WRAPPER_ALIAS =</span><span class="s3">\n  </span><span class="s1">'private-next-rsc-track-dynamic-import'</span><span class="s3">\n</span><span class="s1">export const RSC_ACTION_ENCRYPTION_ALIAS = 'private-next-rsc-action-encryption'</span><span class="s3">\n</span><span class="s1">export const RSC_ACTION_CLIENT_WRAPPER_ALIAS =</span><span class="s3">\n  </span><span class="s1">'private-next-rsc-action-client-wrapper'</span><span class="s3">\n\n</span><span class="s1">export const PUBLIC_DIR_MIDDLEWARE_CONFLICT = `You can not have a '_next' folder inside of your public folder. This conflicts with the internal '/_next' route. https://nextjs.org/docs/messages/public-next-folder-conflict`</span><span class="s3">\n\n</span><span class="s1">export const SSG_GET_INITIAL_PROPS_CONFLICT = `You can not use getInitialProps with getStaticProps. To use SSG, please remove your getInitialProps`</span><span class="s3">\n\n</span><span class="s1">export const SERVER_PROPS_GET_INIT_PROPS_CONFLICT = `You can not use getInitialProps with getServerSideProps. Please remove getInitialProps.`</span><span class="s3">\n\n</span><span class="s1">export const SERVER_PROPS_SSG_CONFLICT = `You can not use getStaticProps or getStaticPaths with getServerSideProps. To use SSG, please remove getServerSideProps`</span><span class="s3">\n\n</span><span class="s1">export const STATIC_STATUS_PAGE_GET_INITIAL_PROPS_ERROR = `can not have getInitialProps/getServerSideProps, https://nextjs.org/docs/messages/404-get-initial-props`</span><span class="s3">\n\n</span><span class="s1">export const SERVER_PROPS_EXPORT_ERROR = `pages with </span><span class="s3">\\</span><span class="s1">`getServerSideProps</span><span class="s3">\\</span><span class="s1">` can not be exported. See more info here: https://nextjs.org/docs/messages/gssp-export`</span><span class="s3">\n\n</span><span class="s1">export const GSP_NO_RETURNED_VALUE =</span><span class="s3">\n  </span><span class="s1">'Your `getStaticProps` function did not return an object. Did you forget to add a `return`?'</span><span class="s3">\n</span><span class="s1">export const GSSP_NO_RETURNED_VALUE =</span><span class="s3">\n  </span><span class="s1">'Your `getServerSideProps` function did not return an object. Did you forget to add a `return`?'</span><span class="s3">\n\n</span><span class="s1">export const UNSTABLE_REVALIDATE_RENAME_ERROR =</span><span class="s3">\n  </span><span class="s1">'The `unstable_revalidate` property is available for general use.</span><span class="s3">\\</span><span class="s1">n' +</span><span class="s3">\n  </span><span class="s1">'Please use `revalidate` instead.'</span><span class="s3">\n\n</span><span class="s1">export const GSSP_COMPONENT_MEMBER_ERROR = `can not be attached to a page's component and must be exported from the page. See more info here: https://nextjs.org/docs/messages/gssp-component-member`</span><span class="s3">\n\n</span><span class="s1">export const NON_STANDARD_NODE_ENV = `You are using a non-standard </span><span class="s3">\&quot;</span><span class="s1">NODE_ENV</span><span class="s3">\&quot; </span><span class="s1">value in your environment. This creates inconsistencies in the project and is strongly advised against. Read more: https://nextjs.org/docs/messages/non-standard-node-env`</span><span class="s3">\n\n</span><span class="s1">export const SSG_FALLBACK_EXPORT_ERROR = `Pages with </span><span class="s3">\\</span><span class="s1">`fallback</span><span class="s3">\\</span><span class="s1">` enabled in </span><span class="s3">\\</span><span class="s1">`getStaticPaths</span><span class="s3">\\</span><span class="s1">` can not be exported. See more info here: https://nextjs.org/docs/messages/ssg-fallback-true-export`</span><span class="s3">\n\n</span><span class="s1">export const ESLINT_DEFAULT_DIRS = ['app', 'pages', 'components', 'lib', 'src']</span><span class="s3">\n\n</span><span class="s1">export const SERVER_RUNTIME: Record&lt;string, ServerRuntime&gt; = {</span><span class="s3">\n  </span><span class="s1">edge: 'edge',</span><span class="s3">\n  </span><span class="s1">experimentalEdge: 'experimental-edge',</span><span class="s3">\n  </span><span class="s1">nodejs: 'nodejs',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* The names of the webpack layers. These layers are the primitives for the</span><span class="s3">\n </span><span class="s1">* webpack chunks.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">const WEBPACK_LAYERS_NAMES = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The layer for the shared code between the client and server bundles.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">shared: 'shared',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The layer for server-only runtime and picking up `react-server` export conditions.</span><span class="s3">\n   </span><span class="s1">* Including app router RSC pages and app router custom routes and metadata routes.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">reactServerComponents: 'rsc',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Server Side Rendering layer for app (ssr).</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">serverSideRendering: 'ssr',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The browser client bundle layer for actions.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">actionBrowser: 'action-browser',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The Node.js bundle layer for the API routes.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">apiNode: 'api-node',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The Edge Lite bundle layer for the API routes.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">apiEdge: 'api-edge',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The layer for the middleware code.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">middleware: 'middleware',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The layer for the instrumentation hooks.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">instrument: 'instrument',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The layer for assets on the edge.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">edgeAsset: 'edge-asset',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The browser client bundle layer for App directory.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">appPagesBrowser: 'app-pages-browser',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The browser client bundle layer for Pages directory.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pagesDirBrowser: 'pages-dir-browser',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The Edge Lite bundle layer for Pages directory.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pagesDirEdge: 'pages-dir-edge',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The Node.js bundle layer for Pages directory.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pagesDirNode: 'pages-dir-node',</span><span class="s3">\n</span><span class="s1">} as const</span><span class="s3">\n\n</span><span class="s1">export type WebpackLayerName =</span><span class="s3">\n  </span><span class="s1">(typeof WEBPACK_LAYERS_NAMES)[keyof typeof WEBPACK_LAYERS_NAMES]</span><span class="s3">\n\n</span><span class="s1">const WEBPACK_LAYERS = {</span><span class="s3">\n  </span><span class="s1">...WEBPACK_LAYERS_NAMES,</span><span class="s3">\n  </span><span class="s1">GROUP: {</span><span class="s3">\n    </span><span class="s1">builtinReact: [</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.reactServerComponents,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.actionBrowser,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n    </span><span class="s1">serverOnly: [</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.reactServerComponents,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.actionBrowser,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.instrument,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.middleware,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n    </span><span class="s1">neutralTarget: [</span><span class="s3">\n      </span><span class="s1">// pages api</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.apiNode,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.apiEdge,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n    </span><span class="s1">clientOnly: [</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.serverSideRendering,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.appPagesBrowser,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n    </span><span class="s1">bundled: [</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.reactServerComponents,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.actionBrowser,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.serverSideRendering,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.appPagesBrowser,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.shared,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.instrument,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.middleware,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n    </span><span class="s1">appPages: [</span><span class="s3">\n      </span><span class="s1">// app router pages and layouts</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.reactServerComponents,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.serverSideRendering,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.appPagesBrowser,</span><span class="s3">\n      </span><span class="s1">WEBPACK_LAYERS_NAMES.actionBrowser,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const WEBPACK_RESOURCE_QUERIES = {</span><span class="s3">\n  </span><span class="s1">edgeSSREntry: '__next_edge_ssr_entry__',</span><span class="s3">\n  </span><span class="s1">metadata: '__next_metadata__',</span><span class="s3">\n  </span><span class="s1">metadataRoute: '__next_metadata_route__',</span><span class="s3">\n  </span><span class="s1">metadataImageMeta: '__next_metadata_image_meta__',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export { WEBPACK_LAYERS, WEBPACK_RESOURCE_QUERIES }</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ACTION_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;APP_DIR_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;CACHE_ONE_YEAR&quot;</span><span class="s0">,</span><span class="s1">&quot;DOT_NEXT_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;ESLINT_DEFAULT_DIRS&quot;</span><span class="s0">,</span><span class="s1">&quot;GSP_NO_RETURNED_VALUE&quot;</span><span class="s0">,</span><span class="s1">&quot;GSSP_COMPONENT_MEMBER_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;GSSP_NO_RETURNED_VALUE&quot;</span><span class="s0">,</span><span class="s1">&quot;HTML_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;INFINITE_CACHE&quot;</span><span class="s0">,</span><span class="s1">&quot;INSTRUMENTATION_HOOK_FILENAME&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;MATCHED_PATH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;MIDDLEWARE_FILENAME&quot;</span><span class="s0">,</span><span class="s1">&quot;MIDDLEWARE_LOCATION_REGEXP&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_BODY_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_IMPLICIT_TAG_ID&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_REVALIDATED_TAGS_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_SOFT_TAG_MAX_LENGTH&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_TAGS_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_TAG_MAX_ITEMS&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_TAG_MAX_LENGTH&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_DATA_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_INTERCEPTION_MARKER_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_META_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_QUERY_PARAM_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RESUME_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NON_STANDARD_NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGES_DIR_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;PRERENDER_REVALIDATE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;PUBLIC_DIR_MIDDLEWARE_CONFLICT&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_DIR_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_ACTION_CLIENT_WRAPPER_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_ACTION_ENCRYPTION_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_ACTION_PROXY_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_ACTION_VALIDATE_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_CACHE_WRAPPER_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_DYNAMIC_IMPORT_WRAPPER_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_MOD_REF_PROXY_ALIAS&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_PREFETCH_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_SEGMENTS_DIR_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_SEGMENT_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_SUFFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_PROPS_EXPORT_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_PROPS_GET_INIT_PROPS_CONFLICT&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_PROPS_SSG_CONFLICT&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;SSG_FALLBACK_EXPORT_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;SSG_GET_INITIAL_PROPS_CONFLICT&quot;</span><span class="s0">,</span><span class="s1">&quot;STATIC_STATUS_PAGE_GET_INITIAL_PROPS_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;TEXT_PLAIN_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;UNSTABLE_REVALIDATE_RENAME_ERROR&quot;</span><span class="s0">,</span><span class="s1">&quot;WEBPACK_LAYERS&quot;</span><span class="s0">,</span><span class="s1">&quot;WEBPACK_RESOURCE_QUERIES&quot;</span><span class="s0">,</span><span class="s1">&quot;edge&quot;</span><span class="s0">,</span><span class="s1">&quot;experimentalEdge&quot;</span><span class="s0">,</span><span class="s1">&quot;nodejs&quot;</span><span class="s0">,</span><span class="s1">&quot;WEBPACK_LAYERS_NAMES&quot;</span><span class="s0">,</span><span class="s1">&quot;shared&quot;</span><span class="s0">,</span><span class="s1">&quot;reactServerComponents&quot;</span><span class="s0">,</span><span class="s1">&quot;serverSideRendering&quot;</span><span class="s0">,</span><span class="s1">&quot;actionBrowser&quot;</span><span class="s0">,</span><span class="s1">&quot;apiNode&quot;</span><span class="s0">,</span><span class="s1">&quot;apiEdge&quot;</span><span class="s0">,</span><span class="s1">&quot;middleware&quot;</span><span class="s0">,</span><span class="s1">&quot;instrument&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeAsset&quot;</span><span class="s0">,</span><span class="s1">&quot;appPagesBrowser&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesDirBrowser&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesDirEdge&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesDirNode&quot;</span><span class="s0">,</span><span class="s1">&quot;GROUP&quot;</span><span class="s0">,</span><span class="s1">&quot;builtinReact&quot;</span><span class="s0">,</span><span class="s1">&quot;serverOnly&quot;</span><span class="s0">,</span><span class="s1">&quot;neutralTarget&quot;</span><span class="s0">,</span><span class="s1">&quot;clientOnly&quot;</span><span class="s0">,</span><span class="s1">&quot;bundled&quot;</span><span class="s0">,</span><span class="s1">&quot;appPages&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeSSREntry&quot;</span><span class="s0">,</span><span class="s1">&quot;metadata&quot;</span><span class="s0">,</span><span class="s1">&quot;metadataRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;metadataImageMeta&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">8941</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/web/utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { OutgoingHttpHeaders } from 'http'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">NEXT_INTERCEPTION_MARKER_PREFIX,</span><span class="s3">\n  </span><span class="s1">NEXT_QUERY_PARAM_PREFIX,</span><span class="s3">\n</span><span class="s1">} from '../../lib/constants'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Converts a Node.js IncomingHttpHeaders object to a Headers object. Any</span><span class="s3">\n </span><span class="s1">* headers with multiple values will be joined with a comma and space. Any</span><span class="s3">\n </span><span class="s1">* headers that have an undefined value will be ignored and others will be</span><span class="s3">\n </span><span class="s1">* coerced to strings.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param nodeHeaders the headers object to convert</span><span class="s3">\n </span><span class="s1">* @returns the converted headers object</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function fromNodeOutgoingHttpHeaders(</span><span class="s3">\n  </span><span class="s1">nodeHeaders: OutgoingHttpHeaders</span><span class="s3">\n</span><span class="s1">): Headers {</span><span class="s3">\n  </span><span class="s1">const headers = new Headers()</span><span class="s3">\n  </span><span class="s1">for (let [key, value] of Object.entries(nodeHeaders)) {</span><span class="s3">\n    </span><span class="s1">const values = Array.isArray(value) ? value : [value]</span><span class="s3">\n    </span><span class="s1">for (let v of values) {</span><span class="s3">\n      </span><span class="s1">if (typeof v === 'undefined') continue</span><span class="s3">\n      </span><span class="s1">if (typeof v === 'number') {</span><span class="s3">\n        </span><span class="s1">v = v.toString()</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">headers.append(key, v)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return headers</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/*</span><span class="s3">\n  </span><span class="s1">Set-Cookie header field-values are sometimes comma joined in one string. This splits them without choking on commas</span><span class="s3">\n  </span><span class="s1">that are within a single set-cookie field-value, such as in the Expires portion.</span><span class="s3">\n  </span><span class="s1">This is uncommon, but explicitly allowed - see https://tools.ietf.org/html/rfc2616#section-4.2</span><span class="s3">\n  </span><span class="s1">Node.js does this for every header *except* set-cookie - see https://github.com/nodejs/node/blob/d5e363b77ebaf1caf67cd7528224b651c86815c1/lib/_http_incoming.js#L128</span><span class="s3">\n  </span><span class="s1">React Native's fetch does this for *every* header, including set-cookie.</span><span class="s3">\n  \n  </span><span class="s1">Based on: https://github.com/google/j2objc/commit/16820fdbc8f76ca0c33472810ce0cb03d20efe25</span><span class="s3">\n  </span><span class="s1">Credits to: https://github.com/tomball for original and https://github.com/chrusart for JavaScript implementation</span><span class="s3">\n</span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function splitCookiesString(cookiesString: string) {</span><span class="s3">\n  </span><span class="s1">var cookiesStrings = []</span><span class="s3">\n  </span><span class="s1">var pos = 0</span><span class="s3">\n  </span><span class="s1">var start</span><span class="s3">\n  </span><span class="s1">var ch</span><span class="s3">\n  </span><span class="s1">var lastComma</span><span class="s3">\n  </span><span class="s1">var nextStart</span><span class="s3">\n  </span><span class="s1">var cookiesSeparatorFound</span><span class="s3">\n\n  </span><span class="s1">function skipWhitespace() {</span><span class="s3">\n    </span><span class="s1">while (pos &lt; cookiesString.length &amp;&amp; /</span><span class="s3">\\</span><span class="s1">s/.test(cookiesString.charAt(pos))) {</span><span class="s3">\n      </span><span class="s1">pos += 1</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return pos &lt; cookiesString.length</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">function notSpecialChar() {</span><span class="s3">\n    </span><span class="s1">ch = cookiesString.charAt(pos)</span><span class="s3">\n\n    </span><span class="s1">return ch !== '=' &amp;&amp; ch !== ';' &amp;&amp; ch !== ','</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">while (pos &lt; cookiesString.length) {</span><span class="s3">\n    </span><span class="s1">start = pos</span><span class="s3">\n    </span><span class="s1">cookiesSeparatorFound = false</span><span class="s3">\n\n    </span><span class="s1">while (skipWhitespace()) {</span><span class="s3">\n      </span><span class="s1">ch = cookiesString.charAt(pos)</span><span class="s3">\n      </span><span class="s1">if (ch === ',') {</span><span class="s3">\n        </span><span class="s1">// ',' is a cookie separator if we have later first '=', not ';' or ','</span><span class="s3">\n        </span><span class="s1">lastComma = pos</span><span class="s3">\n        </span><span class="s1">pos += 1</span><span class="s3">\n\n        </span><span class="s1">skipWhitespace()</span><span class="s3">\n        </span><span class="s1">nextStart = pos</span><span class="s3">\n\n        </span><span class="s1">while (pos &lt; cookiesString.length &amp;&amp; notSpecialChar()) {</span><span class="s3">\n          </span><span class="s1">pos += 1</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// currently special character</span><span class="s3">\n        </span><span class="s1">if (pos &lt; cookiesString.length &amp;&amp; cookiesString.charAt(pos) === '=') {</span><span class="s3">\n          </span><span class="s1">// we found cookies separator</span><span class="s3">\n          </span><span class="s1">cookiesSeparatorFound = true</span><span class="s3">\n          </span><span class="s1">// pos is inside the next cookie, so back up and return it.</span><span class="s3">\n          </span><span class="s1">pos = nextStart</span><span class="s3">\n          </span><span class="s1">cookiesStrings.push(cookiesString.substring(start, lastComma))</span><span class="s3">\n          </span><span class="s1">start = pos</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">// in param ',' or param separator ';',</span><span class="s3">\n          </span><span class="s1">// we continue from that comma</span><span class="s3">\n          </span><span class="s1">pos = lastComma + 1</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">pos += 1</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (!cookiesSeparatorFound || pos &gt;= cookiesString.length) {</span><span class="s3">\n      </span><span class="s1">cookiesStrings.push(cookiesString.substring(start, cookiesString.length))</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return cookiesStrings</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Converts a Headers object to a Node.js OutgoingHttpHeaders object. This is</span><span class="s3">\n </span><span class="s1">* required to support the set-cookie header, which may have multiple values.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param headers the headers object to convert</span><span class="s3">\n </span><span class="s1">* @returns the converted headers object</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function toNodeOutgoingHttpHeaders(</span><span class="s3">\n  </span><span class="s1">headers: Headers</span><span class="s3">\n</span><span class="s1">): OutgoingHttpHeaders {</span><span class="s3">\n  </span><span class="s1">const nodeHeaders: OutgoingHttpHeaders = {}</span><span class="s3">\n  </span><span class="s1">const cookies: string[] = []</span><span class="s3">\n  </span><span class="s1">if (headers) {</span><span class="s3">\n    </span><span class="s1">for (const [key, value] of headers.entries()) {</span><span class="s3">\n      </span><span class="s1">if (key.toLowerCase() === 'set-cookie') {</span><span class="s3">\n        </span><span class="s1">// We may have gotten a comma joined string of cookies, or multiple</span><span class="s3">\n        </span><span class="s1">// set-cookie headers. We need to merge them into one header array</span><span class="s3">\n        </span><span class="s1">// to represent all the cookies.</span><span class="s3">\n        </span><span class="s1">cookies.push(...splitCookiesString(value))</span><span class="s3">\n        </span><span class="s1">nodeHeaders[key] = cookies.length === 1 ? cookies[0] : cookies</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">nodeHeaders[key] = value</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return nodeHeaders</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Validate the correctness of a user-provided URL.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function validateURL(url: string | URL): string {</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">return String(new URL(String(url)))</span><span class="s3">\n  </span><span class="s1">} catch (error: any) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`URL is malformed </span><span class="s3">\&quot;</span><span class="s1">${String(</span><span class="s3">\n        </span><span class="s1">url</span><span class="s3">\n      </span><span class="s1">)}</span><span class="s3">\&quot;</span><span class="s1">. Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,</span><span class="s3">\n      </span><span class="s1">{ cause: error }</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Normalizes `nxtP` and `nxtI` query param values to remove the prefix.</span><span class="s3">\n </span><span class="s1">* This function does not mutate the input key.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeNextQueryParam(key: string): null | string {</span><span class="s3">\n  </span><span class="s1">const prefixes = [NEXT_QUERY_PARAM_PREFIX, NEXT_INTERCEPTION_MARKER_PREFIX]</span><span class="s3">\n  </span><span class="s1">for (const prefix of prefixes) {</span><span class="s3">\n    </span><span class="s1">if (key !== prefix &amp;&amp; key.startsWith(prefix)) {</span><span class="s3">\n      </span><span class="s1">return key.substring(prefix.length)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;fromNodeOutgoingHttpHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeNextQueryParam&quot;</span><span class="s0">,</span><span class="s1">&quot;splitCookiesString&quot;</span><span class="s0">,</span><span class="s1">&quot;toNodeOutgoingHttpHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;validateURL&quot;</span><span class="s0">,</span><span class="s1">&quot;nodeHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;Headers&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;v&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;append&quot;</span><span class="s0">,</span><span class="s1">&quot;cookiesString&quot;</span><span class="s0">,</span><span class="s1">&quot;cookiesStrings&quot;</span><span class="s0">,</span><span class="s1">&quot;pos&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;ch&quot;</span><span class="s0">,</span><span class="s1">&quot;lastComma&quot;</span><span class="s0">,</span><span class="s1">&quot;nextStart&quot;</span><span class="s0">,</span><span class="s1">&quot;cookiesSeparatorFound&quot;</span><span class="s0">,</span><span class="s1">&quot;skipWhitespace&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;charAt&quot;</span><span class="s0">,</span><span class="s1">&quot;notSpecialChar&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;substring&quot;</span><span class="s0">,</span><span class="s1">&quot;cookies&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;cause&quot;</span><span class="s0">,</span><span class="s1">&quot;prefixes&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_QUERY_PARAM_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_INTERCEPTION_MARKER_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">9093</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/web/error.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export class PageSignatureError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor({ page }: { page: string }) {</span><span class="s3">\n    </span><span class="s1">super(`The middleware </span><span class="s3">\&quot;</span><span class="s1">${page}</span><span class="s3">\&quot; </span><span class="s1">accepts an async API directly with the form:</span><span class="s3">\n  \n  </span><span class="s1">export function middleware(request, event) {</span><span class="s3">\n    </span><span class="s1">return NextResponse.redirect('/new-location')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  \n  </span><span class="s1">Read more: https://nextjs.org/docs/messages/middleware-new-signature</span><span class="s3">\n  </span><span class="s1">`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class RemovedPageError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor() {</span><span class="s3">\n    </span><span class="s1">super(`The request.page has been deprecated in favour of </span><span class="s3">\\</span><span class="s1">`URLPattern</span><span class="s3">\\</span><span class="s1">`.</span><span class="s3">\n  </span><span class="s1">Read more: https://nextjs.org/docs/messages/middleware-request-page</span><span class="s3">\n  </span><span class="s1">`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class RemovedUAError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor() {</span><span class="s3">\n    </span><span class="s1">super(`The request.ua has been removed in favour of </span><span class="s3">\\</span><span class="s1">`userAgent</span><span class="s3">\\</span><span class="s1">` function.</span><span class="s3">\n  </span><span class="s1">Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent</span><span class="s3">\n  </span><span class="s1">`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;PageSignatureError&quot;</span><span class="s0">,</span><span class="s1">&quot;RemovedPageError&quot;</span><span class="s0">,</span><span class="s1">&quot;RemovedUAError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;IAAaA,kBAAkB,EAAA;eAAlBA;;IAaAC,gBAAgB,EAAA;eAAhBA;;IAQAC,cAAc,EAAA;eAAdA;;;AArBN,MAAMF,2BAA2BG;IACtCC,YAAY,EAAEC,IAAI,EAAoB,CAAE;QACtC,KAAK,CAAC,CAAC,gBAAgB,EAAEA,KAAK;;;;;;;EAOhC,CAAC;IACD;AACF;AAEO,MAAMJ,yBAAyBE;IACpCC,aAAc;QACZ,KAAK,CAAC,CAAC;;EAET,CAAC;IACD;AACF;AAEO,MAAMF,uBAAuBC;IAClCC,aAAc;QACZ,KAAK,CAAC,CAAC;;EAET,CAAC;IACD;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">9148</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/web/spec-extension/cookies.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export {</span><span class="s3">\n  </span><span class="s1">RequestCookies,</span><span class="s3">\n  </span><span class="s1">ResponseCookies,</span><span class="s3">\n  </span><span class="s1">stringifyCookie,</span><span class="s3">\n</span><span class="s1">} from 'next/dist/compiled/@edge-runtime/cookies'</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RequestCookies&quot;</span><span class="s0">,</span><span class="s1">&quot;ResponseCookies&quot;</span><span class="s0">,</span><span class="s1">&quot;stringifyCookie&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;IACEA,cAAc,EAAA;eAAdA,SAAAA,cAAc;;IACdC,eAAe,EAAA;eAAfA,SAAAA,eAAe;;IACfC,eAAe,EAAA;eAAfA,SAAAA,eAAe;;;yBACV&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">9178</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/web/spec-extension/request.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { I18NConfig } from '../../config-shared'</span><span class="s3">\n</span><span class="s1">import { NextURL } from '../next-url'</span><span class="s3">\n</span><span class="s1">import { toNodeOutgoingHttpHeaders, validateURL } from '../utils'</span><span class="s3">\n</span><span class="s1">import { RemovedUAError, RemovedPageError } from '../error'</span><span class="s3">\n</span><span class="s1">import { RequestCookies } from './cookies'</span><span class="s3">\n\n</span><span class="s1">export const INTERNALS = Symbol('internal request')</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This class extends the [Web `Request` API](https://developer.mozilla.org/docs/Web/API/Request) with additional convenience methods.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `NextRequest`](https://nextjs.org/docs/app/api-reference/functions/next-request)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class NextRequest extends Request {</span><span class="s3">\n  </span><span class="s1">/** @internal */</span><span class="s3">\n  </span><span class="s1">[INTERNALS]: {</span><span class="s3">\n    </span><span class="s1">cookies: RequestCookies</span><span class="s3">\n    </span><span class="s1">url: string</span><span class="s3">\n    </span><span class="s1">nextUrl: NextURL</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">constructor(input: URL | RequestInfo, init: RequestInit = {}) {</span><span class="s3">\n    </span><span class="s1">const url =</span><span class="s3">\n      </span><span class="s1">typeof input !== 'string' &amp;&amp; 'url' in input ? input.url : String(input)</span><span class="s3">\n\n    </span><span class="s1">validateURL(url)</span><span class="s3">\n\n    </span><span class="s1">// node Request instance requires duplex option when a body</span><span class="s3">\n    </span><span class="s1">// is present or it errors, we don't handle this for</span><span class="s3">\n    </span><span class="s1">// Request being passed in since it would have already</span><span class="s3">\n    </span><span class="s1">// errored if this wasn't configured</span><span class="s3">\n    </span><span class="s1">if (process.env.NEXT_RUNTIME !== 'edge') {</span><span class="s3">\n      </span><span class="s1">if (init.body &amp;&amp; init.duplex !== 'half') {</span><span class="s3">\n        </span><span class="s1">init.duplex = 'half'</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (input instanceof Request) super(input, init)</span><span class="s3">\n    </span><span class="s1">else super(url, init)</span><span class="s3">\n\n    </span><span class="s1">const nextUrl = new NextURL(url, {</span><span class="s3">\n      </span><span class="s1">headers: toNodeOutgoingHttpHeaders(this.headers),</span><span class="s3">\n      </span><span class="s1">nextConfig: init.nextConfig,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">this[INTERNALS] = {</span><span class="s3">\n      </span><span class="s1">cookies: new RequestCookies(this.headers),</span><span class="s3">\n      </span><span class="s1">nextUrl,</span><span class="s3">\n      </span><span class="s1">url: process.env.__NEXT_NO_MIDDLEWARE_URL_NORMALIZE</span><span class="s3">\n        </span><span class="s1">? url</span><span class="s3">\n        </span><span class="s1">: nextUrl.toString(),</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">[Symbol.for('edge-runtime.inspect.custom')]() {</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">cookies: this.cookies,</span><span class="s3">\n      </span><span class="s1">nextUrl: this.nextUrl,</span><span class="s3">\n      </span><span class="s1">url: this.url,</span><span class="s3">\n      </span><span class="s1">// rest of props come from Request</span><span class="s3">\n      </span><span class="s1">bodyUsed: this.bodyUsed,</span><span class="s3">\n      </span><span class="s1">cache: this.cache,</span><span class="s3">\n      </span><span class="s1">credentials: this.credentials,</span><span class="s3">\n      </span><span class="s1">destination: this.destination,</span><span class="s3">\n      </span><span class="s1">headers: Object.fromEntries(this.headers),</span><span class="s3">\n      </span><span class="s1">integrity: this.integrity,</span><span class="s3">\n      </span><span class="s1">keepalive: this.keepalive,</span><span class="s3">\n      </span><span class="s1">method: this.method,</span><span class="s3">\n      </span><span class="s1">mode: this.mode,</span><span class="s3">\n      </span><span class="s1">redirect: this.redirect,</span><span class="s3">\n      </span><span class="s1">referrer: this.referrer,</span><span class="s3">\n      </span><span class="s1">referrerPolicy: this.referrerPolicy,</span><span class="s3">\n      </span><span class="s1">signal: this.signal,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get cookies() {</span><span class="s3">\n    </span><span class="s1">return this[INTERNALS].cookies</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get nextUrl() {</span><span class="s3">\n    </span><span class="s1">return this[INTERNALS].nextUrl</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @deprecated</span><span class="s3">\n   </span><span class="s1">* `page` has been deprecated in favour of `URLPattern`.</span><span class="s3">\n   </span><span class="s1">* Read more: https://nextjs.org/docs/messages/middleware-request-page</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public get page() {</span><span class="s3">\n    </span><span class="s1">throw new RemovedPageError()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @deprecated</span><span class="s3">\n   </span><span class="s1">* `ua` has been removed in favour of </span><span class="s3">\\</span><span class="s1">`userAgent</span><span class="s3">\\</span><span class="s1">` function.</span><span class="s3">\n   </span><span class="s1">* Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public get ua() {</span><span class="s3">\n    </span><span class="s1">throw new RemovedUAError()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get url() {</span><span class="s3">\n    </span><span class="s1">return this[INTERNALS].url</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface RequestInit extends globalThis.RequestInit {</span><span class="s3">\n  </span><span class="s1">nextConfig?: {</span><span class="s3">\n    </span><span class="s1">basePath?: string</span><span class="s3">\n    </span><span class="s1">i18n?: I18NConfig | null</span><span class="s3">\n    </span><span class="s1">trailingSlash?: boolean</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">signal?: AbortSignal</span><span class="s3">\n  </span><span class="s1">// see https://github.com/whatwg/fetch/pull/1457</span><span class="s3">\n  </span><span class="s1">duplex?: 'half'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;INTERNALS&quot;</span><span class="s0">,</span><span class="s1">&quot;NextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;Request&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;input&quot;</span><span class="s0">,</span><span class="s1">&quot;init&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;validateURL&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;duplex&quot;</span><span class="s0">,</span><span class="s1">&quot;nextUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;NextURL&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;toNodeOutgoingHttpHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;cookies&quot;</span><span class="s0">,</span><span class="s1">&quot;RequestCookies&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_NO_MIDDLEWARE_URL_NORMALIZE&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;for&quot;</span><span class="s0">,</span><span class="s1">&quot;bodyUsed&quot;</span><span class="s0">,</span><span class="s1">&quot;cache&quot;</span><span class="s0">,</span><span class="s1">&quot;credentials&quot;</span><span class="s0">,</span><span class="s1">&quot;destination&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;fromEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;integrity&quot;</span><span class="s0">,</span><span class="s1">&quot;keepalive&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;mode&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;referrer&quot;</span><span class="s0">,</span><span class="s1">&quot;referrerPolicy&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;RemovedPageError&quot;</span><span class="s0">,</span><span class="s1">&quot;ua&quot;</span><span class="s0">,</span><span class="s1">&quot;RemovedUAError&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;IAMaA,SAAS,EAAA;eAATA;;IAOAC,WAAW,EAAA;eAAXA;;;yBAZW;uBAC+B;uBACN;yBAClB;AAExB,MAAMD,YAAYE,OAAO;AAOzB,MAAMD,oBAAoBE;IAQ/BC,YAAYC,KAAwB,EAAEC,OAAoB,CAAC,CAAC,CAAE;QAC5D,MAAMC,MACJ,OAAOF,UAAU,YAAY,SAASA,QAAQA,MAAME,GAAG,GAAGC,OAAOH;QAEnEI,CAAAA,GAAAA,OAAAA,WAAW,EAACF;QAEZ,2DAA2D;QAC3D,oDAAoD;QACpD,sDAAsD;QACtD,oCAAoC;QACpC,IAAIG,QAAQC,GAAG,CAACC,YAAY,KAAK,OAAQ;YACvC,IAAIN,KAAKO,IAAI,IAAIP,KAAKQ,MAAM,KAAK,QAAQ;gBACvCR,KAAKQ,MAAM,GAAG;YAChB;QACF;QAEA,IAAIT,iBAAiBF,SAAS,KAAK,CAACE,OAAOC;aACtC,KAAK,CAACC,KAAKD;QAEhB,MAAMS,UAAU,IAAIC,SAAAA,OAAO,CAACT,KAAK;YAC/BU,SAASC,CAAAA,GAAAA,OAAAA,yBAAyB,EAAC,IAAI,CAACD,OAAO;YAC/CE,YAAYb,KAAKa,UAAU;QAC7B;QACA,IAAI,CAACnB,UAAU,GAAG;YAChBoB,SAAS,IAAIC,SAAAA,cAAc,CAAC,IAAI,CAACJ,OAAO;YACxCF;YACAR,KAAKG,QAAQC,GAAG,CAACW,0BACbf,QAD+C,kBAE/CQ,QAAQQ,QAAQ;QACtB;IACF;IAEA,CAACrB,OAAOsB,GAAG,CAAC,+BAA+B,GAAG;QAC5C,OAAO;YACLJ,SAAS,IAAI,CAACA,OAAO;YACrBL,SAAS,IAAI,CAACA,OAAO;YACrBR,KAAK,IAAI,CAACA,GAAG;YACb,kCAAkC;YAClCkB,UAAU,IAAI,CAACA,QAAQ;YACvBC,OAAO,IAAI,CAACA,KAAK;YACjBC,aAAa,IAAI,CAACA,WAAW;YAC7BC,aAAa,IAAI,CAACA,WAAW;YAC7BX,SAASY,OAAOC,WAAW,CAAC,IAAI,CAACb,OAAO;YACxCc,WAAW,IAAI,CAACA,SAAS;YACzBC,WAAW,IAAI,CAACA,SAAS;YACzBC,QAAQ,IAAI,CAACA,MAAM;YACnBC,MAAM,IAAI,CAACA,IAAI;YACfC,UAAU,IAAI,CAACA,QAAQ;YACvBC,UAAU,IAAI,CAACA,QAAQ;YACvBC,gBAAgB,IAAI,CAACA,cAAc;YACnCC,QAAQ,IAAI,CAACA,MAAM;QACrB;IACF;IAEA,IAAWlB,UAAU;QACnB,OAAO,IAAI,CAACpB,UAAU,CAACoB,OAAO;IAChC;IAEA,IAAWL,UAAU;QACnB,OAAO,IAAI,CAACf,UAAU,CAACe,OAAO;IAChC;IAEA;;;;GAIC,GACD,IAAWwB,OAAO;QAChB,MAAM,IAAIC,OAAAA,gBAAgB;IAC5B;IAEA;;;;GAIC,GACD,IAAWC,KAAK;QACd,MAAM,IAAIC,OAAAA,cAAc;IAC1B;IAEA,IAAWnC,MAAM;QACf,OAAO,IAAI,CAACP,UAAU,CAACO,GAAG;IAC5B;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">9278</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/web/spec-extension/adapters/reflect.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export class ReflectAdapter {</span><span class="s3">\n  </span><span class="s1">static get&lt;T extends object&gt;(</span><span class="s3">\n    </span><span class="s1">target: T,</span><span class="s3">\n    </span><span class="s1">prop: string | symbol,</span><span class="s3">\n    </span><span class="s1">receiver: unknown</span><span class="s3">\n  </span><span class="s1">): any {</span><span class="s3">\n    </span><span class="s1">const value = Reflect.get(target, prop, receiver)</span><span class="s3">\n    </span><span class="s1">if (typeof value === 'function') {</span><span class="s3">\n      </span><span class="s1">return value.bind(target)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static set&lt;T extends object&gt;(</span><span class="s3">\n    </span><span class="s1">target: T,</span><span class="s3">\n    </span><span class="s1">prop: string | symbol,</span><span class="s3">\n    </span><span class="s1">value: any,</span><span class="s3">\n    </span><span class="s1">receiver: any</span><span class="s3">\n  </span><span class="s1">): boolean {</span><span class="s3">\n    </span><span class="s1">return Reflect.set(target, prop, value, receiver)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static has&lt;T extends object&gt;(target: T, prop: string | symbol): boolean {</span><span class="s3">\n    </span><span class="s1">return Reflect.has(target, prop)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static deleteProperty&lt;T extends object&gt;(</span><span class="s3">\n    </span><span class="s1">target: T,</span><span class="s3">\n    </span><span class="s1">prop: string | symbol</span><span class="s3">\n  </span><span class="s1">): boolean {</span><span class="s3">\n    </span><span class="s1">return Reflect.deleteProperty(target, prop)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ReflectAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;receiver&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;Reflect&quot;</span><span class="s0">,</span><span class="s1">&quot;bind&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;deleteProperty&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAAaA,kBAAAA;;;eAAAA;;;AAAN,MAAMA;IACX,OAAOC,IACLC,MAAS,EACTC,IAAqB,EACrBC,QAAiB,EACZ;QACL,MAAMC,QAAQC,QAAQL,GAAG,CAACC,QAAQC,MAAMC;QACxC,IAAI,OAAOC,UAAU,YAAY;YAC/B,OAAOA,MAAME,IAAI,CAACL;QACpB;QAEA,OAAOG;IACT;IAEA,OAAOG,IACLN,MAAS,EACTC,IAAqB,EACrBE,KAAU,EACVD,QAAa,EACJ;QACT,OAAOE,QAAQE,GAAG,CAACN,QAAQC,MAAME,OAAOD;IAC1C;IAEA,OAAOK,IAAsBP,MAAS,EAAEC,IAAqB,EAAW;QACtE,OAAOG,QAAQG,GAAG,CAACP,QAAQC;IAC7B;IAEA,OAAOO,eACLR,MAAS,EACTC,IAAqB,EACZ;QACT,OAAOG,QAAQI,cAAc,CAACR,QAAQC;IACxC;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">9309</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/web/spec-extension/response.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { stringifyCookie } from '../../web/spec-extension/cookies'</span><span class="s3">\n</span><span class="s1">import type { I18NConfig } from '../../config-shared'</span><span class="s3">\n</span><span class="s1">import { NextURL } from '../next-url'</span><span class="s3">\n</span><span class="s1">import { toNodeOutgoingHttpHeaders, validateURL } from '../utils'</span><span class="s3">\n</span><span class="s1">import { ReflectAdapter } from './adapters/reflect'</span><span class="s3">\n\n</span><span class="s1">import { ResponseCookies } from './cookies'</span><span class="s3">\n\n</span><span class="s1">const INTERNALS = Symbol('internal response')</span><span class="s3">\n</span><span class="s1">const REDIRECTS = new Set([301, 302, 303, 307, 308])</span><span class="s3">\n\n</span><span class="s1">function handleMiddlewareField(</span><span class="s3">\n  </span><span class="s1">init: MiddlewareResponseInit | undefined,</span><span class="s3">\n  </span><span class="s1">headers: Headers</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (init?.request?.headers) {</span><span class="s3">\n    </span><span class="s1">if (!(init.request.headers instanceof Headers)) {</span><span class="s3">\n      </span><span class="s1">throw new Error('request.headers must be an instance of Headers')</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const keys = []</span><span class="s3">\n    </span><span class="s1">for (const [key, value] of init.request.headers) {</span><span class="s3">\n      </span><span class="s1">headers.set('x-middleware-request-' + key, value)</span><span class="s3">\n      </span><span class="s1">keys.push(key)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">headers.set('x-middleware-override-headers', keys.join(','))</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This class extends the [Web `Response` API](https://developer.mozilla.org/docs/Web/API/Response) with additional convenience methods.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `NextResponse`](https://nextjs.org/docs/app/api-reference/functions/next-response)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class NextResponse&lt;Body = unknown&gt; extends Response {</span><span class="s3">\n  </span><span class="s1">[INTERNALS]: {</span><span class="s3">\n    </span><span class="s1">cookies: ResponseCookies</span><span class="s3">\n    </span><span class="s1">url?: NextURL</span><span class="s3">\n    </span><span class="s1">body?: Body</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">constructor(body?: BodyInit | null, init: ResponseInit = {}) {</span><span class="s3">\n    </span><span class="s1">super(body, init)</span><span class="s3">\n\n    </span><span class="s1">const headers = this.headers</span><span class="s3">\n    </span><span class="s1">const cookies = new ResponseCookies(headers)</span><span class="s3">\n\n    </span><span class="s1">const cookiesProxy = new Proxy(cookies, {</span><span class="s3">\n      </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n        </span><span class="s1">switch (prop) {</span><span class="s3">\n          </span><span class="s1">case 'delete':</span><span class="s3">\n          </span><span class="s1">case 'set': {</span><span class="s3">\n            </span><span class="s1">return (...args: [string, string]) =&gt; {</span><span class="s3">\n              </span><span class="s1">const result = Reflect.apply(target[prop], target, args)</span><span class="s3">\n              </span><span class="s1">const newHeaders = new Headers(headers)</span><span class="s3">\n\n              </span><span class="s1">if (result instanceof ResponseCookies) {</span><span class="s3">\n                </span><span class="s1">headers.set(</span><span class="s3">\n                  </span><span class="s1">'x-middleware-set-cookie',</span><span class="s3">\n                  </span><span class="s1">result</span><span class="s3">\n                    </span><span class="s1">.getAll()</span><span class="s3">\n                    </span><span class="s1">.map((cookie) =&gt; stringifyCookie(cookie))</span><span class="s3">\n                    </span><span class="s1">.join(',')</span><span class="s3">\n                </span><span class="s1">)</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n\n              </span><span class="s1">handleMiddlewareField(init, newHeaders)</span><span class="s3">\n              </span><span class="s1">return result</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">default:</span><span class="s3">\n            </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n\n    </span><span class="s1">this[INTERNALS] = {</span><span class="s3">\n      </span><span class="s1">cookies: cookiesProxy,</span><span class="s3">\n      </span><span class="s1">url: init.url</span><span class="s3">\n        </span><span class="s1">? new NextURL(init.url, {</span><span class="s3">\n            </span><span class="s1">headers: toNodeOutgoingHttpHeaders(headers),</span><span class="s3">\n            </span><span class="s1">nextConfig: init.nextConfig,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">[Symbol.for('edge-runtime.inspect.custom')]() {</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">cookies: this.cookies,</span><span class="s3">\n      </span><span class="s1">url: this.url,</span><span class="s3">\n      </span><span class="s1">// rest of props come from Response</span><span class="s3">\n      </span><span class="s1">body: this.body,</span><span class="s3">\n      </span><span class="s1">bodyUsed: this.bodyUsed,</span><span class="s3">\n      </span><span class="s1">headers: Object.fromEntries(this.headers),</span><span class="s3">\n      </span><span class="s1">ok: this.ok,</span><span class="s3">\n      </span><span class="s1">redirected: this.redirected,</span><span class="s3">\n      </span><span class="s1">status: this.status,</span><span class="s3">\n      </span><span class="s1">statusText: this.statusText,</span><span class="s3">\n      </span><span class="s1">type: this.type,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get cookies() {</span><span class="s3">\n    </span><span class="s1">return this[INTERNALS].cookies</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static json&lt;JsonBody&gt;(</span><span class="s3">\n    </span><span class="s1">body: JsonBody,</span><span class="s3">\n    </span><span class="s1">init?: ResponseInit</span><span class="s3">\n  </span><span class="s1">): NextResponse&lt;JsonBody&gt; {</span><span class="s3">\n    </span><span class="s1">const response: Response = Response.json(body, init)</span><span class="s3">\n    </span><span class="s1">return new NextResponse(response.body, response)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static redirect(url: string | NextURL | URL, init?: number | ResponseInit) {</span><span class="s3">\n    </span><span class="s1">const status = typeof init === 'number' ? init : init?.status ?? 307</span><span class="s3">\n    </span><span class="s1">if (!REDIRECTS.has(status)) {</span><span class="s3">\n      </span><span class="s1">throw new RangeError(</span><span class="s3">\n        </span><span class="s1">'Failed to execute </span><span class="s3">\&quot;</span><span class="s1">redirect</span><span class="s3">\&quot; </span><span class="s1">on </span><span class="s3">\&quot;</span><span class="s1">response</span><span class="s3">\&quot;</span><span class="s1">: Invalid status code'</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const initObj = typeof init === 'object' ? init : {}</span><span class="s3">\n    </span><span class="s1">const headers = new Headers(initObj?.headers)</span><span class="s3">\n    </span><span class="s1">headers.set('Location', validateURL(url))</span><span class="s3">\n\n    </span><span class="s1">return new NextResponse(null, {</span><span class="s3">\n      </span><span class="s1">...initObj,</span><span class="s3">\n      </span><span class="s1">headers,</span><span class="s3">\n      </span><span class="s1">status,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static rewrite(</span><span class="s3">\n    </span><span class="s1">destination: string | NextURL | URL,</span><span class="s3">\n    </span><span class="s1">init?: MiddlewareResponseInit</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">const headers = new Headers(init?.headers)</span><span class="s3">\n    </span><span class="s1">headers.set('x-middleware-rewrite', validateURL(destination))</span><span class="s3">\n\n    </span><span class="s1">handleMiddlewareField(init, headers)</span><span class="s3">\n    </span><span class="s1">return new NextResponse(null, { ...init, headers })</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static next(init?: MiddlewareResponseInit) {</span><span class="s3">\n    </span><span class="s1">const headers = new Headers(init?.headers)</span><span class="s3">\n    </span><span class="s1">headers.set('x-middleware-next', '1')</span><span class="s3">\n\n    </span><span class="s1">handleMiddlewareField(init, headers)</span><span class="s3">\n    </span><span class="s1">return new NextResponse(null, { ...init, headers })</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface ResponseInit extends globalThis.ResponseInit {</span><span class="s3">\n  </span><span class="s1">nextConfig?: {</span><span class="s3">\n    </span><span class="s1">basePath?: string</span><span class="s3">\n    </span><span class="s1">i18n?: I18NConfig</span><span class="s3">\n    </span><span class="s1">trailingSlash?: boolean</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">url?: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface ModifiedRequest {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If this is set, the request headers will be overridden with this value.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">headers?: Headers</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface MiddlewareResponseInit extends globalThis.ResponseInit {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* These fields will override the request from clients.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">request?: ModifiedRequest</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;NextResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;INTERNALS&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;REDIRECTS&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;handleMiddlewareField&quot;</span><span class="s0">,</span><span class="s1">&quot;init&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;Headers&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;Response&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;cookies&quot;</span><span class="s0">,</span><span class="s1">&quot;ResponseCookies&quot;</span><span class="s0">,</span><span class="s1">&quot;cookiesProxy&quot;</span><span class="s0">,</span><span class="s1">&quot;Proxy&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;receiver&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;Reflect&quot;</span><span class="s0">,</span><span class="s1">&quot;apply&quot;</span><span class="s0">,</span><span class="s1">&quot;newHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;getAll&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;cookie&quot;</span><span class="s0">,</span><span class="s1">&quot;stringifyCookie&quot;</span><span class="s0">,</span><span class="s1">&quot;ReflectAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;NextURL&quot;</span><span class="s0">,</span><span class="s1">&quot;toNodeOutgoingHttpHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;for&quot;</span><span class="s0">,</span><span class="s1">&quot;bodyUsed&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;fromEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;ok&quot;</span><span class="s0">,</span><span class="s1">&quot;redirected&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;statusText&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;json&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;RangeError&quot;</span><span class="s0">,</span><span class="s1">&quot;initObj&quot;</span><span class="s0">,</span><span class="s1">&quot;validateURL&quot;</span><span class="s0">,</span><span class="s1">&quot;rewrite&quot;</span><span class="s0">,</span><span class="s1">&quot;destination&quot;</span><span class="s0">,</span><span class="s1">&quot;next&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">9446</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/web/spec-extension/image-response.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* @deprecated ImageResponse moved from </span><span class="s3">\&quot;</span><span class="s1">next/server</span><span class="s3">\&quot; </span><span class="s1">to </span><span class="s3">\&quot;</span><span class="s1">next/og</span><span class="s3">\&quot; </span><span class="s1">since Next.js 14, please import from </span><span class="s3">\&quot;</span><span class="s1">next/og</span><span class="s3">\&quot; </span><span class="s1">instead.</span><span class="s3">\n </span><span class="s1">* Migration with codemods: https://nextjs.org/docs/app/building-your-application/upgrading/codemods#next-og-import</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function ImageResponse(): never {</span><span class="s3">\n  </span><span class="s1">throw new Error(</span><span class="s3">\n    </span><span class="s1">'ImageResponse moved from </span><span class="s3">\&quot;</span><span class="s1">next/server</span><span class="s3">\&quot; </span><span class="s1">to </span><span class="s3">\&quot;</span><span class="s1">next/og</span><span class="s3">\&quot; </span><span class="s1">since Next.js 14, please import from </span><span class="s3">\&quot;</span><span class="s1">next/og</span><span class="s3">\&quot; </span><span class="s1">instead'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ImageResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;CAGC;;;+BACeA,iBAAAA;;;eAAAA;;;AAAT,SAASA;IACd,MAAM,OAAA,cAEL,CAFK,IAAIC,MACR,+GADI,qBAAA;eAAA;oBAAA;sBAAA;IAEN;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">9468</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/compiled/ua-parser-js/ua-parser.js&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;(()=&gt;{var i={226:function(i,e){(function(o,a){</span><span class="s3">\&quot;</span><span class="s1">use strict</span><span class="s3">\&quot;</span><span class="s1">;var r=</span><span class="s3">\&quot;</span><span class="s1">1.0.35</span><span class="s3">\&quot;</span><span class="s1">,t=</span><span class="s3">\&quot;\&quot;</span><span class="s1">,n=</span><span class="s3">\&quot;</span><span class="s1">?</span><span class="s3">\&quot;</span><span class="s1">,s=</span><span class="s3">\&quot;</span><span class="s1">function</span><span class="s3">\&quot;</span><span class="s1">,b=</span><span class="s3">\&quot;</span><span class="s1">undefined</span><span class="s3">\&quot;</span><span class="s1">,w=</span><span class="s3">\&quot;</span><span class="s1">object</span><span class="s3">\&quot;</span><span class="s1">,l=</span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">,d=</span><span class="s3">\&quot;</span><span class="s1">major</span><span class="s3">\&quot;</span><span class="s1">,c=</span><span class="s3">\&quot;</span><span class="s1">model</span><span class="s3">\&quot;</span><span class="s1">,u=</span><span class="s3">\&quot;</span><span class="s1">name</span><span class="s3">\&quot;</span><span class="s1">,p=</span><span class="s3">\&quot;</span><span class="s1">type</span><span class="s3">\&quot;</span><span class="s1">,m=</span><span class="s3">\&quot;</span><span class="s1">vendor</span><span class="s3">\&quot;</span><span class="s1">,f=</span><span class="s3">\&quot;</span><span class="s1">version</span><span class="s3">\&quot;</span><span class="s1">,h=</span><span class="s3">\&quot;</span><span class="s1">architecture</span><span class="s3">\&quot;</span><span class="s1">,v=</span><span class="s3">\&quot;</span><span class="s1">console</span><span class="s3">\&quot;</span><span class="s1">,g=</span><span class="s3">\&quot;</span><span class="s1">mobile</span><span class="s3">\&quot;</span><span class="s1">,k=</span><span class="s3">\&quot;</span><span class="s1">tablet</span><span class="s3">\&quot;</span><span class="s1">,x=</span><span class="s3">\&quot;</span><span class="s1">smarttv</span><span class="s3">\&quot;</span><span class="s1">,_=</span><span class="s3">\&quot;</span><span class="s1">wearable</span><span class="s3">\&quot;</span><span class="s1">,y=</span><span class="s3">\&quot;</span><span class="s1">embedded</span><span class="s3">\&quot;</span><span class="s1">,q=350;var T=</span><span class="s3">\&quot;</span><span class="s1">Amazon</span><span class="s3">\&quot;</span><span class="s1">,S=</span><span class="s3">\&quot;</span><span class="s1">Apple</span><span class="s3">\&quot;</span><span class="s1">,z=</span><span class="s3">\&quot;</span><span class="s1">ASUS</span><span class="s3">\&quot;</span><span class="s1">,N=</span><span class="s3">\&quot;</span><span class="s1">BlackBerry</span><span class="s3">\&quot;</span><span class="s1">,A=</span><span class="s3">\&quot;</span><span class="s1">Browser</span><span class="s3">\&quot;</span><span class="s1">,C=</span><span class="s3">\&quot;</span><span class="s1">Chrome</span><span class="s3">\&quot;</span><span class="s1">,E=</span><span class="s3">\&quot;</span><span class="s1">Edge</span><span class="s3">\&quot;</span><span class="s1">,O=</span><span class="s3">\&quot;</span><span class="s1">Firefox</span><span class="s3">\&quot;</span><span class="s1">,U=</span><span class="s3">\&quot;</span><span class="s1">Google</span><span class="s3">\&quot;</span><span class="s1">,j=</span><span class="s3">\&quot;</span><span class="s1">Huawei</span><span class="s3">\&quot;</span><span class="s1">,P=</span><span class="s3">\&quot;</span><span class="s1">LG</span><span class="s3">\&quot;</span><span class="s1">,R=</span><span class="s3">\&quot;</span><span class="s1">Microsoft</span><span class="s3">\&quot;</span><span class="s1">,M=</span><span class="s3">\&quot;</span><span class="s1">Motorola</span><span class="s3">\&quot;</span><span class="s1">,B=</span><span class="s3">\&quot;</span><span class="s1">Opera</span><span class="s3">\&quot;</span><span class="s1">,V=</span><span class="s3">\&quot;</span><span class="s1">Samsung</span><span class="s3">\&quot;</span><span class="s1">,D=</span><span class="s3">\&quot;</span><span class="s1">Sharp</span><span class="s3">\&quot;</span><span class="s1">,I=</span><span class="s3">\&quot;</span><span class="s1">Sony</span><span class="s3">\&quot;</span><span class="s1">,W=</span><span class="s3">\&quot;</span><span class="s1">Viera</span><span class="s3">\&quot;</span><span class="s1">,F=</span><span class="s3">\&quot;</span><span class="s1">Xiaomi</span><span class="s3">\&quot;</span><span class="s1">,G=</span><span class="s3">\&quot;</span><span class="s1">Zebra</span><span class="s3">\&quot;</span><span class="s1">,H=</span><span class="s3">\&quot;</span><span class="s1">Facebook</span><span class="s3">\&quot;</span><span class="s1">,L=</span><span class="s3">\&quot;</span><span class="s1">Chromium OS</span><span class="s3">\&quot;</span><span class="s1">,Z=</span><span class="s3">\&quot;</span><span class="s1">Mac OS</span><span class="s3">\&quot;</span><span class="s1">;var extend=function(i,e){var o={};for(var a in i){if(e[a]&amp;&amp;e[a].length%2===0){o[a]=e[a].concat(i[a])}else{o[a]=i[a]}}return o},enumerize=function(i){var e={};for(var o=0;o&lt;i.length;o++){e[i[o].toUpperCase()]=i[o]}return e},has=function(i,e){return typeof i===l?lowerize(e).indexOf(lowerize(i))!==-1:false},lowerize=function(i){return i.toLowerCase()},majorize=function(i){return typeof i===l?i.replace(/[^</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]/g,t).split(</span><span class="s3">\&quot;</span><span class="s1">.</span><span class="s3">\&quot;</span><span class="s1">)[0]:a},trim=function(i,e){if(typeof i===l){i=i.replace(/^</span><span class="s3">\\</span><span class="s1">s</span><span class="s3">\\</span><span class="s1">s*/,t);return typeof e===b?i:i.substring(0,q)}};var rgxMapper=function(i,e){var o=0,r,t,n,b,l,d;while(o&lt;e.length&amp;&amp;!l){var c=e[o],u=e[o+1];r=t=0;while(r&lt;c.length&amp;&amp;!l){if(!c[r]){break}l=c[r++].exec(i);if(!!l){for(n=0;n&lt;u.length;n++){d=l[++t];b=u[n];if(typeof b===w&amp;&amp;b.length&gt;0){if(b.length===2){if(typeof b[1]==s){this[b[0]]=b[1].call(this,d)}else{this[b[0]]=b[1]}}else if(b.length===3){if(typeof b[1]===s&amp;&amp;!(b[1].exec&amp;&amp;b[1].test)){this[b[0]]=d?b[1].call(this,d,b[2]):a}else{this[b[0]]=d?d.replace(b[1],b[2]):a}}else if(b.length===4){this[b[0]]=d?b[3].call(this,d.replace(b[1],b[2])):a}}else{this[b]=d?d:a}}}}o+=2}},strMapper=function(i,e){for(var o in e){if(typeof e[o]===w&amp;&amp;e[o].length&gt;0){for(var r=0;r&lt;e[o].length;r++){if(has(e[o][r],i)){return o===n?a:o}}}else if(has(e[o],i)){return o===n?a:o}}return i};var $={</span><span class="s3">\&quot;</span><span class="s1">1.0</span><span class="s3">\&quot;</span><span class="s1">:</span><span class="s3">\&quot;</span><span class="s1">/8</span><span class="s3">\&quot;</span><span class="s1">,1.2:</span><span class="s3">\&quot;</span><span class="s1">/1</span><span class="s3">\&quot;</span><span class="s1">,1.3:</span><span class="s3">\&quot;</span><span class="s1">/3</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">2.0</span><span class="s3">\&quot;</span><span class="s1">:</span><span class="s3">\&quot;</span><span class="s1">/412</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">2.0.2</span><span class="s3">\&quot;</span><span class="s1">:</span><span class="s3">\&quot;</span><span class="s1">/416</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">2.0.3</span><span class="s3">\&quot;</span><span class="s1">:</span><span class="s3">\&quot;</span><span class="s1">/417</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">2.0.4</span><span class="s3">\&quot;</span><span class="s1">:</span><span class="s3">\&quot;</span><span class="s1">/419</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">?</span><span class="s3">\&quot;</span><span class="s1">:</span><span class="s3">\&quot;</span><span class="s1">/</span><span class="s3">\&quot;</span><span class="s1">},X={ME:</span><span class="s3">\&quot;</span><span class="s1">4.90</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">NT 3.11</span><span class="s3">\&quot;</span><span class="s1">:</span><span class="s3">\&quot;</span><span class="s1">NT3.51</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">NT 4.0</span><span class="s3">\&quot;</span><span class="s1">:</span><span class="s3">\&quot;</span><span class="s1">NT4.0</span><span class="s3">\&quot;</span><span class="s1">,2e3:</span><span class="s3">\&quot;</span><span class="s1">NT 5.0</span><span class="s3">\&quot;</span><span class="s1">,XP:[</span><span class="s3">\&quot;</span><span class="s1">NT 5.1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">NT 5.2</span><span class="s3">\&quot;</span><span class="s1">],Vista:</span><span class="s3">\&quot;</span><span class="s1">NT 6.0</span><span class="s3">\&quot;</span><span class="s1">,7:</span><span class="s3">\&quot;</span><span class="s1">NT 6.1</span><span class="s3">\&quot;</span><span class="s1">,8:</span><span class="s3">\&quot;</span><span class="s1">NT 6.2</span><span class="s3">\&quot;</span><span class="s1">,8.1:</span><span class="s3">\&quot;</span><span class="s1">NT 6.3</span><span class="s3">\&quot;</span><span class="s1">,10:[</span><span class="s3">\&quot;</span><span class="s1">NT 6.4</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot;</span><span class="s1">NT 10.0</span><span class="s3">\&quot;</span><span class="s1">],RT:</span><span class="s3">\&quot;</span><span class="s1">ARM</span><span class="s3">\&quot;</span><span class="s1">};var K={browser:[[/</span><span class="s3">\\</span><span class="s1">b(?:crmo|crios)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">Chrome</span><span class="s3">\&quot;</span><span class="s1">]],[/edg(?:e|ios|a)?</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">Edge</span><span class="s3">\&quot;</span><span class="s1">]],[/(opera mini)</span><span class="s3">\\</span><span class="s1">/([-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(opera [mobiletab]{3,6})</span><span class="s3">\\</span><span class="s1">b.+version</span><span class="s3">\\</span><span class="s1">/([-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(opera)(?:.+version</span><span class="s3">\\</span><span class="s1">/|[</span><span class="s3">\\</span><span class="s1">/ ]+)([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[u,f],[/opios[</span><span class="s3">\\</span><span class="s1">/ ]+([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,B+</span><span class="s3">\&quot; </span><span class="s1">Mini</span><span class="s3">\&quot;</span><span class="s1">]],[/</span><span class="s3">\\</span><span class="s1">bopr</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,B]],[/(kindle)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[</span><span class="s3">\\</span><span class="s1">/ ]?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i,/(avant |iemobile|slim)(?:browser)?[</span><span class="s3">\\</span><span class="s1">/ ]?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i,/(ba?idubrowser)[</span><span class="s3">\\</span><span class="s1">/ ]?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(?:ms|</span><span class="s3">\\</span><span class="s1">()(ie) ([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)</span><span class="s3">\\</span><span class="s1">/([-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(heytap|ovi)browser</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]+)/i,/(weibo)__([</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]+)/i],[u,f],[/(?:</span><span class="s3">\\</span><span class="s1">buc? ?browser|(?:juc.+)ucweb)[</span><span class="s3">\\</span><span class="s1">/ ]?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">UC</span><span class="s3">\&quot;</span><span class="s1">+A]],[/microm.+</span><span class="s3">\\</span><span class="s1">bqbcore</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/</span><span class="s3">\\</span><span class="s1">bqbcore</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+).+microm/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">WeChat(Win) Desktop</span><span class="s3">\&quot;</span><span class="s1">]],[/micromessenger</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">WeChat</span><span class="s3">\&quot;</span><span class="s1">]],[/konqueror</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">Konqueror</span><span class="s3">\&quot;</span><span class="s1">]],[/trident.+rv[: ]([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]{1,9})</span><span class="s3">\\</span><span class="s1">b.+like gecko/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">IE</span><span class="s3">\&quot;</span><span class="s1">]],[/ya(?:search)?browser</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">Yandex</span><span class="s3">\&quot;</span><span class="s1">]],[/(avast|avg)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[[u,/(.+)/,</span><span class="s3">\&quot;</span><span class="s1">$1 Secure </span><span class="s3">\&quot;</span><span class="s1">+A],f],[/</span><span class="s3">\\</span><span class="s1">bfocus</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,O+</span><span class="s3">\&quot; </span><span class="s1">Focus</span><span class="s3">\&quot;</span><span class="s1">]],[/</span><span class="s3">\\</span><span class="s1">bopt</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,B+</span><span class="s3">\&quot; </span><span class="s1">Touch</span><span class="s3">\&quot;</span><span class="s1">]],[/coc_coc</span><span class="s3">\\</span><span class="s1">w+</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">Coc Coc</span><span class="s3">\&quot;</span><span class="s1">]],[/dolfin</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">Dolphin</span><span class="s3">\&quot;</span><span class="s1">]],[/coast</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,B+</span><span class="s3">\&quot; </span><span class="s1">Coast</span><span class="s3">\&quot;</span><span class="s1">]],[/miuibrowser</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">MIUI </span><span class="s3">\&quot;</span><span class="s1">+A]],[/fxios</span><span class="s3">\\</span><span class="s1">/([-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,O]],[/</span><span class="s3">\\</span><span class="s1">bqihu|(qi?ho?o?|360)browser/i],[[u,</span><span class="s3">\&quot;</span><span class="s1">360 </span><span class="s3">\&quot;</span><span class="s1">+A]],[/(oculus|samsung|sailfish|huawei)browser</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[[u,/(.+)/,</span><span class="s3">\&quot;</span><span class="s1">$1 </span><span class="s3">\&quot;</span><span class="s1">+A],f],[/(comodo_dragon)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[[u,/_/g,</span><span class="s3">\&quot; \&quot;</span><span class="s1">],f],[/(electron)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+) safari/i,/(tesla)(?: qtcarbrowser|</span><span class="s3">\\</span><span class="s1">/(20</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.[-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[</span><span class="s3">\\</span><span class="s1">/ ]?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[u,f],[/(metasr)[</span><span class="s3">\\</span><span class="s1">/ ]?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(lbbrowser)/i,/</span><span class="s3">\\</span><span class="s1">[(linkedin)app</span><span class="s3">\\</span><span class="s1">]/i],[u],[/((?:fban</span><span class="s3">\\</span><span class="s1">/fbios|fb_iab</span><span class="s3">\\</span><span class="s1">/fb4a)(?!.+fbav)|;fbav</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+);)/i],[[u,H],f],[/(kakao(?:talk|story))[</span><span class="s3">\\</span><span class="s1">/ ]([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(naver)</span><span class="s3">\\</span><span class="s1">(.*?(</span><span class="s3">\\</span><span class="s1">d+</span><span class="s3">\\</span><span class="s1">.[</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+).*</span><span class="s3">\\</span><span class="s1">)/i,/safari (line)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/</span><span class="s3">\\</span><span class="s1">b(line)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)</span><span class="s3">\\</span><span class="s1">/iab/i,/(chromium|instagram)[</span><span class="s3">\\</span><span class="s1">/ ]([-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[u,f],[/</span><span class="s3">\\</span><span class="s1">bgsa</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+) .*safari</span><span class="s3">\\</span><span class="s1">//i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">GSA</span><span class="s3">\&quot;</span><span class="s1">]],[/musical_ly(?:.+app_?version</span><span class="s3">\\</span><span class="s1">/|_)([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">TikTok</span><span class="s3">\&quot;</span><span class="s1">]],[/headlesschrome(?:</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)| )/i],[f,[u,C+</span><span class="s3">\&quot; </span><span class="s1">Headless</span><span class="s3">\&quot;</span><span class="s1">]],[/ wv</span><span class="s3">\\</span><span class="s1">).+(chrome)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[[u,C+</span><span class="s3">\&quot; </span><span class="s1">WebView</span><span class="s3">\&quot;</span><span class="s1">],f],[/droid.+ version</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)</span><span class="s3">\\</span><span class="s1">b.+(?:mobile safari|safari)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">Android </span><span class="s3">\&quot;</span><span class="s1">+A]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)</span><span class="s3">\\</span><span class="s1">/v?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[u,f],[/version</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.</span><span class="s3">\\</span><span class="s1">,]+) .*mobile</span><span class="s3">\\</span><span class="s1">/</span><span class="s3">\\</span><span class="s1">w+ (safari)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">Mobile Safari</span><span class="s3">\&quot;</span><span class="s1">]],[/version</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w(</span><span class="s3">\\</span><span class="s1">.|</span><span class="s3">\\</span><span class="s1">,)]+) .*(mobile ?safari|safari)/i],[f,u],[/webkit.+?(mobile ?safari|safari)(</span><span class="s3">\\</span><span class="s1">/[</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[u,[f,strMapper,$]],[/(webkit|khtml)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[u,f],[/(navigator|netscape</span><span class="s3">\\</span><span class="s1">d?)</span><span class="s3">\\</span><span class="s1">/([-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[[u,</span><span class="s3">\&quot;</span><span class="s1">Netscape</span><span class="s3">\&quot;</span><span class="s1">],f],[/mobile vr; rv:([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)</span><span class="s3">\\</span><span class="s1">).+firefox/i],[f,[u,O+</span><span class="s3">\&quot; </span><span class="s1">Reality</span><span class="s3">\&quot;</span><span class="s1">]],[/ekiohf.+(flow)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[</span><span class="s3">\\</span><span class="s1">/ ]?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.</span><span class="s3">\\</span><span class="s1">+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)</span><span class="s3">\\</span><span class="s1">/([-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)$/i,/(firefox)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(mozilla)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+) .+rv</span><span class="s3">\\</span><span class="s1">:.+gecko</span><span class="s3">\\</span><span class="s1">/</span><span class="s3">\\</span><span class="s1">d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[</span><span class="s3">\\</span><span class="s1">. ]?browser)[-</span><span class="s3">\\</span><span class="s1">/ ]?v?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(links) </span><span class="s3">\\</span><span class="s1">(([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/panasonic;(viera)/i],[u,f],[/(cobalt)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[u,[f,/master.|lts./,</span><span class="s3">\&quot;\&quot;</span><span class="s1">]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;</span><span class="s3">\\</span><span class="s1">)]/i],[[h,</span><span class="s3">\&quot;</span><span class="s1">amd64</span><span class="s3">\&quot;</span><span class="s1">]],[/(ia32(?=;))/i],[[h,lowerize]],[/((?:i[346]|x)86)[;</span><span class="s3">\\</span><span class="s1">)]/i],[[h,</span><span class="s3">\&quot;</span><span class="s1">ia32</span><span class="s3">\&quot;</span><span class="s1">]],[/</span><span class="s3">\\</span><span class="s1">b(aarch64|arm(v?8e?l?|_?64))</span><span class="s3">\\</span><span class="s1">b/i],[[h,</span><span class="s3">\&quot;</span><span class="s1">arm64</span><span class="s3">\&quot;</span><span class="s1">]],[/</span><span class="s3">\\</span><span class="s1">b(arm(?:v[67])?ht?n?[fl]p?)</span><span class="s3">\\</span><span class="s1">b/i],[[h,</span><span class="s3">\&quot;</span><span class="s1">armhf</span><span class="s3">\&quot;</span><span class="s1">]],[/windows (ce|mobile); ppc;/i],[[h,</span><span class="s3">\&quot;</span><span class="s1">arm</span><span class="s3">\&quot;</span><span class="s1">]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|</span><span class="s3">\\</span><span class="s1">))/i],[[h,/ower/,t,lowerize]],[/(sun4</span><span class="s3">\\</span><span class="s1">w)[;</span><span class="s3">\\</span><span class="s1">)]/i],[[h,</span><span class="s3">\&quot;</span><span class="s1">sparc</span><span class="s3">\&quot;</span><span class="s1">]],[/((?:avr32|ia64(?=;))|68k(?=</span><span class="s3">\\</span><span class="s1">))|</span><span class="s3">\\</span><span class="s1">barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?</span><span class="s3">\\</span><span class="s1">b|pa-risc)/i],[[h,lowerize]]],device:[[/</span><span class="s3">\\</span><span class="s1">b(sch-i[89]0</span><span class="s3">\\</span><span class="s1">d|shw-m380s|sm-[ptx]</span><span class="s3">\\</span><span class="s1">w{2,4}|gt-[pn]</span><span class="s3">\\</span><span class="s1">d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[m,V],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b((?:s[cgp]h|gt|sm)-</span><span class="s3">\\</span><span class="s1">w+|sc[g-]?[</span><span class="s3">\\</span><span class="s1">d]+a?|galaxy nexus)/i,/samsung[- ]([-</span><span class="s3">\\</span><span class="s1">w]+)/i,/sec-(sgh</span><span class="s3">\\</span><span class="s1">w+)/i],[c,[m,V],[p,g]],[/(?:</span><span class="s3">\\</span><span class="s1">/|</span><span class="s3">\\</span><span class="s1">()(ip(?:hone|od)[</span><span class="s3">\\</span><span class="s1">w, ]*)(?:</span><span class="s3">\\</span><span class="s1">/|;)/i],[c,[m,S],[p,g]],[/</span><span class="s3">\\</span><span class="s1">((ipad);[-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">),; ]+apple/i,/applecoremedia</span><span class="s3">\\</span><span class="s1">/[</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+ </span><span class="s3">\\</span><span class="s1">((ipad)/i,/</span><span class="s3">\\</span><span class="s1">b(ipad)</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">d?,</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">d?[;</span><span class="s3">\\</span><span class="s1">]].+ios/i],[c,[m,S],[p,k]],[/(macintosh);/i],[c,[m,S]],[/</span><span class="s3">\\</span><span class="s1">b(sh-?[altvz]?</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">d[a-ekm]?)/i],[c,[m,D],[p,g]],[/</span><span class="s3">\\</span><span class="s1">b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]</span><span class="s3">\\</span><span class="s1">d{2})</span><span class="s3">\\</span><span class="s1">b(?!.+d</span><span class="s3">\\</span><span class="s1">/s)/i],[c,[m,j],[p,k]],[/(?:huawei|honor)([-</span><span class="s3">\\</span><span class="s1">w ]+)[;</span><span class="s3">\\</span><span class="s1">)]/i,/</span><span class="s3">\\</span><span class="s1">b(nexus 6p|</span><span class="s3">\\</span><span class="s1">w{2,4}e?-[atu]?[ln][</span><span class="s3">\\</span><span class="s1">dx][012359c][adn]?)</span><span class="s3">\\</span><span class="s1">b(?!.+d</span><span class="s3">\\</span><span class="s1">/s)/i],[c,[m,j],[p,g]],[/</span><span class="s3">\\</span><span class="s1">b(poco[</span><span class="s3">\\</span><span class="s1">w ]+)(?: bui|</span><span class="s3">\\</span><span class="s1">))/i,/</span><span class="s3">\\</span><span class="s1">b; (</span><span class="s3">\\</span><span class="s1">w+) build</span><span class="s3">\\</span><span class="s1">/hm</span><span class="s3">\\</span><span class="s1">1/i,/</span><span class="s3">\\</span><span class="s1">b(hm[-_ ]?note?[_ ]?(?:</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">w)?) bui/i,/</span><span class="s3">\\</span><span class="s1">b(redmi[</span><span class="s3">\\</span><span class="s1">-_ ]?(?:note|k)?[</span><span class="s3">\\</span><span class="s1">w_ ]+)(?: bui|</span><span class="s3">\\</span><span class="s1">))/i,/</span><span class="s3">\\</span><span class="s1">b(mi[-_ ]?(?:a</span><span class="s3">\\</span><span class="s1">d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:</span><span class="s3">\\</span><span class="s1">d?</span><span class="s3">\\</span><span class="s1">w?)[_ ]?(?:plus|se|lite)?)(?: bui|</span><span class="s3">\\</span><span class="s1">))/i],[[c,/_/g,</span><span class="s3">\&quot; \&quot;</span><span class="s1">],[m,F],[p,g]],[/</span><span class="s3">\\</span><span class="s1">b(mi[-_ ]?(?:pad)(?:[</span><span class="s3">\\</span><span class="s1">w_ ]+))(?: bui|</span><span class="s3">\\</span><span class="s1">))/i],[[c,/_/g,</span><span class="s3">\&quot; \&quot;</span><span class="s1">],[m,F],[p,k]],[/; (</span><span class="s3">\\</span><span class="s1">w+) bui.+ oppo/i,/</span><span class="s3">\\</span><span class="s1">b(cph[12]</span><span class="s3">\\</span><span class="s1">d{3}|p(?:af|c[al]|d</span><span class="s3">\\</span><span class="s1">w|e[ar])[mt]</span><span class="s3">\\</span><span class="s1">d0|x9007|a101op)</span><span class="s3">\\</span><span class="s1">b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">OPPO</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/vivo (</span><span class="s3">\\</span><span class="s1">w+)(?: bui|</span><span class="s3">\\</span><span class="s1">))/i,/</span><span class="s3">\\</span><span class="s1">b(v[12]</span><span class="s3">\\</span><span class="s1">d{3}</span><span class="s3">\\</span><span class="s1">w?[at])(?: bui|;)/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Vivo</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/</span><span class="s3">\\</span><span class="s1">b(rmx[12]</span><span class="s3">\\</span><span class="s1">d{3})(?: bui|;|</span><span class="s3">\\</span><span class="s1">))/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Realme</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/</span><span class="s3">\\</span><span class="s1">b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)</span><span class="s3">\\</span><span class="s1">b[</span><span class="s3">\\</span><span class="s1">w ]+build</span><span class="s3">\\</span><span class="s1">//i,/</span><span class="s3">\\</span><span class="s1">bmot(?:orola)?[- ](</span><span class="s3">\\</span><span class="s1">w*)/i,/((?:moto[</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">(</span><span class="s3">\\</span><span class="s1">) ]+|xt</span><span class="s3">\\</span><span class="s1">d{3,4}|nexus 6)(?= bui|</span><span class="s3">\\</span><span class="s1">)))/i],[c,[m,M],[p,g]],[/</span><span class="s3">\\</span><span class="s1">b(mz60</span><span class="s3">\\</span><span class="s1">d|xoom[2 ]{0,2}) build</span><span class="s3">\\</span><span class="s1">//i],[c,[m,M],[p,k]],[/((?=lg)?[vl]k</span><span class="s3">\\</span><span class="s1">-?</span><span class="s3">\\</span><span class="s1">d{3}) bui| 3</span><span class="s3">\\</span><span class="s1">.[-</span><span class="s3">\\</span><span class="s1">w; ]{10}lg?-([06cv9]{3,4})/i],[c,[m,P],[p,k]],[/(lm(?:-?f100[nv]?|-[</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)(?= bui|</span><span class="s3">\\</span><span class="s1">))|nexus [45])/i,/</span><span class="s3">\\</span><span class="s1">blg[-e;</span><span class="s3">\\</span><span class="s1">/ ]+((?!browser|netcast|android tv)</span><span class="s3">\\</span><span class="s1">w+)/i,/</span><span class="s3">\\</span><span class="s1">blg-?([</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">w]+) bui/i],[c,[m,P],[p,g]],[/(ideatab[-</span><span class="s3">\\</span><span class="s1">w ]+)/i,/lenovo ?(s[56]000[-</span><span class="s3">\\</span><span class="s1">w]+|tab(?:[</span><span class="s3">\\</span><span class="s1">w ]+)|yt[-</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">w]{6}|tb[-</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">w]{6})/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Lenovo</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/(?:maemo|nokia).*(n900|lumia </span><span class="s3">\\</span><span class="s1">d+)/i,/nokia[-_ ]?([-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i],[[c,/_/g,</span><span class="s3">\&quot; \&quot;</span><span class="s1">],[m,</span><span class="s3">\&quot;</span><span class="s1">Nokia</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/(pixel c)</span><span class="s3">\\</span><span class="s1">b/i],[c,[m,U],[p,k]],[/droid.+; (pixel[</span><span class="s3">\\</span><span class="s1">daxl ]{0,6})(?: bui|</span><span class="s3">\\</span><span class="s1">))/i],[c,[m,U],[p,g]],[/droid.+ (a?</span><span class="s3">\\</span><span class="s1">d[0-2]{2}so|[c-g]</span><span class="s3">\\</span><span class="s1">d{4}|so[-gl]</span><span class="s3">\\</span><span class="s1">w+|xq-a</span><span class="s3">\\</span><span class="s1">w[4-7][12])(?= bui|</span><span class="s3">\\</span><span class="s1">).+chrome</span><span class="s3">\\</span><span class="s1">/(?![1-6]{0,1}</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.))/i],[c,[m,I],[p,g]],[/sony tablet [ps]/i,/</span><span class="s3">\\</span><span class="s1">b(?:sony)?sgp</span><span class="s3">\\</span><span class="s1">w+(?: bui|</span><span class="s3">\\</span><span class="s1">))/i],[[c,</span><span class="s3">\&quot;</span><span class="s1">Xperia Tablet</span><span class="s3">\&quot;</span><span class="s1">],[m,I],[p,k]],[/ (kb2005|in20[12]5|be20[12][59])</span><span class="s3">\\</span><span class="s1">b/i,/(?:one)?(?:plus)? (a</span><span class="s3">\\</span><span class="s1">d0</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">d)(?: b|</span><span class="s3">\\</span><span class="s1">))/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">OnePlus</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|</span><span class="s3">\\</span><span class="s1">))/i,/(kf[a-z]+)( bui|</span><span class="s3">\\</span><span class="s1">)).+silk</span><span class="s3">\\</span><span class="s1">//i],[c,[m,T],[p,k]],[/((?:sd|kf)[0349hijorstuw]+)( bui|</span><span class="s3">\\</span><span class="s1">)).+silk</span><span class="s3">\\</span><span class="s1">//i],[[c,/(.+)/g,</span><span class="s3">\&quot;</span><span class="s1">Fire Phone $1</span><span class="s3">\&quot;</span><span class="s1">],[m,T],[p,g]],[/(playbook);[-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">),; ]+(rim)/i],[c,m,[p,k]],[/</span><span class="s3">\\</span><span class="s1">b((?:bb[a-f]|st[hv])100-</span><span class="s3">\\</span><span class="s1">d)/i,/</span><span class="s3">\\</span><span class="s1">(bb10; (</span><span class="s3">\\</span><span class="s1">w+)/i],[c,[m,N],[p,g]],[/(?:</span><span class="s3">\\</span><span class="s1">b|asus_)(transfo[prime ]{4,10} </span><span class="s3">\\</span><span class="s1">w+|eeepc|slider </span><span class="s3">\\</span><span class="s1">w+|nexus 7|padfone|p00[cj])/i],[c,[m,z],[p,k]],[/ (z[bes]6[027][012][km][ls]|zenfone </span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">w?)</span><span class="s3">\\</span><span class="s1">b/i],[c,[m,z],[p,g]],[/(nexus 9)/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">HTC</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/(htc)[-;_ ]{1,2}([</span><span class="s3">\\</span><span class="s1">w ]+(?=</span><span class="s3">\\</span><span class="s1">)| bui)|</span><span class="s3">\\</span><span class="s1">w+)/i,/(zte)[- ]([</span><span class="s3">\\</span><span class="s1">w ]+?)(?: bui|</span><span class="s3">\\</span><span class="s1">/|</span><span class="s3">\\</span><span class="s1">))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|</span><span class="s3">\\</span><span class="s1">.))|sony(?!-bra))[-_ ]?([-</span><span class="s3">\\</span><span class="s1">w]*)/i],[m,[c,/_/g,</span><span class="s3">\&quot; \&quot;</span><span class="s1">],[p,g]],[/droid.+; ([ab][1-7]-?[0178a]</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">d?)/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Acer</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/droid.+; (m[1-5] note) bui/i,/</span><span class="s3">\\</span><span class="s1">bmz-([-</span><span class="s3">\\</span><span class="s1">w]{2,})/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Meizu</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/(blackberry|benq|palm(?=</span><span class="s3">\\</span><span class="s1">-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-</span><span class="s3">\\</span><span class="s1">w]*)/i,/(hp) ([</span><span class="s3">\\</span><span class="s1">w ]+</span><span class="s3">\\</span><span class="s1">w)/i,/(asus)-?(</span><span class="s3">\\</span><span class="s1">w+)/i,/(microsoft); (lumia[</span><span class="s3">\\</span><span class="s1">w ]+)/i,/(lenovo)[-_ ]?([-</span><span class="s3">\\</span><span class="s1">w]+)/i,/(jolla)/i,/(oppo) ?([</span><span class="s3">\\</span><span class="s1">w ]+) bui/i],[m,c,[p,g]],[/(kobo)</span><span class="s3">\\</span><span class="s1">s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(nook)[</span><span class="s3">\\</span><span class="s1">w ]+build</span><span class="s3">\\</span><span class="s1">/(</span><span class="s3">\\</span><span class="s1">w+)/i,/(dell) (strea[kpr</span><span class="s3">\\</span><span class="s1">d ]*[</span><span class="s3">\\</span><span class="s1">dko])/i,/(le[- ]+pan)[- ]+(</span><span class="s3">\\</span><span class="s1">w{1,9}) bui/i,/(trinity)[- ]*(t</span><span class="s3">\\</span><span class="s1">d{3}) bui/i,/(gigaset)[- ]+(q</span><span class="s3">\\</span><span class="s1">w{1,9}) bui/i,/(vodafone) ([</span><span class="s3">\\</span><span class="s1">w ]+)(?:</span><span class="s3">\\</span><span class="s1">)| bui)/i],[m,c,[p,k]],[/(surface duo)/i],[c,[m,R],[p,k]],[/droid [</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]+; (fp</span><span class="s3">\\</span><span class="s1">du?)(?: b|</span><span class="s3">\\</span><span class="s1">))/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Fairphone</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/(u304aa)/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">AT&amp;T</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/</span><span class="s3">\\</span><span class="s1">bsie-(</span><span class="s3">\\</span><span class="s1">w*)/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Siemens</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/</span><span class="s3">\\</span><span class="s1">b(rct</span><span class="s3">\\</span><span class="s1">w+) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">RCA</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b(venue[</span><span class="s3">\\</span><span class="s1">d ]{2,7}) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Dell</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b(q(?:mv|ta)</span><span class="s3">\\</span><span class="s1">w+) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Verizon</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b(?:barnes[&amp; ]+noble |bn[rt])([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">+ ]*) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Barnes &amp; Noble</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b(tm</span><span class="s3">\\</span><span class="s1">d{3}</span><span class="s3">\\</span><span class="s1">w+) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">NuVision</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b(k88) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">ZTE</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b(nx</span><span class="s3">\\</span><span class="s1">d{3}j) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">ZTE</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/</span><span class="s3">\\</span><span class="s1">b(gen</span><span class="s3">\\</span><span class="s1">d{3}) b.+49h/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Swiss</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/</span><span class="s3">\\</span><span class="s1">b(zur</span><span class="s3">\\</span><span class="s1">d{3}) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Swiss</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b((zeki)?tb.*</span><span class="s3">\\</span><span class="s1">b) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Zeki</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b([yr]</span><span class="s3">\\</span><span class="s1">d{2}) b/i,/</span><span class="s3">\\</span><span class="s1">b(dragon[- ]+touch |dt)(</span><span class="s3">\\</span><span class="s1">w{5}) b/i],[[m,</span><span class="s3">\&quot;</span><span class="s1">Dragon Touch</span><span class="s3">\&quot;</span><span class="s1">],c,[p,k]],[/</span><span class="s3">\\</span><span class="s1">b(ns-?</span><span class="s3">\\</span><span class="s1">w{0,9}) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Insignia</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b((nxa|next)-?</span><span class="s3">\\</span><span class="s1">w{0,9}) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">NextBook</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b(xtreme</span><span class="s3">\\</span><span class="s1">_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[m,</span><span class="s3">\&quot;</span><span class="s1">Voice</span><span class="s3">\&quot;</span><span class="s1">],c,[p,g]],[/</span><span class="s3">\\</span><span class="s1">b(lvtel</span><span class="s3">\\</span><span class="s1">-)?(v1[12]) b/i],[[m,</span><span class="s3">\&quot;</span><span class="s1">LvTel</span><span class="s3">\&quot;</span><span class="s1">],c,[p,g]],[/</span><span class="s3">\\</span><span class="s1">b(ph-1) /i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Essential</span><span class="s3">\&quot;</span><span class="s1">],[p,g]],[/</span><span class="s3">\\</span><span class="s1">b(v(100md|700na|7011|917g).*</span><span class="s3">\\</span><span class="s1">b) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Envizen</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">b(trio[-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">. ]+) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">MachSpeed</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/</span><span class="s3">\\</span><span class="s1">btu_(1491) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Rotor</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/(shield[</span><span class="s3">\\</span><span class="s1">w ]+) b/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Nvidia</span><span class="s3">\&quot;</span><span class="s1">],[p,k]],[/(sprint) (</span><span class="s3">\\</span><span class="s1">w+)/i],[m,c,[p,g]],[/(kin</span><span class="s3">\\</span><span class="s1">.[onetw]{3})/i],[[c,/</span><span class="s3">\\</span><span class="s1">./g,</span><span class="s3">\&quot; \&quot;</span><span class="s1">],[m,R],[p,g]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)</span><span class="s3">\\</span><span class="s1">)/i],[c,[m,G],[p,k]],[/droid.+; (ec30|ps20|tc[2-8]</span><span class="s3">\\</span><span class="s1">d[kx])</span><span class="s3">\\</span><span class="s1">)/i],[c,[m,G],[p,g]],[/smart-tv.+(samsung)/i],[m,[p,x]],[/hbbtv.+maple;(</span><span class="s3">\\</span><span class="s1">d+)/i],[[c,/^/,</span><span class="s3">\&quot;</span><span class="s1">SmartTV</span><span class="s3">\&quot;</span><span class="s1">],[m,V],[p,x]],[/(nux; netcast.+smarttv|lg (netcast</span><span class="s3">\\</span><span class="s1">.tv-201</span><span class="s3">\\</span><span class="s1">d|android tv))/i],[[m,P],[p,x]],[/(apple) ?tv/i],[m,[c,S+</span><span class="s3">\&quot; </span><span class="s1">TV</span><span class="s3">\&quot;</span><span class="s1">],[p,x]],[/crkey/i],[[c,C+</span><span class="s3">\&quot;</span><span class="s1">cast</span><span class="s3">\&quot;</span><span class="s1">],[m,U],[p,x]],[/droid.+aft(</span><span class="s3">\\</span><span class="s1">w)( bui|</span><span class="s3">\\</span><span class="s1">))/i],[c,[m,T],[p,x]],[/</span><span class="s3">\\</span><span class="s1">(dtv[</span><span class="s3">\\</span><span class="s1">);].+(aquos)/i,/(aquos-tv[</span><span class="s3">\\</span><span class="s1">w ]+)</span><span class="s3">\\</span><span class="s1">)/i],[c,[m,D],[p,x]],[/(bravia[</span><span class="s3">\\</span><span class="s1">w ]+)( bui|</span><span class="s3">\\</span><span class="s1">))/i],[c,[m,I],[p,x]],[/(mitv-</span><span class="s3">\\</span><span class="s1">w{5}) bui/i],[c,[m,F],[p,x]],[/Hbbtv.*(technisat) (.*);/i],[m,c,[p,x]],[/</span><span class="s3">\\</span><span class="s1">b(roku)[</span><span class="s3">\\</span><span class="s1">dx]*[</span><span class="s3">\\</span><span class="s1">)</span><span class="s3">\\</span><span class="s1">/]((?:dvp-)?[</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]*)/i,/hbbtv</span><span class="s3">\\</span><span class="s1">/</span><span class="s3">\\</span><span class="s1">d+</span><span class="s3">\\</span><span class="s1">.</span><span class="s3">\\</span><span class="s1">d+</span><span class="s3">\\</span><span class="s1">.</span><span class="s3">\\</span><span class="s1">d+ +</span><span class="s3">\\</span><span class="s1">([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">+ ]*; *([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">d][^;]*);([^;]*)/i],[[m,trim],[c,trim],[p,x]],[/</span><span class="s3">\\</span><span class="s1">b(android tv|smart[- ]?tv|opera tv|tv; rv:)</span><span class="s3">\\</span><span class="s1">b/i],[[p,x]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[m,c,[p,v]],[/droid.+; (shield) bui/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Nvidia</span><span class="s3">\&quot;</span><span class="s1">],[p,v]],[/(playstation [345portablevi]+)/i],[c,[m,I],[p,v]],[/</span><span class="s3">\\</span><span class="s1">b(xbox(?: one)?(?!; xbox))[</span><span class="s3">\\</span><span class="s1">); ]/i],[c,[m,R],[p,v]],[/((pebble))app/i],[m,c,[p,_]],[/(watch)(?: ?os[,</span><span class="s3">\\</span><span class="s1">/]|</span><span class="s3">\\</span><span class="s1">d,</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">/)[</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]+/i],[c,[m,S],[p,_]],[/droid.+; (glass) </span><span class="s3">\\</span><span class="s1">d/i],[c,[m,U],[p,_]],[/droid.+; (wt63?0{2,3})</span><span class="s3">\\</span><span class="s1">)/i],[c,[m,G],[p,_]],[/(quest( 2| pro)?)/i],[c,[m,H],[p,_]],[/(tesla)(?: qtcarbrowser|</span><span class="s3">\\</span><span class="s1">/[-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[m,[p,y]],[/(aeobc)</span><span class="s3">\\</span><span class="s1">b/i],[c,[m,T],[p,y]],[/droid .+?; ([^;]+?)(?: bui|</span><span class="s3">\\</span><span class="s1">) applew).+? mobile safari/i],[c,[p,g]],[/droid .+?; ([^;]+?)(?: bui|</span><span class="s3">\\</span><span class="s1">) applew).+?(?! mobile) safari/i],[c,[p,k]],[/</span><span class="s3">\\</span><span class="s1">b((tablet|tab)[;</span><span class="s3">\\</span><span class="s1">/]|focus</span><span class="s3">\\</span><span class="s1">/</span><span class="s3">\\</span><span class="s1">d(?!.+mobile))/i],[[p,k]],[/(phone|mobile(?:[;</span><span class="s3">\\</span><span class="s1">/]| [ </span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">/</span><span class="s3">\\</span><span class="s1">.]*safari)|pda(?=.+windows ce))/i],[[p,g]],[/(android[-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">. ]{0,9});.+buil/i],[c,[m,</span><span class="s3">\&quot;</span><span class="s1">Generic</span><span class="s3">\&quot;</span><span class="s1">]]],engine:[[/windows.+ edge</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,E+</span><span class="s3">\&quot;</span><span class="s1">HTML</span><span class="s3">\&quot;</span><span class="s1">]],[/webkit</span><span class="s3">\\</span><span class="s1">/537</span><span class="s3">\\</span><span class="s1">.36.+chrome</span><span class="s3">\\</span><span class="s1">/(?!27)([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">Blink</span><span class="s3">\&quot;</span><span class="s1">]],[/(presto)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/ekioh(flow)</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(khtml|tasman|links)[</span><span class="s3">\\</span><span class="s1">/ ]</span><span class="s3">\\</span><span class="s1">(?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(icab)[</span><span class="s3">\\</span><span class="s1">/ ]([23]</span><span class="s3">\\</span><span class="s1">.[</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]+)/i,/</span><span class="s3">\\</span><span class="s1">b(libweb)/i],[u,f],[/rv</span><span class="s3">\\</span><span class="s1">:([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]{1,9})</span><span class="s3">\\</span><span class="s1">b.+(gecko)/i],[f,u]],os:[[/microsoft (windows) (vista|xp)/i],[u,f],[/(windows) nt 6</span><span class="s3">\\</span><span class="s1">.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[</span><span class="s3">\\</span><span class="s1">/ ]?([</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.</span><span class="s3">\\</span><span class="s1">w ]*)/i,/(windows)[</span><span class="s3">\\</span><span class="s1">/ ]?([ntce</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">. ]+</span><span class="s3">\\</span><span class="s1">w)(?!.+xbox)/i],[u,[f,strMapper,X]],[/(win(?=3|9|n)|win 9x )([nt</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]+)/i],[[u,</span><span class="s3">\&quot;</span><span class="s1">Windows</span><span class="s3">\&quot;</span><span class="s1">],[f,strMapper,X]],[/ip[honead]{2,4}</span><span class="s3">\\</span><span class="s1">b(?:.*os ([</span><span class="s3">\\</span><span class="s1">w]+) like mac|; opera)/i,/ios;fbsv</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]+)/i,/cfnetwork</span><span class="s3">\\</span><span class="s1">/.+darwin/i],[[f,/_/g,</span><span class="s3">\&quot;</span><span class="s1">.</span><span class="s3">\&quot;</span><span class="s1">],[u,</span><span class="s3">\&quot;</span><span class="s1">iOS</span><span class="s3">\&quot;</span><span class="s1">]],[/(mac os x) ?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">. ]*)/i,/(macintosh|mac_powerpc</span><span class="s3">\\</span><span class="s1">b)(?!.+haiku)/i],[[u,Z],[f,/_/g,</span><span class="s3">\&quot;</span><span class="s1">.</span><span class="s3">\&quot;</span><span class="s1">]],[/droid ([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)</span><span class="s3">\\</span><span class="s1">b.+(android[- ]x86|harmonyos)/i],[f,u],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-</span><span class="s3">\\</span><span class="s1">/ ]?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i,/(blackberry)</span><span class="s3">\\</span><span class="s1">w*</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i,/(tizen|kaios)[</span><span class="s3">\\</span><span class="s1">/ ]([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/</span><span class="s3">\\</span><span class="s1">((series40);/i],[u,f],[/</span><span class="s3">\\</span><span class="s1">(bb(10);/i],[f,[u,N]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-</span><span class="s3">\\</span><span class="s1">/ ]?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">Symbian</span><span class="s3">\&quot;</span><span class="s1">]],[/mozilla</span><span class="s3">\\</span><span class="s1">/[</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]+ </span><span class="s3">\\</span><span class="s1">((?:mobile|tablet|tv|mobile; [</span><span class="s3">\\</span><span class="s1">w ]+); rv:.+ gecko</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,O+</span><span class="s3">\&quot; </span><span class="s1">OS</span><span class="s3">\&quot;</span><span class="s1">]],[/web0s;.+rt(tv)/i,/</span><span class="s3">\\</span><span class="s1">b(?:hp)?wos(?:browser)?</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">webOS</span><span class="s3">\&quot;</span><span class="s1">]],[/watch(?: ?os[,</span><span class="s3">\\</span><span class="s1">/]|</span><span class="s3">\\</span><span class="s1">d,</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">/)([</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,</span><span class="s3">\&quot;</span><span class="s1">watchOS</span><span class="s3">\&quot;</span><span class="s1">]],[/crkey</span><span class="s3">\\</span><span class="s1">/([</span><span class="s3">\\</span><span class="s1">d</span><span class="s3">\\</span><span class="s1">.]+)/i],[f,[u,C+</span><span class="s3">\&quot;</span><span class="s1">cast</span><span class="s3">\&quot;</span><span class="s1">]],[/(cros) [</span><span class="s3">\\</span><span class="s1">w]+(?:</span><span class="s3">\\</span><span class="s1">)| ([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)</span><span class="s3">\\</span><span class="s1">b)/i],[[u,L],f],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)</span><span class="s3">\\</span><span class="s1">/(</span><span class="s3">\\</span><span class="s1">d+</span><span class="s3">\\</span><span class="s1">.[</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^</span><span class="s3">\\</span><span class="s1">);]+)/i,/</span><span class="s3">\\</span><span class="s1">b(joli|palm)</span><span class="s3">\\</span><span class="s1">b ?(?:os)?</span><span class="s3">\\</span><span class="s1">/?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i,/(mint)[</span><span class="s3">\\</span><span class="s1">/</span><span class="s3">\\</span><span class="s1">(</span><span class="s3">\\</span><span class="s1">) ]?(</span><span class="s3">\\</span><span class="s1">w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu</span><span class="s3">\\</span><span class="s1">/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-</span><span class="s3">\\</span><span class="s1">/ ]?(?!chrom|package)([-</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i,/(hurd|linux) ?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i,/(gnu) ?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i,/</span><span class="s3">\\</span><span class="s1">b([-frentopcghs]{0,5}bsd|dragonfly)[</span><span class="s3">\\</span><span class="s1">/ ]?(?!amd|[ix346]{1,2}86)([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i,/(haiku) (</span><span class="s3">\\</span><span class="s1">w+)/i],[u,f],[/(sunos) ?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.</span><span class="s3">\\</span><span class="s1">d]*)/i],[[u,</span><span class="s3">\&quot;</span><span class="s1">Solaris</span><span class="s3">\&quot;</span><span class="s1">],f],[/((?:open)?solaris)[-</span><span class="s3">\\</span><span class="s1">/ ]?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i,/(aix) ((</span><span class="s3">\\</span><span class="s1">d)(?=</span><span class="s3">\\</span><span class="s1">.|</span><span class="s3">\\</span><span class="s1">)| )[</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.])*/i,/</span><span class="s3">\\</span><span class="s1">b(beos|os</span><span class="s3">\\</span><span class="s1">/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">.]*)/i],[u,f]]};var UAParser=function(i,e){if(typeof i===w){e=i;i=a}if(!(this instanceof UAParser)){return new UAParser(i,e).getResult()}var r=typeof o!==b&amp;&amp;o.navigator?o.navigator:a;var n=i||(r&amp;&amp;r.userAgent?r.userAgent:t);var v=r&amp;&amp;r.userAgentData?r.userAgentData:a;var x=e?extend(K,e):K;var _=r&amp;&amp;r.userAgent==n;this.getBrowser=function(){var i={};i[u]=a;i[f]=a;rgxMapper.call(i,n,x.browser);i[d]=majorize(i[f]);if(_&amp;&amp;r&amp;&amp;r.brave&amp;&amp;typeof r.brave.isBrave==s){i[u]=</span><span class="s3">\&quot;</span><span class="s1">Brave</span><span class="s3">\&quot;</span><span class="s1">}return i};this.getCPU=function(){var i={};i[h]=a;rgxMapper.call(i,n,x.cpu);return i};this.getDevice=function(){var i={};i[m]=a;i[c]=a;i[p]=a;rgxMapper.call(i,n,x.device);if(_&amp;&amp;!i[p]&amp;&amp;v&amp;&amp;v.mobile){i[p]=g}if(_&amp;&amp;i[c]==</span><span class="s3">\&quot;</span><span class="s1">Macintosh</span><span class="s3">\&quot;</span><span class="s1">&amp;&amp;r&amp;&amp;typeof r.standalone!==b&amp;&amp;r.maxTouchPoints&amp;&amp;r.maxTouchPoints&gt;2){i[c]=</span><span class="s3">\&quot;</span><span class="s1">iPad</span><span class="s3">\&quot;</span><span class="s1">;i[p]=k}return i};this.getEngine=function(){var i={};i[u]=a;i[f]=a;rgxMapper.call(i,n,x.engine);return i};this.getOS=function(){var i={};i[u]=a;i[f]=a;rgxMapper.call(i,n,x.os);if(_&amp;&amp;!i[u]&amp;&amp;v&amp;&amp;v.platform!=</span><span class="s3">\&quot;</span><span class="s1">Unknown</span><span class="s3">\&quot;</span><span class="s1">){i[u]=v.platform.replace(/chrome os/i,L).replace(/macos/i,Z)}return i};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}};this.getUA=function(){return n};this.setUA=function(i){n=typeof i===l&amp;&amp;i.length&gt;q?trim(i,q):i;return this};this.setUA(n);return this};UAParser.VERSION=r;UAParser.BROWSER=enumerize([u,f,d]);UAParser.CPU=enumerize([h]);UAParser.DEVICE=enumerize([c,m,p,v,g,x,k,_,y]);UAParser.ENGINE=UAParser.OS=enumerize([u,f]);if(typeof e!==b){if(</span><span class="s3">\&quot;</span><span class="s1">object</span><span class="s3">\&quot;</span><span class="s1">!==b&amp;&amp;i.exports){e=i.exports=UAParser}e.UAParser=UAParser}else{if(typeof define===s&amp;&amp;define.amd){define((function(){return UAParser}))}else if(typeof o!==b){o.UAParser=UAParser}}var Q=typeof o!==b&amp;&amp;(o.jQuery||o.Zepto);if(Q&amp;&amp;!Q.ua){var Y=new UAParser;Q.ua=Y.getResult();Q.ua.get=function(){return Y.getUA()};Q.ua.set=function(i){Y.setUA(i);var e=Y.getResult();for(var o in e){Q.ua[o]=e[o]}}}})(typeof window===</span><span class="s3">\&quot;</span><span class="s1">object</span><span class="s3">\&quot;</span><span class="s1">?window:this)}};var e={};function __nccwpck_require__(o){var a=e[o];if(a!==undefined){return a.exports}var r=e[o]={exports:{}};var t=true;try{i[o].call(r.exports,r,r.exports,__nccwpck_require__);t=false}finally{if(t)delete e[o]}return r.exports}if(typeof __nccwpck_require__!==</span><span class="s3">\&quot;</span><span class="s1">undefined</span><span class="s3">\&quot;</span><span class="s1">)__nccwpck_require__.ab=__dirname+</span><span class="s3">\&quot;</span><span class="s1">/</span><span class="s3">\&quot;</span><span class="s1">;var o=__nccwpck_require__(226);module.exports=o})();&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">11790</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/web/spec-extension/user-agent.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import parseua from 'next/dist/compiled/ua-parser-js'</span><span class="s3">\n\n</span><span class="s1">interface UserAgent {</span><span class="s3">\n  </span><span class="s1">isBot: boolean</span><span class="s3">\n  </span><span class="s1">ua: string</span><span class="s3">\n  </span><span class="s1">browser: {</span><span class="s3">\n    </span><span class="s1">name?: string</span><span class="s3">\n    </span><span class="s1">version?: string</span><span class="s3">\n    </span><span class="s1">major?: string</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">device: {</span><span class="s3">\n    </span><span class="s1">model?: string</span><span class="s3">\n    </span><span class="s1">type?: string</span><span class="s3">\n    </span><span class="s1">vendor?: string</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">engine: {</span><span class="s3">\n    </span><span class="s1">name?: string</span><span class="s3">\n    </span><span class="s1">version?: string</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">os: {</span><span class="s3">\n    </span><span class="s1">name?: string</span><span class="s3">\n    </span><span class="s1">version?: string</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">cpu: {</span><span class="s3">\n    </span><span class="s1">architecture?: string</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isBot(input: string): boolean {</span><span class="s3">\n  </span><span class="s1">return /Googlebot|Mediapartners-Google|AdsBot-Google|googleweblight|Storebot-Google|Google-PageRenderer|Google-InspectionTool|Bingbot|BingPreview|Slurp|DuckDuckBot|baiduspider|yandex|sogou|LinkedInBot|bitlybot|tumblr|vkShare|quora link preview|facebookexternalhit|facebookcatalog|Twitterbot|applebot|redditbot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|ia_archiver/i.test(</span><span class="s3">\n    </span><span class="s1">input</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function userAgentFromString(input: string | undefined): UserAgent {</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">...parseua(input),</span><span class="s3">\n    </span><span class="s1">isBot: input === undefined ? false : isBot(input),</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function userAgent({ headers }: { headers: Headers }): UserAgent {</span><span class="s3">\n  </span><span class="s1">return userAgentFromString(headers.get('user-agent') || undefined)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isBot&quot;</span><span class="s0">,</span><span class="s1">&quot;userAgent&quot;</span><span class="s0">,</span><span class="s1">&quot;userAgentFromString&quot;</span><span class="s0">,</span><span class="s1">&quot;input&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;parseua&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;IA4BgBA,KAAK,EAAA;eAALA;;IAaAC,SAAS,EAAA;eAATA;;IAPAC,mBAAmB,EAAA;eAAnBA;;;mEAlCI;;;;;;AA4Bb,SAASF,MAAMG,KAAa;IACjC,OAAO,0WAA0WC,IAAI,CACnXD;AAEJ;AAEO,SAASD,oBAAoBC,KAAyB;IAC3D,OAAO;QACL,GAAGE,CAAAA,GAAAA,YAAAA,OAAO,EAACF,MAAM;QACjBH,OAAOG,UAAUG,YAAY,QAAQN,MAAMG;IAC7C;AACF;AAEO,SAASF,UAAU,EAAEM,OAAO,EAAwB;IACzD,OAAOL,oBAAoBK,QAAQC,GAAG,CAAC,iBAAiBF;AAC1D&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">11837</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/web/spec-extension/url-pattern.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const GlobalURLPattern =</span><span class="s3">\n  </span><span class="s1">// @ts-expect-error: URLPattern is not available in Node.js</span><span class="s3">\n  </span><span class="s1">typeof URLPattern === 'undefined' ? undefined : URLPattern</span><span class="s3">\n\n</span><span class="s1">export { GlobalURLPattern as URLPattern }</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;URLPattern&quot;</span><span class="s0">,</span><span class="s1">&quot;GlobalURLPattern&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAI6BA,cAAAA;;;eAApBC;;;AAJT,MAAMA,mBACJ,AACA,OAAOD,eAAe,cAAcE,YAAYF,WADW&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">11851</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/after/after.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { workAsyncStorage } from '../app-render/work-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">export type AfterTask&lt;T = unknown&gt; = Promise&lt;T&gt; | AfterCallback&lt;T&gt;</span><span class="s3">\n</span><span class="s1">export type AfterCallback&lt;T = unknown&gt; = () =&gt; T | Promise&lt;T&gt;</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function allows you to schedule callbacks to be executed after the current request finishes.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function after&lt;T&gt;(task: AfterTask&lt;T&gt;): void {</span><span class="s3">\n  </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n\n  </span><span class="s1">if (!workStore) {</span><span class="s3">\n    </span><span class="s1">// TODO(after): the linked docs page talks about *dynamic* APIs, which after soon won't be anymore</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">'`after` was called outside a request scope. Read more: https://nextjs.org/docs/messages/next-dynamic-api-wrong-context'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { afterContext } = workStore</span><span class="s3">\n  </span><span class="s1">return afterContext.after(task)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;after&quot;</span><span class="s0">,</span><span class="s1">&quot;task&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;afterContext&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAQgBA,SAAAA;;;eAAAA;;;0CARiB;AAQ1B,SAASA,MAASC,IAAkB;IACzC,MAAMC,YAAYC,0BAAAA,gBAAgB,CAACC,QAAQ;IAE3C,IAAI,CAACF,WAAW;QACd,kGAAkG;QAClG,MAAM,OAAA,cAEL,CAFK,IAAIG,MACR,2HADI,qBAAA;mBAAA;wBAAA;0BAAA;QAEN;IACF;IAEA,MAAM,EAAEC,YAAY,EAAE,GAAGJ;IACzB,OAAOI,aAAaN,KAAK,CAACC;AAC5B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">11878</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/after/index.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export * from './after'</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;qBAAc,oGAAA&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">11900</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/client/components/hooks-server-context.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const DYNAMIC_ERROR_CODE = 'DYNAMIC_SERVER_USAGE'</span><span class="s3">\n\n</span><span class="s1">export class DynamicServerError extends Error {</span><span class="s3">\n  </span><span class="s1">digest: typeof DYNAMIC_ERROR_CODE = DYNAMIC_ERROR_CODE</span><span class="s3">\n\n  </span><span class="s1">constructor(public readonly description: string) {</span><span class="s3">\n    </span><span class="s1">super(`Dynamic server usage: ${description}`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isDynamicServerError(err: unknown): err is DynamicServerError {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">typeof err !== 'object' ||</span><span class="s3">\n    </span><span class="s1">err === null ||</span><span class="s3">\n    </span><span class="s1">!('digest' in err) ||</span><span class="s3">\n    </span><span class="s1">typeof err.digest !== 'string'</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return err.digest === DYNAMIC_ERROR_CODE</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;DynamicServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;DYNAMIC_ERROR_CODE&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;description&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;IAEaA,kBAAkB,EAAA;eAAlBA;;IAQGC,oBAAoB,EAAA;eAApBA;;;AAVhB,MAAMC,qBAAqB;AAEpB,MAAMF,2BAA2BG;IAGtCC,YAA4BC,WAAmB,CAAE;QAC/C,KAAK,CAAE,2BAAwBA,cAAAA,IAAAA,CADLA,WAAAA,GAAAA,aAAAA,IAAAA,CAF5BC,MAAAA,GAAoCJ;IAIpC;AACF;AAEO,SAASD,qBAAqBM,GAAY;IAC/C,IACE,OAAOA,QAAQ,YACfA,QAAQ,QACR,CAAE,CAAA,YAAYA,GAAE,KAChB,OAAOA,IAAID,MAAM,KAAK,UACtB;QACA,OAAO;IACT;IAEA,OAAOC,IAAID,MAAM,KAAKJ;AACxB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">11944</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/client/components/static-generation-bailout.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const NEXT_STATIC_GEN_BAILOUT = 'NEXT_STATIC_GEN_BAILOUT'</span><span class="s3">\n\n</span><span class="s1">export class StaticGenBailoutError extends Error {</span><span class="s3">\n  </span><span class="s1">public readonly code = NEXT_STATIC_GEN_BAILOUT</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isStaticGenBailoutError(</span><span class="s3">\n  </span><span class="s1">error: unknown</span><span class="s3">\n</span><span class="s1">): error is StaticGenBailoutError {</span><span class="s3">\n  </span><span class="s1">if (typeof error !== 'object' || error === null || !('code' in error)) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return error.code === NEXT_STATIC_GEN_BAILOUT</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;StaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;isStaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_STATIC_GEN_BAILOUT&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;code&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;IAEaA,qBAAqB,EAAA;eAArBA;;IAIGC,uBAAuB,EAAA;eAAvBA;;;AANhB,MAAMC,0BAA0B;AAEzB,MAAMF,8BAA8BG;;QAApC,KAAA,IAAA,OAAA,IAAA,CACWC,IAAAA,GAAOF;;AACzB;AAEO,SAASD,wBACdI,KAAc;IAEd,IAAI,OAAOA,UAAU,YAAYA,UAAU,QAAQ,CAAE,CAAA,UAAUA,KAAI,GAAI;QACrE,OAAO;IACT;IAEA,OAAOA,MAAMD,IAAI,KAAKF;AACxB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">11988</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/dynamic-rendering-utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export function isHangingPromiseRejectionError(</span><span class="s3">\n  </span><span class="s1">err: unknown</span><span class="s3">\n</span><span class="s1">): err is HangingPromiseRejectionError {</span><span class="s3">\n  </span><span class="s1">if (typeof err !== 'object' || err === null || !('digest' in err)) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return err.digest === HANGING_PROMISE_REJECTION</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const HANGING_PROMISE_REJECTION = 'HANGING_PROMISE_REJECTION'</span><span class="s3">\n\n</span><span class="s1">class HangingPromiseRejectionError extends Error {</span><span class="s3">\n  </span><span class="s1">public readonly digest = HANGING_PROMISE_REJECTION</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">public readonly route: string,</span><span class="s3">\n    </span><span class="s1">public readonly expression: string</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">super(</span><span class="s3">\n      </span><span class="s1">`During prerendering, ${expression} rejects when the prerender is complete. Typically these errors are handled by React but if you move ${expression} to a different context by using </span><span class="s3">\\</span><span class="s1">`setTimeout</span><span class="s3">\\</span><span class="s1">`, </span><span class="s3">\\</span><span class="s1">`after</span><span class="s3">\\</span><span class="s1">`, or similar functions you may observe this error and you should handle it in that context. This occurred at route </span><span class="s3">\&quot;</span><span class="s1">${route}</span><span class="s3">\&quot;</span><span class="s1">.`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type AbortListeners = Array&lt;(err: unknown) =&gt; void&gt;</span><span class="s3">\n</span><span class="s1">const abortListenersBySignal = new WeakMap&lt;AbortSignal, AbortListeners&gt;()</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function constructs a promise that will never resolve. This is primarily</span><span class="s3">\n </span><span class="s1">* useful for cacheComponents where we use promise resolution timing to determine which</span><span class="s3">\n </span><span class="s1">* parts of a render can be included in a prerender.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function makeHangingPromise&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">signal: AbortSignal,</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">): Promise&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">if (signal.aborted) {</span><span class="s3">\n    </span><span class="s1">return Promise.reject(new HangingPromiseRejectionError(route, expression))</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">const hangingPromise = new Promise&lt;T&gt;((_, reject) =&gt; {</span><span class="s3">\n      </span><span class="s1">const boundRejection = reject.bind(</span><span class="s3">\n        </span><span class="s1">null,</span><span class="s3">\n        </span><span class="s1">new HangingPromiseRejectionError(route, expression)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">let currentListeners = abortListenersBySignal.get(signal)</span><span class="s3">\n      </span><span class="s1">if (currentListeners) {</span><span class="s3">\n        </span><span class="s1">currentListeners.push(boundRejection)</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">const listeners = [boundRejection]</span><span class="s3">\n        </span><span class="s1">abortListenersBySignal.set(signal, listeners)</span><span class="s3">\n        </span><span class="s1">signal.addEventListener(</span><span class="s3">\n          </span><span class="s1">'abort',</span><span class="s3">\n          </span><span class="s1">() =&gt; {</span><span class="s3">\n            </span><span class="s1">for (let i = 0; i &lt; listeners.length; i++) {</span><span class="s3">\n              </span><span class="s1">listeners[i]()</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">{ once: true }</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">// We are fine if no one actually awaits this promise. We shouldn't consider this an unhandled rejection so</span><span class="s3">\n    </span><span class="s1">// we attach a noop catch handler here to suppress this warning. If you actually await somewhere or construct</span><span class="s3">\n    </span><span class="s1">// your own promise out of it you'll need to ensure you handle the error when it rejects.</span><span class="s3">\n    </span><span class="s1">hangingPromise.catch(ignoreReject)</span><span class="s3">\n    </span><span class="s1">return hangingPromise</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function ignoreReject() {}</span><span class="s3">\n\n</span><span class="s1">export function makeDevtoolsIOAwarePromise&lt;T&gt;(underlying: T): Promise&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">// in React DevTools if we resolve in a setTimeout we will observe</span><span class="s3">\n  </span><span class="s1">// the promise resolution as something that can suspend a boundary or root.</span><span class="s3">\n  </span><span class="s1">return new Promise&lt;T&gt;((resolve) =&gt; {</span><span class="s3">\n    </span><span class="s1">// Must use setTimeout to be considered IO React DevTools. setImmediate will not work.</span><span class="s3">\n    </span><span class="s1">setTimeout(() =&gt; {</span><span class="s3">\n      </span><span class="s1">resolve(underlying)</span><span class="s3">\n    </span><span class="s1">}, 0)</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isHangingPromiseRejectionError&quot;</span><span class="s0">,</span><span class="s1">&quot;makeDevtoolsIOAwarePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;HANGING_PROMISE_REJECTION&quot;</span><span class="s0">,</span><span class="s1">&quot;HangingPromiseRejectionError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;abortListenersBySignal&quot;</span><span class="s0">,</span><span class="s1">&quot;WeakMap&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;aborted&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;reject&quot;</span><span class="s0">,</span><span class="s1">&quot;hangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;_&quot;</span><span class="s0">,</span><span class="s1">&quot;boundRejection&quot;</span><span class="s0">,</span><span class="s1">&quot;bind&quot;</span><span class="s0">,</span><span class="s1">&quot;currentListeners&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;listeners&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;addEventListener&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;once&quot;</span><span class="s0">,</span><span class="s1">&quot;catch&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreReject&quot;</span><span class="s0">,</span><span class="s1">&quot;underlying&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;setTimeout&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;IAAgBA,8BAA8B,EAAA;eAA9BA;;IA2EAC,0BAA0B,EAAA;eAA1BA;;IAxCAC,kBAAkB,EAAA;eAAlBA;;;AAnCT,SAASF,+BACdG,GAAY;IAEZ,IAAI,OAAOA,QAAQ,YAAYA,QAAQ,QAAQ,CAAE,CAAA,YAAYA,GAAE,GAAI;QACjE,OAAO;IACT;IAEA,OAAOA,IAAIC,MAAM,KAAKC;AACxB;AAEA,MAAMA,4BAA4B;AAElC,MAAMC,qCAAqCC;IAGzCC,YACkBC,KAAa,EACbC,UAAkB,CAClC;QACA,KAAK,CACH,CAAC,qBAAqB,EAAEA,WAAW,qGAAqG,EAAEA,WAAW,8KAA8K,EAAED,MAAM,EAAE,CAAC,GAAA,IAAA,CAJhUA,KAAAA,GAAAA,OAAAA,IAAAA,CACAC,UAAAA,GAAAA,YAAAA,IAAAA,CAJFN,MAAAA,GAASC;IASzB;AACF;AAGA,MAAMM,yBAAyB,IAAIC;AAS5B,SAASV,mBACdW,MAAmB,EACnBJ,KAAa,EACbC,UAAkB;IAElB,IAAIG,OAAOC,OAAO,EAAE;QAClB,OAAOC,QAAQC,MAAM,CAAC,IAAIV,6BAA6BG,OAAOC;IAChE,OAAO;QACL,MAAMO,iBAAiB,IAAIF,QAAW,CAACG,GAAGF;YACxC,MAAMG,iBAAiBH,OAAOI,IAAI,CAChC,MACA,IAAId,6BAA6BG,OAAOC;YAE1C,IAAIW,mBAAmBV,uBAAuBW,GAAG,CAACT;YAClD,IAAIQ,kBAAkB;gBACpBA,iBAAiBE,IAAI,CAACJ;YACxB,OAAO;gBACL,MAAMK,YAAY;oBAACL;iBAAe;gBAClCR,uBAAuBc,GAAG,CAACZ,QAAQW;gBACnCX,OAAOa,gBAAgB,CACrB,SACA;oBACE,IAAK,IAAIC,IAAI,GAAGA,IAAIH,UAAUI,MAAM,EAAED,IAAK;wBACzCH,SAAS,CAACG,EAAE;oBACd;gBACF,GACA;oBAAEE,MAAM;gBAAK;YAEjB;QACF;QACA,2GAA2G;QAC3G,6GAA6G;QAC7G,yFAAyF;QACzFZ,eAAea,KAAK,CAACC;QACrB,OAAOd;IACT;AACF;AAEA,SAASc,gBAAgB;AAElB,SAAS9B,2BAA8B+B,UAAa;IACzD,kEAAkE;IAClE,2EAA2E;IAC3E,OAAO,IAAIjB,QAAW,CAACkB;QACrB,sFAAsF;QACtFC,WAAW;YACTD,QAAQD;QACV,GAAG;IACL;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">12071</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/lib/framework/boundary-constants.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export const METADATA_BOUNDARY_NAME = '__next_metadata_boundary__'</span><span class="s3">\n</span><span class="s1">export const VIEWPORT_BOUNDARY_NAME = '__next_viewport_boundary__'</span><span class="s3">\n</span><span class="s1">export const OUTLET_BOUNDARY_NAME = '__next_outlet_boundary__'</span><span class="s3">\n</span><span class="s1">export const ROOT_LAYOUT_BOUNDARY_NAME = '__next_root_layout_boundary__'</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;METADATA_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;OUTLET_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_LAYOUT_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;VIEWPORT_BOUNDARY_NAME&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;;IAAaA,sBAAsB,EAAA;eAAtBA;;IAEAC,oBAAoB,EAAA;eAApBA;;IACAC,yBAAyB,EAAA;eAAzBA;;IAFAC,sBAAsB,EAAA;eAAtBA;;;AADN,MAAMH,yBAAyB;AAC/B,MAAMG,yBAAyB;AAC/B,MAAMF,uBAAuB;AAC7B,MAAMC,4BAA4B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">12108</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/lib/scheduler.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export type ScheduledFn&lt;T = void&gt; = () =&gt; T | PromiseLike&lt;T&gt;</span><span class="s3">\n</span><span class="s1">export type SchedulerFn&lt;T = void&gt; = (cb: ScheduledFn&lt;T&gt;) =&gt; void</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Schedules a function to be called on the next tick after the other promises</span><span class="s3">\n </span><span class="s1">* have been resolved.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param cb the function to schedule</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const scheduleOnNextTick = (cb: ScheduledFn&lt;void&gt;) =&gt; {</span><span class="s3">\n  </span><span class="s1">// We use Promise.resolve().then() here so that the operation is scheduled at</span><span class="s3">\n  </span><span class="s1">// the end of the promise job queue, we then add it to the next process tick</span><span class="s3">\n  </span><span class="s1">// to ensure it's evaluated afterwards.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// This was inspired by the implementation of the DataLoader interface: https://github.com/graphql/dataloader/blob/d336bd15282664e0be4b4a657cb796f09bafbc6b/src/index.js#L213-L255</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">Promise.resolve().then(() =&gt; {</span><span class="s3">\n    </span><span class="s1">if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n      </span><span class="s1">setTimeout(cb, 0)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">process.nextTick(cb)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Schedules a function to be called using `setImmediate` or `setTimeout` if</span><span class="s3">\n </span><span class="s1">* `setImmediate` is not available (like in the Edge runtime).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param cb the function to schedule</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const scheduleImmediate = (cb: ScheduledFn&lt;void&gt;): void =&gt; {</span><span class="s3">\n  </span><span class="s1">if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n    </span><span class="s1">setTimeout(cb, 0)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">setImmediate(cb)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* returns a promise than resolves in a future task. There is no guarantee that the task it resolves in</span><span class="s3">\n </span><span class="s1">* will be the next task but if you await it you can at least be sure that the current task is over and</span><span class="s3">\n </span><span class="s1">* most usefully that the entire microtask queue of the current task has been emptied.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function atLeastOneTask() {</span><span class="s3">\n  </span><span class="s1">return new Promise&lt;void&gt;((resolve) =&gt; scheduleImmediate(resolve))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This utility function is extracted to make it easier to find places where we are doing</span><span class="s3">\n </span><span class="s1">* specific timing tricks to try to schedule work after React has rendered. This is especially</span><span class="s3">\n </span><span class="s1">* important at the moment because Next.js uses the edge builds of React which use setTimeout to</span><span class="s3">\n </span><span class="s1">* schedule work when you might expect that something like setImmediate would do the trick.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Long term we should switch to the node versions of React rendering when possible and then</span><span class="s3">\n </span><span class="s1">* update this to use setImmediate rather than setTimeout</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function waitAtLeastOneReactRenderTask(): Promise&lt;void&gt; {</span><span class="s3">\n  </span><span class="s1">if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n    </span><span class="s1">return new Promise((r) =&gt; setTimeout(r, 0))</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">return new Promise((r) =&gt; setImmediate(r))</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;atLeastOneTask&quot;</span><span class="s0">,</span><span class="s1">&quot;scheduleImmediate&quot;</span><span class="s0">,</span><span class="s1">&quot;scheduleOnNextTick&quot;</span><span class="s0">,</span><span class="s1">&quot;waitAtLeastOneReactRenderTask&quot;</span><span class="s0">,</span><span class="s1">&quot;cb&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;setTimeout&quot;</span><span class="s0">,</span><span class="s1">&quot;nextTick&quot;</span><span class="s0">,</span><span class="s1">&quot;setImmediate&quot;</span><span class="s0">,</span><span class="s1">&quot;r&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;;IA4CgBA,cAAc,EAAA;eAAdA;;IAbHC,iBAAiB,EAAA;eAAjBA;;IAtBAC,kBAAkB,EAAA;eAAlBA;;IAgDGC,6BAA6B,EAAA;eAA7BA;;;AAhDT,MAAMD,qBAAqB,CAACE;IACjC,6EAA6E;IAC7E,4EAA4E;IAC5E,uCAAuC;IACvC,EAAE;IACF,kLAAkL;IAClL,EAAE;IACFC,QAAQC,OAAO,GAAGC,IAAI,CAAC;QACrB,IAAIC,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;aAElC;YACLF,QAAQI,QAAQ,CAACR;QACnB;IACF;AACF;AAQO,MAAMH,oBAAoB,CAACG;IAChC,IAAII,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;SAElC;QACLG,aAAaT;IACf;AACF;AAOO,SAASJ;IACd,OAAO,IAAIK,QAAc,CAACC,UAAYL,kBAAkBK;AAC1D;AAWO,SAASH;IACd,IAAIK,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;SAElC;QACL,OAAO,IAAIL,QAAQ,CAACS,IAAMD,aAAaC;IACzC;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">12173</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/lazy-dynamic/bailout-to-csr.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// This has to be a shared module which is shared between client component error boundary and dynamic component</span><span class="s3">\n</span><span class="s1">const BAILOUT_TO_CSR = 'BAILOUT_TO_CLIENT_SIDE_RENDERING'</span><span class="s3">\n\n</span><span class="s1">/** An error that should be thrown when we want to bail out to client-side rendering. */</span><span class="s3">\n</span><span class="s1">export class BailoutToCSRError extends Error {</span><span class="s3">\n  </span><span class="s1">public readonly digest = BAILOUT_TO_CSR</span><span class="s3">\n\n  </span><span class="s1">constructor(public readonly reason: string) {</span><span class="s3">\n    </span><span class="s1">super(`Bail out to client-side rendering: ${reason}`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/** Checks if a passed argument is an error that is thrown if we want to bail out to client-side rendering. */</span><span class="s3">\n</span><span class="s1">export function isBailoutToCSRError(err: unknown): err is BailoutToCSRError {</span><span class="s3">\n  </span><span class="s1">if (typeof err !== 'object' || err === null || !('digest' in err)) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return err.digest === BAILOUT_TO_CSR</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;BailoutToCSRError&quot;</span><span class="s0">,</span><span class="s1">&quot;isBailoutToCSRError&quot;</span><span class="s0">,</span><span class="s1">&quot;BAILOUT_TO_CSR&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;reason&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,+GAA+G;;;;;;;;;;;;;;;IAIlGA,iBAAiB,EAAA;eAAjBA;;IASGC,mBAAmB,EAAA;eAAnBA;;;AAZhB,MAAMC,iBAAiB;AAGhB,MAAMF,0BAA0BG;IAGrCC,YAA4BC,MAAc,CAAE;QAC1C,KAAK,CAAE,wCAAqCA,SAAAA,IAAAA,CADlBA,MAAAA,GAAAA,QAAAA,IAAAA,CAFZC,MAAAA,GAASJ;IAIzB;AACF;AAGO,SAASD,oBAAoBM,GAAY;IAC9C,IAAI,OAAOA,QAAQ,YAAYA,QAAQ,QAAQ,CAAE,CAAA,YAAYA,GAAE,GAAI;QACjE,OAAO;IACT;IAEA,OAAOA,IAAID,MAAM,KAAKJ;AACxB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">12211</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/invariant-error.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export class InvariantError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor(message: string, options?: ErrorOptions) {</span><span class="s3">\n    </span><span class="s1">super(</span><span class="s3">\n      </span><span class="s1">`Invariant: ${message.endsWith('.') ? message : message + '.'} This is a bug in Next.js.`,</span><span class="s3">\n      </span><span class="s1">options</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">this.name = 'InvariantError'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAAaA,kBAAAA;;;eAAAA;;;AAAN,MAAMA,uBAAuBC;IAClCC,YAAYC,OAAe,EAAEC,OAAsB,CAAE;QACnD,KAAK,CACF,gBAAaD,CAAAA,QAAQE,QAAQ,CAAC,OAAOF,UAAUA,UAAU,GAAE,IAAE,8BAC9DC;QAEF,IAAI,CAACE,IAAI,GAAG;IACd;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">12230</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/app-render/dynamic-rendering.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* The functions provided by this module are used to communicate certain properties</span><span class="s3">\n </span><span class="s1">* about the currently running code so that Next.js can make decisions on how to handle</span><span class="s3">\n </span><span class="s1">* the current execution in different rendering modes such as pre-rendering, resuming, and SSR.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Today Next.js treats all code as potentially static. Certain APIs may only make sense when dynamically rendering.</span><span class="s3">\n </span><span class="s1">* Traditionally this meant deopting the entire render to dynamic however with PPR we can now deopt parts</span><span class="s3">\n </span><span class="s1">* of a React tree as dynamic while still keeping other parts static. There are really two different kinds of</span><span class="s3">\n </span><span class="s1">* Dynamic indications.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* The first is simply an intention to be dynamic. unstable_noStore is an example of this where</span><span class="s3">\n </span><span class="s1">* the currently executing code simply declares that the current scope is dynamic but if you use it</span><span class="s3">\n </span><span class="s1">* inside unstable_cache it can still be cached. This type of indication can be removed if we ever</span><span class="s3">\n </span><span class="s1">* make the default dynamic to begin with because the only way you would ever be static is inside</span><span class="s3">\n </span><span class="s1">* a cache scope which this indication does not affect.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* The second is an indication that a dynamic data source was read. This is a stronger form of dynamic</span><span class="s3">\n </span><span class="s1">* because it means that it is inappropriate to cache this at all. using a dynamic data source inside</span><span class="s3">\n </span><span class="s1">* unstable_cache should error. If you want to use some dynamic data inside unstable_cache you should</span><span class="s3">\n </span><span class="s1">* read that data outside the cache and pass it in as an argument to the cached function.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">import type { WorkStore } from '../app-render/work-async-storage.external'</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">WorkUnitStore,</span><span class="s3">\n  </span><span class="s1">RequestStore,</span><span class="s3">\n  </span><span class="s1">PrerenderStoreLegacy,</span><span class="s3">\n  </span><span class="s1">PrerenderStoreModern,</span><span class="s3">\n  </span><span class="s1">PrerenderStoreModernRuntime,</span><span class="s3">\n</span><span class="s1">} from '../app-render/work-unit-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">// Once postpone is in stable we should switch to importing the postpone export directly</span><span class="s3">\n</span><span class="s1">import React from 'react'</span><span class="s3">\n\n</span><span class="s1">import { DynamicServerError } from '../../client/components/hooks-server-context'</span><span class="s3">\n</span><span class="s1">import { StaticGenBailoutError } from '../../client/components/static-generation-bailout'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">getRuntimeStagePromise,</span><span class="s3">\n  </span><span class="s1">workUnitAsyncStorage,</span><span class="s3">\n</span><span class="s1">} from './work-unit-async-storage.external'</span><span class="s3">\n</span><span class="s1">import { workAsyncStorage } from '../app-render/work-async-storage.external'</span><span class="s3">\n</span><span class="s1">import { makeHangingPromise } from '../dynamic-rendering-utils'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">METADATA_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">VIEWPORT_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">OUTLET_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">ROOT_LAYOUT_BOUNDARY_NAME,</span><span class="s3">\n</span><span class="s1">} from '../../lib/framework/boundary-constants'</span><span class="s3">\n</span><span class="s1">import { scheduleOnNextTick } from '../../lib/scheduler'</span><span class="s3">\n</span><span class="s1">import { BailoutToCSRError } from '../../shared/lib/lazy-dynamic/bailout-to-csr'</span><span class="s3">\n</span><span class="s1">import { InvariantError } from '../../shared/lib/invariant-error'</span><span class="s3">\n\n</span><span class="s1">const hasPostpone = typeof React.unstable_postpone === 'function'</span><span class="s3">\n\n</span><span class="s1">export type DynamicAccess = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If debugging, this will contain the stack trace of where the dynamic access</span><span class="s3">\n   </span><span class="s1">* occurred. This is used to provide more information to the user about why</span><span class="s3">\n   </span><span class="s1">* their page is being rendered dynamically.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">stack?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The expression that was accessed dynamically.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Stores dynamic reasons used during an RSC render.</span><span class="s3">\n</span><span class="s1">export type DynamicTrackingState = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* When true, stack information will also be tracked during dynamic access.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">readonly isDebugDynamicAccesses: boolean | undefined</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The dynamic accesses that occurred during the render.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">readonly dynamicAccesses: Array&lt;DynamicAccess&gt;</span><span class="s3">\n\n  </span><span class="s1">syncDynamicErrorWithStack: null | Error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Stores dynamic reasons used during an SSR render.</span><span class="s3">\n</span><span class="s1">export type DynamicValidationState = {</span><span class="s3">\n  </span><span class="s1">hasSuspenseAboveBody: boolean</span><span class="s3">\n  </span><span class="s1">hasDynamicMetadata: boolean</span><span class="s3">\n  </span><span class="s1">hasDynamicViewport: boolean</span><span class="s3">\n  </span><span class="s1">hasAllowedDynamic: boolean</span><span class="s3">\n  </span><span class="s1">dynamicErrors: Array&lt;Error&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createDynamicTrackingState(</span><span class="s3">\n  </span><span class="s1">isDebugDynamicAccesses: boolean | undefined</span><span class="s3">\n</span><span class="s1">): DynamicTrackingState {</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">isDebugDynamicAccesses,</span><span class="s3">\n    </span><span class="s1">dynamicAccesses: [],</span><span class="s3">\n    </span><span class="s1">syncDynamicErrorWithStack: null,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createDynamicValidationState(): DynamicValidationState {</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">hasSuspenseAboveBody: false,</span><span class="s3">\n    </span><span class="s1">hasDynamicMetadata: false,</span><span class="s3">\n    </span><span class="s1">hasDynamicViewport: false,</span><span class="s3">\n    </span><span class="s1">hasAllowedDynamic: false,</span><span class="s3">\n    </span><span class="s1">dynamicErrors: [],</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getFirstDynamicReason(</span><span class="s3">\n  </span><span class="s1">trackingState: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): undefined | string {</span><span class="s3">\n  </span><span class="s1">return trackingState.dynamicAccesses[0]?.expression</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function communicates that the current scope should be treated as dynamic.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* In most cases this function is a no-op but if called during</span><span class="s3">\n </span><span class="s1">* a PPR prerender it will postpone the current sub-tree and calling</span><span class="s3">\n </span><span class="s1">* it during a normal prerender will cause the entire prerender to abort</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function markCurrentScopeAsDynamic(</span><span class="s3">\n  </span><span class="s1">store: WorkStore,</span><span class="s3">\n  </span><span class="s1">workUnitStore: undefined | Exclude&lt;WorkUnitStore, PrerenderStoreModern&gt;,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">// Inside cache scopes, marking a scope as dynamic has no effect,</span><span class="s3">\n        </span><span class="s1">// because the outer cache scope creates a cache boundary. This is</span><span class="s3">\n        </span><span class="s1">// subtly different from reading a dynamic data source, which is</span><span class="s3">\n        </span><span class="s1">// forbidden inside a cache scope.</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n        </span><span class="s1">// A private cache scope is already dynamic by definition.</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If we're forcing dynamic rendering or we're forcing static rendering, we</span><span class="s3">\n  </span><span class="s1">// don't need to do anything here because the entire page is already dynamic</span><span class="s3">\n  </span><span class="s1">// or it's static and it should not throw or postpone here.</span><span class="s3">\n  </span><span class="s1">if (store.forceDynamic || store.forceStatic) return</span><span class="s3">\n\n  </span><span class="s1">if (store.dynamicShouldError) {</span><span class="s3">\n    </span><span class="s1">throw new StaticGenBailoutError(</span><span class="s3">\n      </span><span class="s1">`Route ${store.route} with </span><span class="s3">\\</span><span class="s1">`dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;\\</span><span class="s1">` couldn't be rendered statically because it used </span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n        </span><span class="s1">return postponeWithTracking(</span><span class="s3">\n          </span><span class="s1">store.route,</span><span class="s3">\n          </span><span class="s1">expression,</span><span class="s3">\n          </span><span class="s1">workUnitStore.dynamicTracking</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n        </span><span class="s1">workUnitStore.revalidate = 0</span><span class="s3">\n\n        </span><span class="s1">// We aren't prerendering, but we are generating a static page. We need</span><span class="s3">\n        </span><span class="s1">// to bail out of static generation.</span><span class="s3">\n        </span><span class="s1">const err = new DynamicServerError(</span><span class="s3">\n          </span><span class="s1">`Route ${store.route} couldn't be rendered statically because it used ${expression}. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">store.dynamicUsageDescription = expression</span><span class="s3">\n        </span><span class="s1">store.dynamicUsageStack = err.stack</span><span class="s3">\n\n        </span><span class="s1">throw err</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n          </span><span class="s1">workUnitStore.usedDynamic = true</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function is meant to be used when prerendering without cacheComponents or PPR.</span><span class="s3">\n </span><span class="s1">* When called during a build it will cause Next.js to consider the route as dynamic.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function throwToInterruptStaticGeneration(</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">store: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreLegacy</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">// We aren't prerendering but we are generating a static page. We need to bail out of static generation</span><span class="s3">\n  </span><span class="s1">const err = new DynamicServerError(</span><span class="s3">\n    </span><span class="s1">`Route ${store.route} couldn't be rendered statically because it used </span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">prerenderStore.revalidate = 0</span><span class="s3">\n\n  </span><span class="s1">store.dynamicUsageDescription = expression</span><span class="s3">\n  </span><span class="s1">store.dynamicUsageStack = err.stack</span><span class="s3">\n\n  </span><span class="s1">throw err</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function should be used to track whether something dynamic happened even when</span><span class="s3">\n </span><span class="s1">* we are in a dynamic render. This is useful for Dev where all renders are dynamic but</span><span class="s3">\n </span><span class="s1">* we still track whether dynamic APIs were accessed for helpful messaging</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function trackDynamicDataInDynamicRender(workUnitStore: WorkUnitStore) {</span><span class="s3">\n  </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'cache':</span><span class="s3">\n    </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n      </span><span class="s1">// Inside cache scopes, marking a scope as dynamic has no effect,</span><span class="s3">\n      </span><span class="s1">// because the outer cache scope creates a cache boundary. This is</span><span class="s3">\n      </span><span class="s1">// subtly different from reading a dynamic data source, which is</span><span class="s3">\n      </span><span class="s1">// forbidden inside a cache scope.</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">// A private cache scope is already dynamic by definition.</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">case 'prerender':</span><span class="s3">\n    </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n    </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">case 'request':</span><span class="s3">\n      </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n        </span><span class="s1">workUnitStore.usedDynamic = true</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function abortOnSynchronousDynamicDataAccess(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">const reason = `Route ${route} needs to bail out of prerendering at this point because it used ${expression}.`</span><span class="s3">\n\n  </span><span class="s1">const error = createPrerenderInterruptedError(reason)</span><span class="s3">\n\n  </span><span class="s1">prerenderStore.controller.abort(error)</span><span class="s3">\n\n  </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">dynamicTracking.dynamicAccesses.push({</span><span class="s3">\n      </span><span class="s1">// When we aren't debugging, we don't need to create another error for the</span><span class="s3">\n      </span><span class="s1">// stack trace.</span><span class="s3">\n      </span><span class="s1">stack: dynamicTracking.isDebugDynamicAccesses</span><span class="s3">\n        </span><span class="s1">? new Error().stack</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n      </span><span class="s1">expression,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function abortOnSynchronousPlatformIOAccess(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">errorWithStack: Error,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n  </span><span class="s1">abortOnSynchronousDynamicDataAccess(route, expression, prerenderStore)</span><span class="s3">\n  </span><span class="s1">// It is important that we set this tracking value after aborting. Aborts are executed</span><span class="s3">\n  </span><span class="s1">// synchronously except for the case where you abort during render itself. By setting this</span><span class="s3">\n  </span><span class="s1">// value late we can use it to determine if any of the aborted tasks are the task that</span><span class="s3">\n  </span><span class="s1">// called the sync IO expression in the first place.</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">if (dynamicTracking.syncDynamicErrorWithStack === null) {</span><span class="s3">\n      </span><span class="s1">dynamicTracking.syncDynamicErrorWithStack = errorWithStack</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function trackSynchronousPlatformIOAccessInDev(</span><span class="s3">\n  </span><span class="s1">requestStore: RequestStore</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">// We don't actually have a controller to abort but we do the semantic equivalent by</span><span class="s3">\n  </span><span class="s1">// advancing the request store out of prerender mode</span><span class="s3">\n  </span><span class="s1">requestStore.prerenderPhase = false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* use this function when prerendering with cacheComponents. If we are doing a</span><span class="s3">\n </span><span class="s1">* prospective prerender we don't actually abort because we want to discover</span><span class="s3">\n </span><span class="s1">* all caches for the shell. If this is the actual prerender we do abort.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This function accepts a prerenderStore but the caller should ensure we're</span><span class="s3">\n </span><span class="s1">* actually running in cacheComponents mode.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function abortAndThrowOnSynchronousRequestDataAccess(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">errorWithStack: Error,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">const prerenderSignal = prerenderStore.controller.signal</span><span class="s3">\n  </span><span class="s1">if (prerenderSignal.aborted === false) {</span><span class="s3">\n    </span><span class="s1">// TODO it would be better to move this aborted check into the callsite so we can avoid making</span><span class="s3">\n    </span><span class="s1">// the error object when it isn't relevant to the aborting of the prerender however</span><span class="s3">\n    </span><span class="s1">// since we need the throw semantics regardless of whether we abort it is easier to land</span><span class="s3">\n    </span><span class="s1">// this way. See how this was handled with `abortOnSynchronousPlatformIOAccess` for a closer</span><span class="s3">\n    </span><span class="s1">// to ideal implementation</span><span class="s3">\n    </span><span class="s1">abortOnSynchronousDynamicDataAccess(route, expression, prerenderStore)</span><span class="s3">\n    </span><span class="s1">// It is important that we set this tracking value after aborting. Aborts are executed</span><span class="s3">\n    </span><span class="s1">// synchronously except for the case where you abort during render itself. By setting this</span><span class="s3">\n    </span><span class="s1">// value late we can use it to determine if any of the aborted tasks are the task that</span><span class="s3">\n    </span><span class="s1">// called the sync IO expression in the first place.</span><span class="s3">\n    </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n    </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n      </span><span class="s1">if (dynamicTracking.syncDynamicErrorWithStack === null) {</span><span class="s3">\n        </span><span class="s1">dynamicTracking.syncDynamicErrorWithStack = errorWithStack</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">throw createPrerenderInterruptedError(</span><span class="s3">\n    </span><span class="s1">`Route ${route} needs to bail out of prerendering at this point because it used ${expression}.`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Use this function when dynamically prerendering with dynamicIO.</span><span class="s3">\n </span><span class="s1">* We don't want to error, because it's better to return something</span><span class="s3">\n </span><span class="s1">* (and we've already aborted the render at the point where the sync dynamic error occured),</span><span class="s3">\n </span><span class="s1">* but we should log an error server-side.</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function warnOnSyncDynamicError(dynamicTracking: DynamicTrackingState) {</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking.syncDynamicErrorWithStack) {</span><span class="s3">\n    </span><span class="s1">// the server did something sync dynamic, likely</span><span class="s3">\n    </span><span class="s1">// leading to an early termination of the prerender.</span><span class="s3">\n    </span><span class="s1">console.error(dynamicTracking.syncDynamicErrorWithStack)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// For now these implementations are the same so we just reexport</span><span class="s3">\n</span><span class="s1">export const trackSynchronousRequestDataAccessInDev =</span><span class="s3">\n  </span><span class="s1">trackSynchronousPlatformIOAccessInDev</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This component will call `React.postpone` that throws the postponed error.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">type PostponeProps = {</span><span class="s3">\n  </span><span class="s1">reason: string</span><span class="s3">\n  </span><span class="s1">route: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">export function Postpone({ reason, route }: PostponeProps): never {</span><span class="s3">\n  </span><span class="s1">const prerenderStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">const dynamicTracking =</span><span class="s3">\n    </span><span class="s1">prerenderStore &amp;&amp; prerenderStore.type === 'prerender-ppr'</span><span class="s3">\n      </span><span class="s1">? prerenderStore.dynamicTracking</span><span class="s3">\n      </span><span class="s1">: null</span><span class="s3">\n  </span><span class="s1">postponeWithTracking(route, reason, dynamicTracking)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function postponeWithTracking(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">dynamicTracking: null | DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">assertPostpone()</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">dynamicTracking.dynamicAccesses.push({</span><span class="s3">\n      </span><span class="s1">// When we aren't debugging, we don't need to create another error for the</span><span class="s3">\n      </span><span class="s1">// stack trace.</span><span class="s3">\n      </span><span class="s1">stack: dynamicTracking.isDebugDynamicAccesses</span><span class="s3">\n        </span><span class="s1">? new Error().stack</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n      </span><span class="s1">expression,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">React.unstable_postpone(createPostponeReason(route, expression))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createPostponeReason(route: string, expression: string) {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">`Route ${route} needs to bail out of prerendering at this point because it used ${expression}. ` +</span><span class="s3">\n    </span><span class="s1">`React throws this special object to indicate where. It should not be caught by ` +</span><span class="s3">\n    </span><span class="s1">`your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isDynamicPostpone(err: unknown) {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">typeof err === 'object' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">err !== null &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof (err as any).message === 'string'</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return isDynamicPostponeReason((err as any).message)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function isDynamicPostponeReason(reason: string) {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">reason.includes(</span><span class="s3">\n      </span><span class="s1">'needs to bail out of prerendering at this point because it used'</span><span class="s3">\n    </span><span class="s1">) &amp;&amp;</span><span class="s3">\n    </span><span class="s1">reason.includes(</span><span class="s3">\n      </span><span class="s1">'Learn more: https://nextjs.org/docs/messages/ppr-caught-error'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">if (isDynamicPostponeReason(createPostponeReason('%%%', '^^^')) === false) {</span><span class="s3">\n  </span><span class="s1">throw new Error(</span><span class="s3">\n    </span><span class="s1">'Invariant: isDynamicPostpone misidentified a postpone reason. This is a bug in Next.js'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const NEXT_PRERENDER_INTERRUPTED = 'NEXT_PRERENDER_INTERRUPTED'</span><span class="s3">\n\n</span><span class="s1">function createPrerenderInterruptedError(message: string): Error {</span><span class="s3">\n  </span><span class="s1">const error = new Error(message)</span><span class="s3">\n  </span><span class="s1">;(error as any).digest = NEXT_PRERENDER_INTERRUPTED</span><span class="s3">\n  </span><span class="s1">return error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type DigestError = Error &amp; {</span><span class="s3">\n  </span><span class="s1">digest: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isPrerenderInterruptedError(</span><span class="s3">\n  </span><span class="s1">error: unknown</span><span class="s3">\n</span><span class="s1">): error is DigestError {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">typeof error === 'object' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">error !== null &amp;&amp;</span><span class="s3">\n    </span><span class="s1">(error as any).digest === NEXT_PRERENDER_INTERRUPTED &amp;&amp;</span><span class="s3">\n    </span><span class="s1">'name' in error &amp;&amp;</span><span class="s3">\n    </span><span class="s1">'message' in error &amp;&amp;</span><span class="s3">\n    </span><span class="s1">error instanceof Error</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function accessedDynamicData(</span><span class="s3">\n  </span><span class="s1">dynamicAccesses: Array&lt;DynamicAccess&gt;</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">return dynamicAccesses.length &gt; 0</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function consumeDynamicAccess(</span><span class="s3">\n  </span><span class="s1">serverDynamic: DynamicTrackingState,</span><span class="s3">\n  </span><span class="s1">clientDynamic: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): DynamicTrackingState['dynamicAccesses'] {</span><span class="s3">\n  </span><span class="s1">// We mutate because we only call this once we are no longer writing</span><span class="s3">\n  </span><span class="s1">// to the dynamicTrackingState and it's more efficient than creating a new</span><span class="s3">\n  </span><span class="s1">// array.</span><span class="s3">\n  </span><span class="s1">serverDynamic.dynamicAccesses.push(...clientDynamic.dynamicAccesses)</span><span class="s3">\n  </span><span class="s1">return serverDynamic.dynamicAccesses</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function formatDynamicAPIAccesses(</span><span class="s3">\n  </span><span class="s1">dynamicAccesses: Array&lt;DynamicAccess&gt;</span><span class="s3">\n</span><span class="s1">): string[] {</span><span class="s3">\n  </span><span class="s1">return dynamicAccesses</span><span class="s3">\n    </span><span class="s1">.filter(</span><span class="s3">\n      </span><span class="s1">(access): access is Required&lt;DynamicAccess&gt; =&gt;</span><span class="s3">\n        </span><span class="s1">typeof access.stack === 'string' &amp;&amp; access.stack.length &gt; 0</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">.map(({ expression, stack }) =&gt; {</span><span class="s3">\n      </span><span class="s1">stack = stack</span><span class="s3">\n        </span><span class="s1">.split('</span><span class="s3">\\</span><span class="s1">n')</span><span class="s3">\n        </span><span class="s1">// Remove the </span><span class="s3">\&quot;</span><span class="s1">Error: </span><span class="s3">\&quot; </span><span class="s1">prefix from the first line of the stack trace as</span><span class="s3">\n        </span><span class="s1">// well as the first 4 lines of the stack trace which is the distance</span><span class="s3">\n        </span><span class="s1">// from the user code and the `new Error().stack` call.</span><span class="s3">\n        </span><span class="s1">.slice(4)</span><span class="s3">\n        </span><span class="s1">.filter((line) =&gt; {</span><span class="s3">\n          </span><span class="s1">// Exclude Next.js internals from the stack trace.</span><span class="s3">\n          </span><span class="s1">if (line.includes('node_modules/next/')) {</span><span class="s3">\n            </span><span class="s1">return false</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Exclude anonymous functions from the stack trace.</span><span class="s3">\n          </span><span class="s1">if (line.includes(' (&lt;anonymous&gt;)')) {</span><span class="s3">\n            </span><span class="s1">return false</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Exclude Node.js internals from the stack trace.</span><span class="s3">\n          </span><span class="s1">if (line.includes(' (node:')) {</span><span class="s3">\n            </span><span class="s1">return false</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">return true</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">.join('</span><span class="s3">\\</span><span class="s1">n')</span><span class="s3">\n      </span><span class="s1">return `Dynamic API Usage Debug - ${expression}:</span><span class="s3">\\</span><span class="s1">n${stack}`</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function assertPostpone() {</span><span class="s3">\n  </span><span class="s1">if (!hasPostpone) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This is a bit of a hack to allow us to abort a render using a Postpone instance instead of an Error which changes React's</span><span class="s3">\n </span><span class="s1">* abort semantics slightly.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function createRenderInBrowserAbortSignal(): AbortSignal {</span><span class="s3">\n  </span><span class="s1">const controller = new AbortController()</span><span class="s3">\n  </span><span class="s1">controller.abort(new BailoutToCSRError('Render in Browser'))</span><span class="s3">\n  </span><span class="s1">return controller.signal</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* In a prerender, we may end up with hanging Promises as inputs due them</span><span class="s3">\n </span><span class="s1">* stalling on connection() or because they're loading dynamic data. In that</span><span class="s3">\n </span><span class="s1">* case we need to abort the encoding of arguments since they'll never complete.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function createHangingInputAbortSignal(</span><span class="s3">\n  </span><span class="s1">workUnitStore: WorkUnitStore</span><span class="s3">\n</span><span class="s1">): AbortSignal | undefined {</span><span class="s3">\n  </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'prerender':</span><span class="s3">\n    </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n      </span><span class="s1">const controller = new AbortController()</span><span class="s3">\n\n      </span><span class="s1">if (workUnitStore.cacheSignal) {</span><span class="s3">\n        </span><span class="s1">// If we have a cacheSignal it means we're in a prospective render. If</span><span class="s3">\n        </span><span class="s1">// the input we're waiting on is coming from another cache, we do want</span><span class="s3">\n        </span><span class="s1">// to wait for it so that we can resolve this cache entry too.</span><span class="s3">\n        </span><span class="s1">workUnitStore.cacheSignal.inputReady().then(() =&gt; {</span><span class="s3">\n          </span><span class="s1">controller.abort()</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">// Otherwise we're in the final render and we should already have all</span><span class="s3">\n        </span><span class="s1">// our caches filled.</span><span class="s3">\n        </span><span class="s1">// If the prerender uses stages, we have wait until the runtime stage,</span><span class="s3">\n        </span><span class="s1">// at which point all runtime inputs will be resolved.</span><span class="s3">\n        </span><span class="s1">// (otherwise, a runtime prerender might consider `cookies()` hanging</span><span class="s3">\n        </span><span class="s1">//  even though they'd resolve in the next task.)</span><span class="s3">\n        </span><span class="s1">//</span><span class="s3">\n        </span><span class="s1">// We might still be waiting on some microtasks so we</span><span class="s3">\n        </span><span class="s1">// wait one tick before giving up. When we give up, we still want to</span><span class="s3">\n        </span><span class="s1">// render the content of this cache as deeply as we can so that we can</span><span class="s3">\n        </span><span class="s1">// suspend as deeply as possible in the tree or not at all if we don't</span><span class="s3">\n        </span><span class="s1">// end up waiting for the input.</span><span class="s3">\n        </span><span class="s1">const runtimeStagePromise = getRuntimeStagePromise(workUnitStore)</span><span class="s3">\n        </span><span class="s1">if (runtimeStagePromise) {</span><span class="s3">\n          </span><span class="s1">runtimeStagePromise.then(() =&gt;</span><span class="s3">\n            </span><span class="s1">scheduleOnNextTick(() =&gt; controller.abort())</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">scheduleOnNextTick(() =&gt; controller.abort())</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return controller.signal</span><span class="s3">\n    </span><span class="s1">case 'prerender-client':</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n    </span><span class="s1">case 'request':</span><span class="s3">\n    </span><span class="s1">case 'cache':</span><span class="s3">\n    </span><span class="s1">case 'private-cache':</span><span class="s3">\n    </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n      </span><span class="s1">return undefined</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function annotateDynamicAccess(</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">dynamicTracking.dynamicAccesses.push({</span><span class="s3">\n      </span><span class="s1">stack: dynamicTracking.isDebugDynamicAccesses</span><span class="s3">\n        </span><span class="s1">? new Error().stack</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n      </span><span class="s1">expression,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function useDynamicRouteParams(expression: string) {</span><span class="s3">\n  </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workStore &amp;&amp; workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender': {</span><span class="s3">\n        </span><span class="s1">const fallbackParams = workUnitStore.fallbackRouteParams</span><span class="s3">\n        </span><span class="s1">if (fallbackParams &amp;&amp; fallbackParams.size &gt; 0) {</span><span class="s3">\n          </span><span class="s1">// We are in a prerender with cacheComponents semantics. We are going to</span><span class="s3">\n          </span><span class="s1">// hang here and never resolve. This will cause the currently</span><span class="s3">\n          </span><span class="s1">// rendering component to effectively be a dynamic hole.</span><span class="s3">\n          </span><span class="s1">React.use(</span><span class="s3">\n            </span><span class="s1">makeHangingPromise(</span><span class="s3">\n              </span><span class="s1">workUnitStore.renderSignal,</span><span class="s3">\n              </span><span class="s1">workStore.route,</span><span class="s3">\n              </span><span class="s1">expression</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr': {</span><span class="s3">\n        </span><span class="s1">const fallbackParams = workUnitStore.fallbackRouteParams</span><span class="s3">\n        </span><span class="s1">if (fallbackParams &amp;&amp; fallbackParams.size &gt; 0) {</span><span class="s3">\n          </span><span class="s1">return postponeWithTracking(</span><span class="s3">\n            </span><span class="s1">workStore.route,</span><span class="s3">\n            </span><span class="s1">expression,</span><span class="s3">\n            </span><span class="s1">workUnitStore.dynamicTracking</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">` was called during a runtime prerender. Next.js should be preventing ${expression} from being included in server components statically, but did not in this case.`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">` was called inside a cache scope. Next.js should be preventing ${expression} from being included in server components statically, but did not in this case.`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const hasSuspenseRegex = /</span><span class="s3">\\</span><span class="s1">n</span><span class="s3">\\</span><span class="s1">s+at Suspense </span><span class="s3">\\</span><span class="s1">(&lt;anonymous&gt;</span><span class="s3">\\</span><span class="s1">)/</span><span class="s3">\n\n</span><span class="s1">// Common implicit body tags that React will treat as body when placed directly in html</span><span class="s3">\n</span><span class="s1">const bodyAndImplicitTags =</span><span class="s3">\n  </span><span class="s1">'body|div|main|section|article|aside|header|footer|nav|form|p|span|h1|h2|h3|h4|h5|h6'</span><span class="s3">\n\n</span><span class="s1">// Detects when RootLayoutBoundary (our framework marker component) appears</span><span class="s3">\n</span><span class="s1">// after Suspense in the component stack, indicating the root layout is wrapped</span><span class="s3">\n</span><span class="s1">// within a Suspense boundary. Ensures no body/html/implicit-body components are in between.</span><span class="s3">\n</span><span class="s1">//</span><span class="s3">\n</span><span class="s1">// Example matches:</span><span class="s3">\n</span><span class="s1">//   at Suspense (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//   at __next_root_layout_boundary__ (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//</span><span class="s3">\n</span><span class="s1">// Or with other components in between (but not body/html/implicit-body):</span><span class="s3">\n</span><span class="s1">//   at Suspense (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//   at SomeComponent (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//   at __next_root_layout_boundary__ (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">const hasSuspenseBeforeRootLayoutWithoutBodyOrImplicitBodyRegex = new RegExp(</span><span class="s3">\n  </span><span class="s1">`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at Suspense </span><span class="s3">\\\\</span><span class="s1">(&lt;anonymous&gt;</span><span class="s3">\\\\</span><span class="s1">)(?:(?!</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at (?:${bodyAndImplicitTags}) </span><span class="s3">\\\\</span><span class="s1">(&lt;anonymous&gt;</span><span class="s3">\\\\</span><span class="s1">))[</span><span class="s3">\\\\</span><span class="s1">s</span><span class="s3">\\\\</span><span class="s1">S])*?</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${ROOT_LAYOUT_BOUNDARY_NAME} </span><span class="s3">\\\\</span><span class="s1">([^</span><span class="s3">\\\\</span><span class="s1">n]*</span><span class="s3">\\\\</span><span class="s1">)`</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n\n</span><span class="s1">const hasMetadataRegex = new RegExp(</span><span class="s3">\n  </span><span class="s1">`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${METADATA_BOUNDARY_NAME}[</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s]`</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n</span><span class="s1">const hasViewportRegex = new RegExp(</span><span class="s3">\n  </span><span class="s1">`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${VIEWPORT_BOUNDARY_NAME}[</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s]`</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n</span><span class="s1">const hasOutletRegex = new RegExp(`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${OUTLET_BOUNDARY_NAME}[</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s]`)</span><span class="s3">\n\n</span><span class="s1">export function trackAllowedDynamicAccess(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">componentStack: string,</span><span class="s3">\n  </span><span class="s1">dynamicValidation: DynamicValidationState,</span><span class="s3">\n  </span><span class="s1">clientDynamic: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (hasOutletRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">// We don't need to track that this is dynamic. It is only so when something else is also dynamic.</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (hasMetadataRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasDynamicMetadata = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (hasViewportRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasDynamicViewport = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (</span><span class="s3">\n    </span><span class="s1">hasSuspenseBeforeRootLayoutWithoutBodyOrImplicitBodyRegex.test(</span><span class="s3">\n      </span><span class="s1">componentStack</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">// For Suspense within body, the prelude wouldn't be empty so it wouldn't violate the empty static shells rule.</span><span class="s3">\n    </span><span class="s1">// But if you have Suspense above body, the prelude is empty but we allow that because having Suspense</span><span class="s3">\n    </span><span class="s1">// is an explicit signal from the user that they acknowledge the empty shell and want dynamic rendering.</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasAllowedDynamic = true</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasSuspenseAboveBody = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (hasSuspenseRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">// this error had a Suspense boundary above it so we don't need to report it as a source</span><span class="s3">\n    </span><span class="s1">// of disallowed</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasAllowedDynamic = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (clientDynamic.syncDynamicErrorWithStack) {</span><span class="s3">\n    </span><span class="s1">// This task was the task that called the sync error.</span><span class="s3">\n    </span><span class="s1">dynamicValidation.dynamicErrors.push(</span><span class="s3">\n      </span><span class="s1">clientDynamic.syncDynamicErrorWithStack</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">const message = `Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot;</span><span class="s1">: A component accessed data, headers, params, searchParams, or a short-lived cache without a Suspense boundary nor a </span><span class="s3">\&quot;</span><span class="s1">use cache</span><span class="s3">\&quot; </span><span class="s1">above it. See more info: https://nextjs.org/docs/messages/next-prerender-missing-suspense`</span><span class="s3">\n    </span><span class="s1">const error = createErrorWithComponentOrOwnerStack(message, componentStack)</span><span class="s3">\n    </span><span class="s1">dynamicValidation.dynamicErrors.push(error)</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* In dev mode, we prefer using the owner stack, otherwise the provided</span><span class="s3">\n </span><span class="s1">* component stack is used.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function createErrorWithComponentOrOwnerStack(</span><span class="s3">\n  </span><span class="s1">message: string,</span><span class="s3">\n  </span><span class="s1">componentStack: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const ownerStack =</span><span class="s3">\n    </span><span class="s1">process.env.NODE_ENV !== 'production' &amp;&amp; React.captureOwnerStack</span><span class="s3">\n      </span><span class="s1">? React.captureOwnerStack()</span><span class="s3">\n      </span><span class="s1">: null</span><span class="s3">\n\n  </span><span class="s1">const error = new Error(message)</span><span class="s3">\n  </span><span class="s1">error.stack = error.name + ': ' + message + (ownerStack ?? componentStack)</span><span class="s3">\n  </span><span class="s1">return error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export enum PreludeState {</span><span class="s3">\n  </span><span class="s1">Full = 0,</span><span class="s3">\n  </span><span class="s1">Empty = 1,</span><span class="s3">\n  </span><span class="s1">Errored = 2,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function logDisallowedDynamicError(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">error: Error</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">console.error(error)</span><span class="s3">\n\n  </span><span class="s1">if (!workStore.dev) {</span><span class="s3">\n    </span><span class="s1">if (workStore.hasReadableErrorStacks) {</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running </span><span class="s3">\\</span><span class="s1">`next dev</span><span class="s3">\\</span><span class="s1">`, then open </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">in your browser to investigate the error.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">console.error(`To get a more detailed stack trace and pinpoint the issue, try one of the following:</span><span class="s3">\n  </span><span class="s1">- Start the app in development mode by running </span><span class="s3">\\</span><span class="s1">`next dev</span><span class="s3">\\</span><span class="s1">`, then open </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">in your browser to investigate the error.</span><span class="s3">\n  </span><span class="s1">- Rerun the production build with </span><span class="s3">\\</span><span class="s1">`next build --debug-prerender</span><span class="s3">\\</span><span class="s1">` to generate better stack traces.`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function throwIfDisallowedDynamic(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prelude: PreludeState,</span><span class="s3">\n  </span><span class="s1">dynamicValidation: DynamicValidationState,</span><span class="s3">\n  </span><span class="s1">serverDynamic: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">if (prelude !== PreludeState.Full) {</span><span class="s3">\n    </span><span class="s1">if (dynamicValidation.hasSuspenseAboveBody) {</span><span class="s3">\n      </span><span class="s1">// This route has opted into allowing fully dynamic rendering</span><span class="s3">\n      </span><span class="s1">// by including a Suspense boundary above the body. In this case</span><span class="s3">\n      </span><span class="s1">// a lack of a shell is not considered disallowed so we simply return</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (serverDynamic.syncDynamicErrorWithStack) {</span><span class="s3">\n      </span><span class="s1">// There is no shell and the server did something sync dynamic likely</span><span class="s3">\n      </span><span class="s1">// leading to an early termination of the prerender before the shell</span><span class="s3">\n      </span><span class="s1">// could be completed. We terminate the build/validating render.</span><span class="s3">\n      </span><span class="s1">logDisallowedDynamicError(</span><span class="s3">\n        </span><span class="s1">workStore,</span><span class="s3">\n        </span><span class="s1">serverDynamic.syncDynamicErrorWithStack</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// We didn't have any sync bailouts but there may be user code which</span><span class="s3">\n    </span><span class="s1">// blocked the root. We would have captured these during the prerender</span><span class="s3">\n    </span><span class="s1">// and can log them here and then terminate the build/validating render</span><span class="s3">\n    </span><span class="s1">const dynamicErrors = dynamicValidation.dynamicErrors</span><span class="s3">\n    </span><span class="s1">if (dynamicErrors.length &gt; 0) {</span><span class="s3">\n      </span><span class="s1">for (let i = 0; i &lt; dynamicErrors.length; i++) {</span><span class="s3">\n        </span><span class="s1">logDisallowedDynamicError(workStore, dynamicErrors[i])</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// If we got this far then the only other thing that could be blocking</span><span class="s3">\n    </span><span class="s1">// the root is dynamic Viewport. If this is dynamic then</span><span class="s3">\n    </span><span class="s1">// you need to opt into that by adding a Suspense boundary above the body</span><span class="s3">\n    </span><span class="s1">// to indicate your are ok with fully dynamic rendering.</span><span class="s3">\n    </span><span class="s1">if (dynamicValidation.hasDynamicViewport) {</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">has a </span><span class="s3">\\</span><span class="s1">`generateViewport</span><span class="s3">\\</span><span class="s1">` that depends on Request data (</span><span class="s3">\\</span><span class="s1">`cookies()</span><span class="s3">\\</span><span class="s1">`, etc...) or uncached external data (</span><span class="s3">\\</span><span class="s1">`fetch(...)</span><span class="s3">\\</span><span class="s1">`, etc...) without explicitly allowing fully dynamic rendering. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-viewport`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (prelude === PreludeState.Empty) {</span><span class="s3">\n      </span><span class="s1">// If we ever get this far then we messed up the tracking of invalid dynamic.</span><span class="s3">\n      </span><span class="s1">// We still adhere to the constraint that you must produce a shell but invite the</span><span class="s3">\n      </span><span class="s1">// user to report this as a bug in Next.js.</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">did not produce a static shell and Next.js was unable to determine a reason. This is a bug in Next.js.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">dynamicValidation.hasAllowedDynamic === false &amp;&amp;</span><span class="s3">\n      </span><span class="s1">dynamicValidation.hasDynamicMetadata</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">has a </span><span class="s3">\\</span><span class="s1">`generateMetadata</span><span class="s3">\\</span><span class="s1">` that depends on Request data (</span><span class="s3">\\</span><span class="s1">`cookies()</span><span class="s3">\\</span><span class="s1">`, etc...) or uncached external data (</span><span class="s3">\\</span><span class="s1">`fetch(...)</span><span class="s3">\\</span><span class="s1">`, etc...) when the rest of the route does not. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-metadata`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function delayUntilRuntimeStage&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModernRuntime,</span><span class="s3">\n  </span><span class="s1">result: Promise&lt;T&gt;</span><span class="s3">\n</span><span class="s1">): Promise&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">if (prerenderStore.runtimeStagePromise) {</span><span class="s3">\n    </span><span class="s1">return prerenderStore.runtimeStagePromise.then(() =&gt; result)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return result</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;Postpone&quot;</span><span class="s0">,</span><span class="s1">&quot;PreludeState&quot;</span><span class="s0">,</span><span class="s1">&quot;abortAndThrowOnSynchronousRequestDataAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;abortOnSynchronousPlatformIOAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;accessedDynamicData&quot;</span><span class="s0">,</span><span class="s1">&quot;annotateDynamicAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;consumeDynamicAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;createDynamicTrackingState&quot;</span><span class="s0">,</span><span class="s1">&quot;createDynamicValidationState&quot;</span><span class="s0">,</span><span class="s1">&quot;createHangingInputAbortSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;createRenderInBrowserAbortSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;delayUntilRuntimeStage&quot;</span><span class="s0">,</span><span class="s1">&quot;formatDynamicAPIAccesses&quot;</span><span class="s0">,</span><span class="s1">&quot;getFirstDynamicReason&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;isPrerenderInterruptedError&quot;</span><span class="s0">,</span><span class="s1">&quot;logDisallowedDynamicError&quot;</span><span class="s0">,</span><span class="s1">&quot;markCurrentScopeAsDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;postponeWithTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;throwIfDisallowedDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;throwToInterruptStaticGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;trackAllowedDynamicAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;trackDynamicDataInDynamicRender&quot;</span><span class="s0">,</span><span class="s1">&quot;trackSynchronousPlatformIOAccessInDev&quot;</span><span class="s0">,</span><span class="s1">&quot;trackSynchronousRequestDataAccessInDev&quot;</span><span class="s0">,</span><span class="s1">&quot;useDynamicRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;warnOnSyncDynamicError&quot;</span><span class="s0">,</span><span class="s1">&quot;hasPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;React&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_postpone&quot;</span><span class="s0">,</span><span class="s1">&quot;isDebugDynamicAccesses&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicAccesses&quot;</span><span class="s0">,</span><span class="s1">&quot;syncDynamicErrorWithStack&quot;</span><span class="s0">,</span><span class="s1">&quot;hasSuspenseAboveBody&quot;</span><span class="s0">,</span><span class="s1">&quot;hasDynamicMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;hasDynamicViewport&quot;</span><span class="s0">,</span><span class="s1">&quot;hasAllowedDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicErrors&quot;</span><span class="s0">,</span><span class="s1">&quot;trackingState&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;store&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitStore&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;forceDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;forceStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicShouldError&quot;</span><span class="s0">,</span><span class="s1">&quot;StaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;DynamicServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicUsageDescription&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicUsageStack&quot;</span><span class="s0">,</span><span class="s1">&quot;stack&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;usedDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderStore&quot;</span><span class="s0">,</span><span class="s1">&quot;abortOnSynchronousDynamicDataAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;reason&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;createPrerenderInterruptedError&quot;</span><span class="s0">,</span><span class="s1">&quot;controller&quot;</span><span class="s0">,</span><span class="s1">&quot;abort&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;errorWithStack&quot;</span><span class="s0">,</span><span class="s1">&quot;requestStore&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderPhase&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;aborted&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;assertPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;createPostponeReason&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicPostponeReason&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_PRERENDER_INTERRUPTED&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;serverDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;clientDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;access&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;line&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;AbortController&quot;</span><span class="s0">,</span><span class="s1">&quot;BailoutToCSRError&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;inputReady&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;runtimeStagePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;getRuntimeStagePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;scheduleOnNextTick&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackParams&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;size&quot;</span><span class="s0">,</span><span class="s1">&quot;use&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;renderSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;hasSuspenseRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;bodyAndImplicitTags&quot;</span><span class="s0">,</span><span class="s1">&quot;hasSuspenseBeforeRootLayoutWithoutBodyOrImplicitBodyRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_LAYOUT_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;hasMetadataRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;METADATA_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;hasViewportRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;VIEWPORT_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;hasOutletRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;OUTLET_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;componentStack&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicValidation&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;createErrorWithComponentOrOwnerStack&quot;</span><span class="s0">,</span><span class="s1">&quot;ownerStack&quot;</span><span class="s0">,</span><span class="s1">&quot;captureOwnerStack&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;dev&quot;</span><span class="s0">,</span><span class="s1">&quot;hasReadableErrorStacks&quot;</span><span class="s0">,</span><span class="s1">&quot;prelude&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">12907</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/request/utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { StaticGenBailoutError } from '../../client/components/static-generation-bailout'</span><span class="s3">\n</span><span class="s1">import { afterTaskAsyncStorage } from '../app-render/after-task-async-storage.external'</span><span class="s3">\n</span><span class="s1">import type { WorkStore } from '../app-render/work-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">export function throwWithStaticGenerationBailoutError(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">throw new StaticGenBailoutError(</span><span class="s3">\n    </span><span class="s1">`Route ${route} couldn't be rendered statically because it used ${expression}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function throwWithStaticGenerationBailoutErrorWithDynamicError(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">throw new StaticGenBailoutError(</span><span class="s3">\n    </span><span class="s1">`Route ${route} with </span><span class="s3">\\</span><span class="s1">`dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;\\</span><span class="s1">` couldn't be rendered statically because it used ${expression}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function throwForSearchParamsAccessInUseCache(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">constructorOpt: Function</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">const error = new Error(</span><span class="s3">\n    </span><span class="s1">`Route ${workStore.route} used </span><span class="s3">\&quot;</span><span class="s1">searchParams</span><span class="s3">\&quot; </span><span class="s1">inside </span><span class="s3">\&quot;</span><span class="s1">use cache</span><span class="s3">\&quot;</span><span class="s1">. Accessing dynamic request data inside a cache scope is not supported. If you need some search params inside a cached function await </span><span class="s3">\&quot;</span><span class="s1">searchParams</span><span class="s3">\&quot; </span><span class="s1">outside of the cached function and pass only the required search params as arguments to the cached function. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">Error.captureStackTrace(error, constructorOpt)</span><span class="s3">\n  </span><span class="s1">workStore.invalidDynamicUsageError ??= error</span><span class="s3">\n\n  </span><span class="s1">throw error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isRequestAPICallableInsideAfter() {</span><span class="s3">\n  </span><span class="s1">const afterTaskStore = afterTaskAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">return afterTaskStore?.rootTaskSpawnPhase === 'action'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isRequestAPICallableInsideAfter&quot;</span><span class="s0">,</span><span class="s1">&quot;throwForSearchParamsAccessInUseCache&quot;</span><span class="s0">,</span><span class="s1">&quot;throwWithStaticGenerationBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;throwWithStaticGenerationBailoutErrorWithDynamicError&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;StaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;constructorOpt&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;captureStackTrace&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidDynamicUsageError&quot;</span><span class="s0">,</span><span class="s1">&quot;afterTaskStore&quot;</span><span class="s0">,</span><span class="s1">&quot;afterTaskAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;rootTaskSpawnPhase&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;;IAoCgBA,+BAA+B,EAAA;eAA/BA;;IAdAC,oCAAoC,EAAA;eAApCA;;IAlBAC,qCAAqC,EAAA;eAArCA;;IASAC,qDAAqD,EAAA;eAArDA;;;yCAbsB;+CACA;AAG/B,SAASD,sCACdE,KAAa,EACbC,UAAkB;IAElB,MAAM,OAAA,cAEL,CAFK,IAAIC,yBAAAA,qBAAqB,CAC7B,CAAC,MAAM,EAAEF,MAAM,iDAAiD,EAAEC,WAAW,0HAA0H,CAAC,GADpM,qBAAA;eAAA;oBAAA;sBAAA;IAEN;AACF;AAEO,SAASF,sDACdC,KAAa,EACbC,UAAkB;IAElB,MAAM,OAAA,cAEL,CAFK,IAAIC,yBAAAA,qBAAqB,CAC7B,CAAC,MAAM,EAAEF,MAAM,4EAA4E,EAAEC,WAAW,0HAA0H,CAAC,GAD/N,qBAAA;eAAA;oBAAA;sBAAA;IAEN;AACF;AAEO,SAASJ,qCACdM,SAAoB,EACpBC,cAAwB;IAExB,MAAMC,QAAQ,OAAA,cAEb,CAFa,IAAIC,MAChB,CAAC,MAAM,EAAEH,UAAUH,KAAK,CAAC,uXAAuX,CAAC,GADrY,qBAAA;eAAA;oBAAA;sBAAA;IAEd;IAEAM,MAAMC,iBAAiB,CAACF,OAAOD;IAC/BD,UAAUK,wBAAwB,KAAKH;IAEvC,MAAMA;AACR;AAEO,SAAST;IACd,MAAMa,iBAAiBC,+BAAAA,qBAAqB,CAACC,QAAQ;IACrD,OAAOF,CAAAA,kBAAAA,OAAAA,KAAAA,IAAAA,eAAgBG,kBAAkB,MAAK;AAChD&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">12970</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/request/connection.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { workAsyncStorage } from '../app-render/work-async-storage.external'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">throwForMissingRequestStore,</span><span class="s3">\n  </span><span class="s1">workUnitAsyncStorage,</span><span class="s3">\n</span><span class="s1">} from '../app-render/work-unit-async-storage.external'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">postponeWithTracking,</span><span class="s3">\n  </span><span class="s1">throwToInterruptStaticGeneration,</span><span class="s3">\n  </span><span class="s1">trackDynamicDataInDynamicRender,</span><span class="s3">\n</span><span class="s1">} from '../app-render/dynamic-rendering'</span><span class="s3">\n</span><span class="s1">import { StaticGenBailoutError } from '../../client/components/static-generation-bailout'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">makeHangingPromise,</span><span class="s3">\n  </span><span class="s1">makeDevtoolsIOAwarePromise,</span><span class="s3">\n</span><span class="s1">} from '../dynamic-rendering-utils'</span><span class="s3">\n</span><span class="s1">import { isRequestAPICallableInsideAfter } from './utils'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function allows you to indicate that you require an actual user Request before continuing.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* During prerendering it will never resolve and during rendering it resolves immediately.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function connection(): Promise&lt;void&gt; {</span><span class="s3">\n  </span><span class="s1">const callingExpression = 'connection'</span><span class="s3">\n  </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n\n  </span><span class="s1">if (workStore) {</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">workUnitStore &amp;&amp;</span><span class="s3">\n      </span><span class="s1">workUnitStore.phase === 'after' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">!isRequestAPICallableInsideAfter()</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">throw new Error(</span><span class="s3">\n        </span><span class="s1">`Route ${workStore.route} used </span><span class="s3">\&quot;</span><span class="s1">connection</span><span class="s3">\&quot; </span><span class="s1">inside </span><span class="s3">\&quot;</span><span class="s1">after(...)</span><span class="s3">\&quot;</span><span class="s1">. The </span><span class="s3">\\</span><span class="s1">`connection()</span><span class="s3">\\</span><span class="s1">` function is used to indicate the subsequent code must only run when there is an actual Request, but </span><span class="s3">\&quot;</span><span class="s1">after(...)</span><span class="s3">\&quot; </span><span class="s1">executes after the request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (workStore.forceStatic) {</span><span class="s3">\n      </span><span class="s1">// When using forceStatic, we override all other logic and always just</span><span class="s3">\n      </span><span class="s1">// return a resolving promise without tracking.</span><span class="s3">\n      </span><span class="s1">return Promise.resolve(undefined)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (workStore.dynamicShouldError) {</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError(</span><span class="s3">\n        </span><span class="s1">`Route ${workStore.route} with </span><span class="s3">\\</span><span class="s1">`dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;\\</span><span class="s1">` couldn't be rendered statically because it used </span><span class="s3">\\</span><span class="s1">`connection</span><span class="s3">\\</span><span class="s1">`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n      </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n        </span><span class="s1">case 'cache': {</span><span class="s3">\n          </span><span class="s1">const error = new Error(</span><span class="s3">\n            </span><span class="s1">`Route ${workStore.route} used </span><span class="s3">\&quot;</span><span class="s1">connection</span><span class="s3">\&quot; </span><span class="s1">inside </span><span class="s3">\&quot;</span><span class="s1">use cache</span><span class="s3">\&quot;</span><span class="s1">. The </span><span class="s3">\\</span><span class="s1">`connection()</span><span class="s3">\\</span><span class="s1">` function is used to indicate the subsequent code must only run when there is an actual request, but caches must be able to be produced before a request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">Error.captureStackTrace(error, connection)</span><span class="s3">\n          </span><span class="s1">workStore.invalidDynamicUsageError ??= error</span><span class="s3">\n          </span><span class="s1">throw error</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">case 'private-cache': {</span><span class="s3">\n          </span><span class="s1">// It might not be intuitive to throw for private caches as well, but</span><span class="s3">\n          </span><span class="s1">// we don't consider runtime prefetches as </span><span class="s3">\&quot;</span><span class="s1">actual requests</span><span class="s3">\&quot; </span><span class="s1">(in the</span><span class="s3">\n          </span><span class="s1">// navigation sense), despite allowing them to read cookies.</span><span class="s3">\n          </span><span class="s1">const error = new Error(</span><span class="s3">\n            </span><span class="s1">`Route ${workStore.route} used </span><span class="s3">\&quot;</span><span class="s1">connection</span><span class="s3">\&quot; </span><span class="s1">inside </span><span class="s3">\&quot;</span><span class="s1">use cache: private</span><span class="s3">\&quot;</span><span class="s1">. The </span><span class="s3">\\</span><span class="s1">`connection()</span><span class="s3">\\</span><span class="s1">` function is used to indicate the subsequent code must only run when there is an actual navigation request, but caches must be able to be produced before a navigation request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">Error.captureStackTrace(error, connection)</span><span class="s3">\n          </span><span class="s1">workStore.invalidDynamicUsageError ??= error</span><span class="s3">\n          </span><span class="s1">throw error</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n          </span><span class="s1">throw new Error(</span><span class="s3">\n            </span><span class="s1">`Route ${workStore.route} used </span><span class="s3">\&quot;</span><span class="s1">connection</span><span class="s3">\&quot; </span><span class="s1">inside a function cached with </span><span class="s3">\&quot;</span><span class="s1">unstable_cache(...)</span><span class="s3">\&quot;</span><span class="s1">. The </span><span class="s3">\\</span><span class="s1">`connection()</span><span class="s3">\\</span><span class="s1">` function is used to indicate the subsequent code must only run when there is an actual Request, but caches must be able to be produced before a Request so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">case 'prerender':</span><span class="s3">\n        </span><span class="s1">case 'prerender-client':</span><span class="s3">\n        </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n          </span><span class="s1">// We return a promise that never resolves to allow the prerender to</span><span class="s3">\n          </span><span class="s1">// stall at this point.</span><span class="s3">\n          </span><span class="s1">return makeHangingPromise(</span><span class="s3">\n            </span><span class="s1">workUnitStore.renderSignal,</span><span class="s3">\n            </span><span class="s1">workStore.route,</span><span class="s3">\n            </span><span class="s1">'`connection()`'</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n          </span><span class="s1">// We use React's postpone API to interrupt rendering here to create a</span><span class="s3">\n          </span><span class="s1">// dynamic hole</span><span class="s3">\n          </span><span class="s1">return postponeWithTracking(</span><span class="s3">\n            </span><span class="s1">workStore.route,</span><span class="s3">\n            </span><span class="s1">'connection',</span><span class="s3">\n            </span><span class="s1">workUnitStore.dynamicTracking</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n          </span><span class="s1">// We throw an error here to interrupt prerendering to mark the route</span><span class="s3">\n          </span><span class="s1">// as dynamic</span><span class="s3">\n          </span><span class="s1">return throwToInterruptStaticGeneration(</span><span class="s3">\n            </span><span class="s1">'connection',</span><span class="s3">\n            </span><span class="s1">workStore,</span><span class="s3">\n            </span><span class="s1">workUnitStore</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">case 'request':</span><span class="s3">\n          </span><span class="s1">trackDynamicDataInDynamicRender(workUnitStore)</span><span class="s3">\n          </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n            </span><span class="s1">// Semantically we only need the dev tracking when running in `next dev`</span><span class="s3">\n            </span><span class="s1">// but since you would never use next dev with production NODE_ENV we use this</span><span class="s3">\n            </span><span class="s1">// as a proxy so we can statically exclude this code from production builds.</span><span class="s3">\n            </span><span class="s1">return makeDevtoolsIOAwarePromise(undefined)</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">return Promise.resolve(undefined)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">default:</span><span class="s3">\n          </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If we end up here, there was no work store or work unit store present.</span><span class="s3">\n  </span><span class="s1">throwForMissingRequestStore(callingExpression)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;connection&quot;</span><span class="s0">,</span><span class="s1">&quot;callingExpression&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitStore&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;phase&quot;</span><span class="s0">,</span><span class="s1">&quot;isRequestAPICallableInsideAfter&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;forceStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicShouldError&quot;</span><span class="s0">,</span><span class="s1">&quot;StaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;captureStackTrace&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidDynamicUsageError&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;renderSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;postponeWithTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;throwToInterruptStaticGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;trackDynamicDataInDynamicRender&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;makeDevtoolsIOAwarePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;throwForMissingRequestStore&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAsBgBA,cAAAA;;;eAAAA;;;0CAtBiB;8CAI1B;kCAKA;yCAC+B;uCAI/B;uBACyC;AAOzC,SAASA;IACd,MAAMC,oBAAoB;IAC1B,MAAMC,YAAYC,0BAAAA,gBAAgB,CAACC,QAAQ;IAC3C,MAAMC,gBAAgBC,8BAAAA,oBAAoB,CAACF,QAAQ;IAEnD,IAAIF,WAAW;QACb,IACEG,iBACAA,cAAcE,KAAK,KAAK,WACxB,CAACC,CAAAA,GAAAA,OAAAA,+BAA+B,KAChC;YACA,MAAM,OAAA,cAEL,CAFK,IAAIC,MACR,CAAC,MAAM,EAAEP,UAAUQ,KAAK,CAAC,6UAA6U,CAAC,GADnW,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;QAEA,IAAIR,UAAUS,WAAW,EAAE;YACzB,sEAAsE;YACtE,+CAA+C;YAC/C,OAAOC,QAAQC,OAAO,CAACC;QACzB;QAEA,IAAIZ,UAAUa,kBAAkB,EAAE;YAChC,MAAM,OAAA,cAEL,CAFK,IAAIC,yBAAAA,qBAAqB,CAC7B,CAAC,MAAM,EAAEd,UAAUQ,KAAK,CAAC,oNAAoN,CAAC,GAD1O,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;QAEA,IAAIL,eAAe;YACjB,OAAQA,cAAcY,IAAI;gBACxB,KAAK;oBAAS;wBACZ,MAAMC,QAAQ,OAAA,cAEb,CAFa,IAAIT,MAChB,CAAC,MAAM,EAAEP,UAAUQ,KAAK,CAAC,kVAAkV,CAAC,GADhW,qBAAA;mCAAA;wCAAA;0CAAA;wBAEd;wBACAD,MAAMU,iBAAiB,CAACD,OAAOlB;wBAC/BE,UAAUkB,wBAAwB,KAAKF;wBACvC,MAAMA;oBACR;gBACA,KAAK;oBAAiB;wBACpB,qEAAqE;wBACrE,oEAAoE;wBACpE,4DAA4D;wBAC5D,MAAMA,QAAQ,OAAA,cAEb,CAFa,IAAIT,MAChB,CAAC,MAAM,EAAEP,UAAUQ,KAAK,CAAC,iXAAiX,CAAC,GAD/X,qBAAA;mCAAA;wCAAA;0CAAA;wBAEd;wBACAD,MAAMU,iBAAiB,CAACD,OAAOlB;wBAC/BE,UAAUkB,wBAAwB,KAAKF;wBACvC,MAAMA;oBACR;gBACA,KAAK;oBACH,MAAM,OAAA,cAEL,CAFK,IAAIT,MACR,CAAC,MAAM,EAAEP,UAAUQ,KAAK,CAAC,0XAA0X,CAAC,GADhZ,qBAAA;+BAAA;oCAAA;sCAAA;oBAEN;gBACF,KAAK;gBACL,KAAK;gBACL,KAAK;oBACH,oEAAoE;oBACpE,uBAAuB;oBACvB,OAAOW,CAAAA,GAAAA,uBAAAA,kBAAkB,EACvBhB,cAAciB,YAAY,EAC1BpB,UAAUQ,KAAK,EACf;gBAEJ,KAAK;oBACH,sEAAsE;oBACtE,eAAe;oBACf,OAAOa,CAAAA,GAAAA,kBAAAA,oBAAoB,EACzBrB,UAAUQ,KAAK,EACf,cACAL,cAAcmB,eAAe;gBAEjC,KAAK;oBACH,qEAAqE;oBACrE,aAAa;oBACb,OAAOC,CAAAA,GAAAA,kBAAAA,gCAAgC,EACrC,cACAvB,WACAG;gBAEJ,KAAK;oBACHqB,CAAAA,GAAAA,kBAAAA,+BAA+B,EAACrB;oBAChC,IAAIsB,QAAQC,GAAG,CAACC,QAAQ,KAAK,WAAe;wBAC1C,wEAAwE;wBACxE,8EAA8E;wBAC9E,4EAA4E;wBAC5E,OAAOC,CAAAA,GAAAA,uBAAAA,0BAA0B,EAAChB;oBACpC,OAAO;;gBAGT;oBACET;YACJ;QACF;IACF;IAEA,yEAAyE;IACzE0B,CAAAA,GAAAA,8BAAAA,2BAA2B,EAAC9B;AAC9B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">13077</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/shared/lib/utils/reflect-utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// This regex will have fast negatives meaning valid identifiers may not pass</span><span class="s3">\n</span><span class="s1">// this test. However this is only used during static generation to provide hints</span><span class="s3">\n</span><span class="s1">// about why a page bailed out of some or all prerendering and we can use bracket notation</span><span class="s3">\n</span><span class="s1">// for example while `_` is a valid identifier it's ok to print `searchParams['_']`</span><span class="s3">\n</span><span class="s1">// even if this would have been fine too `searchParams._`</span><span class="s3">\n</span><span class="s1">const isDefinitelyAValidIdentifier = /^[A-Za-z_$][A-Za-z0-9_$]*$/</span><span class="s3">\n\n</span><span class="s1">export function describeStringPropertyAccess(target: string, prop: string) {</span><span class="s3">\n  </span><span class="s1">if (isDefinitelyAValidIdentifier.test(prop)) {</span><span class="s3">\n    </span><span class="s1">return `</span><span class="s3">\\</span><span class="s1">`${target}.${prop}</span><span class="s3">\\</span><span class="s1">``</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return `</span><span class="s3">\\</span><span class="s1">`${target}[${JSON.stringify(prop)}]</span><span class="s3">\\</span><span class="s1">``</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function describeHasCheckingStringProperty(</span><span class="s3">\n  </span><span class="s1">target: string,</span><span class="s3">\n  </span><span class="s1">prop: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const stringifiedProp = JSON.stringify(prop)</span><span class="s3">\n  </span><span class="s1">return `</span><span class="s3">\\</span><span class="s1">`Reflect.has(${target}, ${stringifiedProp})</span><span class="s3">\\</span><span class="s1">`, </span><span class="s3">\\</span><span class="s1">`${stringifiedProp} in ${target}</span><span class="s3">\\</span><span class="s1">`, or similar`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const wellKnownProperties = new Set([</span><span class="s3">\n  </span><span class="s1">'hasOwnProperty',</span><span class="s3">\n  </span><span class="s1">'isPrototypeOf',</span><span class="s3">\n  </span><span class="s1">'propertyIsEnumerable',</span><span class="s3">\n  </span><span class="s1">'toString',</span><span class="s3">\n  </span><span class="s1">'valueOf',</span><span class="s3">\n  </span><span class="s1">'toLocaleString',</span><span class="s3">\n\n  </span><span class="s1">// Promise prototype</span><span class="s3">\n  </span><span class="s1">// fallthrough</span><span class="s3">\n  </span><span class="s1">'then',</span><span class="s3">\n  </span><span class="s1">'catch',</span><span class="s3">\n  </span><span class="s1">'finally',</span><span class="s3">\n\n  </span><span class="s1">// React Promise extension</span><span class="s3">\n  </span><span class="s1">// fallthrough</span><span class="s3">\n  </span><span class="s1">'status',</span><span class="s3">\n\n  </span><span class="s1">// React introspection</span><span class="s3">\n  </span><span class="s1">'displayName',</span><span class="s3">\n  </span><span class="s1">'_debugInfo',</span><span class="s3">\n\n  </span><span class="s1">// Common tested properties</span><span class="s3">\n  </span><span class="s1">// fallthrough</span><span class="s3">\n  </span><span class="s1">'toJSON',</span><span class="s3">\n  </span><span class="s1">'$$typeof',</span><span class="s3">\n  </span><span class="s1">'__esModule',</span><span class="s3">\n</span><span class="s1">])</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;describeHasCheckingStringProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;describeStringPropertyAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;wellKnownProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;isDefinitelyAValidIdentifier&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;stringifiedProp&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,6EAA6E;AAC7E,iFAAiF;AACjF,0FAA0F;AAC1F,uFAAuF;AACvF,2DAA2D;;;;;;;;;;;;;;;;IAU3CA,iCAAiC,EAAA;eAAjCA;;IAPAC,4BAA4B,EAAA;eAA5BA;;IAeHC,mBAAmB,EAAA;eAAnBA;;;AAjBb,MAAMC,+BAA+B;AAE9B,SAASF,6BAA6BG,MAAc,EAAEC,IAAY;IACvE,IAAIF,6BAA6BG,IAAI,CAACD,OAAO;QAC3C,OAAQ,MAAID,SAAO,MAAGC,OAAK;IAC7B;IACA,OAAQ,MAAID,SAAO,MAAGG,KAAKC,SAAS,CAACH,QAAM;AAC7C;AAEO,SAASL,kCACdI,MAAc,EACdC,IAAY;IAEZ,MAAMI,kBAAkBF,KAAKC,SAAS,CAACH;IACvC,OAAQ,kBAAgBD,SAAO,OAAIK,kBAAgB,UAASA,kBAAgB,SAAML,SAAO;AAC3F;AAEO,MAAMF,sBAAsB,IAAIQ,IAAI;IACzC;IACA;IACA;IACA;IACA;IACA;IAEA,oBAAoB;IACpB,cAAc;IACd;IACA;IACA;IAEA,0BAA0B;IAC1B,cAAc;IACd;IAEA,sBAAsB;IACtB;IACA;IAEA,2BAA2B;IAC3B,cAAc;IACd;IACA;IACA;CACD&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">13146</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/lib/picocolors.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// ISC License</span><span class="s3">\n\n</span><span class="s1">// Copyright (c) 2021 Alexey Raspopov, Kostiantyn Denysov, Anton Verinov</span><span class="s3">\n\n</span><span class="s1">// Permission to use, copy, modify, and/or distribute this software for any</span><span class="s3">\n</span><span class="s1">// purpose with or without fee is hereby granted, provided that the above</span><span class="s3">\n</span><span class="s1">// copyright notice and this permission notice appear in all copies.</span><span class="s3">\n\n</span><span class="s1">// THE SOFTWARE IS PROVIDED </span><span class="s3">\&quot;</span><span class="s1">AS IS</span><span class="s3">\&quot; </span><span class="s1">AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span><span class="s3">\n</span><span class="s1">// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span><span class="s3">\n</span><span class="s1">// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span><span class="s3">\n</span><span class="s1">// ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span><span class="s3">\n</span><span class="s1">// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span><span class="s3">\n</span><span class="s1">// ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span><span class="s3">\n</span><span class="s1">// OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span><span class="s3">\n</span><span class="s1">//</span><span class="s3">\n</span><span class="s1">// https://github.com/alexeyraspopov/picocolors/blob/b6261487e7b81aaab2440e397a356732cad9e342/picocolors.js#L1</span><span class="s3">\n\n</span><span class="s1">const { env, stdout } = globalThis?.process ?? {}</span><span class="s3">\n\n</span><span class="s1">const enabled =</span><span class="s3">\n  </span><span class="s1">env &amp;&amp;</span><span class="s3">\n  </span><span class="s1">!env.NO_COLOR &amp;&amp;</span><span class="s3">\n  </span><span class="s1">(env.FORCE_COLOR || (stdout?.isTTY &amp;&amp; !env.CI &amp;&amp; env.TERM !== 'dumb'))</span><span class="s3">\n\n</span><span class="s1">const replaceClose = (</span><span class="s3">\n  </span><span class="s1">str: string,</span><span class="s3">\n  </span><span class="s1">close: string,</span><span class="s3">\n  </span><span class="s1">replace: string,</span><span class="s3">\n  </span><span class="s1">index: number</span><span class="s3">\n</span><span class="s1">): string =&gt; {</span><span class="s3">\n  </span><span class="s1">const start = str.substring(0, index) + replace</span><span class="s3">\n  </span><span class="s1">const end = str.substring(index + close.length)</span><span class="s3">\n  </span><span class="s1">const nextIndex = end.indexOf(close)</span><span class="s3">\n  </span><span class="s1">return ~nextIndex</span><span class="s3">\n    </span><span class="s1">? start + replaceClose(end, close, replace, nextIndex)</span><span class="s3">\n    </span><span class="s1">: start + end</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const formatter = (open: string, close: string, replace = open) =&gt; {</span><span class="s3">\n  </span><span class="s1">if (!enabled) return String</span><span class="s3">\n  </span><span class="s1">return (input: string) =&gt; {</span><span class="s3">\n    </span><span class="s1">const string = '' + input</span><span class="s3">\n    </span><span class="s1">const index = string.indexOf(close, open.length)</span><span class="s3">\n    </span><span class="s1">return ~index</span><span class="s3">\n      </span><span class="s1">? open + replaceClose(string, close, replace, index) + close</span><span class="s3">\n      </span><span class="s1">: open + string + close</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const reset = enabled ? (s: string) =&gt; `</span><span class="s3">\\</span><span class="s1">x1b[0m${s}</span><span class="s3">\\</span><span class="s1">x1b[0m` : String</span><span class="s3">\n</span><span class="s1">export const bold = formatter('</span><span class="s3">\\</span><span class="s1">x1b[1m', '</span><span class="s3">\\</span><span class="s1">x1b[22m', '</span><span class="s3">\\</span><span class="s1">x1b[22m</span><span class="s3">\\</span><span class="s1">x1b[1m')</span><span class="s3">\n</span><span class="s1">export const dim = formatter('</span><span class="s3">\\</span><span class="s1">x1b[2m', '</span><span class="s3">\\</span><span class="s1">x1b[22m', '</span><span class="s3">\\</span><span class="s1">x1b[22m</span><span class="s3">\\</span><span class="s1">x1b[2m')</span><span class="s3">\n</span><span class="s1">export const italic = formatter('</span><span class="s3">\\</span><span class="s1">x1b[3m', '</span><span class="s3">\\</span><span class="s1">x1b[23m')</span><span class="s3">\n</span><span class="s1">export const underline = formatter('</span><span class="s3">\\</span><span class="s1">x1b[4m', '</span><span class="s3">\\</span><span class="s1">x1b[24m')</span><span class="s3">\n</span><span class="s1">export const inverse = formatter('</span><span class="s3">\\</span><span class="s1">x1b[7m', '</span><span class="s3">\\</span><span class="s1">x1b[27m')</span><span class="s3">\n</span><span class="s1">export const hidden = formatter('</span><span class="s3">\\</span><span class="s1">x1b[8m', '</span><span class="s3">\\</span><span class="s1">x1b[28m')</span><span class="s3">\n</span><span class="s1">export const strikethrough = formatter('</span><span class="s3">\\</span><span class="s1">x1b[9m', '</span><span class="s3">\\</span><span class="s1">x1b[29m')</span><span class="s3">\n</span><span class="s1">export const black = formatter('</span><span class="s3">\\</span><span class="s1">x1b[30m', '</span><span class="s3">\\</span><span class="s1">x1b[39m')</span><span class="s3">\n</span><span class="s1">export const red = formatter('</span><span class="s3">\\</span><span class="s1">x1b[31m', '</span><span class="s3">\\</span><span class="s1">x1b[39m')</span><span class="s3">\n</span><span class="s1">export const green = formatter('</span><span class="s3">\\</span><span class="s1">x1b[32m', '</span><span class="s3">\\</span><span class="s1">x1b[39m')</span><span class="s3">\n</span><span class="s1">export const yellow = formatter('</span><span class="s3">\\</span><span class="s1">x1b[33m', '</span><span class="s3">\\</span><span class="s1">x1b[39m')</span><span class="s3">\n</span><span class="s1">export const blue = formatter('</span><span class="s3">\\</span><span class="s1">x1b[34m', '</span><span class="s3">\\</span><span class="s1">x1b[39m')</span><span class="s3">\n</span><span class="s1">export const magenta = formatter('</span><span class="s3">\\</span><span class="s1">x1b[35m', '</span><span class="s3">\\</span><span class="s1">x1b[39m')</span><span class="s3">\n</span><span class="s1">export const purple = formatter('</span><span class="s3">\\</span><span class="s1">x1b[38;2;173;127;168m', '</span><span class="s3">\\</span><span class="s1">x1b[39m')</span><span class="s3">\n</span><span class="s1">export const cyan = formatter('</span><span class="s3">\\</span><span class="s1">x1b[36m', '</span><span class="s3">\\</span><span class="s1">x1b[39m')</span><span class="s3">\n</span><span class="s1">export const white = formatter('</span><span class="s3">\\</span><span class="s1">x1b[37m', '</span><span class="s3">\\</span><span class="s1">x1b[39m')</span><span class="s3">\n</span><span class="s1">export const gray = formatter('</span><span class="s3">\\</span><span class="s1">x1b[90m', '</span><span class="s3">\\</span><span class="s1">x1b[39m')</span><span class="s3">\n</span><span class="s1">export const bgBlack = formatter('</span><span class="s3">\\</span><span class="s1">x1b[40m', '</span><span class="s3">\\</span><span class="s1">x1b[49m')</span><span class="s3">\n</span><span class="s1">export const bgRed = formatter('</span><span class="s3">\\</span><span class="s1">x1b[41m', '</span><span class="s3">\\</span><span class="s1">x1b[49m')</span><span class="s3">\n</span><span class="s1">export const bgGreen = formatter('</span><span class="s3">\\</span><span class="s1">x1b[42m', '</span><span class="s3">\\</span><span class="s1">x1b[49m')</span><span class="s3">\n</span><span class="s1">export const bgYellow = formatter('</span><span class="s3">\\</span><span class="s1">x1b[43m', '</span><span class="s3">\\</span><span class="s1">x1b[49m')</span><span class="s3">\n</span><span class="s1">export const bgBlue = formatter('</span><span class="s3">\\</span><span class="s1">x1b[44m', '</span><span class="s3">\\</span><span class="s1">x1b[49m')</span><span class="s3">\n</span><span class="s1">export const bgMagenta = formatter('</span><span class="s3">\\</span><span class="s1">x1b[45m', '</span><span class="s3">\\</span><span class="s1">x1b[49m')</span><span class="s3">\n</span><span class="s1">export const bgCyan = formatter('</span><span class="s3">\\</span><span class="s1">x1b[46m', '</span><span class="s3">\\</span><span class="s1">x1b[49m')</span><span class="s3">\n</span><span class="s1">export const bgWhite = formatter('</span><span class="s3">\\</span><span class="s1">x1b[47m', '</span><span class="s3">\\</span><span class="s1">x1b[49m')</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;bgBlack&quot;</span><span class="s0">,</span><span class="s1">&quot;bgBlue&quot;</span><span class="s0">,</span><span class="s1">&quot;bgCyan&quot;</span><span class="s0">,</span><span class="s1">&quot;bgGreen&quot;</span><span class="s0">,</span><span class="s1">&quot;bgMagenta&quot;</span><span class="s0">,</span><span class="s1">&quot;bgRed&quot;</span><span class="s0">,</span><span class="s1">&quot;bgWhite&quot;</span><span class="s0">,</span><span class="s1">&quot;bgYellow&quot;</span><span class="s0">,</span><span class="s1">&quot;black&quot;</span><span class="s0">,</span><span class="s1">&quot;blue&quot;</span><span class="s0">,</span><span class="s1">&quot;bold&quot;</span><span class="s0">,</span><span class="s1">&quot;cyan&quot;</span><span class="s0">,</span><span class="s1">&quot;dim&quot;</span><span class="s0">,</span><span class="s1">&quot;gray&quot;</span><span class="s0">,</span><span class="s1">&quot;green&quot;</span><span class="s0">,</span><span class="s1">&quot;hidden&quot;</span><span class="s0">,</span><span class="s1">&quot;inverse&quot;</span><span class="s0">,</span><span class="s1">&quot;italic&quot;</span><span class="s0">,</span><span class="s1">&quot;magenta&quot;</span><span class="s0">,</span><span class="s1">&quot;purple&quot;</span><span class="s0">,</span><span class="s1">&quot;red&quot;</span><span class="s0">,</span><span class="s1">&quot;reset&quot;</span><span class="s0">,</span><span class="s1">&quot;strikethrough&quot;</span><span class="s0">,</span><span class="s1">&quot;underline&quot;</span><span class="s0">,</span><span class="s1">&quot;white&quot;</span><span class="s0">,</span><span class="s1">&quot;yellow&quot;</span><span class="s0">,</span><span class="s1">&quot;globalThis&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;stdout&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;enabled&quot;</span><span class="s0">,</span><span class="s1">&quot;NO_COLOR&quot;</span><span class="s0">,</span><span class="s1">&quot;FORCE_COLOR&quot;</span><span class="s0">,</span><span class="s1">&quot;isTTY&quot;</span><span class="s0">,</span><span class="s1">&quot;CI&quot;</span><span class="s0">,</span><span class="s1">&quot;TERM&quot;</span><span class="s0">,</span><span class="s1">&quot;replaceClose&quot;</span><span class="s0">,</span><span class="s1">&quot;str&quot;</span><span class="s0">,</span><span class="s1">&quot;close&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;substring&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;nextIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;indexOf&quot;</span><span class="s0">,</span><span class="s1">&quot;formatter&quot;</span><span class="s0">,</span><span class="s1">&quot;open&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;input&quot;</span><span class="s0">,</span><span class="s1">&quot;string&quot;</span><span class="s0">,</span><span class="s1">&quot;s&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">13324</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/lib/lru-cache.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Node in the doubly-linked list used for LRU tracking.</span><span class="s3">\n </span><span class="s1">* Each node represents a cache entry with bidirectional pointers.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">class LRUNode&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">public readonly key: string</span><span class="s3">\n  </span><span class="s1">public data: T</span><span class="s3">\n  </span><span class="s1">public size: number</span><span class="s3">\n  </span><span class="s1">public prev: LRUNode&lt;T&gt; | SentinelNode&lt;T&gt; | null = null</span><span class="s3">\n  </span><span class="s1">public next: LRUNode&lt;T&gt; | SentinelNode&lt;T&gt; | null = null</span><span class="s3">\n\n  </span><span class="s1">constructor(key: string, data: T, size: number) {</span><span class="s3">\n    </span><span class="s1">this.key = key</span><span class="s3">\n    </span><span class="s1">this.data = data</span><span class="s3">\n    </span><span class="s1">this.size = size</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Sentinel node used for head/tail boundaries.</span><span class="s3">\n </span><span class="s1">* These nodes don't contain actual cache data but simplify list operations.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">class SentinelNode&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">public prev: LRUNode&lt;T&gt; | SentinelNode&lt;T&gt; | null = null</span><span class="s3">\n  </span><span class="s1">public next: LRUNode&lt;T&gt; | SentinelNode&lt;T&gt; | null = null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* LRU (Least Recently Used) Cache implementation using a doubly-linked list</span><span class="s3">\n </span><span class="s1">* and hash map for O(1) operations.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Algorithm:</span><span class="s3">\n </span><span class="s1">* - Uses a doubly-linked list to maintain access order (most recent at head)</span><span class="s3">\n </span><span class="s1">* - Hash map provides O(1) key-to-node lookup</span><span class="s3">\n </span><span class="s1">* - Sentinel head/tail nodes simplify edge case handling</span><span class="s3">\n </span><span class="s1">* - Size-based eviction supports custom size calculation functions</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Data Structure Layout:</span><span class="s3">\n </span><span class="s1">* HEAD &lt;-&gt; [most recent] &lt;-&gt; ... &lt;-&gt; [least recent] &lt;-&gt; TAIL</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Operations:</span><span class="s3">\n </span><span class="s1">* - get(): Move accessed node to head (mark as most recent)</span><span class="s3">\n </span><span class="s1">* - set(): Add new node at head, evict from tail if over capacity</span><span class="s3">\n </span><span class="s1">* - Eviction: Remove least recent node (tail.prev) when size exceeds limit</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class LRUCache&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">private readonly cache: Map&lt;string, LRUNode&lt;T&gt;&gt; = new Map()</span><span class="s3">\n  </span><span class="s1">private readonly head: SentinelNode&lt;T&gt;</span><span class="s3">\n  </span><span class="s1">private readonly tail: SentinelNode&lt;T&gt;</span><span class="s3">\n  </span><span class="s1">private totalSize: number = 0</span><span class="s3">\n  </span><span class="s1">private readonly maxSize: number</span><span class="s3">\n  </span><span class="s1">private readonly calculateSize: ((value: T) =&gt; number) | undefined</span><span class="s3">\n\n  </span><span class="s1">constructor(maxSize: number, calculateSize?: (value: T) =&gt; number) {</span><span class="s3">\n    </span><span class="s1">this.maxSize = maxSize</span><span class="s3">\n    </span><span class="s1">this.calculateSize = calculateSize</span><span class="s3">\n\n    </span><span class="s1">// Create sentinel nodes to simplify doubly-linked list operations</span><span class="s3">\n    </span><span class="s1">// HEAD &lt;-&gt; TAIL (empty list)</span><span class="s3">\n    </span><span class="s1">this.head = new SentinelNode&lt;T&gt;()</span><span class="s3">\n    </span><span class="s1">this.tail = new SentinelNode&lt;T&gt;()</span><span class="s3">\n    </span><span class="s1">this.head.next = this.tail</span><span class="s3">\n    </span><span class="s1">this.tail.prev = this.head</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Adds a node immediately after the head (marks as most recently used).</span><span class="s3">\n   </span><span class="s1">* Used when inserting new items or when an item is accessed.</span><span class="s3">\n   </span><span class="s1">* PRECONDITION: node must be disconnected (prev/next should be null)</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">private addToHead(node: LRUNode&lt;T&gt;): void {</span><span class="s3">\n    </span><span class="s1">node.prev = this.head</span><span class="s3">\n    </span><span class="s1">node.next = this.head.next</span><span class="s3">\n    </span><span class="s1">// head.next is always non-null (points to tail or another node)</span><span class="s3">\n    </span><span class="s1">this.head.next!.prev = node</span><span class="s3">\n    </span><span class="s1">this.head.next = node</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Removes a node from its current position in the doubly-linked list.</span><span class="s3">\n   </span><span class="s1">* Updates the prev/next pointers of adjacent nodes to maintain list integrity.</span><span class="s3">\n   </span><span class="s1">* PRECONDITION: node must be connected (prev/next are non-null)</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">private removeNode(node: LRUNode&lt;T&gt;): void {</span><span class="s3">\n    </span><span class="s1">// Connected nodes always have non-null prev/next</span><span class="s3">\n    </span><span class="s1">node.prev!.next = node.next</span><span class="s3">\n    </span><span class="s1">node.next!.prev = node.prev</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Moves an existing node to the head position (marks as most recently used).</span><span class="s3">\n   </span><span class="s1">* This is the core LRU operation - accessed items become most recent.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">private moveToHead(node: LRUNode&lt;T&gt;): void {</span><span class="s3">\n    </span><span class="s1">this.removeNode(node)</span><span class="s3">\n    </span><span class="s1">this.addToHead(node)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Removes and returns the least recently used node (the one before tail).</span><span class="s3">\n   </span><span class="s1">* This is called during eviction when the cache exceeds capacity.</span><span class="s3">\n   </span><span class="s1">* PRECONDITION: cache is not empty (ensured by caller)</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">private removeTail(): LRUNode&lt;T&gt; {</span><span class="s3">\n    </span><span class="s1">const lastNode = this.tail.prev as LRUNode&lt;T&gt;</span><span class="s3">\n    </span><span class="s1">// tail.prev is always non-null and always LRUNode when cache is not empty</span><span class="s3">\n    </span><span class="s1">this.removeNode(lastNode)</span><span class="s3">\n    </span><span class="s1">return lastNode</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Sets a key-value pair in the cache.</span><span class="s3">\n   </span><span class="s1">* If the key exists, updates the value and moves to head.</span><span class="s3">\n   </span><span class="s1">* If new, adds at head and evicts from tail if necessary.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* Time Complexity:</span><span class="s3">\n   </span><span class="s1">* - O(1) for uniform item sizes</span><span class="s3">\n   </span><span class="s1">* - O(k) where k is the number of items evicted (can be O(N) for variable sizes)</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public set(key: string, value: T): void {</span><span class="s3">\n    </span><span class="s1">const size = this.calculateSize?.(value) ?? 1</span><span class="s3">\n    </span><span class="s1">if (size &gt; this.maxSize) {</span><span class="s3">\n      </span><span class="s1">console.warn('Single item size exceeds maxSize')</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const existing = this.cache.get(key)</span><span class="s3">\n    </span><span class="s1">if (existing) {</span><span class="s3">\n      </span><span class="s1">// Update existing node: adjust size and move to head (most recent)</span><span class="s3">\n      </span><span class="s1">existing.data = value</span><span class="s3">\n      </span><span class="s1">this.totalSize = this.totalSize - existing.size + size</span><span class="s3">\n      </span><span class="s1">existing.size = size</span><span class="s3">\n      </span><span class="s1">this.moveToHead(existing)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">// Add new node at head (most recent position)</span><span class="s3">\n      </span><span class="s1">const newNode = new LRUNode(key, value, size)</span><span class="s3">\n      </span><span class="s1">this.cache.set(key, newNode)</span><span class="s3">\n      </span><span class="s1">this.addToHead(newNode)</span><span class="s3">\n      </span><span class="s1">this.totalSize += size</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// Evict least recently used items until under capacity</span><span class="s3">\n    </span><span class="s1">while (this.totalSize &gt; this.maxSize &amp;&amp; this.cache.size &gt; 0) {</span><span class="s3">\n      </span><span class="s1">const tail = this.removeTail()</span><span class="s3">\n      </span><span class="s1">this.cache.delete(tail.key)</span><span class="s3">\n      </span><span class="s1">this.totalSize -= tail.size</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Checks if a key exists in the cache.</span><span class="s3">\n   </span><span class="s1">* This is a pure query operation - does NOT update LRU order.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* Time Complexity: O(1)</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public has(key: string): boolean {</span><span class="s3">\n    </span><span class="s1">return this.cache.has(key)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Retrieves a value by key and marks it as most recently used.</span><span class="s3">\n   </span><span class="s1">* Moving to head maintains the LRU property for future evictions.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* Time Complexity: O(1)</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public get(key: string): T | undefined {</span><span class="s3">\n    </span><span class="s1">const node = this.cache.get(key)</span><span class="s3">\n    </span><span class="s1">if (!node) return undefined</span><span class="s3">\n\n    </span><span class="s1">// Mark as most recently used by moving to head</span><span class="s3">\n    </span><span class="s1">this.moveToHead(node)</span><span class="s3">\n\n    </span><span class="s1">return node.data</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns an iterator over the cache entries. The order is outputted in the</span><span class="s3">\n   </span><span class="s1">* order of most recently used to least recently used.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public *[Symbol.iterator](): IterableIterator&lt;[string, T]&gt; {</span><span class="s3">\n    </span><span class="s1">let current = this.head.next</span><span class="s3">\n    </span><span class="s1">while (current &amp;&amp; current !== this.tail) {</span><span class="s3">\n      </span><span class="s1">// Between head and tail, current is always LRUNode</span><span class="s3">\n      </span><span class="s1">const node = current as LRUNode&lt;T&gt;</span><span class="s3">\n      </span><span class="s1">yield [node.key, node.data]</span><span class="s3">\n      </span><span class="s1">current = current.next</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Removes a specific key from the cache.</span><span class="s3">\n   </span><span class="s1">* Updates both the hash map and doubly-linked list.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* Time Complexity: O(1)</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public remove(key: string): void {</span><span class="s3">\n    </span><span class="s1">const node = this.cache.get(key)</span><span class="s3">\n    </span><span class="s1">if (!node) return</span><span class="s3">\n\n    </span><span class="s1">this.removeNode(node)</span><span class="s3">\n    </span><span class="s1">this.cache.delete(key)</span><span class="s3">\n    </span><span class="s1">this.totalSize -= node.size</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns the number of items in the cache.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public get size(): number {</span><span class="s3">\n    </span><span class="s1">return this.cache.size</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns the current total size of all cached items.</span><span class="s3">\n   </span><span class="s1">* This uses the custom size calculation if provided.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public get currentSize(): number {</span><span class="s3">\n    </span><span class="s1">return this.totalSize</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;LRUCache&quot;</span><span class="s0">,</span><span class="s1">&quot;LRUNode&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;size&quot;</span><span class="s0">,</span><span class="s1">&quot;prev&quot;</span><span class="s0">,</span><span class="s1">&quot;next&quot;</span><span class="s0">,</span><span class="s1">&quot;SentinelNode&quot;</span><span class="s0">,</span><span class="s1">&quot;maxSize&quot;</span><span class="s0">,</span><span class="s1">&quot;calculateSize&quot;</span><span class="s0">,</span><span class="s1">&quot;cache&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;totalSize&quot;</span><span class="s0">,</span><span class="s1">&quot;head&quot;</span><span class="s0">,</span><span class="s1">&quot;tail&quot;</span><span class="s0">,</span><span class="s1">&quot;addToHead&quot;</span><span class="s0">,</span><span class="s1">&quot;node&quot;</span><span class="s0">,</span><span class="s1">&quot;removeNode&quot;</span><span class="s0">,</span><span class="s1">&quot;moveToHead&quot;</span><span class="s0">,</span><span class="s1">&quot;removeTail&quot;</span><span class="s0">,</span><span class="s1">&quot;lastNode&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;warn&quot;</span><span class="s0">,</span><span class="s1">&quot;existing&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;newNode&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;iterator&quot;</span><span class="s0">,</span><span class="s1">&quot;current&quot;</span><span class="s0">,</span><span class="s1">&quot;remove&quot;</span><span class="s0">,</span><span class="s1">&quot;currentSize&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">13502</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/build/output/log.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { bold, green, magenta, red, yellow, white } from '../../lib/picocolors'</span><span class="s3">\n</span><span class="s1">import { LRUCache } from '../../server/lib/lru-cache'</span><span class="s3">\n\n</span><span class="s1">export const prefixes = {</span><span class="s3">\n  </span><span class="s1">wait: white(bold('')),</span><span class="s3">\n  </span><span class="s1">error: red(bold('')),</span><span class="s3">\n  </span><span class="s1">warn: yellow(bold('')),</span><span class="s3">\n  </span><span class="s1">ready: '', // no color</span><span class="s3">\n  </span><span class="s1">info: white(bold(' ')),</span><span class="s3">\n  </span><span class="s1">event: green(bold('')),</span><span class="s3">\n  </span><span class="s1">trace: magenta(bold('')),</span><span class="s3">\n</span><span class="s1">} as const</span><span class="s3">\n\n</span><span class="s1">const LOGGING_METHOD = {</span><span class="s3">\n  </span><span class="s1">log: 'log',</span><span class="s3">\n  </span><span class="s1">warn: 'warn',</span><span class="s3">\n  </span><span class="s1">error: 'error',</span><span class="s3">\n</span><span class="s1">} as const</span><span class="s3">\n\n</span><span class="s1">function prefixedLog(prefixType: keyof typeof prefixes, ...message: any[]) {</span><span class="s3">\n  </span><span class="s1">if ((message[0] === '' || message[0] === undefined) &amp;&amp; message.length === 1) {</span><span class="s3">\n    </span><span class="s1">message.shift()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const consoleMethod: keyof typeof LOGGING_METHOD =</span><span class="s3">\n    </span><span class="s1">prefixType in LOGGING_METHOD</span><span class="s3">\n      </span><span class="s1">? LOGGING_METHOD[prefixType as keyof typeof LOGGING_METHOD]</span><span class="s3">\n      </span><span class="s1">: 'log'</span><span class="s3">\n\n  </span><span class="s1">const prefix = prefixes[prefixType]</span><span class="s3">\n  </span><span class="s1">// If there's no message, don't print the prefix but a new line</span><span class="s3">\n  </span><span class="s1">if (message.length === 0) {</span><span class="s3">\n    </span><span class="s1">console[consoleMethod]('')</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">// Ensure if there's ANSI escape codes it's concatenated into one string.</span><span class="s3">\n    </span><span class="s1">// Chrome DevTool can only handle color if it's in one string.</span><span class="s3">\n    </span><span class="s1">if (message.length === 1 &amp;&amp; typeof message[0] === 'string') {</span><span class="s3">\n      </span><span class="s1">console[consoleMethod](' ' + prefix + ' ' + message[0])</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">console[consoleMethod](' ' + prefix, ...message)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function bootstrap(...message: string[]) {</span><span class="s3">\n  </span><span class="s1">// logging format: ' &lt;prefix&gt; &lt;message&gt;'</span><span class="s3">\n  </span><span class="s1">// e.g. '  Compiled successfully'</span><span class="s3">\n  </span><span class="s1">// Add spaces to align with the indent of other logs</span><span class="s3">\n  </span><span class="s1">console.log('   ' + message.join(' '))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function wait(...message: any[]) {</span><span class="s3">\n  </span><span class="s1">prefixedLog('wait', ...message)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function error(...message: any[]) {</span><span class="s3">\n  </span><span class="s1">prefixedLog('error', ...message)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function warn(...message: any[]) {</span><span class="s3">\n  </span><span class="s1">prefixedLog('warn', ...message)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function ready(...message: any[]) {</span><span class="s3">\n  </span><span class="s1">prefixedLog('ready', ...message)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function info(...message: any[]) {</span><span class="s3">\n  </span><span class="s1">prefixedLog('info', ...message)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function event(...message: any[]) {</span><span class="s3">\n  </span><span class="s1">prefixedLog('event', ...message)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function trace(...message: any[]) {</span><span class="s3">\n  </span><span class="s1">prefixedLog('trace', ...message)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const warnOnceCache = new LRUCache&lt;string&gt;(10_000, (value) =&gt; value.length)</span><span class="s3">\n</span><span class="s1">export function warnOnce(...message: any[]) {</span><span class="s3">\n  </span><span class="s1">const key = message.join(' ')</span><span class="s3">\n  </span><span class="s1">if (!warnOnceCache.has(key)) {</span><span class="s3">\n    </span><span class="s1">warnOnceCache.set(key, key)</span><span class="s3">\n    </span><span class="s1">warn(...message)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;bootstrap&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;event&quot;</span><span class="s0">,</span><span class="s1">&quot;info&quot;</span><span class="s0">,</span><span class="s1">&quot;prefixes&quot;</span><span class="s0">,</span><span class="s1">&quot;ready&quot;</span><span class="s0">,</span><span class="s1">&quot;trace&quot;</span><span class="s0">,</span><span class="s1">&quot;wait&quot;</span><span class="s0">,</span><span class="s1">&quot;warn&quot;</span><span class="s0">,</span><span class="s1">&quot;warnOnce&quot;</span><span class="s0">,</span><span class="s1">&quot;white&quot;</span><span class="s0">,</span><span class="s1">&quot;bold&quot;</span><span class="s0">,</span><span class="s1">&quot;red&quot;</span><span class="s0">,</span><span class="s1">&quot;yellow&quot;</span><span class="s0">,</span><span class="s1">&quot;green&quot;</span><span class="s0">,</span><span class="s1">&quot;magenta&quot;</span><span class="s0">,</span><span class="s1">&quot;LOGGING_METHOD&quot;</span><span class="s0">,</span><span class="s1">&quot;log&quot;</span><span class="s0">,</span><span class="s1">&quot;prefixedLog&quot;</span><span class="s0">,</span><span class="s1">&quot;prefixType&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;shift&quot;</span><span class="s0">,</span><span class="s1">&quot;consoleMethod&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;warnOnceCache&quot;</span><span class="s0">,</span><span class="s1">&quot;LRUCache&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;;;;;;;;IA4CgBA,SAAS,EAAA;eAATA;;IAWAC,KAAK,EAAA;eAALA;;IAgBAC,KAAK,EAAA;eAALA;;IAJAC,IAAI,EAAA;eAAJA;;IAhEHC,QAAQ,EAAA;eAARA;;IA4DGC,KAAK,EAAA;eAALA;;IAYAC,KAAK,EAAA;eAALA;;IAxBAC,IAAI,EAAA;eAAJA;;IAQAC,IAAI,EAAA;eAAJA;;IAqBAC,QAAQ,EAAA;eAARA;;;4BAhFyC;0BAChC;AAElB,MAAML,WAAW;IACtBG,MAAMG,CAAAA,GAAAA,YAAAA,KAAK,EAACC,CAAAA,GAAAA,YAAAA,IAAI,EAAC;IACjBV,OAAOW,CAAAA,GAAAA,YAAAA,GAAG,EAACD,CAAAA,GAAAA,YAAAA,IAAI,EAAC;IAChBH,MAAMK,CAAAA,GAAAA,YAAAA,MAAM,EAACF,CAAAA,GAAAA,YAAAA,IAAI,EAAC;IAClBN,OAAO;IACPF,MAAMO,CAAAA,GAAAA,YAAAA,KAAK,EAACC,CAAAA,GAAAA,YAAAA,IAAI,EAAC;IACjBT,OAAOY,CAAAA,GAAAA,YAAAA,KAAK,EAACH,CAAAA,GAAAA,YAAAA,IAAI,EAAC;IAClBL,OAAOS,CAAAA,GAAAA,YAAAA,OAAO,EAACJ,CAAAA,GAAAA,YAAAA,IAAI,EAAC;AACtB;AAEA,MAAMK,iBAAiB;IACrBC,KAAK;IACLT,MAAM;IACNP,OAAO;AACT;AAEA,SAASiB,YAAYC,UAAiC,EAAE,GAAGC,OAAc;IACvE,IAAKA,CAAAA,OAAO,CAAC,EAAE,KAAK,MAAMA,OAAO,CAAC,EAAE,KAAKC,SAAQ,KAAMD,QAAQE,MAAM,KAAK,GAAG;QAC3EF,QAAQG,KAAK;IACf;IAEA,MAAMC,gBACJL,cAAcH,iBACVA,cAAc,CAACG,WAA0C,GACzD;IAEN,MAAMM,SAASrB,QAAQ,CAACe,WAAW;IACnC,+DAA+D;IAC/D,IAAIC,QAAQE,MAAM,KAAK,GAAG;QACxBI,OAAO,CAACF,cAAc,CAAC;IACzB,OAAO;QACL,yEAAyE;QACzE,8DAA8D;QAC9D,IAAIJ,QAAQE,MAAM,KAAK,KAAK,OAAOF,OAAO,CAAC,EAAE,KAAK,UAAU;YAC1DM,OAAO,CAACF,cAAc,CAAC,MAAMC,SAAS,MAAML,OAAO,CAAC,EAAE;QACxD,OAAO;YACLM,OAAO,CAACF,cAAc,CAAC,MAAMC,WAAWL;QAC1C;IACF;AACF;AAEO,SAASpB,UAAU,GAAGoB,OAAiB;IAC5C,wCAAwC;IACxC,kCAAkC;IAClC,oDAAoD;IACpDM,QAAQT,GAAG,CAAC,QAAQG,QAAQO,IAAI,CAAC;AACnC;AAEO,SAASpB,KAAK,GAAGa,OAAc;IACpCF,YAAY,WAAWE;AACzB;AAEO,SAASnB,MAAM,GAAGmB,OAAc;IACrCF,YAAY,YAAYE;AAC1B;AAEO,SAASZ,KAAK,GAAGY,OAAc;IACpCF,YAAY,WAAWE;AACzB;AAEO,SAASf,MAAM,GAAGe,OAAc;IACrCF,YAAY,YAAYE;AAC1B;AAEO,SAASjB,KAAK,GAAGiB,OAAc;IACpCF,YAAY,WAAWE;AACzB;AAEO,SAASlB,MAAM,GAAGkB,OAAc;IACrCF,YAAY,YAAYE;AAC1B;AAEO,SAASd,MAAM,GAAGc,OAAc;IACrCF,YAAY,YAAYE;AAC1B;AAEA,MAAMQ,gBAAgB,IAAIC,UAAAA,QAAQ,CAAS,OAAQ,CAACC,QAAUA,MAAMR,MAAM;AACnE,SAASb,SAAS,GAAGW,OAAc;IACxC,MAAMW,MAAMX,QAAQO,IAAI,CAAC;IACzB,IAAI,CAACC,cAAcI,GAAG,CAACD,MAAM;QAC3BH,cAAcK,GAAG,CAACF,KAAKA;QACvBvB,QAAQY;IACV;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">13629</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/server/request/root-params.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { InvariantError } from '../../shared/lib/invariant-error'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">postponeWithTracking,</span><span class="s3">\n  </span><span class="s1">throwToInterruptStaticGeneration,</span><span class="s3">\n</span><span class="s1">} from '../app-render/dynamic-rendering'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">workAsyncStorage,</span><span class="s3">\n  </span><span class="s1">type WorkStore,</span><span class="s3">\n</span><span class="s1">} from '../app-render/work-async-storage.external'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">workUnitAsyncStorage,</span><span class="s3">\n  </span><span class="s1">type PrerenderStoreLegacy,</span><span class="s3">\n  </span><span class="s1">type PrerenderStorePPR,</span><span class="s3">\n  </span><span class="s1">type StaticPrerenderStore,</span><span class="s3">\n</span><span class="s1">} from '../app-render/work-unit-async-storage.external'</span><span class="s3">\n</span><span class="s1">import { makeHangingPromise } from '../dynamic-rendering-utils'</span><span class="s3">\n</span><span class="s1">import type { FallbackRouteParams } from './fallback-params'</span><span class="s3">\n</span><span class="s1">import type { Params, ParamValue } from './params'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">describeStringPropertyAccess,</span><span class="s3">\n  </span><span class="s1">wellKnownProperties,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/utils/reflect-utils'</span><span class="s3">\n</span><span class="s1">import { actionAsyncStorage } from '../app-render/action-async-storage.external'</span><span class="s3">\n</span><span class="s1">import { warnOnce } from '../../build/output/log'</span><span class="s3">\n\n</span><span class="s1">interface CacheLifetime {}</span><span class="s3">\n</span><span class="s1">const CachedParams = new WeakMap&lt;CacheLifetime, Promise&lt;Params&gt;&gt;()</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @deprecated import specific root params from `next/root-params` instead.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export async function unstable_rootParams(): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">warnOnce(</span><span class="s3">\n    </span><span class="s1">'`unstable_rootParams()` is deprecated and will be removed in an upcoming major release. Import specific root params from `next/root-params` instead.'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (!workStore) {</span><span class="s3">\n    </span><span class="s1">throw new InvariantError('Missing workStore in unstable_rootParams')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n\n  </span><span class="s1">if (!workUnitStore) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Route ${workStore.route} used </span><span class="s3">\\</span><span class="s1">`unstable_rootParams()</span><span class="s3">\\</span><span class="s1">` in Pages Router. This API is only available within App Router.`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'cache':</span><span class="s3">\n    </span><span class="s1">case 'unstable-cache': {</span><span class="s3">\n      </span><span class="s1">throw new Error(</span><span class="s3">\n        </span><span class="s1">`Route ${workStore.route} used </span><span class="s3">\\</span><span class="s1">`unstable_rootParams()</span><span class="s3">\\</span><span class="s1">` inside </span><span class="s3">\\</span><span class="s1">`</span><span class="s3">\&quot;</span><span class="s1">use cache</span><span class="s3">\&quot;\\</span><span class="s1">` or </span><span class="s3">\\</span><span class="s1">`unstable_cache</span><span class="s3">\\</span><span class="s1">`. Support for this API inside cache scopes is planned for a future version of Next.js.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'prerender':</span><span class="s3">\n    </span><span class="s1">case 'prerender-client':</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">return createPrerenderRootParams(</span><span class="s3">\n        </span><span class="s1">workUnitStore.rootParams,</span><span class="s3">\n        </span><span class="s1">workStore,</span><span class="s3">\n        </span><span class="s1">workUnitStore</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">case 'private-cache':</span><span class="s3">\n    </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n    </span><span class="s1">case 'request':</span><span class="s3">\n      </span><span class="s1">return Promise.resolve(workUnitStore.rootParams)</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">return workUnitStore satisfies never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createPrerenderRootParams(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: StaticPrerenderStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">switch (prerenderStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'prerender-client': {</span><span class="s3">\n      </span><span class="s1">const exportName = '`unstable_rootParams`'</span><span class="s3">\n      </span><span class="s1">throw new InvariantError(</span><span class="s3">\n        </span><span class="s1">`${exportName} must not be used within a client component. Next.js should be preventing ${exportName} from being included in client components statically, but did not in this case.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'prerender': {</span><span class="s3">\n      </span><span class="s1">const fallbackParams = prerenderStore.fallbackRouteParams</span><span class="s3">\n      </span><span class="s1">if (fallbackParams) {</span><span class="s3">\n        </span><span class="s1">for (const key in underlyingParams) {</span><span class="s3">\n          </span><span class="s1">if (fallbackParams.has(key)) {</span><span class="s3">\n            </span><span class="s1">const cachedParams = CachedParams.get(underlyingParams)</span><span class="s3">\n            </span><span class="s1">if (cachedParams) {</span><span class="s3">\n              </span><span class="s1">return cachedParams</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">const promise = makeHangingPromise&lt;Params&gt;(</span><span class="s3">\n              </span><span class="s1">prerenderStore.renderSignal,</span><span class="s3">\n              </span><span class="s1">workStore.route,</span><span class="s3">\n              </span><span class="s1">'`unstable_rootParams`'</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">CachedParams.set(underlyingParams, promise)</span><span class="s3">\n\n            </span><span class="s1">return promise</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr': {</span><span class="s3">\n      </span><span class="s1">const fallbackParams = prerenderStore.fallbackRouteParams</span><span class="s3">\n      </span><span class="s1">if (fallbackParams) {</span><span class="s3">\n        </span><span class="s1">for (const key in underlyingParams) {</span><span class="s3">\n          </span><span class="s1">if (fallbackParams.has(key)) {</span><span class="s3">\n            </span><span class="s1">// We have fallback params at this level so we need to make an erroring</span><span class="s3">\n            </span><span class="s1">// params object which will postpone if you access the fallback params</span><span class="s3">\n            </span><span class="s1">return makeErroringRootParams(</span><span class="s3">\n              </span><span class="s1">underlyingParams,</span><span class="s3">\n              </span><span class="s1">fallbackParams,</span><span class="s3">\n              </span><span class="s1">workStore,</span><span class="s3">\n              </span><span class="s1">prerenderStore</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">prerenderStore satisfies never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// We don't have any fallback params so we have an entirely static safe params object</span><span class="s3">\n  </span><span class="s1">return Promise.resolve(underlyingParams)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function makeErroringRootParams(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">fallbackParams: FallbackRouteParams,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStorePPR | PrerenderStoreLegacy</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedParams = CachedParams.get(underlyingParams)</span><span class="s3">\n  </span><span class="s1">if (cachedParams) {</span><span class="s3">\n    </span><span class="s1">return cachedParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const augmentedUnderlying = { ...underlyingParams }</span><span class="s3">\n\n  </span><span class="s1">// We don't use makeResolvedReactPromise here because params</span><span class="s3">\n  </span><span class="s1">// supports copying with spread and we don't want to unnecessarily</span><span class="s3">\n  </span><span class="s1">// instrument the promise with spreadable properties of ReactPromise.</span><span class="s3">\n  </span><span class="s1">const promise = Promise.resolve(augmentedUnderlying)</span><span class="s3">\n  </span><span class="s1">CachedParams.set(underlyingParams, promise)</span><span class="s3">\n\n  </span><span class="s1">Object.keys(underlyingParams).forEach((prop) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (wellKnownProperties.has(prop)) {</span><span class="s3">\n      </span><span class="s1">// These properties cannot be shadowed because they need to be the</span><span class="s3">\n      </span><span class="s1">// true underlying value for Promises to work correctly at runtime</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if (fallbackParams.has(prop)) {</span><span class="s3">\n        </span><span class="s1">Object.defineProperty(augmentedUnderlying, prop, {</span><span class="s3">\n          </span><span class="s1">get() {</span><span class="s3">\n            </span><span class="s1">const expression = describeStringPropertyAccess(</span><span class="s3">\n              </span><span class="s1">'unstable_rootParams',</span><span class="s3">\n              </span><span class="s1">prop</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">// In most dynamic APIs we also throw if `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">` however</span><span class="s3">\n            </span><span class="s1">// for params is only dynamic when we're generating a fallback shell</span><span class="s3">\n            </span><span class="s1">// and even when `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">` we still support generating dynamic</span><span class="s3">\n            </span><span class="s1">// fallback shells</span><span class="s3">\n            </span><span class="s1">// TODO remove this comment when cacheComponents is the default since there</span><span class="s3">\n            </span><span class="s1">// will be no `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">`</span><span class="s3">\n            </span><span class="s1">if (prerenderStore.type === 'prerender-ppr') {</span><span class="s3">\n              </span><span class="s1">// PPR Prerender (no cacheComponents)</span><span class="s3">\n              </span><span class="s1">postponeWithTracking(</span><span class="s3">\n                </span><span class="s1">workStore.route,</span><span class="s3">\n                </span><span class="s1">expression,</span><span class="s3">\n                </span><span class="s1">prerenderStore.dynamicTracking</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">} else {</span><span class="s3">\n              </span><span class="s1">// Legacy Prerender</span><span class="s3">\n              </span><span class="s1">throwToInterruptStaticGeneration(</span><span class="s3">\n                </span><span class="s1">expression,</span><span class="s3">\n                </span><span class="s1">workStore,</span><span class="s3">\n                </span><span class="s1">prerenderStore</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">enumerable: true,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">;(promise as any)[prop] = underlyingParams[prop]</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">return promise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Used for the compiler-generated `next/root-params` module.</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function getRootParam(paramName: string): Promise&lt;ParamValue&gt; {</span><span class="s3">\n  </span><span class="s1">const apiName = `</span><span class="s3">\\</span><span class="s1">`import('next/root-params').${paramName}()</span><span class="s3">\\</span><span class="s1">``</span><span class="s3">\n\n  </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (!workStore) {</span><span class="s3">\n    </span><span class="s1">throw new InvariantError(`Missing workStore in ${apiName}`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (!workUnitStore) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Route ${workStore.route} used ${apiName} outside of a Server Component. This is not allowed.`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const actionStore = actionAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (actionStore) {</span><span class="s3">\n    </span><span class="s1">if (actionStore.isAppRoute) {</span><span class="s3">\n      </span><span class="s1">// TODO(root-params): add support for route handlers</span><span class="s3">\n      </span><span class="s1">throw new Error(</span><span class="s3">\n        </span><span class="s1">`Route ${workStore.route} used ${apiName} inside a Route Handler. Support for this API in Route Handlers is planned for a future version of Next.js.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">if (actionStore.isAction &amp;&amp; workUnitStore.phase === 'action') {</span><span class="s3">\n      </span><span class="s1">// Actions are not fundamentally tied to a route (even if they're always submitted from some page),</span><span class="s3">\n      </span><span class="s1">// so root params would be inconsistent if an action is called from multiple roots.</span><span class="s3">\n      </span><span class="s1">// Make sure we check if the phase is </span><span class="s3">\&quot;</span><span class="s1">action</span><span class="s3">\&quot; </span><span class="s1">- we should not error in the rerender</span><span class="s3">\n      </span><span class="s1">// after an action revalidates or updates cookies (which will still have `actionStore.isAction === true`)</span><span class="s3">\n      </span><span class="s1">throw new Error(</span><span class="s3">\n        </span><span class="s1">`${apiName} was used inside a Server Action. This is not supported. Functions from 'next/root-params' can only be called in the context of a route.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n    </span><span class="s1">case 'cache': {</span><span class="s3">\n      </span><span class="s1">throw new Error(</span><span class="s3">\n        </span><span class="s1">`Route ${workStore.route} used ${apiName} inside </span><span class="s3">\\</span><span class="s1">`</span><span class="s3">\&quot;</span><span class="s1">use cache</span><span class="s3">\&quot;\\</span><span class="s1">` or </span><span class="s3">\\</span><span class="s1">`unstable_cache</span><span class="s3">\\</span><span class="s1">`. Support for this API inside cache scopes is planned for a future version of Next.js.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'prerender':</span><span class="s3">\n    </span><span class="s1">case 'prerender-client':</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy': {</span><span class="s3">\n      </span><span class="s1">return createPrerenderRootParamPromise(</span><span class="s3">\n        </span><span class="s1">paramName,</span><span class="s3">\n        </span><span class="s1">workStore,</span><span class="s3">\n        </span><span class="s1">workUnitStore,</span><span class="s3">\n        </span><span class="s1">apiName</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'private-cache':</span><span class="s3">\n    </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n    </span><span class="s1">case 'request': {</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">default: {</span><span class="s3">\n      </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return Promise.resolve(workUnitStore.rootParams[paramName])</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createPrerenderRootParamPromise(</span><span class="s3">\n  </span><span class="s1">paramName: string,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: StaticPrerenderStore,</span><span class="s3">\n  </span><span class="s1">apiName: string</span><span class="s3">\n</span><span class="s1">): Promise&lt;ParamValue&gt; {</span><span class="s3">\n  </span><span class="s1">switch (prerenderStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'prerender-client': {</span><span class="s3">\n      </span><span class="s1">throw new InvariantError(</span><span class="s3">\n        </span><span class="s1">`${apiName} must not be used within a client component. Next.js should be preventing ${apiName} from being included in client components statically, but did not in this case.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'prerender':</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const underlyingParams = prerenderStore.rootParams</span><span class="s3">\n\n  </span><span class="s1">switch (prerenderStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'prerender': {</span><span class="s3">\n      </span><span class="s1">// We are in a dynamicIO prerender.</span><span class="s3">\n      </span><span class="s1">// The param is a fallback, so it should be treated as dynamic.</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">prerenderStore.fallbackRouteParams &amp;&amp;</span><span class="s3">\n        </span><span class="s1">prerenderStore.fallbackRouteParams.has(paramName)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">return makeHangingPromise&lt;ParamValue&gt;(</span><span class="s3">\n          </span><span class="s1">prerenderStore.renderSignal,</span><span class="s3">\n          </span><span class="s1">workStore.route,</span><span class="s3">\n          </span><span class="s1">apiName</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr': {</span><span class="s3">\n      </span><span class="s1">// We aren't in a dynamicIO prerender, but the param is a fallback,</span><span class="s3">\n      </span><span class="s1">// so we need to make an erroring params object which will postpone/error if you access it</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">prerenderStore.fallbackRouteParams &amp;&amp;</span><span class="s3">\n        </span><span class="s1">prerenderStore.fallbackRouteParams.has(paramName)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">return makeErroringRootParamPromise(</span><span class="s3">\n          </span><span class="s1">paramName,</span><span class="s3">\n          </span><span class="s1">workStore,</span><span class="s3">\n          </span><span class="s1">prerenderStore,</span><span class="s3">\n          </span><span class="s1">apiName</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy': {</span><span class="s3">\n      </span><span class="s1">// legacy prerenders can't have fallback params</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">default: {</span><span class="s3">\n      </span><span class="s1">prerenderStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If the param is not a fallback param, we just return the statically available value.</span><span class="s3">\n  </span><span class="s1">return Promise.resolve(underlyingParams[paramName])</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/** Deliberately async -- we want to create a rejected promise, not error synchronously. */</span><span class="s3">\n</span><span class="s1">async function makeErroringRootParamPromise(</span><span class="s3">\n  </span><span class="s1">paramName: string,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStorePPR | PrerenderStoreLegacy,</span><span class="s3">\n  </span><span class="s1">apiName: string</span><span class="s3">\n</span><span class="s1">): Promise&lt;ParamValue&gt; {</span><span class="s3">\n  </span><span class="s1">const expression = describeStringPropertyAccess(apiName, paramName)</span><span class="s3">\n  </span><span class="s1">// In most dynamic APIs, we also throw if `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">`.</span><span class="s3">\n  </span><span class="s1">// However, root params are only dynamic when we're generating a fallback shell,</span><span class="s3">\n  </span><span class="s1">// and even with `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">` we still support generating dynamic fallback shells.</span><span class="s3">\n  </span><span class="s1">// TODO: remove this comment when dynamicIO is the default since there will be no `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">`</span><span class="s3">\n  </span><span class="s1">switch (prerenderStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr': {</span><span class="s3">\n      </span><span class="s1">return postponeWithTracking(</span><span class="s3">\n        </span><span class="s1">workStore.route,</span><span class="s3">\n        </span><span class="s1">expression,</span><span class="s3">\n        </span><span class="s1">prerenderStore.dynamicTracking</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy': {</span><span class="s3">\n      </span><span class="s1">return throwToInterruptStaticGeneration(</span><span class="s3">\n        </span><span class="s1">expression,</span><span class="s3">\n        </span><span class="s1">workStore,</span><span class="s3">\n        </span><span class="s1">prerenderStore</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">default: {</span><span class="s3">\n      </span><span class="s1">prerenderStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getRootParam&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_rootParams&quot;</span><span class="s0">,</span><span class="s1">&quot;CachedParams&quot;</span><span class="s0">,</span><span class="s1">&quot;WeakMap&quot;</span><span class="s0">,</span><span class="s1">&quot;warnOnce&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitStore&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;createPrerenderRootParams&quot;</span><span class="s0">,</span><span class="s1">&quot;rootParams&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;underlyingParams&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderStore&quot;</span><span class="s0">,</span><span class="s1">&quot;exportName&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackParams&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;cachedParams&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;renderSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;makeErroringRootParams&quot;</span><span class="s0">,</span><span class="s1">&quot;augmentedUnderlying&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;wellKnownProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;defineProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;describeStringPropertyAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;postponeWithTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;throwToInterruptStaticGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;enumerable&quot;</span><span class="s0">,</span><span class="s1">&quot;paramName&quot;</span><span class="s0">,</span><span class="s1">&quot;apiName&quot;</span><span class="s0">,</span><span class="s1">&quot;actionStore&quot;</span><span class="s0">,</span><span class="s1">&quot;actionAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;isAppRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;isAction&quot;</span><span class="s0">,</span><span class="s1">&quot;phase&quot;</span><span class="s0">,</span><span class="s1">&quot;createPrerenderRootParamPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;makeErroringRootParamPromise&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">13938</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/server.js&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const serverExports = {</span><span class="s3">\n  </span><span class="s1">NextRequest: require('next/dist/server/web/spec-extension/request')</span><span class="s3">\n    </span><span class="s1">.NextRequest,</span><span class="s3">\n  </span><span class="s1">NextResponse: require('next/dist/server/web/spec-extension/response')</span><span class="s3">\n    </span><span class="s1">.NextResponse,</span><span class="s3">\n  </span><span class="s1">ImageResponse: require('next/dist/server/web/spec-extension/image-response')</span><span class="s3">\n    </span><span class="s1">.ImageResponse,</span><span class="s3">\n  </span><span class="s1">userAgentFromString: require('next/dist/server/web/spec-extension/user-agent')</span><span class="s3">\n    </span><span class="s1">.userAgentFromString,</span><span class="s3">\n  </span><span class="s1">userAgent: require('next/dist/server/web/spec-extension/user-agent')</span><span class="s3">\n    </span><span class="s1">.userAgent,</span><span class="s3">\n  </span><span class="s1">URLPattern: require('next/dist/server/web/spec-extension/url-pattern')</span><span class="s3">\n    </span><span class="s1">.URLPattern,</span><span class="s3">\n  </span><span class="s1">after: require('next/dist/server/after').after,</span><span class="s3">\n  </span><span class="s1">connection: require('next/dist/server/request/connection').connection,</span><span class="s3">\n  </span><span class="s1">unstable_rootParams: require('next/dist/server/request/root-params')</span><span class="s3">\n    </span><span class="s1">.unstable_rootParams,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// https://nodejs.org/api/esm.html#commonjs-namespaces</span><span class="s3">\n</span><span class="s1">// When importing CommonJS modules, the module.exports object is provided as the default export</span><span class="s3">\n</span><span class="s1">module.exports = serverExports</span><span class="s3">\n\n</span><span class="s1">// make import { xxx } from 'next/server' work</span><span class="s3">\n</span><span class="s1">exports.NextRequest = serverExports.NextRequest</span><span class="s3">\n</span><span class="s1">exports.NextResponse = serverExports.NextResponse</span><span class="s3">\n</span><span class="s1">exports.ImageResponse = serverExports.ImageResponse</span><span class="s3">\n</span><span class="s1">exports.userAgentFromString = serverExports.userAgentFromString</span><span class="s3">\n</span><span class="s1">exports.userAgent = serverExports.userAgent</span><span class="s3">\n</span><span class="s1">exports.URLPattern = serverExports.URLPattern</span><span class="s3">\n</span><span class="s1">exports.after = serverExports.after</span><span class="s3">\n</span><span class="s1">exports.connection = serverExports.connection</span><span class="s3">\n</span><span class="s1">exports.unstable_rootParams = serverExports.unstable_rootParams</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,MAAM,gBAAgB;IACpB,aAAa,0HACV,WAAW;IACd,cAAc,2HACX,YAAY;IACf,eAAe,iIACZ,aAAa;IAChB,qBAAqB,6HAClB,mBAAmB;IACtB,WAAW,6HACR,SAAS;IACZ,YAAY,8HACT,UAAU;IACb,OAAO,2GAAkC,KAAK;IAC9C,YAAY,kHAA+C,UAAU;IACrE,qBAAqB,mHAClB,mBAAmB;AACxB;AAEA,sDAAsD;AACtD,+FAA+F;AAC/F,OAAO,OAAO,GAAG;AAEjB,8CAA8C;AAC9C,QAAQ,WAAW,GAAG,cAAc,WAAW;AAC/C,QAAQ,YAAY,GAAG,cAAc,YAAY;AACjD,QAAQ,aAAa,GAAG,cAAc,aAAa;AACnD,QAAQ,mBAAmB,GAAG,cAAc,mBAAmB;AAC/D,QAAQ,SAAS,GAAG,cAAc,SAAS;AAC3C,QAAQ,UAAU,GAAG,cAAc,UAAU;AAC7C,QAAQ,KAAK,GAAG,cAAc,KAAK;AACnC,QAAQ,UAAU,GAAG,cAAc,UAAU;AAC7C,QAAQ,mBAAmB,GAAG,cAAc,mBAAmB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">13966</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/build/templates/app-route.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">AppRouteRouteModule,</span><span class="s3">\n  </span><span class="s1">type AppRouteRouteHandlerContext,</span><span class="s3">\n  </span><span class="s1">type AppRouteRouteModuleOptions,</span><span class="s3">\n</span><span class="s1">} from '../../server/route-modules/app-route/module.compiled'</span><span class="s3">\n</span><span class="s1">import { RouteKind } from '../../server/route-kind'</span><span class="s3">\n</span><span class="s1">import { patchFetch as _patchFetch } from '../../server/lib/patch-fetch'</span><span class="s3">\n</span><span class="s1">import type { IncomingMessage, ServerResponse } from 'node:http'</span><span class="s3">\n</span><span class="s1">import { getRequestMeta } from '../../server/request-meta'</span><span class="s3">\n</span><span class="s1">import { getTracer, type Span, SpanKind } from '../../server/lib/trace/tracer'</span><span class="s3">\n</span><span class="s1">import { normalizeAppPath } from '../../shared/lib/router/utils/app-paths'</span><span class="s3">\n</span><span class="s1">import { NodeNextRequest, NodeNextResponse } from '../../server/base-http/node'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">NextRequestAdapter,</span><span class="s3">\n  </span><span class="s1">signalFromNodeResponse,</span><span class="s3">\n</span><span class="s1">} from '../../server/web/spec-extension/adapters/next-request'</span><span class="s3">\n</span><span class="s1">import { BaseServerSpan } from '../../server/lib/trace/constants'</span><span class="s3">\n</span><span class="s1">import { getRevalidateReason } from '../../server/instrumentation/utils'</span><span class="s3">\n</span><span class="s1">import { sendResponse } from '../../server/send-response'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">fromNodeOutgoingHttpHeaders,</span><span class="s3">\n  </span><span class="s1">toNodeOutgoingHttpHeaders,</span><span class="s3">\n</span><span class="s1">} from '../../server/web/utils'</span><span class="s3">\n</span><span class="s1">import { getCacheControlHeader } from '../../server/lib/cache-control'</span><span class="s3">\n</span><span class="s1">import { INFINITE_CACHE, NEXT_CACHE_TAGS_HEADER } from '../../lib/constants'</span><span class="s3">\n</span><span class="s1">import { NoFallbackError } from '../../shared/lib/no-fallback-error.external'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">CachedRouteKind,</span><span class="s3">\n  </span><span class="s1">type ResponseCacheEntry,</span><span class="s3">\n  </span><span class="s1">type ResponseGenerator,</span><span class="s3">\n</span><span class="s1">} from '../../server/response-cache'</span><span class="s3">\n\n</span><span class="s1">import * as userland from 'VAR_USERLAND'</span><span class="s3">\n\n</span><span class="s1">// These are injected by the loader afterwards. This is injected as a variable</span><span class="s3">\n</span><span class="s1">// instead of a replacement because this could also be `undefined` instead of</span><span class="s3">\n</span><span class="s1">// an empty string.</span><span class="s3">\n</span><span class="s1">declare const nextConfigOutput: AppRouteRouteModuleOptions['nextConfigOutput']</span><span class="s3">\n\n</span><span class="s1">// We inject the nextConfigOutput here so that we can use them in the route</span><span class="s3">\n</span><span class="s1">// module.</span><span class="s3">\n</span><span class="s1">// INJECT:nextConfigOutput</span><span class="s3">\n\n</span><span class="s1">const routeModule = new AppRouteRouteModule({</span><span class="s3">\n  </span><span class="s1">definition: {</span><span class="s3">\n    </span><span class="s1">kind: RouteKind.APP_ROUTE,</span><span class="s3">\n    </span><span class="s1">page: 'VAR_DEFINITION_PAGE',</span><span class="s3">\n    </span><span class="s1">pathname: 'VAR_DEFINITION_PATHNAME',</span><span class="s3">\n    </span><span class="s1">filename: 'VAR_DEFINITION_FILENAME',</span><span class="s3">\n    </span><span class="s1">bundlePath: 'VAR_DEFINITION_BUNDLE_PATH',</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',</span><span class="s3">\n  </span><span class="s1">relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',</span><span class="s3">\n  </span><span class="s1">resolvedPagePath: 'VAR_RESOLVED_PAGE_PATH',</span><span class="s3">\n  </span><span class="s1">nextConfigOutput,</span><span class="s3">\n  </span><span class="s1">userland,</span><span class="s3">\n</span><span class="s1">})</span><span class="s3">\n\n</span><span class="s1">// Pull out the exports that we need to expose from the module. This should</span><span class="s3">\n</span><span class="s1">// be eliminated when we've moved the other routes to the new format. These</span><span class="s3">\n</span><span class="s1">// are used to hook into the route.</span><span class="s3">\n</span><span class="s1">const { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule</span><span class="s3">\n\n</span><span class="s1">function patchFetch() {</span><span class="s3">\n  </span><span class="s1">return _patchFetch({</span><span class="s3">\n    </span><span class="s1">workAsyncStorage,</span><span class="s3">\n    </span><span class="s1">workUnitAsyncStorage,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export {</span><span class="s3">\n  </span><span class="s1">routeModule,</span><span class="s3">\n  </span><span class="s1">workAsyncStorage,</span><span class="s3">\n  </span><span class="s1">workUnitAsyncStorage,</span><span class="s3">\n  </span><span class="s1">serverHooks,</span><span class="s3">\n  </span><span class="s1">patchFetch,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function handler(</span><span class="s3">\n  </span><span class="s1">req: IncomingMessage,</span><span class="s3">\n  </span><span class="s1">res: ServerResponse,</span><span class="s3">\n  </span><span class="s1">ctx: {</span><span class="s3">\n    </span><span class="s1">waitUntil: (prom: Promise&lt;void&gt;) =&gt; void</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">let srcPage = 'VAR_DEFINITION_PAGE'</span><span class="s3">\n\n  </span><span class="s1">// turbopack doesn't normalize `/index` in the page name</span><span class="s3">\n  </span><span class="s1">// so we need to to process dynamic routes properly</span><span class="s3">\n  </span><span class="s1">// TODO: fix turbopack providing differing value from webpack</span><span class="s3">\n  </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n    </span><span class="s1">srcPage = srcPage.replace(/</span><span class="s3">\\</span><span class="s1">/index$/, '') || '/'</span><span class="s3">\n  </span><span class="s1">} else if (srcPage === '/index') {</span><span class="s3">\n    </span><span class="s1">// we always normalize /index specifically</span><span class="s3">\n    </span><span class="s1">srcPage = '/'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const multiZoneDraftMode = process.env</span><span class="s3">\n    </span><span class="s1">.__NEXT_MULTI_ZONE_DRAFT_MODE as any as boolean</span><span class="s3">\n\n  </span><span class="s1">const prepareResult = await routeModule.prepare(req, res, {</span><span class="s3">\n    </span><span class="s1">srcPage,</span><span class="s3">\n    </span><span class="s1">multiZoneDraftMode,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">if (!prepareResult) {</span><span class="s3">\n    </span><span class="s1">res.statusCode = 400</span><span class="s3">\n    </span><span class="s1">res.end('Bad Request')</span><span class="s3">\n    </span><span class="s1">ctx.waitUntil?.(Promise.resolve())</span><span class="s3">\n    </span><span class="s1">return null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const {</span><span class="s3">\n    </span><span class="s1">buildId,</span><span class="s3">\n    </span><span class="s1">params,</span><span class="s3">\n    </span><span class="s1">nextConfig,</span><span class="s3">\n    </span><span class="s1">isDraftMode,</span><span class="s3">\n    </span><span class="s1">prerenderManifest,</span><span class="s3">\n    </span><span class="s1">routerServerContext,</span><span class="s3">\n    </span><span class="s1">isOnDemandRevalidate,</span><span class="s3">\n    </span><span class="s1">revalidateOnlyGenerated,</span><span class="s3">\n    </span><span class="s1">resolvedPathname,</span><span class="s3">\n  </span><span class="s1">} = prepareResult</span><span class="s3">\n\n  </span><span class="s1">const normalizedSrcPage = normalizeAppPath(srcPage)</span><span class="s3">\n\n  </span><span class="s1">let isIsr = Boolean(</span><span class="s3">\n    </span><span class="s1">prerenderManifest.dynamicRoutes[normalizedSrcPage] ||</span><span class="s3">\n      </span><span class="s1">prerenderManifest.routes[resolvedPathname]</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">if (isIsr &amp;&amp; !isDraftMode) {</span><span class="s3">\n    </span><span class="s1">const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname])</span><span class="s3">\n    </span><span class="s1">const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage]</span><span class="s3">\n\n    </span><span class="s1">if (prerenderInfo) {</span><span class="s3">\n      </span><span class="s1">if (prerenderInfo.fallback === false &amp;&amp; !isPrerendered) {</span><span class="s3">\n        </span><span class="s1">throw new NoFallbackError()</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let cacheKey: string | null = null</span><span class="s3">\n\n  </span><span class="s1">if (isIsr &amp;&amp; !routeModule.isDev &amp;&amp; !isDraftMode) {</span><span class="s3">\n    </span><span class="s1">cacheKey = resolvedPathname</span><span class="s3">\n    </span><span class="s1">// ensure /index and / is normalized to one key</span><span class="s3">\n    </span><span class="s1">cacheKey = cacheKey === '/index' ? '/' : cacheKey</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const supportsDynamicResponse: boolean =</span><span class="s3">\n    </span><span class="s1">// If we're in development, we always support dynamic HTML</span><span class="s3">\n    </span><span class="s1">routeModule.isDev === true ||</span><span class="s3">\n    </span><span class="s1">// If this is not SSG or does not have static paths, then it supports</span><span class="s3">\n    </span><span class="s1">// dynamic HTML.</span><span class="s3">\n    </span><span class="s1">!isIsr</span><span class="s3">\n\n  </span><span class="s1">// This is a revalidation request if the request is for a static</span><span class="s3">\n  </span><span class="s1">// page and it is not being resumed from a postponed render and</span><span class="s3">\n  </span><span class="s1">// it is not a dynamic RSC request then it is a revalidation</span><span class="s3">\n  </span><span class="s1">// request.</span><span class="s3">\n  </span><span class="s1">const isRevalidate = isIsr &amp;&amp; !supportsDynamicResponse</span><span class="s3">\n\n  </span><span class="s1">const method = req.method || 'GET'</span><span class="s3">\n  </span><span class="s1">const tracer = getTracer()</span><span class="s3">\n  </span><span class="s1">const activeSpan = tracer.getActiveScopeSpan()</span><span class="s3">\n\n  </span><span class="s1">const context: AppRouteRouteHandlerContext = {</span><span class="s3">\n    </span><span class="s1">params,</span><span class="s3">\n    </span><span class="s1">prerenderManifest,</span><span class="s3">\n    </span><span class="s1">renderOpts: {</span><span class="s3">\n      </span><span class="s1">experimental: {</span><span class="s3">\n        </span><span class="s1">cacheComponents: Boolean(nextConfig.experimental.cacheComponents),</span><span class="s3">\n        </span><span class="s1">authInterrupts: Boolean(nextConfig.experimental.authInterrupts),</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">supportsDynamicResponse,</span><span class="s3">\n      </span><span class="s1">incrementalCache: getRequestMeta(req, 'incrementalCache'),</span><span class="s3">\n      </span><span class="s1">cacheLifeProfiles: nextConfig.experimental?.cacheLife,</span><span class="s3">\n      </span><span class="s1">isRevalidate,</span><span class="s3">\n      </span><span class="s1">waitUntil: ctx.waitUntil,</span><span class="s3">\n      </span><span class="s1">onClose: (cb) =&gt; {</span><span class="s3">\n        </span><span class="s1">res.on('close', cb)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">onAfterTaskError: undefined,</span><span class="s3">\n      </span><span class="s1">onInstrumentationRequestError: (error, _request, errorContext) =&gt;</span><span class="s3">\n        </span><span class="s1">routeModule.onRequestError(</span><span class="s3">\n          </span><span class="s1">req,</span><span class="s3">\n          </span><span class="s1">error,</span><span class="s3">\n          </span><span class="s1">errorContext,</span><span class="s3">\n          </span><span class="s1">routerServerContext</span><span class="s3">\n        </span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">sharedContext: {</span><span class="s3">\n      </span><span class="s1">buildId,</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const nodeNextReq = new NodeNextRequest(req)</span><span class="s3">\n  </span><span class="s1">const nodeNextRes = new NodeNextResponse(res)</span><span class="s3">\n\n  </span><span class="s1">const nextReq = NextRequestAdapter.fromNodeNextRequest(</span><span class="s3">\n    </span><span class="s1">nodeNextReq,</span><span class="s3">\n    </span><span class="s1">signalFromNodeResponse(res)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">const invokeRouteModule = async (span?: Span) =&gt; {</span><span class="s3">\n      </span><span class="s1">return routeModule.handle(nextReq, context).finally(() =&gt; {</span><span class="s3">\n        </span><span class="s1">if (!span) return</span><span class="s3">\n\n        </span><span class="s1">span.setAttributes({</span><span class="s3">\n          </span><span class="s1">'http.status_code': res.statusCode,</span><span class="s3">\n          </span><span class="s1">'next.rsc': false,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n\n        </span><span class="s1">const rootSpanAttributes = tracer.getRootSpanAttributes()</span><span class="s3">\n        </span><span class="s1">// We were unable to get attributes, probably OTEL is not enabled</span><span class="s3">\n        </span><span class="s1">if (!rootSpanAttributes) {</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">rootSpanAttributes.get('next.span_type') !==</span><span class="s3">\n          </span><span class="s1">BaseServerSpan.handleRequest</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">console.warn(</span><span class="s3">\n            </span><span class="s1">`Unexpected root span type '${rootSpanAttributes.get(</span><span class="s3">\n              </span><span class="s1">'next.span_type'</span><span class="s3">\n            </span><span class="s1">)}'. Please report this Next.js issue https://github.com/vercel/next.js`</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const route = rootSpanAttributes.get('next.route')</span><span class="s3">\n        </span><span class="s1">if (route) {</span><span class="s3">\n          </span><span class="s1">const name = `${method} ${route}`</span><span class="s3">\n\n          </span><span class="s1">span.setAttributes({</span><span class="s3">\n            </span><span class="s1">'next.route': route,</span><span class="s3">\n            </span><span class="s1">'http.route': route,</span><span class="s3">\n            </span><span class="s1">'next.span_name': name,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">span.updateName(name)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">span.updateName(`${method} ${req.url}`)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const handleResponse = async (currentSpan?: Span) =&gt; {</span><span class="s3">\n      </span><span class="s1">const responseGenerator: ResponseGenerator = async ({</span><span class="s3">\n        </span><span class="s1">previousCacheEntry,</span><span class="s3">\n      </span><span class="s1">}) =&gt; {</span><span class="s3">\n        </span><span class="s1">try {</span><span class="s3">\n          </span><span class="s1">if (</span><span class="s3">\n            </span><span class="s1">!getRequestMeta(req, 'minimalMode') &amp;&amp;</span><span class="s3">\n            </span><span class="s1">isOnDemandRevalidate &amp;&amp;</span><span class="s3">\n            </span><span class="s1">revalidateOnlyGenerated &amp;&amp;</span><span class="s3">\n            </span><span class="s1">!previousCacheEntry</span><span class="s3">\n          </span><span class="s1">) {</span><span class="s3">\n            </span><span class="s1">res.statusCode = 404</span><span class="s3">\n            </span><span class="s1">// on-demand revalidate always sets this header</span><span class="s3">\n            </span><span class="s1">res.setHeader('x-nextjs-cache', 'REVALIDATED')</span><span class="s3">\n            </span><span class="s1">res.end('This page could not be found')</span><span class="s3">\n            </span><span class="s1">return null</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">const response = await invokeRouteModule(currentSpan)</span><span class="s3">\n\n          </span><span class="s1">;(req as any).fetchMetrics = (context.renderOpts as any).fetchMetrics</span><span class="s3">\n          </span><span class="s1">let pendingWaitUntil = context.renderOpts.pendingWaitUntil</span><span class="s3">\n\n          </span><span class="s1">// Attempt using provided waitUntil if available</span><span class="s3">\n          </span><span class="s1">// if it's not we fallback to sendResponse's handling</span><span class="s3">\n          </span><span class="s1">if (pendingWaitUntil) {</span><span class="s3">\n            </span><span class="s1">if (ctx.waitUntil) {</span><span class="s3">\n              </span><span class="s1">ctx.waitUntil(pendingWaitUntil)</span><span class="s3">\n              </span><span class="s1">pendingWaitUntil = undefined</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">const cacheTags = context.renderOpts.collectedTags</span><span class="s3">\n\n          </span><span class="s1">// If the request is for a static response, we can cache it so long</span><span class="s3">\n          </span><span class="s1">// as it's not edge.</span><span class="s3">\n          </span><span class="s1">if (isIsr) {</span><span class="s3">\n            </span><span class="s1">const blob = await response.blob()</span><span class="s3">\n\n            </span><span class="s1">// Copy the headers from the response.</span><span class="s3">\n            </span><span class="s1">const headers = toNodeOutgoingHttpHeaders(response.headers)</span><span class="s3">\n\n            </span><span class="s1">if (cacheTags) {</span><span class="s3">\n              </span><span class="s1">headers[NEXT_CACHE_TAGS_HEADER] = cacheTags</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">if (!headers['content-type'] &amp;&amp; blob.type) {</span><span class="s3">\n              </span><span class="s1">headers['content-type'] = blob.type</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">const revalidate =</span><span class="s3">\n              </span><span class="s1">typeof context.renderOpts.collectedRevalidate === 'undefined' ||</span><span class="s3">\n              </span><span class="s1">context.renderOpts.collectedRevalidate &gt;= INFINITE_CACHE</span><span class="s3">\n                </span><span class="s1">? false</span><span class="s3">\n                </span><span class="s1">: context.renderOpts.collectedRevalidate</span><span class="s3">\n\n            </span><span class="s1">const expire =</span><span class="s3">\n              </span><span class="s1">typeof context.renderOpts.collectedExpire === 'undefined' ||</span><span class="s3">\n              </span><span class="s1">context.renderOpts.collectedExpire &gt;= INFINITE_CACHE</span><span class="s3">\n                </span><span class="s1">? undefined</span><span class="s3">\n                </span><span class="s1">: context.renderOpts.collectedExpire</span><span class="s3">\n\n            </span><span class="s1">// Create the cache entry for the response.</span><span class="s3">\n            </span><span class="s1">const cacheEntry: ResponseCacheEntry = {</span><span class="s3">\n              </span><span class="s1">value: {</span><span class="s3">\n                </span><span class="s1">kind: CachedRouteKind.APP_ROUTE,</span><span class="s3">\n                </span><span class="s1">status: response.status,</span><span class="s3">\n                </span><span class="s1">body: Buffer.from(await blob.arrayBuffer()),</span><span class="s3">\n                </span><span class="s1">headers,</span><span class="s3">\n              </span><span class="s1">},</span><span class="s3">\n              </span><span class="s1">cacheControl: { revalidate, expire },</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">return cacheEntry</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">// send response without caching if not ISR</span><span class="s3">\n            </span><span class="s1">await sendResponse(</span><span class="s3">\n              </span><span class="s1">nodeNextReq,</span><span class="s3">\n              </span><span class="s1">nodeNextRes,</span><span class="s3">\n              </span><span class="s1">response,</span><span class="s3">\n              </span><span class="s1">context.renderOpts.pendingWaitUntil</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">return null</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">} catch (err) {</span><span class="s3">\n          </span><span class="s1">// if this is a background revalidate we need to report</span><span class="s3">\n          </span><span class="s1">// the request error here as it won't be bubbled</span><span class="s3">\n          </span><span class="s1">if (previousCacheEntry?.isStale) {</span><span class="s3">\n            </span><span class="s1">await routeModule.onRequestError(</span><span class="s3">\n              </span><span class="s1">req,</span><span class="s3">\n              </span><span class="s1">err,</span><span class="s3">\n              </span><span class="s1">{</span><span class="s3">\n                </span><span class="s1">routerKind: 'App Router',</span><span class="s3">\n                </span><span class="s1">routePath: srcPage,</span><span class="s3">\n                </span><span class="s1">routeType: 'route',</span><span class="s3">\n                </span><span class="s1">revalidateReason: getRevalidateReason({</span><span class="s3">\n                  </span><span class="s1">isRevalidate,</span><span class="s3">\n                  </span><span class="s1">isOnDemandRevalidate,</span><span class="s3">\n                </span><span class="s1">}),</span><span class="s3">\n              </span><span class="s1">},</span><span class="s3">\n              </span><span class="s1">routerServerContext</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">throw err</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const cacheEntry = await routeModule.handleResponse({</span><span class="s3">\n        </span><span class="s1">req,</span><span class="s3">\n        </span><span class="s1">nextConfig,</span><span class="s3">\n        </span><span class="s1">cacheKey,</span><span class="s3">\n        </span><span class="s1">routeKind: RouteKind.APP_ROUTE,</span><span class="s3">\n        </span><span class="s1">isFallback: false,</span><span class="s3">\n        </span><span class="s1">prerenderManifest,</span><span class="s3">\n        </span><span class="s1">isRoutePPREnabled: false,</span><span class="s3">\n        </span><span class="s1">isOnDemandRevalidate,</span><span class="s3">\n        </span><span class="s1">revalidateOnlyGenerated,</span><span class="s3">\n        </span><span class="s1">responseGenerator,</span><span class="s3">\n        </span><span class="s1">waitUntil: ctx.waitUntil,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n\n      </span><span class="s1">// we don't create a cacheEntry for ISR</span><span class="s3">\n      </span><span class="s1">if (!isIsr) {</span><span class="s3">\n        </span><span class="s1">return null</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (cacheEntry?.value?.kind !== CachedRouteKind.APP_ROUTE) {</span><span class="s3">\n        </span><span class="s1">throw new Error(</span><span class="s3">\n          </span><span class="s1">`Invariant: app-route received invalid cache entry ${cacheEntry?.value?.kind}`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (!getRequestMeta(req, 'minimalMode')) {</span><span class="s3">\n        </span><span class="s1">res.setHeader(</span><span class="s3">\n          </span><span class="s1">'x-nextjs-cache',</span><span class="s3">\n          </span><span class="s1">isOnDemandRevalidate</span><span class="s3">\n            </span><span class="s1">? 'REVALIDATED'</span><span class="s3">\n            </span><span class="s1">: cacheEntry.isMiss</span><span class="s3">\n              </span><span class="s1">? 'MISS'</span><span class="s3">\n              </span><span class="s1">: cacheEntry.isStale</span><span class="s3">\n                </span><span class="s1">? 'STALE'</span><span class="s3">\n                </span><span class="s1">: 'HIT'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Draft mode should never be cached</span><span class="s3">\n      </span><span class="s1">if (isDraftMode) {</span><span class="s3">\n        </span><span class="s1">res.setHeader(</span><span class="s3">\n          </span><span class="s1">'Cache-Control',</span><span class="s3">\n          </span><span class="s1">'private, no-cache, no-store, max-age=0, must-revalidate'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const headers = fromNodeOutgoingHttpHeaders(cacheEntry.value.headers)</span><span class="s3">\n\n      </span><span class="s1">if (!(getRequestMeta(req, 'minimalMode') &amp;&amp; isIsr)) {</span><span class="s3">\n        </span><span class="s1">headers.delete(NEXT_CACHE_TAGS_HEADER)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// If cache control is already set on the response we don't</span><span class="s3">\n      </span><span class="s1">// override it to allow users to customize it via next.config</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">cacheEntry.cacheControl &amp;&amp;</span><span class="s3">\n        </span><span class="s1">!res.getHeader('Cache-Control') &amp;&amp;</span><span class="s3">\n        </span><span class="s1">!headers.get('Cache-Control')</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">headers.set(</span><span class="s3">\n          </span><span class="s1">'Cache-Control',</span><span class="s3">\n          </span><span class="s1">getCacheControlHeader(cacheEntry.cacheControl)</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">await sendResponse(</span><span class="s3">\n        </span><span class="s1">nodeNextReq,</span><span class="s3">\n        </span><span class="s1">nodeNextRes,</span><span class="s3">\n        </span><span class="s1">new Response(cacheEntry.value.body, {</span><span class="s3">\n          </span><span class="s1">headers,</span><span class="s3">\n          </span><span class="s1">status: cacheEntry.value.status || 200,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">return null</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// TODO: activeSpan code path is for when wrapped by</span><span class="s3">\n    </span><span class="s1">// next-server can be removed when this is no longer used</span><span class="s3">\n    </span><span class="s1">if (activeSpan) {</span><span class="s3">\n      </span><span class="s1">await handleResponse(activeSpan)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">await tracer.withPropagatedContext(req.headers, () =&gt;</span><span class="s3">\n        </span><span class="s1">tracer.trace(</span><span class="s3">\n          </span><span class="s1">BaseServerSpan.handleRequest,</span><span class="s3">\n          </span><span class="s1">{</span><span class="s3">\n            </span><span class="s1">spanName: `${method} ${req.url}`,</span><span class="s3">\n            </span><span class="s1">kind: SpanKind.SERVER,</span><span class="s3">\n            </span><span class="s1">attributes: {</span><span class="s3">\n              </span><span class="s1">'http.method': method,</span><span class="s3">\n              </span><span class="s1">'http.target': req.url,</span><span class="s3">\n            </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">handleResponse</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} catch (err) {</span><span class="s3">\n    </span><span class="s1">if (!(err instanceof NoFallbackError)) {</span><span class="s3">\n      </span><span class="s1">await routeModule.onRequestError(req, err, {</span><span class="s3">\n        </span><span class="s1">routerKind: 'App Router',</span><span class="s3">\n        </span><span class="s1">routePath: normalizedSrcPage,</span><span class="s3">\n        </span><span class="s1">routeType: 'route',</span><span class="s3">\n        </span><span class="s1">revalidateReason: getRevalidateReason({</span><span class="s3">\n          </span><span class="s1">isRevalidate,</span><span class="s3">\n          </span><span class="s1">isOnDemandRevalidate,</span><span class="s3">\n        </span><span class="s1">}),</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// rethrow so that we can handle serving error page</span><span class="s3">\n\n    </span><span class="s1">// If this is during static generation, throw the error again.</span><span class="s3">\n    </span><span class="s1">if (isIsr) throw err</span><span class="s3">\n\n    </span><span class="s1">// Otherwise, send a 500 response.</span><span class="s3">\n    </span><span class="s1">await sendResponse(</span><span class="s3">\n      </span><span class="s1">nodeNextReq,</span><span class="s3">\n      </span><span class="s1">nodeNextRes,</span><span class="s3">\n      </span><span class="s1">new Response(null, { status: 500 })</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">return null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;AppRouteRouteModule&quot;</span><span class="s0">,</span><span class="s1">&quot;RouteKind&quot;</span><span class="s0">,</span><span class="s1">&quot;patchFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;_patchFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;getRequestMeta&quot;</span><span class="s0">,</span><span class="s1">&quot;getTracer&quot;</span><span class="s0">,</span><span class="s1">&quot;SpanKind&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeNextResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;NextRequestAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;signalFromNodeResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;BaseServerSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;getRevalidateReason&quot;</span><span class="s0">,</span><span class="s1">&quot;sendResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;fromNodeOutgoingHttpHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;toNodeOutgoingHttpHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;getCacheControlHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;INFINITE_CACHE&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_TAGS_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NoFallbackError&quot;</span><span class="s0">,</span><span class="s1">&quot;CachedRouteKind&quot;</span><span class="s0">,</span><span class="s1">&quot;userland&quot;</span><span class="s0">,</span><span class="s1">&quot;routeModule&quot;</span><span class="s0">,</span><span class="s1">&quot;definition&quot;</span><span class="s0">,</span><span class="s1">&quot;kind&quot;</span><span class="s0">,</span><span class="s1">&quot;APP_ROUTE&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;filename&quot;</span><span class="s0">,</span><span class="s1">&quot;bundlePath&quot;</span><span class="s0">,</span><span class="s1">&quot;distDir&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_RELATIVE_DIST_DIR&quot;</span><span class="s0">,</span><span class="s1">&quot;relativeProjectDir&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_RELATIVE_PROJECT_DIR&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvedPagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfigOutput&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;serverHooks&quot;</span><span class="s0">,</span><span class="s1">&quot;handler&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;ctx&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;srcPage&quot;</span><span class="s0">,</span><span class="s1">&quot;TURBOPACK&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;multiZoneDraftMode&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_MULTI_ZONE_DRAFT_MODE&quot;</span><span class="s0">,</span><span class="s1">&quot;prepareResult&quot;</span><span class="s0">,</span><span class="s1">&quot;prepare&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;waitUntil&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;isDraftMode&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;routerServerContext&quot;</span><span class="s0">,</span><span class="s1">&quot;isOnDemandRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidateOnlyGenerated&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvedPathname&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizedSrcPage&quot;</span><span class="s0">,</span><span class="s1">&quot;isIsr&quot;</span><span class="s0">,</span><span class="s1">&quot;Boolean&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;routes&quot;</span><span class="s0">,</span><span class="s1">&quot;isPrerendered&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;fallback&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;isDev&quot;</span><span class="s0">,</span><span class="s1">&quot;supportsDynamicResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;isRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;tracer&quot;</span><span class="s0">,</span><span class="s1">&quot;activeSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;getActiveScopeSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;context&quot;</span><span class="s0">,</span><span class="s1">&quot;renderOpts&quot;</span><span class="s0">,</span><span class="s1">&quot;experimental&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheComponents&quot;</span><span class="s0">,</span><span class="s1">&quot;authInterrupts&quot;</span><span class="s0">,</span><span class="s1">&quot;incrementalCache&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheLifeProfiles&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheLife&quot;</span><span class="s0">,</span><span class="s1">&quot;onClose&quot;</span><span class="s0">,</span><span class="s1">&quot;cb&quot;</span><span class="s0">,</span><span class="s1">&quot;on&quot;</span><span class="s0">,</span><span class="s1">&quot;onAfterTaskError&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;onInstrumentationRequestError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;_request&quot;</span><span class="s0">,</span><span class="s1">&quot;errorContext&quot;</span><span class="s0">,</span><span class="s1">&quot;onRequestError&quot;</span><span class="s0">,</span><span class="s1">&quot;sharedContext&quot;</span><span class="s0">,</span><span class="s1">&quot;nodeNextReq&quot;</span><span class="s0">,</span><span class="s1">&quot;nodeNextRes&quot;</span><span class="s0">,</span><span class="s1">&quot;nextReq&quot;</span><span class="s0">,</span><span class="s1">&quot;fromNodeNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;invokeRouteModule&quot;</span><span class="s0">,</span><span class="s1">&quot;span&quot;</span><span class="s0">,</span><span class="s1">&quot;handle&quot;</span><span class="s0">,</span><span class="s1">&quot;finally&quot;</span><span class="s0">,</span><span class="s1">&quot;setAttributes&quot;</span><span class="s0">,</span><span class="s1">&quot;rootSpanAttributes&quot;</span><span class="s0">,</span><span class="s1">&quot;getRootSpanAttributes&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;handleRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;warn&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;updateName&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;handleResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;currentSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;responseGenerator&quot;</span><span class="s0">,</span><span class="s1">&quot;previousCacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;setHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchMetrics&quot;</span><span class="s0">,</span><span class="s1">&quot;pendingWaitUntil&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheTags&quot;</span><span class="s0">,</span><span class="s1">&quot;collectedTags&quot;</span><span class="s0">,</span><span class="s1">&quot;blob&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;collectedRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;expire&quot;</span><span class="s0">,</span><span class="s1">&quot;collectedExpire&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;Buffer&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;arrayBuffer&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheControl&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;isStale&quot;</span><span class="s0">,</span><span class="s1">&quot;routerKind&quot;</span><span class="s0">,</span><span class="s1">&quot;routePath&quot;</span><span class="s0">,</span><span class="s1">&quot;routeType&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidateReason&quot;</span><span class="s0">,</span><span class="s1">&quot;routeKind&quot;</span><span class="s0">,</span><span class="s1">&quot;isFallback&quot;</span><span class="s0">,</span><span class="s1">&quot;isRoutePPREnabled&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;isMiss&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;Response&quot;</span><span class="s0">,</span><span class="s1">&quot;withPropagatedContext&quot;</span><span class="s0">,</span><span class="s1">&quot;trace&quot;</span><span class="s0">,</span><span class="s1">&quot;spanName&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER&quot;</span><span class="s0">,</span><span class="s1">&quot;attributes&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}}]</span>
<span class="s0">}</span></pre>
</body>
</html>