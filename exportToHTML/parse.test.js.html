<html>
<head>
<title>parse.test.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #8c8c8c; font-style: italic;}
.s4 { color: #1750eb;}
.s5 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
parse.test.js</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">metadata from </span><span class="s2">'../../metadata.min.json' </span><span class="s0">with </span><span class="s1">{ type: </span><span class="s2">'json' </span><span class="s1">}</span>
<span class="s0">import </span><span class="s1">_parseNumber from </span><span class="s2">'./parse.js'</span>
<span class="s0">import </span><span class="s1">Metadata from </span><span class="s2">'../metadata.js'</span>

<span class="s0">function </span><span class="s1">parseNumber(...parameters) {</span>
	<span class="s1">parameters.push(metadata)</span>
	<span class="s0">return </span><span class="s1">_parseNumber.apply(</span><span class="s0">this</span><span class="s1">, parameters)</span>
<span class="s1">}</span>

<span class="s0">const </span><span class="s1">USE_NON_GEOGRAPHIC_COUNTRY_CODE = </span><span class="s0">false</span>

<span class="s1">describe(</span><span class="s2">'parse'</span><span class="s1">, () =&gt; {</span>
	<span class="s1">it(</span><span class="s2">'should not parse invalid phone numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Too short.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+7 (800) 55-35-35'</span><span class="s1">)).to.deep.equal({})</span>
		<span class="s3">// Too long.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+7 (800) 55-35-35-55'</span><span class="s1">)).to.deep.equal({})</span>

		<span class="s1">expect(parseNumber(</span><span class="s2">'+7 (800) 55-35-35'</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">)).to.deep.equal({})</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'(800) 55 35 35'</span><span class="s1">, { defaultCountry: </span><span class="s2">'RU' </span><span class="s1">})).to.deep.equal({})</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+1 187 215 5230'</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">)).to.deep.equal({})</span>

		<span class="s1">expect(parseNumber(</span><span class="s2">'911231231'</span><span class="s1">, </span><span class="s2">'BE'</span><span class="s1">)).to.deep.equal({})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse valid phone numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Instant loans</span>
		<span class="s3">// https://www.youtube.com/watch?v=6e1pMrYH5jI</span>
		<span class="s3">//</span>
		<span class="s3">// Restrict to RU</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'Phone: 8 (800) 555 35 35.'</span><span class="s1">, </span><span class="s2">'RU'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'RU'</span><span class="s1">, phone: </span><span class="s2">'8005553535' </span><span class="s1">})</span>
		<span class="s3">// International format</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'Phone: +7 (800) 555-35-35.'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'RU'</span><span class="s1">, phone: </span><span class="s2">'8005553535' </span><span class="s1">})</span>
		<span class="s3">// // Restrict to US, but not a US country phone code supplied</span>
		<span class="s3">// parseNumber('+7 (800) 555-35-35', 'US').should.deep.equal({})</span>
		<span class="s3">// Restrict to RU</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'(800) 555 35 35'</span><span class="s1">, </span><span class="s2">'RU'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'RU'</span><span class="s1">, phone: </span><span class="s2">'8005553535' </span><span class="s1">})</span>
		<span class="s3">// Default to RU</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'8 (800) 555 35 35'</span><span class="s1">, { defaultCountry: </span><span class="s2">'RU' </span><span class="s1">})).to.deep.equal({ country: </span><span class="s2">'RU'</span><span class="s1">, phone: </span><span class="s2">'8005553535' </span><span class="s1">})</span>

		<span class="s3">// Gangster partyline</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+1-213-373-4253'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'US'</span><span class="s1">, phone: </span><span class="s2">'2133734253' </span><span class="s1">})</span>

		<span class="s3">// Switzerland (just in case)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'044 668 18 00'</span><span class="s1">, </span><span class="s2">'CH'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'CH'</span><span class="s1">, phone: </span><span class="s2">'446681800' </span><span class="s1">})</span>

		<span class="s3">// China, Beijing</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'010-852644821'</span><span class="s1">, </span><span class="s2">'CN'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'CN'</span><span class="s1">, phone: </span><span class="s2">'10852644821' </span><span class="s1">})</span>

		<span class="s3">// France</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+33169454850'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'FR'</span><span class="s1">, phone: </span><span class="s2">'169454850' </span><span class="s1">})</span>

		<span class="s3">// UK (Jersey)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+44 7700 300000'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'JE'</span><span class="s1">, phone: </span><span class="s2">'7700300000' </span><span class="s1">})</span>

		<span class="s3">// KZ</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+7 702 211 1111'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'KZ'</span><span class="s1">, phone: </span><span class="s2">'7022111111' </span><span class="s1">})</span>

		<span class="s3">// Brazil</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'11987654321'</span><span class="s1">, </span><span class="s2">'BR'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'BR'</span><span class="s1">, phone: </span><span class="s2">'11987654321' </span><span class="s1">})</span>

		<span class="s3">// Long country phone code.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+212659777777'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'MA'</span><span class="s1">, phone: </span><span class="s2">'659777777' </span><span class="s1">})</span>

		<span class="s3">// No country could be derived.</span>
		<span class="s3">// parseNumber('+212569887076').should.deep.equal({ countryPhoneCode: '212', phone: '569887076' })</span>

		<span class="s3">// GB. Moible numbers starting 07624* are Isle of Man.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'07624369230'</span><span class="s1">, </span><span class="s2">'GB'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'IM'</span><span class="s1">, phone: </span><span class="s2">'7624369230' </span><span class="s1">})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse possible numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Invalid phone number for a given country.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'1112223344'</span><span class="s1">, </span><span class="s2">'RU'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({</span>
			<span class="s1">country            : </span><span class="s2">'RU'</span><span class="s1">,</span>
			<span class="s1">countryCallingCode : </span><span class="s2">'7'</span><span class="s1">,</span>
			<span class="s1">phone              : </span><span class="s2">'1112223344'</span><span class="s1">,</span>
			<span class="s1">carrierCode        : undefined,</span>
			<span class="s1">ext                : undefined,</span>
			<span class="s1">valid              : </span><span class="s0">false</span><span class="s1">,</span>
			<span class="s1">possible           : </span><span class="s0">true</span>
		<span class="s1">})</span>

		<span class="s3">// International phone number.</span>
		<span class="s3">// Several countries with the same country phone code.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+71112223344'</span><span class="s1">)).to.deep.equal({})</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+71112223344'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({</span>
			<span class="s1">country            : undefined,</span>
			<span class="s1">countryCallingCode : </span><span class="s2">'7'</span><span class="s1">,</span>
			<span class="s1">phone              : </span><span class="s2">'1112223344'</span><span class="s1">,</span>
			<span class="s1">carrierCode        : undefined,</span>
			<span class="s1">ext                : undefined,</span>
			<span class="s1">valid              : </span><span class="s0">false</span><span class="s1">,</span>
			<span class="s1">possible           : </span><span class="s0">true</span>
		<span class="s1">})</span>

		<span class="s3">// International phone number.</span>
		<span class="s3">// Single country with the given country phone code.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+33011222333'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({</span>
			<span class="s1">country            : </span><span class="s2">'FR'</span><span class="s1">,</span>
			<span class="s1">countryCallingCode : </span><span class="s2">'33'</span><span class="s1">,</span>
			<span class="s1">phone              : </span><span class="s2">'011222333'</span><span class="s1">,</span>
			<span class="s1">carrierCode        : undefined,</span>
			<span class="s1">ext                : undefined,</span>
			<span class="s1">valid              : </span><span class="s0">false</span><span class="s1">,</span>
			<span class="s1">possible           : </span><span class="s0">true</span>
		<span class="s1">})</span>

		<span class="s3">// Too short.</span>
		<span class="s3">// Won't strip national prefix `8` because otherwise the number would be too short.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+7 (800) 55-35-35'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({</span>
			<span class="s1">country            : undefined,</span>
			<span class="s1">countryCallingCode : </span><span class="s2">'7'</span><span class="s1">,</span>
			<span class="s1">phone              : </span><span class="s2">'800553535'</span><span class="s1">,</span>
			<span class="s1">carrierCode        : undefined,</span>
			<span class="s1">ext                : undefined,</span>
			<span class="s1">valid              : </span><span class="s0">false</span><span class="s1">,</span>
			<span class="s1">possible           : </span><span class="s0">false</span>
		<span class="s1">})</span>

		<span class="s3">// Too long.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+1 213 37342530'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({</span>
			<span class="s1">country            : undefined,</span>
			<span class="s1">countryCallingCode : </span><span class="s2">'1'</span><span class="s1">,</span>
			<span class="s1">phone              : </span><span class="s2">'21337342530'</span><span class="s1">,</span>
			<span class="s1">carrierCode        : undefined,</span>
			<span class="s1">ext                : undefined,</span>
			<span class="s1">valid              : </span><span class="s0">false</span><span class="s1">,</span>
			<span class="s1">possible           : </span><span class="s0">false</span>
		<span class="s1">})</span>

		<span class="s3">// No national number to be parsed.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+996'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({</span>
			<span class="s3">// countryCallingCode : '996'</span>
		<span class="s1">})</span>

		<span class="s3">// Valid number.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+78005553535'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({</span>
			<span class="s1">country            : </span><span class="s2">'RU'</span><span class="s1">,</span>
			<span class="s1">countryCallingCode : </span><span class="s2">'7'</span><span class="s1">,</span>
			<span class="s1">phone              : </span><span class="s2">'8005553535'</span><span class="s1">,</span>
			<span class="s1">carrierCode        : undefined,</span>
			<span class="s1">ext                : undefined,</span>
			<span class="s1">valid              : </span><span class="s0">true</span><span class="s1">,</span>
			<span class="s1">possible           : </span><span class="s0">true</span>
		<span class="s1">})</span>

		<span class="s3">// https://github.com/catamphetamine/libphonenumber-js/issues/211</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+966'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({})</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+9664'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({})</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+96645'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({</span>
			<span class="s1">carrierCode        : undefined,</span>
			<span class="s1">phone              : </span><span class="s2">'45'</span><span class="s1">,</span>
			<span class="s1">ext                : undefined,</span>
			<span class="s1">country            : </span><span class="s2">'SA'</span><span class="s1">,</span>
			<span class="s1">countryCallingCode : </span><span class="s2">'966'</span><span class="s1">,</span>
			<span class="s1">possible           : </span><span class="s0">false</span><span class="s1">,</span>
			<span class="s1">valid              : </span><span class="s0">false</span>
		<span class="s1">})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse non-European digits'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+١٢١٢٢٣٢٣٢٣٢'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'US'</span><span class="s1">, phone: </span><span class="s2">'2122323232' </span><span class="s1">})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work in edge cases'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">let </span><span class="s1">thrower</span>

		<span class="s3">// No input</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">''</span><span class="s1">)).to.deep.equal({})</span>

		<span class="s3">// No country phone code</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+'</span><span class="s1">)).to.deep.equal({})</span>

		<span class="s3">// No country at all (non international number and no explicit country code)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'123'</span><span class="s1">)).to.deep.equal({})</span>

		<span class="s3">// No country metadata for this `require` country code</span>
		<span class="s1">thrower = () =&gt; parseNumber(</span><span class="s2">'123'</span><span class="s1">, </span><span class="s2">'ZZ'</span><span class="s1">)</span>
		<span class="s1">expect(thrower).to.throw(</span><span class="s2">'Unknown country'</span><span class="s1">)</span>

		<span class="s3">// No country metadata for this `default` country code</span>
		<span class="s1">thrower = () =&gt; parseNumber(</span><span class="s2">'123'</span><span class="s1">, { defaultCountry: </span><span class="s2">'ZZ' </span><span class="s1">})</span>
		<span class="s1">expect(thrower).to.throw(</span><span class="s2">'Unknown country'</span><span class="s1">)</span>

		<span class="s3">// Invalid country phone code</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+210'</span><span class="s1">)).to.deep.equal({})</span>

		<span class="s3">// Invalid country phone code (extended parsing mode)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+210'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({})</span>

		<span class="s3">// Too short of a number.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'1'</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({})</span>

		<span class="s3">// Too long of a number.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'1111111111111111111'</span><span class="s1">, </span><span class="s2">'RU'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({})</span>

		<span class="s3">// Not a number.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'abcdefg'</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({})</span>

		<span class="s3">// Country phone code beginning with a '0'</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+0123'</span><span class="s1">)).to.deep.equal({})</span>

		<span class="s3">// Barbados NANPA phone number</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+12460000000'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'BB'</span><span class="s1">, phone: </span><span class="s2">'2460000000' </span><span class="s1">})</span>

		<span class="s3">// // A case when country (restricted to) is not equal</span>
		<span class="s3">// // to the one parsed out of an international number.</span>
		<span class="s3">// parseNumber('+1-213-373-4253', 'RU').should.deep.equal({})</span>

		<span class="s3">// National (significant) number too short</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'2'</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">)).to.deep.equal({})</span>

		<span class="s3">// National (significant) number too long</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'222222222222222222'</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">)).to.deep.equal({})</span>

		<span class="s3">// No `national_prefix_for_parsing`</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'41111'</span><span class="s1">, </span><span class="s2">'AC'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'AC'</span><span class="s1">, phone: </span><span class="s2">'41111'</span><span class="s1">})</span>

		<span class="s3">// https://github.com/catamphetamine/libphonenumber-js/issues/235</span>
		<span class="s3">// `matchesEntirely()` bug fix.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+4915784846111‬'</span><span class="s1">)).to.deep.equal({ country: </span><span class="s2">'DE'</span><span class="s1">, phone: </span><span class="s2">'15784846111' </span><span class="s1">})</span>

		<span class="s3">// No metadata</span>
		<span class="s1">thrower = () =&gt; _parseNumber(</span><span class="s2">''</span><span class="s1">)</span>
		<span class="s1">expect(thrower).to.throw(</span><span class="s2">'`metadata` argument not passed'</span><span class="s1">)</span>

		<span class="s3">// Numerical `value`</span>
		<span class="s1">thrower = () =&gt; parseNumber(</span><span class="s4">2141111111</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">)</span>
		<span class="s1">expect(thrower).to.throw(</span><span class="s2">'A text for parsing must be a string.'</span><span class="s1">)</span>

		<span class="s3">// Input string too long.</span>
		<span class="s1">expect(</span>
            <span class="s1">parseNumber(</span><span class="s2">'8005553535                                                                                                                                                                                                                                                 '</span><span class="s1">, </span><span class="s2">'RU'</span><span class="s1">)</span>
        <span class="s1">).to.deep.equal({})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse phone number extensions'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// &quot;ext&quot;</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'2134567890 ext 123'</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country : </span><span class="s2">'US'</span><span class="s1">,</span>
			<span class="s1">phone   : </span><span class="s2">'2134567890'</span><span class="s1">,</span>
			<span class="s1">ext     : </span><span class="s2">'123'</span>
		<span class="s1">})</span>

		<span class="s3">// &quot;ext.&quot;</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+12134567890 ext. 12345'</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country : </span><span class="s2">'US'</span><span class="s1">,</span>
			<span class="s1">phone   : </span><span class="s2">'2134567890'</span><span class="s1">,</span>
			<span class="s1">ext     : </span><span class="s2">'12345'</span>
		<span class="s1">})</span>

		<span class="s3">// &quot;доб.&quot;</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+78005553535 доб. 1234'</span><span class="s1">, </span><span class="s2">'RU'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country : </span><span class="s2">'RU'</span><span class="s1">,</span>
			<span class="s1">phone   : </span><span class="s2">'8005553535'</span><span class="s1">,</span>
			<span class="s1">ext     : </span><span class="s2">'1234'</span>
		<span class="s1">})</span>

		<span class="s3">// &quot;#&quot;</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+12134567890#1234'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country : </span><span class="s2">'US'</span><span class="s1">,</span>
			<span class="s1">phone   : </span><span class="s2">'2134567890'</span><span class="s1">,</span>
			<span class="s1">ext     : </span><span class="s2">'1234'</span>
		<span class="s1">})</span>

		<span class="s3">// &quot;x&quot;</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+78005553535 x1234'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country : </span><span class="s2">'RU'</span><span class="s1">,</span>
			<span class="s1">phone   : </span><span class="s2">'8005553535'</span><span class="s1">,</span>
			<span class="s1">ext     : </span><span class="s2">'1234'</span>
		<span class="s1">})</span>

		<span class="s3">// Not a valid extension</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'2134567890 ext. abc'</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country : </span><span class="s2">'US'</span><span class="s1">,</span>
			<span class="s1">phone   : </span><span class="s2">'2134567890'</span>
		<span class="s1">})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse RFC 3966 phone numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'tel:+78005553535;ext=123'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country : </span><span class="s2">'RU'</span><span class="s1">,</span>
			<span class="s1">phone   : </span><span class="s2">'8005553535'</span><span class="s1">,</span>
			<span class="s1">ext     : </span><span class="s2">'123'</span>
		<span class="s1">})</span>

		<span class="s3">// Should parse &quot;visual separators&quot;.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'tel:+7(800)555-35.35;ext=123'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country : </span><span class="s2">'RU'</span><span class="s1">,</span>
			<span class="s1">phone   : </span><span class="s2">'8005553535'</span><span class="s1">,</span>
			<span class="s1">ext     : </span><span class="s2">'123'</span>
		<span class="s1">})</span>

		<span class="s3">// Invalid number.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'tel:+7x8005553535;ext=123'</span><span class="s1">)).to.deep.equal({})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse invalid international numbers even if they are invalid'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+7(8)8005553535'</span><span class="s1">, </span><span class="s2">'RU'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country : </span><span class="s2">'RU'</span><span class="s1">,</span>
			<span class="s1">phone   : </span><span class="s2">'8005553535'</span>
		<span class="s1">})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse carrier codes'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'0 15 21 5555-5555'</span><span class="s1">, </span><span class="s2">'BR'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({</span>
			<span class="s1">country            : </span><span class="s2">'BR'</span><span class="s1">,</span>
			<span class="s1">countryCallingCode : </span><span class="s2">'55'</span><span class="s1">,</span>
			<span class="s1">phone              : </span><span class="s2">'2155555555'</span><span class="s1">,</span>
			<span class="s1">carrierCode        : </span><span class="s2">'15'</span><span class="s1">,</span>
			<span class="s1">ext                : undefined,</span>
			<span class="s1">valid              : </span><span class="s0">true</span><span class="s1">,</span>
			<span class="s1">possible           : </span><span class="s0">true</span>
		<span class="s1">})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse IDD prefixes'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'011 61 2 3456 7890'</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">phone   : </span><span class="s2">'234567890'</span><span class="s1">,</span>
			<span class="s1">country : </span><span class="s2">'AU'</span>
		<span class="s1">})</span>

		<span class="s1">expect(parseNumber(</span><span class="s2">'011 61 2 3456 7890'</span><span class="s1">, </span><span class="s2">'FR'</span><span class="s1">)).to.deep.equal({})</span>

		<span class="s1">expect(parseNumber(</span><span class="s2">'00 61 2 3456 7890'</span><span class="s1">, </span><span class="s2">'US'</span><span class="s1">)).to.deep.equal({})</span>

		<span class="s1">expect(parseNumber(</span><span class="s2">'810 61 2 3456 7890'</span><span class="s1">, </span><span class="s2">'RU'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">phone   : </span><span class="s2">'234567890'</span><span class="s1">,</span>
			<span class="s1">country : </span><span class="s2">'AU'</span>
		<span class="s1">})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work with v2 API'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">parseNumber(</span><span class="s2">'+99989160151539'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work with Argentina numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// The same mobile number is written differently</span>
		<span class="s3">// in different formats in Argentina:</span>
		<span class="s3">// `9` gets prepended in international format.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+54 9 3435 55 1212'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'AR'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'93435551212'</span>
		<span class="s1">})</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'0343 15-555-1212'</span><span class="s1">, </span><span class="s2">'AR'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'AR'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'93435551212'</span>
		<span class="s1">})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work with Mexico numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Fixed line.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+52 449 978 0001'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'MX'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'4499780001'</span>
		<span class="s1">})</span>
		<span class="s3">// &quot;Dialling tokens 01, 02, 044, 045 and 1 are removed as they are</span>
		<span class="s3">//  no longer valid since August 2019.&quot;</span>
		<span class="s3">//</span>
		<span class="s3">// parseNumber('01 (449)978-0001', 'MX').should.deep.equal({</span>
		<span class="s3">//  country: 'MX',</span>
		<span class="s3">//  phone: '4499780001'</span>
		<span class="s3">// })</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'(449)978-0001'</span><span class="s1">, </span><span class="s2">'MX'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'MX'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'4499780001'</span>
		<span class="s1">})</span>
		<span class="s3">// &quot;Dialling tokens 01, 02, 044, 045 and 1 are removed as they are</span>
		<span class="s3">//  no longer valid since August 2019.&quot;</span>
		<span class="s3">//</span>
		<span class="s3">// // Mobile.</span>
		<span class="s3">// // `1` is prepended before area code to mobile numbers in international format.</span>
		<span class="s3">// parseNumber('+52 1 33 1234-5678', 'MX').should.deep.equal({</span>
		<span class="s3">//  country: 'MX',</span>
		<span class="s3">//  phone: '3312345678'</span>
		<span class="s3">// })</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+52 33 1234-5678'</span><span class="s1">, </span><span class="s2">'MX'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'MX'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'3312345678'</span>
		<span class="s1">})</span>
		<span class="s3">// &quot;Dialling tokens 01, 02, 044, 045 and 1 are removed as they are</span>
		<span class="s3">//  no longer valid since August 2019.&quot;</span>
		<span class="s3">//</span>
		<span class="s3">// parseNumber('044 (33) 1234-5678', 'MX').should.deep.equal({</span>
		<span class="s3">//  country: 'MX',</span>
		<span class="s3">//  phone: '3312345678'</span>
		<span class="s3">// })</span>
		<span class="s3">// parseNumber('045 33 1234-5678', 'MX').should.deep.equal({</span>
		<span class="s3">//  country: 'MX',</span>
		<span class="s3">//  phone: '3312345678'</span>
		<span class="s3">// })</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse non-geographic numbering plan phone numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+870773111632'</span><span class="s1">)).to.deep.equal(USE_NON_GEOGRAPHIC_COUNTRY_CODE ?</span>
        <span class="s1">{</span>
            <span class="s1">country: </span><span class="s2">'001'</span><span class="s1">,</span>
            <span class="s1">phone: </span><span class="s2">'773111632'</span>
        <span class="s1">} :</span>
        <span class="s1">{})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse non-geographic numbering plan phone numbers (default country code)'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'773111632'</span><span class="s1">, { defaultCallingCode: </span><span class="s2">'870' </span><span class="s1">})).to.deep.equal(USE_NON_GEOGRAPHIC_COUNTRY_CODE ?</span>
        <span class="s1">{</span>
            <span class="s1">country: </span><span class="s2">'001'</span><span class="s1">,</span>
            <span class="s1">phone: </span><span class="s2">'773111632'</span>
        <span class="s1">} :</span>
        <span class="s1">{})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse non-geographic numbering plan phone numbers (extended)'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+870773111632'</span><span class="s1">, { extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({</span>
			<span class="s1">country: USE_NON_GEOGRAPHIC_COUNTRY_CODE ? </span><span class="s2">'001' </span><span class="s1">: undefined,</span>
			<span class="s1">countryCallingCode: </span><span class="s2">'870'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'773111632'</span><span class="s1">,</span>
			<span class="s1">carrierCode: undefined,</span>
			<span class="s1">ext: undefined,</span>
			<span class="s1">possible: </span><span class="s0">true</span><span class="s1">,</span>
			<span class="s1">valid: </span><span class="s0">true</span>
		<span class="s1">})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse non-geographic numbering plan phone numbers (default country code) (extended)'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'773111632'</span><span class="s1">, { defaultCallingCode: </span><span class="s2">'870'</span><span class="s1">, extended: </span><span class="s0">true </span><span class="s1">})).to.deep.equal({</span>
			<span class="s1">country: USE_NON_GEOGRAPHIC_COUNTRY_CODE ? </span><span class="s2">'001' </span><span class="s1">: undefined,</span>
			<span class="s1">countryCallingCode: </span><span class="s2">'870'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'773111632'</span><span class="s1">,</span>
			<span class="s1">carrierCode: undefined,</span>
			<span class="s1">ext: undefined,</span>
			<span class="s1">possible: </span><span class="s0">true</span><span class="s1">,</span>
			<span class="s1">valid: </span><span class="s0">true</span>
		<span class="s1">})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'shouldn</span><span class="s5">\'</span><span class="s2">t crash when invalid `defaultCallingCode` is passed'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(() =&gt; parseNumber(</span><span class="s2">'773111632'</span><span class="s1">, { defaultCallingCode: </span><span class="s2">'999' </span><span class="s1">})).to.throw(</span><span class="s2">'Unknown calling code'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'shouldn</span><span class="s5">\'</span><span class="s2">t set `country` when there</span><span class="s5">\'</span><span class="s2">s no `defaultCountry` and `defaultCallingCode` is not of a &quot;non-geographic entity&quot;'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'88005553535'</span><span class="s1">, { defaultCallingCode: </span><span class="s2">'7' </span><span class="s1">})).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'RU'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'8005553535'</span>
		<span class="s1">})</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should correctly parse numbers starting with the same digit as the national prefix'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// https://github.com/catamphetamine/libphonenumber-js/issues/373</span>
		<span class="s3">// `BY`'s `national_prefix` is `8`.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+37582004910060'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'BY'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'82004910060'</span>
		<span class="s1">});</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should autocorrect numbers without a leading +'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// https://github.com/catamphetamine/libphonenumber-js/issues/376</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'375447521111'</span><span class="s1">, </span><span class="s2">'BY'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'BY'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'447521111'</span>
		<span class="s1">});</span>
		<span class="s3">// https://github.com/catamphetamine/libphonenumber-js/issues/316</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'33612902554'</span><span class="s1">, </span><span class="s2">'FR'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'FR'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'612902554'</span>
		<span class="s1">});</span>
		<span class="s3">// https://github.com/catamphetamine/libphonenumber-js/issues/375</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'61438331999'</span><span class="s1">, </span><span class="s2">'AU'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'AU'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'438331999'</span>
		<span class="s1">});</span>
		<span class="s3">// A case when `49` is a country calling code of a number without a leading `+`.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'4930123456'</span><span class="s1">, </span><span class="s2">'DE'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'DE'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'30123456'</span>
		<span class="s1">});</span>
		<span class="s3">// A case when `49` is a valid area code.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'4951234567890'</span><span class="s1">, </span><span class="s2">'DE'</span><span class="s1">)).to.deep.equal({</span>
			<span class="s1">country: </span><span class="s2">'DE'</span><span class="s1">,</span>
			<span class="s1">phone: </span><span class="s2">'4951234567890'</span>
		<span class="s1">});</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse extensions (long extensions with explicitl abels)'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Test lower and upper limits of extension lengths for each type of label.</span>

		<span class="s3">// Firstly, when in RFC format: PhoneNumberUtil.extLimitAfterExplicitLabel</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'33316005 ext 0'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'0'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'33316005 ext 01234567890123456789'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'01234567890123456789'</span><span class="s1">)</span>
		<span class="s3">// Extension too long.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'33316005 ext 012345678901234567890'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.be.undefined</span>

		<span class="s3">// Explicit extension label.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005ext:1'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'1'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005 xtn:12345678901234567890'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'12345678901234567890'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005 extension</span><span class="s5">\t</span><span class="s2">12345678901234567890'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'12345678901234567890'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005 xtensio:12345678901234567890'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'12345678901234567890'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005 xtensión, 12345678901234567890#'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'12345678901234567890'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005extension.12345678901234567890'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'12345678901234567890'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005 доб:12345678901234567890'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'12345678901234567890'</span><span class="s1">)</span>

		<span class="s3">// Extension too long.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005 extension 123456789012345678901'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.be.undefined</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse extensions (long extensions with auto dialling labels)'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+12679000000,,123456789012345#'</span><span class="s1">).ext).to.equal(</span><span class="s2">'123456789012345'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+12679000000;123456789012345#'</span><span class="s1">).ext).to.equal(</span><span class="s2">'123456789012345'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+442034000000,,123456789#'</span><span class="s1">).ext).to.equal(</span><span class="s2">'123456789'</span><span class="s1">)</span>
		<span class="s3">// Extension too long.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+12679000000,,1234567890123456#'</span><span class="s1">).ext).to.be.undefined</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse extensions (short extensions with ambiguous characters)'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005 x 123456789'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'123456789'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005 x. 123456789'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'123456789'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005 #123456789#'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'123456789'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005 ~ 123456789'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.equal(</span><span class="s2">'123456789'</span><span class="s1">)</span>
		<span class="s3">// Extension too long.</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'03 3316005 ~ 1234567890'</span><span class="s1">, </span><span class="s2">'NZ'</span><span class="s1">).ext).to.be.undefined</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse extensions (short extensions when not sure of label)'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+1123-456-7890 666666#'</span><span class="s1">, { v2: </span><span class="s0">true </span><span class="s1">}).ext).to.equal(</span><span class="s2">'666666'</span><span class="s1">)</span>
		<span class="s1">expect(parseNumber(</span><span class="s2">'+11234567890-6#'</span><span class="s1">, { v2: </span><span class="s0">true </span><span class="s1">}).ext).to.equal(</span><span class="s2">'6'</span><span class="s1">)</span>
		<span class="s3">// Extension too long.</span>
		<span class="s1">expect(() =&gt; parseNumber(</span><span class="s2">'+1123-456-7890 7777777#'</span><span class="s1">, { v2: </span><span class="s0">true </span><span class="s1">})).to.throw(</span><span class="s2">'NOT_A_NUMBER'</span><span class="s1">)</span>
	<span class="s1">})</span>
<span class="s1">})</span></pre>
</body>
</html>