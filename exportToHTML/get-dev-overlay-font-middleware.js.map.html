<html>
<head>
<title>get-dev-overlay-font-middleware.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
get-dev-overlay-font-middleware.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/next-devtools/server/font/get-dev-overlay-font-middleware.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { ServerResponse, IncomingMessage } from 'http'</span><span class="s3">\n</span><span class="s1">import path from 'path'</span><span class="s3">\n</span><span class="s1">import * as fs from 'fs/promises'</span><span class="s3">\n</span><span class="s1">import { constants } from 'fs'</span><span class="s3">\n</span><span class="s1">import * as Log from '../../../build/output/log'</span><span class="s3">\n</span><span class="s1">import { middlewareResponse } from '../middleware-response'</span><span class="s3">\n\n</span><span class="s1">const FONT_PREFIX = '/__nextjs_font/'</span><span class="s3">\n\n</span><span class="s1">const VALID_FONTS = [</span><span class="s3">\n  </span><span class="s1">'geist-latin-ext.woff2',</span><span class="s3">\n  </span><span class="s1">'geist-mono-latin-ext.woff2',</span><span class="s3">\n  </span><span class="s1">'geist-latin.woff2',</span><span class="s3">\n  </span><span class="s1">'geist-mono-latin.woff2',</span><span class="s3">\n</span><span class="s1">]</span><span class="s3">\n\n</span><span class="s1">const FONT_HEADERS = {</span><span class="s3">\n  </span><span class="s1">'Content-Type': 'font/woff2',</span><span class="s3">\n  </span><span class="s1">'Cache-Control': 'public, max-age=31536000, immutable',</span><span class="s3">\n</span><span class="s1">} as const</span><span class="s3">\n\n</span><span class="s1">export function getDevOverlayFontMiddleware() {</span><span class="s3">\n  </span><span class="s1">return async function devOverlayFontMiddleware(</span><span class="s3">\n    </span><span class="s1">req: IncomingMessage,</span><span class="s3">\n    </span><span class="s1">res: ServerResponse,</span><span class="s3">\n    </span><span class="s1">next: () =&gt; void</span><span class="s3">\n  </span><span class="s1">): Promise&lt;void&gt; {</span><span class="s3">\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">const { pathname } = new URL(`http://n${req.url}`)</span><span class="s3">\n\n      </span><span class="s1">if (!pathname.startsWith(FONT_PREFIX)) {</span><span class="s3">\n        </span><span class="s1">return next()</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const fontFile = pathname.replace(FONT_PREFIX, '')</span><span class="s3">\n      </span><span class="s1">if (!VALID_FONTS.includes(fontFile)) {</span><span class="s3">\n        </span><span class="s1">return middlewareResponse.notFound(res)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const fontPath = path.resolve(__dirname, fontFile)</span><span class="s3">\n      </span><span class="s1">const fileExists = await checkFileExists(fontPath)</span><span class="s3">\n\n      </span><span class="s1">if (!fileExists) {</span><span class="s3">\n        </span><span class="s1">return middlewareResponse.notFound(res)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const fontData = await fs.readFile(fontPath)</span><span class="s3">\n      </span><span class="s1">Object.entries(FONT_HEADERS).forEach(([key, value]) =&gt; {</span><span class="s3">\n        </span><span class="s1">res.setHeader(key, value)</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">res.end(fontData)</span><span class="s3">\n    </span><span class="s1">} catch (err) {</span><span class="s3">\n      </span><span class="s1">Log.error(</span><span class="s3">\n        </span><span class="s1">'Failed to serve font:',</span><span class="s3">\n        </span><span class="s1">err instanceof Error ? err.message : err</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">return middlewareResponse.internalServerError(res)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">async function checkFileExists(filePath: string): Promise&lt;boolean&gt; {</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">await fs.access(filePath, constants.F_OK)</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">} catch {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getDevOverlayFontMiddleware&quot;</span><span class="s0">,</span><span class="s1">&quot;FONT_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;VALID_FONTS&quot;</span><span class="s0">,</span><span class="s1">&quot;FONT_HEADERS&quot;</span><span class="s0">,</span><span class="s1">&quot;devOverlayFontMiddleware&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;next&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;fontFile&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;middlewareResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;notFound&quot;</span><span class="s0">,</span><span class="s1">&quot;fontPath&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;__dirname&quot;</span><span class="s0">,</span><span class="s1">&quot;fileExists&quot;</span><span class="s0">,</span><span class="s1">&quot;checkFileExists&quot;</span><span class="s0">,</span><span class="s1">&quot;fontData&quot;</span><span class="s0">,</span><span class="s1">&quot;fs&quot;</span><span class="s0">,</span><span class="s1">&quot;readFile&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;setHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;Log&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;internalServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;filePath&quot;</span><span class="s0">,</span><span class="s1">&quot;access&quot;</span><span class="s0">,</span><span class="s1">&quot;constants&quot;</span><span class="s0">,</span><span class="s1">&quot;F_OK&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BAqBgBA;;;eAAAA;;;;;+DApBC;oEACG;oBACM;+DACL;oCACc;AAEnC,MAAMC,cAAc;AAEpB,MAAMC,cAAc;IAClB;IACA;IACA;IACA;CACD;AAED,MAAMC,eAAe;IACnB,gBAAgB;IAChB,iBAAiB;AACnB;AAEO,SAASH;IACd,OAAO,eAAeI,yBACpBC,GAAoB,EACpBC,GAAmB,EACnBC,IAAgB;QAEhB,IAAI;YACF,MAAM,EAAEC,QAAQ,EAAE,GAAG,IAAIC,IAAI,AAAC,aAAUJ,IAAIK,GAAG;YAE/C,IAAI,CAACF,SAASG,UAAU,CAACV,cAAc;gBACrC,OAAOM;YACT;YAEA,MAAMK,WAAWJ,SAASK,OAAO,CAACZ,aAAa;YAC/C,IAAI,CAACC,YAAYY,QAAQ,CAACF,WAAW;gBACnC,OAAOG,sCAAkB,CAACC,QAAQ,CAACV;YACrC;YAEA,MAAMW,WAAWC,aAAI,CAACC,OAAO,CAACC,WAAWR;YACzC,MAAMS,aAAa,MAAMC,gBAAgBL;YAEzC,IAAI,CAACI,YAAY;gBACf,OAAON,sCAAkB,CAACC,QAAQ,CAACV;YACrC;YAEA,MAAMiB,WAAW,MAAMC,UAAGC,QAAQ,CAACR;YACnCS,OAAOC,OAAO,CAACxB,cAAcyB,OAAO,CAAC;oBAAC,CAACC,KAAKC,MAAM;gBAChDxB,IAAIyB,SAAS,CAACF,KAAKC;YACrB;YACAxB,IAAI0B,GAAG,CAACT;QACV,EAAE,OAAOU,KAAK;YACZC,KAAIC,KAAK,CACP,yBACAF,eAAeG,QAAQH,IAAII,OAAO,GAAGJ;YAEvC,OAAOlB,sCAAkB,CAACuB,mBAAmB,CAAChC;QAChD;IACF;AACF;AAEA,eAAegB,gBAAgBiB,QAAgB;IAC7C,IAAI;QACF,MAAMf,UAAGgB,MAAM,CAACD,UAAUE,aAAS,CAACC,IAAI;QACxC,OAAO;IACT,EAAE,UAAM;QACN,OAAO;IACT;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>