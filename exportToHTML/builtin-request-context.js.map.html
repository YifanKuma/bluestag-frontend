<html>
<head>
<title>builtin-request-context.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
builtin-request-context.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../src/server/after/builtin-request-context.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { createAsyncLocalStorage } from '../app-render/async-local-storage'</span><span class="s3">\n\n</span><span class="s1">export function getBuiltinRequestContext():</span><span class="s3">\n  </span><span class="s1">| BuiltinRequestContextValue</span><span class="s3">\n  </span><span class="s1">| undefined {</span><span class="s3">\n  </span><span class="s1">const _globalThis = globalThis as GlobalThisWithRequestContext</span><span class="s3">\n  </span><span class="s1">const ctx = _globalThis[NEXT_REQUEST_CONTEXT_SYMBOL]</span><span class="s3">\n  </span><span class="s1">return ctx?.get()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const NEXT_REQUEST_CONTEXT_SYMBOL = Symbol.for('@next/request-context')</span><span class="s3">\n\n</span><span class="s1">type GlobalThisWithRequestContext = typeof globalThis &amp; {</span><span class="s3">\n  </span><span class="s1">[NEXT_REQUEST_CONTEXT_SYMBOL]?: BuiltinRequestContext</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/** A request context provided by the platform. */</span><span class="s3">\n</span><span class="s1">export type BuiltinRequestContext = {</span><span class="s3">\n  </span><span class="s1">get(): BuiltinRequestContextValue | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type RunnableBuiltinRequestContext = BuiltinRequestContext &amp; {</span><span class="s3">\n  </span><span class="s1">run&lt;T&gt;(value: BuiltinRequestContextValue, callback: () =&gt; T): T</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type BuiltinRequestContextValue = {</span><span class="s3">\n  </span><span class="s1">waitUntil?: WaitUntil</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">export type WaitUntil = (promise: Promise&lt;any&gt;) =&gt; void</span><span class="s3">\n\n</span><span class="s1">/** </span><span class="s3">\&quot;</span><span class="s1">@next/request-context</span><span class="s3">\&quot; </span><span class="s1">has a different signature from AsyncLocalStorage,</span><span class="s3">\n </span><span class="s1">* matching [AsyncContext.Variable](https://github.com/tc39/proposal-async-context).</span><span class="s3">\n </span><span class="s1">* We don't need a full AsyncContext adapter here, just having `.get()` is enough</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function createLocalRequestContext(): RunnableBuiltinRequestContext {</span><span class="s3">\n  </span><span class="s1">const storage = createAsyncLocalStorage&lt;BuiltinRequestContextValue&gt;()</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">get: () =&gt; storage.getStore(),</span><span class="s3">\n    </span><span class="s1">run: (value, callback) =&gt; storage.run(value, callback),</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;createLocalRequestContext&quot;</span><span class="s0">,</span><span class="s1">&quot;getBuiltinRequestContext&quot;</span><span class="s0">,</span><span class="s1">&quot;_globalThis&quot;</span><span class="s0">,</span><span class="s1">&quot;globalThis&quot;</span><span class="s0">,</span><span class="s1">&quot;ctx&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_REQUEST_CONTEXT_SYMBOL&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;for&quot;</span><span class="s0">,</span><span class="s1">&quot;storage&quot;</span><span class="s0">,</span><span class="s1">&quot;createAsyncLocalStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;run&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;callback&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;IAkCgBA,yBAAyB;eAAzBA;;IAhCAC,wBAAwB;eAAxBA;;;mCAFwB;AAEjC,SAASA;IAGd,MAAMC,cAAcC;IACpB,MAAMC,MAAMF,WAAW,CAACG,4BAA4B;IACpD,OAAOD,uBAAAA,IAAKE,GAAG;AACjB;AAEA,MAAMD,8BAA8BE,OAAOC,GAAG,CAAC;AAwBxC,SAASR;IACd,MAAMS,UAAUC,IAAAA,0CAAuB;IACvC,OAAO;QACLJ,KAAK,IAAMG,QAAQE,QAAQ;QAC3BC,KAAK,CAACC,OAAOC,WAAaL,QAAQG,GAAG,CAACC,OAAOC;IAC/C;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>