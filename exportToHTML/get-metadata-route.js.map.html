<html>
<head>
<title>get-metadata-route.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
get-metadata-route.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../src/lib/metadata/get-metadata-route.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { isMetadataPage } from './is-metadata-route'</span><span class="s3">\n</span><span class="s1">import path from '../../shared/lib/isomorphic/path'</span><span class="s3">\n</span><span class="s1">import { interpolateDynamicPath } from '../../server/server-utils'</span><span class="s3">\n</span><span class="s1">import { getNamedRouteRegex } from '../../shared/lib/router/utils/route-regex'</span><span class="s3">\n</span><span class="s1">import { djb2Hash } from '../../shared/lib/hash'</span><span class="s3">\n</span><span class="s1">import { normalizeAppPath } from '../../shared/lib/router/utils/app-paths'</span><span class="s3">\n</span><span class="s1">import { normalizePathSep } from '../../shared/lib/page-path/normalize-path-sep'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">isGroupSegment,</span><span class="s3">\n  </span><span class="s1">isParallelRouteSegment,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/segment'</span><span class="s3">\n\n</span><span class="s1">/*</span><span class="s3">\n </span><span class="s1">* If there's special convention like (...) or @ in the page path,</span><span class="s3">\n </span><span class="s1">* Give it a unique hash suffix to avoid conflicts</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* e.g.</span><span class="s3">\n </span><span class="s1">* /opengraph-image -&gt; /opengraph-image</span><span class="s3">\n </span><span class="s1">* /(post)/opengraph-image.tsx -&gt; /opengraph-image-[0-9a-z]{6}</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Sitemap is an exception, it should not have a suffix.</span><span class="s3">\n </span><span class="s1">* Each sitemap contains all the urls of sub routes, we don't have the case of duplicates `/(group)/sitemap.[ext]` and `/sitemap.[ext]` since they should be the same.</span><span class="s3">\n </span><span class="s1">* Hence we always normalize the urls for sitemap and do not append hash suffix, and ensure user-land only contains one sitemap per pathname.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* /sitemap -&gt; /sitemap</span><span class="s3">\n </span><span class="s1">* /(post)/sitemap -&gt; /sitemap</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function getMetadataRouteSuffix(page: string) {</span><span class="s3">\n  </span><span class="s1">// Remove the last segment and get the parent pathname</span><span class="s3">\n  </span><span class="s1">// e.g. /parent/a/b/c -&gt; /parent/a/b</span><span class="s3">\n  </span><span class="s1">// e.g. /parent/opengraph-image -&gt; /parent</span><span class="s3">\n  </span><span class="s1">const parentPathname = path.dirname(page)</span><span class="s3">\n  </span><span class="s1">// Only apply suffix to metadata routes except for sitemaps</span><span class="s3">\n  </span><span class="s1">if (page.endsWith('/sitemap')) {</span><span class="s3">\n    </span><span class="s1">return ''</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Calculate the hash suffix based on the parent path</span><span class="s3">\n  </span><span class="s1">let suffix = ''</span><span class="s3">\n  </span><span class="s1">// Check if there's any special characters in the parent pathname.</span><span class="s3">\n  </span><span class="s1">const segments = parentPathname.split('/')</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">segments.some((seg) =&gt; isGroupSegment(seg) || isParallelRouteSegment(seg))</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">// Hash the parent path to get a unique suffix</span><span class="s3">\n    </span><span class="s1">suffix = djb2Hash(parentPathname).toString(36).slice(0, 6)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return suffix</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Fill the dynamic segment in the metadata route</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Example:</span><span class="s3">\n </span><span class="s1">* fillMetadataSegment('/a/[slug]', { params: { slug: 'b' } }, 'open-graph') -&gt; '/a/b/open-graph'</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function fillMetadataSegment(</span><span class="s3">\n  </span><span class="s1">segment: string,</span><span class="s3">\n  </span><span class="s1">params: any,</span><span class="s3">\n  </span><span class="s1">lastSegment: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const pathname = normalizeAppPath(segment)</span><span class="s3">\n  </span><span class="s1">const routeRegex = getNamedRouteRegex(pathname, {</span><span class="s3">\n    </span><span class="s1">prefixRouteKeys: false,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">const route = interpolateDynamicPath(pathname, params, routeRegex)</span><span class="s3">\n  </span><span class="s1">const { name, ext } = path.parse(lastSegment)</span><span class="s3">\n  </span><span class="s1">const pagePath = path.posix.join(segment, name)</span><span class="s3">\n  </span><span class="s1">const suffix = getMetadataRouteSuffix(pagePath)</span><span class="s3">\n  </span><span class="s1">const routeSuffix = suffix ? `-${suffix}` : ''</span><span class="s3">\n\n  </span><span class="s1">return normalizePathSep(path.join(route, `${name}${routeSuffix}${ext}`))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Map metadata page key to the corresponding route</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* static file page key:    /app/robots.txt -&gt; /robots.xml -&gt; /robots.txt/route</span><span class="s3">\n </span><span class="s1">* dynamic route page key:  /app/robots.tsx -&gt; /robots -&gt; /robots.txt/route</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param page</span><span class="s3">\n </span><span class="s1">* @returns</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeMetadataRoute(page: string) {</span><span class="s3">\n  </span><span class="s1">if (!isMetadataPage(page)) {</span><span class="s3">\n    </span><span class="s1">return page</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">let route = page</span><span class="s3">\n  </span><span class="s1">let suffix = ''</span><span class="s3">\n  </span><span class="s1">if (page === '/robots') {</span><span class="s3">\n    </span><span class="s1">route += '.txt'</span><span class="s3">\n  </span><span class="s1">} else if (page === '/manifest') {</span><span class="s3">\n    </span><span class="s1">route += '.webmanifest'</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">suffix = getMetadataRouteSuffix(page)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">// Support both /&lt;metadata-route.ext&gt; and custom routes /&lt;metadata-route&gt;/route.ts.</span><span class="s3">\n  </span><span class="s1">// If it's a metadata file route, we need to append /[id]/route to the page.</span><span class="s3">\n  </span><span class="s1">if (!route.endsWith('/route')) {</span><span class="s3">\n    </span><span class="s1">const { dir, name: baseName, ext } = path.parse(route)</span><span class="s3">\n    </span><span class="s1">route = path.posix.join(</span><span class="s3">\n      </span><span class="s1">dir,</span><span class="s3">\n      </span><span class="s1">`${baseName}${suffix ? `-${suffix}` : ''}${ext}`,</span><span class="s3">\n      </span><span class="s1">'route'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return route</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Normalize metadata route page to either a single route or a dynamic route.</span><span class="s3">\n</span><span class="s1">// e.g. Input: /sitemap/route</span><span class="s3">\n</span><span class="s1">// when isDynamic is false, single route -&gt; /sitemap.xml/route</span><span class="s3">\n</span><span class="s1">// when isDynamic is false, dynamic route -&gt; /sitemap/[__metadata_id__]/route</span><span class="s3">\n</span><span class="s1">// also works for pathname such as /sitemap -&gt; /sitemap.xml, but will not append /route suffix</span><span class="s3">\n</span><span class="s1">export function normalizeMetadataPageToRoute(page: string, isDynamic: boolean) {</span><span class="s3">\n  </span><span class="s1">const isRoute = page.endsWith('/route')</span><span class="s3">\n  </span><span class="s1">const routePagePath = isRoute ? page.slice(0, -'/route'.length) : page</span><span class="s3">\n  </span><span class="s1">const metadataRouteExtension = routePagePath.endsWith('/sitemap')</span><span class="s3">\n    </span><span class="s1">? '.xml'</span><span class="s3">\n    </span><span class="s1">: ''</span><span class="s3">\n  </span><span class="s1">const mapped = isDynamic</span><span class="s3">\n    </span><span class="s1">? `${routePagePath}/[__metadata_id__]`</span><span class="s3">\n    </span><span class="s1">: `${routePagePath}${metadataRouteExtension}`</span><span class="s3">\n\n  </span><span class="s1">return mapped + (isRoute ? '/route' : '')</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;fillMetadataSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeMetadataPageToRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeMetadataRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;getMetadataRouteSuffix&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;parentPathname&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;dirname&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;suffix&quot;</span><span class="s0">,</span><span class="s1">&quot;segments&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;some&quot;</span><span class="s0">,</span><span class="s1">&quot;seg&quot;</span><span class="s0">,</span><span class="s1">&quot;isGroupSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;isParallelRouteSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;djb2Hash&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;lastSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;routeRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;getNamedRouteRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;prefixRouteKeys&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;interpolateDynamicPath&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;ext&quot;</span><span class="s0">,</span><span class="s1">&quot;parse&quot;</span><span class="s0">,</span><span class="s1">&quot;pagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;posix&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;routeSuffix&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizePathSep&quot;</span><span class="s0">,</span><span class="s1">&quot;isMetadataPage&quot;</span><span class="s0">,</span><span class="s1">&quot;dir&quot;</span><span class="s0">,</span><span class="s1">&quot;baseName&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;isRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;routePagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;metadataRouteExtension&quot;</span><span class="s0">,</span><span class="s1">&quot;mapped&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;;IAyDgBA,mBAAmB;eAAnBA;;IA2DAC,4BAA4B;eAA5BA;;IAhCAC,sBAAsB;eAAtBA;;;iCApFe;6DACd;6BACsB;4BACJ;sBACV;0BACQ;kCACA;yBAI1B;;;;;;AAEP;;;;;;;;;;;;;;CAcC,GACD,SAASC,uBAAuBC,IAAY;IAC1C,sDAAsD;IACtD,oCAAoC;IACpC,0CAA0C;IAC1C,MAAMC,iBAAiBC,aAAI,CAACC,OAAO,CAACH;IACpC,2DAA2D;IAC3D,IAAIA,KAAKI,QAAQ,CAAC,aAAa;QAC7B,OAAO;IACT;IAEA,qDAAqD;IACrD,IAAIC,SAAS;IACb,kEAAkE;IAClE,MAAMC,WAAWL,eAAeM,KAAK,CAAC;IACtC,IACED,SAASE,IAAI,CAAC,CAACC,MAAQC,IAAAA,uBAAc,EAACD,QAAQE,IAAAA,+BAAsB,EAACF,OACrE;QACA,8CAA8C;QAC9CJ,SAASO,IAAAA,cAAQ,EAACX,gBAAgBY,QAAQ,CAAC,IAAIC,KAAK,CAAC,GAAG;IAC1D;IACA,OAAOT;AACT;AASO,SAAST,oBACdmB,OAAe,EACfC,MAAW,EACXC,WAAmB;IAEnB,MAAMC,WAAWC,IAAAA,0BAAgB,EAACJ;IAClC,MAAMK,aAAaC,IAAAA,8BAAkB,EAACH,UAAU;QAC9CI,iBAAiB;IACnB;IACA,MAAMC,QAAQC,IAAAA,mCAAsB,EAACN,UAAUF,QAAQI;IACvD,MAAM,EAAEK,IAAI,EAAEC,GAAG,EAAE,GAAGxB,aAAI,CAACyB,KAAK,CAACV;IACjC,MAAMW,WAAW1B,aAAI,CAAC2B,KAAK,CAACC,IAAI,CAACf,SAASU;IAC1C,MAAMpB,SAASN,uBAAuB6B;IACtC,MAAMG,cAAc1B,SAAS,CAAC,CAAC,EAAEA,QAAQ,GAAG;IAE5C,OAAO2B,IAAAA,kCAAgB,EAAC9B,aAAI,CAAC4B,IAAI,CAACP,OAAO,GAAGE,OAAOM,cAAcL,KAAK;AACxE;AAWO,SAAS5B,uBAAuBE,IAAY;IACjD,IAAI,CAACiC,IAAAA,+BAAc,EAACjC,OAAO;QACzB,OAAOA;IACT;IACA,IAAIuB,QAAQvB;IACZ,IAAIK,SAAS;IACb,IAAIL,SAAS,WAAW;QACtBuB,SAAS;IACX,OAAO,IAAIvB,SAAS,aAAa;QAC/BuB,SAAS;IACX,OAAO;QACLlB,SAASN,uBAAuBC;IAClC;IACA,mFAAmF;IACnF,4EAA4E;IAC5E,IAAI,CAACuB,MAAMnB,QAAQ,CAAC,WAAW;QAC7B,MAAM,EAAE8B,GAAG,EAAET,MAAMU,QAAQ,EAAET,GAAG,EAAE,GAAGxB,aAAI,CAACyB,KAAK,CAACJ;QAChDA,QAAQrB,aAAI,CAAC2B,KAAK,CAACC,IAAI,CACrBI,KACA,GAAGC,WAAW9B,SAAS,CAAC,CAAC,EAAEA,QAAQ,GAAG,KAAKqB,KAAK,EAChD;IAEJ;IAEA,OAAOH;AACT;AAOO,SAAS1B,6BAA6BG,IAAY,EAAEoC,SAAkB;IAC3E,MAAMC,UAAUrC,KAAKI,QAAQ,CAAC;IAC9B,MAAMkC,gBAAgBD,UAAUrC,KAAKc,KAAK,CAAC,GAAG,CAAC,SAASyB,MAAM,IAAIvC;IAClE,MAAMwC,yBAAyBF,cAAclC,QAAQ,CAAC,cAClD,SACA;IACJ,MAAMqC,SAASL,YACX,GAAGE,cAAc,kBAAkB,CAAC,GACpC,GAAGA,gBAAgBE,wBAAwB;IAE/C,OAAOC,SAAUJ,CAAAA,UAAU,WAAW,EAAC;AACzC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>