<html>
<head>
<title>delta-remove.mjs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #8c8c8c; font-style: italic;}
.s4 { color: #1750eb;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
delta-remove.mjs</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">{ percent, mixNumber } from </span><span class="s2">'motion-dom'</span><span class="s1">;</span>
<span class="s0">import </span><span class="s1">{ scalePoint } from </span><span class="s2">'./delta-apply.mjs'</span><span class="s1">;</span>

<span class="s3">/**</span>
 <span class="s3">* Remove a delta from a point. This is essentially the steps of applyPointDelta in reverse</span>
 <span class="s3">*/</span>
<span class="s0">function </span><span class="s1">removePointDelta(point, translate, scale, originPoint, boxScale) {</span>
    <span class="s1">point -= translate;</span>
    <span class="s1">point = scalePoint(point, </span><span class="s4">1 </span><span class="s1">/ scale, originPoint);</span>
    <span class="s0">if </span><span class="s1">(boxScale !== undefined) {</span>
        <span class="s1">point = scalePoint(point, </span><span class="s4">1 </span><span class="s1">/ boxScale, originPoint);</span>
    <span class="s1">}</span>
    <span class="s0">return </span><span class="s1">point;</span>
<span class="s1">}</span>
<span class="s3">/**</span>
 <span class="s3">* Remove a delta from an axis. This is essentially the steps of applyAxisDelta in reverse</span>
 <span class="s3">*/</span>
<span class="s0">function </span><span class="s1">removeAxisDelta(axis, translate = </span><span class="s4">0</span><span class="s1">, scale = </span><span class="s4">1</span><span class="s1">, origin = </span><span class="s4">0.5</span><span class="s1">, boxScale, originAxis = axis, sourceAxis = axis) {</span>
    <span class="s0">if </span><span class="s1">(percent.test(translate)) {</span>
        <span class="s1">translate = parseFloat(translate);</span>
        <span class="s0">const </span><span class="s1">relativeProgress = mixNumber(sourceAxis.min, sourceAxis.max, translate / </span><span class="s4">100</span><span class="s1">);</span>
        <span class="s1">translate = relativeProgress - sourceAxis.min;</span>
    <span class="s1">}</span>
    <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">translate !== </span><span class="s2">&quot;number&quot;</span><span class="s1">)</span>
        <span class="s0">return</span><span class="s1">;</span>
    <span class="s0">let </span><span class="s1">originPoint = mixNumber(originAxis.min, originAxis.max, origin);</span>
    <span class="s0">if </span><span class="s1">(axis === originAxis)</span>
        <span class="s1">originPoint -= translate;</span>
    <span class="s1">axis.min = removePointDelta(axis.min, translate, scale, originPoint, boxScale);</span>
    <span class="s1">axis.max = removePointDelta(axis.max, translate, scale, originPoint, boxScale);</span>
<span class="s1">}</span>
<span class="s3">/**</span>
 <span class="s3">* Remove a transforms from an axis. This is essentially the steps of applyAxisTransforms in reverse</span>
 <span class="s3">* and acts as a bridge between motion values and removeAxisDelta</span>
 <span class="s3">*/</span>
<span class="s0">function </span><span class="s1">removeAxisTransforms(axis, transforms, [key, scaleKey, originKey], origin, sourceAxis) {</span>
    <span class="s1">removeAxisDelta(axis, transforms[key], transforms[scaleKey], transforms[originKey], transforms.scale, origin, sourceAxis);</span>
<span class="s1">}</span>
<span class="s3">/**</span>
 <span class="s3">* The names of the motion values we want to apply as translation, scale and origin.</span>
 <span class="s3">*/</span>
<span class="s0">const </span><span class="s1">xKeys = [</span><span class="s2">&quot;x&quot;</span><span class="s1">, </span><span class="s2">&quot;scaleX&quot;</span><span class="s1">, </span><span class="s2">&quot;originX&quot;</span><span class="s1">];</span>
<span class="s0">const </span><span class="s1">yKeys = [</span><span class="s2">&quot;y&quot;</span><span class="s1">, </span><span class="s2">&quot;scaleY&quot;</span><span class="s1">, </span><span class="s2">&quot;originY&quot;</span><span class="s1">];</span>
<span class="s3">/**</span>
 <span class="s3">* Remove a transforms from an box. This is essentially the steps of applyAxisBox in reverse</span>
 <span class="s3">* and acts as a bridge between motion values and removeAxisDelta</span>
 <span class="s3">*/</span>
<span class="s0">function </span><span class="s1">removeBoxTransforms(box, transforms, originBox, sourceBox) {</span>
    <span class="s1">removeAxisTransforms(box.x, transforms, xKeys, originBox ? originBox.x : undefined, sourceBox ? sourceBox.x : undefined);</span>
    <span class="s1">removeAxisTransforms(box.y, transforms, yKeys, originBox ? originBox.y : undefined, sourceBox ? sourceBox.y : undefined);</span>
<span class="s1">}</span>

<span class="s0">export </span><span class="s1">{ removeAxisDelta, removeAxisTransforms, removeBoxTransforms, removePointDelta };</span>
</pre>
</body>
</html>