<html>
<head>
<title>response.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #1750eb;}
.s4 { color: #8c8c8c; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
response.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, {</span>
    <span class="s1">value: </span><span class="s2">true</span>
<span class="s1">});</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;NextResponse&quot;</span><span class="s1">, {</span>
    <span class="s1">enumerable: </span><span class="s2">true</span><span class="s1">,</span>
    <span class="s1">get: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">NextResponse;</span>
    <span class="s1">}</span>
<span class="s1">});</span>
<span class="s2">const </span><span class="s1">_cookies = require(</span><span class="s0">&quot;../../web/spec-extension/cookies&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">_nexturl = require(</span><span class="s0">&quot;../next-url&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">_utils = require(</span><span class="s0">&quot;../utils&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">_reflect = require(</span><span class="s0">&quot;./adapters/reflect&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">_cookies1 = require(</span><span class="s0">&quot;./cookies&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">INTERNALS = Symbol(</span><span class="s0">'internal response'</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">REDIRECTS = </span><span class="s2">new </span><span class="s1">Set([</span>
    <span class="s3">301</span><span class="s1">,</span>
    <span class="s3">302</span><span class="s1">,</span>
    <span class="s3">303</span><span class="s1">,</span>
    <span class="s3">307</span><span class="s1">,</span>
    <span class="s3">308</span>
<span class="s1">]);</span>
<span class="s2">function </span><span class="s1">handleMiddlewareField(init, headers) {</span>
    <span class="s2">var </span><span class="s1">_init_request;</span>
    <span class="s2">if </span><span class="s1">(init == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: (_init_request = init.request) == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: _init_request.headers) {</span>
        <span class="s2">if </span><span class="s1">(!(init.request.headers </span><span class="s2">instanceof </span><span class="s1">Headers)) {</span>
            <span class="s2">throw </span><span class="s1">Object.defineProperty(</span><span class="s2">new </span><span class="s1">Error(</span><span class="s0">'request.headers must be an instance of Headers'</span><span class="s1">), </span><span class="s0">&quot;__NEXT_ERROR_CODE&quot;</span><span class="s1">, {</span>
                <span class="s1">value: </span><span class="s0">&quot;E119&quot;</span><span class="s1">,</span>
                <span class="s1">enumerable: </span><span class="s2">false</span><span class="s1">,</span>
                <span class="s1">configurable: </span><span class="s2">true</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s2">const </span><span class="s1">keys = [];</span>
        <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">[key, value] of init.request.headers){</span>
            <span class="s1">headers.set(</span><span class="s0">'x-middleware-request-' </span><span class="s1">+ key, value);</span>
            <span class="s1">keys.push(key);</span>
        <span class="s1">}</span>
        <span class="s1">headers.set(</span><span class="s0">'x-middleware-override-headers'</span><span class="s1">, keys.join(</span><span class="s0">','</span><span class="s1">));</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s2">class </span><span class="s1">NextResponse </span><span class="s2">extends </span><span class="s1">Response {</span>
    <span class="s1">constructor(body, init = {}){</span>
        <span class="s2">super</span><span class="s1">(body, init);</span>
        <span class="s2">const </span><span class="s1">headers = </span><span class="s2">this</span><span class="s1">.headers;</span>
        <span class="s2">const </span><span class="s1">cookies = </span><span class="s2">new </span><span class="s1">_cookies1.ResponseCookies(headers);</span>
        <span class="s2">const </span><span class="s1">cookiesProxy = </span><span class="s2">new </span><span class="s1">Proxy(cookies, {</span>
            <span class="s1">get (target, prop, receiver) {</span>
                <span class="s2">switch</span><span class="s1">(prop){</span>
                    <span class="s2">case </span><span class="s0">'delete'</span><span class="s1">:</span>
                    <span class="s2">case </span><span class="s0">'set'</span><span class="s1">:</span>
                        <span class="s1">{</span>
                            <span class="s2">return </span><span class="s1">(...args)=&gt;{</span>
                                <span class="s2">const </span><span class="s1">result = Reflect.apply(target[prop], target, args);</span>
                                <span class="s2">const </span><span class="s1">newHeaders = </span><span class="s2">new </span><span class="s1">Headers(headers);</span>
                                <span class="s2">if </span><span class="s1">(result </span><span class="s2">instanceof </span><span class="s1">_cookies1.ResponseCookies) {</span>
                                    <span class="s1">headers.set(</span><span class="s0">'x-middleware-set-cookie'</span><span class="s1">, result.getAll().map((cookie)=&gt;(</span><span class="s3">0</span><span class="s1">, _cookies.stringifyCookie)(cookie)).join(</span><span class="s0">','</span><span class="s1">));</span>
                                <span class="s1">}</span>
                                <span class="s1">handleMiddlewareField(init, newHeaders);</span>
                                <span class="s2">return </span><span class="s1">result;</span>
                            <span class="s1">};</span>
                        <span class="s1">}</span>
                    <span class="s2">default</span><span class="s1">:</span>
                        <span class="s2">return </span><span class="s1">_reflect.ReflectAdapter.get(target, prop, receiver);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">});</span>
        <span class="s2">this</span><span class="s1">[INTERNALS] = {</span>
            <span class="s1">cookies: cookiesProxy,</span>
            <span class="s1">url: init.url ? </span><span class="s2">new </span><span class="s1">_nexturl.NextURL(init.url, {</span>
                <span class="s1">headers: (</span><span class="s3">0</span><span class="s1">, _utils.toNodeOutgoingHttpHeaders)(headers),</span>
                <span class="s1">nextConfig: init.nextConfig</span>
            <span class="s1">}) : undefined</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
    <span class="s1">[Symbol.for(</span><span class="s0">'edge-runtime.inspect.custom'</span><span class="s1">)]() {</span>
        <span class="s2">return </span><span class="s1">{</span>
            <span class="s1">cookies: </span><span class="s2">this</span><span class="s1">.cookies,</span>
            <span class="s1">url: </span><span class="s2">this</span><span class="s1">.url,</span>
            <span class="s4">// rest of props come from Response</span>
            <span class="s1">body: </span><span class="s2">this</span><span class="s1">.body,</span>
            <span class="s1">bodyUsed: </span><span class="s2">this</span><span class="s1">.bodyUsed,</span>
            <span class="s1">headers: Object.fromEntries(</span><span class="s2">this</span><span class="s1">.headers),</span>
            <span class="s1">ok: </span><span class="s2">this</span><span class="s1">.ok,</span>
            <span class="s1">redirected: </span><span class="s2">this</span><span class="s1">.redirected,</span>
            <span class="s1">status: </span><span class="s2">this</span><span class="s1">.status,</span>
            <span class="s1">statusText: </span><span class="s2">this</span><span class="s1">.statusText,</span>
            <span class="s1">type: </span><span class="s2">this</span><span class="s1">.type</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
    <span class="s1">get cookies() {</span>
        <span class="s2">return this</span><span class="s1">[INTERNALS].cookies;</span>
    <span class="s1">}</span>
    <span class="s2">static </span><span class="s1">json(body, init) {</span>
        <span class="s2">const </span><span class="s1">response = Response.json(body, init);</span>
        <span class="s2">return new </span><span class="s1">NextResponse(response.body, response);</span>
    <span class="s1">}</span>
    <span class="s2">static </span><span class="s1">redirect(url, init) {</span>
        <span class="s2">const </span><span class="s1">status = </span><span class="s2">typeof </span><span class="s1">init === </span><span class="s0">'number' </span><span class="s1">? init : (init == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: init.status) ?? </span><span class="s3">307</span><span class="s1">;</span>
        <span class="s2">if </span><span class="s1">(!REDIRECTS.has(status)) {</span>
            <span class="s2">throw </span><span class="s1">Object.defineProperty(</span><span class="s2">new </span><span class="s1">RangeError(</span><span class="s0">'Failed to execute &quot;redirect&quot; on &quot;response&quot;: Invalid status code'</span><span class="s1">), </span><span class="s0">&quot;__NEXT_ERROR_CODE&quot;</span><span class="s1">, {</span>
                <span class="s1">value: </span><span class="s0">&quot;E529&quot;</span><span class="s1">,</span>
                <span class="s1">enumerable: </span><span class="s2">false</span><span class="s1">,</span>
                <span class="s1">configurable: </span><span class="s2">true</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s2">const </span><span class="s1">initObj = </span><span class="s2">typeof </span><span class="s1">init === </span><span class="s0">'object' </span><span class="s1">? init : {};</span>
        <span class="s2">const </span><span class="s1">headers = </span><span class="s2">new </span><span class="s1">Headers(initObj == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: initObj.headers);</span>
        <span class="s1">headers.set(</span><span class="s0">'Location'</span><span class="s1">, (</span><span class="s3">0</span><span class="s1">, _utils.validateURL)(url));</span>
        <span class="s2">return new </span><span class="s1">NextResponse(</span><span class="s2">null</span><span class="s1">, {</span>
            <span class="s1">...initObj,</span>
            <span class="s1">headers,</span>
            <span class="s1">status</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s2">static </span><span class="s1">rewrite(destination, init) {</span>
        <span class="s2">const </span><span class="s1">headers = </span><span class="s2">new </span><span class="s1">Headers(init == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: init.headers);</span>
        <span class="s1">headers.set(</span><span class="s0">'x-middleware-rewrite'</span><span class="s1">, (</span><span class="s3">0</span><span class="s1">, _utils.validateURL)(destination));</span>
        <span class="s1">handleMiddlewareField(init, headers);</span>
        <span class="s2">return new </span><span class="s1">NextResponse(</span><span class="s2">null</span><span class="s1">, {</span>
            <span class="s1">...init,</span>
            <span class="s1">headers</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s2">static </span><span class="s1">next(init) {</span>
        <span class="s2">const </span><span class="s1">headers = </span><span class="s2">new </span><span class="s1">Headers(init == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: init.headers);</span>
        <span class="s1">headers.set(</span><span class="s0">'x-middleware-next'</span><span class="s1">, </span><span class="s0">'1'</span><span class="s1">);</span>
        <span class="s1">handleMiddlewareField(init, headers);</span>
        <span class="s2">return new </span><span class="s1">NextResponse(</span><span class="s2">null</span><span class="s1">, {</span>
            <span class="s1">...init,</span>
            <span class="s1">headers</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s4">//# sourceMappingURL=response.js.map</span></pre>
</body>
</html>