<html>
<head>
<title>ReactRefreshWebpackPlugin.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #8c8c8c; font-style: italic;}
.s4 { color: #0037a6;}
.s5 { color: #1750eb;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
ReactRefreshWebpackPlugin.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, { value: </span><span class="s2">true </span><span class="s1">});</span>
<span class="s3">// Shared between webpack 4 and 5:</span>
<span class="s2">function </span><span class="s1">injectRefreshFunctions(compilation, Template) {</span>
    <span class="s2">const </span><span class="s1">hookVars = compilation.mainTemplate.hooks.localVars;</span>
    <span class="s1">hookVars.tap(</span><span class="s0">'ReactFreshWebpackPlugin'</span><span class="s1">, (source) =&gt; Template.asString([</span>
        <span class="s1">source,</span>
        <span class="s0">''</span><span class="s1">,</span>
        <span class="s0">'// noop fns to prevent runtime errors during initialization'</span><span class="s1">,</span>
        <span class="s0">'if (typeof self !== &quot;undefined&quot;) {'</span><span class="s1">,</span>
        <span class="s1">Template.indent(</span><span class="s0">'self.$RefreshReg$ = function () {};'</span><span class="s1">),</span>
        <span class="s1">Template.indent(</span><span class="s0">'self.$RefreshSig$ = function () {'</span><span class="s1">),</span>
        <span class="s1">Template.indent(Template.indent(</span><span class="s0">'return function (type) {'</span><span class="s1">)),</span>
        <span class="s1">Template.indent(Template.indent(Template.indent(</span><span class="s0">'return type;'</span><span class="s1">))),</span>
        <span class="s1">Template.indent(Template.indent(</span><span class="s0">'};'</span><span class="s1">)),</span>
        <span class="s1">Template.indent(</span><span class="s0">'};'</span><span class="s1">),</span>
        <span class="s0">'}'</span><span class="s1">,</span>
    <span class="s1">]));</span>
<span class="s1">}</span>
<span class="s2">function </span><span class="s1">webpack4(compiler) {</span>
    <span class="s2">const </span><span class="s1">{ Template } = </span><span class="s2">this</span><span class="s1">;</span>
    <span class="s3">// Webpack 4 does not have a method to handle interception of module</span>
    <span class="s3">// execution.</span>
    <span class="s3">// The closest thing we have to emulating this is mimicking the behavior of</span>
    <span class="s3">// `strictModuleExceptionHandling` in `MainTemplate`:</span>
    <span class="s3">// https://github.com/webpack/webpack/blob/4c644bf1f7cb067c748a52614500e0e2182b2700/lib/MainTemplate.js#L200</span>
    <span class="s1">compiler.hooks.compilation.tap(</span><span class="s0">'ReactFreshWebpackPlugin'</span><span class="s1">, (compilation) =&gt; {</span>
        <span class="s1">injectRefreshFunctions(compilation, Template);</span>
        <span class="s2">const </span><span class="s1">hookRequire = compilation.mainTemplate.hooks.require;</span>
        <span class="s3">// @ts-ignore webpack 5 types compat</span>
        <span class="s1">hookRequire.tap(</span><span class="s0">'ReactFreshWebpackPlugin'</span><span class="s1">, (source) =&gt; {</span>
            <span class="s3">// Webpack 4 evaluates module code on the following line:</span>
            <span class="s3">// ```</span>
            <span class="s3">// modules[moduleId].call(module.exports, module, module.exports, hotCreateRequire(moduleId));</span>
            <span class="s3">// ```</span>
            <span class="s3">// https://github.com/webpack/webpack/blob/4c644bf1f7cb067c748a52614500e0e2182b2700/lib/MainTemplate.js#L200</span>
            <span class="s2">const </span><span class="s1">lines = source.split(</span><span class="s0">'</span><span class="s4">\n</span><span class="s0">'</span><span class="s1">);</span>
            <span class="s3">// @ts-ignore webpack 5 types compat</span>
            <span class="s2">const </span><span class="s1">evalIndex = lines.findIndex((l) =&gt; l.includes(</span><span class="s0">'modules[moduleId].call('</span><span class="s1">));</span>
            <span class="s3">// Unable to find the module execution, that's OK:</span>
            <span class="s2">if </span><span class="s1">(evalIndex === -</span><span class="s5">1</span><span class="s1">) {</span>
                <span class="s2">return </span><span class="s1">source;</span>
            <span class="s1">}</span>
            <span class="s3">// Legacy CSS implementations will `eval` browser code in a Node.js</span>
            <span class="s3">// context to extract CSS. For backwards compatibility, we need to check</span>
            <span class="s3">// we're in a browser context before continuing.</span>
            <span class="s2">return </span><span class="s1">Template.asString([</span>
                <span class="s1">...lines.slice(</span><span class="s5">0</span><span class="s1">, evalIndex),</span>
                <span class="s0">`</span>
        <span class="s0">var hasRefresh = typeof self !== &quot;undefined&quot; &amp;&amp; !!self.$RefreshInterceptModuleExecution$; 
        var cleanup = hasRefresh 
          ? self.$RefreshInterceptModuleExecution$(moduleId) 
          : function() {}; 
        try { 
        `</span><span class="s1">,</span>
                <span class="s1">lines[evalIndex],</span>
                <span class="s0">`</span>
        <span class="s0">} finally { 
          cleanup(); 
        } 
        `</span><span class="s1">,</span>
                <span class="s1">...lines.slice(evalIndex + </span><span class="s5">1</span><span class="s1">),</span>
            <span class="s1">]);</span>
        <span class="s1">});</span>
    <span class="s1">});</span>
<span class="s1">}</span>
<span class="s2">function </span><span class="s1">webpack5(compiler) {</span>
    <span class="s2">const </span><span class="s1">{ RuntimeGlobals, RuntimeModule, Template } = </span><span class="s2">this</span><span class="s1">;</span>
    <span class="s2">class </span><span class="s1">ReactRefreshRuntimeModule </span><span class="s2">extends </span><span class="s1">RuntimeModule {</span>
        <span class="s1">constructor() {</span>
            <span class="s2">super</span><span class="s1">(</span><span class="s0">'react refresh'</span><span class="s1">, </span><span class="s5">5</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s1">generate() {</span>
            <span class="s2">const </span><span class="s1">{ runtimeTemplate } = </span><span class="s2">this</span><span class="s1">.compilation;</span>
            <span class="s2">return </span><span class="s1">Template.asString([</span>
                <span class="s0">`if (</span><span class="s1">${RuntimeGlobals.interceptModuleExecution}</span><span class="s0">) {`</span><span class="s1">,</span>
                <span class="s0">`</span><span class="s1">${RuntimeGlobals.interceptModuleExecution}</span><span class="s0">.push(</span><span class="s1">${runtimeTemplate.basicFunction(</span><span class="s0">'options'</span><span class="s1">, [</span>
                    <span class="s0">`</span><span class="s1">${runtimeTemplate.supportsConst() ? </span><span class="s0">'const' </span><span class="s1">: </span><span class="s0">'var'</span><span class="s1">} </span><span class="s0">originalFactory = options.factory;`</span><span class="s1">,</span>
                    <span class="s0">`options.factory = </span><span class="s1">${runtimeTemplate.basicFunction(</span><span class="s0">'moduleObject, moduleExports, webpackRequire'</span><span class="s1">, [</span>
                        <span class="s3">// Legacy CSS implementations will `eval` browser code in a Node.js</span>
                        <span class="s3">// context to extract CSS. For backwards compatibility, we need to check</span>
                        <span class="s3">// we're in a browser context before continuing.</span>
                        <span class="s0">`</span><span class="s1">${runtimeTemplate.supportsConst() ? </span><span class="s0">'const' </span><span class="s1">: </span><span class="s0">'var'</span><span class="s1">} </span><span class="s0">hasRefresh = typeof self !== &quot;undefined&quot; &amp;&amp; !!self.$RefreshInterceptModuleExecution$;`</span><span class="s1">,</span>
                        <span class="s0">`</span><span class="s1">${runtimeTemplate.supportsConst() ? </span><span class="s0">'const' </span><span class="s1">: </span><span class="s0">'var'</span><span class="s1">} </span><span class="s0">cleanup = hasRefresh ? self.$RefreshInterceptModuleExecution$(moduleObject.id) : </span><span class="s1">${runtimeTemplate.supportsArrowFunction()</span>
                            <span class="s1">? </span><span class="s0">'() =&gt; {}'</span>
                            <span class="s1">: </span><span class="s0">'function() {}'</span><span class="s1">}</span><span class="s0">;`</span><span class="s1">,</span>
                        <span class="s0">'try {'</span><span class="s1">,</span>
                        <span class="s1">Template.indent(</span><span class="s0">'originalFactory.call(this, moduleObject, moduleExports, webpackRequire);'</span><span class="s1">),</span>
                        <span class="s0">'} finally {'</span><span class="s1">,</span>
                        <span class="s1">Template.indent(</span><span class="s0">`cleanup();`</span><span class="s1">),</span>
                        <span class="s0">'}'</span><span class="s1">,</span>
                    <span class="s1">])}</span><span class="s0">`</span><span class="s1">,</span>
                <span class="s1">])}</span><span class="s0">)`</span><span class="s1">,</span>
                <span class="s0">'}'</span><span class="s1">,</span>
            <span class="s1">]);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">// @ts-ignore webpack 5 types compat</span>
    <span class="s1">compiler.hooks.compilation.tap(</span><span class="s0">'ReactFreshWebpackPlugin'</span><span class="s1">, (compilation) =&gt; {</span>
        <span class="s1">injectRefreshFunctions(compilation, Template);</span>
        <span class="s1">compilation.hooks.additionalTreeRuntimeRequirements.tap(</span><span class="s0">'ReactFreshWebpackPlugin'</span><span class="s1">, (chunk) =&gt; {</span>
            <span class="s1">compilation.addRuntimeModule(chunk, </span><span class="s2">new </span><span class="s1">ReactRefreshRuntimeModule());</span>
        <span class="s1">});</span>
    <span class="s1">});</span>
<span class="s1">}</span>
<span class="s2">class </span><span class="s1">ReactFreshWebpackPlugin {</span>
    <span class="s1">constructor({ version, RuntimeGlobals, RuntimeModule, Template, } = require(</span><span class="s0">'webpack'</span><span class="s1">)) {</span>
        <span class="s2">this</span><span class="s1">.webpackMajorVersion = parseInt(version !== </span><span class="s2">null </span><span class="s1">&amp;&amp; version !== </span><span class="s2">void </span><span class="s5">0 </span><span class="s1">? version : </span><span class="s0">''</span><span class="s1">, </span><span class="s5">10</span><span class="s1">);</span>
        <span class="s2">this</span><span class="s1">.RuntimeGlobals = RuntimeGlobals;</span>
        <span class="s2">this</span><span class="s1">.RuntimeModule = RuntimeModule;</span>
        <span class="s2">this</span><span class="s1">.Template = Template;</span>
    <span class="s1">}</span>
    <span class="s1">apply(compiler) {</span>
        <span class="s2">switch </span><span class="s1">(</span><span class="s2">this</span><span class="s1">.webpackMajorVersion) {</span>
            <span class="s2">case </span><span class="s5">4</span><span class="s1">: {</span>
                <span class="s1">webpack4.call(</span><span class="s2">this</span><span class="s1">, compiler);</span>
                <span class="s2">break</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s2">case </span><span class="s5">5</span><span class="s1">: {</span>
                <span class="s1">webpack5.call(</span><span class="s2">this</span><span class="s1">, compiler);</span>
                <span class="s2">break</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s2">default</span><span class="s1">: {</span>
                <span class="s2">throw new </span><span class="s1">Error(</span><span class="s0">`ReactFreshWebpackPlugin does not support webpack v</span><span class="s1">${</span><span class="s2">this</span><span class="s1">.webpackMajorVersion}</span><span class="s0">.`</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s1">exports.default = ReactFreshWebpackPlugin;</span>
<span class="s3">//# sourceMappingURL=ReactRefreshWebpackPlugin.js.map</span></pre>
</body>
</html>