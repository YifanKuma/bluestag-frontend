<html>
<head>
<title>optimize-hook-destructuring.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
optimize-hook-destructuring.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/build/babel/plugins/optimize-hook-destructuring.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type {</span><span class="s3">\n  </span><span class="s1">NodePath,</span><span class="s3">\n  </span><span class="s1">types as BabelTypes,</span><span class="s3">\n</span><span class="s1">} from 'next/dist/compiled/babel/core'</span><span class="s3">\n</span><span class="s1">import type { PluginObj } from 'next/dist/compiled/babel/core'</span><span class="s3">\n</span><span class="s1">// matches any hook-like (the default)</span><span class="s3">\n</span><span class="s1">const isHook = /^use[A-Z]/</span><span class="s3">\n\n</span><span class="s1">// matches only built-in hooks provided by React et al</span><span class="s3">\n</span><span class="s1">const isBuiltInHook =</span><span class="s3">\n  </span><span class="s1">/^use(Callback|Context|DebugValue|Effect|ImperativeHandle|LayoutEffect|Memo|Reducer|Ref|State)$/</span><span class="s3">\n\n</span><span class="s1">export default function ({</span><span class="s3">\n  </span><span class="s1">types: t,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">types: typeof BabelTypes</span><span class="s3">\n</span><span class="s1">}): PluginObj&lt;any&gt; {</span><span class="s3">\n  </span><span class="s1">const visitor = {</span><span class="s3">\n    </span><span class="s1">CallExpression(path: NodePath&lt;BabelTypes.CallExpression&gt;, state: any) {</span><span class="s3">\n      </span><span class="s1">const onlyBuiltIns = state.opts.onlyBuiltIns</span><span class="s3">\n\n      </span><span class="s1">// if specified, options.lib is a list of libraries that provide hook functions</span><span class="s3">\n      </span><span class="s1">const libs =</span><span class="s3">\n        </span><span class="s1">state.opts.lib &amp;&amp;</span><span class="s3">\n        </span><span class="s1">(state.opts.lib === true</span><span class="s3">\n          </span><span class="s1">? ['react', 'preact/hooks']</span><span class="s3">\n          </span><span class="s1">: [].concat(state.opts.lib))</span><span class="s3">\n\n      </span><span class="s1">// skip function calls that are not the init of a variable declaration:</span><span class="s3">\n      </span><span class="s1">if (!t.isVariableDeclarator(path.parent)) return</span><span class="s3">\n\n      </span><span class="s1">// skip function calls where the return value is not Array-destructured:</span><span class="s3">\n      </span><span class="s1">if (!t.isArrayPattern(path.parent.id)) return</span><span class="s3">\n\n      </span><span class="s1">// name of the (hook) function being called:</span><span class="s3">\n      </span><span class="s1">const hookName = (path.node.callee as BabelTypes.Identifier).name</span><span class="s3">\n\n      </span><span class="s1">if (libs) {</span><span class="s3">\n        </span><span class="s1">const binding = path.scope.getBinding(hookName)</span><span class="s3">\n        </span><span class="s1">// not an import</span><span class="s3">\n        </span><span class="s1">if (!binding || binding.kind !== 'module') return</span><span class="s3">\n\n        </span><span class="s1">const specifier = (binding.path.parent as BabelTypes.ImportDeclaration)</span><span class="s3">\n          </span><span class="s1">.source.value</span><span class="s3">\n        </span><span class="s1">// not a match</span><span class="s3">\n        </span><span class="s1">if (!libs.some((lib: any) =&gt; lib === specifier)) return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// only match function calls with names that look like a hook</span><span class="s3">\n      </span><span class="s1">if (!(onlyBuiltIns ? isBuiltInHook : isHook).test(hookName)) return</span><span class="s3">\n\n      </span><span class="s1">path.parent.id = t.objectPattern(</span><span class="s3">\n        </span><span class="s1">path.parent.id.elements.reduce&lt;Array&lt;BabelTypes.ObjectProperty&gt;&gt;(</span><span class="s3">\n          </span><span class="s1">(patterns, element, i) =&gt; {</span><span class="s3">\n            </span><span class="s1">if (element === null) {</span><span class="s3">\n              </span><span class="s1">return patterns</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">return patterns.concat(</span><span class="s3">\n              </span><span class="s1">t.objectProperty(</span><span class="s3">\n                </span><span class="s1">t.numericLiteral(i),</span><span class="s3">\n                </span><span class="s1">// TODO: fix this</span><span class="s3">\n                </span><span class="s1">element as Exclude&lt;</span><span class="s3">\n                  </span><span class="s1">typeof element,</span><span class="s3">\n                  </span><span class="s1">BabelTypes.MemberExpression | BabelTypes.TSParameterProperty</span><span class="s3">\n                </span><span class="s1">&gt;</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">[]</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">name: 'optimize-hook-destructuring',</span><span class="s3">\n    </span><span class="s1">visitor: {</span><span class="s3">\n      </span><span class="s1">// this is a workaround to run before preset-env destroys destructured assignments</span><span class="s3">\n      </span><span class="s1">Program(path, state) {</span><span class="s3">\n        </span><span class="s1">path.traverse(visitor, state)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isHook&quot;</span><span class="s0">,</span><span class="s1">&quot;isBuiltInHook&quot;</span><span class="s0">,</span><span class="s1">&quot;types&quot;</span><span class="s0">,</span><span class="s1">&quot;t&quot;</span><span class="s0">,</span><span class="s1">&quot;visitor&quot;</span><span class="s0">,</span><span class="s1">&quot;CallExpression&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;state&quot;</span><span class="s0">,</span><span class="s1">&quot;onlyBuiltIns&quot;</span><span class="s0">,</span><span class="s1">&quot;opts&quot;</span><span class="s0">,</span><span class="s1">&quot;libs&quot;</span><span class="s0">,</span><span class="s1">&quot;lib&quot;</span><span class="s0">,</span><span class="s1">&quot;concat&quot;</span><span class="s0">,</span><span class="s1">&quot;isVariableDeclarator&quot;</span><span class="s0">,</span><span class="s1">&quot;parent&quot;</span><span class="s0">,</span><span class="s1">&quot;isArrayPattern&quot;</span><span class="s0">,</span><span class="s1">&quot;id&quot;</span><span class="s0">,</span><span class="s1">&quot;hookName&quot;</span><span class="s0">,</span><span class="s1">&quot;node&quot;</span><span class="s0">,</span><span class="s1">&quot;callee&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;binding&quot;</span><span class="s0">,</span><span class="s1">&quot;scope&quot;</span><span class="s0">,</span><span class="s1">&quot;getBinding&quot;</span><span class="s0">,</span><span class="s1">&quot;kind&quot;</span><span class="s0">,</span><span class="s1">&quot;specifier&quot;</span><span class="s0">,</span><span class="s1">&quot;source&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;some&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;objectPattern&quot;</span><span class="s0">,</span><span class="s1">&quot;elements&quot;</span><span class="s0">,</span><span class="s1">&quot;reduce&quot;</span><span class="s0">,</span><span class="s1">&quot;patterns&quot;</span><span class="s0">,</span><span class="s1">&quot;element&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;objectProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;numericLiteral&quot;</span><span class="s0">,</span><span class="s1">&quot;Program&quot;</span><span class="s0">,</span><span class="s1">&quot;traverse&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BAYA;;;eAAA;;;AAPA,sCAAsC;AACtC,MAAMA,SAAS;AAEf,sDAAsD;AACtD,MAAMC,gBACJ;AAEa,SAAf,SAAyB,EACvBC,OAAOC,CAAC,EAGT;IACC,MAAMC,UAAU;QACdC,gBAAeC,IAAyC,EAAEC,KAAU;YAClE,MAAMC,eAAeD,MAAME,IAAI,CAACD,YAAY;YAE5C,+EAA+E;YAC/E,MAAME,OACJH,MAAME,IAAI,CAACE,GAAG,IACbJ,CAAAA,MAAME,IAAI,CAACE,GAAG,KAAK,OAChB;gBAAC;gBAAS;aAAe,GACzB,EAAE,CAACC,MAAM,CAACL,MAAME,IAAI,CAACE,GAAG,CAAA;YAE9B,uEAAuE;YACvE,IAAI,CAACR,EAAEU,oBAAoB,CAACP,KAAKQ,MAAM,GAAG;YAE1C,wEAAwE;YACxE,IAAI,CAACX,EAAEY,cAAc,CAACT,KAAKQ,MAAM,CAACE,EAAE,GAAG;YAEvC,4CAA4C;YAC5C,MAAMC,WAAW,AAACX,KAAKY,IAAI,CAACC,MAAM,CAA2BC,IAAI;YAEjE,IAAIV,MAAM;gBACR,MAAMW,UAAUf,KAAKgB,KAAK,CAACC,UAAU,CAACN;gBACtC,gBAAgB;gBAChB,IAAI,CAACI,WAAWA,QAAQG,IAAI,KAAK,UAAU;gBAE3C,MAAMC,YAAY,AAACJ,QAAQf,IAAI,CAACQ,MAAM,CACnCY,MAAM,CAACC,KAAK;gBACf,cAAc;gBACd,IAAI,CAACjB,KAAKkB,IAAI,CAAC,CAACjB,MAAaA,QAAQc,YAAY;YACnD;YAEA,6DAA6D;YAC7D,IAAI,CAAC,AAACjB,CAAAA,eAAeP,gBAAgBD,MAAK,EAAG6B,IAAI,CAACZ,WAAW;YAE7DX,KAAKQ,MAAM,CAACE,EAAE,GAAGb,EAAE2B,aAAa,CAC9BxB,KAAKQ,MAAM,CAACE,EAAE,CAACe,QAAQ,CAACC,MAAM,CAC5B,CAACC,UAAUC,SAASC;gBAClB,IAAID,YAAY,MAAM;oBACpB,OAAOD;gBACT;gBAEA,OAAOA,SAASrB,MAAM,CACpBT,EAAEiC,cAAc,CACdjC,EAAEkC,cAAc,CAACF,IACjB,iBAAiB;gBACjBD;YAMN,GACA,EAAE;QAGR;IACF;IAEA,OAAO;QACLd,MAAM;QACNhB,SAAS;YACP,kFAAkF;YAClFkC,SAAQhC,IAAI,EAAEC,KAAK;gBACjBD,KAAKiC,QAAQ,CAACnC,SAASG;YACzB;QACF;IACF;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>