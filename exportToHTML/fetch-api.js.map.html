<html>
<head>
<title>fetch-api.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
fetch-api.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/experimental/testmode/proxy/fetch-api.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { ProxyFetchRequest, ProxyResponse } from './types'</span><span class="s3">\n</span><span class="s1">import { ABORT, CONTINUE, UNHANDLED } from './types'</span><span class="s3">\n\n</span><span class="s1">export type FetchHandlerResult =</span><span class="s3">\n  </span><span class="s1">| Response</span><span class="s3">\n  </span><span class="s1">| 'abort'</span><span class="s3">\n  </span><span class="s1">| 'continue'</span><span class="s3">\n  </span><span class="s1">| null</span><span class="s3">\n  </span><span class="s1">| undefined</span><span class="s3">\n\n</span><span class="s1">export type FetchHandler = (</span><span class="s3">\n  </span><span class="s1">testData: string,</span><span class="s3">\n  </span><span class="s1">request: Request</span><span class="s3">\n</span><span class="s1">) =&gt; FetchHandlerResult | Promise&lt;FetchHandlerResult&gt;</span><span class="s3">\n\n</span><span class="s1">function buildRequest(req: ProxyFetchRequest): Request {</span><span class="s3">\n  </span><span class="s1">const { request: proxyRequest } = req</span><span class="s3">\n  </span><span class="s1">const { url, headers, body, ...options } = proxyRequest</span><span class="s3">\n  </span><span class="s1">return new Request(url, {</span><span class="s3">\n    </span><span class="s1">...options,</span><span class="s3">\n    </span><span class="s1">headers: new Headers(headers),</span><span class="s3">\n    </span><span class="s1">body: body ? Buffer.from(body, 'base64') : null,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">async function buildResponse(</span><span class="s3">\n  </span><span class="s1">response: FetchHandlerResult</span><span class="s3">\n</span><span class="s1">): Promise&lt;ProxyResponse&gt; {</span><span class="s3">\n  </span><span class="s1">if (!response) {</span><span class="s3">\n    </span><span class="s1">return UNHANDLED</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (response === 'abort') {</span><span class="s3">\n    </span><span class="s1">return ABORT</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (response === 'continue') {</span><span class="s3">\n    </span><span class="s1">return CONTINUE</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { status, headers, body } = response</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">api: 'fetch',</span><span class="s3">\n    </span><span class="s1">response: {</span><span class="s3">\n      </span><span class="s1">status,</span><span class="s3">\n      </span><span class="s1">headers: Array.from(headers),</span><span class="s3">\n      </span><span class="s1">body: body</span><span class="s3">\n        </span><span class="s1">? Buffer.from(await response.arrayBuffer()).toString('base64')</span><span class="s3">\n        </span><span class="s1">: null,</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function handleFetch(</span><span class="s3">\n  </span><span class="s1">req: ProxyFetchRequest,</span><span class="s3">\n  </span><span class="s1">onFetch: FetchHandler</span><span class="s3">\n</span><span class="s1">): Promise&lt;ProxyResponse&gt; {</span><span class="s3">\n  </span><span class="s1">const { testData } = req</span><span class="s3">\n  </span><span class="s1">const request = buildRequest(req)</span><span class="s3">\n  </span><span class="s1">const response = await onFetch(testData, request)</span><span class="s3">\n  </span><span class="s1">return buildResponse(response)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;handleFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;buildRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;proxyRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;Request&quot;</span><span class="s0">,</span><span class="s1">&quot;Headers&quot;</span><span class="s0">,</span><span class="s1">&quot;Buffer&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;buildResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;UNHANDLED&quot;</span><span class="s0">,</span><span class="s1">&quot;ABORT&quot;</span><span class="s0">,</span><span class="s1">&quot;CONTINUE&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;api&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;arrayBuffer&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;onFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;testData&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BAmDsBA;;;eAAAA;;;uBAlDqB;AAc3C,SAASC,aAAaC,GAAsB;IAC1C,MAAM,EAAEC,SAASC,YAAY,EAAE,GAAGF;IAClC,MAAM,EAAEG,GAAG,EAAEC,OAAO,EAAEC,IAAI,EAAE,GAAGC,SAAS,GAAGJ;IAC3C,OAAO,IAAIK,QAAQJ,KAAK;QACtB,GAAGG,OAAO;QACVF,SAAS,IAAII,QAAQJ;QACrBC,MAAMA,OAAOI,OAAOC,IAAI,CAACL,MAAM,YAAY;IAC7C;AACF;AAEA,eAAeM,cACbC,QAA4B;IAE5B,IAAI,CAACA,UAAU;QACb,OAAOC,gBAAS;IAClB;IACA,IAAID,aAAa,SAAS;QACxB,OAAOE,YAAK;IACd;IACA,IAAIF,aAAa,YAAY;QAC3B,OAAOG,eAAQ;IACjB;IAEA,MAAM,EAAEC,MAAM,EAAEZ,OAAO,EAAEC,IAAI,EAAE,GAAGO;IAClC,OAAO;QACLK,KAAK;QACLL,UAAU;YACRI;YACAZ,SAASc,MAAMR,IAAI,CAACN;YACpBC,MAAMA,OACFI,OAAOC,IAAI,CAAC,MAAME,SAASO,WAAW,IAAIC,QAAQ,CAAC,YACnD;QACN;IACF;AACF;AAEO,eAAetB,YACpBE,GAAsB,EACtBqB,OAAqB;IAErB,MAAM,EAAEC,QAAQ,EAAE,GAAGtB;IACrB,MAAMC,UAAUF,aAAaC;IAC7B,MAAMY,WAAW,MAAMS,QAAQC,UAAUrB;IACzC,OAAOU,cAAcC;AACvB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>