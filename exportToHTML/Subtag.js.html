<html>
<head>
<title>Subtag.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #8c8c8c; font-style: italic;}
.s1 { color: #8c8c8c; font-style: italic;}
.s2 { color: #080808;}
.s3 { color: #067d17;}
.s4 { color: #0033b3;}
.s5 { color: #1750eb;}
.s6 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Subtag.js</font>
</center></td></tr></table>
<pre><span class="s0">/**</span>
 <span class="s0">* </span><span class="s1">@author </span><span class="s0">Matthew Caruana Galizia &lt;mattcg@gmail.com&gt;</span>
 <span class="s0">* </span><span class="s1">@license </span><span class="s0">MIT: http://mattcg.mit-license.org/</span>
 <span class="s0">* </span><span class="s1">@copyright </span><span class="s0">Copyright (c) 2013, Matthew Caruana Galizia</span>
 <span class="s0">*/</span>

<span class="s3">'use strict'</span><span class="s2">;</span>

<span class="s4">function </span><span class="s2">_typeof(obj) { </span><span class="s3">&quot;@babel/helpers - typeof&quot;</span><span class="s2">; </span><span class="s4">return </span><span class="s2">_typeof = </span><span class="s3">&quot;function&quot; </span><span class="s2">== </span><span class="s4">typeof </span><span class="s2">Symbol &amp;&amp; </span><span class="s3">&quot;symbol&quot; </span><span class="s2">== </span><span class="s4">typeof </span><span class="s2">Symbol.iterator ? </span><span class="s4">function </span><span class="s2">(obj) { </span><span class="s4">return typeof </span><span class="s2">obj; } : </span><span class="s4">function </span><span class="s2">(obj) { </span><span class="s4">return </span><span class="s2">obj &amp;&amp; </span><span class="s3">&quot;function&quot; </span><span class="s2">== </span><span class="s4">typeof </span><span class="s2">Symbol &amp;&amp; obj.constructor === Symbol &amp;&amp; obj !== Symbol.prototype ? </span><span class="s3">&quot;symbol&quot; </span><span class="s2">: </span><span class="s4">typeof </span><span class="s2">obj; }, _typeof(obj); }</span>
<span class="s4">function </span><span class="s2">_classCallCheck(instance, Constructor) { </span><span class="s4">if </span><span class="s2">(!(instance </span><span class="s4">instanceof </span><span class="s2">Constructor)) { </span><span class="s4">throw new </span><span class="s2">TypeError(</span><span class="s3">&quot;Cannot call a class as a function&quot;</span><span class="s2">); } }</span>
<span class="s4">function </span><span class="s2">_defineProperties(target, props) { </span><span class="s4">for </span><span class="s2">(</span><span class="s4">var </span><span class="s2">i = </span><span class="s5">0</span><span class="s2">; i &lt; props.length; i++) { </span><span class="s4">var </span><span class="s2">descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || </span><span class="s4">false</span><span class="s2">; descriptor.configurable = </span><span class="s4">true</span><span class="s2">; </span><span class="s4">if </span><span class="s2">(</span><span class="s3">&quot;value&quot; </span><span class="s4">in </span><span class="s2">descriptor) descriptor.writable = </span><span class="s4">true</span><span class="s2">; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }</span>
<span class="s4">function </span><span class="s2">_createClass(Constructor, protoProps, staticProps) { </span><span class="s4">if </span><span class="s2">(protoProps) _defineProperties(Constructor.prototype, protoProps); </span><span class="s4">if </span><span class="s2">(staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, </span><span class="s3">&quot;prototype&quot;</span><span class="s2">, { writable: </span><span class="s4">false </span><span class="s2">}); </span><span class="s4">return </span><span class="s2">Constructor; }</span>
<span class="s4">function </span><span class="s2">_defineProperty(obj, key, value) { key = _toPropertyKey(key); </span><span class="s4">if </span><span class="s2">(key </span><span class="s4">in </span><span class="s2">obj) { Object.defineProperty(obj, key, { value: value, enumerable: </span><span class="s4">true</span><span class="s2">, configurable: </span><span class="s4">true</span><span class="s2">, writable: </span><span class="s4">true </span><span class="s2">}); } </span><span class="s4">else </span><span class="s2">{ obj[key] = value; } </span><span class="s4">return </span><span class="s2">obj; }</span>
<span class="s4">function </span><span class="s2">_toPropertyKey(arg) { </span><span class="s4">var </span><span class="s2">key = _toPrimitive(arg, </span><span class="s3">&quot;string&quot;</span><span class="s2">); </span><span class="s4">return </span><span class="s2">_typeof(key) === </span><span class="s3">&quot;symbol&quot; </span><span class="s2">? key : String(key); }</span>
<span class="s4">function </span><span class="s2">_toPrimitive(input, hint) { </span><span class="s4">if </span><span class="s2">(_typeof(input) !== </span><span class="s3">&quot;object&quot; </span><span class="s2">|| input === </span><span class="s4">null</span><span class="s2">) </span><span class="s4">return </span><span class="s2">input; </span><span class="s4">var </span><span class="s2">prim = input[Symbol.toPrimitive]; </span><span class="s4">if </span><span class="s2">(prim !== undefined) { </span><span class="s4">var </span><span class="s2">res = prim.call(input, hint || </span><span class="s3">&quot;default&quot;</span><span class="s2">); </span><span class="s4">if </span><span class="s2">(_typeof(res) !== </span><span class="s3">&quot;object&quot;</span><span class="s2">) </span><span class="s4">return </span><span class="s2">res; </span><span class="s4">throw new </span><span class="s2">TypeError(</span><span class="s3">&quot;@@toPrimitive must return a primitive value.&quot;</span><span class="s2">); } </span><span class="s4">return </span><span class="s2">(hint === </span><span class="s3">&quot;string&quot; </span><span class="s2">? String : Number)(input); }</span>
<span class="s4">var </span><span class="s2">index = require(</span><span class="s3">'language-subtag-registry/data/json/index.json'</span><span class="s2">);</span>
<span class="s4">var </span><span class="s2">registry = require(</span><span class="s3">'language-subtag-registry/data/json/registry.json'</span><span class="s2">);</span>
<span class="s4">var </span><span class="s2">Subtag = </span><span class="s0">/*#__PURE__*/</span><span class="s4">function </span><span class="s2">() {</span>
  <span class="s0">/**</span>
   <span class="s0">* </span><span class="s1">@param </span><span class="s0">{string} subtag</span>
   <span class="s0">* </span><span class="s1">@param </span><span class="s0">{string} type</span>
   <span class="s0">*/</span>
  <span class="s4">function </span><span class="s2">Subtag(subtag, type) {</span>
    <span class="s2">_classCallCheck(</span><span class="s4">this</span><span class="s2">, Subtag);</span>
    <span class="s4">var </span><span class="s2">types, i, record;</span>

    <span class="s0">// Lowercase for consistency (case is only a formatting convention, not a standard requirement).</span>
    <span class="s2">subtag = subtag.toLowerCase();</span>
    <span class="s2">type = type.toLowerCase();</span>
    <span class="s4">function </span><span class="s2">error(code, message) {</span>
      <span class="s4">var </span><span class="s2">err;</span>
      <span class="s2">err = </span><span class="s4">new </span><span class="s2">Error(message);</span>
      <span class="s2">err.code = code;</span>
      <span class="s2">err.subtag = subtag;</span>
      <span class="s4">throw </span><span class="s2">err;</span>
    <span class="s2">}</span>
    <span class="s2">types = index[subtag];</span>
    <span class="s4">if </span><span class="s2">(!types) {</span>
      <span class="s2">error(Subtag.ERR_NONEXISTENT, </span><span class="s3">'Non-existent subtag </span><span class="s6">\'</span><span class="s3">' </span><span class="s2">+ subtag + </span><span class="s3">'</span><span class="s6">\'</span><span class="s3">.'</span><span class="s2">);</span>
    <span class="s2">}</span>
    <span class="s2">i = types[type];</span>
    <span class="s4">if </span><span class="s2">(!i &amp;&amp; </span><span class="s5">0 </span><span class="s2">!== i) {</span>
      <span class="s2">error(Subtag.ERR_NONEXISTENT, </span><span class="s3">'Non-existent subtag </span><span class="s6">\'</span><span class="s3">' </span><span class="s2">+ subtag + </span><span class="s3">'</span><span class="s6">\' </span><span class="s3">of type </span><span class="s6">\'</span><span class="s3">' </span><span class="s2">+ type + </span><span class="s3">'</span><span class="s6">\'</span><span class="s3">.'</span><span class="s2">);</span>
    <span class="s2">}</span>
    <span class="s2">record = registry[i];</span>
    <span class="s4">if </span><span class="s2">(!record.Subtag) {</span>
      <span class="s2">error(Subtag.ERR_TAG, </span><span class="s3">'</span><span class="s6">\'</span><span class="s3">' </span><span class="s2">+ subtag + </span><span class="s3">'</span><span class="s6">\' </span><span class="s3">is a </span><span class="s6">\'</span><span class="s3">' </span><span class="s2">+ type + </span><span class="s3">'</span><span class="s6">\' </span><span class="s3">tag.'</span><span class="s2">);</span>
    <span class="s2">}</span>
    <span class="s4">this</span><span class="s2">.data = {</span>
      <span class="s2">subtag: subtag,</span>
      <span class="s2">record: record,</span>
      <span class="s2">type: type</span>
    <span class="s2">};</span>
  <span class="s2">}</span>
  <span class="s2">_createClass(Subtag, [{</span>
    <span class="s2">key: </span><span class="s3">&quot;type&quot;</span><span class="s2">,</span>
    <span class="s2">value: </span><span class="s4">function </span><span class="s2">type() {</span>
      <span class="s4">return this</span><span class="s2">.data.type;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s2">key: </span><span class="s3">&quot;descriptions&quot;</span><span class="s2">,</span>
    <span class="s2">value: </span><span class="s4">function </span><span class="s2">descriptions() {</span>
      <span class="s0">// Every record has one or more descriptions (stored as an array).</span>
      <span class="s4">return this</span><span class="s2">.data.record.Description;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s2">key: </span><span class="s3">&quot;preferred&quot;</span><span class="s2">,</span>
    <span class="s2">value: </span><span class="s4">function </span><span class="s2">preferred() {</span>
      <span class="s4">var </span><span class="s2">type,</span>
        <span class="s2">preferred = </span><span class="s4">this</span><span class="s2">.data.record[</span><span class="s3">'Preferred-Value'</span><span class="s2">];</span>
      <span class="s4">if </span><span class="s2">(preferred) {</span>
        <span class="s2">type = </span><span class="s4">this</span><span class="s2">.data.type;</span>
        <span class="s4">if </span><span class="s2">(type === </span><span class="s3">'extlang'</span><span class="s2">) {</span>
          <span class="s2">type = </span><span class="s3">'language'</span><span class="s2">;</span>
        <span class="s2">}</span>
        <span class="s4">return new </span><span class="s2">Subtag(preferred, type);</span>
      <span class="s2">}</span>
      <span class="s4">return null</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s2">key: </span><span class="s3">&quot;script&quot;</span><span class="s2">,</span>
    <span class="s2">value: </span><span class="s4">function </span><span class="s2">script() {</span>
      <span class="s4">var </span><span class="s2">script = </span><span class="s4">this</span><span class="s2">.data.record[</span><span class="s3">'Suppress-Script'</span><span class="s2">];</span>
      <span class="s4">if </span><span class="s2">(script) {</span>
        <span class="s4">return new </span><span class="s2">Subtag(script, </span><span class="s3">'script'</span><span class="s2">);</span>
      <span class="s2">}</span>
      <span class="s4">return null</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s2">key: </span><span class="s3">&quot;scope&quot;</span><span class="s2">,</span>
    <span class="s2">value: </span><span class="s4">function </span><span class="s2">scope() {</span>
      <span class="s4">return this</span><span class="s2">.data.record.Scope || </span><span class="s4">null</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s2">key: </span><span class="s3">&quot;deprecated&quot;</span><span class="s2">,</span>
    <span class="s2">value: </span><span class="s4">function </span><span class="s2">deprecated() {</span>
      <span class="s4">return this</span><span class="s2">.data.record.Deprecated || </span><span class="s4">null</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s2">key: </span><span class="s3">&quot;added&quot;</span><span class="s2">,</span>
    <span class="s2">value: </span><span class="s4">function </span><span class="s2">added() {</span>
      <span class="s4">return this</span><span class="s2">.data.record.Added;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s2">key: </span><span class="s3">&quot;comments&quot;</span><span class="s2">,</span>
    <span class="s2">value: </span><span class="s4">function </span><span class="s2">comments() {</span>
      <span class="s0">// Comments don't always occur for records, so switch to an empty array if missing.</span>
      <span class="s4">return this</span><span class="s2">.data.record.Comments || [];</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s2">key: </span><span class="s3">&quot;format&quot;</span><span class="s2">,</span>
    <span class="s2">value: </span><span class="s4">function </span><span class="s2">format() {</span>
      <span class="s4">var </span><span class="s2">subtag = </span><span class="s4">this</span><span class="s2">.data.subtag;</span>
      <span class="s4">switch </span><span class="s2">(</span><span class="s4">this</span><span class="s2">.data.type) {</span>
        <span class="s4">case </span><span class="s3">'region'</span><span class="s2">:</span>
          <span class="s4">return </span><span class="s2">subtag.toUpperCase();</span>
        <span class="s4">case </span><span class="s3">'script'</span><span class="s2">:</span>
          <span class="s4">return </span><span class="s2">subtag[</span><span class="s5">0</span><span class="s2">].toUpperCase() + subtag.slice(</span><span class="s5">1</span><span class="s2">);</span>
      <span class="s2">}</span>
      <span class="s4">return </span><span class="s2">subtag;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s2">key: </span><span class="s3">&quot;toString&quot;</span><span class="s2">,</span>
    <span class="s2">value: </span><span class="s4">function </span><span class="s2">toString() {</span>
      <span class="s4">return this</span><span class="s2">.format();</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>
  <span class="s4">return </span><span class="s2">Subtag;</span>
<span class="s2">}();</span>
<span class="s2">_defineProperty(Subtag, </span><span class="s3">&quot;ERR_NONEXISTENT&quot;</span><span class="s2">, </span><span class="s5">1</span><span class="s2">);</span>
<span class="s2">_defineProperty(Subtag, </span><span class="s3">&quot;ERR_TAG&quot;</span><span class="s2">, </span><span class="s5">2</span><span class="s2">);</span>
<span class="s2">module.exports = Subtag;</span></pre>
</body>
</html>