<html>
<head>
<title>use-drag-controls.mjs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #8c8c8c; font-style: italic;}
.s4 { color: #8c8c8c; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
use-drag-controls.mjs</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">{ useConstant } from </span><span class="s2">'../../utils/use-constant.mjs'</span><span class="s1">;</span>

<span class="s3">/**</span>
 <span class="s3">* Can manually trigger a drag gesture on one or more `drag`-enabled `motion` components.</span>
 <span class="s3">*</span>
 <span class="s3">* ```jsx</span>
 <span class="s3">* const dragControls = useDragControls()</span>
 <span class="s3">*</span>
 <span class="s3">* function startDrag(event) {</span>
 <span class="s3">*   dragControls.start(event, { snapToCursor: true })</span>
 <span class="s3">* }</span>
 <span class="s3">*</span>
 <span class="s3">* return (</span>
 <span class="s3">*   &lt;&gt;</span>
 <span class="s3">*     &lt;div onPointerDown={startDrag} /&gt;</span>
 <span class="s3">*     &lt;motion.div drag=&quot;x&quot; dragControls={dragControls} /&gt;</span>
 <span class="s3">*   &lt;/&gt;</span>
 <span class="s3">* )</span>
 <span class="s3">* ```</span>
 <span class="s3">*</span>
 <span class="s3">* </span><span class="s4">@public</span>
 <span class="s3">*/</span>
<span class="s0">class </span><span class="s1">DragControls {</span>
    <span class="s1">constructor() {</span>
        <span class="s0">this</span><span class="s1">.componentControls = </span><span class="s0">new </span><span class="s1">Set();</span>
    <span class="s1">}</span>
    <span class="s3">/**</span>
     <span class="s3">* Subscribe a component's internal `VisualElementDragControls` to the user-facing API.</span>
     <span class="s3">*</span>
     <span class="s3">* </span><span class="s4">@internal</span>
     <span class="s3">*/</span>
    <span class="s1">subscribe(controls) {</span>
        <span class="s0">this</span><span class="s1">.componentControls.add(controls);</span>
        <span class="s0">return </span><span class="s1">() =&gt; </span><span class="s0">this</span><span class="s1">.componentControls.delete(controls);</span>
    <span class="s1">}</span>
    <span class="s3">/**</span>
     <span class="s3">* Start a drag gesture on every `motion` component that has this set of drag controls</span>
     <span class="s3">* passed into it via the `dragControls` prop.</span>
     <span class="s3">*</span>
     <span class="s3">* ```jsx</span>
     <span class="s3">* dragControls.start(e, {</span>
     <span class="s3">*   snapToCursor: true</span>
     <span class="s3">* })</span>
     <span class="s3">* ```</span>
     <span class="s3">*</span>
     <span class="s3">* </span><span class="s4">@param </span><span class="s3">event - PointerEvent</span>
     <span class="s3">* </span><span class="s4">@param </span><span class="s3">options - Options</span>
     <span class="s3">*</span>
     <span class="s3">* </span><span class="s4">@public</span>
     <span class="s3">*/</span>
    <span class="s1">start(event, options) {</span>
        <span class="s0">this</span><span class="s1">.componentControls.forEach((controls) =&gt; {</span>
            <span class="s1">controls.start(event.nativeEvent || event, options);</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s3">/**</span>
     <span class="s3">* Cancels a drag gesture.</span>
     <span class="s3">*</span>
     <span class="s3">* ```jsx</span>
     <span class="s3">* dragControls.cancel()</span>
     <span class="s3">* ```</span>
     <span class="s3">*</span>
     <span class="s3">* </span><span class="s4">@public</span>
     <span class="s3">*/</span>
    <span class="s1">cancel() {</span>
        <span class="s0">this</span><span class="s1">.componentControls.forEach((controls) =&gt; {</span>
            <span class="s1">controls.cancel();</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s3">/**</span>
     <span class="s3">* Stops a drag gesture.</span>
     <span class="s3">*</span>
     <span class="s3">* ```jsx</span>
     <span class="s3">* dragControls.stop()</span>
     <span class="s3">* ```</span>
     <span class="s3">*</span>
     <span class="s3">* </span><span class="s4">@public</span>
     <span class="s3">*/</span>
    <span class="s1">stop() {</span>
        <span class="s0">this</span><span class="s1">.componentControls.forEach((controls) =&gt; {</span>
            <span class="s1">controls.stop();</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s0">const </span><span class="s1">createDragControls = () =&gt; </span><span class="s0">new </span><span class="s1">DragControls();</span>
<span class="s3">/**</span>
 <span class="s3">* Usually, dragging is initiated by pressing down on a `motion` component with a `drag` prop</span>
 <span class="s3">* and moving it. For some use-cases, for instance clicking at an arbitrary point on a video scrubber, we</span>
 <span class="s3">* might want to initiate that dragging from a different component than the draggable one.</span>
 <span class="s3">*</span>
 <span class="s3">* By creating a `dragControls` using the `useDragControls` hook, we can pass this into</span>
 <span class="s3">* the draggable component's `dragControls` prop. It exposes a `start` method</span>
 <span class="s3">* that can start dragging from pointer events on other components.</span>
 <span class="s3">*</span>
 <span class="s3">* ```jsx</span>
 <span class="s3">* const dragControls = useDragControls()</span>
 <span class="s3">*</span>
 <span class="s3">* function startDrag(event) {</span>
 <span class="s3">*   dragControls.start(event, { snapToCursor: true })</span>
 <span class="s3">* }</span>
 <span class="s3">*</span>
 <span class="s3">* return (</span>
 <span class="s3">*   &lt;&gt;</span>
 <span class="s3">*     &lt;div onPointerDown={startDrag} /&gt;</span>
 <span class="s3">*     &lt;motion.div drag=&quot;x&quot; dragControls={dragControls} /&gt;</span>
 <span class="s3">*   &lt;/&gt;</span>
 <span class="s3">* )</span>
 <span class="s3">* ```</span>
 <span class="s3">*</span>
 <span class="s3">* </span><span class="s4">@public</span>
 <span class="s3">*/</span>
<span class="s0">function </span><span class="s1">useDragControls() {</span>
    <span class="s0">return </span><span class="s1">useConstant(createDragControls);</span>
<span class="s1">}</span>

<span class="s0">export </span><span class="s1">{ DragControls, useDragControls };</span>
</pre>
</body>
</html>