<html>
<head>
<title>emnapi-core.cjs.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #1750eb;}
.s4 { color: #264eff;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
emnapi-core.cjs.js</font>
</center></td></tr></table>
<pre><span class="s0">var </span><span class="s1">wasiThreads = require(</span><span class="s2">'@emnapi/wasi-threads'</span><span class="s1">);</span>

<span class="s0">const </span><span class="s1">_WebAssembly = </span><span class="s0">typeof </span><span class="s1">WebAssembly !== </span><span class="s2">'undefined'</span>
    <span class="s1">? WebAssembly</span>
    <span class="s1">: </span><span class="s0">typeof </span><span class="s1">WXWebAssembly !== </span><span class="s2">'undefined'</span>
        <span class="s1">? WXWebAssembly</span>
        <span class="s1">: undefined;</span>
<span class="s0">function </span><span class="s1">validateImports(imports) {</span>
    <span class="s0">if </span><span class="s1">(imports &amp;&amp; </span><span class="s0">typeof </span><span class="s1">imports !== </span><span class="s2">'object'</span><span class="s1">) {</span>
        <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'imports must be an object or undefined'</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s0">return true</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s0">function </span><span class="s1">load(wasmInput, imports) {</span>
    <span class="s0">if </span><span class="s1">(!wasmInput)</span>
        <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid wasm source'</span><span class="s1">);</span>
    <span class="s1">validateImports(imports);</span>
    <span class="s1">imports = imports !== </span><span class="s0">null </span><span class="s1">&amp;&amp; imports !== </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? imports : {};</span>
    <span class="s0">try </span><span class="s1">{</span>
        <span class="s0">const </span><span class="s1">then = </span><span class="s0">typeof </span><span class="s1">wasmInput === </span><span class="s2">'object' </span><span class="s1">&amp;&amp; wasmInput !== </span><span class="s0">null </span><span class="s1">&amp;&amp; </span><span class="s2">'then' </span><span class="s0">in </span><span class="s1">wasmInput ? wasmInput.then : undefined;</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">then === </span><span class="s2">'function'</span><span class="s1">) {</span>
            <span class="s0">return </span><span class="s1">then.call(wasmInput, (input) =&gt; load(input, imports));</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s0">catch </span><span class="s1">(_) { }</span>
    <span class="s0">if </span><span class="s1">(wasmInput </span><span class="s0">instanceof </span><span class="s1">ArrayBuffer || ArrayBuffer.isView(wasmInput)) {</span>
        <span class="s0">return </span><span class="s1">_WebAssembly.instantiate(wasmInput, imports);</span>
    <span class="s1">}</span>
    <span class="s0">if </span><span class="s1">(wasmInput </span><span class="s0">instanceof </span><span class="s1">_WebAssembly.Module) {</span>
        <span class="s0">return </span><span class="s1">_WebAssembly.instantiate(wasmInput, imports).then((instance) =&gt; {</span>
            <span class="s0">return </span><span class="s1">{ instance, module: wasmInput };</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">Response !== </span><span class="s2">'undefined' </span><span class="s1">&amp;&amp; wasmInput </span><span class="s0">instanceof </span><span class="s1">Response) {</span>
        <span class="s0">return </span><span class="s1">wasmInput.arrayBuffer().then(buffer =&gt; {</span>
            <span class="s0">return </span><span class="s1">_WebAssembly.instantiate(buffer, imports);</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s0">const </span><span class="s1">inputIsString = </span><span class="s0">typeof </span><span class="s1">wasmInput === </span><span class="s2">'string'</span><span class="s1">;</span>
    <span class="s0">if </span><span class="s1">(inputIsString || (</span><span class="s0">typeof </span><span class="s1">URL !== </span><span class="s2">'undefined' </span><span class="s1">&amp;&amp; wasmInput </span><span class="s0">instanceof </span><span class="s1">URL)) {</span>
        <span class="s0">if </span><span class="s1">(inputIsString &amp;&amp; </span><span class="s0">typeof </span><span class="s1">wx !== </span><span class="s2">'undefined' </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">__wxConfig !== </span><span class="s2">'undefined'</span><span class="s1">) {</span>
            <span class="s0">return </span><span class="s1">_WebAssembly.instantiate(wasmInput, imports);</span>
        <span class="s1">}</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">fetch !== </span><span class="s2">'function'</span><span class="s1">) {</span>
            <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'wasm source can not be a string or URL in this environment'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">_WebAssembly.instantiateStreaming === </span><span class="s2">'function'</span><span class="s1">) {</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">return </span><span class="s1">_WebAssembly.instantiateStreaming(fetch(wasmInput), imports).catch(() =&gt; {</span>
                    <span class="s0">return </span><span class="s1">load(fetch(wasmInput), imports);</span>
                <span class="s1">});</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(_) {</span>
                <span class="s0">return </span><span class="s1">load(fetch(wasmInput), imports);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">else </span><span class="s1">{</span>
            <span class="s0">return </span><span class="s1">load(fetch(wasmInput), imports);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid wasm source'</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s0">function </span><span class="s1">loadSync(wasmInput, imports) {</span>
    <span class="s0">if </span><span class="s1">(!wasmInput)</span>
        <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid wasm source'</span><span class="s1">);</span>
    <span class="s1">validateImports(imports);</span>
    <span class="s1">imports = imports !== </span><span class="s0">null </span><span class="s1">&amp;&amp; imports !== </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? imports : {};</span>
    <span class="s0">let </span><span class="s1">module;</span>
    <span class="s0">if </span><span class="s1">((wasmInput </span><span class="s0">instanceof </span><span class="s1">ArrayBuffer) || ArrayBuffer.isView(wasmInput)) {</span>
        <span class="s1">module = </span><span class="s0">new </span><span class="s1">_WebAssembly.Module(wasmInput);</span>
    <span class="s1">}</span>
    <span class="s0">else if </span><span class="s1">(wasmInput </span><span class="s0">instanceof </span><span class="s1">WebAssembly.Module) {</span>
        <span class="s1">module = wasmInput;</span>
    <span class="s1">}</span>
    <span class="s0">else </span><span class="s1">{</span>
        <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid wasm source'</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s0">const </span><span class="s1">instance = </span><span class="s0">new </span><span class="s1">_WebAssembly.Instance(module, imports);</span>
    <span class="s0">const </span><span class="s1">source = { instance, module };</span>
    <span class="s0">return </span><span class="s1">source;</span>
<span class="s1">}</span>

<span class="s0">function </span><span class="s1">createNapiModule(options) {</span>
    <span class="s0">var </span><span class="s1">napiModule = (</span><span class="s0">function </span><span class="s1">() {</span>
        <span class="s0">var </span><span class="s1">ENVIRONMENT_IS_NODE = </span><span class="s0">typeof </span><span class="s1">process === </span><span class="s2">'object' </span><span class="s1">&amp;&amp; process !== </span><span class="s0">null </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">process.versions === </span><span class="s2">'object' </span><span class="s1">&amp;&amp; process.versions !== </span><span class="s0">null </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">process.versions.node === </span><span class="s2">'string'</span><span class="s1">;</span>
        <span class="s0">var </span><span class="s1">ENVIRONMENT_IS_PTHREAD = Boolean(options.childThread);</span>
        <span class="s0">var </span><span class="s1">waitThreadStart = </span><span class="s0">typeof </span><span class="s1">options.waitThreadStart === </span><span class="s2">'number' </span><span class="s1">? options.waitThreadStart : Boolean(options.waitThreadStart);</span>
        <span class="s0">var </span><span class="s1">wasmInstance;</span>
        <span class="s0">var </span><span class="s1">wasmMemory;</span>
        <span class="s0">var </span><span class="s1">wasmTable;</span>
        <span class="s0">var </span><span class="s1">_malloc;</span>
        <span class="s0">var </span><span class="s1">_free;</span>
        <span class="s0">function </span><span class="s1">abort(msg) {</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">_WebAssembly.RuntimeError === </span><span class="s2">'function'</span><span class="s1">) {</span>
                <span class="s0">throw new </span><span class="s1">_WebAssembly.RuntimeError(msg);</span>
            <span class="s1">}</span>
            <span class="s0">throw </span><span class="s1">Error(msg);</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">napiModule = {</span>
            <span class="s1">imports: {</span>
                <span class="s1">env: {},</span>
                <span class="s1">napi: {},</span>
                <span class="s1">emnapi: {}</span>
            <span class="s1">},</span>
            <span class="s1">exports: {},</span>
            <span class="s1">emnapi: {},</span>
            <span class="s1">loaded: </span><span class="s0">false</span><span class="s1">,</span>
            <span class="s1">filename: </span><span class="s2">''</span><span class="s1">,</span>
            <span class="s1">childThread: ENVIRONMENT_IS_PTHREAD,</span>
            <span class="s1">initWorker: undefined,</span>
            <span class="s1">executeAsyncWork: undefined,</span>
            <span class="s1">waitThreadStart: waitThreadStart,</span>
            <span class="s1">PThread: undefined,</span>
            <span class="s1">init: </span><span class="s0">function </span><span class="s1">(options) {</span>
                <span class="s0">if </span><span class="s1">(napiModule.loaded)</span>
                    <span class="s0">return </span><span class="s1">napiModule.exports;</span>
                <span class="s0">if </span><span class="s1">(!options)</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid napi init options'</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">instance = options.instance;</span>
                <span class="s0">if </span><span class="s1">(!(instance === </span><span class="s0">null </span><span class="s1">|| instance === </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">: instance.exports))</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid wasm instance'</span><span class="s1">);</span>
                <span class="s1">wasmInstance = instance;</span>
                <span class="s0">var </span><span class="s1">exports = instance.exports;</span>
                <span class="s0">var </span><span class="s1">module = options.module;</span>
                <span class="s0">var </span><span class="s1">memory = options.memory || exports.memory;</span>
                <span class="s0">var </span><span class="s1">table = options.table || exports.__indirect_function_table;</span>
                <span class="s0">if </span><span class="s1">(!(module </span><span class="s0">instanceof </span><span class="s1">_WebAssembly.Module))</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid wasm module'</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!(memory </span><span class="s0">instanceof </span><span class="s1">_WebAssembly.Memory))</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid wasm memory'</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!(table </span><span class="s0">instanceof </span><span class="s1">_WebAssembly.Table))</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid wasm table'</span><span class="s1">);</span>
                <span class="s1">wasmMemory = memory;</span>
                <span class="s1">wasmTable = table;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">exports.malloc !== </span><span class="s2">'function'</span><span class="s1">)</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'malloc is not exported'</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">exports.free !== </span><span class="s2">'function'</span><span class="s1">)</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'free is not exported'</span><span class="s1">);</span>
                <span class="s1">_malloc = exports.malloc;</span>
                <span class="s1">_free = exports.free;</span>
                <span class="s0">if </span><span class="s1">(!napiModule.childThread) {</span>
                    <span class="s0">var </span><span class="s1">moduleApiVersion = </span><span class="s3">8</span><span class="s1">;</span>
                    <span class="s0">var </span><span class="s1">node_api_module_get_api_version_v1 = instance.exports.node_api_module_get_api_version_v1;</span>
                    <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">node_api_module_get_api_version_v1 === </span><span class="s2">'function'</span><span class="s1">) {</span>
                        <span class="s1">moduleApiVersion = node_api_module_get_api_version_v1();</span>
                    <span class="s1">}</span>
                    <span class="s0">var </span><span class="s1">envObject = napiModule.envObject || (napiModule.envObject = emnapiCtx.createEnv(napiModule.filename, moduleApiVersion, </span><span class="s0">function </span><span class="s1">(cb) { </span><span class="s0">return </span><span class="s1">(wasmTable.get(cb)); }, </span><span class="s0">function </span><span class="s1">(cb) { </span><span class="s0">return </span><span class="s1">(wasmTable.get(cb)); }, abort, emnapiNodeBinding));</span>
                    <span class="s0">var </span><span class="s1">scope_1 = emnapiCtx.openScope(envObject);</span>
                    <span class="s0">try </span><span class="s1">{</span>
                        <span class="s1">envObject.callIntoModule(</span><span class="s0">function </span><span class="s1">(_envObject) {</span>
                            <span class="s0">var </span><span class="s1">exports = napiModule.exports;</span>
                            <span class="s0">var </span><span class="s1">exportsHandle = scope_1.add(exports);</span>
                            <span class="s0">var </span><span class="s1">napi_register_wasm_v1 = instance.exports.napi_register_wasm_v1;</span>
                            <span class="s0">var </span><span class="s1">napiValue = napi_register_wasm_v1(_envObject.id, exportsHandle.id);</span>
                            <span class="s1">napiModule.exports = (!napiValue) ? exports : emnapiCtx.handleStore.get(napiValue).value;</span>
                        <span class="s1">});</span>
                    <span class="s1">}</span>
                    <span class="s0">catch </span><span class="s1">(e) {</span>
                        <span class="s0">if </span><span class="s1">(e !== </span><span class="s2">'unwind'</span><span class="s1">) {</span>
                            <span class="s0">throw </span><span class="s1">e;</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                    <span class="s0">finally </span><span class="s1">{</span>
                        <span class="s1">emnapiCtx.closeScope(envObject, scope_1);</span>
                    <span class="s1">}</span>
                    <span class="s1">napiModule.loaded = </span><span class="s0">true</span><span class="s1">;</span>
                    <span class="s0">delete </span><span class="s1">napiModule.envObject;</span>
                    <span class="s0">return </span><span class="s1">napiModule.exports;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">};</span>
        <span class="s0">var </span><span class="s1">emnapiCtx;</span>
        <span class="s0">var </span><span class="s1">emnapiNodeBinding;</span>
        <span class="s0">var </span><span class="s1">onCreateWorker = undefined;</span>
        <span class="s0">var </span><span class="s1">err;</span>
        <span class="s0">if </span><span class="s1">(!ENVIRONMENT_IS_PTHREAD) {</span>
            <span class="s0">var </span><span class="s1">context = options.context;</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">context !== </span><span class="s2">'object' </span><span class="s1">|| context === </span><span class="s0">null</span><span class="s1">) {</span>
                <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">&quot;Invalid `options.context`. Use `import { getDefaultContext } from '@emnapi/runtime'`&quot;</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s1">emnapiCtx = context;</span>
        <span class="s1">}</span>
        <span class="s0">else </span><span class="s1">{</span>
            <span class="s1">emnapiCtx = options === </span><span class="s0">null </span><span class="s1">|| options === </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">: options.context;</span>
            <span class="s0">var </span><span class="s1">postMsg = </span><span class="s0">typeof </span><span class="s1">options.postMessage === </span><span class="s2">'function'</span>
                <span class="s1">? options.postMessage</span>
                <span class="s1">: </span><span class="s0">typeof </span><span class="s1">postMessage === </span><span class="s2">'function'</span>
                    <span class="s1">? postMessage</span>
                    <span class="s1">: undefined;</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">postMsg !== </span><span class="s2">'function'</span><span class="s1">) {</span>
                <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'No postMessage found'</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s1">napiModule.postMessage = postMsg;</span>
        <span class="s1">}</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">options.filename === </span><span class="s2">'string'</span><span class="s1">) {</span>
            <span class="s1">napiModule.filename = options.filename;</span>
        <span class="s1">}</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">options.onCreateWorker === </span><span class="s2">'function'</span><span class="s1">) {</span>
            <span class="s1">onCreateWorker = options.onCreateWorker;</span>
        <span class="s1">}</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">options.print === </span><span class="s2">'function'</span><span class="s1">) {</span>
            <span class="s1">options.print;</span>
        <span class="s1">}</span>
        <span class="s0">else </span><span class="s1">{</span>
            <span class="s1">console.log.bind(console);</span>
        <span class="s1">}</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">options.printErr === </span><span class="s2">'function'</span><span class="s1">) {</span>
            <span class="s1">err = options.printErr;</span>
        <span class="s1">}</span>
        <span class="s0">else </span><span class="s1">{</span>
            <span class="s1">err = console.warn.bind(console);</span>
        <span class="s1">}</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s2">'nodeBinding' </span><span class="s0">in </span><span class="s1">options) {</span>
            <span class="s0">var </span><span class="s1">nodeBinding = options.nodeBinding;</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">nodeBinding !== </span><span class="s2">'object' </span><span class="s1">|| nodeBinding === </span><span class="s0">null</span><span class="s1">) {</span>
                <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid `options.nodeBinding`. Use @emnapi/node-binding package'</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s1">emnapiNodeBinding = nodeBinding;</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">emnapiAsyncWorkPoolSize = </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s2">'asyncWorkPoolSize' </span><span class="s0">in </span><span class="s1">options) {</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">options.asyncWorkPoolSize !== </span><span class="s2">'number'</span><span class="s1">) {</span>
                <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'options.asyncWorkPoolSize must be a integer'</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s1">emnapiAsyncWorkPoolSize = options.asyncWorkPoolSize &gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">if </span><span class="s1">(emnapiAsyncWorkPoolSize &gt; </span><span class="s3">1024</span><span class="s1">) {</span>
                <span class="s1">emnapiAsyncWorkPoolSize = </span><span class="s3">1024</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(emnapiAsyncWorkPoolSize &lt; -</span><span class="s3">1024</span><span class="s1">) {</span>
                <span class="s1">emnapiAsyncWorkPoolSize = -</span><span class="s3">1024</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">singleThreadAsyncWork = ENVIRONMENT_IS_PTHREAD ? </span><span class="s0">false </span><span class="s1">: (emnapiAsyncWorkPoolSize &lt;= </span><span class="s3">0</span><span class="s1">);</span>
        <span class="s0">function </span><span class="s1">_emnapi_async_work_pool_size() {</span>
            <span class="s0">return </span><span class="s1">Math.abs(emnapiAsyncWorkPoolSize);</span>
        <span class="s1">}</span>
        <span class="s1">napiModule.imports.env._emnapi_async_work_pool_size = _emnapi_async_work_pool_size;</span>
        <span class="s0">function </span><span class="s1">emnapiAddSendListener(worker) {</span>
            <span class="s0">if </span><span class="s1">(!worker)</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s0">if </span><span class="s1">(worker._emnapiSendListener)</span>
                <span class="s0">return true</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">handler = </span><span class="s0">function </span><span class="s1">(e) {</span>
                <span class="s0">var </span><span class="s1">data = ENVIRONMENT_IS_NODE ? e : e.data;</span>
                <span class="s0">var </span><span class="s1">__emnapi__ = data.__emnapi__;</span>
                <span class="s0">if </span><span class="s1">(__emnapi__ &amp;&amp; __emnapi__.type === </span><span class="s2">'async-send'</span><span class="s1">) {</span>
                    <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_PTHREAD) {</span>
                        <span class="s0">var </span><span class="s1">postMessage_1 = napiModule.postMessage;</span>
                        <span class="s1">postMessage_1({ __emnapi__: __emnapi__ });</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s0">var </span><span class="s1">callback = __emnapi__.payload.callback;</span>
                        <span class="s1">(wasmTable.get(callback))(__emnapi__.payload.data);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
            <span class="s1">};</span>
            <span class="s0">var </span><span class="s1">dispose = </span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_NODE) {</span>
                    <span class="s1">worker.off(</span><span class="s2">'message'</span><span class="s1">, handler);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">worker.removeEventListener(</span><span class="s2">'message'</span><span class="s1">, handler, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">delete </span><span class="s1">worker._emnapiSendListener;</span>
            <span class="s1">};</span>
            <span class="s1">worker._emnapiSendListener = { handler: handler, dispose: dispose };</span>
            <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_NODE) {</span>
                <span class="s1">worker.on(</span><span class="s2">'message'</span><span class="s1">, handler);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s1">worker.addEventListener(</span><span class="s2">'message'</span><span class="s1">, handler, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return true</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s1">napiModule.emnapi.addSendListener = emnapiAddSendListener;</span>
        <span class="s0">var </span><span class="s1">PThread = </span><span class="s0">new </span><span class="s1">wasiThreads.ThreadManager(ENVIRONMENT_IS_PTHREAD</span>
            <span class="s1">? {</span>
                <span class="s1">printErr: err,</span>
                <span class="s1">childThread: </span><span class="s0">true</span>
            <span class="s1">}</span>
            <span class="s1">: {</span>
                <span class="s1">printErr: err,</span>
                <span class="s1">beforeLoad: </span><span class="s0">function </span><span class="s1">(worker) {</span>
                    <span class="s1">emnapiAddSendListener(worker);</span>
                <span class="s1">},</span>
                <span class="s1">reuseWorker: options.reuseWorker,</span>
                <span class="s1">onCreateWorker: onCreateWorker</span>
            <span class="s1">});</span>
        <span class="s1">napiModule.PThread = PThread;</span>
        <span class="s0">function </span><span class="s1">napi_set_last_error(env, error_code, engine_error_code, engine_reserved) {</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">return </span><span class="s1">envObject.setLastError(error_code, engine_error_code, engine_reserved);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_clear_last_error(env) {</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_get_node_version(major, minor, patch) {</span>
            <span class="s0">var </span><span class="s1">versions = (</span><span class="s0">typeof </span><span class="s1">process === </span><span class="s2">'object' </span><span class="s1">&amp;&amp; process !== </span><span class="s0">null </span><span class="s1">&amp;&amp;</span>
                <span class="s0">typeof </span><span class="s1">process.versions === </span><span class="s2">'object' </span><span class="s1">&amp;&amp; process.versions !== </span><span class="s0">null </span><span class="s1">&amp;&amp;</span>
                <span class="s0">typeof </span><span class="s1">process.versions.node === </span><span class="s2">'string'</span><span class="s1">)</span>
                <span class="s1">? process.versions.node.split(</span><span class="s2">'.'</span><span class="s1">).map(</span><span class="s0">function </span><span class="s1">(n) { </span><span class="s0">return </span><span class="s1">Number(n); })</span>
                <span class="s1">: [</span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">];</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(major, versions[</span><span class="s3">0</span><span class="s1">], </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(minor, versions[</span><span class="s3">1</span><span class="s1">], </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(patch, versions[</span><span class="s3">2</span><span class="s1">], </span><span class="s0">true</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_runtime_keepalive_push() {</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_runtime_keepalive_pop() {</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_set_immediate(callback, data) {</span>
            <span class="s1">emnapiCtx.feature.setImmediate(</span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s1">(wasmTable.get(callback))(data);</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_next_tick(callback, data) {</span>
            <span class="s1">Promise.resolve().then(</span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s1">(wasmTable.get(callback))(data);</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_callback_into_module(forceUncaught, env, callback, data, close_scope_if_throw) {</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">var </span><span class="s1">scope = emnapiCtx.openScope(envObject);</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s1">envObject.callbackIntoModule(Boolean(forceUncaught), </span><span class="s0">function </span><span class="s1">() {</span>
                    <span class="s1">(wasmTable.get(callback))(env, data);</span>
                <span class="s1">});</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">emnapiCtx.closeScope(envObject, scope);</span>
                <span class="s0">if </span><span class="s1">(close_scope_if_throw) {</span>
                    <span class="s1">emnapiCtx.closeScope(envObject);</span>
                <span class="s1">}</span>
                <span class="s0">throw </span><span class="s1">err;</span>
            <span class="s1">}</span>
            <span class="s1">emnapiCtx.closeScope(envObject, scope);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_call_finalizer(forceUncaught, env, callback, data, hint) {</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.callFinalizerInternal(forceUncaught, callback, data, hint);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_ctx_increase_waiting_request_counter() {</span>
            <span class="s1">emnapiCtx.increaseWaitingRequestCounter();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_ctx_decrease_waiting_request_counter() {</span>
            <span class="s1">emnapiCtx.decreaseWaitingRequestCounter();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_is_main_runtime_thread() {</span>
            <span class="s0">return </span><span class="s1">ENVIRONMENT_IS_PTHREAD ? </span><span class="s3">0 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_is_main_browser_thread() {</span>
            <span class="s0">return </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">window !== </span><span class="s2">'undefined' </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">document !== </span><span class="s2">'undefined' </span><span class="s1">&amp;&amp; !ENVIRONMENT_IS_NODE) ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_unwind() {</span>
            <span class="s0">throw </span><span class="s2">'unwind'</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_get_now() {</span>
            <span class="s0">return </span><span class="s1">performance.timeOrigin + performance.now();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">$emnapiSetValueI64(result, numberValue) {</span>
            <span class="s0">var </span><span class="s1">tempDouble;</span>
            <span class="s0">var </span><span class="s1">tempI64 = [</span>
                <span class="s1">numberValue &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">,</span>
                <span class="s1">(tempDouble = numberValue, +Math.abs(tempDouble) &gt;= </span><span class="s3">1 </span><span class="s1">? tempDouble &gt; </span><span class="s3">0 </span><span class="s1">? (Math.min(+Math.floor(tempDouble / </span><span class="s3">4294967296</span><span class="s1">), </span><span class="s3">4294967295</span><span class="s1">) | </span><span class="s3">0</span><span class="s1">) &gt;&gt;&gt; </span><span class="s3">0 </span><span class="s1">: ~~+Math.ceil((tempDouble - +(~~tempDouble &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">)) / </span><span class="s3">4294967296</span><span class="s1">) &gt;&gt;&gt; </span><span class="s3">0 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">)</span>
            <span class="s1">];</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt32(result, tempI64[</span><span class="s3">0</span><span class="s1">], </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt32(result + </span><span class="s3">4</span><span class="s1">, tempI64[</span><span class="s3">1</span><span class="s1">], </span><span class="s0">true</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_open_handle_scope() {</span>
            <span class="s0">return </span><span class="s1">emnapiCtx.openScope().id;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_close_handle_scope(_scope) {</span>
            <span class="s0">return </span><span class="s1">emnapiCtx.closeScope();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">utilMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">$emnapiSetValueI64: $emnapiSetValueI64,</span>
            <span class="s1">_emnapi_call_finalizer: _emnapi_call_finalizer,</span>
            <span class="s1">_emnapi_callback_into_module: _emnapi_callback_into_module,</span>
            <span class="s1">_emnapi_close_handle_scope: _emnapi_close_handle_scope,</span>
            <span class="s1">_emnapi_ctx_decrease_waiting_request_counter: _emnapi_ctx_decrease_waiting_request_counter,</span>
            <span class="s1">_emnapi_ctx_increase_waiting_request_counter: _emnapi_ctx_increase_waiting_request_counter,</span>
            <span class="s1">_emnapi_get_node_version: _emnapi_get_node_version,</span>
            <span class="s1">_emnapi_get_now: _emnapi_get_now,</span>
            <span class="s1">_emnapi_is_main_browser_thread: _emnapi_is_main_browser_thread,</span>
            <span class="s1">_emnapi_is_main_runtime_thread: _emnapi_is_main_runtime_thread,</span>
            <span class="s1">_emnapi_next_tick: _emnapi_next_tick,</span>
            <span class="s1">_emnapi_open_handle_scope: _emnapi_open_handle_scope,</span>
            <span class="s1">_emnapi_runtime_keepalive_pop: _emnapi_runtime_keepalive_pop,</span>
            <span class="s1">_emnapi_runtime_keepalive_push: _emnapi_runtime_keepalive_push,</span>
            <span class="s1">_emnapi_set_immediate: _emnapi_set_immediate,</span>
            <span class="s1">_emnapi_unwind: _emnapi_unwind,</span>
            <span class="s1">napi_clear_last_error: napi_clear_last_error,</span>
            <span class="s1">napi_set_last_error: napi_set_last_error</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">emnapiGetWorkerByPthreadPtr(pthreadPtr) {</span>
            <span class="s0">var </span><span class="s1">view = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">var </span><span class="s1">tidOffset = </span><span class="s3">20</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">tid = view.getInt32(pthreadPtr + tidOffset, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">worker = PThread.pthreads[tid];</span>
            <span class="s0">return </span><span class="s1">worker;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_worker_unref(pthreadPtr) {</span>
            <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_PTHREAD)</span>
                <span class="s0">return</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">worker = emnapiGetWorkerByPthreadPtr(pthreadPtr);</span>
            <span class="s0">if </span><span class="s1">(worker &amp;&amp; </span><span class="s0">typeof </span><span class="s1">worker.unref === </span><span class="s2">'function'</span><span class="s1">) {</span>
                <span class="s1">worker.unref();</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_async_send_js(type, callback, data) {</span>
            <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_PTHREAD) {</span>
                <span class="s0">var </span><span class="s1">postMessage_1 = napiModule.postMessage;</span>
                <span class="s1">postMessage_1({</span>
                    <span class="s1">__emnapi__: {</span>
                        <span class="s1">type: </span><span class="s2">'async-send'</span><span class="s1">,</span>
                        <span class="s1">payload: {</span>
                            <span class="s1">callback: callback,</span>
                            <span class="s1">data: data</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                <span class="s1">});</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s0">switch </span><span class="s1">(type) {</span>
                    <span class="s0">case </span><span class="s3">0</span><span class="s1">:</span>
                        <span class="s1">_emnapi_set_immediate(callback, data);</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s3">1</span><span class="s1">:</span>
                        <span class="s1">_emnapi_next_tick(callback, data);</span>
                        <span class="s0">break</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">uvThreadpoolReadyResolve;</span>
        <span class="s0">var </span><span class="s1">uvThreadpoolReady = </span><span class="s0">new </span><span class="s1">Promise(</span><span class="s0">function </span><span class="s1">(resolve) {</span>
            <span class="s1">uvThreadpoolReadyResolve = </span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s1">uvThreadpoolReady.ready = </span><span class="s0">true</span><span class="s1">;</span>
                <span class="s1">resolve();</span>
            <span class="s1">};</span>
        <span class="s1">});</span>
        <span class="s1">uvThreadpoolReady.ready = </span><span class="s0">false</span><span class="s1">;</span>
        <span class="s0">function </span><span class="s1">_emnapi_after_uvthreadpool_ready(callback, q, type) {</span>
            <span class="s0">if </span><span class="s1">(uvThreadpoolReady.ready) {</span>
                <span class="s1">(wasmTable.get(callback))(q, type);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s1">uvThreadpoolReady.then(</span><span class="s0">function </span><span class="s1">() {</span>
                    <span class="s1">(wasmTable.get(callback))(q, type);</span>
                <span class="s1">});</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_tell_js_uvthreadpool(threads, size) {</span>
            <span class="s0">var </span><span class="s1">p = [];</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">var </span><span class="s1">_loop_1 = </span><span class="s0">function </span><span class="s1">(i) {</span>
                <span class="s0">var </span><span class="s1">pthreadPtr = HEAP_DATA_VIEW.getUint32(threads + i * </span><span class="s3">4</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">worker = emnapiGetWorkerByPthreadPtr(pthreadPtr);</span>
                <span class="s1">p.push(</span><span class="s0">new </span><span class="s1">Promise(</span><span class="s0">function </span><span class="s1">(resolve) {</span>
                    <span class="s0">var </span><span class="s1">handler = </span><span class="s0">function </span><span class="s1">(e) {</span>
                        <span class="s0">var </span><span class="s1">data = ENVIRONMENT_IS_NODE ? e : e.data;</span>
                        <span class="s0">var </span><span class="s1">__emnapi__ = data.__emnapi__;</span>
                        <span class="s0">if </span><span class="s1">(__emnapi__ &amp;&amp; __emnapi__.type === </span><span class="s2">'async-thread-ready'</span><span class="s1">) {</span>
                            <span class="s1">resolve();</span>
                            <span class="s0">if </span><span class="s1">(worker &amp;&amp; </span><span class="s0">typeof </span><span class="s1">worker.unref === </span><span class="s2">'function'</span><span class="s1">) {</span>
                                <span class="s1">worker.unref();</span>
                            <span class="s1">}</span>
                            <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_NODE) {</span>
                                <span class="s1">worker.off(</span><span class="s2">'message'</span><span class="s1">, handler);</span>
                            <span class="s1">}</span>
                            <span class="s0">else </span><span class="s1">{</span>
                                <span class="s1">worker.removeEventListener(</span><span class="s2">'message'</span><span class="s1">, handler);</span>
                            <span class="s1">}</span>
                        <span class="s1">}</span>
                    <span class="s1">};</span>
                    <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_NODE) {</span>
                        <span class="s1">worker.on(</span><span class="s2">'message'</span><span class="s1">, handler);</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s1">worker.addEventListener(</span><span class="s2">'message'</span><span class="s1">, handler);</span>
                    <span class="s1">}</span>
                <span class="s1">}));</span>
            <span class="s1">};</span>
            <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; size; i++) {</span>
                <span class="s1">_loop_1(i);</span>
            <span class="s1">}</span>
            <span class="s1">Promise.all(p).then(uvThreadpoolReadyResolve);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_emit_async_thread_ready() {</span>
            <span class="s0">if </span><span class="s1">(!ENVIRONMENT_IS_PTHREAD)</span>
                <span class="s0">return</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">postMessage = napiModule.postMessage;</span>
            <span class="s1">postMessage({</span>
                <span class="s1">__emnapi__: {</span>
                    <span class="s1">type: </span><span class="s2">'async-thread-ready'</span><span class="s1">,</span>
                    <span class="s1">payload: {}</span>
                <span class="s1">}</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">asyncMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">_emnapi_after_uvthreadpool_ready: _emnapi_after_uvthreadpool_ready,</span>
            <span class="s1">_emnapi_async_send_js: _emnapi_async_send_js,</span>
            <span class="s1">_emnapi_emit_async_thread_ready: _emnapi_emit_async_thread_ready,</span>
            <span class="s1">_emnapi_tell_js_uvthreadpool: _emnapi_tell_js_uvthreadpool,</span>
            <span class="s1">_emnapi_worker_unref: _emnapi_worker_unref</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_adjust_external_memory(env, change_in_bytes, adjusted_value) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">if </span><span class="s1">(!adjusted_value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">change_in_bytes_number = Number(change_in_bytes);</span>
            <span class="s0">if </span><span class="s1">(change_in_bytes_number &lt; </span><span class="s3">0</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">old_size = wasmMemory.buffer.byteLength;</span>
            <span class="s0">var </span><span class="s1">new_size = old_size + change_in_bytes_number;</span>
            <span class="s1">new_size = new_size + ((</span><span class="s3">65536 </span><span class="s1">- new_size % </span><span class="s3">65536</span><span class="s1">) % </span><span class="s3">65536</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(wasmMemory.grow((new_size - old_size + </span><span class="s3">65535</span><span class="s1">) &gt;&gt; </span><span class="s3">16</span><span class="s1">) === -</span><span class="s3">1</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(emnapiCtx.feature.supportBigInt) {</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setBigInt64(adjusted_value, BigInt(wasmMemory.buffer.byteLength), </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s1">$emnapiSetValueI64(adjusted_value, wasmMemory.buffer.byteLength);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">memoryMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_adjust_external_memory: napi_adjust_external_memory</span>
        <span class="s1">});</span>
        <span class="s0">var </span><span class="s1">emnapiAWST = {</span>
            <span class="s1">idGen: {},</span>
            <span class="s1">values: [undefined],</span>
            <span class="s1">queued: </span><span class="s0">new </span><span class="s1">Set(),</span>
            <span class="s1">pending: [],</span>
            <span class="s1">init: </span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s0">var </span><span class="s1">idGen = {</span>
                    <span class="s1">nextId: </span><span class="s3">1</span><span class="s1">,</span>
                    <span class="s1">list: [],</span>
                    <span class="s1">generate: </span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s0">var </span><span class="s1">id;</span>
                        <span class="s0">if </span><span class="s1">(idGen.list.length) {</span>
                            <span class="s1">id = idGen.list.shift();</span>
                        <span class="s1">}</span>
                        <span class="s0">else </span><span class="s1">{</span>
                            <span class="s1">id = idGen.nextId;</span>
                            <span class="s1">idGen.nextId++;</span>
                        <span class="s1">}</span>
                        <span class="s0">return </span><span class="s1">id;</span>
                    <span class="s1">},</span>
                    <span class="s1">reuse: </span><span class="s0">function </span><span class="s1">(id) {</span>
                        <span class="s1">idGen.list.push(id);</span>
                    <span class="s1">}</span>
                <span class="s1">};</span>
                <span class="s1">emnapiAWST.idGen = idGen;</span>
                <span class="s1">emnapiAWST.values = [undefined];</span>
                <span class="s1">emnapiAWST.queued = </span><span class="s0">new </span><span class="s1">Set();</span>
                <span class="s1">emnapiAWST.pending = [];</span>
            <span class="s1">},</span>
            <span class="s1">create: </span><span class="s0">function </span><span class="s1">(env, resource, resourceName, execute, complete, data) {</span>
                <span class="s0">var </span><span class="s1">asyncId = </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">triggerAsyncId = </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(emnapiNodeBinding) {</span>
                    <span class="s0">var </span><span class="s1">asyncContext = emnapiNodeBinding.node.emitAsyncInit(resource, resourceName, -</span><span class="s3">1</span><span class="s1">);</span>
                    <span class="s1">asyncId = asyncContext.asyncId;</span>
                    <span class="s1">triggerAsyncId = asyncContext.triggerAsyncId;</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">id = emnapiAWST.idGen.generate();</span>
                <span class="s1">emnapiAWST.values[id] = {</span>
                    <span class="s1">env: env,</span>
                    <span class="s1">id: id,</span>
                    <span class="s1">resource: resource,</span>
                    <span class="s1">asyncId: asyncId,</span>
                    <span class="s1">triggerAsyncId: triggerAsyncId,</span>
                    <span class="s1">status: </span><span class="s3">0</span><span class="s1">,</span>
                    <span class="s1">execute: execute,</span>
                    <span class="s1">complete: complete,</span>
                    <span class="s1">data: data</span>
                <span class="s1">};</span>
                <span class="s0">return </span><span class="s1">id;</span>
            <span class="s1">},</span>
            <span class="s1">callComplete: </span><span class="s0">function </span><span class="s1">(work, status) {</span>
                <span class="s0">var </span><span class="s1">complete = work.complete;</span>
                <span class="s0">var </span><span class="s1">env = work.env;</span>
                <span class="s0">var </span><span class="s1">data = work.data;</span>
                <span class="s0">var </span><span class="s1">callback = </span><span class="s0">function </span><span class="s1">() {</span>
                    <span class="s0">if </span><span class="s1">(!complete)</span>
                        <span class="s0">return</span><span class="s1">;</span>
                    <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                    <span class="s0">var </span><span class="s1">scope = emnapiCtx.openScope(envObject);</span>
                    <span class="s0">try </span><span class="s1">{</span>
                        <span class="s1">envObject.callbackIntoModule(</span><span class="s0">true</span><span class="s1">, </span><span class="s0">function </span><span class="s1">() {</span>
                            <span class="s1">(wasmTable.get(complete))(env, status, data);</span>
                        <span class="s1">});</span>
                    <span class="s1">}</span>
                    <span class="s0">finally </span><span class="s1">{</span>
                        <span class="s1">emnapiCtx.closeScope(envObject, scope);</span>
                    <span class="s1">}</span>
                <span class="s1">};</span>
                <span class="s0">if </span><span class="s1">(emnapiNodeBinding) {</span>
                    <span class="s1">emnapiNodeBinding.node.makeCallback(work.resource, callback, [], {</span>
                        <span class="s1">asyncId: work.asyncId,</span>
                        <span class="s1">triggerAsyncId: work.triggerAsyncId</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">callback();</span>
                <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s1">queue: </span><span class="s0">function </span><span class="s1">(id) {</span>
                <span class="s0">var </span><span class="s1">work = emnapiAWST.values[id];</span>
                <span class="s0">if </span><span class="s1">(!work)</span>
                    <span class="s0">return</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(work.status === </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s1">work.status = </span><span class="s3">1</span><span class="s1">;</span>
                    <span class="s0">if </span><span class="s1">(emnapiAWST.queued.size &gt;= (Math.abs(emnapiAsyncWorkPoolSize) || </span><span class="s3">4</span><span class="s1">)) {</span>
                        <span class="s1">emnapiAWST.pending.push(id);</span>
                        <span class="s0">return</span><span class="s1">;</span>
                    <span class="s1">}</span>
                    <span class="s1">emnapiAWST.queued.add(id);</span>
                    <span class="s0">var </span><span class="s1">env_1 = work.env;</span>
                    <span class="s0">var </span><span class="s1">data_1 = work.data;</span>
                    <span class="s0">var </span><span class="s1">execute = work.execute;</span>
                    <span class="s1">work.status = </span><span class="s3">2</span><span class="s1">;</span>
                    <span class="s1">emnapiCtx.feature.setImmediate(</span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s1">(wasmTable.get(execute))(env_1, data_1);</span>
                        <span class="s1">emnapiAWST.queued.delete(id);</span>
                        <span class="s1">work.status = </span><span class="s3">3</span><span class="s1">;</span>
                        <span class="s1">emnapiCtx.feature.setImmediate(</span><span class="s0">function </span><span class="s1">() {</span>
                            <span class="s1">emnapiAWST.callComplete(work, </span><span class="s3">0</span><span class="s1">);</span>
                        <span class="s1">});</span>
                        <span class="s0">if </span><span class="s1">(emnapiAWST.pending.length &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                            <span class="s0">var </span><span class="s1">nextWorkId = emnapiAWST.pending.shift();</span>
                            <span class="s1">emnapiAWST.values[nextWorkId].status = </span><span class="s3">0</span><span class="s1">;</span>
                            <span class="s1">emnapiAWST.queue(nextWorkId);</span>
                        <span class="s1">}</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s1">cancel: </span><span class="s0">function </span><span class="s1">(id) {</span>
                <span class="s0">var </span><span class="s1">index = emnapiAWST.pending.indexOf(id);</span>
                <span class="s0">if </span><span class="s1">(index !== -</span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s0">var </span><span class="s1">work_1 = emnapiAWST.values[id];</span>
                    <span class="s0">if </span><span class="s1">(work_1 &amp;&amp; (work_1.status === </span><span class="s3">1</span><span class="s1">)) {</span>
                        <span class="s1">work_1.status = </span><span class="s3">4</span><span class="s1">;</span>
                        <span class="s1">emnapiAWST.pending.splice(index, </span><span class="s3">1</span><span class="s1">);</span>
                        <span class="s1">emnapiCtx.feature.setImmediate(</span><span class="s0">function </span><span class="s1">() {</span>
                            <span class="s1">emnapiAWST.callComplete(work_1, </span><span class="s3">11</span><span class="s1">);</span>
                        <span class="s1">});</span>
                        <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s0">return </span><span class="s3">9</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s3">9</span><span class="s1">;</span>
            <span class="s1">},</span>
            <span class="s1">remove: </span><span class="s0">function </span><span class="s1">(id) {</span>
                <span class="s0">var </span><span class="s1">work = emnapiAWST.values[id];</span>
                <span class="s0">if </span><span class="s1">(!work)</span>
                    <span class="s0">return</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(emnapiNodeBinding) {</span>
                    <span class="s1">emnapiNodeBinding.node.emitAsyncDestroy({</span>
                        <span class="s1">asyncId: work.asyncId,</span>
                        <span class="s1">triggerAsyncId: work.triggerAsyncId</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
                <span class="s1">emnapiAWST.values[id] = undefined;</span>
                <span class="s1">emnapiAWST.idGen.reuse(id);</span>
            <span class="s1">}</span>
        <span class="s1">};</span>
        <span class="s0">function </span><span class="s1">_emnapi_node_emit_async_init(async_resource, async_resource_name, trigger_async_id, result) {</span>
            <span class="s0">if </span><span class="s1">(!emnapiNodeBinding)</span>
                <span class="s0">return</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">resource = emnapiCtx.handleStore.get(async_resource).value;</span>
            <span class="s0">var </span><span class="s1">resource_name = emnapiCtx.handleStore.get(async_resource_name).value;</span>
            <span class="s0">var </span><span class="s1">asyncContext = emnapiNodeBinding.node.emitAsyncInit(resource, resource_name, trigger_async_id);</span>
            <span class="s0">var </span><span class="s1">asyncId = asyncContext.asyncId;</span>
            <span class="s0">var </span><span class="s1">triggerAsyncId = asyncContext.triggerAsyncId;</span>
            <span class="s0">if </span><span class="s1">(result) {</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setFloat64(result, asyncId, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">HEAP_DATA_VIEW.setFloat64(result + </span><span class="s3">8</span><span class="s1">, triggerAsyncId, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_node_emit_async_destroy(async_id, trigger_async_id) {</span>
            <span class="s0">if </span><span class="s1">(!emnapiNodeBinding)</span>
                <span class="s0">return</span><span class="s1">;</span>
            <span class="s1">emnapiNodeBinding.node.emitAsyncDestroy({</span>
                <span class="s1">asyncId: async_id,</span>
                <span class="s1">triggerAsyncId: trigger_async_id</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_node_make_callback(env, async_resource, cb, argv, size, async_id, trigger_async_id, result) {</span>
            <span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">v;</span>
            <span class="s0">if </span><span class="s1">(!emnapiNodeBinding)</span>
                <span class="s0">return</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">resource = emnapiCtx.handleStore.get(async_resource).value;</span>
            <span class="s0">var </span><span class="s1">callback = emnapiCtx.handleStore.get(cb).value;</span>
            <span class="s1">size = size &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">arr = Array(size);</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">for </span><span class="s1">(; i &lt; size; i++) {</span>
                <span class="s0">var </span><span class="s1">argVal = HEAP_DATA_VIEW.getUint32(argv + i * </span><span class="s3">4</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">arr[i] = emnapiCtx.handleStore.get(argVal).value;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">ret = emnapiNodeBinding.node.makeCallback(resource, callback, arr, {</span>
                <span class="s1">asyncId: async_id,</span>
                <span class="s1">triggerAsyncId: trigger_async_id</span>
            <span class="s1">});</span>
            <span class="s0">if </span><span class="s1">(result) {</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s1">v = envObject.ensureHandleId(ret);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_async_init_js(async_resource, async_resource_name, result) {</span>
            <span class="s0">if </span><span class="s1">(!emnapiNodeBinding) {</span>
                <span class="s0">return </span><span class="s3">9</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">resource;</span>
            <span class="s0">if </span><span class="s1">(async_resource) {</span>
                <span class="s1">resource = Object(emnapiCtx.handleStore.get(async_resource).value);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">name = emnapiCtx.handleStore.get(async_resource_name).value;</span>
            <span class="s0">var </span><span class="s1">ret = emnapiNodeBinding.napi.asyncInit(resource, name);</span>
            <span class="s0">if </span><span class="s1">(ret.status !== </span><span class="s3">0</span><span class="s1">)</span>
                <span class="s0">return </span><span class="s1">ret.status;</span>
            <span class="s0">var </span><span class="s1">numberValue = ret.value;</span>
            <span class="s0">if </span><span class="s1">(!((numberValue &gt;= (BigInt(-</span><span class="s3">1</span><span class="s1">) * (BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">63</span><span class="s1">)))) &amp;&amp; (numberValue &lt; (BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">63</span><span class="s1">))))) {</span>
                <span class="s1">numberValue = numberValue &amp; ((BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">64</span><span class="s1">)) - BigInt(</span><span class="s3">1</span><span class="s1">));</span>
                <span class="s0">if </span><span class="s1">(numberValue &gt;= (BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">63</span><span class="s1">))) {</span>
                    <span class="s1">numberValue = numberValue - (BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">64</span><span class="s1">));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">low = Number(numberValue &amp; BigInt(</span><span class="s3">0xffffffff</span><span class="s1">));</span>
            <span class="s0">var </span><span class="s1">high = Number(numberValue &gt;&gt; BigInt(</span><span class="s3">32</span><span class="s1">));</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt32(result, low, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt32(result + </span><span class="s3">4</span><span class="s1">, high, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_async_destroy_js(async_context) {</span>
            <span class="s0">if </span><span class="s1">(!emnapiNodeBinding) {</span>
                <span class="s0">return </span><span class="s3">9</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">var </span><span class="s1">low = HEAP_DATA_VIEW.getInt32(async_context, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">high = HEAP_DATA_VIEW.getInt32(async_context + </span><span class="s3">4</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">pointer = BigInt(low &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">) | (BigInt(high) &lt;&lt; BigInt(</span><span class="s3">32</span><span class="s1">));</span>
            <span class="s0">var </span><span class="s1">ret = emnapiNodeBinding.napi.asyncDestroy(pointer);</span>
            <span class="s0">if </span><span class="s1">(ret.status !== </span><span class="s3">0</span><span class="s1">)</span>
                <span class="s0">return </span><span class="s1">ret.status;</span>
            <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_open_callback_scope(env, ignored, async_context_handle, result) {</span>
            <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'napi_open_callback_scope has not been implemented yet'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_close_callback_scope(env, scope) {</span>
            <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'napi_close_callback_scope has not been implemented yet'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_make_callback(env, async_context, recv, func, argc, argv, result) {</span>
            <span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">v;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!emnapiNodeBinding) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!recv)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(argc &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">if </span><span class="s1">(!argv)</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v8recv = Object(emnapiCtx.handleStore.get(recv).value);</span>
                <span class="s0">var </span><span class="s1">v8func = emnapiCtx.handleStore.get(func).value;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">v8func !== </span><span class="s2">'function'</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">var </span><span class="s1">low = HEAP_DATA_VIEW.getInt32(async_context, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">high = HEAP_DATA_VIEW.getInt32(async_context + </span><span class="s3">4</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">ctx = BigInt(low &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">) | (BigInt(high) &lt;&lt; BigInt(</span><span class="s3">32</span><span class="s1">));</span>
                <span class="s1">argc = argc &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">arr = Array(argc);</span>
                <span class="s0">for </span><span class="s1">(; i &lt; argc; i++) {</span>
                    <span class="s0">var </span><span class="s1">argVal = HEAP_DATA_VIEW.getUint32(argv + i * </span><span class="s3">4</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">arr[i] = emnapiCtx.handleStore.get(argVal).value;</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">ret = emnapiNodeBinding.napi.makeCallback(ctx, v8recv, v8func, arr);</span>
                <span class="s0">if </span><span class="s1">(ret.error) {</span>
                    <span class="s0">throw </span><span class="s1">ret.error;</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(ret.status !== </span><span class="s3">0</span><span class="s1">)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(ret.status);</span>
                <span class="s0">if </span><span class="s1">(result) {</span>
                    <span class="s1">v = envObject.ensureHandleId(ret.value);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_env_check_gc_access(env) {</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">nodeMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">_emnapi_async_destroy_js: _emnapi_async_destroy_js,</span>
            <span class="s1">_emnapi_async_init_js: _emnapi_async_init_js,</span>
            <span class="s1">_emnapi_env_check_gc_access: _emnapi_env_check_gc_access,</span>
            <span class="s1">_emnapi_node_emit_async_destroy: _emnapi_node_emit_async_destroy,</span>
            <span class="s1">_emnapi_node_emit_async_init: _emnapi_node_emit_async_init,</span>
            <span class="s1">_emnapi_node_make_callback: _emnapi_node_make_callback,</span>
            <span class="s1">napi_close_callback_scope: napi_close_callback_scope,</span>
            <span class="s1">napi_make_callback: napi_make_callback,</span>
            <span class="s1">napi_open_callback_scope: napi_open_callback_scope</span>
        <span class="s1">});</span>
        <span class="s0">var </span><span class="s1">emnapiTSFN = {</span>
            <span class="s1">offset: {</span>
                <span class="s1">resource: </span><span class="s3">0</span><span class="s1">,</span>
                <span class="s1">async_id: </span><span class="s3">8</span><span class="s1">,</span>
                <span class="s1">trigger_async_id: </span><span class="s3">16</span><span class="s1">,</span>
                <span class="s1">queue_size: </span><span class="s3">24</span><span class="s1">,</span>
                <span class="s1">queue: </span><span class="s3">1 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">24</span><span class="s1">,</span>
                <span class="s1">thread_count: </span><span class="s3">2 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">24</span><span class="s1">,</span>
                <span class="s1">is_closing: </span><span class="s3">3 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">24</span><span class="s1">,</span>
                <span class="s1">dispatch_state: </span><span class="s3">3 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">28</span><span class="s1">,</span>
                <span class="s1">context: </span><span class="s3">3 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">32</span><span class="s1">,</span>
                <span class="s1">max_queue_size: </span><span class="s3">4 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">32</span><span class="s1">,</span>
                <span class="s1">ref: </span><span class="s3">5 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">32</span><span class="s1">,</span>
                <span class="s1">env: </span><span class="s3">6 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">32</span><span class="s1">,</span>
                <span class="s1">finalize_data: </span><span class="s3">7 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">32</span><span class="s1">,</span>
                <span class="s1">finalize_cb: </span><span class="s3">8 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">32</span><span class="s1">,</span>
                <span class="s1">call_js_cb: </span><span class="s3">9 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">32</span><span class="s1">,</span>
                <span class="s1">handles_closing: </span><span class="s3">10 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">32</span><span class="s1">,</span>
                <span class="s1">async_ref: </span><span class="s3">10 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">36</span><span class="s1">,</span>
                <span class="s1">mutex: </span><span class="s3">10 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">40</span><span class="s1">,</span>
                <span class="s1">cond: </span><span class="s3">10 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">44</span><span class="s1">,</span>
                <span class="s1">end: </span><span class="s3">10 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">48</span>
            <span class="s1">},</span>
            <span class="s1">init: </span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">PThread !== </span><span class="s2">'undefined'</span><span class="s1">) {</span>
                    <span class="s1">PThread.unusedWorkers.forEach(emnapiTSFN.addListener);</span>
                    <span class="s1">PThread.runningWorkers.forEach(emnapiTSFN.addListener);</span>
                    <span class="s0">var </span><span class="s1">__original_getNewWorker_1 = PThread.getNewWorker;</span>
                    <span class="s1">PThread.getNewWorker = </span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s0">var </span><span class="s1">r = __original_getNewWorker_1.apply(</span><span class="s0">this</span><span class="s1">, arguments);</span>
                        <span class="s1">emnapiTSFN.addListener(r);</span>
                        <span class="s0">return </span><span class="s1">r;</span>
                    <span class="s1">};</span>
                <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s1">addListener: </span><span class="s0">function </span><span class="s1">(worker) {</span>
                <span class="s0">if </span><span class="s1">(!worker)</span>
                    <span class="s0">return false</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(worker._emnapiTSFNListener)</span>
                    <span class="s0">return true</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">handler = </span><span class="s0">function </span><span class="s1">(e) {</span>
                    <span class="s0">var </span><span class="s1">data = ENVIRONMENT_IS_NODE ? e : e.data;</span>
                    <span class="s0">var </span><span class="s1">__emnapi__ = data.__emnapi__;</span>
                    <span class="s0">if </span><span class="s1">(__emnapi__) {</span>
                        <span class="s0">var </span><span class="s1">type = __emnapi__.type;</span>
                        <span class="s0">var </span><span class="s1">payload = __emnapi__.payload;</span>
                        <span class="s0">if </span><span class="s1">(type === </span><span class="s2">'tsfn-send'</span><span class="s1">) {</span>
                            <span class="s1">emnapiTSFN.dispatch(payload.tsfn);</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                <span class="s1">};</span>
                <span class="s0">var </span><span class="s1">dispose = </span><span class="s0">function </span><span class="s1">() {</span>
                    <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_NODE) {</span>
                        <span class="s1">worker.off(</span><span class="s2">'message'</span><span class="s1">, handler);</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s1">worker.removeEventListener(</span><span class="s2">'message'</span><span class="s1">, handler, </span><span class="s0">false</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s0">delete </span><span class="s1">worker._emnapiTSFNListener;</span>
                <span class="s1">};</span>
                <span class="s1">worker._emnapiTSFNListener = { handler: handler, dispose: dispose };</span>
                <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_NODE) {</span>
                    <span class="s1">worker.on(</span><span class="s2">'message'</span><span class="s1">, handler);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">worker.addEventListener(</span><span class="s2">'message'</span><span class="s1">, handler, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return true</span><span class="s1">;</span>
            <span class="s1">},</span>
            <span class="s1">initQueue: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">size = </span><span class="s3">2 </span><span class="s1">* </span><span class="s3">4</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">queue = _malloc(size);</span>
                <span class="s0">if </span><span class="s1">(!queue)</span>
                    <span class="s0">return false</span><span class="s1">;</span>
                <span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer, queue, size).fill(</span><span class="s3">0</span><span class="s1">);</span>
                <span class="s1">emnapiTSFN.storeSizeTypeValue(func + emnapiTSFN.offset.queue, queue, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s0">return true</span><span class="s1">;</span>
            <span class="s1">},</span>
            <span class="s1">destroyQueue: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">queue = emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.queue, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(queue) {</span>
                    <span class="s1">_free(queue);</span>
                <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s1">pushQueue: </span><span class="s0">function </span><span class="s1">(func, data) {</span>
                <span class="s0">var </span><span class="s1">queue = emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.queue, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">head = emnapiTSFN.loadSizeTypeValue(queue, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">tail = emnapiTSFN.loadSizeTypeValue(queue + </span><span class="s3">4</span><span class="s1">, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">size = </span><span class="s3">2 </span><span class="s1">* </span><span class="s3">4</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">node = _malloc(size);</span>
                <span class="s0">if </span><span class="s1">(!node)</span>
                    <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'OOM'</span><span class="s1">);</span>
                <span class="s1">emnapiTSFN.storeSizeTypeValue(node, data, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s1">emnapiTSFN.storeSizeTypeValue(node + </span><span class="s3">4</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(head === </span><span class="s3">0 </span><span class="s1">&amp;&amp; tail === </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s1">emnapiTSFN.storeSizeTypeValue(queue, node, </span><span class="s0">false</span><span class="s1">);</span>
                    <span class="s1">emnapiTSFN.storeSizeTypeValue(queue + </span><span class="s3">4</span><span class="s1">, node, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">emnapiTSFN.storeSizeTypeValue(tail + </span><span class="s3">4</span><span class="s1">, node, </span><span class="s0">false</span><span class="s1">);</span>
                    <span class="s1">emnapiTSFN.storeSizeTypeValue(queue + </span><span class="s3">4</span><span class="s1">, node, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">emnapiTSFN.addQueueSize(func);</span>
            <span class="s1">},</span>
            <span class="s1">shiftQueue: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">queue = emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.queue, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">head = emnapiTSFN.loadSizeTypeValue(queue, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(head === </span><span class="s3">0</span><span class="s1">)</span>
                    <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">node = head;</span>
                <span class="s0">var </span><span class="s1">next = emnapiTSFN.loadSizeTypeValue(head + </span><span class="s3">4</span><span class="s1">, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s1">emnapiTSFN.storeSizeTypeValue(queue, next, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(next === </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s1">emnapiTSFN.storeSizeTypeValue(queue + </span><span class="s3">4</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">emnapiTSFN.storeSizeTypeValue(node + </span><span class="s3">4</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">value = emnapiTSFN.loadSizeTypeValue(node, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s1">_free(node);</span>
                <span class="s1">emnapiTSFN.subQueueSize(func);</span>
                <span class="s0">return </span><span class="s1">value;</span>
            <span class="s1">},</span>
            <span class="s1">push: </span><span class="s0">function </span><span class="s1">(func, data, mode) {</span>
                <span class="s0">var </span><span class="s1">mutex = emnapiTSFN.getMutex(func);</span>
                <span class="s0">var </span><span class="s1">cond = emnapiTSFN.getCond(func);</span>
                <span class="s0">var </span><span class="s1">waitCondition = </span><span class="s0">function </span><span class="s1">() {</span>
                    <span class="s0">var </span><span class="s1">queueSize = emnapiTSFN.getQueueSize(func);</span>
                    <span class="s0">var </span><span class="s1">maxSize = emnapiTSFN.getMaxQueueSize(func);</span>
                    <span class="s0">var </span><span class="s1">isClosing = emnapiTSFN.getIsClosing(func);</span>
                    <span class="s0">return </span><span class="s1">queueSize &gt;= maxSize &amp;&amp; maxSize &gt; </span><span class="s3">0 </span><span class="s1">&amp;&amp; !isClosing;</span>
                <span class="s1">};</span>
                <span class="s0">var </span><span class="s1">isBrowserMain = </span><span class="s0">typeof </span><span class="s1">window !== </span><span class="s2">'undefined' </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">document !== </span><span class="s2">'undefined' </span><span class="s1">&amp;&amp; !ENVIRONMENT_IS_NODE;</span>
                <span class="s0">return </span><span class="s1">mutex.execute(</span><span class="s0">function </span><span class="s1">() {</span>
                    <span class="s0">while </span><span class="s1">(waitCondition()) {</span>
                        <span class="s0">if </span><span class="s1">(mode === </span><span class="s3">0</span><span class="s1">) {</span>
                            <span class="s0">return </span><span class="s3">15</span><span class="s1">;</span>
                        <span class="s1">}</span>
                        <span class="s0">if </span><span class="s1">(isBrowserMain) {</span>
                            <span class="s0">return </span><span class="s3">21</span><span class="s1">;</span>
                        <span class="s1">}</span>
                        <span class="s1">cond.wait();</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(emnapiTSFN.getIsClosing(func)) {</span>
                        <span class="s0">if </span><span class="s1">(emnapiTSFN.getThreadCount(func) === </span><span class="s3">0</span><span class="s1">) {</span>
                            <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                        <span class="s1">}</span>
                        <span class="s0">else </span><span class="s1">{</span>
                            <span class="s1">emnapiTSFN.subThreadCount(func);</span>
                            <span class="s0">return </span><span class="s3">16</span><span class="s1">;</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s1">emnapiTSFN.pushQueue(func, data);</span>
                        <span class="s1">emnapiTSFN.send(func);</span>
                        <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">});</span>
            <span class="s1">},</span>
            <span class="s1">getMutex: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">index = func + emnapiTSFN.offset.mutex;</span>
                <span class="s0">var </span><span class="s1">mutex = {</span>
                    <span class="s1">lock: </span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s0">var </span><span class="s1">isBrowserMain = </span><span class="s0">typeof </span><span class="s1">window !== </span><span class="s2">'undefined' </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">document !== </span><span class="s2">'undefined' </span><span class="s1">&amp;&amp; !ENVIRONMENT_IS_NODE;</span>
                        <span class="s0">var </span><span class="s1">i32a = </span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer, index, </span><span class="s3">1</span><span class="s1">);</span>
                        <span class="s0">if </span><span class="s1">(isBrowserMain) {</span>
                            <span class="s0">while </span><span class="s1">(</span><span class="s0">true</span><span class="s1">) {</span>
                                <span class="s0">var </span><span class="s1">oldValue = Atomics.compareExchange(i32a, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s1">);</span>
                                <span class="s0">if </span><span class="s1">(oldValue === </span><span class="s3">0</span><span class="s1">) {</span>
                                    <span class="s0">return</span><span class="s1">;</span>
                                <span class="s1">}</span>
                            <span class="s1">}</span>
                        <span class="s1">}</span>
                        <span class="s0">else </span><span class="s1">{</span>
                            <span class="s0">while </span><span class="s1">(</span><span class="s0">true</span><span class="s1">) {</span>
                                <span class="s0">var </span><span class="s1">oldValue = Atomics.compareExchange(i32a, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s1">);</span>
                                <span class="s0">if </span><span class="s1">(oldValue === </span><span class="s3">0</span><span class="s1">) {</span>
                                    <span class="s0">return</span><span class="s1">;</span>
                                <span class="s1">}</span>
                                <span class="s1">Atomics.wait(i32a, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s1">);</span>
                            <span class="s1">}</span>
                        <span class="s1">}</span>
                    <span class="s1">},</span>
                    <span class="s1">unlock: </span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s0">var </span><span class="s1">i32a = </span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer, index, </span><span class="s3">1</span><span class="s1">);</span>
                        <span class="s0">var </span><span class="s1">oldValue = Atomics.compareExchange(i32a, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s1">);</span>
                        <span class="s0">if </span><span class="s1">(oldValue !== </span><span class="s3">1</span><span class="s1">) {</span>
                            <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'Tried to unlock while not holding the mutex'</span><span class="s1">);</span>
                        <span class="s1">}</span>
                        <span class="s1">Atomics.notify(i32a, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s1">);</span>
                    <span class="s1">},</span>
                    <span class="s1">execute: </span><span class="s0">function </span><span class="s1">(fn) {</span>
                        <span class="s1">mutex.lock();</span>
                        <span class="s0">try </span><span class="s1">{</span>
                            <span class="s0">return </span><span class="s1">fn();</span>
                        <span class="s1">}</span>
                        <span class="s0">finally </span><span class="s1">{</span>
                            <span class="s1">mutex.unlock();</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                <span class="s1">};</span>
                <span class="s0">return </span><span class="s1">mutex;</span>
            <span class="s1">},</span>
            <span class="s1">getCond: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">index = func + emnapiTSFN.offset.cond;</span>
                <span class="s0">var </span><span class="s1">mutex = emnapiTSFN.getMutex(func);</span>
                <span class="s0">var </span><span class="s1">cond = {</span>
                    <span class="s1">wait: </span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s0">var </span><span class="s1">i32a = </span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer, index, </span><span class="s3">1</span><span class="s1">);</span>
                        <span class="s0">var </span><span class="s1">value = Atomics.load(i32a, </span><span class="s3">0</span><span class="s1">);</span>
                        <span class="s1">mutex.unlock();</span>
                        <span class="s1">Atomics.wait(i32a, </span><span class="s3">0</span><span class="s1">, value);</span>
                        <span class="s1">mutex.lock();</span>
                    <span class="s1">},</span>
                    <span class="s1">signal: </span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s0">var </span><span class="s1">i32a = </span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer, index, </span><span class="s3">1</span><span class="s1">);</span>
                        <span class="s1">Atomics.add(i32a, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s1">);</span>
                        <span class="s1">Atomics.notify(i32a, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s1">);</span>
                    <span class="s1">}</span>
                <span class="s1">};</span>
                <span class="s0">return </span><span class="s1">cond;</span>
            <span class="s1">},</span>
            <span class="s1">getQueueSize: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.queue_size, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">addQueueSize: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">offset = emnapiTSFN.offset.queue_size;</span>
                <span class="s0">var </span><span class="s1">arr, index;</span>
                <span class="s1">arr = </span><span class="s0">new </span><span class="s1">Uint32Array(wasmMemory.buffer);</span>
                <span class="s1">index = (func + offset) &gt;&gt; </span><span class="s3">2</span><span class="s1">;</span>
                <span class="s1">Atomics.add(arr, index, </span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">subQueueSize: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">offset = emnapiTSFN.offset.queue_size;</span>
                <span class="s0">var </span><span class="s1">arr, index;</span>
                <span class="s1">arr = </span><span class="s0">new </span><span class="s1">Uint32Array(wasmMemory.buffer);</span>
                <span class="s1">index = (func + offset) &gt;&gt; </span><span class="s3">2</span><span class="s1">;</span>
                <span class="s1">Atomics.sub(arr, index, </span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getThreadCount: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.thread_count, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">addThreadCount: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">offset = emnapiTSFN.offset.thread_count;</span>
                <span class="s0">var </span><span class="s1">arr, index;</span>
                <span class="s1">arr = </span><span class="s0">new </span><span class="s1">Uint32Array(wasmMemory.buffer);</span>
                <span class="s1">index = (func + offset) &gt;&gt; </span><span class="s3">2</span><span class="s1">;</span>
                <span class="s1">Atomics.add(arr, index, </span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">subThreadCount: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">offset = emnapiTSFN.offset.thread_count;</span>
                <span class="s0">var </span><span class="s1">arr, index;</span>
                <span class="s1">arr = </span><span class="s0">new </span><span class="s1">Uint32Array(wasmMemory.buffer);</span>
                <span class="s1">index = (func + offset) &gt;&gt; </span><span class="s3">2</span><span class="s1">;</span>
                <span class="s1">Atomics.sub(arr, index, </span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getIsClosing: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">Atomics.load(</span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer), (func + emnapiTSFN.offset.is_closing) &gt;&gt; </span><span class="s3">2</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">setIsClosing: </span><span class="s0">function </span><span class="s1">(func, value) {</span>
                <span class="s1">Atomics.store(</span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer), (func + emnapiTSFN.offset.is_closing) &gt;&gt; </span><span class="s3">2</span><span class="s1">, value);</span>
            <span class="s1">},</span>
            <span class="s1">getHandlesClosing: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">Atomics.load(</span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer), (func + emnapiTSFN.offset.handles_closing) &gt;&gt; </span><span class="s3">2</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">setHandlesClosing: </span><span class="s0">function </span><span class="s1">(func, value) {</span>
                <span class="s1">Atomics.store(</span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer), (func + emnapiTSFN.offset.handles_closing) &gt;&gt; </span><span class="s3">2</span><span class="s1">, value);</span>
            <span class="s1">},</span>
            <span class="s1">getDispatchState: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">Atomics.load(</span><span class="s0">new </span><span class="s1">Uint32Array(wasmMemory.buffer), (func + emnapiTSFN.offset.dispatch_state) &gt;&gt; </span><span class="s3">2</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getContext: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.context, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getMaxQueueSize: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.max_queue_size, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getEnv: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.env, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getCallJSCb: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.call_js_cb, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getRef: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.ref, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getResource: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.resource, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getFinalizeCb: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.finalize_cb, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getFinalizeData: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(func + emnapiTSFN.offset.finalize_data, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">loadSizeTypeValue: </span><span class="s0">function </span><span class="s1">(offset, unsigned) {</span>
                <span class="s0">var </span><span class="s1">ret;</span>
                <span class="s0">var </span><span class="s1">arr;</span>
                <span class="s0">if </span><span class="s1">(unsigned) {</span>
                    <span class="s1">arr = </span><span class="s0">new </span><span class="s1">Uint32Array(wasmMemory.buffer);</span>
                    <span class="s1">ret = Atomics.load(arr, offset &gt;&gt; </span><span class="s3">2</span><span class="s1">);</span>
                    <span class="s0">return </span><span class="s1">ret;</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">arr = </span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer);</span>
                    <span class="s1">ret = Atomics.load(arr, offset &gt;&gt; </span><span class="s3">2</span><span class="s1">);</span>
                    <span class="s0">return </span><span class="s1">ret;</span>
                <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s1">storeSizeTypeValue: </span><span class="s0">function </span><span class="s1">(offset, value, unsigned) {</span>
                <span class="s0">var </span><span class="s1">arr;</span>
                <span class="s0">if </span><span class="s1">(unsigned) {</span>
                    <span class="s1">arr = </span><span class="s0">new </span><span class="s1">Uint32Array(wasmMemory.buffer);</span>
                    <span class="s1">Atomics.store(arr, offset &gt;&gt; </span><span class="s3">2</span><span class="s1">, value);</span>
                    <span class="s0">return </span><span class="s1">undefined;</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">arr = </span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer);</span>
                    <span class="s1">Atomics.store(arr, offset &gt;&gt; </span><span class="s3">2</span><span class="s1">, value &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">);</span>
                    <span class="s0">return </span><span class="s1">undefined;</span>
                <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s1">destroy: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s1">emnapiTSFN.destroyQueue(func);</span>
                <span class="s0">var </span><span class="s1">env = emnapiTSFN.getEnv(func);</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s0">var </span><span class="s1">ref = emnapiTSFN.getRef(func);</span>
                <span class="s0">if </span><span class="s1">(ref) {</span>
                    <span class="s1">emnapiCtx.refStore.get(ref).dispose();</span>
                <span class="s1">}</span>
                <span class="s1">emnapiCtx.removeCleanupHook(envObject, emnapiTSFN.cleanup, func);</span>
                <span class="s1">envObject.unref();</span>
                <span class="s0">var </span><span class="s1">asyncRefOffset = (func + emnapiTSFN.offset.async_ref) &gt;&gt; </span><span class="s3">2</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">arr = </span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer);</span>
                <span class="s0">if </span><span class="s1">(Atomics.load(arr, asyncRefOffset)) {</span>
                    <span class="s1">Atomics.store(arr, asyncRefOffset, </span><span class="s3">0</span><span class="s1">);</span>
                    <span class="s1">emnapiCtx.decreaseWaitingRequestCounter();</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">resource = emnapiTSFN.getResource(func);</span>
                <span class="s1">emnapiCtx.refStore.get(resource).dispose();</span>
                <span class="s0">if </span><span class="s1">(emnapiNodeBinding) {</span>
                    <span class="s0">var </span><span class="s1">view = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                    <span class="s0">var </span><span class="s1">asyncId = view.getFloat64(func + emnapiTSFN.offset.async_id, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">triggerAsyncId = view.getFloat64(func + emnapiTSFN.offset.trigger_async_id, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">_emnapi_node_emit_async_destroy(asyncId, triggerAsyncId);</span>
                <span class="s1">}</span>
                <span class="s1">_free(func);</span>
            <span class="s1">},</span>
            <span class="s1">emptyQueueAndDelete: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">callJsCb = emnapiTSFN.getCallJSCb(func);</span>
                <span class="s0">var </span><span class="s1">context = emnapiTSFN.getContext(func);</span>
                <span class="s0">var </span><span class="s1">data;</span>
                <span class="s0">while </span><span class="s1">(emnapiTSFN.getQueueSize(func) &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s1">data = emnapiTSFN.shiftQueue(func);</span>
                    <span class="s0">if </span><span class="s1">(callJsCb) {</span>
                        <span class="s1">(wasmTable.get(callJsCb))(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, context, data);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s1">emnapiTSFN.destroy(func);</span>
            <span class="s1">},</span>
            <span class="s1">finalize: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">env = emnapiTSFN.getEnv(func);</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s1">emnapiCtx.openScope(envObject);</span>
                <span class="s0">var </span><span class="s1">finalize = emnapiTSFN.getFinalizeCb(func);</span>
                <span class="s0">var </span><span class="s1">data = emnapiTSFN.getFinalizeData(func);</span>
                <span class="s0">var </span><span class="s1">context = emnapiTSFN.getContext(func);</span>
                <span class="s0">var </span><span class="s1">f = </span><span class="s0">function </span><span class="s1">() {</span>
                    <span class="s1">envObject.callFinalizerInternal(</span><span class="s3">0</span><span class="s1">, finalize, data, context);</span>
                <span class="s1">};</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s0">if </span><span class="s1">(finalize) {</span>
                        <span class="s0">if </span><span class="s1">(emnapiNodeBinding) {</span>
                            <span class="s0">var </span><span class="s1">resource = emnapiTSFN.getResource(func);</span>
                            <span class="s0">var </span><span class="s1">resource_value = emnapiCtx.refStore.get(resource).get();</span>
                            <span class="s0">var </span><span class="s1">resourceObject = emnapiCtx.handleStore.get(resource_value).value;</span>
                            <span class="s0">var </span><span class="s1">view = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                            <span class="s0">var </span><span class="s1">asyncId = view.getFloat64(func + emnapiTSFN.offset.async_id, </span><span class="s0">true</span><span class="s1">);</span>
                            <span class="s0">var </span><span class="s1">triggerAsyncId = view.getFloat64(func + emnapiTSFN.offset.trigger_async_id, </span><span class="s0">true</span><span class="s1">);</span>
                            <span class="s1">emnapiNodeBinding.node.makeCallback(resourceObject, f, [], {</span>
                                <span class="s1">asyncId: asyncId,</span>
                                <span class="s1">triggerAsyncId: triggerAsyncId</span>
                            <span class="s1">});</span>
                        <span class="s1">}</span>
                        <span class="s0">else </span><span class="s1">{</span>
                            <span class="s1">f();</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                    <span class="s1">emnapiTSFN.emptyQueueAndDelete(func);</span>
                <span class="s1">}</span>
                <span class="s0">finally </span><span class="s1">{</span>
                    <span class="s1">emnapiCtx.closeScope(envObject);</span>
                <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s1">cleanup: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s1">emnapiTSFN.closeHandlesAndMaybeDelete(func, </span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">closeHandlesAndMaybeDelete: </span><span class="s0">function </span><span class="s1">(func, set_closing) {</span>
                <span class="s0">var </span><span class="s1">env = emnapiTSFN.getEnv(func);</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s1">emnapiCtx.openScope(envObject);</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s0">if </span><span class="s1">(set_closing) {</span>
                        <span class="s1">emnapiTSFN.getMutex(func).execute(</span><span class="s0">function </span><span class="s1">() {</span>
                            <span class="s1">emnapiTSFN.setIsClosing(func, </span><span class="s3">1</span><span class="s1">);</span>
                            <span class="s0">if </span><span class="s1">(emnapiTSFN.getMaxQueueSize(func) &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                                <span class="s1">emnapiTSFN.getCond(func).signal();</span>
                            <span class="s1">}</span>
                        <span class="s1">});</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(emnapiTSFN.getHandlesClosing(func)) {</span>
                        <span class="s0">return</span><span class="s1">;</span>
                    <span class="s1">}</span>
                    <span class="s1">emnapiTSFN.setHandlesClosing(func, </span><span class="s3">1</span><span class="s1">);</span>
                    <span class="s1">emnapiCtx.feature.setImmediate(</span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s1">emnapiTSFN.finalize(func);</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
                <span class="s0">finally </span><span class="s1">{</span>
                    <span class="s1">emnapiCtx.closeScope(envObject);</span>
                <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s1">dispatchOne: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">data = </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">popped_value = </span><span class="s0">false</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">has_more = </span><span class="s0">false</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">mutex = emnapiTSFN.getMutex(func);</span>
                <span class="s0">var </span><span class="s1">cond = emnapiTSFN.getCond(func);</span>
                <span class="s1">mutex.execute(</span><span class="s0">function </span><span class="s1">() {</span>
                    <span class="s0">if </span><span class="s1">(emnapiTSFN.getIsClosing(func)) {</span>
                        <span class="s1">emnapiTSFN.closeHandlesAndMaybeDelete(func, </span><span class="s3">0</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s0">var </span><span class="s1">size = emnapiTSFN.getQueueSize(func);</span>
                        <span class="s0">if </span><span class="s1">(size &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                            <span class="s1">data = emnapiTSFN.shiftQueue(func);</span>
                            <span class="s1">popped_value = </span><span class="s0">true</span><span class="s1">;</span>
                            <span class="s0">var </span><span class="s1">maxQueueSize = emnapiTSFN.getMaxQueueSize(func);</span>
                            <span class="s0">if </span><span class="s1">(size === maxQueueSize &amp;&amp; maxQueueSize &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                                <span class="s1">cond.signal();</span>
                            <span class="s1">}</span>
                            <span class="s1">size--;</span>
                        <span class="s1">}</span>
                        <span class="s0">if </span><span class="s1">(size === </span><span class="s3">0</span><span class="s1">) {</span>
                            <span class="s0">if </span><span class="s1">(emnapiTSFN.getThreadCount(func) === </span><span class="s3">0</span><span class="s1">) {</span>
                                <span class="s1">emnapiTSFN.setIsClosing(func, </span><span class="s3">1</span><span class="s1">);</span>
                                <span class="s0">if </span><span class="s1">(emnapiTSFN.getMaxQueueSize(func) &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                                    <span class="s1">cond.signal();</span>
                                <span class="s1">}</span>
                                <span class="s1">emnapiTSFN.closeHandlesAndMaybeDelete(func, </span><span class="s3">0</span><span class="s1">);</span>
                            <span class="s1">}</span>
                        <span class="s1">}</span>
                        <span class="s0">else </span><span class="s1">{</span>
                            <span class="s1">has_more = </span><span class="s0">true</span><span class="s1">;</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                <span class="s1">});</span>
                <span class="s0">if </span><span class="s1">(popped_value) {</span>
                    <span class="s0">var </span><span class="s1">env = emnapiTSFN.getEnv(func);</span>
                    <span class="s0">var </span><span class="s1">envObject_1 = emnapiCtx.envStore.get(env);</span>
                    <span class="s1">emnapiCtx.openScope(envObject_1);</span>
                    <span class="s0">var </span><span class="s1">f = </span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s1">envObject_1.callbackIntoModule(</span><span class="s0">false</span><span class="s1">, </span><span class="s0">function </span><span class="s1">() {</span>
                            <span class="s0">var </span><span class="s1">callJsCb = emnapiTSFN.getCallJSCb(func);</span>
                            <span class="s0">var </span><span class="s1">ref = emnapiTSFN.getRef(func);</span>
                            <span class="s0">var </span><span class="s1">js_callback = ref ? emnapiCtx.refStore.get(ref).get() : </span><span class="s3">0</span><span class="s1">;</span>
                            <span class="s0">if </span><span class="s1">(callJsCb) {</span>
                                <span class="s0">var </span><span class="s1">context = emnapiTSFN.getContext(func);</span>
                                <span class="s1">(wasmTable.get(callJsCb))(env, js_callback, context, data);</span>
                            <span class="s1">}</span>
                            <span class="s0">else </span><span class="s1">{</span>
                                <span class="s0">var </span><span class="s1">jsCallback = js_callback ? emnapiCtx.handleStore.get(js_callback).value : </span><span class="s0">null</span><span class="s1">;</span>
                                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">jsCallback === </span><span class="s2">'function'</span><span class="s1">) {</span>
                                    <span class="s1">jsCallback();</span>
                                <span class="s1">}</span>
                            <span class="s1">}</span>
                        <span class="s1">});</span>
                    <span class="s1">};</span>
                    <span class="s0">try </span><span class="s1">{</span>
                        <span class="s0">if </span><span class="s1">(emnapiNodeBinding) {</span>
                            <span class="s0">var </span><span class="s1">resource = emnapiTSFN.getResource(func);</span>
                            <span class="s0">var </span><span class="s1">resource_value = emnapiCtx.refStore.get(resource).get();</span>
                            <span class="s0">var </span><span class="s1">resourceObject = emnapiCtx.handleStore.get(resource_value).value;</span>
                            <span class="s0">var </span><span class="s1">view = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                            <span class="s1">emnapiNodeBinding.node.makeCallback(resourceObject, f, [], {</span>
                                <span class="s1">asyncId: view.getFloat64(func + emnapiTSFN.offset.async_id, </span><span class="s0">true</span><span class="s1">),</span>
                                <span class="s1">triggerAsyncId: view.getFloat64(func + emnapiTSFN.offset.trigger_async_id, </span><span class="s0">true</span><span class="s1">)</span>
                            <span class="s1">});</span>
                        <span class="s1">}</span>
                        <span class="s0">else </span><span class="s1">{</span>
                            <span class="s1">f();</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                    <span class="s0">finally </span><span class="s1">{</span>
                        <span class="s1">emnapiCtx.closeScope(envObject_1);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">has_more;</span>
            <span class="s1">},</span>
            <span class="s1">dispatch: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">has_more = </span><span class="s0">true</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">iterations_left = </span><span class="s3">1000</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">ui32a = </span><span class="s0">new </span><span class="s1">Uint32Array(wasmMemory.buffer);</span>
                <span class="s0">var </span><span class="s1">index = (func + emnapiTSFN.offset.dispatch_state) &gt;&gt; </span><span class="s3">2</span><span class="s1">;</span>
                <span class="s0">while </span><span class="s1">(has_more &amp;&amp; --iterations_left !== </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s1">Atomics.store(ui32a, index, </span><span class="s3">1</span><span class="s1">);</span>
                    <span class="s1">has_more = emnapiTSFN.dispatchOne(func);</span>
                    <span class="s0">if </span><span class="s1">(Atomics.exchange(ui32a, index, </span><span class="s3">0</span><span class="s1">) !== </span><span class="s3">1</span><span class="s1">) {</span>
                        <span class="s1">has_more = </span><span class="s0">true</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(has_more) {</span>
                    <span class="s1">emnapiTSFN.send(func);</span>
                <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s1">send: </span><span class="s0">function </span><span class="s1">(func) {</span>
                <span class="s0">var </span><span class="s1">current_state = Atomics.or(</span><span class="s0">new </span><span class="s1">Uint32Array(wasmMemory.buffer), (func + emnapiTSFN.offset.dispatch_state) &gt;&gt; </span><span class="s3">2</span><span class="s1">, </span><span class="s3">1 </span><span class="s1">&lt;&lt; </span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">((current_state &amp; </span><span class="s3">1</span><span class="s1">) === </span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s0">return</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">((</span><span class="s0">typeof </span><span class="s1">ENVIRONMENT_IS_PTHREAD !== </span><span class="s2">'undefined'</span><span class="s1">) &amp;&amp; ENVIRONMENT_IS_PTHREAD) {</span>
                    <span class="s1">postMessage({</span>
                        <span class="s1">__emnapi__: {</span>
                            <span class="s1">type: </span><span class="s2">'tsfn-send'</span><span class="s1">,</span>
                            <span class="s1">payload: {</span>
                                <span class="s1">tsfn: func</span>
                            <span class="s1">}</span>
                        <span class="s1">}</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">emnapiCtx.feature.setImmediate(</span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s1">emnapiTSFN.dispatch(func);</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">};</span>
        <span class="s0">function </span><span class="s1">napi_create_threadsafe_function(env, func, async_resource, async_resource_name, max_queue_size, initial_thread_count, thread_finalize_data, thread_finalize_cb, context, call_js_cb, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!async_resource_name)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">max_queue_size = max_queue_size &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s1">initial_thread_count = initial_thread_count &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">if </span><span class="s1">(initial_thread_count === </span><span class="s3">0</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">ref = </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">if </span><span class="s1">(!func) {</span>
                <span class="s0">if </span><span class="s1">(!call_js_cb)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s0">var </span><span class="s1">funcValue = emnapiCtx.handleStore.get(func).value;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">funcValue !== </span><span class="s2">'function'</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">ref = emnapiCtx.createReference(envObject, func, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">).id;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">asyncResourceObject;</span>
            <span class="s0">if </span><span class="s1">(async_resource) {</span>
                <span class="s1">asyncResourceObject = emnapiCtx.handleStore.get(async_resource).value;</span>
                <span class="s0">if </span><span class="s1">(asyncResourceObject == </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">asyncResourceObject = Object(asyncResourceObject);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s1">asyncResourceObject = {};</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">resource = envObject.ensureHandleId(asyncResourceObject);</span>
            <span class="s0">var </span><span class="s1">asyncResourceName = emnapiCtx.handleStore.get(async_resource_name).value;</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">asyncResourceName === </span><span class="s2">'symbol'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s1">asyncResourceName = String(asyncResourceName);</span>
            <span class="s0">var </span><span class="s1">resource_name = envObject.ensureHandleId(asyncResourceName);</span>
            <span class="s0">var </span><span class="s1">sizeofTSFN = emnapiTSFN.offset.end;</span>
            <span class="s0">var </span><span class="s1">tsfn = _malloc(sizeofTSFN);</span>
            <span class="s0">if </span><span class="s1">(!tsfn)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer).subarray(tsfn, tsfn + sizeofTSFN).fill(</span><span class="s3">0</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">resourceRef = emnapiCtx.createReference(envObject, resource, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">resource_ = resourceRef.id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(tsfn, resource_, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!emnapiTSFN.initQueue(tsfn)) {</span>
                <span class="s1">_free(tsfn);</span>
                <span class="s1">resourceRef.dispose();</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s1">_emnapi_node_emit_async_init(resource, resource_name, -</span><span class="s3">1</span><span class="s1">, tsfn + emnapiTSFN.offset.async_id);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(tsfn + emnapiTSFN.offset.thread_count, initial_thread_count, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(tsfn + emnapiTSFN.offset.context, context, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(tsfn + emnapiTSFN.offset.max_queue_size, max_queue_size, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(tsfn + emnapiTSFN.offset.ref, ref, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(tsfn + emnapiTSFN.offset.env, env, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(tsfn + emnapiTSFN.offset.finalize_data, thread_finalize_data, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(tsfn + emnapiTSFN.offset.finalize_cb, thread_finalize_cb, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(tsfn + emnapiTSFN.offset.call_js_cb, call_js_cb, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">emnapiCtx.addCleanupHook(envObject, emnapiTSFN.cleanup, tsfn);</span>
            <span class="s1">envObject.ref();</span>
            <span class="s1">emnapiCtx.increaseWaitingRequestCounter();</span>
            <span class="s1">HEAP_DATA_VIEW.setInt32(tsfn + emnapiTSFN.offset.async_ref, </span><span class="s3">1</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, tsfn, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_threadsafe_function_context(func, result) {</span>
            <span class="s0">if </span><span class="s1">(!func || !result) {</span>
                <span class="s1">abort();</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">context = emnapiTSFN.getContext(func);</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, context, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_call_threadsafe_function(func, data, mode) {</span>
            <span class="s0">if </span><span class="s1">(!func) {</span>
                <span class="s1">abort();</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">emnapiTSFN.push(func, data, mode);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_acquire_threadsafe_function(func) {</span>
            <span class="s0">if </span><span class="s1">(!func) {</span>
                <span class="s1">abort();</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">mutex = emnapiTSFN.getMutex(func);</span>
            <span class="s0">return </span><span class="s1">mutex.execute(</span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s0">if </span><span class="s1">(emnapiTSFN.getIsClosing(func)) {</span>
                    <span class="s0">return </span><span class="s3">16</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s1">emnapiTSFN.addThreadCount(func);</span>
                <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_release_threadsafe_function(func, mode) {</span>
            <span class="s0">if </span><span class="s1">(!func) {</span>
                <span class="s1">abort();</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">mutex = emnapiTSFN.getMutex(func);</span>
            <span class="s0">var </span><span class="s1">cond = emnapiTSFN.getCond(func);</span>
            <span class="s0">return </span><span class="s1">mutex.execute(</span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s0">if </span><span class="s1">(emnapiTSFN.getThreadCount(func) === </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s1">emnapiTSFN.subThreadCount(func);</span>
                <span class="s0">if </span><span class="s1">(emnapiTSFN.getThreadCount(func) === </span><span class="s3">0 </span><span class="s1">|| mode === </span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s0">var </span><span class="s1">isClosing = emnapiTSFN.getIsClosing(func);</span>
                    <span class="s0">if </span><span class="s1">(!isClosing) {</span>
                        <span class="s0">var </span><span class="s1">isClosingValue = (mode === </span><span class="s3">1</span><span class="s1">) ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
                        <span class="s1">emnapiTSFN.setIsClosing(func, isClosingValue);</span>
                        <span class="s0">if </span><span class="s1">(isClosingValue &amp;&amp; emnapiTSFN.getMaxQueueSize(func) &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                            <span class="s1">cond.signal();</span>
                        <span class="s1">}</span>
                        <span class="s1">emnapiTSFN.send(func);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_unref_threadsafe_function(env, func) {</span>
            <span class="s0">if </span><span class="s1">(!func) {</span>
                <span class="s1">abort();</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">asyncRefOffset = (func + emnapiTSFN.offset.async_ref) &gt;&gt; </span><span class="s3">2</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">arr = </span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(Atomics.load(arr, asyncRefOffset)) {</span>
                <span class="s1">Atomics.store(arr, asyncRefOffset, </span><span class="s3">0</span><span class="s1">);</span>
                <span class="s1">emnapiCtx.decreaseWaitingRequestCounter();</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_ref_threadsafe_function(env, func) {</span>
            <span class="s0">if </span><span class="s1">(!func) {</span>
                <span class="s1">abort();</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">asyncRefOffset = (func + emnapiTSFN.offset.async_ref) &gt;&gt; </span><span class="s3">2</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">arr = </span><span class="s0">new </span><span class="s1">Int32Array(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(!Atomics.load(arr, asyncRefOffset)) {</span>
                <span class="s1">Atomics.store(arr, asyncRefOffset, </span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">emnapiCtx.increaseWaitingRequestCounter();</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">emnapiAWMT = {</span>
            <span class="s1">unusedWorkers: [],</span>
            <span class="s1">runningWorkers: [],</span>
            <span class="s1">workQueue: [],</span>
            <span class="s1">workerReady: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">offset: {</span>
                <span class="s1">resource: </span><span class="s3">0</span><span class="s1">,</span>
                <span class="s1">async_id: </span><span class="s3">8</span><span class="s1">,</span>
                <span class="s1">trigger_async_id: </span><span class="s3">16</span><span class="s1">,</span>
                <span class="s1">env: </span><span class="s3">24</span><span class="s1">,</span>
                <span class="s1">data: </span><span class="s3">1 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">24</span><span class="s1">,</span>
                <span class="s1">execute: </span><span class="s3">2 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">24</span><span class="s1">,</span>
                <span class="s1">complete: </span><span class="s3">3 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">24</span><span class="s1">,</span>
                <span class="s1">end: </span><span class="s3">4 </span><span class="s1">* </span><span class="s3">4 </span><span class="s1">+ </span><span class="s3">24</span>
            <span class="s1">},</span>
            <span class="s1">init: </span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s1">emnapiAWMT.unusedWorkers = [];</span>
                <span class="s1">emnapiAWMT.runningWorkers = [];</span>
                <span class="s1">emnapiAWMT.workQueue = [];</span>
                <span class="s1">emnapiAWMT.workerReady = </span><span class="s0">null</span><span class="s1">;</span>
            <span class="s1">},</span>
            <span class="s1">addListener: </span><span class="s0">function </span><span class="s1">(worker) {</span>
                <span class="s0">if </span><span class="s1">(!worker)</span>
                    <span class="s0">return false</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(worker._emnapiAWMTListener)</span>
                    <span class="s0">return true</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">handler = </span><span class="s0">function </span><span class="s1">(e) {</span>
                    <span class="s0">var </span><span class="s1">data = ENVIRONMENT_IS_NODE ? e : e.data;</span>
                    <span class="s0">var </span><span class="s1">__emnapi__ = data.__emnapi__;</span>
                    <span class="s0">if </span><span class="s1">(__emnapi__) {</span>
                        <span class="s0">var </span><span class="s1">type = __emnapi__.type;</span>
                        <span class="s0">var </span><span class="s1">payload = __emnapi__.payload;</span>
                        <span class="s0">if </span><span class="s1">(type === </span><span class="s2">'async-work-complete'</span><span class="s1">) {</span>
                            <span class="s1">emnapiCtx.decreaseWaitingRequestCounter();</span>
                            <span class="s1">emnapiAWMT.runningWorkers.splice(emnapiAWMT.runningWorkers.indexOf(worker), </span><span class="s3">1</span><span class="s1">);</span>
                            <span class="s1">emnapiAWMT.unusedWorkers.push(worker);</span>
                            <span class="s1">emnapiAWMT.checkIdleWorker();</span>
                            <span class="s1">emnapiAWMT.callComplete(payload.work, </span><span class="s3">0</span><span class="s1">);</span>
                        <span class="s1">}</span>
                        <span class="s0">else if </span><span class="s1">(type === </span><span class="s2">'async-work-queue'</span><span class="s1">) {</span>
                            <span class="s1">emnapiAWMT.scheduleWork(payload.work);</span>
                        <span class="s1">}</span>
                        <span class="s0">else if </span><span class="s1">(type === </span><span class="s2">'async-work-cancel'</span><span class="s1">) {</span>
                            <span class="s1">emnapiAWMT.cancelWork(payload.work);</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                <span class="s1">};</span>
                <span class="s0">var </span><span class="s1">dispose = </span><span class="s0">function </span><span class="s1">() {</span>
                    <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_NODE) {</span>
                        <span class="s1">worker.off(</span><span class="s2">'message'</span><span class="s1">, handler);</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s1">worker.removeEventListener(</span><span class="s2">'message'</span><span class="s1">, handler, </span><span class="s0">false</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s0">delete </span><span class="s1">worker._emnapiAWMTListener;</span>
                <span class="s1">};</span>
                <span class="s1">worker._emnapiAWMTListener = { handler: handler, dispose: dispose };</span>
                <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_NODE) {</span>
                    <span class="s1">worker.on(</span><span class="s2">'message'</span><span class="s1">, handler);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">worker.addEventListener(</span><span class="s2">'message'</span><span class="s1">, handler, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return true</span><span class="s1">;</span>
            <span class="s1">},</span>
            <span class="s1">initWorkers: </span><span class="s0">function </span><span class="s1">(n) {</span>
                <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_PTHREAD) {</span>
                    <span class="s0">return </span><span class="s1">emnapiAWMT.workerReady || (emnapiAWMT.workerReady = Promise.resolve());</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(emnapiAWMT.workerReady)</span>
                    <span class="s0">return </span><span class="s1">emnapiAWMT.workerReady;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">onCreateWorker !== </span><span class="s2">'function'</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'`options.onCreateWorker` is not a function'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">promises = [];</span>
                <span class="s0">var </span><span class="s1">args = [];</span>
                <span class="s0">if </span><span class="s1">(!(</span><span class="s2">'emnapi_async_worker_create' </span><span class="s0">in </span><span class="s1">wasmInstance.exports)) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'`emnapi_async_worker_create` is not exported, please try to add `--export=emnapi_async_worker_create` to linker flags'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; n; ++i) {</span>
                    <span class="s1">args.push(wasmInstance.exports.emnapi_async_worker_create());</span>
                <span class="s1">}</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s0">var </span><span class="s1">_loop_1 = </span><span class="s0">function </span><span class="s1">(i) {</span>
                        <span class="s0">var </span><span class="s1">worker = onCreateWorker({ type: </span><span class="s2">'async-work'</span><span class="s1">, name: </span><span class="s2">'emnapi-async-worker' </span><span class="s1">});</span>
                        <span class="s0">var </span><span class="s1">p = PThread.loadWasmModuleToWorker(worker);</span>
                        <span class="s1">emnapiAWMT.addListener(worker);</span>
                        <span class="s1">promises.push(p.then(</span><span class="s0">function </span><span class="s1">() {</span>
                            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">worker.unref === </span><span class="s2">'function'</span><span class="s1">) {</span>
                                <span class="s1">worker.unref();</span>
                            <span class="s1">}</span>
                        <span class="s1">}));</span>
                        <span class="s1">emnapiAWMT.unusedWorkers.push(worker);</span>
                        <span class="s0">var </span><span class="s1">arg = args[i];</span>
                        <span class="s1">worker.threadBlockBase = arg;</span>
                        <span class="s1">worker.postMessage({</span>
                            <span class="s1">__emnapi__: {</span>
                                <span class="s1">type: </span><span class="s2">'async-worker-init'</span><span class="s1">,</span>
                                <span class="s1">payload: { arg: arg }</span>
                            <span class="s1">}</span>
                        <span class="s1">});</span>
                    <span class="s1">};</span>
                    <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; n; ++i) {</span>
                        <span class="s1">_loop_1(i);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(err) {</span>
                    <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; n; ++i) {</span>
                        <span class="s0">var </span><span class="s1">arg = args[i];</span>
                        <span class="s1">_free(arg);</span>
                    <span class="s1">}</span>
                    <span class="s0">throw </span><span class="s1">err;</span>
                <span class="s1">}</span>
                <span class="s1">emnapiAWMT.workerReady = Promise.all(promises);</span>
                <span class="s0">return </span><span class="s1">emnapiAWMT.workerReady;</span>
            <span class="s1">},</span>
            <span class="s1">checkIdleWorker: </span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s0">if </span><span class="s1">(emnapiAWMT.unusedWorkers.length &gt; </span><span class="s3">0 </span><span class="s1">&amp;&amp; emnapiAWMT.workQueue.length &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">var </span><span class="s1">worker = emnapiAWMT.unusedWorkers.shift();</span>
                    <span class="s0">var </span><span class="s1">work = emnapiAWMT.workQueue.shift();</span>
                    <span class="s1">emnapiAWMT.runningWorkers.push(worker);</span>
                    <span class="s1">worker.postMessage({</span>
                        <span class="s1">__emnapi__: {</span>
                            <span class="s1">type: </span><span class="s2">'async-work-execute'</span><span class="s1">,</span>
                            <span class="s1">payload: { work: work }</span>
                        <span class="s1">}</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s1">getResource: </span><span class="s0">function </span><span class="s1">(work) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(work + emnapiAWMT.offset.resource, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getExecute: </span><span class="s0">function </span><span class="s1">(work) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(work + emnapiAWMT.offset.execute, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getComplete: </span><span class="s0">function </span><span class="s1">(work) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(work + emnapiAWMT.offset.complete, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getEnv: </span><span class="s0">function </span><span class="s1">(work) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(work + emnapiAWMT.offset.env, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">getData: </span><span class="s0">function </span><span class="s1">(work) {</span>
                <span class="s0">return </span><span class="s1">emnapiTSFN.loadSizeTypeValue(work + emnapiAWMT.offset.data, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">},</span>
            <span class="s1">scheduleWork: </span><span class="s0">function </span><span class="s1">(work) {</span>
                <span class="s0">var </span><span class="s1">_a;</span>
                <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_PTHREAD) {</span>
                    <span class="s0">var </span><span class="s1">postMessage_1 = napiModule.postMessage;</span>
                    <span class="s1">postMessage_1({</span>
                        <span class="s1">__emnapi__: {</span>
                            <span class="s1">type: </span><span class="s2">'async-work-queue'</span><span class="s1">,</span>
                            <span class="s1">payload: { work: work }</span>
                        <span class="s1">}</span>
                    <span class="s1">});</span>
                    <span class="s0">return</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s1">emnapiCtx.increaseWaitingRequestCounter();</span>
                <span class="s1">emnapiAWMT.workQueue.push(work);</span>
                <span class="s0">if </span><span class="s1">((_a = emnapiAWMT.workerReady) === </span><span class="s0">null </span><span class="s1">|| _a === </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">: _a.ready) {</span>
                    <span class="s1">emnapiAWMT.checkIdleWorker();</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s0">var </span><span class="s1">fail = </span><span class="s0">function </span><span class="s1">(err) {</span>
                        <span class="s1">emnapiCtx.decreaseWaitingRequestCounter();</span>
                        <span class="s0">throw </span><span class="s1">err;</span>
                    <span class="s1">};</span>
                    <span class="s0">try </span><span class="s1">{</span>
                        <span class="s1">emnapiAWMT.initWorkers(_emnapi_async_work_pool_size()).then(</span><span class="s0">function </span><span class="s1">() {</span>
                            <span class="s1">emnapiAWMT.workerReady.ready = </span><span class="s0">true</span><span class="s1">;</span>
                            <span class="s1">emnapiAWMT.checkIdleWorker();</span>
                        <span class="s1">}, fail);</span>
                    <span class="s1">}</span>
                    <span class="s0">catch </span><span class="s1">(err) {</span>
                        <span class="s1">fail(err);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
            <span class="s1">},</span>
            <span class="s1">cancelWork: </span><span class="s0">function </span><span class="s1">(work) {</span>
                <span class="s0">if </span><span class="s1">(ENVIRONMENT_IS_PTHREAD) {</span>
                    <span class="s0">var </span><span class="s1">postMessage_2 = napiModule.postMessage;</span>
                    <span class="s1">postMessage_2({</span>
                        <span class="s1">__emnapi__: {</span>
                            <span class="s1">type: </span><span class="s2">'async-work-cancel'</span><span class="s1">,</span>
                            <span class="s1">payload: { work: work }</span>
                        <span class="s1">}</span>
                    <span class="s1">});</span>
                    <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">index = emnapiAWMT.workQueue.indexOf(work);</span>
                <span class="s0">if </span><span class="s1">(index !== -</span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s1">emnapiAWMT.workQueue.splice(index, </span><span class="s3">1</span><span class="s1">);</span>
                    <span class="s1">emnapiCtx.feature.setImmediate(</span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s1">emnapiCtx.decreaseWaitingRequestCounter();</span>
                        <span class="s1">emnapiAWMT.checkIdleWorker();</span>
                        <span class="s1">emnapiAWMT.callComplete(work, </span><span class="s3">11</span><span class="s1">);</span>
                    <span class="s1">});</span>
                    <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s3">9</span><span class="s1">;</span>
            <span class="s1">},</span>
            <span class="s1">callComplete: </span><span class="s0">function </span><span class="s1">(work, status) {</span>
                <span class="s0">var </span><span class="s1">complete = emnapiAWMT.getComplete(work);</span>
                <span class="s0">var </span><span class="s1">env = emnapiAWMT.getEnv(work);</span>
                <span class="s0">var </span><span class="s1">data = emnapiAWMT.getData(work);</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s0">var </span><span class="s1">scope = emnapiCtx.openScope(envObject);</span>
                <span class="s0">var </span><span class="s1">callback = </span><span class="s0">function </span><span class="s1">() {</span>
                    <span class="s0">if </span><span class="s1">(!complete)</span>
                        <span class="s0">return</span><span class="s1">;</span>
                    <span class="s1">envObject.callbackIntoModule(</span><span class="s0">true</span><span class="s1">, </span><span class="s0">function </span><span class="s1">() {</span>
                        <span class="s1">(wasmTable.get(complete))(env, status, data);</span>
                    <span class="s1">});</span>
                <span class="s1">};</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s0">if </span><span class="s1">(emnapiNodeBinding) {</span>
                        <span class="s0">var </span><span class="s1">resource = emnapiAWMT.getResource(work);</span>
                        <span class="s0">var </span><span class="s1">resource_value = emnapiCtx.refStore.get(resource).get();</span>
                        <span class="s0">var </span><span class="s1">resourceObject = emnapiCtx.handleStore.get(resource_value).value;</span>
                        <span class="s0">var </span><span class="s1">view = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                        <span class="s0">var </span><span class="s1">asyncId = view.getFloat64(work + emnapiAWMT.offset.async_id, </span><span class="s0">true</span><span class="s1">);</span>
                        <span class="s0">var </span><span class="s1">triggerAsyncId = view.getFloat64(work + emnapiAWMT.offset.trigger_async_id, </span><span class="s0">true</span><span class="s1">);</span>
                        <span class="s1">emnapiNodeBinding.node.makeCallback(resourceObject, callback, [], {</span>
                            <span class="s1">asyncId: asyncId,</span>
                            <span class="s1">triggerAsyncId: triggerAsyncId</span>
                        <span class="s1">});</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s1">callback();</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">finally </span><span class="s1">{</span>
                    <span class="s1">emnapiCtx.closeScope(envObject, scope);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">};</span>
        <span class="s0">var </span><span class="s1">napi_create_async_work = singleThreadAsyncWork</span>
            <span class="s1">? </span><span class="s0">function </span><span class="s1">(env, resource, resource_name, execute, complete, data, result) {</span>
                <span class="s0">if </span><span class="s1">(!env)</span>
                    <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s1">envObject.checkGCAccess();</span>
                <span class="s0">if </span><span class="s1">(!execute)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">resourceObject;</span>
                <span class="s0">if </span><span class="s1">(resource) {</span>
                    <span class="s1">resourceObject = Object(emnapiCtx.handleStore.get(resource).value);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">resourceObject = {};</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!resource_name)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">resourceName = String(emnapiCtx.handleStore.get(resource_name).value);</span>
                <span class="s0">var </span><span class="s1">id = emnapiAWST.create(env, resourceObject, resourceName, execute, complete, data);</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, id, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s1">: </span><span class="s0">function </span><span class="s1">(env, resource, resource_name, execute, complete, data, result) {</span>
                <span class="s0">if </span><span class="s1">(!env)</span>
                    <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s1">envObject.checkGCAccess();</span>
                <span class="s0">if </span><span class="s1">(!execute)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">resourceObject;</span>
                <span class="s0">if </span><span class="s1">(resource) {</span>
                    <span class="s1">resourceObject = Object(emnapiCtx.handleStore.get(resource).value);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">resourceObject = {};</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!resource_name)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">sizeofAW = emnapiAWMT.offset.end;</span>
                <span class="s0">var </span><span class="s1">aw = _malloc(sizeofAW);</span>
                <span class="s0">if </span><span class="s1">(!aw)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
                <span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer).subarray(aw, aw + sizeofAW).fill(</span><span class="s3">0</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">s = envObject.ensureHandleId(resourceObject);</span>
                <span class="s0">var </span><span class="s1">resourceRef = emnapiCtx.createReference(envObject, s, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">resource_ = resourceRef.id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(aw, resource_, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">_emnapi_node_emit_async_init(s, resource_name, -</span><span class="s3">1</span><span class="s1">, aw + emnapiAWMT.offset.async_id);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(aw + emnapiAWMT.offset.env, env, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(aw + emnapiAWMT.offset.execute, execute, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(aw + emnapiAWMT.offset.complete, complete, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(aw + emnapiAWMT.offset.data, data, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, aw, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">};</span>
        <span class="s0">var </span><span class="s1">napi_delete_async_work = singleThreadAsyncWork</span>
            <span class="s1">? </span><span class="s0">function </span><span class="s1">(env, work) {</span>
                <span class="s0">if </span><span class="s1">(!env)</span>
                    <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s1">envObject.checkGCAccess();</span>
                <span class="s0">if </span><span class="s1">(!work)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">emnapiAWST.remove(work);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s1">: </span><span class="s0">function </span><span class="s1">(env, work) {</span>
                <span class="s0">if </span><span class="s1">(!env)</span>
                    <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s1">envObject.checkGCAccess();</span>
                <span class="s0">if </span><span class="s1">(!work)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">resource = emnapiAWMT.getResource(work);</span>
                <span class="s1">emnapiCtx.refStore.get(resource).dispose();</span>
                <span class="s0">if </span><span class="s1">(emnapiNodeBinding) {</span>
                    <span class="s0">var </span><span class="s1">view = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                    <span class="s0">var </span><span class="s1">asyncId = view.getFloat64(work + emnapiAWMT.offset.async_id, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">triggerAsyncId = view.getFloat64(work + emnapiAWMT.offset.trigger_async_id, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">_emnapi_node_emit_async_destroy(asyncId, triggerAsyncId);</span>
                <span class="s1">}</span>
                <span class="s1">_free(work);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">};</span>
        <span class="s0">var </span><span class="s1">napi_queue_async_work = singleThreadAsyncWork</span>
            <span class="s1">? </span><span class="s0">function </span><span class="s1">(env, work) {</span>
                <span class="s0">if </span><span class="s1">(!env)</span>
                    <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s0">if </span><span class="s1">(!work)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">emnapiAWST.queue(work);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s1">: </span><span class="s0">function </span><span class="s1">(env, work) {</span>
                <span class="s0">if </span><span class="s1">(!env)</span>
                    <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s0">if </span><span class="s1">(!work)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">emnapiAWMT.scheduleWork(work);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">};</span>
        <span class="s0">var </span><span class="s1">napi_cancel_async_work = singleThreadAsyncWork</span>
            <span class="s1">? </span><span class="s0">function </span><span class="s1">(env, work) {</span>
                <span class="s0">if </span><span class="s1">(!env)</span>
                    <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s0">if </span><span class="s1">(!work)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">status = emnapiAWST.cancel(work);</span>
                <span class="s0">if </span><span class="s1">(status === </span><span class="s3">0</span><span class="s1">)</span>
                    <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(status);</span>
            <span class="s1">}</span>
            <span class="s1">: </span><span class="s0">function </span><span class="s1">(env, work) {</span>
                <span class="s0">if </span><span class="s1">(!env)</span>
                    <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s0">if </span><span class="s1">(!work)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">status = emnapiAWMT.cancelWork(work);</span>
                <span class="s0">if </span><span class="s1">(status === </span><span class="s3">0</span><span class="s1">)</span>
                    <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(status);</span>
            <span class="s1">};</span>
        <span class="s0">function </span><span class="s1">initWorker(startArg) {</span>
            <span class="s0">if </span><span class="s1">(napiModule.childThread) {</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">wasmInstance.exports.emnapi_async_worker_init !== </span><span class="s2">'function'</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'`emnapi_async_worker_init` is not exported, please try to add `--export=emnapi_async_worker_init` to linker flags'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">wasmInstance.exports.emnapi_async_worker_init(startArg);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'startThread is only available in child threads'</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">executeAsyncWork(work) {</span>
            <span class="s0">if </span><span class="s1">(!ENVIRONMENT_IS_PTHREAD)</span>
                <span class="s0">return</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">execute = emnapiAWMT.getExecute(work);</span>
            <span class="s0">var </span><span class="s1">env = emnapiAWMT.getEnv(work);</span>
            <span class="s0">var </span><span class="s1">data = emnapiAWMT.getData(work);</span>
            <span class="s1">(wasmTable.get(execute))(env, data);</span>
            <span class="s0">var </span><span class="s1">postMessage = napiModule.postMessage;</span>
            <span class="s1">postMessage({</span>
                <span class="s1">__emnapi__: {</span>
                    <span class="s1">type: </span><span class="s2">'async-work-complete'</span><span class="s1">,</span>
                    <span class="s1">payload: { work: work }</span>
                <span class="s1">}</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s1">napiModule.initWorker = initWorker;</span>
        <span class="s1">napiModule.executeAsyncWork = executeAsyncWork;</span>
        <span class="s0">var </span><span class="s1">asyncWorkMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_cancel_async_work: napi_cancel_async_work,</span>
            <span class="s1">napi_create_async_work: napi_create_async_work,</span>
            <span class="s1">napi_delete_async_work: napi_delete_async_work,</span>
            <span class="s1">napi_queue_async_work: napi_queue_async_work</span>
        <span class="s1">});</span>
        <span class="s0">var </span><span class="s1">emnapiExternalMemory = {</span>
            <span class="s1">registry: </span><span class="s0">typeof </span><span class="s1">FinalizationRegistry === </span><span class="s2">'function' </span><span class="s1">? </span><span class="s0">new </span><span class="s1">FinalizationRegistry(</span><span class="s0">function </span><span class="s1">(_pointer) { _free(_pointer); }) : undefined,</span>
            <span class="s1">table: </span><span class="s0">new </span><span class="s1">WeakMap(),</span>
            <span class="s1">wasmMemoryViewTable: </span><span class="s0">new </span><span class="s1">WeakMap(),</span>
            <span class="s1">init: </span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s1">emnapiExternalMemory.registry = </span><span class="s0">typeof </span><span class="s1">FinalizationRegistry === </span><span class="s2">'function' </span><span class="s1">? </span><span class="s0">new </span><span class="s1">FinalizationRegistry(</span><span class="s0">function </span><span class="s1">(_pointer) { _free(_pointer); }) : undefined;</span>
                <span class="s1">emnapiExternalMemory.table = </span><span class="s0">new </span><span class="s1">WeakMap();</span>
                <span class="s1">emnapiExternalMemory.wasmMemoryViewTable = </span><span class="s0">new </span><span class="s1">WeakMap();</span>
            <span class="s1">},</span>
            <span class="s1">isDetachedArrayBuffer: </span><span class="s0">function </span><span class="s1">(arrayBuffer) {</span>
                <span class="s0">if </span><span class="s1">(arrayBuffer.byteLength === </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">try </span><span class="s1">{</span>
                        <span class="s0">new </span><span class="s1">Uint8Array(arrayBuffer);</span>
                    <span class="s1">}</span>
                    <span class="s0">catch </span><span class="s1">(_) {</span>
                        <span class="s0">return true</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">},</span>
            <span class="s1">getArrayBufferPointer: </span><span class="s0">function </span><span class="s1">(arrayBuffer, shouldCopy) {</span>
                <span class="s0">var </span><span class="s1">_a;</span>
                <span class="s0">var </span><span class="s1">info = {</span>
                    <span class="s1">address: </span><span class="s3">0</span><span class="s1">,</span>
                    <span class="s1">ownership: </span><span class="s3">0</span><span class="s1">,</span>
                    <span class="s1">runtimeAllocated: </span><span class="s3">0</span>
                <span class="s1">};</span>
                <span class="s0">if </span><span class="s1">(arrayBuffer === wasmMemory.buffer) {</span>
                    <span class="s0">return </span><span class="s1">info;</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">isDetached = emnapiExternalMemory.isDetachedArrayBuffer(arrayBuffer);</span>
                <span class="s0">if </span><span class="s1">(emnapiExternalMemory.table.has(arrayBuffer)) {</span>
                    <span class="s0">var </span><span class="s1">cachedInfo = emnapiExternalMemory.table.get(arrayBuffer);</span>
                    <span class="s0">if </span><span class="s1">(isDetached) {</span>
                        <span class="s1">cachedInfo.address = </span><span class="s3">0</span><span class="s1">;</span>
                        <span class="s0">return </span><span class="s1">cachedInfo;</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(shouldCopy &amp;&amp; cachedInfo.ownership === </span><span class="s3">0 </span><span class="s1">&amp;&amp; cachedInfo.runtimeAllocated === </span><span class="s3">1</span><span class="s1">) {</span>
                        <span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer).set(</span><span class="s0">new </span><span class="s1">Uint8Array(arrayBuffer), cachedInfo.address);</span>
                    <span class="s1">}</span>
                    <span class="s0">return </span><span class="s1">cachedInfo;</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(isDetached || (arrayBuffer.byteLength === </span><span class="s3">0</span><span class="s1">)) {</span>
                    <span class="s0">return </span><span class="s1">info;</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!shouldCopy) {</span>
                    <span class="s0">return </span><span class="s1">info;</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">pointer = _malloc(arrayBuffer.byteLength);</span>
                <span class="s0">if </span><span class="s1">(!pointer)</span>
                    <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'Out of memory'</span><span class="s1">);</span>
                <span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer).set(</span><span class="s0">new </span><span class="s1">Uint8Array(arrayBuffer), pointer);</span>
                <span class="s1">info.address = pointer;</span>
                <span class="s1">info.ownership = emnapiExternalMemory.registry ? </span><span class="s3">0 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s1">info.runtimeAllocated = </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s1">emnapiExternalMemory.table.set(arrayBuffer, info);</span>
                <span class="s1">(_a = emnapiExternalMemory.registry) === </span><span class="s0">null </span><span class="s1">|| _a === </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">: _a.register(arrayBuffer, pointer);</span>
                <span class="s0">return </span><span class="s1">info;</span>
            <span class="s1">},</span>
            <span class="s1">getOrUpdateMemoryView: </span><span class="s0">function </span><span class="s1">(view) {</span>
                <span class="s0">if </span><span class="s1">(view.buffer === wasmMemory.buffer) {</span>
                    <span class="s0">if </span><span class="s1">(!emnapiExternalMemory.wasmMemoryViewTable.has(view)) {</span>
                        <span class="s1">emnapiExternalMemory.wasmMemoryViewTable.set(view, {</span>
                            <span class="s1">Ctor: view.constructor,</span>
                            <span class="s1">address: view.byteOffset,</span>
                            <span class="s1">length: view </span><span class="s0">instanceof </span><span class="s1">DataView ? view.byteLength : view.length,</span>
                            <span class="s1">ownership: </span><span class="s3">1</span><span class="s1">,</span>
                            <span class="s1">runtimeAllocated: </span><span class="s3">0</span>
                        <span class="s1">});</span>
                    <span class="s1">}</span>
                    <span class="s0">return </span><span class="s1">view;</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">maybeOldWasmMemory = emnapiExternalMemory.isDetachedArrayBuffer(view.buffer) ||</span>
                    <span class="s1">((</span><span class="s0">typeof </span><span class="s1">SharedArrayBuffer === </span><span class="s2">'function'</span><span class="s1">) &amp;&amp; (view.buffer </span><span class="s0">instanceof </span><span class="s1">SharedArrayBuffer));</span>
                <span class="s0">if </span><span class="s1">(maybeOldWasmMemory &amp;&amp; emnapiExternalMemory.wasmMemoryViewTable.has(view)) {</span>
                    <span class="s0">var </span><span class="s1">info = emnapiExternalMemory.wasmMemoryViewTable.get(view);</span>
                    <span class="s0">var </span><span class="s1">Ctor = info.Ctor;</span>
                    <span class="s0">var </span><span class="s1">newView = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                    <span class="s0">var </span><span class="s1">Buffer_1 = emnapiCtx.feature.Buffer;</span>
                    <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">Buffer_1 === </span><span class="s2">'function' </span><span class="s1">&amp;&amp; Ctor === Buffer_1) {</span>
                        <span class="s1">newView = Buffer_1.from(wasmMemory.buffer, info.address, info.length);</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s1">newView = </span><span class="s0">new </span><span class="s1">Ctor(wasmMemory.buffer, info.address, info.length);</span>
                    <span class="s1">}</span>
                    <span class="s1">emnapiExternalMemory.wasmMemoryViewTable.set(newView, info);</span>
                    <span class="s0">return </span><span class="s1">newView;</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">view;</span>
            <span class="s1">},</span>
            <span class="s1">getViewPointer: </span><span class="s0">function </span><span class="s1">(view, shouldCopy) {</span>
                <span class="s1">view = emnapiExternalMemory.getOrUpdateMemoryView(view);</span>
                <span class="s0">if </span><span class="s1">(view.buffer === wasmMemory.buffer) {</span>
                    <span class="s0">if </span><span class="s1">(emnapiExternalMemory.wasmMemoryViewTable.has(view)) {</span>
                        <span class="s0">var </span><span class="s1">_a = emnapiExternalMemory.wasmMemoryViewTable.get(view), address_1 = _a.address, ownership_1 = _a.ownership, runtimeAllocated_1 = _a.runtimeAllocated;</span>
                        <span class="s0">return </span><span class="s1">{ address: address_1, ownership: ownership_1, runtimeAllocated: runtimeAllocated_1, view: view };</span>
                    <span class="s1">}</span>
                    <span class="s0">return </span><span class="s1">{ address: view.byteOffset, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0</span><span class="s1">, view: view };</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">_b = emnapiExternalMemory.getArrayBufferPointer(view.buffer, shouldCopy), address = _b.address, ownership = _b.ownership, runtimeAllocated = _b.runtimeAllocated;</span>
                <span class="s0">return </span><span class="s1">{ address: address === </span><span class="s3">0 </span><span class="s1">? </span><span class="s3">0 </span><span class="s1">: (address + view.byteOffset), ownership: ownership, runtimeAllocated: runtimeAllocated, view: view };</span>
            <span class="s1">}</span>
        <span class="s1">};</span>
        <span class="s0">var </span><span class="s1">emnapiString = {</span>
            <span class="s1">utf8Decoder: undefined,</span>
            <span class="s1">utf16Decoder: undefined,</span>
            <span class="s1">init: </span><span class="s0">function </span><span class="s1">() {</span>
                <span class="s0">var </span><span class="s1">fallbackDecoder = {</span>
                    <span class="s1">decode: </span><span class="s0">function </span><span class="s1">(bytes) {</span>
                        <span class="s0">var </span><span class="s1">inputIndex = </span><span class="s3">0</span><span class="s1">;</span>
                        <span class="s0">var </span><span class="s1">pendingSize = Math.min(</span><span class="s3">0x1000</span><span class="s1">, bytes.length + </span><span class="s3">1</span><span class="s1">);</span>
                        <span class="s0">var </span><span class="s1">pending = </span><span class="s0">new </span><span class="s1">Uint16Array(pendingSize);</span>
                        <span class="s0">var </span><span class="s1">chunks = [];</span>
                        <span class="s0">var </span><span class="s1">pendingIndex = </span><span class="s3">0</span><span class="s1">;</span>
                        <span class="s0">for </span><span class="s1">(;;) {</span>
                            <span class="s0">var </span><span class="s1">more = inputIndex &lt; bytes.length;</span>
                            <span class="s0">if </span><span class="s1">(!more || (pendingIndex &gt;= pendingSize - </span><span class="s3">1</span><span class="s1">)) {</span>
                                <span class="s0">var </span><span class="s1">subarray = pending.subarray(</span><span class="s3">0</span><span class="s1">, pendingIndex);</span>
                                <span class="s0">var </span><span class="s1">arraylike = subarray;</span>
                                <span class="s1">chunks.push(String.fromCharCode.apply(</span><span class="s0">null</span><span class="s1">, arraylike));</span>
                                <span class="s0">if </span><span class="s1">(!more) {</span>
                                    <span class="s0">return </span><span class="s1">chunks.join(</span><span class="s2">''</span><span class="s1">);</span>
                                <span class="s1">}</span>
                                <span class="s1">bytes = bytes.subarray(inputIndex);</span>
                                <span class="s1">inputIndex = </span><span class="s3">0</span><span class="s1">;</span>
                                <span class="s1">pendingIndex = </span><span class="s3">0</span><span class="s1">;</span>
                            <span class="s1">}</span>
                            <span class="s0">var </span><span class="s1">byte1 = bytes[inputIndex++];</span>
                            <span class="s0">if </span><span class="s1">((byte1 &amp; </span><span class="s3">0x80</span><span class="s1">) === </span><span class="s3">0</span><span class="s1">) {</span>
                                <span class="s1">pending[pendingIndex++] = byte1;</span>
                            <span class="s1">}</span>
                            <span class="s0">else if </span><span class="s1">((byte1 &amp; </span><span class="s3">0xe0</span><span class="s1">) === </span><span class="s3">0xc0</span><span class="s1">) {</span>
                                <span class="s0">var </span><span class="s1">byte2 = bytes[inputIndex++] &amp; </span><span class="s3">0x3f</span><span class="s1">;</span>
                                <span class="s1">pending[pendingIndex++] = ((byte1 &amp; </span><span class="s3">0x1f</span><span class="s1">) &lt;&lt; </span><span class="s3">6</span><span class="s1">) | byte2;</span>
                            <span class="s1">}</span>
                            <span class="s0">else if </span><span class="s1">((byte1 &amp; </span><span class="s3">0xf0</span><span class="s1">) === </span><span class="s3">0xe0</span><span class="s1">) {</span>
                                <span class="s0">var </span><span class="s1">byte2 = bytes[inputIndex++] &amp; </span><span class="s3">0x3f</span><span class="s1">;</span>
                                <span class="s0">var </span><span class="s1">byte3 = bytes[inputIndex++] &amp; </span><span class="s3">0x3f</span><span class="s1">;</span>
                                <span class="s1">pending[pendingIndex++] = ((byte1 &amp; </span><span class="s3">0x1f</span><span class="s1">) &lt;&lt; </span><span class="s3">12</span><span class="s1">) | (byte2 &lt;&lt; </span><span class="s3">6</span><span class="s1">) | byte3;</span>
                            <span class="s1">}</span>
                            <span class="s0">else if </span><span class="s1">((byte1 &amp; </span><span class="s3">0xf8</span><span class="s1">) === </span><span class="s3">0xf0</span><span class="s1">) {</span>
                                <span class="s0">var </span><span class="s1">byte2 = bytes[inputIndex++] &amp; </span><span class="s3">0x3f</span><span class="s1">;</span>
                                <span class="s0">var </span><span class="s1">byte3 = bytes[inputIndex++] &amp; </span><span class="s3">0x3f</span><span class="s1">;</span>
                                <span class="s0">var </span><span class="s1">byte4 = bytes[inputIndex++] &amp; </span><span class="s3">0x3f</span><span class="s1">;</span>
                                <span class="s0">var </span><span class="s1">codepoint = ((byte1 &amp; </span><span class="s3">0x07</span><span class="s1">) &lt;&lt; </span><span class="s3">0x12</span><span class="s1">) | (byte2 &lt;&lt; </span><span class="s3">0x0c</span><span class="s1">) | (byte3 &lt;&lt; </span><span class="s3">0x06</span><span class="s1">) | byte4;</span>
                                <span class="s0">if </span><span class="s1">(codepoint &gt; </span><span class="s3">0xffff</span><span class="s1">) {</span>
                                    <span class="s1">codepoint -= </span><span class="s3">0x10000</span><span class="s1">;</span>
                                    <span class="s1">pending[pendingIndex++] = (codepoint &gt;&gt;&gt; </span><span class="s3">10</span><span class="s1">) &amp; </span><span class="s3">0x3ff </span><span class="s1">| </span><span class="s3">0xd800</span><span class="s1">;</span>
                                    <span class="s1">codepoint = </span><span class="s3">0xdc00 </span><span class="s1">| codepoint &amp; </span><span class="s3">0x3ff</span><span class="s1">;</span>
                                <span class="s1">}</span>
                                <span class="s1">pending[pendingIndex++] = codepoint;</span>
                            <span class="s1">}</span>
                            <span class="s0">else </span><span class="s1">;</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                <span class="s1">};</span>
                <span class="s0">var </span><span class="s1">utf8Decoder;</span>
                <span class="s1">utf8Decoder = </span><span class="s0">typeof </span><span class="s1">TextDecoder === </span><span class="s2">'function' </span><span class="s1">? </span><span class="s0">new </span><span class="s1">TextDecoder() : fallbackDecoder;</span>
                <span class="s1">emnapiString.utf8Decoder = utf8Decoder;</span>
                <span class="s0">var </span><span class="s1">fallbackDecoder2 = {</span>
                    <span class="s1">decode: </span><span class="s0">function </span><span class="s1">(input) {</span>
                        <span class="s0">var </span><span class="s1">bytes = </span><span class="s0">new </span><span class="s1">Uint16Array(input.buffer, input.byteOffset, input.byteLength / </span><span class="s3">2</span><span class="s1">);</span>
                        <span class="s0">if </span><span class="s1">(bytes.length &lt;= </span><span class="s3">0x1000</span><span class="s1">) {</span>
                            <span class="s0">return </span><span class="s1">String.fromCharCode.apply(</span><span class="s0">null</span><span class="s1">, bytes);</span>
                        <span class="s1">}</span>
                        <span class="s0">var </span><span class="s1">chunks = [];</span>
                        <span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">;</span>
                        <span class="s0">var </span><span class="s1">len = </span><span class="s3">0</span><span class="s1">;</span>
                        <span class="s0">for </span><span class="s1">(; i &lt; bytes.length; i += len) {</span>
                            <span class="s1">len = Math.min(</span><span class="s3">0x1000</span><span class="s1">, bytes.length - i);</span>
                            <span class="s1">chunks.push(String.fromCharCode.apply(</span><span class="s0">null</span><span class="s1">, bytes.subarray(i, i + len)));</span>
                        <span class="s1">}</span>
                        <span class="s0">return </span><span class="s1">chunks.join(</span><span class="s2">''</span><span class="s1">);</span>
                    <span class="s1">}</span>
                <span class="s1">};</span>
                <span class="s0">var </span><span class="s1">utf16Decoder;</span>
                <span class="s1">utf16Decoder = </span><span class="s0">typeof </span><span class="s1">TextDecoder === </span><span class="s2">'function' </span><span class="s1">? </span><span class="s0">new </span><span class="s1">TextDecoder(</span><span class="s2">'utf-16le'</span><span class="s1">) : fallbackDecoder2;</span>
                <span class="s1">emnapiString.utf16Decoder = utf16Decoder;</span>
            <span class="s1">},</span>
            <span class="s1">lengthBytesUTF8: </span><span class="s0">function </span><span class="s1">(str) {</span>
                <span class="s0">var </span><span class="s1">c;</span>
                <span class="s0">var </span><span class="s1">len = </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; str.length; ++i) {</span>
                    <span class="s1">c = str.charCodeAt(i);</span>
                    <span class="s0">if </span><span class="s1">(c &lt;= </span><span class="s3">0x7F</span><span class="s1">) {</span>
                        <span class="s1">len++;</span>
                    <span class="s1">}</span>
                    <span class="s0">else if </span><span class="s1">(c &lt;= </span><span class="s3">0x7FF</span><span class="s1">) {</span>
                        <span class="s1">len += </span><span class="s3">2</span><span class="s1">;</span>
                    <span class="s1">}</span>
                    <span class="s0">else if </span><span class="s1">(c &gt;= </span><span class="s3">0xD800 </span><span class="s1">&amp;&amp; c &lt;= </span><span class="s3">0xDFFF</span><span class="s1">) {</span>
                        <span class="s1">len += </span><span class="s3">4</span><span class="s1">;</span>
                        <span class="s1">++i;</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s1">len += </span><span class="s3">3</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">len;</span>
            <span class="s1">},</span>
            <span class="s1">UTF8ToString: </span><span class="s0">function </span><span class="s1">(ptr, length) {</span>
                <span class="s0">if </span><span class="s1">(!ptr || !length)</span>
                    <span class="s0">return </span><span class="s2">''</span><span class="s1">;</span>
                <span class="s1">ptr &gt;&gt;&gt;= </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAPU8 = </span><span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer);</span>
                <span class="s0">var </span><span class="s1">end = ptr;</span>
                <span class="s0">if </span><span class="s1">(length === -</span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s0">for </span><span class="s1">(; HEAPU8[end];)</span>
                        <span class="s1">++end;</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">end = ptr + (length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">length = end - ptr;</span>
                <span class="s0">if </span><span class="s1">(length &lt;= </span><span class="s3">16</span><span class="s1">) {</span>
                    <span class="s0">var </span><span class="s1">idx = ptr;</span>
                    <span class="s0">var </span><span class="s1">str = </span><span class="s2">''</span><span class="s1">;</span>
                    <span class="s0">while </span><span class="s1">(idx &lt; end) {</span>
                        <span class="s0">var </span><span class="s1">u0 = HEAPU8[idx++];</span>
                        <span class="s0">if </span><span class="s1">(!(u0 &amp; </span><span class="s3">0x80</span><span class="s1">)) {</span>
                            <span class="s1">str += String.fromCharCode(u0);</span>
                            <span class="s0">continue</span><span class="s1">;</span>
                        <span class="s1">}</span>
                        <span class="s0">var </span><span class="s1">u1 = HEAPU8[idx++] &amp; </span><span class="s3">63</span><span class="s1">;</span>
                        <span class="s0">if </span><span class="s1">((u0 &amp; </span><span class="s3">0xE0</span><span class="s1">) === </span><span class="s3">0xC0</span><span class="s1">) {</span>
                            <span class="s1">str += String.fromCharCode(((u0 &amp; </span><span class="s3">31</span><span class="s1">) &lt;&lt; </span><span class="s3">6</span><span class="s1">) | u1);</span>
                            <span class="s0">continue</span><span class="s1">;</span>
                        <span class="s1">}</span>
                        <span class="s0">var </span><span class="s1">u2 = HEAPU8[idx++] &amp; </span><span class="s3">63</span><span class="s1">;</span>
                        <span class="s0">if </span><span class="s1">((u0 &amp; </span><span class="s3">0xF0</span><span class="s1">) === </span><span class="s3">0xE0</span><span class="s1">) {</span>
                            <span class="s1">u0 = ((u0 &amp; </span><span class="s3">15</span><span class="s1">) &lt;&lt; </span><span class="s3">12</span><span class="s1">) | (u1 &lt;&lt; </span><span class="s3">6</span><span class="s1">) | u2;</span>
                        <span class="s1">}</span>
                        <span class="s0">else </span><span class="s1">{</span>
                            <span class="s1">u0 = ((u0 &amp; </span><span class="s3">7</span><span class="s1">) &lt;&lt; </span><span class="s3">18</span><span class="s1">) | (u1 &lt;&lt; </span><span class="s3">12</span><span class="s1">) | (u2 &lt;&lt; </span><span class="s3">6</span><span class="s1">) | (HEAPU8[idx++] &amp; </span><span class="s3">63</span><span class="s1">);</span>
                        <span class="s1">}</span>
                        <span class="s0">if </span><span class="s1">(u0 &lt; </span><span class="s3">0x10000</span><span class="s1">) {</span>
                            <span class="s1">str += String.fromCharCode(u0);</span>
                        <span class="s1">}</span>
                        <span class="s0">else </span><span class="s1">{</span>
                            <span class="s0">var </span><span class="s1">ch = u0 - </span><span class="s3">0x10000</span><span class="s1">;</span>
                            <span class="s1">str += String.fromCharCode(</span><span class="s3">0xD800 </span><span class="s1">| (ch &gt;&gt; </span><span class="s3">10</span><span class="s1">), </span><span class="s3">0xDC00 </span><span class="s1">| (ch &amp; </span><span class="s3">0x3FF</span><span class="s1">));</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                    <span class="s0">return </span><span class="s1">str;</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">emnapiString.utf8Decoder.decode(((</span><span class="s0">typeof </span><span class="s1">SharedArrayBuffer === </span><span class="s2">&quot;function&quot; </span><span class="s1">&amp;&amp; HEAPU8.buffer </span><span class="s0">instanceof </span><span class="s1">SharedArrayBuffer) || (Object.prototype.toString.call(HEAPU8.buffer) === </span><span class="s2">&quot;[object SharedArrayBuffer]&quot;</span><span class="s1">)) ? HEAPU8.slice(ptr, end) : HEAPU8.subarray(ptr, end));</span>
            <span class="s1">},</span>
            <span class="s1">stringToUTF8: </span><span class="s0">function </span><span class="s1">(str, outPtr, maxBytesToWrite) {</span>
                <span class="s0">var </span><span class="s1">HEAPU8 = </span><span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer);</span>
                <span class="s0">var </span><span class="s1">outIdx = outPtr;</span>
                <span class="s1">outIdx &gt;&gt;&gt;= </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(!(maxBytesToWrite &gt; </span><span class="s3">0</span><span class="s1">)) {</span>
                    <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">startIdx = outIdx;</span>
                <span class="s0">var </span><span class="s1">endIdx = outIdx + maxBytesToWrite - </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; str.length; ++i) {</span>
                    <span class="s0">var </span><span class="s1">u = str.charCodeAt(i);</span>
                    <span class="s0">if </span><span class="s1">(u &gt;= </span><span class="s3">0xD800 </span><span class="s1">&amp;&amp; u &lt;= </span><span class="s3">0xDFFF</span><span class="s1">) {</span>
                        <span class="s0">var </span><span class="s1">u1 = str.charCodeAt(++i);</span>
                        <span class="s1">u = </span><span class="s3">0x10000 </span><span class="s1">+ ((u &amp; </span><span class="s3">0x3FF</span><span class="s1">) &lt;&lt; </span><span class="s3">10</span><span class="s1">) | (u1 &amp; </span><span class="s3">0x3FF</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(u &lt;= </span><span class="s3">0x7F</span><span class="s1">) {</span>
                        <span class="s0">if </span><span class="s1">(outIdx &gt;= endIdx)</span>
                            <span class="s0">break</span><span class="s1">;</span>
                        <span class="s1">HEAPU8[outIdx++] = u;</span>
                    <span class="s1">}</span>
                    <span class="s0">else if </span><span class="s1">(u &lt;= </span><span class="s3">0x7FF</span><span class="s1">) {</span>
                        <span class="s0">if </span><span class="s1">(outIdx + </span><span class="s3">1 </span><span class="s1">&gt;= endIdx)</span>
                            <span class="s0">break</span><span class="s1">;</span>
                        <span class="s1">HEAPU8[outIdx++] = </span><span class="s3">0xC0 </span><span class="s1">| (u &gt;&gt; </span><span class="s3">6</span><span class="s1">);</span>
                        <span class="s1">HEAPU8[outIdx++] = </span><span class="s3">0x80 </span><span class="s1">| (u &amp; </span><span class="s3">63</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s0">else if </span><span class="s1">(u &lt;= </span><span class="s3">0xFFFF</span><span class="s1">) {</span>
                        <span class="s0">if </span><span class="s1">(outIdx + </span><span class="s3">2 </span><span class="s1">&gt;= endIdx)</span>
                            <span class="s0">break</span><span class="s1">;</span>
                        <span class="s1">HEAPU8[outIdx++] = </span><span class="s3">0xE0 </span><span class="s1">| (u &gt;&gt; </span><span class="s3">12</span><span class="s1">);</span>
                        <span class="s1">HEAPU8[outIdx++] = </span><span class="s3">0x80 </span><span class="s1">| ((u &gt;&gt; </span><span class="s3">6</span><span class="s1">) &amp; </span><span class="s3">63</span><span class="s1">);</span>
                        <span class="s1">HEAPU8[outIdx++] = </span><span class="s3">0x80 </span><span class="s1">| (u &amp; </span><span class="s3">63</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s0">if </span><span class="s1">(outIdx + </span><span class="s3">3 </span><span class="s1">&gt;= endIdx)</span>
                            <span class="s0">break</span><span class="s1">;</span>
                        <span class="s1">HEAPU8[outIdx++] = </span><span class="s3">0xF0 </span><span class="s1">| (u &gt;&gt; </span><span class="s3">18</span><span class="s1">);</span>
                        <span class="s1">HEAPU8[outIdx++] = </span><span class="s3">0x80 </span><span class="s1">| ((u &gt;&gt; </span><span class="s3">12</span><span class="s1">) &amp; </span><span class="s3">63</span><span class="s1">);</span>
                        <span class="s1">HEAPU8[outIdx++] = </span><span class="s3">0x80 </span><span class="s1">| ((u &gt;&gt; </span><span class="s3">6</span><span class="s1">) &amp; </span><span class="s3">63</span><span class="s1">);</span>
                        <span class="s1">HEAPU8[outIdx++] = </span><span class="s3">0x80 </span><span class="s1">| (u &amp; </span><span class="s3">63</span><span class="s1">);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s1">HEAPU8[outIdx] = </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">return </span><span class="s1">outIdx - startIdx;</span>
            <span class="s1">},</span>
            <span class="s1">UTF16ToString: </span><span class="s0">function </span><span class="s1">(ptr, length) {</span>
                <span class="s0">if </span><span class="s1">(!ptr || !length)</span>
                    <span class="s0">return </span><span class="s2">''</span><span class="s1">;</span>
                <span class="s1">ptr &gt;&gt;&gt;= </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">end = ptr;</span>
                <span class="s0">if </span><span class="s1">(length === -</span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s0">var </span><span class="s1">idx = end &gt;&gt; </span><span class="s3">1</span><span class="s1">;</span>
                    <span class="s0">var </span><span class="s1">HEAPU16 = </span><span class="s0">new </span><span class="s1">Uint16Array(wasmMemory.buffer);</span>
                    <span class="s0">while </span><span class="s1">(HEAPU16[idx])</span>
                        <span class="s1">++idx;</span>
                    <span class="s1">end = idx &lt;&lt; </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">end = ptr + (length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">) * </span><span class="s3">2</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s1">length = end - ptr;</span>
                <span class="s0">if </span><span class="s1">(length &lt;= </span><span class="s3">32</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">String.fromCharCode.apply(</span><span class="s0">null</span><span class="s1">, </span><span class="s0">new </span><span class="s1">Uint16Array(wasmMemory.buffer, ptr, length / </span><span class="s3">2</span><span class="s1">));</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">HEAPU8 = </span><span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer);</span>
                <span class="s0">return </span><span class="s1">emnapiString.utf16Decoder.decode(((</span><span class="s0">typeof </span><span class="s1">SharedArrayBuffer === </span><span class="s2">&quot;function&quot; </span><span class="s1">&amp;&amp; HEAPU8.buffer </span><span class="s0">instanceof </span><span class="s1">SharedArrayBuffer) || (Object.prototype.toString.call(HEAPU8.buffer) === </span><span class="s2">&quot;[object SharedArrayBuffer]&quot;</span><span class="s1">)) ? HEAPU8.slice(ptr, end) : HEAPU8.subarray(ptr, end));</span>
            <span class="s1">},</span>
            <span class="s1">stringToUTF16: </span><span class="s0">function </span><span class="s1">(str, outPtr, maxBytesToWrite) {</span>
                <span class="s0">if </span><span class="s1">(maxBytesToWrite === undefined) {</span>
                    <span class="s1">maxBytesToWrite = </span><span class="s3">0x7FFFFFFF</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(maxBytesToWrite &lt; </span><span class="s3">2</span><span class="s1">)</span>
                    <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s1">maxBytesToWrite -= </span><span class="s3">2</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">startPtr = outPtr;</span>
                <span class="s0">var </span><span class="s1">numCharsToWrite = (maxBytesToWrite &lt; str.length * </span><span class="s3">2</span><span class="s1">) ? (maxBytesToWrite / </span><span class="s3">2</span><span class="s1">) : str.length;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; numCharsToWrite; ++i) {</span>
                    <span class="s0">var </span><span class="s1">codeUnit = str.charCodeAt(i);</span>
                    <span class="s1">HEAP_DATA_VIEW.setInt16(outPtr, codeUnit, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">outPtr += </span><span class="s3">2</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s1">HEAP_DATA_VIEW.setInt16(outPtr, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">outPtr - startPtr;</span>
            <span class="s1">},</span>
            <span class="s1">newString: </span><span class="s0">function </span><span class="s1">(env, str, length, result, stringMaker) {</span>
                <span class="s0">if </span><span class="s1">(!env)</span>
                    <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s1">envObject.checkGCAccess();</span>
                <span class="s0">var </span><span class="s1">autoLength = length === -</span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">sizelength = length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(length !== </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">if </span><span class="s1">(!str)</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!(autoLength || (sizelength &lt;= </span><span class="s3">2147483647</span><span class="s1">)))</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">strValue = stringMaker(str, autoLength, sizelength);</span>
                <span class="s0">var </span><span class="s1">value = emnapiCtx.addToCurrentScope(strValue).id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">},</span>
            <span class="s1">newExternalString: </span><span class="s0">function </span><span class="s1">(env, str, length, finalize_callback, finalize_hint, result, copied, createApi, stringMaker) {</span>
                <span class="s0">if </span><span class="s1">(!env)</span>
                    <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
                <span class="s1">envObject.checkGCAccess();</span>
                <span class="s0">var </span><span class="s1">autoLength = length === -</span><span class="s3">1</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">sizelength = length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(length !== </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">if </span><span class="s1">(!str)</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!(autoLength || (sizelength &lt;= </span><span class="s3">2147483647</span><span class="s1">)))</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">status = createApi(env, str, length, result);</span>
                <span class="s0">if </span><span class="s1">(status === </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">if </span><span class="s1">(copied) {</span>
                        <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                        <span class="s1">HEAP_DATA_VIEW.setInt8(copied, </span><span class="s3">1</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(finalize_callback) {</span>
                        <span class="s1">envObject.callFinalizer(finalize_callback, str, finalize_hint);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">status;</span>
            <span class="s1">}</span>
        <span class="s1">};</span>
        <span class="s0">function </span><span class="s1">napi_get_array_length(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!value)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
                <span class="s0">if </span><span class="s1">(!handle.isArray()) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">8</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v = handle.value.length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_arraybuffer_info(env, arraybuffer, data, byte_length) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!arraybuffer)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(arraybuffer);</span>
            <span class="s0">if </span><span class="s1">(!handle.isArrayBuffer()) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(data) {</span>
                <span class="s0">var </span><span class="s1">p = emnapiExternalMemory.getArrayBufferPointer(handle.value, </span><span class="s0">true</span><span class="s1">).address;</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(data, p, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(byte_length) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(byte_length, handle.value.byteLength, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_prototype(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!value)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
                <span class="s0">if </span><span class="s1">(handle.value == </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert undefined or null to object'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s1">v = handle.isObject() || handle.isFunction() ? handle.value : Object(handle.value);</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(_) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">p = envObject.ensureHandleId(Object.getPrototypeOf(v));</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, p, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_typedarray_info(env, typedarray, type, length, data, arraybuffer, byte_offset) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!typedarray)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(typedarray);</span>
            <span class="s0">if </span><span class="s1">(!handle.isTypedArray()) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">v = handle.value;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(type) {</span>
                <span class="s0">var </span><span class="s1">t = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(v </span><span class="s0">instanceof </span><span class="s1">Int8Array) {</span>
                    <span class="s1">t = </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(v </span><span class="s0">instanceof </span><span class="s1">Uint8Array) {</span>
                    <span class="s1">t = </span><span class="s3">1</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(v </span><span class="s0">instanceof </span><span class="s1">Uint8ClampedArray) {</span>
                    <span class="s1">t = </span><span class="s3">2</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(v </span><span class="s0">instanceof </span><span class="s1">Int16Array) {</span>
                    <span class="s1">t = </span><span class="s3">3</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(v </span><span class="s0">instanceof </span><span class="s1">Uint16Array) {</span>
                    <span class="s1">t = </span><span class="s3">4</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(v </span><span class="s0">instanceof </span><span class="s1">Int32Array) {</span>
                    <span class="s1">t = </span><span class="s3">5</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(v </span><span class="s0">instanceof </span><span class="s1">Uint32Array) {</span>
                    <span class="s1">t = </span><span class="s3">6</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(v </span><span class="s0">instanceof </span><span class="s1">Float32Array) {</span>
                    <span class="s1">t = </span><span class="s3">7</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(v </span><span class="s0">instanceof </span><span class="s1">Float64Array) {</span>
                    <span class="s1">t = </span><span class="s3">8</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(v </span><span class="s0">instanceof </span><span class="s1">BigInt64Array) {</span>
                    <span class="s1">t = </span><span class="s3">9</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(v </span><span class="s0">instanceof </span><span class="s1">BigUint64Array) {</span>
                    <span class="s1">t = </span><span class="s3">10</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">HEAP_DATA_VIEW.setInt32(type, t, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(length) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(length, v.length, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">buffer;</span>
            <span class="s0">if </span><span class="s1">(data || arraybuffer) {</span>
                <span class="s1">buffer = v.buffer;</span>
                <span class="s0">if </span><span class="s1">(data) {</span>
                    <span class="s0">var </span><span class="s1">p = emnapiExternalMemory.getViewPointer(v, </span><span class="s0">true</span><span class="s1">).address;</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(data, p, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(arraybuffer) {</span>
                    <span class="s0">var </span><span class="s1">ab = envObject.ensureHandleId(buffer);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(arraybuffer, ab, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(byte_offset) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(byte_offset, v.byteOffset, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_buffer_info(env, buffer, data, length) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!buffer)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(buffer);</span>
            <span class="s0">if </span><span class="s1">(!handle.isBuffer(emnapiCtx.feature.Buffer))</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(handle.isDataView()) {</span>
                <span class="s0">return </span><span class="s1">napi_get_dataview_info(env, buffer, length, data, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">napi_get_typedarray_info(env, buffer, </span><span class="s3">0</span><span class="s1">, length, data, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_dataview_info(env, dataview, byte_length, data, arraybuffer, byte_offset) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!dataview)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(dataview);</span>
            <span class="s0">if </span><span class="s1">(!handle.isDataView()) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">v = handle.value;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(byte_length) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(byte_length, v.byteLength, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">buffer;</span>
            <span class="s0">if </span><span class="s1">(data || arraybuffer) {</span>
                <span class="s1">buffer = v.buffer;</span>
                <span class="s0">if </span><span class="s1">(data) {</span>
                    <span class="s0">var </span><span class="s1">p = emnapiExternalMemory.getViewPointer(v, </span><span class="s0">true</span><span class="s1">).address;</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(data, p, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(arraybuffer) {</span>
                    <span class="s0">var </span><span class="s1">ab = envObject.ensureHandleId(buffer);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(arraybuffer, ab, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(byte_offset) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(byte_offset, v.byteOffset, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_date_value(env, value, result) {</span>
            <span class="s0">var </span><span class="s1">v;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!value)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
                <span class="s0">if </span><span class="s1">(!handle.isDate()) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">v = handle.value.valueOf();</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setFloat64(result, v, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_bool(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">handle.value !== </span><span class="s2">'boolean'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">7</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">r = handle.value ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_double(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">handle.value !== </span><span class="s2">'number'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">6</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">r = handle.value;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setFloat64(result, r, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_bigint_int64(env, value, result, lossless) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.supportBigInt) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!lossless)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">var </span><span class="s1">numberValue = handle.value;</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">numberValue !== </span><span class="s2">'bigint'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">6</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">((numberValue &gt;= (BigInt(-</span><span class="s3">1</span><span class="s1">) * (BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">63</span><span class="s1">)))) &amp;&amp; (numberValue &lt; (BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">63</span><span class="s1">)))) {</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(lossless, </span><span class="s3">1</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(lossless, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">numberValue = numberValue &amp; ((BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">64</span><span class="s1">)) - BigInt(</span><span class="s3">1</span><span class="s1">));</span>
                <span class="s0">if </span><span class="s1">(numberValue &gt;= (BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">63</span><span class="s1">))) {</span>
                    <span class="s1">numberValue = numberValue - (BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">64</span><span class="s1">));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">low = Number(numberValue &amp; BigInt(</span><span class="s3">0xffffffff</span><span class="s1">));</span>
            <span class="s0">var </span><span class="s1">high = Number(numberValue &gt;&gt; BigInt(</span><span class="s3">32</span><span class="s1">));</span>
            <span class="s1">HEAP_DATA_VIEW.setInt32(result, low, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt32(result + </span><span class="s3">4</span><span class="s1">, high, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_bigint_uint64(env, value, result, lossless) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.supportBigInt) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!lossless)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">var </span><span class="s1">numberValue = handle.value;</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">numberValue !== </span><span class="s2">'bigint'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">6</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">((numberValue &gt;= BigInt(</span><span class="s3">0</span><span class="s1">)) &amp;&amp; (numberValue &lt; (BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">64</span><span class="s1">)))) {</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(lossless, </span><span class="s3">1</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(lossless, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">numberValue = numberValue &amp; ((BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">64</span><span class="s1">)) - BigInt(</span><span class="s3">1</span><span class="s1">));</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">low = Number(numberValue &amp; BigInt(</span><span class="s3">0xffffffff</span><span class="s1">));</span>
            <span class="s0">var </span><span class="s1">high = Number(numberValue &gt;&gt; BigInt(</span><span class="s3">32</span><span class="s1">));</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, low, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result + </span><span class="s3">4</span><span class="s1">, high, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_bigint_words(env, value, sign_bit, word_count, words) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.supportBigInt) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!word_count)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">if </span><span class="s1">(!handle.isBigInt()) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">17</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">isMinus = handle.value &lt; BigInt(</span><span class="s3">0</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">var </span><span class="s1">word_count_int = HEAP_DATA_VIEW.getUint32(word_count, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">wordCount = </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">bigintValue = isMinus ? (handle.value * BigInt(-</span><span class="s3">1</span><span class="s1">)) : handle.value;</span>
            <span class="s0">while </span><span class="s1">(bigintValue !== BigInt(</span><span class="s3">0</span><span class="s1">)) {</span>
                <span class="s1">wordCount++;</span>
                <span class="s1">bigintValue = bigintValue &gt;&gt; BigInt(</span><span class="s3">64</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s1">bigintValue = isMinus ? (handle.value * BigInt(-</span><span class="s3">1</span><span class="s1">)) : handle.value;</span>
            <span class="s0">if </span><span class="s1">(!sign_bit &amp;&amp; !words) {</span>
                <span class="s1">word_count_int = wordCount;</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(word_count, word_count_int, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!sign_bit)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!words)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">wordsArr = [];</span>
                <span class="s0">while </span><span class="s1">(bigintValue !== BigInt(</span><span class="s3">0</span><span class="s1">)) {</span>
                    <span class="s0">var </span><span class="s1">uint64 = bigintValue &amp; ((BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">64</span><span class="s1">)) - BigInt(</span><span class="s3">1</span><span class="s1">));</span>
                    <span class="s1">wordsArr.push(uint64);</span>
                    <span class="s1">bigintValue = bigintValue &gt;&gt; BigInt(</span><span class="s3">64</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">len = Math.min(word_count_int, wordsArr.length);</span>
                <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; len; i++) {</span>
                    <span class="s0">var </span><span class="s1">low = Number(wordsArr[i] &amp; BigInt(</span><span class="s3">0xffffffff</span><span class="s1">));</span>
                    <span class="s0">var </span><span class="s1">high = Number(wordsArr[i] &gt;&gt; BigInt(</span><span class="s3">32</span><span class="s1">));</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(words + i * </span><span class="s3">8</span><span class="s1">, low, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(words + (i * </span><span class="s3">8 </span><span class="s1">+ </span><span class="s3">4</span><span class="s1">), high, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">HEAP_DATA_VIEW.setInt32(sign_bit, isMinus ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(word_count, len, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_external(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">if </span><span class="s1">(!handle.isExternal()) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">p = handle.data();</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, p, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_int32(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">handle.value !== </span><span class="s2">'number'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">6</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">v = </span><span class="s0">new </span><span class="s1">Int32Array([handle.value])[</span><span class="s3">0</span><span class="s1">];</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_int64(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">handle.value !== </span><span class="s2">'number'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">6</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">numberValue = handle.value;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(numberValue === Number.POSITIVE_INFINITY || numberValue === Number.NEGATIVE_INFINITY || isNaN(numberValue)) {</span>
                <span class="s1">HEAP_DATA_VIEW.setInt32(result, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">HEAP_DATA_VIEW.setInt32(result + </span><span class="s3">4</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(numberValue &lt; -</span><span class="s3">9223372036854776e3</span><span class="s1">) {</span>
                <span class="s1">HEAP_DATA_VIEW.setInt32(result, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">HEAP_DATA_VIEW.setInt32(result + </span><span class="s3">4</span><span class="s1">, </span><span class="s3">2147483648</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(numberValue &gt;= </span><span class="s3">9223372036854776000</span><span class="s1">) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, </span><span class="s3">4294967295</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result + </span><span class="s3">4</span><span class="s1">, </span><span class="s3">2147483647</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s1">$emnapiSetValueI64(result, Math.trunc(numberValue));</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_string_latin1(env, value, buf, buf_size, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">buf_size = buf_size &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">handle.value !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(!buf) {</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, handle.value.length, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(buf_size !== </span><span class="s3">0</span><span class="s1">) {</span>
                <span class="s0">var </span><span class="s1">copied = </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">v = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; buf_size - </span><span class="s3">1</span><span class="s1">; ++i) {</span>
                    <span class="s1">v = handle.value.charCodeAt(i) &amp; </span><span class="s3">0xff</span><span class="s1">;</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint8(buf + i, v, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">copied++;</span>
                <span class="s1">}</span>
                <span class="s1">HEAP_DATA_VIEW.setUint8(buf + copied, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(result) {</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(result, copied, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(result) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_string_utf8(env, value, buf, buf_size, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">buf_size = buf_size &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">handle.value !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(!buf) {</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">strLength = emnapiString.lengthBytesUTF8(handle.value);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, strLength, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(buf_size !== </span><span class="s3">0</span><span class="s1">) {</span>
                <span class="s0">var </span><span class="s1">copied = emnapiString.stringToUTF8(handle.value, buf, buf_size);</span>
                <span class="s0">if </span><span class="s1">(result) {</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(result, copied, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(result) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_string_utf16(env, value, buf, buf_size, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">buf_size = buf_size &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">handle.value !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(!buf) {</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, handle.value.length, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(buf_size !== </span><span class="s3">0</span><span class="s1">) {</span>
                <span class="s0">var </span><span class="s1">copied = emnapiString.stringToUTF16(handle.value, buf, buf_size * </span><span class="s3">2</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(result) {</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(result, copied / </span><span class="s3">2</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(result) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_value_uint32(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">handle.value !== </span><span class="s2">'number'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">6</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">v = </span><span class="s0">new </span><span class="s1">Uint32Array([handle.value])[</span><span class="s3">0</span><span class="s1">];</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">convert2cMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_get_array_length: napi_get_array_length,</span>
            <span class="s1">napi_get_arraybuffer_info: napi_get_arraybuffer_info,</span>
            <span class="s1">napi_get_buffer_info: napi_get_buffer_info,</span>
            <span class="s1">napi_get_dataview_info: napi_get_dataview_info,</span>
            <span class="s1">napi_get_date_value: napi_get_date_value,</span>
            <span class="s1">napi_get_prototype: napi_get_prototype,</span>
            <span class="s1">napi_get_typedarray_info: napi_get_typedarray_info,</span>
            <span class="s1">napi_get_value_bigint_int64: napi_get_value_bigint_int64,</span>
            <span class="s1">napi_get_value_bigint_uint64: napi_get_value_bigint_uint64,</span>
            <span class="s1">napi_get_value_bigint_words: napi_get_value_bigint_words,</span>
            <span class="s1">napi_get_value_bool: napi_get_value_bool,</span>
            <span class="s1">napi_get_value_double: napi_get_value_double,</span>
            <span class="s1">napi_get_value_external: napi_get_value_external,</span>
            <span class="s1">napi_get_value_int32: napi_get_value_int32,</span>
            <span class="s1">napi_get_value_int64: napi_get_value_int64,</span>
            <span class="s1">napi_get_value_string_latin1: napi_get_value_string_latin1,</span>
            <span class="s1">napi_get_value_string_utf16: napi_get_value_string_utf16,</span>
            <span class="s1">napi_get_value_string_utf8: napi_get_value_string_utf8,</span>
            <span class="s1">napi_get_value_uint32: napi_get_value_uint32</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_create_int32(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">v = emnapiCtx.addToCurrentScope(value).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_uint32(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">v = emnapiCtx.addToCurrentScope(value &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_int64(env, low, high, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!high)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">value = Number(low);</span>
            <span class="s0">var </span><span class="s1">v1 = emnapiCtx.addToCurrentScope(value).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(high, v1, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_double(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">v = emnapiCtx.addToCurrentScope(value).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_string_latin1(env, str, length, result) {</span>
            <span class="s0">return </span><span class="s1">emnapiString.newString(env, str, length, result, </span><span class="s0">function </span><span class="s1">(str, autoLength, sizeLength) {</span>
                <span class="s0">var </span><span class="s1">latin1String = </span><span class="s2">''</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">len = </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">if </span><span class="s1">(autoLength) {</span>
                    <span class="s0">while </span><span class="s1">(</span><span class="s0">true</span><span class="s1">) {</span>
                        <span class="s0">var </span><span class="s1">ch = HEAP_DATA_VIEW.getUint8(str, </span><span class="s0">true</span><span class="s1">);</span>
                        <span class="s0">if </span><span class="s1">(!ch)</span>
                            <span class="s0">break</span><span class="s1">;</span>
                        <span class="s1">latin1String += String.fromCharCode(ch);</span>
                        <span class="s1">str++;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s0">while </span><span class="s1">(len &lt; sizeLength) {</span>
                        <span class="s0">var </span><span class="s1">ch = HEAP_DATA_VIEW.getUint8(str, </span><span class="s0">true</span><span class="s1">);</span>
                        <span class="s0">if </span><span class="s1">(!ch)</span>
                            <span class="s0">break</span><span class="s1">;</span>
                        <span class="s1">latin1String += String.fromCharCode(ch);</span>
                        <span class="s1">len++;</span>
                        <span class="s1">str++;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">latin1String;</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_string_utf16(env, str, length, result) {</span>
            <span class="s0">return </span><span class="s1">emnapiString.newString(env, str, length, result, </span><span class="s0">function </span><span class="s1">(str) {</span>
                <span class="s0">return </span><span class="s1">emnapiString.UTF16ToString(str, length);</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_string_utf8(env, str, length, result) {</span>
            <span class="s0">return </span><span class="s1">emnapiString.newString(env, str, length, result, </span><span class="s0">function </span><span class="s1">(str) {</span>
                <span class="s0">return </span><span class="s1">emnapiString.UTF8ToString(str, length);</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">node_api_create_external_string_latin1(env, str, length, finalize_callback, finalize_hint, result, copied) {</span>
            <span class="s0">return </span><span class="s1">emnapiString.newExternalString(env, str, length, finalize_callback, finalize_hint, result, copied, napi_create_string_latin1, undefined);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">node_api_create_external_string_utf16(env, str, length, finalize_callback, finalize_hint, result, copied) {</span>
            <span class="s0">return </span><span class="s1">emnapiString.newExternalString(env, str, length, finalize_callback, finalize_hint, result, copied, napi_create_string_utf16, undefined);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">node_api_create_property_key_latin1(env, str, length, result) {</span>
            <span class="s0">return </span><span class="s1">napi_create_string_latin1(env, str, length, result);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">node_api_create_property_key_utf8(env, str, length, result) {</span>
            <span class="s0">return </span><span class="s1">napi_create_string_utf8(env, str, length, result);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">node_api_create_property_key_utf16(env, str, length, result) {</span>
            <span class="s0">return </span><span class="s1">napi_create_string_utf16(env, str, length, result);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_bigint_int64(env, low, high, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.supportBigInt) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!high)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">value = low;</span>
            <span class="s0">var </span><span class="s1">v1 = emnapiCtx.addToCurrentScope(value).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(high, v1, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_bigint_uint64(env, low, high, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.supportBigInt) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!high)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">value = low &amp; ((BigInt(</span><span class="s3">1</span><span class="s1">) &lt;&lt; BigInt(</span><span class="s3">64</span><span class="s1">)) - BigInt(</span><span class="s3">1</span><span class="s1">));</span>
            <span class="s0">var </span><span class="s1">v1 = emnapiCtx.addToCurrentScope(value).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(high, v1, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_bigint_words(env, sign_bit, word_count, words, result) {</span>
            <span class="s0">var </span><span class="s1">v, i;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.supportBigInt) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">word_count = word_count &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(word_count &gt; </span><span class="s3">2147483647</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(word_count &gt; (</span><span class="s3">1024 </span><span class="s1">* </span><span class="s3">1024 </span><span class="s1">/ (</span><span class="s3">4 </span><span class="s1">* </span><span class="s3">8</span><span class="s1">) / </span><span class="s3">2</span><span class="s1">)) {</span>
                    <span class="s0">throw new </span><span class="s1">RangeError(</span><span class="s2">'Maximum BigInt size exceeded'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">value = BigInt(</span><span class="s3">0</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">for </span><span class="s1">(i = </span><span class="s3">0</span><span class="s1">; i &lt; word_count; i++) {</span>
                    <span class="s0">var </span><span class="s1">low = HEAP_DATA_VIEW.getUint32(words + i * </span><span class="s3">8</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">high = HEAP_DATA_VIEW.getUint32(words + (i * </span><span class="s3">8 </span><span class="s1">+ </span><span class="s3">4</span><span class="s1">), </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">wordi = BigInt(low) | (BigInt(high) &lt;&lt; BigInt(</span><span class="s3">32</span><span class="s1">));</span>
                    <span class="s1">value += wordi &lt;&lt; BigInt(</span><span class="s3">64 </span><span class="s1">* i);</span>
                <span class="s1">}</span>
                <span class="s1">value *= ((BigInt(sign_bit) % BigInt(</span><span class="s3">2</span><span class="s1">) === BigInt(</span><span class="s3">0</span><span class="s1">)) ? BigInt(</span><span class="s3">1</span><span class="s1">) : BigInt(-</span><span class="s3">1</span><span class="s1">));</span>
                <span class="s1">v = emnapiCtx.addToCurrentScope(value).id;</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">convert2napiMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_create_bigint_int64: napi_create_bigint_int64,</span>
            <span class="s1">napi_create_bigint_uint64: napi_create_bigint_uint64,</span>
            <span class="s1">napi_create_bigint_words: napi_create_bigint_words,</span>
            <span class="s1">napi_create_double: napi_create_double,</span>
            <span class="s1">napi_create_int32: napi_create_int32,</span>
            <span class="s1">napi_create_int64: napi_create_int64,</span>
            <span class="s1">napi_create_string_latin1: napi_create_string_latin1,</span>
            <span class="s1">napi_create_string_utf16: napi_create_string_utf16,</span>
            <span class="s1">napi_create_string_utf8: napi_create_string_utf8,</span>
            <span class="s1">napi_create_uint32: napi_create_uint32,</span>
            <span class="s1">node_api_create_external_string_latin1: node_api_create_external_string_latin1,</span>
            <span class="s1">node_api_create_external_string_utf16: node_api_create_external_string_utf16,</span>
            <span class="s1">node_api_create_property_key_latin1: node_api_create_property_key_latin1,</span>
            <span class="s1">node_api_create_property_key_utf16: node_api_create_property_key_utf16,</span>
            <span class="s1">node_api_create_property_key_utf8: node_api_create_property_key_utf8</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">emnapiCreateFunction(envObject, utf8name, length, cb, data) {</span>
            <span class="s0">var </span><span class="s1">functionName = (!utf8name || !length) ? </span><span class="s2">'' </span><span class="s1">: (emnapiString.UTF8ToString(utf8name, length));</span>
            <span class="s0">var </span><span class="s1">f;</span>
            <span class="s0">var </span><span class="s1">napiCallback = (wasmTable.get(cb));</span>
            <span class="s0">var </span><span class="s1">callback = </span><span class="s0">function </span><span class="s1">(envObject) {</span>
                <span class="s0">return </span><span class="s1">napiCallback(envObject.id, envObject.ctx.scopeStore.currentScope.id);</span>
            <span class="s1">};</span>
            <span class="s0">var </span><span class="s1">makeFunction = </span><span class="s0">function </span><span class="s1">(envObject, callback) {</span>
                <span class="s0">return function </span><span class="s1">() {</span>
                    <span class="s0">var </span><span class="s1">scope = envObject.ctx.openScope(envObject);</span>
                    <span class="s0">var </span><span class="s1">callbackInfo = scope.callbackInfo;</span>
                    <span class="s1">callbackInfo.data = data;</span>
                    <span class="s1">callbackInfo.args = arguments;</span>
                    <span class="s1">callbackInfo.thiz = </span><span class="s0">this</span><span class="s1">;</span>
                    <span class="s1">callbackInfo.fn = f;</span>
                    <span class="s0">try </span><span class="s1">{</span>
                        <span class="s0">var </span><span class="s1">napiValue = envObject.callIntoModule(callback);</span>
                        <span class="s0">return </span><span class="s1">(!napiValue) ? undefined : envObject.ctx.handleStore.get(napiValue).value;</span>
                    <span class="s1">}</span>
                    <span class="s0">finally </span><span class="s1">{</span>
                        <span class="s1">callbackInfo.data = </span><span class="s3">0</span><span class="s1">;</span>
                        <span class="s1">callbackInfo.args = undefined;</span>
                        <span class="s1">callbackInfo.thiz = undefined;</span>
                        <span class="s1">callbackInfo.fn = undefined;</span>
                        <span class="s1">envObject.ctx.closeScope(envObject, scope);</span>
                    <span class="s1">}</span>
                <span class="s1">};</span>
            <span class="s1">};</span>
            <span class="s0">if </span><span class="s1">(functionName === </span><span class="s2">''</span><span class="s1">) {</span>
                <span class="s1">f = makeFunction(envObject, callback);</span>
                <span class="s0">return </span><span class="s1">{ status: </span><span class="s3">0</span><span class="s1">, f: f };</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(!(</span><span class="s4">/^[_$a-zA-Z][_$a-zA-Z0-9]*$/</span><span class="s1">.test(functionName))) {</span>
                <span class="s0">return </span><span class="s1">{ status: </span><span class="s3">1</span><span class="s1">, f: undefined };</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(emnapiCtx.feature.supportNewFunction) {</span>
                <span class="s0">var </span><span class="s1">_ = makeFunction(envObject, callback);</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s1">f = (</span><span class="s0">new </span><span class="s1">Function(</span><span class="s2">'_'</span><span class="s1">, </span><span class="s2">'return function ' </span><span class="s1">+ functionName + </span><span class="s2">'(){' </span><span class="s1">+</span>
                        <span class="s2">'&quot;use strict&quot;;' </span><span class="s1">+</span>
                        <span class="s2">'return _.apply(this,arguments);' </span><span class="s1">+</span>
                        <span class="s2">'};'</span><span class="s1">))(_);</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(_err) {</span>
                    <span class="s1">f = makeFunction(envObject, callback);</span>
                    <span class="s0">if </span><span class="s1">(emnapiCtx.feature.canSetFunctionName)</span>
                        <span class="s1">Object.defineProperty(f, </span><span class="s2">'name'</span><span class="s1">, { value: functionName });</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s1">f = makeFunction(envObject, callback);</span>
                <span class="s0">if </span><span class="s1">(emnapiCtx.feature.canSetFunctionName)</span>
                    <span class="s1">Object.defineProperty(f, </span><span class="s2">'name'</span><span class="s1">, { value: functionName });</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">{ status: </span><span class="s3">0</span><span class="s1">, f: f };</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">emnapiDefineProperty(envObject, obj, propertyName, method, getter, setter, value, attributes, data) {</span>
            <span class="s0">if </span><span class="s1">(getter || setter) {</span>
                <span class="s0">var </span><span class="s1">localGetter = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">localSetter = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(getter) {</span>
                    <span class="s1">localGetter = emnapiCreateFunction(envObject, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, getter, data).f;</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(setter) {</span>
                    <span class="s1">localSetter = emnapiCreateFunction(envObject, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, setter, data).f;</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">desc = {</span>
                    <span class="s1">configurable: (attributes &amp; </span><span class="s3">4</span><span class="s1">) !== </span><span class="s3">0</span><span class="s1">,</span>
                    <span class="s1">enumerable: (attributes &amp; </span><span class="s3">2</span><span class="s1">) !== </span><span class="s3">0</span><span class="s1">,</span>
                    <span class="s1">get: localGetter,</span>
                    <span class="s1">set: localSetter</span>
                <span class="s1">};</span>
                <span class="s1">Object.defineProperty(obj, propertyName, desc);</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(method) {</span>
                <span class="s0">var </span><span class="s1">localMethod = emnapiCreateFunction(envObject, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, method, data).f;</span>
                <span class="s0">var </span><span class="s1">desc = {</span>
                    <span class="s1">configurable: (attributes &amp; </span><span class="s3">4</span><span class="s1">) !== </span><span class="s3">0</span><span class="s1">,</span>
                    <span class="s1">enumerable: (attributes &amp; </span><span class="s3">2</span><span class="s1">) !== </span><span class="s3">0</span><span class="s1">,</span>
                    <span class="s1">writable: (attributes &amp; </span><span class="s3">1</span><span class="s1">) !== </span><span class="s3">0</span><span class="s1">,</span>
                    <span class="s1">value: localMethod</span>
                <span class="s1">};</span>
                <span class="s1">Object.defineProperty(obj, propertyName, desc);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s0">var </span><span class="s1">desc = {</span>
                    <span class="s1">configurable: (attributes &amp; </span><span class="s3">4</span><span class="s1">) !== </span><span class="s3">0</span><span class="s1">,</span>
                    <span class="s1">enumerable: (attributes &amp; </span><span class="s3">2</span><span class="s1">) !== </span><span class="s3">0</span><span class="s1">,</span>
                    <span class="s1">writable: (attributes &amp; </span><span class="s3">1</span><span class="s1">) !== </span><span class="s3">0</span><span class="s1">,</span>
                    <span class="s1">value: emnapiCtx.handleStore.get(value).value</span>
                <span class="s1">};</span>
                <span class="s1">Object.defineProperty(obj, propertyName, desc);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">emnapiGetHandle(js_object) {</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(js_object);</span>
            <span class="s0">if </span><span class="s1">(!(handle.isObject() || handle.isFunction())) {</span>
                <span class="s0">return </span><span class="s1">{ status: </span><span class="s3">1 </span><span class="s1">};</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">emnapiExternalMemory !== </span><span class="s2">'undefined' </span><span class="s1">&amp;&amp; ArrayBuffer.isView(handle.value)) {</span>
                <span class="s0">if </span><span class="s1">(emnapiExternalMemory.wasmMemoryViewTable.has(handle.value)) {</span>
                    <span class="s1">handle = emnapiCtx.addToCurrentScope(emnapiExternalMemory.wasmMemoryViewTable.get(handle.value));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">{ status: </span><span class="s3">0</span><span class="s1">, handle: handle };</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">emnapiWrap(env, js_object, native_object, finalize_cb, finalize_hint, result) {</span>
            <span class="s0">var </span><span class="s1">referenceId;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.supportFinalizer) {</span>
                    <span class="s0">if </span><span class="s1">(finalize_cb) {</span>
                        <span class="s0">throw </span><span class="s1">emnapiCtx.createNotSupportWeakRefError(</span><span class="s2">'napi_wrap'</span><span class="s1">, </span><span class="s2">'Parameter &quot;finalize_cb&quot; must be 0(NULL)'</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(result) {</span>
                        <span class="s0">throw </span><span class="s1">emnapiCtx.createNotSupportWeakRefError(</span><span class="s2">'napi_wrap'</span><span class="s1">, </span><span class="s2">'Parameter &quot;result&quot; must be 0(NULL)'</span><span class="s1">);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!js_object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">handleResult = emnapiGetHandle(js_object);</span>
                <span class="s0">if </span><span class="s1">(handleResult.status !== </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(handleResult.status);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">handle = handleResult.handle;</span>
                <span class="s0">if </span><span class="s1">(envObject.getObjectBinding(handle.value).wrapped !== </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">reference = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(result) {</span>
                    <span class="s0">if </span><span class="s1">(!finalize_cb)</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                    <span class="s1">reference = emnapiCtx.createReferenceWithFinalizer(envObject, handle.id, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, finalize_cb, native_object, finalize_hint);</span>
                    <span class="s1">referenceId = reference.id;</span>
                    <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(result, referenceId, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s0">if </span><span class="s1">(finalize_cb) {</span>
                        <span class="s1">reference = emnapiCtx.createReferenceWithFinalizer(envObject, handle.id, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, finalize_cb, native_object, finalize_hint);</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s1">reference = emnapiCtx.createReferenceWithData(envObject, handle.id, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, native_object);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s1">envObject.getObjectBinding(handle.value).wrapped = reference.id;</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">emnapiUnwrap(env, js_object, result, action) {</span>
            <span class="s0">var </span><span class="s1">data;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!js_object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(action === </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">if </span><span class="s1">(!result)</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">value = emnapiCtx.handleStore.get(js_object);</span>
                <span class="s0">if </span><span class="s1">(!(value.isObject() || value.isFunction())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">binding = envObject.getObjectBinding(value.value);</span>
                <span class="s0">var </span><span class="s1">referenceId = binding.wrapped;</span>
                <span class="s0">var </span><span class="s1">ref = emnapiCtx.refStore.get(referenceId);</span>
                <span class="s0">if </span><span class="s1">(!ref)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(result) {</span>
                    <span class="s1">data = ref.data();</span>
                    <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(result, data, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(action === </span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s1">binding.wrapped = </span><span class="s3">0</span><span class="s1">;</span>
                    <span class="s0">if </span><span class="s1">(ref.ownership() === </span><span class="s3">1</span><span class="s1">) {</span>
                        <span class="s1">ref.resetFinalizer();</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s1">ref.dispose();</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_define_class(env, utf8name, length, constructor, callback_data, property_count, properties, result) {</span>
            <span class="s0">var </span><span class="s1">propPtr, valueHandleId, attributes;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!constructor)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">property_count = property_count &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(property_count &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">if </span><span class="s1">(!properties)</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">((length &lt; -</span><span class="s3">1</span><span class="s1">) || (length &gt; </span><span class="s3">2147483647</span><span class="s1">) || (!utf8name)) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">fresult = emnapiCreateFunction(envObject, utf8name, length, constructor, callback_data);</span>
                <span class="s0">if </span><span class="s1">(fresult.status !== </span><span class="s3">0</span><span class="s1">)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(fresult.status);</span>
                <span class="s0">var </span><span class="s1">F = fresult.f;</span>
                <span class="s0">var </span><span class="s1">propertyName = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; property_count; i++) {</span>
                    <span class="s1">propPtr = properties + (i * (</span><span class="s3">4 </span><span class="s1">* </span><span class="s3">8</span><span class="s1">));</span>
                    <span class="s0">var </span><span class="s1">utf8Name = HEAP_DATA_VIEW.getUint32(propPtr, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">name_1 = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">4</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">method = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">8</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">getter = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">12</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">setter = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">16</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">value = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">20</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">attributes = HEAP_DATA_VIEW.getInt32(propPtr + </span><span class="s3">24</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">data = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">28</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">if </span><span class="s1">(utf8Name) {</span>
                        <span class="s1">propertyName = emnapiString.UTF8ToString(utf8Name, -</span><span class="s3">1</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s0">if </span><span class="s1">(!name_1) {</span>
                            <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">4</span><span class="s1">);</span>
                        <span class="s1">}</span>
                        <span class="s1">propertyName = emnapiCtx.handleStore.get(name_1).value;</span>
                        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">propertyName !== </span><span class="s2">'string' </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">propertyName !== </span><span class="s2">'symbol'</span><span class="s1">) {</span>
                            <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">4</span><span class="s1">);</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">((attributes &amp; </span><span class="s3">1024</span><span class="s1">) !== </span><span class="s3">0</span><span class="s1">) {</span>
                        <span class="s1">emnapiDefineProperty(envObject, F, propertyName, method, getter, setter, value, attributes, data);</span>
                        <span class="s0">continue</span><span class="s1">;</span>
                    <span class="s1">}</span>
                    <span class="s1">emnapiDefineProperty(envObject, F.prototype, propertyName, method, getter, setter, value, attributes, data);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">valueHandle = emnapiCtx.addToCurrentScope(F);</span>
                <span class="s1">valueHandleId = valueHandle.id;</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, valueHandleId, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_wrap(env, js_object, native_object, finalize_cb, finalize_hint, result) {</span>
            <span class="s0">return </span><span class="s1">emnapiWrap(env, js_object, native_object, finalize_cb, finalize_hint, result);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_unwrap(env, js_object, result) {</span>
            <span class="s0">return </span><span class="s1">emnapiUnwrap(env, js_object, result, </span><span class="s3">0</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_remove_wrap(env, js_object, result) {</span>
            <span class="s0">return </span><span class="s1">emnapiUnwrap(env, js_object, result, </span><span class="s3">1</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_type_tag_object(env, object, type_tag) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!object) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.tryCatch.hasCaught() ? </span><span class="s3">10 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">value = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(!(value.isObject() || value.isFunction())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.tryCatch.hasCaught() ? </span><span class="s3">10 </span><span class="s1">: </span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!type_tag) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.tryCatch.hasCaught() ? </span><span class="s3">10 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">binding = envObject.getObjectBinding(value.value);</span>
                <span class="s0">if </span><span class="s1">(binding.tag !== </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.tryCatch.hasCaught() ? </span><span class="s3">10 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">tag = </span><span class="s0">new </span><span class="s1">Uint8Array(</span><span class="s3">16</span><span class="s1">);</span>
                <span class="s1">tag.set(</span><span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer, type_tag, </span><span class="s3">16</span><span class="s1">));</span>
                <span class="s1">binding.tag = </span><span class="s0">new </span><span class="s1">Uint32Array(tag.buffer);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_check_object_type_tag(env, object, type_tag, result) {</span>
            <span class="s0">var </span><span class="s1">ret = </span><span class="s0">true</span><span class="s1">;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!object) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.tryCatch.hasCaught() ? </span><span class="s3">10 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">value = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(!(value.isObject() || value.isFunction())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.tryCatch.hasCaught() ? </span><span class="s3">10 </span><span class="s1">: </span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!type_tag) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.tryCatch.hasCaught() ? </span><span class="s3">10 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!result) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.tryCatch.hasCaught() ? </span><span class="s3">10 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">binding = envObject.getObjectBinding(value.value);</span>
                <span class="s0">if </span><span class="s1">(binding.tag !== </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">var </span><span class="s1">tag = binding.tag;</span>
                    <span class="s0">var </span><span class="s1">typeTag = </span><span class="s0">new </span><span class="s1">Uint32Array(wasmMemory.buffer, type_tag, </span><span class="s3">4</span><span class="s1">);</span>
                    <span class="s1">ret = (tag[</span><span class="s3">0</span><span class="s1">] === typeTag[</span><span class="s3">0</span><span class="s1">] &amp;&amp;</span>
                        <span class="s1">tag[</span><span class="s3">1</span><span class="s1">] === typeTag[</span><span class="s3">1</span><span class="s1">] &amp;&amp;</span>
                        <span class="s1">tag[</span><span class="s3">2</span><span class="s1">] === typeTag[</span><span class="s3">2</span><span class="s1">] &amp;&amp;</span>
                        <span class="s1">tag[</span><span class="s3">3</span><span class="s1">] === typeTag[</span><span class="s3">3</span><span class="s1">]);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">ret = </span><span class="s0">false</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(result, ret ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_add_finalizer(env, js_object, finalize_data, finalize_cb, finalize_hint, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.supportFinalizer) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(!js_object)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!finalize_cb)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handleResult = emnapiGetHandle(js_object);</span>
            <span class="s0">if </span><span class="s1">(handleResult.status !== </span><span class="s3">0</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(handleResult.status);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">handle = handleResult.handle;</span>
            <span class="s0">var </span><span class="s1">ownership = !result ? </span><span class="s3">0 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">reference = emnapiCtx.createReferenceWithFinalizer(envObject, handle.id, </span><span class="s3">0</span><span class="s1">, ownership, finalize_cb, finalize_data, finalize_hint);</span>
            <span class="s0">if </span><span class="s1">(result) {</span>
                <span class="s0">var </span><span class="s1">referenceId = reference.id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, referenceId, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">node_api_post_finalizer(env, finalize_cb, finalize_data, finalize_hint) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.enqueueFinalizer(emnapiCtx.createTrackedFinalizer(envObject, finalize_cb, finalize_data, finalize_hint));</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">wrapMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_add_finalizer: napi_add_finalizer,</span>
            <span class="s1">napi_check_object_type_tag: napi_check_object_type_tag,</span>
            <span class="s1">napi_define_class: napi_define_class,</span>
            <span class="s1">napi_remove_wrap: napi_remove_wrap,</span>
            <span class="s1">napi_type_tag_object: napi_type_tag_object,</span>
            <span class="s1">napi_unwrap: napi_unwrap,</span>
            <span class="s1">napi_wrap: napi_wrap,</span>
            <span class="s1">node_api_post_finalizer: node_api_post_finalizer</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">emnapi_create_memory_view(env, typedarray_type, external_data, byte_length, finalize_cb, finalize_hint, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">byte_length = byte_length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(!external_data) {</span>
                    <span class="s1">byte_length = </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(byte_length &gt; </span><span class="s3">2147483647</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">RangeError(</span><span class="s2">'Cannot create a memory view larger than 2147483647 bytes'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">((external_data + byte_length) &gt; wasmMemory.buffer.byteLength) {</span>
                    <span class="s0">throw new </span><span class="s1">RangeError(</span><span class="s2">'Memory out of range'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.supportFinalizer &amp;&amp; finalize_cb) {</span>
                    <span class="s0">throw </span><span class="s1">emnapiCtx.createNotSupportWeakRefError(</span><span class="s2">'emnapi_create_memory_view'</span><span class="s1">, </span><span class="s2">'Parameter &quot;finalize_cb&quot; must be 0(NULL)'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">viewDescriptor = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">switch </span><span class="s1">(typedarray_type) {</span>
                    <span class="s0">case </span><span class="s3">0</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: Int8Array, address: external_data, length: byte_length, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s3">1</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: Uint8Array, address: external_data, length: byte_length, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s3">2</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: Uint8ClampedArray, address: external_data, length: byte_length, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s3">3</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: Int16Array, address: external_data, length: byte_length &gt;&gt; </span><span class="s3">1</span><span class="s1">, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s3">4</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: Uint16Array, address: external_data, length: byte_length &gt;&gt; </span><span class="s3">1</span><span class="s1">, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s3">5</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: Int32Array, address: external_data, length: byte_length &gt;&gt; </span><span class="s3">2</span><span class="s1">, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s3">6</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: Uint32Array, address: external_data, length: byte_length &gt;&gt; </span><span class="s3">2</span><span class="s1">, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s3">7</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: Float32Array, address: external_data, length: byte_length &gt;&gt; </span><span class="s3">2</span><span class="s1">, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s3">8</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: Float64Array, address: external_data, length: byte_length &gt;&gt; </span><span class="s3">3</span><span class="s1">, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s3">9</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: BigInt64Array, address: external_data, length: byte_length &gt;&gt; </span><span class="s3">3</span><span class="s1">, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s3">10</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: BigUint64Array, address: external_data, length: byte_length &gt;&gt; </span><span class="s3">3</span><span class="s1">, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s1">-</span><span class="s3">1</span><span class="s1">:</span>
                        <span class="s1">viewDescriptor = { Ctor: DataView, address: external_data, length: byte_length, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s0">case </span><span class="s1">-</span><span class="s3">2</span><span class="s1">: {</span>
                        <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.Buffer) {</span>
                            <span class="s0">throw </span><span class="s1">emnapiCtx.createNotSupportBufferError(</span><span class="s2">'emnapi_create_memory_view'</span><span class="s1">, </span><span class="s2">''</span><span class="s1">);</span>
                        <span class="s1">}</span>
                        <span class="s1">viewDescriptor = { Ctor: emnapiCtx.feature.Buffer, address: external_data, length: byte_length, ownership: </span><span class="s3">1</span><span class="s1">, runtimeAllocated: </span><span class="s3">0 </span><span class="s1">};</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s1">}</span>
                    <span class="s0">default</span><span class="s1">: </span><span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">Ctor = viewDescriptor.Ctor;</span>
                <span class="s0">var </span><span class="s1">typedArray = typedarray_type === -</span><span class="s3">2</span>
                    <span class="s1">? emnapiCtx.feature.Buffer.from(wasmMemory.buffer, viewDescriptor.address, viewDescriptor.length)</span>
                    <span class="s1">: </span><span class="s0">new </span><span class="s1">Ctor(wasmMemory.buffer, viewDescriptor.address, viewDescriptor.length);</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.addToCurrentScope(typedArray);</span>
                <span class="s1">emnapiExternalMemory.wasmMemoryViewTable.set(typedArray, viewDescriptor);</span>
                <span class="s0">if </span><span class="s1">(finalize_cb) {</span>
                    <span class="s0">var </span><span class="s1">status_1 = napi_add_finalizer(env, handle.id, external_data, finalize_cb, finalize_hint, </span><span class="s3">0</span><span class="s1">);</span>
                    <span class="s0">if </span><span class="s1">(status_1 === </span><span class="s3">10</span><span class="s1">) {</span>
                        <span class="s0">var </span><span class="s1">err = envObject.tryCatch.extractException();</span>
                        <span class="s1">envObject.clearLastError();</span>
                        <span class="s0">throw </span><span class="s1">err;</span>
                    <span class="s1">}</span>
                    <span class="s0">else if </span><span class="s1">(status_1 !== </span><span class="s3">0</span><span class="s1">) {</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(status_1);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s1">value = handle.id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">emnapi_is_support_weakref() {</span>
            <span class="s0">return </span><span class="s1">emnapiCtx.feature.supportFinalizer ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">emnapi_is_support_bigint() {</span>
            <span class="s0">return </span><span class="s1">emnapiCtx.feature.supportBigInt ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">emnapi_is_node_binding_available() {</span>
            <span class="s0">return </span><span class="s1">emnapiNodeBinding ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">$emnapiSyncMemory(js_to_wasm, arrayBufferOrView, offset, len) {</span>
            <span class="s1">offset = offset !== </span><span class="s0">null </span><span class="s1">&amp;&amp; offset !== </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? offset : </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s1">offset = offset &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">view;</span>
            <span class="s0">if </span><span class="s1">(arrayBufferOrView </span><span class="s0">instanceof </span><span class="s1">ArrayBuffer) {</span>
                <span class="s0">var </span><span class="s1">pointer = emnapiExternalMemory.getArrayBufferPointer(arrayBufferOrView, </span><span class="s0">false</span><span class="s1">).address;</span>
                <span class="s0">if </span><span class="s1">(!pointer)</span>
                    <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'Unknown ArrayBuffer address'</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">len !== </span><span class="s2">'number' </span><span class="s1">|| len === -</span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s1">len = arrayBufferOrView.byteLength - offset;</span>
                <span class="s1">}</span>
                <span class="s1">len = len &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(len === </span><span class="s3">0</span><span class="s1">)</span>
                    <span class="s0">return </span><span class="s1">arrayBufferOrView;</span>
                <span class="s1">view = </span><span class="s0">new </span><span class="s1">Uint8Array(arrayBufferOrView, offset, len);</span>
                <span class="s0">var </span><span class="s1">wasmMemoryU8 = </span><span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer);</span>
                <span class="s0">if </span><span class="s1">(!js_to_wasm) {</span>
                    <span class="s1">view.set(wasmMemoryU8.subarray(pointer, pointer + len));</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">wasmMemoryU8.set(view, pointer);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">arrayBufferOrView;</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(ArrayBuffer.isView(arrayBufferOrView)) {</span>
                <span class="s0">var </span><span class="s1">viewPointerInfo = emnapiExternalMemory.getViewPointer(arrayBufferOrView, </span><span class="s0">false</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">latestView = viewPointerInfo.view;</span>
                <span class="s0">var </span><span class="s1">pointer = viewPointerInfo.address;</span>
                <span class="s0">if </span><span class="s1">(!pointer)</span>
                    <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'Unknown ArrayBuffer address'</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">len !== </span><span class="s2">'number' </span><span class="s1">|| len === -</span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s1">len = latestView.byteLength - offset;</span>
                <span class="s1">}</span>
                <span class="s1">len = len &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(len === </span><span class="s3">0</span><span class="s1">)</span>
                    <span class="s0">return </span><span class="s1">latestView;</span>
                <span class="s1">view = </span><span class="s0">new </span><span class="s1">Uint8Array(latestView.buffer, latestView.byteOffset + offset, len);</span>
                <span class="s0">var </span><span class="s1">wasmMemoryU8 = </span><span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer);</span>
                <span class="s0">if </span><span class="s1">(!js_to_wasm) {</span>
                    <span class="s1">view.set(wasmMemoryU8.subarray(pointer, pointer + len));</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">wasmMemoryU8.set(view, pointer);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">latestView;</span>
            <span class="s1">}</span>
            <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'emnapiSyncMemory expect ArrayBuffer or ArrayBufferView as first parameter'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">emnapi_sync_memory(env, js_to_wasm, arraybuffer_or_view, offset, len) {</span>
            <span class="s0">var </span><span class="s1">v;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!arraybuffer_or_view)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">var </span><span class="s1">handleId = HEAP_DATA_VIEW.getUint32(arraybuffer_or_view, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">handle = envObject.ctx.handleStore.get(handleId);</span>
                <span class="s0">if </span><span class="s1">(!handle.isArrayBuffer() &amp;&amp; !handle.isTypedArray() &amp;&amp; !handle.isDataView()) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">ret = $emnapiSyncMemory(Boolean(js_to_wasm), handle.value, offset, len);</span>
                <span class="s0">if </span><span class="s1">(handle.value !== ret) {</span>
                    <span class="s1">v = envObject.ensureHandleId(ret);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(arraybuffer_or_view, v, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">$emnapiGetMemoryAddress(arrayBufferOrView) {</span>
            <span class="s0">var </span><span class="s1">isArrayBuffer = arrayBufferOrView </span><span class="s0">instanceof </span><span class="s1">ArrayBuffer;</span>
            <span class="s0">var </span><span class="s1">isDataView = arrayBufferOrView </span><span class="s0">instanceof </span><span class="s1">DataView;</span>
            <span class="s0">var </span><span class="s1">isTypedArray = ArrayBuffer.isView(arrayBufferOrView) &amp;&amp; !isDataView;</span>
            <span class="s0">if </span><span class="s1">(!isArrayBuffer &amp;&amp; !isTypedArray &amp;&amp; !isDataView) {</span>
                <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'emnapiGetMemoryAddress expect ArrayBuffer or ArrayBufferView as first parameter'</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">info;</span>
            <span class="s0">if </span><span class="s1">(isArrayBuffer) {</span>
                <span class="s1">info = emnapiExternalMemory.getArrayBufferPointer(arrayBufferOrView, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s1">info = emnapiExternalMemory.getViewPointer(arrayBufferOrView, </span><span class="s0">false</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">{</span>
                <span class="s1">address: info.address,</span>
                <span class="s1">ownership: info.ownership,</span>
                <span class="s1">runtimeAllocated: info.runtimeAllocated</span>
            <span class="s1">};</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">emnapi_get_memory_address(env, arraybuffer_or_view, address, ownership, runtime_allocated) {</span>
            <span class="s0">var </span><span class="s1">p, runtimeAllocated, ownershipOut;</span>
            <span class="s0">var </span><span class="s1">info;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!arraybuffer_or_view)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!address &amp;&amp; !ownership &amp;&amp; !runtime_allocated) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">handle = envObject.ctx.handleStore.get(arraybuffer_or_view);</span>
                <span class="s1">info = $emnapiGetMemoryAddress(handle.value);</span>
                <span class="s1">p = info.address;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">if </span><span class="s1">(address) {</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(address, p, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(ownership) {</span>
                    <span class="s1">ownershipOut = info.ownership;</span>
                    <span class="s1">HEAP_DATA_VIEW.setInt32(ownership, ownershipOut, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(runtime_allocated) {</span>
                    <span class="s1">runtimeAllocated = info.runtimeAllocated;</span>
                    <span class="s1">HEAP_DATA_VIEW.setInt8(runtime_allocated, runtimeAllocated, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">emnapi_get_runtime_version(env, version) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">if </span><span class="s1">(!version)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">runtimeVersion;</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s1">runtimeVersion = emnapiCtx.getRuntimeVersions().version;</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(_) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">versions = runtimeVersion.split(</span><span class="s2">'.'</span><span class="s1">)</span>
                <span class="s1">.map(</span><span class="s0">function </span><span class="s1">(n) { </span><span class="s0">return </span><span class="s1">Number(n); });</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(version, versions[</span><span class="s3">0</span><span class="s1">], </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(version + </span><span class="s3">4</span><span class="s1">, versions[</span><span class="s3">1</span><span class="s1">], </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(version + </span><span class="s3">8</span><span class="s1">, versions[</span><span class="s3">2</span><span class="s1">], </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">emnapiMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">$emnapiGetMemoryAddress: $emnapiGetMemoryAddress,</span>
            <span class="s1">$emnapiSyncMemory: $emnapiSyncMemory,</span>
            <span class="s1">emnapi_create_memory_view: emnapi_create_memory_view,</span>
            <span class="s1">emnapi_get_memory_address: emnapi_get_memory_address,</span>
            <span class="s1">emnapi_get_runtime_version: emnapi_get_runtime_version,</span>
            <span class="s1">emnapi_is_node_binding_available: emnapi_is_node_binding_available,</span>
            <span class="s1">emnapi_is_support_bigint: emnapi_is_support_bigint,</span>
            <span class="s1">emnapi_is_support_weakref: emnapi_is_support_weakref,</span>
            <span class="s1">emnapi_sync_memory: emnapi_sync_memory</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_create_array(env, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">value = emnapiCtx.addToCurrentScope([]).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_array_with_length(env, length, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">length = length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">value = emnapiCtx.addToCurrentScope(</span><span class="s0">new </span><span class="s1">Array(length)).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">emnapiCreateArrayBuffer(byte_length, data) {</span>
            <span class="s1">byte_length = byte_length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">arrayBuffer = </span><span class="s0">new </span><span class="s1">ArrayBuffer(byte_length);</span>
            <span class="s0">if </span><span class="s1">(data) {</span>
                <span class="s0">var </span><span class="s1">p = emnapiExternalMemory.getArrayBufferPointer(arrayBuffer, </span><span class="s0">true</span><span class="s1">).address;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(data, p, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">arrayBuffer;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_arraybuffer(env, byte_length, data, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">arrayBuffer = emnapiCreateArrayBuffer(byte_length, data);</span>
                <span class="s1">value = emnapiCtx.addToCurrentScope(arrayBuffer).id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_date(env, time, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">value = emnapiCtx.addToCurrentScope(</span><span class="s0">new </span><span class="s1">Date(time)).id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_external(env, data, finalize_cb, finalize_hint, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.supportFinalizer &amp;&amp; finalize_cb) {</span>
                    <span class="s0">throw </span><span class="s1">emnapiCtx.createNotSupportWeakRefError(</span><span class="s2">'napi_create_external'</span><span class="s1">, </span><span class="s2">'Parameter &quot;finalize_cb&quot; must be 0(NULL)'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">externalHandle = emnapiCtx.getCurrentScope().addExternal(data);</span>
                <span class="s0">if </span><span class="s1">(finalize_cb) {</span>
                    <span class="s1">emnapiCtx.createReferenceWithFinalizer(envObject, externalHandle.id, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, finalize_cb, data, finalize_hint);</span>
                <span class="s1">}</span>
                <span class="s1">value = externalHandle.id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_external_arraybuffer(env, external_data, byte_length, finalize_cb, finalize_hint, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">byte_length = byte_length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(!external_data) {</span>
                    <span class="s1">byte_length = </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">((external_data + byte_length) &gt; wasmMemory.buffer.byteLength) {</span>
                    <span class="s0">throw new </span><span class="s1">RangeError(</span><span class="s2">'Memory out of range'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!emnapiCtx.feature.supportFinalizer &amp;&amp; finalize_cb) {</span>
                    <span class="s0">throw </span><span class="s1">emnapiCtx.createNotSupportWeakRefError(</span><span class="s2">'napi_create_external_arraybuffer'</span><span class="s1">, </span><span class="s2">'Parameter &quot;finalize_cb&quot; must be 0(NULL)'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">arrayBuffer = </span><span class="s0">new </span><span class="s1">ArrayBuffer(byte_length);</span>
                <span class="s0">if </span><span class="s1">(byte_length === </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">try </span><span class="s1">{</span>
                        <span class="s0">var </span><span class="s1">MessageChannel_1 = emnapiCtx.feature.MessageChannel;</span>
                        <span class="s0">var </span><span class="s1">messageChannel = </span><span class="s0">new </span><span class="s1">MessageChannel_1();</span>
                        <span class="s1">messageChannel.port1.postMessage(arrayBuffer, [arrayBuffer]);</span>
                    <span class="s1">}</span>
                    <span class="s0">catch </span><span class="s1">(_) { }</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s0">var </span><span class="s1">u8arr = </span><span class="s0">new </span><span class="s1">Uint8Array(arrayBuffer);</span>
                    <span class="s1">u8arr.set(</span><span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer).subarray(external_data, external_data + byte_length));</span>
                    <span class="s1">emnapiExternalMemory.table.set(arrayBuffer, {</span>
                        <span class="s1">address: external_data,</span>
                        <span class="s1">ownership: </span><span class="s3">1</span><span class="s1">,</span>
                        <span class="s1">runtimeAllocated: </span><span class="s3">0</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.addToCurrentScope(arrayBuffer);</span>
                <span class="s0">if </span><span class="s1">(finalize_cb) {</span>
                    <span class="s0">var </span><span class="s1">status_1 = napi_add_finalizer(env, handle.id, external_data, finalize_cb, finalize_hint, </span><span class="s3">0</span><span class="s1">);</span>
                    <span class="s0">if </span><span class="s1">(status_1 === </span><span class="s3">10</span><span class="s1">) {</span>
                        <span class="s0">var </span><span class="s1">err = envObject.tryCatch.extractException();</span>
                        <span class="s1">envObject.clearLastError();</span>
                        <span class="s0">throw </span><span class="s1">err;</span>
                    <span class="s1">}</span>
                    <span class="s0">else if </span><span class="s1">(status_1 !== </span><span class="s3">0</span><span class="s1">) {</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(status_1);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s1">value = handle.id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_object(env, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">value = emnapiCtx.addToCurrentScope({}).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_symbol(env, description, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(!description) {</span>
                <span class="s0">var </span><span class="s1">value = emnapiCtx.addToCurrentScope(Symbol()).id;</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(description);</span>
                <span class="s0">var </span><span class="s1">desc = handle.value;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">desc !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v = emnapiCtx.addToCurrentScope(Symbol(desc)).id;</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_typedarray(env, type, length, arraybuffer, byte_offset, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!arraybuffer)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(arraybuffer);</span>
                <span class="s0">if </span><span class="s1">(!handle.isArrayBuffer()) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">buffer = handle.value;</span>
                <span class="s0">var </span><span class="s1">createTypedArray = </span><span class="s0">function </span><span class="s1">(envObject, Type, size_of_element, buffer, byte_offset, length) {</span>
                    <span class="s0">var </span><span class="s1">_a;</span>
                    <span class="s1">byte_offset = byte_offset &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                    <span class="s1">length = length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                    <span class="s0">if </span><span class="s1">(size_of_element &gt; </span><span class="s3">1</span><span class="s1">) {</span>
                        <span class="s0">if </span><span class="s1">((byte_offset) % (size_of_element) !== </span><span class="s3">0</span><span class="s1">) {</span>
                            <span class="s0">var </span><span class="s1">err = </span><span class="s0">new </span><span class="s1">RangeError(</span><span class="s2">&quot;start offset of &quot;</span><span class="s1">.concat((_a = Type.name) !== </span><span class="s0">null </span><span class="s1">&amp;&amp; _a !== </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? _a : </span><span class="s2">''</span><span class="s1">, </span><span class="s2">&quot; should be a multiple of &quot;</span><span class="s1">).concat(size_of_element));</span>
                            <span class="s1">err.code = </span><span class="s2">'ERR_NAPI_INVALID_TYPEDARRAY_ALIGNMENT'</span><span class="s1">;</span>
                            <span class="s1">envObject.tryCatch.setError(err);</span>
                            <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(((length * size_of_element) + byte_offset) &gt; buffer.byteLength) {</span>
                        <span class="s0">var </span><span class="s1">err = </span><span class="s0">new </span><span class="s1">RangeError(</span><span class="s2">'Invalid typed array length'</span><span class="s1">);</span>
                        <span class="s1">err.code = </span><span class="s2">'ERR_NAPI_INVALID_TYPEDARRAY_LENGTH'</span><span class="s1">;</span>
                        <span class="s1">envObject.tryCatch.setError(err);</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s0">var </span><span class="s1">out = </span><span class="s0">new </span><span class="s1">Type(buffer, byte_offset, length);</span>
                    <span class="s0">if </span><span class="s1">(buffer === wasmMemory.buffer) {</span>
                        <span class="s0">if </span><span class="s1">(!emnapiExternalMemory.wasmMemoryViewTable.has(out)) {</span>
                            <span class="s1">emnapiExternalMemory.wasmMemoryViewTable.set(out, {</span>
                                <span class="s1">Ctor: Type,</span>
                                <span class="s1">address: byte_offset,</span>
                                <span class="s1">length: length,</span>
                                <span class="s1">ownership: </span><span class="s3">1</span><span class="s1">,</span>
                                <span class="s1">runtimeAllocated: </span><span class="s3">0</span>
                            <span class="s1">});</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                    <span class="s1">value = emnapiCtx.addToCurrentScope(out).id;</span>
                    <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
                <span class="s1">};</span>
                <span class="s0">switch </span><span class="s1">(type) {</span>
                    <span class="s0">case </span><span class="s3">0</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">createTypedArray(envObject, Int8Array, </span><span class="s3">1</span><span class="s1">, buffer, byte_offset, length);</span>
                    <span class="s0">case </span><span class="s3">1</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">createTypedArray(envObject, Uint8Array, </span><span class="s3">1</span><span class="s1">, buffer, byte_offset, length);</span>
                    <span class="s0">case </span><span class="s3">2</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">createTypedArray(envObject, Uint8ClampedArray, </span><span class="s3">1</span><span class="s1">, buffer, byte_offset, length);</span>
                    <span class="s0">case </span><span class="s3">3</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">createTypedArray(envObject, Int16Array, </span><span class="s3">2</span><span class="s1">, buffer, byte_offset, length);</span>
                    <span class="s0">case </span><span class="s3">4</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">createTypedArray(envObject, Uint16Array, </span><span class="s3">2</span><span class="s1">, buffer, byte_offset, length);</span>
                    <span class="s0">case </span><span class="s3">5</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">createTypedArray(envObject, Int32Array, </span><span class="s3">4</span><span class="s1">, buffer, byte_offset, length);</span>
                    <span class="s0">case </span><span class="s3">6</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">createTypedArray(envObject, Uint32Array, </span><span class="s3">4</span><span class="s1">, buffer, byte_offset, length);</span>
                    <span class="s0">case </span><span class="s3">7</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">createTypedArray(envObject, Float32Array, </span><span class="s3">4</span><span class="s1">, buffer, byte_offset, length);</span>
                    <span class="s0">case </span><span class="s3">8</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">createTypedArray(envObject, Float64Array, </span><span class="s3">8</span><span class="s1">, buffer, byte_offset, length);</span>
                    <span class="s0">case </span><span class="s3">9</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">createTypedArray(envObject, BigInt64Array, </span><span class="s3">8</span><span class="s1">, buffer, byte_offset, length);</span>
                    <span class="s0">case </span><span class="s3">10</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">createTypedArray(envObject, BigUint64Array, </span><span class="s3">8</span><span class="s1">, buffer, byte_offset, length);</span>
                    <span class="s0">default</span><span class="s1">:</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_buffer(env, size, data, result) {</span>
            <span class="s0">var </span><span class="s1">_a;</span>
            <span class="s0">var </span><span class="s1">value, pointer;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">Buffer = emnapiCtx.feature.Buffer;</span>
                <span class="s0">if </span><span class="s1">(!Buffer) {</span>
                    <span class="s0">throw </span><span class="s1">emnapiCtx.createNotSupportBufferError(</span><span class="s2">'napi_create_buffer'</span><span class="s1">, </span><span class="s2">''</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">buffer = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s1">size = size &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">if </span><span class="s1">(!data || (size === </span><span class="s3">0</span><span class="s1">)) {</span>
                    <span class="s1">buffer = Buffer.alloc(size);</span>
                    <span class="s1">value = emnapiCtx.addToCurrentScope(buffer).id;</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">pointer = _malloc(size);</span>
                    <span class="s0">if </span><span class="s1">(!pointer)</span>
                        <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'Out of memory'</span><span class="s1">);</span>
                    <span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer).subarray(pointer, pointer + size).fill(</span><span class="s3">0</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">buffer_1 = Buffer.from(wasmMemory.buffer, pointer, size);</span>
                    <span class="s0">var </span><span class="s1">viewDescriptor = {</span>
                        <span class="s1">Ctor: Buffer,</span>
                        <span class="s1">address: pointer,</span>
                        <span class="s1">length: size,</span>
                        <span class="s1">ownership: emnapiExternalMemory.registry ? </span><span class="s3">0 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">,</span>
                        <span class="s1">runtimeAllocated: </span><span class="s3">1</span>
                    <span class="s1">};</span>
                    <span class="s1">emnapiExternalMemory.wasmMemoryViewTable.set(buffer_1, viewDescriptor);</span>
                    <span class="s1">(_a = emnapiExternalMemory.registry) === </span><span class="s0">null </span><span class="s1">|| _a === </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">: _a.register(viewDescriptor, pointer);</span>
                    <span class="s1">value = emnapiCtx.addToCurrentScope(buffer_1).id;</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(data, pointer, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_buffer_copy(env, length, data, result_data, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">Buffer = emnapiCtx.feature.Buffer;</span>
                <span class="s0">if </span><span class="s1">(!Buffer) {</span>
                    <span class="s0">throw </span><span class="s1">emnapiCtx.createNotSupportBufferError(</span><span class="s2">'napi_create_buffer_copy'</span><span class="s1">, </span><span class="s2">''</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">arrayBuffer = emnapiCreateArrayBuffer(length, result_data);</span>
                <span class="s0">var </span><span class="s1">buffer = Buffer.from(arrayBuffer);</span>
                <span class="s1">buffer.set(</span><span class="s0">new </span><span class="s1">Uint8Array(wasmMemory.buffer).subarray(data, data + length));</span>
                <span class="s1">value = emnapiCtx.addToCurrentScope(buffer).id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_external_buffer(env, length, data, finalize_cb, finalize_hint, result) {</span>
            <span class="s0">return </span><span class="s1">emnapi_create_memory_view(env, -</span><span class="s3">2</span><span class="s1">, data, length, finalize_cb, finalize_hint, result);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">node_api_create_buffer_from_arraybuffer(env, arraybuffer, byte_offset, byte_length, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!arraybuffer)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">byte_offset = byte_offset &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s1">byte_length = byte_length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(arraybuffer);</span>
                <span class="s0">if </span><span class="s1">(!handle.isArrayBuffer()) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">buffer = handle.value;</span>
                <span class="s0">if </span><span class="s1">((byte_length + byte_offset) &gt; buffer.byteLength) {</span>
                    <span class="s0">var </span><span class="s1">err = </span><span class="s0">new </span><span class="s1">RangeError(</span><span class="s2">'The byte offset + length is out of range'</span><span class="s1">);</span>
                    <span class="s1">err.code = </span><span class="s2">'ERR_OUT_OF_RANGE'</span><span class="s1">;</span>
                    <span class="s0">throw </span><span class="s1">err;</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">Buffer = emnapiCtx.feature.Buffer;</span>
                <span class="s0">if </span><span class="s1">(!Buffer) {</span>
                    <span class="s0">throw </span><span class="s1">emnapiCtx.createNotSupportBufferError(</span><span class="s2">'node_api_create_buffer_from_arraybuffer'</span><span class="s1">, </span><span class="s2">''</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">out = Buffer.from(buffer, byte_offset, byte_length);</span>
                <span class="s0">if </span><span class="s1">(buffer === wasmMemory.buffer) {</span>
                    <span class="s0">if </span><span class="s1">(!emnapiExternalMemory.wasmMemoryViewTable.has(out)) {</span>
                        <span class="s1">emnapiExternalMemory.wasmMemoryViewTable.set(out, {</span>
                            <span class="s1">Ctor: Buffer,</span>
                            <span class="s1">address: byte_offset,</span>
                            <span class="s1">length: byte_length,</span>
                            <span class="s1">ownership: </span><span class="s3">1</span><span class="s1">,</span>
                            <span class="s1">runtimeAllocated: </span><span class="s3">0</span>
                        <span class="s1">});</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s1">value = emnapiCtx.addToCurrentScope(out).id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_dataview(env, byte_length, arraybuffer, byte_offset, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!arraybuffer)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">byte_length = byte_length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s1">byte_offset = byte_offset &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(arraybuffer);</span>
                <span class="s0">if </span><span class="s1">(!handle.isArrayBuffer()) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">buffer = handle.value;</span>
                <span class="s0">if </span><span class="s1">((byte_length + byte_offset) &gt; buffer.byteLength) {</span>
                    <span class="s0">var </span><span class="s1">err = </span><span class="s0">new </span><span class="s1">RangeError(</span><span class="s2">'byte_offset + byte_length should be less than or equal to the size in bytes of the array passed in'</span><span class="s1">);</span>
                    <span class="s1">err.code = </span><span class="s2">'ERR_NAPI_INVALID_DATAVIEW_ARGS'</span><span class="s1">;</span>
                    <span class="s0">throw </span><span class="s1">err;</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">dataview = </span><span class="s0">new </span><span class="s1">DataView(buffer, byte_offset, byte_length);</span>
                <span class="s0">if </span><span class="s1">(buffer === wasmMemory.buffer) {</span>
                    <span class="s0">if </span><span class="s1">(!emnapiExternalMemory.wasmMemoryViewTable.has(dataview)) {</span>
                        <span class="s1">emnapiExternalMemory.wasmMemoryViewTable.set(dataview, {</span>
                            <span class="s1">Ctor: DataView,</span>
                            <span class="s1">address: byte_offset,</span>
                            <span class="s1">length: byte_length,</span>
                            <span class="s1">ownership: </span><span class="s3">1</span><span class="s1">,</span>
                            <span class="s1">runtimeAllocated: </span><span class="s3">0</span>
                        <span class="s1">});</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s1">value = emnapiCtx.addToCurrentScope(dataview).id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">node_api_symbol_for(env, utf8description, length, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">autoLength = length === -</span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">sizelength = length &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">if </span><span class="s1">(length !== </span><span class="s3">0</span><span class="s1">) {</span>
                <span class="s0">if </span><span class="s1">(!utf8description)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(!(autoLength || (sizelength &lt;= </span><span class="s3">2147483647</span><span class="s1">))) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">descriptionString = emnapiString.UTF8ToString(utf8description, length);</span>
            <span class="s0">var </span><span class="s1">value = emnapiCtx.addToCurrentScope(Symbol.for(descriptionString)).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">createMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_create_array: napi_create_array,</span>
            <span class="s1">napi_create_array_with_length: napi_create_array_with_length,</span>
            <span class="s1">napi_create_arraybuffer: napi_create_arraybuffer,</span>
            <span class="s1">napi_create_buffer: napi_create_buffer,</span>
            <span class="s1">napi_create_buffer_copy: napi_create_buffer_copy,</span>
            <span class="s1">napi_create_dataview: napi_create_dataview,</span>
            <span class="s1">napi_create_date: napi_create_date,</span>
            <span class="s1">napi_create_external: napi_create_external,</span>
            <span class="s1">napi_create_external_arraybuffer: napi_create_external_arraybuffer,</span>
            <span class="s1">napi_create_external_buffer: napi_create_external_buffer,</span>
            <span class="s1">napi_create_object: napi_create_object,</span>
            <span class="s1">napi_create_symbol: napi_create_symbol,</span>
            <span class="s1">napi_create_typedarray: napi_create_typedarray,</span>
            <span class="s1">node_api_create_buffer_from_arraybuffer: node_api_create_buffer_from_arraybuffer,</span>
            <span class="s1">node_api_symbol_for: node_api_symbol_for</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_get_boolean(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">v = value === </span><span class="s3">0 </span><span class="s1">? </span><span class="s3">3 </span><span class="s1">: </span><span class="s3">4</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_global(env, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">value = </span><span class="s3">5</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_null(env, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">value = </span><span class="s3">2</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_undefined(env, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">value = </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">globalMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_get_boolean: napi_get_boolean,</span>
            <span class="s1">napi_get_global: napi_get_global,</span>
            <span class="s1">napi_get_null: napi_get_null,</span>
            <span class="s1">napi_get_undefined: napi_get_undefined</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_set_instance_data(env, data, finalize_cb, finalize_hint) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.setInstanceData(data, finalize_cb, finalize_hint);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_instance_data(env, data) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">if </span><span class="s1">(!data)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">value = envObject.getInstanceData();</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(data, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">envMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_get_instance_data: napi_get_instance_data,</span>
            <span class="s1">napi_set_instance_data: napi_set_instance_data</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">_emnapi_get_last_error_info(env, error_code, engine_error_code, engine_reserved) {</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">var </span><span class="s1">lastError = envObject.lastError;</span>
            <span class="s0">var </span><span class="s1">errorCode = lastError.errorCode;</span>
            <span class="s0">var </span><span class="s1">engineErrorCode = lastError.engineErrorCode &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">engineReserved = lastError.engineReserved;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt32(error_code, errorCode, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(engine_error_code, engineErrorCode, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(engine_reserved, engineReserved, </span><span class="s0">true</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_throw(env, error) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!error)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">envObject.tryCatch.setError(emnapiCtx.handleStore.get(error).value);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_throw_error(env, code, msg) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!msg)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">error = </span><span class="s0">new </span><span class="s1">Error(emnapiString.UTF8ToString(msg, -</span><span class="s3">1</span><span class="s1">));</span>
                <span class="s0">if </span><span class="s1">(code)</span>
                    <span class="s1">error.code = emnapiString.UTF8ToString(code, -</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">envObject.tryCatch.setError(error);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_throw_type_error(env, code, msg) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!msg)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">error = </span><span class="s0">new </span><span class="s1">TypeError(emnapiString.UTF8ToString(msg, -</span><span class="s3">1</span><span class="s1">));</span>
                <span class="s0">if </span><span class="s1">(code)</span>
                    <span class="s1">error.code = emnapiString.UTF8ToString(code, -</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">envObject.tryCatch.setError(error);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_throw_range_error(env, code, msg) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!msg)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">error = </span><span class="s0">new </span><span class="s1">RangeError(emnapiString.UTF8ToString(msg, -</span><span class="s3">1</span><span class="s1">));</span>
                <span class="s0">if </span><span class="s1">(code)</span>
                    <span class="s1">error.code = emnapiString.UTF8ToString(code, -</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">envObject.tryCatch.setError(error);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">node_api_throw_syntax_error(env, code, msg) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!msg)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">error = </span><span class="s0">new </span><span class="s1">SyntaxError(emnapiString.UTF8ToString(msg, -</span><span class="s3">1</span><span class="s1">));</span>
                <span class="s0">if </span><span class="s1">(code)</span>
                    <span class="s1">error.code = emnapiString.UTF8ToString(code, -</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">envObject.tryCatch.setError(error);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_is_exception_pending(env, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">r = envObject.tryCatch.hasCaught();</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt8(result, r ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_error(env, code, msg, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!msg)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">msgValue = emnapiCtx.handleStore.get(msg).value;</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">msgValue !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">error = </span><span class="s0">new </span><span class="s1">Error(msgValue);</span>
            <span class="s0">if </span><span class="s1">(code) {</span>
                <span class="s0">var </span><span class="s1">codeValue = emnapiCtx.handleStore.get(code).value;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">codeValue !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">error.code = codeValue;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">value = emnapiCtx.addToCurrentScope(error).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_type_error(env, code, msg, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!msg)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">msgValue = emnapiCtx.handleStore.get(msg).value;</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">msgValue !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">error = </span><span class="s0">new </span><span class="s1">TypeError(msgValue);</span>
            <span class="s0">if </span><span class="s1">(code) {</span>
                <span class="s0">var </span><span class="s1">codeValue = emnapiCtx.handleStore.get(code).value;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">codeValue !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">error.code = codeValue;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">value = emnapiCtx.addToCurrentScope(error).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_range_error(env, code, msg, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!msg)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">msgValue = emnapiCtx.handleStore.get(msg).value;</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">msgValue !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">error = </span><span class="s0">new </span><span class="s1">RangeError(msgValue);</span>
            <span class="s0">if </span><span class="s1">(code) {</span>
                <span class="s0">var </span><span class="s1">codeValue = emnapiCtx.handleStore.get(code).value;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">codeValue !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">error.code = codeValue;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">value = emnapiCtx.addToCurrentScope(error).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">node_api_create_syntax_error(env, code, msg, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!msg)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">msgValue = emnapiCtx.handleStore.get(msg).value;</span>
            <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">msgValue !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">error = </span><span class="s0">new </span><span class="s1">SyntaxError(msgValue);</span>
            <span class="s0">if </span><span class="s1">(code) {</span>
                <span class="s0">var </span><span class="s1">codeValue = emnapiCtx.handleStore.get(code).value;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">codeValue !== </span><span class="s2">'string'</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">error.code = codeValue;</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">value = emnapiCtx.addToCurrentScope(error).id;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_and_clear_last_exception(env, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.hasCaught()) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, </span><span class="s3">1</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s0">var </span><span class="s1">err = envObject.tryCatch.exception();</span>
                <span class="s0">var </span><span class="s1">value = envObject.ensureHandleId(err);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">envObject.tryCatch.reset();</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_fatal_error(location, location_len, message, message_len) {</span>
            <span class="s0">var </span><span class="s1">locationStr = emnapiString.UTF8ToString(location, location_len);</span>
            <span class="s0">var </span><span class="s1">messageStr = emnapiString.UTF8ToString(message, message_len);</span>
            <span class="s0">if </span><span class="s1">(emnapiNodeBinding) {</span>
                <span class="s1">emnapiNodeBinding.napi.fatalError(locationStr, messageStr);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s1">abort(</span><span class="s2">'FATAL ERROR: ' </span><span class="s1">+ locationStr + </span><span class="s2">' ' </span><span class="s1">+ messageStr);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_fatal_exception(env, err) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!err)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">error = envObject.ctx.handleStore.get(err);</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s1">envObject.triggerFatalException(error.value);</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(_) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">errorMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">_emnapi_get_last_error_info: _emnapi_get_last_error_info,</span>
            <span class="s1">napi_create_error: napi_create_error,</span>
            <span class="s1">napi_create_range_error: napi_create_range_error,</span>
            <span class="s1">napi_create_type_error: napi_create_type_error,</span>
            <span class="s1">napi_fatal_error: napi_fatal_error,</span>
            <span class="s1">napi_fatal_exception: napi_fatal_exception,</span>
            <span class="s1">napi_get_and_clear_last_exception: napi_get_and_clear_last_exception,</span>
            <span class="s1">napi_is_exception_pending: napi_is_exception_pending,</span>
            <span class="s1">napi_throw: napi_throw,</span>
            <span class="s1">napi_throw_error: napi_throw_error,</span>
            <span class="s1">napi_throw_range_error: napi_throw_range_error,</span>
            <span class="s1">napi_throw_type_error: napi_throw_type_error,</span>
            <span class="s1">node_api_create_syntax_error: node_api_create_syntax_error,</span>
            <span class="s1">node_api_throw_syntax_error: node_api_throw_syntax_error</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_create_function(env, utf8name, length, cb, data, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!cb)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">fresult = emnapiCreateFunction(envObject, utf8name, length, cb, data);</span>
                <span class="s0">if </span><span class="s1">(fresult.status !== </span><span class="s3">0</span><span class="s1">)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(fresult.status);</span>
                <span class="s0">var </span><span class="s1">f = fresult.f;</span>
                <span class="s0">var </span><span class="s1">valueHandle = emnapiCtx.addToCurrentScope(f);</span>
                <span class="s1">value = valueHandle.id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_cb_info(env, cbinfo, argc, argv, this_arg, data) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">if </span><span class="s1">(!cbinfo)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">cbinfoValue = emnapiCtx.scopeStore.get(cbinfo).callbackInfo;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s0">if </span><span class="s1">(argv) {</span>
                <span class="s0">if </span><span class="s1">(!argc)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">argcValue = HEAP_DATA_VIEW.getUint32(argc, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">len = cbinfoValue.args.length;</span>
                <span class="s0">var </span><span class="s1">arrlen = argcValue &lt; len ? argcValue : len;</span>
                <span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">for </span><span class="s1">(; i &lt; arrlen; i++) {</span>
                    <span class="s0">var </span><span class="s1">argVal = envObject.ensureHandleId(cbinfoValue.args[i]);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(argv + i * </span><span class="s3">4</span><span class="s1">, argVal, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(i &lt; argcValue) {</span>
                    <span class="s0">for </span><span class="s1">(; i &lt; argcValue; i++) {</span>
                        <span class="s1">HEAP_DATA_VIEW.setUint32(argv + i * </span><span class="s3">4</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(argc) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(argc, cbinfoValue.args.length, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(this_arg) {</span>
                <span class="s0">var </span><span class="s1">v = envObject.ensureHandleId(cbinfoValue.thiz);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(this_arg, v, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(data) {</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(data, cbinfoValue.data, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_call_function(env, recv, func, argc, argv, result) {</span>
            <span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">v;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!recv)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">argc = argc &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(argc &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">if </span><span class="s1">(!argv)</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v8recv = emnapiCtx.handleStore.get(recv).value;</span>
                <span class="s0">if </span><span class="s1">(!func)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">v8func = emnapiCtx.handleStore.get(func).value;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">v8func !== </span><span class="s2">'function'</span><span class="s1">)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">args = [];</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">for </span><span class="s1">(; i &lt; argc; i++) {</span>
                    <span class="s0">var </span><span class="s1">argVal = HEAP_DATA_VIEW.getUint32(argv + i * </span><span class="s3">4</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">args.push(emnapiCtx.handleStore.get(argVal).value);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">ret = v8func.apply(v8recv, args);</span>
                <span class="s0">if </span><span class="s1">(result) {</span>
                    <span class="s1">v = envObject.ensureHandleId(ret);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_new_instance(env, constructor, argc, argv, result) {</span>
            <span class="s0">var </span><span class="s1">i;</span>
            <span class="s0">var </span><span class="s1">v;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!constructor)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">argc = argc &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(argc &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">if </span><span class="s1">(!argv)</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">Ctor = emnapiCtx.handleStore.get(constructor).value;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">Ctor !== </span><span class="s2">'function'</span><span class="s1">)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">ret = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">if </span><span class="s1">(emnapiCtx.feature.supportReflect) {</span>
                    <span class="s0">var </span><span class="s1">argList = Array(argc);</span>
                    <span class="s0">for </span><span class="s1">(i = </span><span class="s3">0</span><span class="s1">; i &lt; argc; i++) {</span>
                        <span class="s0">var </span><span class="s1">argVal = HEAP_DATA_VIEW.getUint32(argv + i * </span><span class="s3">4</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                        <span class="s1">argList[i] = emnapiCtx.handleStore.get(argVal).value;</span>
                    <span class="s1">}</span>
                    <span class="s1">ret = Reflect.construct(Ctor, argList, Ctor);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s0">var </span><span class="s1">args = Array(argc + </span><span class="s3">1</span><span class="s1">);</span>
                    <span class="s1">args[</span><span class="s3">0</span><span class="s1">] = undefined;</span>
                    <span class="s0">for </span><span class="s1">(i = </span><span class="s3">0</span><span class="s1">; i &lt; argc; i++) {</span>
                        <span class="s0">var </span><span class="s1">argVal = HEAP_DATA_VIEW.getUint32(argv + i * </span><span class="s3">4</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                        <span class="s1">args[i + </span><span class="s3">1</span><span class="s1">] = emnapiCtx.handleStore.get(argVal).value;</span>
                    <span class="s1">}</span>
                    <span class="s0">var </span><span class="s1">BoundCtor = Ctor.bind.apply(Ctor, args);</span>
                    <span class="s1">ret = </span><span class="s0">new </span><span class="s1">BoundCtor();</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(result) {</span>
                    <span class="s1">v = envObject.ensureHandleId(ret);</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_new_target(env, cbinfo, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!cbinfo)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">cbinfoValue = emnapiCtx.scopeStore.get(cbinfo).callbackInfo;</span>
            <span class="s0">var </span><span class="s1">thiz = cbinfoValue.thiz, fn = cbinfoValue.fn;</span>
            <span class="s0">var </span><span class="s1">value = thiz == </span><span class="s0">null </span><span class="s1">|| thiz.constructor == </span><span class="s0">null</span>
                <span class="s1">? </span><span class="s3">0</span>
                <span class="s1">: thiz </span><span class="s0">instanceof </span><span class="s1">fn</span>
                    <span class="s1">? envObject.ensureHandleId(thiz.constructor)</span>
                    <span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">functionMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_call_function: napi_call_function,</span>
            <span class="s1">napi_create_function: napi_create_function,</span>
            <span class="s1">napi_get_cb_info: napi_get_cb_info,</span>
            <span class="s1">napi_get_new_target: napi_get_new_target,</span>
            <span class="s1">napi_new_instance: napi_new_instance</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_open_handle_scope(env, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">scope = emnapiCtx.openScope(envObject);</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, scope.id, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_close_handle_scope(env, scope) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!scope)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">((envObject.openHandleScopes === </span><span class="s3">0</span><span class="s1">)) {</span>
                <span class="s0">return </span><span class="s3">13</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s1">emnapiCtx.closeScope(envObject);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_open_escapable_handle_scope(env, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">scope = emnapiCtx.openScope(envObject);</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, scope.id, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_close_escapable_handle_scope(env, scope) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!scope)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">((envObject.openHandleScopes === </span><span class="s3">0</span><span class="s1">)) {</span>
                <span class="s0">return </span><span class="s3">13</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s1">emnapiCtx.closeScope(envObject);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_escape_handle(env, scope, escapee, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!scope)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!escapee)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">scopeObject = emnapiCtx.scopeStore.get(scope);</span>
            <span class="s0">if </span><span class="s1">(!scopeObject.escapeCalled()) {</span>
                <span class="s0">var </span><span class="s1">newHandle = scopeObject.escape(escapee);</span>
                <span class="s0">var </span><span class="s1">value = newHandle ? newHandle.id : </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">12</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_create_reference(env, value, initial_refcount, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">if </span><span class="s1">(envObject.moduleApiVersion &lt; </span><span class="s3">10</span><span class="s1">) {</span>
                <span class="s0">if </span><span class="s1">(!(handle.isObject() || handle.isFunction() || handle.isSymbol())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">ref = emnapiCtx.createReference(envObject, handle.id, initial_refcount &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, ref.id, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_delete_reference(env, ref) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">if </span><span class="s1">(!ref)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">emnapiCtx.refStore.get(ref).dispose();</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_reference_ref(env, ref, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!ref)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">count = emnapiCtx.refStore.get(ref).ref();</span>
            <span class="s0">if </span><span class="s1">(result) {</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, count, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_reference_unref(env, ref, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!ref)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">reference = emnapiCtx.refStore.get(ref);</span>
            <span class="s0">var </span><span class="s1">refcount = reference.refcount();</span>
            <span class="s0">if </span><span class="s1">(refcount === </span><span class="s3">0</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">count = reference.unref();</span>
            <span class="s0">if </span><span class="s1">(result) {</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, count, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_reference_value(env, ref, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!ref)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">reference = emnapiCtx.refStore.get(ref);</span>
            <span class="s0">var </span><span class="s1">handleId = reference.get(envObject);</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, handleId, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_add_env_cleanup_hook(env, fun, arg) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">if </span><span class="s1">(!fun)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">emnapiCtx.addCleanupHook(envObject, fun, arg);</span>
            <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_remove_env_cleanup_hook(env, fun, arg) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">if </span><span class="s1">(!fun)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">emnapiCtx.removeCleanupHook(envObject, fun, arg);</span>
            <span class="s0">return </span><span class="s3">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_env_ref(env) {</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.ref();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">_emnapi_env_unref(env) {</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.unref();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">lifeMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">_emnapi_env_ref: _emnapi_env_ref,</span>
            <span class="s1">_emnapi_env_unref: _emnapi_env_unref,</span>
            <span class="s1">napi_add_env_cleanup_hook: napi_add_env_cleanup_hook,</span>
            <span class="s1">napi_close_escapable_handle_scope: napi_close_escapable_handle_scope,</span>
            <span class="s1">napi_close_handle_scope: napi_close_handle_scope,</span>
            <span class="s1">napi_create_reference: napi_create_reference,</span>
            <span class="s1">napi_delete_reference: napi_delete_reference,</span>
            <span class="s1">napi_escape_handle: napi_escape_handle,</span>
            <span class="s1">napi_get_reference_value: napi_get_reference_value,</span>
            <span class="s1">napi_open_escapable_handle_scope: napi_open_escapable_handle_scope,</span>
            <span class="s1">napi_open_handle_scope: napi_open_handle_scope,</span>
            <span class="s1">napi_reference_ref: napi_reference_ref,</span>
            <span class="s1">napi_reference_unref: napi_reference_unref,</span>
            <span class="s1">napi_remove_env_cleanup_hook: napi_remove_env_cleanup_hook</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">_emnapi_get_filename(env, buf, len) {</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">var </span><span class="s1">filename = envObject.filename;</span>
            <span class="s0">if </span><span class="s1">(!buf) {</span>
                <span class="s0">return </span><span class="s1">emnapiString.lengthBytesUTF8(filename);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">emnapiString.stringToUTF8(filename, buf, len);</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">miscellaneousMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">_emnapi_get_filename: _emnapi_get_filename</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_create_promise(env, deferred, promise) {</span>
            <span class="s0">var </span><span class="s1">deferredObjectId, value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!deferred)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!promise)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">var </span><span class="s1">p = </span><span class="s0">new </span><span class="s1">Promise(</span><span class="s0">function </span><span class="s1">(resolve, reject) {</span>
                    <span class="s0">var </span><span class="s1">deferredObject = emnapiCtx.createDeferred({ resolve: resolve, reject: reject });</span>
                    <span class="s1">deferredObjectId = deferredObject.id;</span>
                    <span class="s1">HEAP_DATA_VIEW.setUint32(deferred, deferredObjectId, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">});</span>
                <span class="s1">value = emnapiCtx.addToCurrentScope(p).id;</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(promise, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_resolve_deferred(env, deferred, resolution) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!deferred)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!resolution)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">deferredObject = emnapiCtx.deferredStore.get(deferred);</span>
                <span class="s1">deferredObject.resolve(emnapiCtx.handleStore.get(resolution).value);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_reject_deferred(env, deferred, resolution) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!deferred)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!resolution)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">deferredObject = emnapiCtx.deferredStore.get(deferred);</span>
                <span class="s1">deferredObject.reject(emnapiCtx.handleStore.get(resolution).value);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_is_promise(env, value, is_promise) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!is_promise)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">var </span><span class="s1">r = h.isPromise() ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt8(is_promise, r, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">promiseMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_create_promise: napi_create_promise,</span>
            <span class="s1">napi_is_promise: napi_is_promise,</span>
            <span class="s1">napi_reject_deferred: napi_reject_deferred,</span>
            <span class="s1">napi_resolve_deferred: napi_resolve_deferred</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_get_all_property_names(env, object, key_mode, key_filter, key_conversion, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(h.value == </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert undefined or null to object'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">obj = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s1">obj = h.isObject() || h.isFunction() ? h.value : Object(h.value);</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(_) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(key_mode !== </span><span class="s3">0 </span><span class="s1">&amp;&amp; key_mode !== </span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(key_conversion !== </span><span class="s3">0 </span><span class="s1">&amp;&amp; key_conversion !== </span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">props = [];</span>
                <span class="s0">var </span><span class="s1">names = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">symbols = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">i = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">own = </span><span class="s0">true</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">integerIndiceRegex = </span><span class="s4">/^(0|[1-9][0-9]*)$/</span><span class="s1">;</span>
                <span class="s0">do </span><span class="s1">{</span>
                    <span class="s1">names = Object.getOwnPropertyNames(obj);</span>
                    <span class="s1">symbols = Object.getOwnPropertySymbols(obj);</span>
                    <span class="s0">for </span><span class="s1">(i = </span><span class="s3">0</span><span class="s1">; i &lt; names.length; i++) {</span>
                        <span class="s1">props.push({</span>
                            <span class="s1">name: integerIndiceRegex.test(names[i]) ? Number(names[i]) : names[i],</span>
                            <span class="s1">desc: Object.getOwnPropertyDescriptor(obj, names[i]),</span>
                            <span class="s1">own: own</span>
                        <span class="s1">});</span>
                    <span class="s1">}</span>
                    <span class="s0">for </span><span class="s1">(i = </span><span class="s3">0</span><span class="s1">; i &lt; symbols.length; i++) {</span>
                        <span class="s1">props.push({</span>
                            <span class="s1">name: symbols[i],</span>
                            <span class="s1">desc: Object.getOwnPropertyDescriptor(obj, symbols[i]),</span>
                            <span class="s1">own: own</span>
                        <span class="s1">});</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(key_mode === </span><span class="s3">1</span><span class="s1">) {</span>
                        <span class="s0">break</span><span class="s1">;</span>
                    <span class="s1">}</span>
                    <span class="s1">obj = Object.getPrototypeOf(obj);</span>
                    <span class="s1">own = </span><span class="s0">false</span><span class="s1">;</span>
                <span class="s1">} </span><span class="s0">while </span><span class="s1">(obj);</span>
                <span class="s0">var </span><span class="s1">ret = [];</span>
                <span class="s0">var </span><span class="s1">addName = </span><span class="s0">function </span><span class="s1">(ret, name, key_filter, conversion_mode) {</span>
                    <span class="s0">if </span><span class="s1">(ret.indexOf(name) !== -</span><span class="s3">1</span><span class="s1">)</span>
                        <span class="s0">return</span><span class="s1">;</span>
                    <span class="s0">if </span><span class="s1">(conversion_mode === </span><span class="s3">0</span><span class="s1">) {</span>
                        <span class="s1">ret.push(name);</span>
                    <span class="s1">}</span>
                    <span class="s0">else if </span><span class="s1">(conversion_mode === </span><span class="s3">1</span><span class="s1">) {</span>
                        <span class="s0">var </span><span class="s1">realName = </span><span class="s0">typeof </span><span class="s1">name === </span><span class="s2">'number' </span><span class="s1">? String(name) : name;</span>
                        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">realName === </span><span class="s2">'string'</span><span class="s1">) {</span>
                            <span class="s0">if </span><span class="s1">(!(key_filter &amp; </span><span class="s3">8</span><span class="s1">)) {</span>
                                <span class="s1">ret.push(realName);</span>
                            <span class="s1">}</span>
                        <span class="s1">}</span>
                        <span class="s0">else </span><span class="s1">{</span>
                            <span class="s1">ret.push(realName);</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                <span class="s1">};</span>
                <span class="s0">for </span><span class="s1">(i = </span><span class="s3">0</span><span class="s1">; i &lt; props.length; i++) {</span>
                    <span class="s0">var </span><span class="s1">prop = props[i];</span>
                    <span class="s0">var </span><span class="s1">name_1 = prop.name;</span>
                    <span class="s0">var </span><span class="s1">desc = prop.desc;</span>
                    <span class="s0">if </span><span class="s1">(key_filter === </span><span class="s3">0</span><span class="s1">) {</span>
                        <span class="s1">addName(ret, name_1, key_filter, key_conversion);</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s0">if </span><span class="s1">(key_filter &amp; </span><span class="s3">8 </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">name_1 === </span><span class="s2">'string'</span><span class="s1">) {</span>
                            <span class="s0">continue</span><span class="s1">;</span>
                        <span class="s1">}</span>
                        <span class="s0">if </span><span class="s1">(key_filter &amp; </span><span class="s3">16 </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">name_1 === </span><span class="s2">'symbol'</span><span class="s1">) {</span>
                            <span class="s0">continue</span><span class="s1">;</span>
                        <span class="s1">}</span>
                        <span class="s0">var </span><span class="s1">shouldAdd = </span><span class="s0">true</span><span class="s1">;</span>
                        <span class="s0">switch </span><span class="s1">(key_filter &amp; </span><span class="s3">7</span><span class="s1">) {</span>
                            <span class="s0">case </span><span class="s3">1</span><span class="s1">: {</span>
                                <span class="s1">shouldAdd = Boolean(desc.writable);</span>
                                <span class="s0">break</span><span class="s1">;</span>
                            <span class="s1">}</span>
                            <span class="s0">case </span><span class="s3">2</span><span class="s1">: {</span>
                                <span class="s1">shouldAdd = Boolean(desc.enumerable);</span>
                                <span class="s0">break</span><span class="s1">;</span>
                            <span class="s1">}</span>
                            <span class="s0">case </span><span class="s1">(</span><span class="s3">1 </span><span class="s1">| </span><span class="s3">2</span><span class="s1">): {</span>
                                <span class="s1">shouldAdd = Boolean(desc.writable &amp;&amp; desc.enumerable);</span>
                                <span class="s0">break</span><span class="s1">;</span>
                            <span class="s1">}</span>
                            <span class="s0">case </span><span class="s3">4</span><span class="s1">: {</span>
                                <span class="s1">shouldAdd = Boolean(desc.configurable);</span>
                                <span class="s0">break</span><span class="s1">;</span>
                            <span class="s1">}</span>
                            <span class="s0">case </span><span class="s1">(</span><span class="s3">4 </span><span class="s1">| </span><span class="s3">1</span><span class="s1">): {</span>
                                <span class="s1">shouldAdd = Boolean(desc.configurable &amp;&amp; desc.writable);</span>
                                <span class="s0">break</span><span class="s1">;</span>
                            <span class="s1">}</span>
                            <span class="s0">case </span><span class="s1">(</span><span class="s3">4 </span><span class="s1">| </span><span class="s3">2</span><span class="s1">): {</span>
                                <span class="s1">shouldAdd = Boolean(desc.configurable &amp;&amp; desc.enumerable);</span>
                                <span class="s0">break</span><span class="s1">;</span>
                            <span class="s1">}</span>
                            <span class="s0">case </span><span class="s1">(</span><span class="s3">4 </span><span class="s1">| </span><span class="s3">2 </span><span class="s1">| </span><span class="s3">1</span><span class="s1">): {</span>
                                <span class="s1">shouldAdd = Boolean(desc.configurable &amp;&amp; desc.enumerable &amp;&amp; desc.writable);</span>
                                <span class="s0">break</span><span class="s1">;</span>
                            <span class="s1">}</span>
                        <span class="s1">}</span>
                        <span class="s0">if </span><span class="s1">(shouldAdd) {</span>
                            <span class="s1">addName(ret, name_1, key_filter, key_conversion);</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s1">value = emnapiCtx.addToCurrentScope(ret).id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_property_names(env, object, result) {</span>
            <span class="s0">return </span><span class="s1">napi_get_all_property_names(env, object, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">2 </span><span class="s1">| </span><span class="s3">16</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, result);</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_set_property(env, object, key, value) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!key)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!value)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(!(h.isObject() || h.isFunction())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">h.value[emnapiCtx.handleStore.get(key).value] = emnapiCtx.handleStore.get(value).value;</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_has_property(env, object, key, result) {</span>
            <span class="s0">var </span><span class="s1">r;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!key)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(h.value == </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert undefined or null to object'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s1">v = h.isObject() || h.isFunction() ? h.value : Object(h.value);</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(_) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">r = (emnapiCtx.handleStore.get(key).value </span><span class="s0">in </span><span class="s1">v) ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_property(env, object, key, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!key)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(h.value == </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert undefined or null to object'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s1">v = h.isObject() || h.isFunction() ? h.value : Object(h.value);</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(_) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">value = envObject.ensureHandleId(v[emnapiCtx.handleStore.get(key).value]);</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_delete_property(env, object, key, result) {</span>
            <span class="s0">var </span><span class="s1">r;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!key)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(!(h.isObject() || h.isFunction())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">propertyKey = emnapiCtx.handleStore.get(key).value;</span>
                <span class="s0">if </span><span class="s1">(emnapiCtx.feature.supportReflect) {</span>
                    <span class="s1">r = Reflect.deleteProperty(h.value, propertyKey);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s0">try </span><span class="s1">{</span>
                        <span class="s1">r = </span><span class="s0">delete </span><span class="s1">h.value[propertyKey];</span>
                    <span class="s1">}</span>
                    <span class="s0">catch </span><span class="s1">(_) {</span>
                        <span class="s1">r = </span><span class="s0">false</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(result) {</span>
                    <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                    <span class="s1">HEAP_DATA_VIEW.setInt8(result, r ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_has_own_property(env, object, key, result) {</span>
            <span class="s0">var </span><span class="s1">r;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!key)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(h.value == </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert undefined or null to object'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s1">v = h.isObject() || h.isFunction() ? h.value : Object(h.value);</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(_) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">prop = emnapiCtx.handleStore.get(key).value;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">prop !== </span><span class="s2">'string' </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">prop !== </span><span class="s2">'symbol'</span><span class="s1">) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">4</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">r = Object.prototype.hasOwnProperty.call(v, emnapiCtx.handleStore.get(key).value);</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(result, r ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_set_named_property(env, object, cname, value) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!value)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(!(h.isObject() || h.isFunction())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!cname) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">emnapiCtx.handleStore.get(object).value[emnapiString.UTF8ToString(cname, -</span><span class="s3">1</span><span class="s1">)] = emnapiCtx.handleStore.get(value).value;</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_has_named_property(env, object, utf8name, result) {</span>
            <span class="s0">var </span><span class="s1">r;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!utf8name) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(h.value == </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert undefined or null to object'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s1">v = h.isObject() || h.isFunction() ? h.value : Object(h.value);</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(_) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">r = emnapiString.UTF8ToString(utf8name, -</span><span class="s3">1</span><span class="s1">) </span><span class="s0">in </span><span class="s1">v;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(result, r ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_named_property(env, object, utf8name, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!utf8name) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(h.value == </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert undefined or null to object'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s1">v = h.isObject() || h.isFunction() ? h.value : Object(h.value);</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(_) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">value = envObject.ensureHandleId(v[emnapiString.UTF8ToString(utf8name, -</span><span class="s3">1</span><span class="s1">)]);</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_set_element(env, object, index, value) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!value)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(!(h.isObject() || h.isFunction())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">h.value[index &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">] = emnapiCtx.handleStore.get(value).value;</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_has_element(env, object, index, result) {</span>
            <span class="s0">var </span><span class="s1">r;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(h.value == </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert undefined or null to object'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s1">v = h.isObject() || h.isFunction() ? h.value : Object(h.value);</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(_) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">r = ((index &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">) </span><span class="s0">in </span><span class="s1">v) ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_get_element(env, object, index, result) {</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(h.value == </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert undefined or null to object'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">v = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">try </span><span class="s1">{</span>
                    <span class="s1">v = h.isObject() || h.isFunction() ? h.value : Object(h.value);</span>
                <span class="s1">}</span>
                <span class="s0">catch </span><span class="s1">(_) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">value = envObject.ensureHandleId(v[index &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">]);</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_delete_element(env, object, index, result) {</span>
            <span class="s0">var </span><span class="s1">r;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">if </span><span class="s1">(!(h.isObject() || h.isFunction())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(emnapiCtx.feature.supportReflect) {</span>
                    <span class="s1">r = Reflect.deleteProperty(h.value, index &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s0">try </span><span class="s1">{</span>
                        <span class="s1">r = </span><span class="s0">delete </span><span class="s1">h.value[index &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">];</span>
                    <span class="s1">}</span>
                    <span class="s0">catch </span><span class="s1">(_) {</span>
                        <span class="s1">r = </span><span class="s0">false</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(result) {</span>
                    <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                    <span class="s1">HEAP_DATA_VIEW.setInt8(result, r ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_define_properties(env, object, property_count, properties) {</span>
            <span class="s0">var </span><span class="s1">propPtr, attributes;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s1">property_count = property_count &gt;&gt;&gt; </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(property_count &gt; </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">if </span><span class="s1">(!properties)</span>
                        <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">var </span><span class="s1">maybeObject = h.value;</span>
                <span class="s0">if </span><span class="s1">(!(h.isObject() || h.isFunction())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">propertyName = </span><span class="s0">void </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; property_count; i++) {</span>
                    <span class="s1">propPtr = properties + (i * (</span><span class="s3">4 </span><span class="s1">* </span><span class="s3">8</span><span class="s1">));</span>
                    <span class="s0">var </span><span class="s1">utf8Name = HEAP_DATA_VIEW.getUint32(propPtr, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">name_2 = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">4</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">method = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">8</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">getter = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">12</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">setter = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">16</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">value = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">20</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s1">attributes = HEAP_DATA_VIEW.getInt32(propPtr + </span><span class="s3">24</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">var </span><span class="s1">data = HEAP_DATA_VIEW.getUint32(propPtr + </span><span class="s3">28</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                    <span class="s0">if </span><span class="s1">(utf8Name) {</span>
                        <span class="s1">propertyName = emnapiString.UTF8ToString(utf8Name, -</span><span class="s3">1</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s0">else </span><span class="s1">{</span>
                        <span class="s0">if </span><span class="s1">(!name_2) {</span>
                            <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">4</span><span class="s1">);</span>
                        <span class="s1">}</span>
                        <span class="s1">propertyName = emnapiCtx.handleStore.get(name_2).value;</span>
                        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">propertyName !== </span><span class="s2">'string' </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">propertyName !== </span><span class="s2">'symbol'</span><span class="s1">) {</span>
                            <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">4</span><span class="s1">);</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                    <span class="s1">emnapiDefineProperty(envObject, maybeObject, propertyName, method, getter, setter, value, attributes, data);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_object_freeze(env, object) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">var </span><span class="s1">maybeObject = h.value;</span>
                <span class="s0">if </span><span class="s1">(!(h.isObject() || h.isFunction())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">Object.freeze(maybeObject);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_object_seal(env, object) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(object);</span>
                <span class="s0">var </span><span class="s1">maybeObject = h.value;</span>
                <span class="s0">if </span><span class="s1">(!(h.isObject() || h.isFunction())) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">2</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">Object.seal(maybeObject);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">propertyMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_define_properties: napi_define_properties,</span>
            <span class="s1">napi_delete_element: napi_delete_element,</span>
            <span class="s1">napi_delete_property: napi_delete_property,</span>
            <span class="s1">napi_get_all_property_names: napi_get_all_property_names,</span>
            <span class="s1">napi_get_element: napi_get_element,</span>
            <span class="s1">napi_get_named_property: napi_get_named_property,</span>
            <span class="s1">napi_get_property: napi_get_property,</span>
            <span class="s1">napi_get_property_names: napi_get_property_names,</span>
            <span class="s1">napi_has_element: napi_has_element,</span>
            <span class="s1">napi_has_named_property: napi_has_named_property,</span>
            <span class="s1">napi_has_own_property: napi_has_own_property,</span>
            <span class="s1">napi_has_property: napi_has_property,</span>
            <span class="s1">napi_object_freeze: napi_object_freeze,</span>
            <span class="s1">napi_object_seal: napi_object_seal,</span>
            <span class="s1">napi_set_element: napi_set_element,</span>
            <span class="s1">napi_set_named_property: napi_set_named_property,</span>
            <span class="s1">napi_set_property: napi_set_property</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_run_script(env, script, result) {</span>
            <span class="s0">var </span><span class="s1">status;</span>
            <span class="s0">var </span><span class="s1">value;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!script)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">v8Script = emnapiCtx.handleStore.get(script);</span>
                <span class="s0">if </span><span class="s1">(!v8Script.isString()) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">3</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">g = emnapiCtx.handleStore.get(</span><span class="s3">5</span><span class="s1">).value;</span>
                <span class="s0">var </span><span class="s1">ret = g.eval(v8Script.value);</span>
                <span class="s1">value = envObject.ensureHandleId(ret);</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, value, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s1">status = envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">status;</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">scriptMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_run_script: napi_run_script</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_typeof(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">v = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">var </span><span class="s1">r;</span>
            <span class="s0">if </span><span class="s1">(v.isNumber()) {</span>
                <span class="s1">r = </span><span class="s3">3</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(v.isBigInt()) {</span>
                <span class="s1">r = </span><span class="s3">9</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(v.isString()) {</span>
                <span class="s1">r = </span><span class="s3">4</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(v.isFunction()) {</span>
                <span class="s1">r = </span><span class="s3">7</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(v.isExternal()) {</span>
                <span class="s1">r = </span><span class="s3">8</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(v.isObject()) {</span>
                <span class="s1">r = </span><span class="s3">6</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(v.isBoolean()) {</span>
                <span class="s1">r = </span><span class="s3">2</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(v.isUndefined()) {</span>
                <span class="s1">r = </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(v.isSymbol()) {</span>
                <span class="s1">r = </span><span class="s3">5</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">else if </span><span class="s1">(v.isNull()) {</span>
                <span class="s1">r = </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt32(result, r, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_coerce_to_bool(env, value, result) {</span>
            <span class="s0">var </span><span class="s1">v;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!value)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
                <span class="s1">v = handle.value ? </span><span class="s3">4 </span><span class="s1">: </span><span class="s3">3</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_coerce_to_number(env, value, result) {</span>
            <span class="s0">var </span><span class="s1">v;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!value)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
                <span class="s0">if </span><span class="s1">(handle.isBigInt()) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert a BigInt value to a number'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">v = emnapiCtx.addToCurrentScope(Number(handle.value)).id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_coerce_to_object(env, value, result) {</span>
            <span class="s0">var </span><span class="s1">v;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!value)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
                <span class="s0">if </span><span class="s1">(handle.value == </span><span class="s0">null</span><span class="s1">) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert undefined or null to object'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">v = envObject.ensureHandleId(Object(handle.value));</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_coerce_to_string(env, value, result) {</span>
            <span class="s0">var </span><span class="s1">v;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!value)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">handle = emnapiCtx.handleStore.get(value);</span>
                <span class="s0">if </span><span class="s1">(handle.isSymbol()) {</span>
                    <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Cannot convert a Symbol value to a string'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s1">v = emnapiCtx.addToCurrentScope(String(handle.value)).id;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setUint32(result, v, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_instanceof(env, object, constructor, result) {</span>
            <span class="s0">var </span><span class="s1">r;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!object)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!constructor)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(result, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">ctor = emnapiCtx.handleStore.get(constructor);</span>
                <span class="s0">if </span><span class="s1">(!ctor.isFunction()) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">5</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">var </span><span class="s1">val = emnapiCtx.handleStore.get(object).value;</span>
                <span class="s0">var </span><span class="s1">ret = val </span><span class="s0">instanceof </span><span class="s1">ctor.value;</span>
                <span class="s1">r = ret ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_is_array(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">var </span><span class="s1">r = h.isArray() ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_is_arraybuffer(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">var </span><span class="s1">r = h.isArrayBuffer() ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_is_date(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">var </span><span class="s1">r = h.isDate() ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_is_error(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">val = emnapiCtx.handleStore.get(value).value;</span>
            <span class="s0">var </span><span class="s1">r = (val </span><span class="s0">instanceof </span><span class="s1">Error) ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_is_typedarray(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">var </span><span class="s1">r = h.isTypedArray() ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_is_buffer(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">var </span><span class="s1">r = h.isBuffer(emnapiCtx.feature.Buffer) ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_is_dataview(env, value, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!value)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(value);</span>
            <span class="s0">var </span><span class="s1">r = h.isDataView() ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_strict_equals(env, lhs, rhs, result) {</span>
            <span class="s0">var </span><span class="s1">r;</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!lhs)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!rhs)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">lv = emnapiCtx.handleStore.get(lhs).value;</span>
                <span class="s0">var </span><span class="s1">rv = emnapiCtx.handleStore.get(rhs).value;</span>
                <span class="s1">r = (lv === rv) ? </span><span class="s3">1 </span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(result, r, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_detach_arraybuffer(env, arraybuffer) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!arraybuffer)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">value = emnapiCtx.handleStore.get(arraybuffer).value;</span>
            <span class="s0">if </span><span class="s1">(!(value </span><span class="s0">instanceof </span><span class="s1">ArrayBuffer)) {</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">SharedArrayBuffer === </span><span class="s2">'function' </span><span class="s1">&amp;&amp; (value </span><span class="s0">instanceof </span><span class="s1">SharedArrayBuffer)) {</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">20</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">19</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">var </span><span class="s1">MessageChannel_1 = emnapiCtx.feature.MessageChannel;</span>
                <span class="s0">var </span><span class="s1">messageChannel = </span><span class="s0">new </span><span class="s1">MessageChannel_1();</span>
                <span class="s1">messageChannel.port1.postMessage(value, [value]);</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(_) {</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">9</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">function </span><span class="s1">napi_is_detached_arraybuffer(env, arraybuffer, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s1">envObject.checkGCAccess();</span>
            <span class="s0">if </span><span class="s1">(!envObject.tryCatch.isEmpty())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s0">if </span><span class="s1">(!envObject.canCallIntoJs())</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(envObject.moduleApiVersion &gt;= </span><span class="s3">10 </span><span class="s1">? </span><span class="s3">23 </span><span class="s1">: </span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">envObject.clearLastError();</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!arraybuffer)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">if </span><span class="s1">(!result)</span>
                    <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
                <span class="s0">var </span><span class="s1">h = emnapiCtx.handleStore.get(arraybuffer);</span>
                <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
                <span class="s0">if </span><span class="s1">(h.isArrayBuffer() &amp;&amp; h.value.byteLength === </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s0">try </span><span class="s1">{</span>
                        <span class="s0">new </span><span class="s1">Uint8Array(h.value);</span>
                    <span class="s1">}</span>
                    <span class="s0">catch </span><span class="s1">(_) {</span>
                        <span class="s1">HEAP_DATA_VIEW.setInt8(result, </span><span class="s3">1</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                        <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s1">HEAP_DATA_VIEW.setInt8(result, </span><span class="s3">0</span><span class="s1">, </span><span class="s0">true</span><span class="s1">);</span>
                <span class="s0">return </span><span class="s1">envObject.getReturnStatus();</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s1">envObject.tryCatch.setError(err);</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">10</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">valueOperationMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_coerce_to_bool: napi_coerce_to_bool,</span>
            <span class="s1">napi_coerce_to_number: napi_coerce_to_number,</span>
            <span class="s1">napi_coerce_to_object: napi_coerce_to_object,</span>
            <span class="s1">napi_coerce_to_string: napi_coerce_to_string,</span>
            <span class="s1">napi_detach_arraybuffer: napi_detach_arraybuffer,</span>
            <span class="s1">napi_instanceof: napi_instanceof,</span>
            <span class="s1">napi_is_array: napi_is_array,</span>
            <span class="s1">napi_is_arraybuffer: napi_is_arraybuffer,</span>
            <span class="s1">napi_is_buffer: napi_is_buffer,</span>
            <span class="s1">napi_is_dataview: napi_is_dataview,</span>
            <span class="s1">napi_is_date: napi_is_date,</span>
            <span class="s1">napi_is_detached_arraybuffer: napi_is_detached_arraybuffer,</span>
            <span class="s1">napi_is_error: napi_is_error,</span>
            <span class="s1">napi_is_typedarray: napi_is_typedarray,</span>
            <span class="s1">napi_strict_equals: napi_strict_equals,</span>
            <span class="s1">napi_typeof: napi_typeof</span>
        <span class="s1">});</span>
        <span class="s0">function </span><span class="s1">napi_get_version(env, result) {</span>
            <span class="s0">if </span><span class="s1">(!env)</span>
                <span class="s0">return </span><span class="s3">1</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">envObject = emnapiCtx.envStore.get(env);</span>
            <span class="s0">if </span><span class="s1">(!result)</span>
                <span class="s0">return </span><span class="s1">envObject.setLastError(</span><span class="s3">1</span><span class="s1">);</span>
            <span class="s0">var </span><span class="s1">NODE_API_SUPPORTED_VERSION_MAX = </span><span class="s3">10</span><span class="s1">;</span>
            <span class="s0">var </span><span class="s1">HEAP_DATA_VIEW = </span><span class="s0">new </span><span class="s1">DataView(wasmMemory.buffer);</span>
            <span class="s1">HEAP_DATA_VIEW.setUint32(result, NODE_API_SUPPORTED_VERSION_MAX, </span><span class="s0">true</span><span class="s1">);</span>
            <span class="s0">return </span><span class="s1">envObject.clearLastError();</span>
        <span class="s1">}</span>
        <span class="s0">var </span><span class="s1">versionMod = Object.freeze({</span>
            <span class="s1">__proto__: </span><span class="s0">null</span><span class="s1">,</span>
            <span class="s1">napi_get_version: napi_get_version</span>
        <span class="s1">});</span>
        <span class="s1">emnapiAWST.init();</span>
        <span class="s1">emnapiExternalMemory.init();</span>
        <span class="s1">emnapiString.init();</span>
        <span class="s1">emnapiTSFN.init();</span>
        <span class="s1">PThread.init();</span>
        <span class="s1">napiModule.emnapi.syncMemory = $emnapiSyncMemory;</span>
        <span class="s1">napiModule.emnapi.getMemoryAddress = $emnapiGetMemoryAddress;</span>
        <span class="s0">function </span><span class="s1">addImports(mod) {</span>
            <span class="s0">var </span><span class="s1">keys = Object.keys(mod);</span>
            <span class="s0">for </span><span class="s1">(</span><span class="s0">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">; i &lt; keys.length; ++i) {</span>
                <span class="s0">var </span><span class="s1">k = keys[i];</span>
                <span class="s0">if </span><span class="s1">(k.indexOf(</span><span class="s2">'$'</span><span class="s1">) === </span><span class="s3">0</span><span class="s1">)</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s0">if </span><span class="s1">(k.indexOf(</span><span class="s2">'emnapi_'</span><span class="s1">) === </span><span class="s3">0</span><span class="s1">) {</span>
                    <span class="s1">napiModule.imports.emnapi[k] = mod[k];</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(k.indexOf(</span><span class="s2">'_emnapi_'</span><span class="s1">) === </span><span class="s3">0 </span><span class="s1">|| k === </span><span class="s2">'napi_set_last_error' </span><span class="s1">|| k === </span><span class="s2">'napi_clear_last_error'</span><span class="s1">) {</span>
                    <span class="s1">napiModule.imports.env[k] = mod[k];</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">napiModule.imports.napi[k] = mod[k];</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s1">addImports(asyncMod);</span>
        <span class="s1">addImports(memoryMod);</span>
        <span class="s1">addImports(asyncWorkMod);</span>
        <span class="s1">addImports(utilMod);</span>
        <span class="s1">addImports(convert2cMod);</span>
        <span class="s1">addImports(convert2napiMod);</span>
        <span class="s1">addImports(createMod);</span>
        <span class="s1">addImports(globalMod);</span>
        <span class="s1">addImports(wrapMod);</span>
        <span class="s1">addImports(envMod);</span>
        <span class="s1">addImports(emnapiMod);</span>
        <span class="s1">addImports(errorMod);</span>
        <span class="s1">addImports(functionMod);</span>
        <span class="s1">addImports(lifeMod);</span>
        <span class="s1">addImports(miscellaneousMod);</span>
        <span class="s1">addImports(nodeMod);</span>
        <span class="s1">addImports(promiseMod);</span>
        <span class="s1">addImports(propertyMod);</span>
        <span class="s1">addImports(scriptMod);</span>
        <span class="s1">addImports(valueOperationMod);</span>
        <span class="s1">addImports(versionMod);</span>
        <span class="s1">napiModule.imports.napi.napi_create_threadsafe_function = napi_create_threadsafe_function;</span>
        <span class="s1">napiModule.imports.napi.napi_get_threadsafe_function_context = napi_get_threadsafe_function_context;</span>
        <span class="s1">napiModule.imports.napi.napi_call_threadsafe_function = napi_call_threadsafe_function;</span>
        <span class="s1">napiModule.imports.napi.napi_acquire_threadsafe_function = napi_acquire_threadsafe_function;</span>
        <span class="s1">napiModule.imports.napi.napi_release_threadsafe_function = napi_release_threadsafe_function;</span>
        <span class="s1">napiModule.imports.napi.napi_unref_threadsafe_function = napi_unref_threadsafe_function;</span>
        <span class="s1">napiModule.imports.napi.napi_ref_threadsafe_function = napi_ref_threadsafe_function;</span>
        <span class="s0">return </span><span class="s1">napiModule;</span>
    <span class="s1">})();</span>
    <span class="s0">return </span><span class="s1">napiModule;</span>
<span class="s1">}</span>

<span class="s0">function </span><span class="s1">loadNapiModuleImpl(loadFn, userNapiModule, wasmInput, options) {</span>
    <span class="s1">options = options !== </span><span class="s0">null </span><span class="s1">&amp;&amp; options !== </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? options : {};</span>
    <span class="s0">const </span><span class="s1">getMemory = options.getMemory;</span>
    <span class="s0">const </span><span class="s1">getTable = options.getTable;</span>
    <span class="s0">const </span><span class="s1">beforeInit = options.beforeInit;</span>
    <span class="s0">if </span><span class="s1">(getMemory != </span><span class="s0">null </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">getMemory !== </span><span class="s2">'function'</span><span class="s1">) {</span>
        <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'options.getMemory is not a function'</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s0">if </span><span class="s1">(getTable != </span><span class="s0">null </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">getTable !== </span><span class="s2">'function'</span><span class="s1">) {</span>
        <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'options.getTable is not a function'</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s0">if </span><span class="s1">(beforeInit != </span><span class="s0">null </span><span class="s1">&amp;&amp; </span><span class="s0">typeof </span><span class="s1">beforeInit !== </span><span class="s2">'function'</span><span class="s1">) {</span>
        <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'options.beforeInit is not a function'</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s0">let </span><span class="s1">napiModule;</span>
    <span class="s0">const </span><span class="s1">isLoad = </span><span class="s0">typeof </span><span class="s1">userNapiModule === </span><span class="s2">'object' </span><span class="s1">&amp;&amp; userNapiModule !== </span><span class="s0">null</span><span class="s1">;</span>
    <span class="s0">if </span><span class="s1">(isLoad) {</span>
        <span class="s0">if </span><span class="s1">(userNapiModule.loaded) {</span>
            <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'napiModule has already loaded'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s1">napiModule = userNapiModule;</span>
    <span class="s1">}</span>
    <span class="s0">else </span><span class="s1">{</span>
        <span class="s1">napiModule = createNapiModule(options);</span>
    <span class="s1">}</span>
    <span class="s0">const </span><span class="s1">wasi = options.wasi;</span>
    <span class="s0">let </span><span class="s1">wasiThreads$1;</span>
    <span class="s0">let </span><span class="s1">importObject = {</span>
        <span class="s1">env: napiModule.imports.env,</span>
        <span class="s1">napi: napiModule.imports.napi,</span>
        <span class="s1">emnapi: napiModule.imports.emnapi</span>
    <span class="s1">};</span>
    <span class="s0">if </span><span class="s1">(wasi) {</span>
        <span class="s1">wasiThreads$1 = </span><span class="s0">new </span><span class="s1">wasiThreads.WASIThreads(napiModule.childThread</span>
            <span class="s1">? {</span>
                <span class="s1">wasi,</span>
                <span class="s1">childThread: </span><span class="s0">true</span><span class="s1">,</span>
                <span class="s1">postMessage: napiModule.postMessage</span>
            <span class="s1">}</span>
            <span class="s1">: {</span>
                <span class="s1">wasi,</span>
                <span class="s1">threadManager: napiModule.PThread,</span>
                <span class="s1">waitThreadStart: napiModule.waitThreadStart</span>
            <span class="s1">});</span>
        <span class="s1">Object.assign(importObject, </span><span class="s0">typeof </span><span class="s1">wasi.getImportObject === </span><span class="s2">'function'</span>
            <span class="s1">? wasi.getImportObject()</span>
            <span class="s1">: { wasi_snapshot_preview1: wasi.wasiImport });</span>
        <span class="s1">Object.assign(importObject, wasiThreads$1.getImportObject());</span>
    <span class="s1">}</span>
    <span class="s0">const </span><span class="s1">overwriteImports = options.overwriteImports;</span>
    <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">overwriteImports === </span><span class="s2">'function'</span><span class="s1">) {</span>
        <span class="s0">const </span><span class="s1">newImportObject = overwriteImports(importObject);</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">newImportObject === </span><span class="s2">'object' </span><span class="s1">&amp;&amp; newImportObject !== </span><span class="s0">null</span><span class="s1">) {</span>
            <span class="s1">importObject = newImportObject;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s0">return </span><span class="s1">loadFn(wasmInput, importObject, (err, source) =&gt; {</span>
        <span class="s0">if </span><span class="s1">(err) {</span>
            <span class="s0">throw </span><span class="s1">err;</span>
        <span class="s1">}</span>
        <span class="s0">const </span><span class="s1">originalInstance = source.instance;</span>
        <span class="s0">let </span><span class="s1">instance = originalInstance;</span>
        <span class="s0">const </span><span class="s1">originalExports = originalInstance.exports;</span>
        <span class="s0">const </span><span class="s1">exportMemory = </span><span class="s2">'memory' </span><span class="s0">in </span><span class="s1">originalExports;</span>
        <span class="s0">const </span><span class="s1">importMemory = </span><span class="s2">'memory' </span><span class="s0">in </span><span class="s1">importObject.env;</span>
        <span class="s0">const </span><span class="s1">memory = getMemory</span>
            <span class="s1">? getMemory(originalExports)</span>
            <span class="s1">: exportMemory</span>
                <span class="s1">? originalExports.memory</span>
                <span class="s1">: importMemory</span>
                    <span class="s1">? importObject.env.memory</span>
                    <span class="s1">: undefined;</span>
        <span class="s0">if </span><span class="s1">(!memory) {</span>
            <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'memory is neither exported nor imported'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">const </span><span class="s1">table = getTable ? getTable(originalExports) : originalExports.__indirect_function_table;</span>
        <span class="s0">if </span><span class="s1">(wasi &amp;&amp; !exportMemory) {</span>
            <span class="s0">const </span><span class="s1">exports = Object.create(</span><span class="s0">null</span><span class="s1">);</span>
            <span class="s1">Object.assign(exports, originalExports, { memory });</span>
            <span class="s1">instance = { exports };</span>
        <span class="s1">}</span>
        <span class="s0">const </span><span class="s1">module = source.module;</span>
        <span class="s0">if </span><span class="s1">(wasi) {</span>
            <span class="s1">instance = wasiThreads$1.initialize(instance, module, memory);</span>
        <span class="s1">}</span>
        <span class="s0">else </span><span class="s1">{</span>
            <span class="s1">napiModule.PThread.setup(module, memory);</span>
        <span class="s1">}</span>
        <span class="s0">const </span><span class="s1">emnapiInit = () =&gt; {</span>
            <span class="s0">if </span><span class="s1">(beforeInit) {</span>
                <span class="s1">beforeInit({</span>
                    <span class="s1">instance: originalInstance,</span>
                    <span class="s1">module</span>
                <span class="s1">});</span>
            <span class="s1">}</span>
            <span class="s1">napiModule.init({</span>
                <span class="s1">instance,</span>
                <span class="s1">module,</span>
                <span class="s1">memory,</span>
                <span class="s1">table</span>
            <span class="s1">});</span>
            <span class="s0">const </span><span class="s1">ret = {</span>
                <span class="s1">instance: originalInstance,</span>
                <span class="s1">module,</span>
                <span class="s1">usedInstance: instance</span>
            <span class="s1">};</span>
            <span class="s0">if </span><span class="s1">(!isLoad) {</span>
                <span class="s1">ret.napiModule = napiModule;</span>
            <span class="s1">}</span>
            <span class="s0">return </span><span class="s1">ret;</span>
        <span class="s1">};</span>
        <span class="s0">if </span><span class="s1">(napiModule.PThread.shouldPreloadWorkers()) {</span>
            <span class="s0">const </span><span class="s1">poolReady = napiModule.PThread.loadWasmModuleToAllWorkers();</span>
            <span class="s0">if </span><span class="s1">(loadFn === loadCallback) {</span>
                <span class="s0">return </span><span class="s1">poolReady.then(emnapiInit);</span>
            <span class="s1">}</span>
            <span class="s0">else </span><span class="s1">{</span>
                <span class="s0">throw new </span><span class="s1">Error(</span><span class="s2">'Synchronous loading is not supported with worker pool (reuseWorker.size &gt; 0)'</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s0">return </span><span class="s1">emnapiInit();</span>
    <span class="s1">});</span>
<span class="s1">}</span>
<span class="s0">function </span><span class="s1">loadCallback(wasmInput, importObject, callback) {</span>
    <span class="s0">return </span><span class="s1">load(wasmInput, importObject).then((source) =&gt; {</span>
        <span class="s0">return </span><span class="s1">callback(</span><span class="s0">null</span><span class="s1">, source);</span>
    <span class="s1">}, err =&gt; {</span>
        <span class="s0">return </span><span class="s1">callback(err);</span>
    <span class="s1">});</span>
<span class="s1">}</span>
<span class="s0">function </span><span class="s1">loadSyncCallback(wasmInput, importObject, callback) {</span>
    <span class="s0">let </span><span class="s1">source;</span>
    <span class="s0">try </span><span class="s1">{</span>
        <span class="s1">source = loadSync(wasmInput, importObject);</span>
    <span class="s1">}</span>
    <span class="s0">catch </span><span class="s1">(err) {</span>
        <span class="s0">return </span><span class="s1">callback(err);</span>
    <span class="s1">}</span>
    <span class="s0">return </span><span class="s1">callback(</span><span class="s0">null</span><span class="s1">, source);</span>
<span class="s1">}</span>
<span class="s0">function </span><span class="s1">loadNapiModule(napiModule, wasmInput, options) {</span>
    <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">napiModule !== </span><span class="s2">'object' </span><span class="s1">|| napiModule === </span><span class="s0">null</span><span class="s1">) {</span>
        <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid napiModule'</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s0">return </span><span class="s1">loadNapiModuleImpl(loadCallback, napiModule, wasmInput, options);</span>
<span class="s1">}</span>
<span class="s0">function </span><span class="s1">loadNapiModuleSync(napiModule, wasmInput, options) {</span>
    <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">napiModule !== </span><span class="s2">'object' </span><span class="s1">|| napiModule === </span><span class="s0">null</span><span class="s1">) {</span>
        <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'Invalid napiModule'</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s0">return </span><span class="s1">loadNapiModuleImpl(loadSyncCallback, napiModule, wasmInput, options);</span>
<span class="s1">}</span>
<span class="s0">function </span><span class="s1">instantiateNapiModule(wasmInput, options) {</span>
    <span class="s0">return </span><span class="s1">loadNapiModuleImpl(loadCallback, undefined, wasmInput, options);</span>
<span class="s1">}</span>
<span class="s0">function </span><span class="s1">instantiateNapiModuleSync(wasmInput, options) {</span>
    <span class="s0">return </span><span class="s1">loadNapiModuleImpl(loadSyncCallback, undefined, wasmInput, options);</span>
<span class="s1">}</span>

<span class="s0">class </span><span class="s1">MessageHandler </span><span class="s0">extends </span><span class="s1">wasiThreads.ThreadMessageHandler {</span>
    <span class="s1">constructor(options) {</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">options.onLoad !== </span><span class="s2">'function'</span><span class="s1">) {</span>
            <span class="s0">throw new </span><span class="s1">TypeError(</span><span class="s2">'options.onLoad is not a function'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s0">const </span><span class="s1">userOnError = options.onError;</span>
        <span class="s0">super</span><span class="s1">({</span>
            <span class="s1">...options,</span>
            <span class="s1">onError: (err, type) =&gt; {</span>
                <span class="s0">var </span><span class="s1">_a;</span>
                <span class="s0">const </span><span class="s1">emnapi_thread_crashed = (_a = </span><span class="s0">this</span><span class="s1">.instance) === </span><span class="s0">null </span><span class="s1">|| _a === </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">: _a.exports.emnapi_thread_crashed;</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">emnapi_thread_crashed === </span><span class="s2">'function'</span><span class="s1">) {</span>
                    <span class="s1">emnapi_thread_crashed();</span>
                <span class="s1">}</span>
                <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">userOnError === </span><span class="s2">'function'</span><span class="s1">) {</span>
                    <span class="s1">userOnError(err, type);</span>
                <span class="s1">}</span>
                <span class="s0">else </span><span class="s1">{</span>
                    <span class="s0">throw </span><span class="s1">err;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">});</span>
        <span class="s0">this</span><span class="s1">.napiModule = undefined;</span>
    <span class="s1">}</span>
    <span class="s1">instantiate(data) {</span>
        <span class="s0">const </span><span class="s1">source = </span><span class="s0">this</span><span class="s1">.onLoad(data);</span>
        <span class="s0">const </span><span class="s1">then = source.then;</span>
        <span class="s0">if </span><span class="s1">(</span><span class="s0">typeof </span><span class="s1">then === </span><span class="s2">'function'</span><span class="s1">) {</span>
            <span class="s0">return </span><span class="s1">source.then((result) =&gt; {</span>
                <span class="s0">this</span><span class="s1">.napiModule = result.napiModule;</span>
                <span class="s0">return </span><span class="s1">result;</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s0">this</span><span class="s1">.napiModule = source.napiModule;</span>
        <span class="s0">return </span><span class="s1">source;</span>
    <span class="s1">}</span>
    <span class="s1">handle(e) {</span>
        <span class="s0">var </span><span class="s1">_a;</span>
        <span class="s0">super</span><span class="s1">.handle(e);</span>
        <span class="s0">if </span><span class="s1">((_a = e === </span><span class="s0">null </span><span class="s1">|| e === </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">: e.data) === </span><span class="s0">null </span><span class="s1">|| _a === </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">? </span><span class="s0">void </span><span class="s3">0 </span><span class="s1">: _a.__emnapi__) {</span>
            <span class="s0">const </span><span class="s1">type = e.data.__emnapi__.type;</span>
            <span class="s0">const </span><span class="s1">payload = e.data.__emnapi__.payload;</span>
            <span class="s0">try </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(type === </span><span class="s2">'async-worker-init'</span><span class="s1">) {</span>
                    <span class="s0">this</span><span class="s1">.handleAfterLoad(e, () =&gt; {</span>
                        <span class="s0">this</span><span class="s1">.napiModule.initWorker(payload.arg);</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
                <span class="s0">else if </span><span class="s1">(type === </span><span class="s2">'async-work-execute'</span><span class="s1">) {</span>
                    <span class="s0">this</span><span class="s1">.handleAfterLoad(e, () =&gt; {</span>
                        <span class="s0">this</span><span class="s1">.napiModule.executeAsyncWork(payload.work);</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s0">catch </span><span class="s1">(err) {</span>
                <span class="s0">this</span><span class="s1">.onError(err, type);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s0">const </span><span class="s1">version = </span><span class="s2">&quot;1.5.0&quot;</span><span class="s1">;</span>

<span class="s1">exports.MessageHandler = MessageHandler;</span>
<span class="s1">exports.createNapiModule = createNapiModule;</span>
<span class="s1">exports.instantiateNapiModule = instantiateNapiModule;</span>
<span class="s1">exports.instantiateNapiModuleSync = instantiateNapiModuleSync;</span>
<span class="s1">exports.loadNapiModule = loadNapiModule;</span>
<span class="s1">exports.loadNapiModuleSync = loadNapiModuleSync;</span>
<span class="s1">exports.version = version;</span>
<span class="s1">Object.keys(wasiThreads).forEach(</span><span class="s0">function </span><span class="s1">(k) {</span>
    <span class="s0">if </span><span class="s1">(k !== </span><span class="s2">'default' </span><span class="s1">&amp;&amp; !Object.prototype.hasOwnProperty.call(exports, k)) Object.defineProperty(exports, k, {</span>
        <span class="s1">enumerable: </span><span class="s0">true</span><span class="s1">,</span>
        <span class="s1">get: </span><span class="s0">function </span><span class="s1">() { </span><span class="s0">return </span><span class="s1">wasiThreads[k]; }</span>
    <span class="s1">});</span>
<span class="s1">});</span>
</pre>
</body>
</html>