<html>
<head>
<title>register.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #1750eb;}
.s4 { color: #8c8c8c; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
register.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>
<span class="s2">var </span><span class="s1">__spreadArray = (</span><span class="s2">this </span><span class="s1">&amp;&amp; </span><span class="s2">this</span><span class="s1">.__spreadArray) || </span><span class="s2">function </span><span class="s1">(to, from, pack) {</span>
    <span class="s2">if </span><span class="s1">(pack || arguments.length === </span><span class="s3">2</span><span class="s1">) </span><span class="s2">for </span><span class="s1">(</span><span class="s2">var </span><span class="s1">i = </span><span class="s3">0</span><span class="s1">, l = from.length, ar; i &lt; l; i++) {</span>
        <span class="s2">if </span><span class="s1">(ar || !(i </span><span class="s2">in </span><span class="s1">from)) {</span>
            <span class="s2">if </span><span class="s1">(!ar) ar = Array.prototype.slice.call(from, </span><span class="s3">0</span><span class="s1">, i);</span>
            <span class="s1">ar[i] = from[i];</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">to.concat(ar || Array.prototype.slice.call(from));</span>
<span class="s1">};</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, { value: </span><span class="s2">true </span><span class="s1">});</span>
<span class="s1">exports.register = </span><span class="s2">void </span><span class="s3">0</span><span class="s1">;</span>
<span class="s2">var </span><span class="s1">match_path_sync_1 = require(</span><span class="s0">&quot;./match-path-sync&quot;</span><span class="s1">);</span>
<span class="s2">var </span><span class="s1">config_loader_1 = require(</span><span class="s0">&quot;./config-loader&quot;</span><span class="s1">);</span>
<span class="s2">var </span><span class="s1">options_1 = require(</span><span class="s0">&quot;./options&quot;</span><span class="s1">);</span>
<span class="s2">var </span><span class="s1">noOp = </span><span class="s2">function </span><span class="s1">() { </span><span class="s2">return void </span><span class="s3">0</span><span class="s1">; };</span>
<span class="s2">function </span><span class="s1">getCoreModules(builtinModules) {</span>
    <span class="s1">builtinModules = builtinModules || [</span>
        <span class="s0">&quot;assert&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;buffer&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;child_process&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;cluster&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;crypto&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;dgram&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;dns&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;domain&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;events&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;fs&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;http&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;https&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;net&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;os&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;path&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;punycode&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;querystring&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;readline&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;stream&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;string_decoder&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;tls&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;tty&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;url&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;util&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;v8&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;vm&quot;</span><span class="s1">,</span>
        <span class="s0">&quot;zlib&quot;</span><span class="s1">,</span>
    <span class="s1">];</span>
    <span class="s2">var </span><span class="s1">coreModules = {};</span>
    <span class="s2">for </span><span class="s1">(</span><span class="s2">var </span><span class="s1">_i = </span><span class="s3">0</span><span class="s1">, builtinModules_1 = builtinModules; _i &lt; builtinModules_1.length; _i++) {</span>
        <span class="s2">var </span><span class="s1">module_1 = builtinModules_1[_i];</span>
        <span class="s1">coreModules[module_1] = </span><span class="s2">true</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">coreModules;</span>
<span class="s1">}</span>
<span class="s4">/**</span>
 <span class="s4">* Installs a custom module load function that can adhere to paths in tsconfig.</span>
 <span class="s4">* Returns a function to undo paths registration.</span>
 <span class="s4">*/</span>
<span class="s2">function </span><span class="s1">register(explicitParams) {</span>
    <span class="s2">var </span><span class="s1">configLoaderResult = (</span><span class="s3">0</span><span class="s1">, config_loader_1.configLoader)({</span>
        <span class="s1">cwd: options_1.options.cwd,</span>
        <span class="s1">explicitParams: explicitParams,</span>
    <span class="s1">});</span>
    <span class="s2">if </span><span class="s1">(configLoaderResult.resultType === </span><span class="s0">&quot;failed&quot;</span><span class="s1">) {</span>
        <span class="s1">console.warn(</span><span class="s0">&quot;&quot;</span><span class="s1">.concat(configLoaderResult.message, </span><span class="s0">&quot;. tsconfig-paths will be skipped&quot;</span><span class="s1">));</span>
        <span class="s2">return </span><span class="s1">noOp;</span>
    <span class="s1">}</span>
    <span class="s2">var </span><span class="s1">matchPath = (</span><span class="s3">0</span><span class="s1">, match_path_sync_1.createMatchPath)(configLoaderResult.absoluteBaseUrl, configLoaderResult.paths, configLoaderResult.mainFields, configLoaderResult.addMatchAll);</span>
    <span class="s4">// Patch node's module loading</span>
    <span class="s4">// tslint:disable-next-line:no-require-imports variable-name</span>
    <span class="s2">var </span><span class="s1">Module = require(</span><span class="s0">&quot;module&quot;</span><span class="s1">);</span>
    <span class="s2">var </span><span class="s1">originalResolveFilename = Module._resolveFilename;</span>
    <span class="s2">var </span><span class="s1">coreModules = getCoreModules(Module.builtinModules);</span>
    <span class="s4">// tslint:disable-next-line:no-any</span>
    <span class="s1">Module._resolveFilename = </span><span class="s2">function </span><span class="s1">(request, _parent) {</span>
        <span class="s2">var </span><span class="s1">isCoreModule = coreModules.hasOwnProperty(request);</span>
        <span class="s2">if </span><span class="s1">(!isCoreModule) {</span>
            <span class="s2">var </span><span class="s1">found = matchPath(request);</span>
            <span class="s2">if </span><span class="s1">(found) {</span>
                <span class="s2">var </span><span class="s1">modifiedArguments = __spreadArray([found], [].slice.call(arguments, </span><span class="s3">1</span><span class="s1">), </span><span class="s2">true</span><span class="s1">); </span><span class="s4">// Passes all arguments. Even those that is not specified above.</span>
                <span class="s4">// tslint:disable-next-line:no-invalid-this</span>
                <span class="s2">return </span><span class="s1">originalResolveFilename.apply(</span><span class="s2">this</span><span class="s1">, modifiedArguments);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s4">// tslint:disable-next-line:no-invalid-this</span>
        <span class="s2">return </span><span class="s1">originalResolveFilename.apply(</span><span class="s2">this</span><span class="s1">, arguments);</span>
    <span class="s1">};</span>
    <span class="s2">return function </span><span class="s1">() {</span>
        <span class="s4">// Return node's module loading to original state.</span>
        <span class="s1">Module._resolveFilename = originalResolveFilename;</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s1">exports.register = register;</span>
<span class="s4">//# sourceMappingURL=register.js.map</span></pre>
</body>
</html>