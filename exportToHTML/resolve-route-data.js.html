<html>
<head>
<title>resolve-route-data.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #1750eb;}
.s4 { color: #0037a6;}
.s5 { color: #8c8c8c; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
resolve-route-data.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, {</span>
    <span class="s1">value: </span><span class="s2">true</span>
<span class="s1">});</span>
<span class="s3">0 </span><span class="s1">&amp;&amp; (module.exports = {</span>
    <span class="s1">resolveManifest: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">resolveRobots: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">resolveRouteData: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">resolveSitemap: </span><span class="s2">null</span>
<span class="s1">});</span>
<span class="s2">function </span><span class="s1">_export(target, all) {</span>
    <span class="s2">for</span><span class="s1">(</span><span class="s2">var </span><span class="s1">name </span><span class="s2">in </span><span class="s1">all)Object.defineProperty(target, name, {</span>
        <span class="s1">enumerable: </span><span class="s2">true</span><span class="s1">,</span>
        <span class="s1">get: all[name]</span>
    <span class="s1">});</span>
<span class="s1">}</span>
<span class="s1">_export(exports, {</span>
    <span class="s1">resolveManifest: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveManifest;</span>
    <span class="s1">},</span>
    <span class="s1">resolveRobots: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveRobots;</span>
    <span class="s1">},</span>
    <span class="s1">resolveRouteData: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveRouteData;</span>
    <span class="s1">},</span>
    <span class="s1">resolveSitemap: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveSitemap;</span>
    <span class="s1">}</span>
<span class="s1">});</span>
<span class="s2">const </span><span class="s1">_utils = require(</span><span class="s0">&quot;../../../../lib/metadata/generate/utils&quot;</span><span class="s1">);</span>
<span class="s2">function </span><span class="s1">resolveRobots(data) {</span>
    <span class="s2">let </span><span class="s1">content = </span><span class="s0">''</span><span class="s1">;</span>
    <span class="s2">const </span><span class="s1">rules = Array.isArray(data.rules) ? data.rules : [</span>
        <span class="s1">data.rules</span>
    <span class="s1">];</span>
    <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">rule of rules){</span>
        <span class="s2">const </span><span class="s1">userAgent = (</span><span class="s3">0</span><span class="s1">, _utils.resolveArray)(rule.userAgent || [</span>
            <span class="s0">'*'</span>
        <span class="s1">]);</span>
        <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">agent of userAgent){</span>
            <span class="s1">content += </span><span class="s0">`User-Agent: </span><span class="s1">${agent}</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s2">if </span><span class="s1">(rule.allow) {</span>
            <span class="s2">const </span><span class="s1">allow = (</span><span class="s3">0</span><span class="s1">, _utils.resolveArray)(rule.allow);</span>
            <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">item of allow){</span>
                <span class="s1">content += </span><span class="s0">`Allow: </span><span class="s1">${item}</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s2">if </span><span class="s1">(rule.disallow) {</span>
            <span class="s2">const </span><span class="s1">disallow = (</span><span class="s3">0</span><span class="s1">, _utils.resolveArray)(rule.disallow);</span>
            <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">item of disallow){</span>
                <span class="s1">content += </span><span class="s0">`Disallow: </span><span class="s1">${item}</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s2">if </span><span class="s1">(rule.crawlDelay) {</span>
            <span class="s1">content += </span><span class="s0">`Crawl-delay: </span><span class="s1">${rule.crawlDelay}</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s1">content += </span><span class="s0">'</span><span class="s4">\n</span><span class="s0">'</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">if </span><span class="s1">(data.host) {</span>
        <span class="s1">content += </span><span class="s0">`Host: </span><span class="s1">${data.host}</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">if </span><span class="s1">(data.sitemap) {</span>
        <span class="s2">const </span><span class="s1">sitemap = (</span><span class="s3">0</span><span class="s1">, _utils.resolveArray)(data.sitemap);</span>
        <span class="s5">// TODO-METADATA: support injecting sitemap url into robots.txt</span>
        <span class="s1">sitemap.forEach((item)=&gt;{</span>
            <span class="s1">content += </span><span class="s0">`Sitemap: </span><span class="s1">${item}</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">content;</span>
<span class="s1">}</span>
<span class="s2">function </span><span class="s1">resolveSitemap(data) {</span>
    <span class="s2">const </span><span class="s1">hasAlternates = data.some((item)=&gt;Object.keys(item.alternates ?? {}).length &gt; </span><span class="s3">0</span><span class="s1">);</span>
    <span class="s2">const </span><span class="s1">hasImages = data.some((item)=&gt;{</span>
        <span class="s2">var </span><span class="s1">_item_images;</span>
        <span class="s2">return </span><span class="s1">Boolean((_item_images = item.images) == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: _item_images.length);</span>
    <span class="s1">});</span>
    <span class="s2">const </span><span class="s1">hasVideos = data.some((item)=&gt;{</span>
        <span class="s2">var </span><span class="s1">_item_videos;</span>
        <span class="s2">return </span><span class="s1">Boolean((_item_videos = item.videos) == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: _item_videos.length);</span>
    <span class="s1">});</span>
    <span class="s2">let </span><span class="s1">content = </span><span class="s0">''</span><span class="s1">;</span>
    <span class="s1">content += </span><span class="s0">'&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="s4">\n</span><span class="s0">'</span><span class="s1">;</span>
    <span class="s1">content += </span><span class="s0">'&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;'</span><span class="s1">;</span>
    <span class="s2">if </span><span class="s1">(hasImages) {</span>
        <span class="s1">content += </span><span class="s0">' xmlns:image=&quot;http://www.google.com/schemas/sitemap-image/1.1&quot;'</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">if </span><span class="s1">(hasVideos) {</span>
        <span class="s1">content += </span><span class="s0">' xmlns:video=&quot;http://www.google.com/schemas/sitemap-video/1.1&quot;'</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">if </span><span class="s1">(hasAlternates) {</span>
        <span class="s1">content += </span><span class="s0">' xmlns:xhtml=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><span class="s4">\n</span><span class="s0">'</span><span class="s1">;</span>
    <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
        <span class="s1">content += </span><span class="s0">'&gt;</span><span class="s4">\n</span><span class="s0">'</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">item of data){</span>
        <span class="s2">var </span><span class="s1">_item_alternates, _item_images, _item_videos;</span>
        <span class="s1">content += </span><span class="s0">'&lt;url&gt;</span><span class="s4">\n</span><span class="s0">'</span><span class="s1">;</span>
        <span class="s1">content += </span><span class="s0">`&lt;loc&gt;</span><span class="s1">${item.url}</span><span class="s0">&lt;/loc&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
        <span class="s2">const </span><span class="s1">languages = (_item_alternates = item.alternates) == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: _item_alternates.languages;</span>
        <span class="s2">if </span><span class="s1">(languages &amp;&amp; Object.keys(languages).length) {</span>
            <span class="s5">// Since sitemap is separated from the page rendering, there's not metadataBase accessible yet.</span>
            <span class="s5">// we give the default setting that won't effect the languages resolving.</span>
            <span class="s2">for</span><span class="s1">(</span><span class="s2">const </span><span class="s1">language </span><span class="s2">in </span><span class="s1">languages){</span>
                <span class="s1">content += </span><span class="s0">`&lt;xhtml:link rel=&quot;alternate&quot; hreflang=&quot;</span><span class="s1">${language}</span><span class="s0">&quot; href=&quot;</span><span class="s1">${languages[language]}</span><span class="s0">&quot; /&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s2">if </span><span class="s1">((_item_images = item.images) == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: _item_images.length) {</span>
            <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">image of item.images){</span>
                <span class="s1">content += </span><span class="s0">`&lt;image:image&gt;</span><span class="s4">\n</span><span class="s0">&lt;image:loc&gt;</span><span class="s1">${image}</span><span class="s0">&lt;/image:loc&gt;</span><span class="s4">\n</span><span class="s0">&lt;/image:image&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s2">if </span><span class="s1">((_item_videos = item.videos) == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: _item_videos.length) {</span>
            <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">video of item.videos){</span>
                <span class="s2">let </span><span class="s1">videoFields = [</span>
                    <span class="s0">`&lt;video:video&gt;`</span><span class="s1">,</span>
                    <span class="s0">`&lt;video:title&gt;</span><span class="s1">${video.title}</span><span class="s0">&lt;/video:title&gt;`</span><span class="s1">,</span>
                    <span class="s0">`&lt;video:thumbnail_loc&gt;</span><span class="s1">${video.thumbnail_loc}</span><span class="s0">&lt;/video:thumbnail_loc&gt;`</span><span class="s1">,</span>
                    <span class="s0">`&lt;video:description&gt;</span><span class="s1">${video.description}</span><span class="s0">&lt;/video:description&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.content_loc &amp;&amp; </span><span class="s0">`&lt;video:content_loc&gt;</span><span class="s1">${video.content_loc}</span><span class="s0">&lt;/video:content_loc&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.player_loc &amp;&amp; </span><span class="s0">`&lt;video:player_loc&gt;</span><span class="s1">${video.player_loc}</span><span class="s0">&lt;/video:player_loc&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.duration &amp;&amp; </span><span class="s0">`&lt;video:duration&gt;</span><span class="s1">${video.duration}</span><span class="s0">&lt;/video:duration&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.view_count &amp;&amp; </span><span class="s0">`&lt;video:view_count&gt;</span><span class="s1">${video.view_count}</span><span class="s0">&lt;/video:view_count&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.tag &amp;&amp; </span><span class="s0">`&lt;video:tag&gt;</span><span class="s1">${video.tag}</span><span class="s0">&lt;/video:tag&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.rating &amp;&amp; </span><span class="s0">`&lt;video:rating&gt;</span><span class="s1">${video.rating}</span><span class="s0">&lt;/video:rating&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.expiration_date &amp;&amp; </span><span class="s0">`&lt;video:expiration_date&gt;</span><span class="s1">${video.expiration_date}</span><span class="s0">&lt;/video:expiration_date&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.publication_date &amp;&amp; </span><span class="s0">`&lt;video:publication_date&gt;</span><span class="s1">${video.publication_date}</span><span class="s0">&lt;/video:publication_date&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.family_friendly &amp;&amp; </span><span class="s0">`&lt;video:family_friendly&gt;</span><span class="s1">${video.family_friendly}</span><span class="s0">&lt;/video:family_friendly&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.requires_subscription &amp;&amp; </span><span class="s0">`&lt;video:requires_subscription&gt;</span><span class="s1">${video.requires_subscription}</span><span class="s0">&lt;/video:requires_subscription&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.live &amp;&amp; </span><span class="s0">`&lt;video:live&gt;</span><span class="s1">${video.live}</span><span class="s0">&lt;/video:live&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.restriction &amp;&amp; </span><span class="s0">`&lt;video:restriction relationship=&quot;</span><span class="s1">${video.restriction.relationship}</span><span class="s0">&quot;&gt;</span><span class="s1">${video.restriction.content}</span><span class="s0">&lt;/video:restriction&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.platform &amp;&amp; </span><span class="s0">`&lt;video:platform relationship=&quot;</span><span class="s1">${video.platform.relationship}</span><span class="s0">&quot;&gt;</span><span class="s1">${video.platform.content}</span><span class="s0">&lt;/video:platform&gt;`</span><span class="s1">,</span>
                    <span class="s1">video.uploader &amp;&amp; </span><span class="s0">`&lt;video:uploader</span><span class="s1">${video.uploader.info &amp;&amp; </span><span class="s0">` info=&quot;</span><span class="s1">${video.uploader.info}</span><span class="s0">&quot;`</span><span class="s1">}</span><span class="s0">&gt;</span><span class="s1">${video.uploader.content}</span><span class="s0">&lt;/video:uploader&gt;`</span><span class="s1">,</span>
                    <span class="s0">`&lt;/video:video&gt;</span><span class="s4">\n</span><span class="s0">`</span>
                <span class="s1">].filter(Boolean);</span>
                <span class="s1">content += videoFields.join(</span><span class="s0">'</span><span class="s4">\n</span><span class="s0">'</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s2">if </span><span class="s1">(item.lastModified) {</span>
            <span class="s2">const </span><span class="s1">serializedDate = item.lastModified </span><span class="s2">instanceof </span><span class="s1">Date ? item.lastModified.toISOString() : item.lastModified;</span>
            <span class="s1">content += </span><span class="s0">`&lt;lastmod&gt;</span><span class="s1">${serializedDate}</span><span class="s0">&lt;/lastmod&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s2">if </span><span class="s1">(item.changeFrequency) {</span>
            <span class="s1">content += </span><span class="s0">`&lt;changefreq&gt;</span><span class="s1">${item.changeFrequency}</span><span class="s0">&lt;/changefreq&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">item.priority === </span><span class="s0">'number'</span><span class="s1">) {</span>
            <span class="s1">content += </span><span class="s0">`&lt;priority&gt;</span><span class="s1">${item.priority}</span><span class="s0">&lt;/priority&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s1">content += </span><span class="s0">'&lt;/url&gt;</span><span class="s4">\n</span><span class="s0">'</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s1">content += </span><span class="s0">'&lt;/urlset&gt;</span><span class="s4">\n</span><span class="s0">'</span><span class="s1">;</span>
    <span class="s2">return </span><span class="s1">content;</span>
<span class="s1">}</span>
<span class="s2">function </span><span class="s1">resolveManifest(data) {</span>
    <span class="s2">return </span><span class="s1">JSON.stringify(data);</span>
<span class="s1">}</span>
<span class="s2">function </span><span class="s1">resolveRouteData(data, fileType) {</span>
    <span class="s2">if </span><span class="s1">(fileType === </span><span class="s0">'robots'</span><span class="s1">) {</span>
        <span class="s2">return </span><span class="s1">resolveRobots(data);</span>
    <span class="s1">}</span>
    <span class="s2">if </span><span class="s1">(fileType === </span><span class="s0">'sitemap'</span><span class="s1">) {</span>
        <span class="s2">return </span><span class="s1">resolveSitemap(data);</span>
    <span class="s1">}</span>
    <span class="s2">if </span><span class="s1">(fileType === </span><span class="s0">'manifest'</span><span class="s1">) {</span>
        <span class="s2">return </span><span class="s1">resolveManifest(data);</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s0">''</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s5">//# sourceMappingURL=resolve-route-data.js.map</span></pre>
</body>
</html>