<html>
<head>
<title>node.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #8c8c8c; font-style: italic;}
.s3 { color: #0033b3;}
.s4 { color: #1750eb;}
.s5 { color: #264eff;}
.s6 { color: #8c8c8c; font-style: italic;}
.s7 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
node.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>

<span class="s2">/**</span>
 <span class="s2">* Module dependencies.</span>
 <span class="s2">*/</span>
<span class="s3">var </span><span class="s1">tty = require(</span><span class="s0">'tty'</span><span class="s1">);</span>

<span class="s3">var </span><span class="s1">util = require(</span><span class="s0">'util'</span><span class="s1">);</span>
<span class="s2">/**</span>
 <span class="s2">* This is the Node.js implementation of `debug()`.</span>
 <span class="s2">*/</span>


<span class="s1">exports.init = init;</span>
<span class="s1">exports.log = log;</span>
<span class="s1">exports.formatArgs = formatArgs;</span>
<span class="s1">exports.save = save;</span>
<span class="s1">exports.load = load;</span>
<span class="s1">exports.useColors = useColors;</span>
<span class="s2">/**</span>
 <span class="s2">* Colors.</span>
 <span class="s2">*/</span>

<span class="s1">exports.colors = [</span><span class="s4">6</span><span class="s1">, </span><span class="s4">2</span><span class="s1">, </span><span class="s4">3</span><span class="s1">, </span><span class="s4">4</span><span class="s1">, </span><span class="s4">5</span><span class="s1">, </span><span class="s4">1</span><span class="s1">];</span>

<span class="s3">try </span><span class="s1">{</span>
  <span class="s2">// Optional dependency (as in, doesn't need to be installed, NOT like optionalDependencies in package.json)</span>
  <span class="s2">// eslint-disable-next-line import/no-extraneous-dependencies</span>
  <span class="s3">var </span><span class="s1">supportsColor = require(</span><span class="s0">'supports-color'</span><span class="s1">);</span>

  <span class="s3">if </span><span class="s1">(supportsColor &amp;&amp; (supportsColor.stderr || supportsColor).level &gt;= </span><span class="s4">2</span><span class="s1">) {</span>
    <span class="s1">exports.colors = [</span><span class="s4">20</span><span class="s1">, </span><span class="s4">21</span><span class="s1">, </span><span class="s4">26</span><span class="s1">, </span><span class="s4">27</span><span class="s1">, </span><span class="s4">32</span><span class="s1">, </span><span class="s4">33</span><span class="s1">, </span><span class="s4">38</span><span class="s1">, </span><span class="s4">39</span><span class="s1">, </span><span class="s4">40</span><span class="s1">, </span><span class="s4">41</span><span class="s1">, </span><span class="s4">42</span><span class="s1">, </span><span class="s4">43</span><span class="s1">, </span><span class="s4">44</span><span class="s1">, </span><span class="s4">45</span><span class="s1">, </span><span class="s4">56</span><span class="s1">, </span><span class="s4">57</span><span class="s1">, </span><span class="s4">62</span><span class="s1">, </span><span class="s4">63</span><span class="s1">, </span><span class="s4">68</span><span class="s1">, </span><span class="s4">69</span><span class="s1">, </span><span class="s4">74</span><span class="s1">, </span><span class="s4">75</span><span class="s1">, </span><span class="s4">76</span><span class="s1">, </span><span class="s4">77</span><span class="s1">, </span><span class="s4">78</span><span class="s1">, </span><span class="s4">79</span><span class="s1">, </span><span class="s4">80</span><span class="s1">, </span><span class="s4">81</span><span class="s1">, </span><span class="s4">92</span><span class="s1">, </span><span class="s4">93</span><span class="s1">, </span><span class="s4">98</span><span class="s1">, </span><span class="s4">99</span><span class="s1">, </span><span class="s4">112</span><span class="s1">, </span><span class="s4">113</span><span class="s1">, </span><span class="s4">128</span><span class="s1">, </span><span class="s4">129</span><span class="s1">, </span><span class="s4">134</span><span class="s1">, </span><span class="s4">135</span><span class="s1">, </span><span class="s4">148</span><span class="s1">, </span><span class="s4">149</span><span class="s1">, </span><span class="s4">160</span><span class="s1">, </span><span class="s4">161</span><span class="s1">, </span><span class="s4">162</span><span class="s1">, </span><span class="s4">163</span><span class="s1">, </span><span class="s4">164</span><span class="s1">, </span><span class="s4">165</span><span class="s1">, </span><span class="s4">166</span><span class="s1">, </span><span class="s4">167</span><span class="s1">, </span><span class="s4">168</span><span class="s1">, </span><span class="s4">169</span><span class="s1">, </span><span class="s4">170</span><span class="s1">, </span><span class="s4">171</span><span class="s1">, </span><span class="s4">172</span><span class="s1">, </span><span class="s4">173</span><span class="s1">, </span><span class="s4">178</span><span class="s1">, </span><span class="s4">179</span><span class="s1">, </span><span class="s4">184</span><span class="s1">, </span><span class="s4">185</span><span class="s1">, </span><span class="s4">196</span><span class="s1">, </span><span class="s4">197</span><span class="s1">, </span><span class="s4">198</span><span class="s1">, </span><span class="s4">199</span><span class="s1">, </span><span class="s4">200</span><span class="s1">, </span><span class="s4">201</span><span class="s1">, </span><span class="s4">202</span><span class="s1">, </span><span class="s4">203</span><span class="s1">, </span><span class="s4">204</span><span class="s1">, </span><span class="s4">205</span><span class="s1">, </span><span class="s4">206</span><span class="s1">, </span><span class="s4">207</span><span class="s1">, </span><span class="s4">208</span><span class="s1">, </span><span class="s4">209</span><span class="s1">, </span><span class="s4">214</span><span class="s1">, </span><span class="s4">215</span><span class="s1">, </span><span class="s4">220</span><span class="s1">, </span><span class="s4">221</span><span class="s1">];</span>
  <span class="s1">}</span>
<span class="s1">} </span><span class="s3">catch </span><span class="s1">(error) {} </span><span class="s2">// Swallow - we only care if `supports-color` is available; it doesn't have to be.</span>

<span class="s2">/**</span>
 <span class="s2">* Build up the default `inspectOpts` object from the environment variables.</span>
 <span class="s2">*</span>
 <span class="s2">*   $ DEBUG_COLORS=no DEBUG_DEPTH=10 DEBUG_SHOW_HIDDEN=enabled node script.js</span>
 <span class="s2">*/</span>


<span class="s1">exports.inspectOpts = Object.keys(process.env).filter(</span><span class="s3">function </span><span class="s1">(key) {</span>
  <span class="s3">return </span><span class="s5">/^debug_/i</span><span class="s1">.test(key);</span>
<span class="s1">}).reduce(</span><span class="s3">function </span><span class="s1">(obj, key) {</span>
  <span class="s2">// Camel-case</span>
  <span class="s3">var </span><span class="s1">prop = key.substring(</span><span class="s4">6</span><span class="s1">).toLowerCase().replace(</span><span class="s5">/_([a-z])/g</span><span class="s1">, </span><span class="s3">function </span><span class="s1">(_, k) {</span>
    <span class="s3">return </span><span class="s1">k.toUpperCase();</span>
  <span class="s1">}); </span><span class="s2">// Coerce string value into JS value</span>

  <span class="s3">var </span><span class="s1">val = process.env[key];</span>

  <span class="s3">if </span><span class="s1">(</span><span class="s5">/^(yes|on|true|enabled)$/i</span><span class="s1">.test(val)) {</span>
    <span class="s1">val = </span><span class="s3">true</span><span class="s1">;</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s5">/^(no|off|false|disabled)$/i</span><span class="s1">.test(val)) {</span>
    <span class="s1">val = </span><span class="s3">false</span><span class="s1">;</span>
  <span class="s1">} </span><span class="s3">else if </span><span class="s1">(val === </span><span class="s0">'null'</span><span class="s1">) {</span>
    <span class="s1">val = </span><span class="s3">null</span><span class="s1">;</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s1">val = Number(val);</span>
  <span class="s1">}</span>

  <span class="s1">obj[prop] = val;</span>
  <span class="s3">return </span><span class="s1">obj;</span>
<span class="s1">}, {});</span>
<span class="s2">/**</span>
 <span class="s2">* Is stdout a TTY? Colored output is enabled when `true`.</span>
 <span class="s2">*/</span>

<span class="s3">function </span><span class="s1">useColors() {</span>
  <span class="s3">return </span><span class="s0">'colors' </span><span class="s3">in </span><span class="s1">exports.inspectOpts ? Boolean(exports.inspectOpts.colors) : tty.isatty(process.stderr.fd);</span>
<span class="s1">}</span>
<span class="s2">/**</span>
 <span class="s2">* Adds ANSI color escape codes if enabled.</span>
 <span class="s2">*</span>
 <span class="s2">* </span><span class="s6">@api </span><span class="s2">public</span>
 <span class="s2">*/</span>


<span class="s3">function </span><span class="s1">formatArgs(args) {</span>
  <span class="s3">var </span><span class="s1">name = </span><span class="s3">this</span><span class="s1">.namespace,</span>
      <span class="s1">useColors = </span><span class="s3">this</span><span class="s1">.useColors;</span>

  <span class="s3">if </span><span class="s1">(useColors) {</span>
    <span class="s3">var </span><span class="s1">c = </span><span class="s3">this</span><span class="s1">.color;</span>
    <span class="s3">var </span><span class="s1">colorCode = </span><span class="s0">&quot;</span><span class="s7">\x1B</span><span class="s0">[3&quot; </span><span class="s1">+ (c &lt; </span><span class="s4">8 </span><span class="s1">? c : </span><span class="s0">'8;5;' </span><span class="s1">+ c);</span>
    <span class="s3">var </span><span class="s1">prefix = </span><span class="s0">&quot;  &quot;</span><span class="s1">.concat(colorCode, </span><span class="s0">&quot;;1m&quot;</span><span class="s1">).concat(name, </span><span class="s0">&quot; </span><span class="s7">\x1B</span><span class="s0">[0m&quot;</span><span class="s1">);</span>
    <span class="s1">args[</span><span class="s4">0</span><span class="s1">] = prefix + args[</span><span class="s4">0</span><span class="s1">].split(</span><span class="s0">'</span><span class="s7">\n</span><span class="s0">'</span><span class="s1">).join(</span><span class="s0">'</span><span class="s7">\n</span><span class="s0">' </span><span class="s1">+ prefix);</span>
    <span class="s1">args.push(colorCode + </span><span class="s0">'m+' </span><span class="s1">+ module.exports.humanize(</span><span class="s3">this</span><span class="s1">.diff) + </span><span class="s0">&quot;</span><span class="s7">\x1B</span><span class="s0">[0m&quot;</span><span class="s1">);</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s1">args[</span><span class="s4">0</span><span class="s1">] = getDate() + name + </span><span class="s0">' ' </span><span class="s1">+ args[</span><span class="s4">0</span><span class="s1">];</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s1">getDate() {</span>
  <span class="s3">if </span><span class="s1">(exports.inspectOpts.hideDate) {</span>
    <span class="s3">return </span><span class="s0">''</span><span class="s1">;</span>
  <span class="s1">}</span>

  <span class="s3">return new </span><span class="s1">Date().toISOString() + </span><span class="s0">' '</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s2">/**</span>
 <span class="s2">* Invokes `util.format()` with the specified arguments and writes to stderr.</span>
 <span class="s2">*/</span>


<span class="s3">function </span><span class="s1">log() {</span>
  <span class="s3">return </span><span class="s1">process.stderr.write(util.format.apply(util, arguments) + </span><span class="s0">'</span><span class="s7">\n</span><span class="s0">'</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s2">/**</span>
 <span class="s2">* Save `namespaces`.</span>
 <span class="s2">*</span>
 <span class="s2">* </span><span class="s6">@param </span><span class="s2">{String} namespaces</span>
 <span class="s2">* </span><span class="s6">@api </span><span class="s2">private</span>
 <span class="s2">*/</span>


<span class="s3">function </span><span class="s1">save(namespaces) {</span>
  <span class="s3">if </span><span class="s1">(namespaces) {</span>
    <span class="s1">process.env.DEBUG = namespaces;</span>
  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
    <span class="s2">// If you set a process.env field to null or undefined, it gets cast to the</span>
    <span class="s2">// string 'null' or 'undefined'. Just delete instead.</span>
    <span class="s3">delete </span><span class="s1">process.env.DEBUG;</span>
  <span class="s1">}</span>
<span class="s1">}</span>
<span class="s2">/**</span>
 <span class="s2">* Load `namespaces`.</span>
 <span class="s2">*</span>
 <span class="s2">* </span><span class="s6">@return </span><span class="s2">{String} returns the previously persisted debug modes</span>
 <span class="s2">* </span><span class="s6">@api </span><span class="s2">private</span>
 <span class="s2">*/</span>


<span class="s3">function </span><span class="s1">load() {</span>
  <span class="s3">return </span><span class="s1">process.env.DEBUG;</span>
<span class="s1">}</span>
<span class="s2">/**</span>
 <span class="s2">* Init logic for `debug` instances.</span>
 <span class="s2">*</span>
 <span class="s2">* Create a new `inspectOpts` object in case `useColors` is set</span>
 <span class="s2">* differently for a particular `debug` instance.</span>
 <span class="s2">*/</span>


<span class="s3">function </span><span class="s1">init(debug) {</span>
  <span class="s1">debug.inspectOpts = {};</span>
  <span class="s3">var </span><span class="s1">keys = Object.keys(exports.inspectOpts);</span>

  <span class="s3">for </span><span class="s1">(</span><span class="s3">var </span><span class="s1">i = </span><span class="s4">0</span><span class="s1">; i &lt; keys.length; i++) {</span>
    <span class="s1">debug.inspectOpts[keys[i]] = exports.inspectOpts[keys[i]];</span>
  <span class="s1">}</span>
<span class="s1">}</span>

<span class="s1">module.exports = require(</span><span class="s0">'./common'</span><span class="s1">)(exports);</span>
<span class="s3">var </span><span class="s1">formatters = module.exports.formatters;</span>
<span class="s2">/**</span>
 <span class="s2">* Map %o to `util.inspect()`, all on a single line.</span>
 <span class="s2">*/</span>

<span class="s1">formatters.o = </span><span class="s3">function </span><span class="s1">(v) {</span>
  <span class="s3">this</span><span class="s1">.inspectOpts.colors = </span><span class="s3">this</span><span class="s1">.useColors;</span>
  <span class="s3">return </span><span class="s1">util.inspect(v, </span><span class="s3">this</span><span class="s1">.inspectOpts)</span>
    <span class="s1">.split(</span><span class="s0">'</span><span class="s7">\n</span><span class="s0">'</span><span class="s1">)</span>
    <span class="s1">.map(</span><span class="s3">function </span><span class="s1">(str) { </span><span class="s3">return </span><span class="s1">str.trim(); })</span>
    <span class="s1">.join(</span><span class="s0">' '</span><span class="s1">);</span>
<span class="s1">};</span>
<span class="s2">/**</span>
 <span class="s2">* Map %O to `util.inspect()`, allowing multiple lines if needed.</span>
 <span class="s2">*/</span>


<span class="s1">formatters.O = </span><span class="s3">function </span><span class="s1">(v) {</span>
  <span class="s3">this</span><span class="s1">.inspectOpts.colors = </span><span class="s3">this</span><span class="s1">.useColors;</span>
  <span class="s3">return </span><span class="s1">util.inspect(v, </span><span class="s3">this</span><span class="s1">.inspectOpts);</span>
<span class="s1">};</span>

</pre>
</body>
</html>