<html>
<head>
<title>node_modules_next_dist_e26b5ed5._.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
.s4 { color: #0033b3;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
node_modules_next_dist_e26b5ed5._.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span>
  <span class="s1">&quot;version&quot;</span><span class="s0">: </span><span class="s2">3</span><span class="s0">,</span>
  <span class="s1">&quot;sources&quot;</span><span class="s0">: [],</span>
  <span class="s1">&quot;sections&quot;</span><span class="s0">: [</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">15</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/src/client/components/builtin/unauthorized.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { HTTPAccessErrorFallback } from '../http-access-fallback/error-fallback'</span><span class="s3">\n\n</span><span class="s1">export default function Unauthorized() {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">&lt;HTTPAccessErrorFallback</span><span class="s3">\n      </span><span class="s1">status={401}</span><span class="s3">\n      </span><span class="s1">message=</span><span class="s3">\&quot;</span><span class="s1">You're not authorized to access this page.</span><span class="s3">\&quot;\n    </span><span class="s1">/&gt;</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;Unauthorized&quot;</span><span class="s0">,</span><span class="s1">&quot;HTTPAccessErrorFallback&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;+BAEA,WAAA;;;eAAwBA;;;;+BAFgB;AAEzB,SAASA;IACtB,OAAA,WAAA,GACE,CAAA,GAAA,YAAA,GAAA,EAACC,eAAAA,uBAAuB,EAAA;QACtBC,QAAQ;QACRC,SAAQ;;AAGd&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">46</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/route-modules/app-page/module.compiled.js&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n  </span><span class="s1">module.exports = require('next/dist/server/route-modules/app-page/module.js')</span><span class="s3">\n</span><span class="s1">} else {</span><span class="s3">\n  </span><span class="s1">if (process.env.__NEXT_EXPERIMENTAL_REACT) {</span><span class="s3">\n    </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;module&quot;</span><span class="s0">,</span><span class="s1">&quot;exports&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_EXPERIMENTAL_REACT&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;TURBOPACK&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">68</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/instrumentation/utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export function getRevalidateReason(params: {</span><span class="s3">\n  </span><span class="s1">isOnDemandRevalidate?: boolean</span><span class="s3">\n  </span><span class="s1">isRevalidate?: boolean</span><span class="s3">\n</span><span class="s1">}): 'on-demand' | 'stale' | undefined {</span><span class="s3">\n  </span><span class="s1">if (params.isOnDemandRevalidate) {</span><span class="s3">\n    </span><span class="s1">return 'on-demand'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (params.isRevalidate) {</span><span class="s3">\n    </span><span class="s1">return 'stale'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getRevalidateReason&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;isOnDemandRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;isRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,SAASA,oBAAoBC,MAGnC;IACC,IAAIA,OAAOC,oBAAoB,EAAE;QAC/B,OAAO;IACT;IACA,IAAID,OAAOE,YAAY,EAAE;QACvB,OAAO;IACT;IACA,OAAOC;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">85</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/app-render/interop-default.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Interop between </span><span class="s3">\&quot;</span><span class="s1">export default</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">module.exports</span><span class="s3">\&quot;</span><span class="s1">.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function interopDefault(mod: any) {</span><span class="s3">\n  </span><span class="s1">return mod.default || mod</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;interopDefault&quot;</span><span class="s0">,</span><span class="s1">&quot;mod&quot;</span><span class="s0">,</span><span class="s1">&quot;default&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;CAEC,GACD;;;;AAAO,SAASA,eAAeC,GAAQ;IACrC,OAAOA,IAAIC,OAAO,IAAID;AACxB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">98</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/app-render/strip-flight-headers.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { IncomingHttpHeaders } from 'node:http'</span><span class="s3">\n\n</span><span class="s1">import { FLIGHT_HEADERS } from '../../client/components/app-router-headers'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Removes the flight headers from the request.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param req the request to strip the headers from</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function stripFlightHeaders(headers: IncomingHttpHeaders) {</span><span class="s3">\n  </span><span class="s1">for (const header of FLIGHT_HEADERS) {</span><span class="s3">\n    </span><span class="s1">delete headers[header]</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;FLIGHT_HEADERS&quot;</span><span class="s0">,</span><span class="s1">&quot;stripFlightHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;header&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAEA,SAASA,cAAc,QAAQ,6CAA4C;;AAOpE,SAASC,mBAAmBC,OAA4B;IAC7D,KAAK,MAAMC,UAAUH,yMAAAA,CAAgB;QACnC,OAAOE,OAAO,CAACC,OAAO;IACxB;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">113</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/web/spec-extension/adapters/headers.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { IncomingHttpHeaders } from 'http'</span><span class="s3">\n\n</span><span class="s1">import { ReflectAdapter } from './reflect'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class ReadonlyHeadersError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor() {</span><span class="s3">\n    </span><span class="s1">super(</span><span class="s3">\n      </span><span class="s1">'Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public static callable() {</span><span class="s3">\n    </span><span class="s1">throw new ReadonlyHeadersError()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type ReadonlyHeaders = Headers &amp; {</span><span class="s3">\n  </span><span class="s1">/** @deprecated Method unavailable on `ReadonlyHeaders`. Read more: https://nextjs.org/docs/app/api-reference/functions/headers */</span><span class="s3">\n  </span><span class="s1">append(...args: any[]): void</span><span class="s3">\n  </span><span class="s1">/** @deprecated Method unavailable on `ReadonlyHeaders`. Read more: https://nextjs.org/docs/app/api-reference/functions/headers */</span><span class="s3">\n  </span><span class="s1">set(...args: any[]): void</span><span class="s3">\n  </span><span class="s1">/** @deprecated Method unavailable on `ReadonlyHeaders`. Read more: https://nextjs.org/docs/app/api-reference/functions/headers */</span><span class="s3">\n  </span><span class="s1">delete(...args: any[]): void</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">export class HeadersAdapter extends Headers {</span><span class="s3">\n  </span><span class="s1">private readonly headers: IncomingHttpHeaders</span><span class="s3">\n\n  </span><span class="s1">constructor(headers: IncomingHttpHeaders) {</span><span class="s3">\n    </span><span class="s1">// We've already overridden the methods that would be called, so we're just</span><span class="s3">\n    </span><span class="s1">// calling the super constructor to ensure that the instanceof check works.</span><span class="s3">\n    </span><span class="s1">super()</span><span class="s3">\n\n    </span><span class="s1">this.headers = new Proxy(headers, {</span><span class="s3">\n      </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n        </span><span class="s1">// Because this is just an object, we expect that all </span><span class="s3">\&quot;</span><span class="s1">get</span><span class="s3">\&quot; </span><span class="s1">operations</span><span class="s3">\n        </span><span class="s1">// are for properties. If it's a </span><span class="s3">\&quot;</span><span class="s1">get</span><span class="s3">\&quot; </span><span class="s1">for a symbol, we'll just return</span><span class="s3">\n        </span><span class="s1">// the symbol.</span><span class="s3">\n        </span><span class="s1">if (typeof prop === 'symbol') {</span><span class="s3">\n          </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const lowercased = prop.toLowerCase()</span><span class="s3">\n\n        </span><span class="s1">// Let's find the original casing of the key. This assumes that there is</span><span class="s3">\n        </span><span class="s1">// no mixed case keys (e.g. </span><span class="s3">\&quot;</span><span class="s1">Content-Type</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">content-type</span><span class="s3">\&quot;</span><span class="s1">) in the</span><span class="s3">\n        </span><span class="s1">// headers object.</span><span class="s3">\n        </span><span class="s1">const original = Object.keys(headers).find(</span><span class="s3">\n          </span><span class="s1">(o) =&gt; o.toLowerCase() === lowercased</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">// If the original casing doesn't exist, return undefined.</span><span class="s3">\n        </span><span class="s1">if (typeof original === 'undefined') return</span><span class="s3">\n\n        </span><span class="s1">// If the original casing exists, return the value.</span><span class="s3">\n        </span><span class="s1">return ReflectAdapter.get(target, original, receiver)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">set(target, prop, value, receiver) {</span><span class="s3">\n        </span><span class="s1">if (typeof prop === 'symbol') {</span><span class="s3">\n          </span><span class="s1">return ReflectAdapter.set(target, prop, value, receiver)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const lowercased = prop.toLowerCase()</span><span class="s3">\n\n        </span><span class="s1">// Let's find the original casing of the key. This assumes that there is</span><span class="s3">\n        </span><span class="s1">// no mixed case keys (e.g. </span><span class="s3">\&quot;</span><span class="s1">Content-Type</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">content-type</span><span class="s3">\&quot;</span><span class="s1">) in the</span><span class="s3">\n        </span><span class="s1">// headers object.</span><span class="s3">\n        </span><span class="s1">const original = Object.keys(headers).find(</span><span class="s3">\n          </span><span class="s1">(o) =&gt; o.toLowerCase() === lowercased</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">// If the original casing doesn't exist, use the prop as the key.</span><span class="s3">\n        </span><span class="s1">return ReflectAdapter.set(target, original ?? prop, value, receiver)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">has(target, prop) {</span><span class="s3">\n        </span><span class="s1">if (typeof prop === 'symbol') return ReflectAdapter.has(target, prop)</span><span class="s3">\n\n        </span><span class="s1">const lowercased = prop.toLowerCase()</span><span class="s3">\n\n        </span><span class="s1">// Let's find the original casing of the key. This assumes that there is</span><span class="s3">\n        </span><span class="s1">// no mixed case keys (e.g. </span><span class="s3">\&quot;</span><span class="s1">Content-Type</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">content-type</span><span class="s3">\&quot;</span><span class="s1">) in the</span><span class="s3">\n        </span><span class="s1">// headers object.</span><span class="s3">\n        </span><span class="s1">const original = Object.keys(headers).find(</span><span class="s3">\n          </span><span class="s1">(o) =&gt; o.toLowerCase() === lowercased</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">// If the original casing doesn't exist, return false.</span><span class="s3">\n        </span><span class="s1">if (typeof original === 'undefined') return false</span><span class="s3">\n\n        </span><span class="s1">// If the original casing exists, return true.</span><span class="s3">\n        </span><span class="s1">return ReflectAdapter.has(target, original)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">deleteProperty(target, prop) {</span><span class="s3">\n        </span><span class="s1">if (typeof prop === 'symbol')</span><span class="s3">\n          </span><span class="s1">return ReflectAdapter.deleteProperty(target, prop)</span><span class="s3">\n\n        </span><span class="s1">const lowercased = prop.toLowerCase()</span><span class="s3">\n\n        </span><span class="s1">// Let's find the original casing of the key. This assumes that there is</span><span class="s3">\n        </span><span class="s1">// no mixed case keys (e.g. </span><span class="s3">\&quot;</span><span class="s1">Content-Type</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">content-type</span><span class="s3">\&quot;</span><span class="s1">) in the</span><span class="s3">\n        </span><span class="s1">// headers object.</span><span class="s3">\n        </span><span class="s1">const original = Object.keys(headers).find(</span><span class="s3">\n          </span><span class="s1">(o) =&gt; o.toLowerCase() === lowercased</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">// If the original casing doesn't exist, return true.</span><span class="s3">\n        </span><span class="s1">if (typeof original === 'undefined') return true</span><span class="s3">\n\n        </span><span class="s1">// If the original casing exists, delete the property.</span><span class="s3">\n        </span><span class="s1">return ReflectAdapter.deleteProperty(target, original)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Seals a Headers instance to prevent modification by throwing an error when</span><span class="s3">\n   </span><span class="s1">* any mutating method is called.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public static seal(headers: Headers): ReadonlyHeaders {</span><span class="s3">\n    </span><span class="s1">return new Proxy&lt;ReadonlyHeaders&gt;(headers, {</span><span class="s3">\n      </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n        </span><span class="s1">switch (prop) {</span><span class="s3">\n          </span><span class="s1">case 'append':</span><span class="s3">\n          </span><span class="s1">case 'delete':</span><span class="s3">\n          </span><span class="s1">case 'set':</span><span class="s3">\n            </span><span class="s1">return ReadonlyHeadersError.callable</span><span class="s3">\n          </span><span class="s1">default:</span><span class="s3">\n            </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Merges a header value into a string. This stores multiple values as an</span><span class="s3">\n   </span><span class="s1">* array, so we need to merge them into a string.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param value a header value</span><span class="s3">\n   </span><span class="s1">* @returns a merged header value (a string)</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">private merge(value: string | string[]): string {</span><span class="s3">\n    </span><span class="s1">if (Array.isArray(value)) return value.join(', ')</span><span class="s3">\n\n    </span><span class="s1">return value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Creates a Headers instance from a plain object or a Headers instance.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @param headers a plain object or a Headers instance</span><span class="s3">\n   </span><span class="s1">* @returns a headers instance</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public static from(headers: IncomingHttpHeaders | Headers): Headers {</span><span class="s3">\n    </span><span class="s1">if (headers instanceof Headers) return headers</span><span class="s3">\n\n    </span><span class="s1">return new HeadersAdapter(headers)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public append(name: string, value: string): void {</span><span class="s3">\n    </span><span class="s1">const existing = this.headers[name]</span><span class="s3">\n    </span><span class="s1">if (typeof existing === 'string') {</span><span class="s3">\n      </span><span class="s1">this.headers[name] = [existing, value]</span><span class="s3">\n    </span><span class="s1">} else if (Array.isArray(existing)) {</span><span class="s3">\n      </span><span class="s1">existing.push(value)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">this.headers[name] = value</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public delete(name: string): void {</span><span class="s3">\n    </span><span class="s1">delete this.headers[name]</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get(name: string): string | null {</span><span class="s3">\n    </span><span class="s1">const value = this.headers[name]</span><span class="s3">\n    </span><span class="s1">if (typeof value !== 'undefined') return this.merge(value)</span><span class="s3">\n\n    </span><span class="s1">return null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public has(name: string): boolean {</span><span class="s3">\n    </span><span class="s1">return typeof this.headers[name] !== 'undefined'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public set(name: string, value: string): void {</span><span class="s3">\n    </span><span class="s1">this.headers[name] = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public forEach(</span><span class="s3">\n    </span><span class="s1">callbackfn: (value: string, name: string, parent: Headers) =&gt; void,</span><span class="s3">\n    </span><span class="s1">thisArg?: any</span><span class="s3">\n  </span><span class="s1">): void {</span><span class="s3">\n    </span><span class="s1">for (const [name, value] of this.entries()) {</span><span class="s3">\n      </span><span class="s1">callbackfn.call(thisArg, value, name, this)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public *entries(): HeadersIterator&lt;[string, string]&gt; {</span><span class="s3">\n    </span><span class="s1">for (const key of Object.keys(this.headers)) {</span><span class="s3">\n      </span><span class="s1">const name = key.toLowerCase()</span><span class="s3">\n      </span><span class="s1">// We assert here that this is a string because we got it from the</span><span class="s3">\n      </span><span class="s1">// Object.keys() call above.</span><span class="s3">\n      </span><span class="s1">const value = this.get(name) as string</span><span class="s3">\n\n      </span><span class="s1">yield [name, value] as [string, string]</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public *keys(): HeadersIterator&lt;string&gt; {</span><span class="s3">\n    </span><span class="s1">for (const key of Object.keys(this.headers)) {</span><span class="s3">\n      </span><span class="s1">const name = key.toLowerCase()</span><span class="s3">\n      </span><span class="s1">yield name</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public *values(): HeadersIterator&lt;string&gt; {</span><span class="s3">\n    </span><span class="s1">for (const key of Object.keys(this.headers)) {</span><span class="s3">\n      </span><span class="s1">// We assert here that this is a string because we got it from the</span><span class="s3">\n      </span><span class="s1">// Object.keys() call above.</span><span class="s3">\n      </span><span class="s1">const value = this.get(key) as string</span><span class="s3">\n\n      </span><span class="s1">yield value</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public [Symbol.iterator](): HeadersIterator&lt;[string, string]&gt; {</span><span class="s3">\n    </span><span class="s1">return this.entries()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ReflectAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;ReadonlyHeadersError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;callable&quot;</span><span class="s0">,</span><span class="s1">&quot;HeadersAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;Headers&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;Proxy&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;receiver&quot;</span><span class="s0">,</span><span class="s1">&quot;lowercased&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;original&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;find&quot;</span><span class="s0">,</span><span class="s1">&quot;o&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;deleteProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;seal&quot;</span><span class="s0">,</span><span class="s1">&quot;merge&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;append&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;existing&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;callbackfn&quot;</span><span class="s0">,</span><span class="s1">&quot;thisArg&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;call&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;iterator&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAEA,SAASA,cAAc,QAAQ,YAAW;;AAKnC,MAAMC,6BAA6BC;IACxCC,aAAc;QACZ,KAAK,CACH;IAEJ;IAEA,OAAcC,WAAW;QACvB,MAAM,IAAIH;IACZ;AACF;AAUO,MAAMI,uBAAuBC;IAGlCH,YAAYI,OAA4B,CAAE;QACxC,2EAA2E;QAC3E,2EAA2E;QAC3E,KAAK;QAEL,IAAI,CAACA,OAAO,GAAG,IAAIC,MAAMD,SAAS;YAChCE,KAAIC,MAAM,EAAEC,IAAI,EAAEC,QAAQ;gBACxB,sEAAsE;gBACtE,sEAAsE;gBACtE,cAAc;gBACd,IAAI,OAAOD,SAAS,UAAU;oBAC5B,OAAOX,kNAAAA,CAAeS,GAAG,CAACC,QAAQC,MAAMC;gBAC1C;gBAEA,MAAMC,aAAaF,KAAKG,WAAW;gBAEnC,wEAAwE;gBACxE,qEAAqE;gBACrE,kBAAkB;gBAClB,MAAMC,WAAWC,OAAOC,IAAI,CAACV,SAASW,IAAI,CACxC,CAACC,IAAMA,EAAEL,WAAW,OAAOD;gBAG7B,0DAA0D;gBAC1D,IAAI,OAAOE,aAAa,aAAa;gBAErC,mDAAmD;gBACnD,OAAOf,kNAAAA,CAAeS,GAAG,CAACC,QAAQK,UAAUH;YAC9C;YACAQ,KAAIV,MAAM,EAAEC,IAAI,EAAEU,KAAK,EAAET,QAAQ;gBAC/B,IAAI,OAAOD,SAAS,UAAU;oBAC5B,OAAOX,kNAAAA,CAAeoB,GAAG,CAACV,QAAQC,MAAMU,OAAOT;gBACjD;gBAEA,MAAMC,aAAaF,KAAKG,WAAW;gBAEnC,wEAAwE;gBACxE,qEAAqE;gBACrE,kBAAkB;gBAClB,MAAMC,WAAWC,OAAOC,IAAI,CAACV,SAASW,IAAI,CACxC,CAACC,IAAMA,EAAEL,WAAW,OAAOD;gBAG7B,iEAAiE;gBACjE,OAAOb,kNAAAA,CAAeoB,GAAG,CAACV,QAAQK,YAAYJ,MAAMU,OAAOT;YAC7D;YACAU,KAAIZ,MAAM,EAAEC,IAAI;gBACd,IAAI,OAAOA,SAAS,UAAU,OAAOX,kNAAAA,CAAesB,GAAG,CAACZ,QAAQC;gBAEhE,MAAME,aAAaF,KAAKG,WAAW;gBAEnC,wEAAwE;gBACxE,qEAAqE;gBACrE,kBAAkB;gBAClB,MAAMC,WAAWC,OAAOC,IAAI,CAACV,SAASW,IAAI,CACxC,CAACC,IAAMA,EAAEL,WAAW,OAAOD;gBAG7B,sDAAsD;gBACtD,IAAI,OAAOE,aAAa,aAAa,OAAO;gBAE5C,8CAA8C;gBAC9C,OAAOf,kNAAAA,CAAesB,GAAG,CAACZ,QAAQK;YACpC;YACAQ,gBAAeb,MAAM,EAAEC,IAAI;gBACzB,IAAI,OAAOA,SAAS,UAClB,OAAOX,kNAAAA,CAAeuB,cAAc,CAACb,QAAQC;gBAE/C,MAAME,aAAaF,KAAKG,WAAW;gBAEnC,wEAAwE;gBACxE,qEAAqE;gBACrE,kBAAkB;gBAClB,MAAMC,WAAWC,OAAOC,IAAI,CAACV,SAASW,IAAI,CACxC,CAACC,IAAMA,EAAEL,WAAW,OAAOD;gBAG7B,qDAAqD;gBACrD,IAAI,OAAOE,aAAa,aAAa,OAAO;gBAE5C,sDAAsD;gBACtD,OAAOf,kNAAAA,CAAeuB,cAAc,CAACb,QAAQK;YAC/C;QACF;IACF;IAEA;;;GAGC,GACD,OAAcS,KAAKjB,OAAgB,EAAmB;QACpD,OAAO,IAAIC,MAAuBD,SAAS;YACzCE,KAAIC,MAAM,EAAEC,IAAI,EAAEC,QAAQ;gBACxB,OAAQD;oBACN,KAAK;oBACL,KAAK;oBACL,KAAK;wBACH,OAAOV,qBAAqBG,QAAQ;oBACtC;wBACE,OAAOJ,kNAAAA,CAAeS,GAAG,CAACC,QAAQC,MAAMC;gBAC5C;YACF;QACF;IACF;IAEA;;;;;;GAMC,GACOa,MAAMJ,KAAwB,EAAU;QAC9C,IAAIK,MAAMC,OAAO,CAACN,QAAQ,OAAOA,MAAMO,IAAI,CAAC;QAE5C,OAAOP;IACT;IAEA;;;;;GAKC,GACD,OAAcQ,KAAKtB,OAAsC,EAAW;QAClE,IAAIA,mBAAmBD,SAAS,OAAOC;QAEvC,OAAO,IAAIF,eAAeE;IAC5B;IAEOuB,OAAOC,IAAY,EAAEV,KAAa,EAAQ;QAC/C,MAAMW,WAAW,IAAI,CAACzB,OAAO,CAACwB,KAAK;QACnC,IAAI,OAAOC,aAAa,UAAU;YAChC,IAAI,CAACzB,OAAO,CAACwB,KAAK,GAAG;gBAACC;gBAAUX;aAAM;QACxC,OAAO,IAAIK,MAAMC,OAAO,CAACK,WAAW;YAClCA,SAASC,IAAI,CAACZ;QAChB,OAAO;YACL,IAAI,CAACd,OAAO,CAACwB,KAAK,GAAGV;QACvB;IACF;IAEOa,OAAOH,IAAY,EAAQ;QAChC,OAAO,IAAI,CAACxB,OAAO,CAACwB,KAAK;IAC3B;IAEOtB,IAAIsB,IAAY,EAAiB;QACtC,MAAMV,QAAQ,IAAI,CAACd,OAAO,CAACwB,KAAK;QAChC,IAAI,OAAOV,UAAU,aAAa,OAAO,IAAI,CAACI,KAAK,CAACJ;QAEpD,OAAO;IACT;IAEOC,IAAIS,IAAY,EAAW;QAChC,OAAO,OAAO,IAAI,CAACxB,OAAO,CAACwB,KAAK,KAAK;IACvC;IAEOX,IAAIW,IAAY,EAAEV,KAAa,EAAQ;QAC5C,IAAI,CAACd,OAAO,CAACwB,KAAK,GAAGV;IACvB;IAEOc,QACLC,UAAkE,EAClEC,OAAa,EACP;QACN,KAAK,MAAM,CAACN,MAAMV,MAAM,IAAI,IAAI,CAACiB,OAAO,GAAI;YAC1CF,WAAWG,IAAI,CAACF,SAAShB,OAAOU,MAAM,IAAI;QAC5C;IACF;IAEA,CAAQO,UAA6C;QACnD,KAAK,MAAME,OAAOxB,OAAOC,IAAI,CAAC,IAAI,CAACV,OAAO,EAAG;YAC3C,MAAMwB,OAAOS,IAAI1B,WAAW;YAC5B,kEAAkE;YAClE,4BAA4B;YAC5B,MAAMO,QAAQ,IAAI,CAACZ,GAAG,CAACsB;YAEvB,MAAM;gBAACA;gBAAMV;aAAM;QACrB;IACF;IAEA,CAAQJ,OAAgC;QACtC,KAAK,MAAMuB,OAAOxB,OAAOC,IAAI,CAAC,IAAI,CAACV,OAAO,EAAG;YAC3C,MAAMwB,OAAOS,IAAI1B,WAAW;YAC5B,MAAMiB;QACR;IACF;IAEA,CAAQU,SAAkC;QACxC,KAAK,MAAMD,OAAOxB,OAAOC,IAAI,CAAC,IAAI,CAACV,OAAO,EAAG;YAC3C,kEAAkE;YAClE,4BAA4B;YAC5B,MAAMc,QAAQ,IAAI,CAACZ,GAAG,CAAC+B;YAEvB,MAAMnB;QACR;IACF;IAEO,CAACqB,OAAOC,QAAQ,CAAC,GAAsC;QAC5D,OAAO,IAAI,CAACL,OAAO;IACrB;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">292</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/api-utils/index.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { IncomingMessage } from 'http'</span><span class="s3">\n</span><span class="s1">import type { BaseNextRequest } from '../base-http'</span><span class="s3">\n</span><span class="s1">import type { CookieSerializeOptions } from 'next/dist/compiled/cookie'</span><span class="s3">\n</span><span class="s1">import type { NextApiResponse } from '../../shared/lib/utils'</span><span class="s3">\n\n</span><span class="s1">import { HeadersAdapter } from '../web/spec-extension/adapters/headers'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">PRERENDER_REVALIDATE_HEADER,</span><span class="s3">\n  </span><span class="s1">PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER,</span><span class="s3">\n</span><span class="s1">} from '../../lib/constants'</span><span class="s3">\n</span><span class="s1">import { getTracer } from '../lib/trace/tracer'</span><span class="s3">\n</span><span class="s1">import { NodeSpan } from '../lib/trace/constants'</span><span class="s3">\n\n</span><span class="s1">export type NextApiRequestCookies = Partial&lt;{ [key: string]: string }&gt;</span><span class="s3">\n</span><span class="s1">export type NextApiRequestQuery = Partial&lt;{ [key: string]: string | string[] }&gt;</span><span class="s3">\n\n</span><span class="s1">export type __ApiPreviewProps = {</span><span class="s3">\n  </span><span class="s1">previewModeId: string</span><span class="s3">\n  </span><span class="s1">previewModeEncryptionKey: string</span><span class="s3">\n  </span><span class="s1">previewModeSigningKey: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function wrapApiHandler&lt;T extends (...args: any[]) =&gt; any&gt;(</span><span class="s3">\n  </span><span class="s1">page: string,</span><span class="s3">\n  </span><span class="s1">handler: T</span><span class="s3">\n</span><span class="s1">): T {</span><span class="s3">\n  </span><span class="s1">return ((...args) =&gt; {</span><span class="s3">\n    </span><span class="s1">getTracer().setRootSpanAttribute('next.route', page)</span><span class="s3">\n    </span><span class="s1">// Call API route method</span><span class="s3">\n    </span><span class="s1">return getTracer().trace(</span><span class="s3">\n      </span><span class="s1">NodeSpan.runHandler,</span><span class="s3">\n      </span><span class="s1">{</span><span class="s3">\n        </span><span class="s1">spanName: `executing api route (pages) ${page}`,</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">() =&gt; handler(...args)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}) as T</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param res response object</span><span class="s3">\n </span><span class="s1">* @param statusCode `HTTP` status code of response</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function sendStatusCode(</span><span class="s3">\n  </span><span class="s1">res: NextApiResponse,</span><span class="s3">\n  </span><span class="s1">statusCode: number</span><span class="s3">\n</span><span class="s1">): NextApiResponse&lt;any&gt; {</span><span class="s3">\n  </span><span class="s1">res.statusCode = statusCode</span><span class="s3">\n  </span><span class="s1">return res</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param res response object</span><span class="s3">\n </span><span class="s1">* @param [statusOrUrl] `HTTP` status code of redirect</span><span class="s3">\n </span><span class="s1">* @param url URL of redirect</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function redirect(</span><span class="s3">\n  </span><span class="s1">res: NextApiResponse,</span><span class="s3">\n  </span><span class="s1">statusOrUrl: string | number,</span><span class="s3">\n  </span><span class="s1">url?: string</span><span class="s3">\n</span><span class="s1">): NextApiResponse&lt;any&gt; {</span><span class="s3">\n  </span><span class="s1">if (typeof statusOrUrl === 'string') {</span><span class="s3">\n    </span><span class="s1">url = statusOrUrl</span><span class="s3">\n    </span><span class="s1">statusOrUrl = 307</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (typeof statusOrUrl !== 'number' || typeof url !== 'string') {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Invalid redirect arguments. Please use a single argument URL, e.g. res.redirect('/destination') or use a status code and URL, e.g. res.redirect(307, '/destination').`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">res.writeHead(statusOrUrl, { Location: url })</span><span class="s3">\n  </span><span class="s1">res.write(url)</span><span class="s3">\n  </span><span class="s1">res.end()</span><span class="s3">\n  </span><span class="s1">return res</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function checkIsOnDemandRevalidate(</span><span class="s3">\n  </span><span class="s1">req: Request | IncomingMessage | BaseNextRequest,</span><span class="s3">\n  </span><span class="s1">previewProps: __ApiPreviewProps</span><span class="s3">\n</span><span class="s1">): {</span><span class="s3">\n  </span><span class="s1">isOnDemandRevalidate: boolean</span><span class="s3">\n  </span><span class="s1">revalidateOnlyGenerated: boolean</span><span class="s3">\n</span><span class="s1">} {</span><span class="s3">\n  </span><span class="s1">const headers = HeadersAdapter.from(req.headers)</span><span class="s3">\n\n  </span><span class="s1">const previewModeId = headers.get(PRERENDER_REVALIDATE_HEADER)</span><span class="s3">\n  </span><span class="s1">const isOnDemandRevalidate = previewModeId === previewProps.previewModeId</span><span class="s3">\n\n  </span><span class="s1">const revalidateOnlyGenerated = headers.has(</span><span class="s3">\n    </span><span class="s1">PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">return { isOnDemandRevalidate, revalidateOnlyGenerated }</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const COOKIE_NAME_PRERENDER_BYPASS = `__prerender_bypass`</span><span class="s3">\n</span><span class="s1">export const COOKIE_NAME_PRERENDER_DATA = `__next_preview_data`</span><span class="s3">\n\n</span><span class="s1">export const RESPONSE_LIMIT_DEFAULT = 4 * 1024 * 1024</span><span class="s3">\n\n</span><span class="s1">export const SYMBOL_PREVIEW_DATA = Symbol(COOKIE_NAME_PRERENDER_DATA)</span><span class="s3">\n</span><span class="s1">export const SYMBOL_CLEARED_COOKIES = Symbol(COOKIE_NAME_PRERENDER_BYPASS)</span><span class="s3">\n\n</span><span class="s1">export function clearPreviewData&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">res: NextApiResponse&lt;T&gt;,</span><span class="s3">\n  </span><span class="s1">options: {</span><span class="s3">\n    </span><span class="s1">path?: string</span><span class="s3">\n  </span><span class="s1">} = {}</span><span class="s3">\n</span><span class="s1">): NextApiResponse&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">if (SYMBOL_CLEARED_COOKIES in res) {</span><span class="s3">\n    </span><span class="s1">return res</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { serialize } =</span><span class="s3">\n    </span><span class="s1">require('next/dist/compiled/cookie') as typeof import('next/dist/compiled/cookie')</span><span class="s3">\n  </span><span class="s1">const previous = res.getHeader('Set-Cookie')</span><span class="s3">\n  </span><span class="s1">res.setHeader(`Set-Cookie`, [</span><span class="s3">\n    </span><span class="s1">...(typeof previous === 'string'</span><span class="s3">\n      </span><span class="s1">? [previous]</span><span class="s3">\n      </span><span class="s1">: Array.isArray(previous)</span><span class="s3">\n        </span><span class="s1">? previous</span><span class="s3">\n        </span><span class="s1">: []),</span><span class="s3">\n    </span><span class="s1">serialize(COOKIE_NAME_PRERENDER_BYPASS, '', {</span><span class="s3">\n      </span><span class="s1">// To delete a cookie, set `expires` to a date in the past:</span><span class="s3">\n      </span><span class="s1">// https://tools.ietf.org/html/rfc6265#section-4.1.1</span><span class="s3">\n      </span><span class="s1">// `Max-Age: 0` is not valid, thus ignored, and the cookie is persisted.</span><span class="s3">\n      </span><span class="s1">expires: new Date(0),</span><span class="s3">\n      </span><span class="s1">httpOnly: true,</span><span class="s3">\n      </span><span class="s1">sameSite: process.env.NODE_ENV !== 'development' ? 'none' : 'lax',</span><span class="s3">\n      </span><span class="s1">secure: process.env.NODE_ENV !== 'development',</span><span class="s3">\n      </span><span class="s1">path: '/',</span><span class="s3">\n      </span><span class="s1">...(options.path !== undefined</span><span class="s3">\n        </span><span class="s1">? ({ path: options.path } as CookieSerializeOptions)</span><span class="s3">\n        </span><span class="s1">: undefined),</span><span class="s3">\n    </span><span class="s1">}),</span><span class="s3">\n    </span><span class="s1">serialize(COOKIE_NAME_PRERENDER_DATA, '', {</span><span class="s3">\n      </span><span class="s1">// To delete a cookie, set `expires` to a date in the past:</span><span class="s3">\n      </span><span class="s1">// https://tools.ietf.org/html/rfc6265#section-4.1.1</span><span class="s3">\n      </span><span class="s1">// `Max-Age: 0` is not valid, thus ignored, and the cookie is persisted.</span><span class="s3">\n      </span><span class="s1">expires: new Date(0),</span><span class="s3">\n      </span><span class="s1">httpOnly: true,</span><span class="s3">\n      </span><span class="s1">sameSite: process.env.NODE_ENV !== 'development' ? 'none' : 'lax',</span><span class="s3">\n      </span><span class="s1">secure: process.env.NODE_ENV !== 'development',</span><span class="s3">\n      </span><span class="s1">path: '/',</span><span class="s3">\n      </span><span class="s1">...(options.path !== undefined</span><span class="s3">\n        </span><span class="s1">? ({ path: options.path } as CookieSerializeOptions)</span><span class="s3">\n        </span><span class="s1">: undefined),</span><span class="s3">\n    </span><span class="s1">}),</span><span class="s3">\n  </span><span class="s1">])</span><span class="s3">\n\n  </span><span class="s1">Object.defineProperty(res, SYMBOL_CLEARED_COOKIES, {</span><span class="s3">\n    </span><span class="s1">value: true,</span><span class="s3">\n    </span><span class="s1">enumerable: false,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">return res</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Custom error class</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class ApiError extends Error {</span><span class="s3">\n  </span><span class="s1">readonly statusCode: number</span><span class="s3">\n\n  </span><span class="s1">constructor(statusCode: number, message: string) {</span><span class="s3">\n    </span><span class="s1">super(message)</span><span class="s3">\n    </span><span class="s1">this.statusCode = statusCode</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Sends error in `response`</span><span class="s3">\n </span><span class="s1">* @param res response object</span><span class="s3">\n </span><span class="s1">* @param statusCode of response</span><span class="s3">\n </span><span class="s1">* @param message of response</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function sendError(</span><span class="s3">\n  </span><span class="s1">res: NextApiResponse,</span><span class="s3">\n  </span><span class="s1">statusCode: number,</span><span class="s3">\n  </span><span class="s1">message: string</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">res.statusCode = statusCode</span><span class="s3">\n  </span><span class="s1">res.statusMessage = message</span><span class="s3">\n  </span><span class="s1">res.end(message)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface LazyProps {</span><span class="s3">\n  </span><span class="s1">req: IncomingMessage</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Execute getter function only if its needed</span><span class="s3">\n </span><span class="s1">* @param LazyProps `req` and `params` for lazyProp</span><span class="s3">\n </span><span class="s1">* @param prop name of property</span><span class="s3">\n </span><span class="s1">* @param getter function to get data</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function setLazyProp&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">{ req }: LazyProps,</span><span class="s3">\n  </span><span class="s1">prop: string,</span><span class="s3">\n  </span><span class="s1">getter: () =&gt; T</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">const opts = { configurable: true, enumerable: true }</span><span class="s3">\n  </span><span class="s1">const optsReset = { ...opts, writable: true }</span><span class="s3">\n\n  </span><span class="s1">Object.defineProperty(req, prop, {</span><span class="s3">\n    </span><span class="s1">...opts,</span><span class="s3">\n    </span><span class="s1">get: () =&gt; {</span><span class="s3">\n      </span><span class="s1">const value = getter()</span><span class="s3">\n      </span><span class="s1">// we set the property on the object to avoid recalculating it</span><span class="s3">\n      </span><span class="s1">Object.defineProperty(req, prop, { ...optsReset, value })</span><span class="s3">\n      </span><span class="s1">return value</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">set: (value) =&gt; {</span><span class="s3">\n      </span><span class="s1">Object.defineProperty(req, prop, { ...optsReset, value })</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;HeadersAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;PRERENDER_REVALIDATE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;getTracer&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;wrapApiHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;handler&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;setRootSpanAttribute&quot;</span><span class="s0">,</span><span class="s1">&quot;trace&quot;</span><span class="s0">,</span><span class="s1">&quot;runHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;spanName&quot;</span><span class="s0">,</span><span class="s1">&quot;sendStatusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;statusOrUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;writeHead&quot;</span><span class="s0">,</span><span class="s1">&quot;Location&quot;</span><span class="s0">,</span><span class="s1">&quot;write&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;checkIsOnDemandRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;previewProps&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;previewModeId&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;isOnDemandRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidateOnlyGenerated&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;COOKIE_NAME_PRERENDER_BYPASS&quot;</span><span class="s0">,</span><span class="s1">&quot;COOKIE_NAME_PRERENDER_DATA&quot;</span><span class="s0">,</span><span class="s1">&quot;RESPONSE_LIMIT_DEFAULT&quot;</span><span class="s0">,</span><span class="s1">&quot;SYMBOL_PREVIEW_DATA&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;SYMBOL_CLEARED_COOKIES&quot;</span><span class="s0">,</span><span class="s1">&quot;clearPreviewData&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;serialize&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;previous&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;setHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;expires&quot;</span><span class="s0">,</span><span class="s1">&quot;Date&quot;</span><span class="s0">,</span><span class="s1">&quot;httpOnly&quot;</span><span class="s0">,</span><span class="s1">&quot;sameSite&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;secure&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;defineProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;enumerable&quot;</span><span class="s0">,</span><span class="s1">&quot;ApiError&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;sendError&quot;</span><span class="s0">,</span><span class="s1">&quot;statusMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;setLazyProp&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;getter&quot;</span><span class="s0">,</span><span class="s1">&quot;opts&quot;</span><span class="s0">,</span><span class="s1">&quot;configurable&quot;</span><span class="s0">,</span><span class="s1">&quot;optsReset&quot;</span><span class="s0">,</span><span class="s1">&quot;writable&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">461</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/api-utils/get-cookie-parser.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { NextApiRequestCookies } from '.'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Parse cookies from the `headers` of request</span><span class="s3">\n </span><span class="s1">* @param req request object</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">export function getCookieParser(headers: {</span><span class="s3">\n  </span><span class="s1">[key: string]: string | string[] | null | undefined</span><span class="s3">\n</span><span class="s1">}): () =&gt; NextApiRequestCookies {</span><span class="s3">\n  </span><span class="s1">return function parseCookie(): NextApiRequestCookies {</span><span class="s3">\n    </span><span class="s1">const { cookie } = headers</span><span class="s3">\n\n    </span><span class="s1">if (!cookie) {</span><span class="s3">\n      </span><span class="s1">return {}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const { parse: parseCookieFn } =</span><span class="s3">\n      </span><span class="s1">require('next/dist/compiled/cookie') as typeof import('next/dist/compiled/cookie')</span><span class="s3">\n    </span><span class="s1">return parseCookieFn(Array.isArray(cookie) ? cookie.join('; ') : cookie)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getCookieParser&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;parseCookie&quot;</span><span class="s0">,</span><span class="s1">&quot;cookie&quot;</span><span class="s0">,</span><span class="s1">&quot;parse&quot;</span><span class="s0">,</span><span class="s1">&quot;parseCookieFn&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAEA;;;CAGC,GAED;;;;AAAO,SAASA,gBAAgBC,OAE/B;IACC,OAAO,SAASC;QACd,MAAM,EAAEC,MAAM,EAAE,GAAGF;QAEnB,IAAI,CAACE,QAAQ;YACX,OAAO,CAAC;QACV;QAEA,MAAM,EAAEC,OAAOC,aAAa,EAAE,GAC5BC,QAAQ;QACV,OAAOD,cAAcE,MAAMC,OAAO,CAACL,UAAUA,OAAOM,IAAI,CAAC,QAAQN;IACnE;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">482</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/base-http/index.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { IncomingHttpHeaders, OutgoingHttpHeaders } from 'http'</span><span class="s3">\n</span><span class="s1">import type { I18NConfig } from '../config-shared'</span><span class="s3">\n\n</span><span class="s1">import { RedirectStatusCode } from '../../client/components/redirect-status-code'</span><span class="s3">\n</span><span class="s1">import type { NextApiRequestCookies } from '../api-utils'</span><span class="s3">\n</span><span class="s1">import { getCookieParser } from '../api-utils/get-cookie-parser'</span><span class="s3">\n\n</span><span class="s1">export interface BaseNextRequestConfig {</span><span class="s3">\n  </span><span class="s1">basePath: string | undefined</span><span class="s3">\n  </span><span class="s1">i18n?: I18NConfig</span><span class="s3">\n  </span><span class="s1">trailingSlash?: boolean | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type FetchMetric = {</span><span class="s3">\n  </span><span class="s1">url: string</span><span class="s3">\n  </span><span class="s1">idx: number</span><span class="s3">\n  </span><span class="s1">end: number</span><span class="s3">\n  </span><span class="s1">start: number</span><span class="s3">\n  </span><span class="s1">method: string</span><span class="s3">\n  </span><span class="s1">status: number</span><span class="s3">\n  </span><span class="s1">cacheReason: string</span><span class="s3">\n  </span><span class="s1">cacheStatus: 'hit' | 'miss' | 'skip' | 'hmr'</span><span class="s3">\n  </span><span class="s1">cacheWarning?: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type FetchMetrics = Array&lt;FetchMetric&gt;</span><span class="s3">\n\n</span><span class="s1">export abstract class BaseNextRequest&lt;Body = any&gt; {</span><span class="s3">\n  </span><span class="s1">protected _cookies: NextApiRequestCookies | undefined</span><span class="s3">\n  </span><span class="s1">public abstract headers: IncomingHttpHeaders</span><span class="s3">\n  </span><span class="s1">public abstract fetchMetrics: FetchMetric[] | undefined</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">public method: string,</span><span class="s3">\n    </span><span class="s1">public url: string,</span><span class="s3">\n    </span><span class="s1">public body: Body</span><span class="s3">\n  </span><span class="s1">) {}</span><span class="s3">\n\n  </span><span class="s1">// Utils implemented using the abstract methods above</span><span class="s3">\n\n  </span><span class="s1">public get cookies() {</span><span class="s3">\n    </span><span class="s1">if (this._cookies) return this._cookies</span><span class="s3">\n    </span><span class="s1">return (this._cookies = getCookieParser(this.headers)())</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export abstract class BaseNextResponse&lt;Destination = any&gt; {</span><span class="s3">\n  </span><span class="s1">abstract statusCode: number | undefined</span><span class="s3">\n  </span><span class="s1">abstract statusMessage: string | undefined</span><span class="s3">\n  </span><span class="s1">abstract get sent(): boolean</span><span class="s3">\n\n  </span><span class="s1">constructor(public destination: Destination) {}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Sets a value for the header overwriting existing values</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">abstract setHeader(name: string, value: string | string[]): this</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Removes a header</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">abstract removeHeader(name: string): this</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Appends value for the given header name</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">abstract appendHeader(name: string, value: string): this</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Get all values for a header as an array or undefined if no value is present</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">abstract getHeaderValues(name: string): string[] | undefined</span><span class="s3">\n\n  </span><span class="s1">abstract hasHeader(name: string): boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Get values for a header concatenated using `,` or undefined if no value is present</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">abstract getHeader(name: string): string | undefined</span><span class="s3">\n\n  </span><span class="s1">abstract getHeaders(): OutgoingHttpHeaders</span><span class="s3">\n\n  </span><span class="s1">abstract body(value: string): this</span><span class="s3">\n\n  </span><span class="s1">abstract send(): void</span><span class="s3">\n\n  </span><span class="s1">abstract onClose(callback: () =&gt; void): void</span><span class="s3">\n\n  </span><span class="s1">// Utils implemented using the abstract methods above</span><span class="s3">\n\n  </span><span class="s1">public redirect(destination: string, statusCode: number) {</span><span class="s3">\n    </span><span class="s1">this.setHeader('Location', destination)</span><span class="s3">\n    </span><span class="s1">this.statusCode = statusCode</span><span class="s3">\n\n    </span><span class="s1">// Since IE11 doesn't support the 308 header add backwards</span><span class="s3">\n    </span><span class="s1">// compatibility using refresh header</span><span class="s3">\n    </span><span class="s1">if (statusCode === RedirectStatusCode.PermanentRedirect) {</span><span class="s3">\n      </span><span class="s1">this.setHeader('Refresh', `0;url=${destination}`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return this</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RedirectStatusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;getCookieParser&quot;</span><span class="s0">,</span><span class="s1">&quot;BaseNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;cookies&quot;</span><span class="s0">,</span><span class="s1">&quot;_cookies&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;BaseNextResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;destination&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;setHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;PermanentRedirect&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAGA,SAASA,kBAAkB,QAAQ,+CAA8C;AAEjF,SAASC,eAAe,QAAQ,iCAAgC;;;AAsBzD,MAAeC;IAKpBC,YACSC,MAAc,EACdC,GAAW,EACXC,IAAU,CACjB;aAHOF,MAAAA,GAAAA;aACAC,GAAAA,GAAAA;aACAC,IAAAA,GAAAA;IACN;IAEH,qDAAqD;IAErD,IAAWC,UAAU;QACnB,IAAI,IAAI,CAACC,QAAQ,EAAE,OAAO,IAAI,CAACA,QAAQ;QACvC,OAAQ,IAAI,CAACA,QAAQ,OAAGP,2MAAAA,EAAgB,IAAI,CAACQ,OAAO;IACtD;AACF;AAEO,MAAeC;IAKpBP,YAAmBQ,WAAwB,CAAE;aAA1BA,WAAAA,GAAAA;IAA2B;IAqC9C,qDAAqD;IAE9CC,SAASD,WAAmB,EAAEE,UAAkB,EAAE;QACvD,IAAI,CAACC,SAAS,CAAC,YAAYH;QAC3B,IAAI,CAACE,UAAU,GAAGA;QAElB,0DAA0D;QAC1D,qCAAqC;QACrC,IAAIA,eAAeb,+MAAAA,CAAmBe,iBAAiB,EAAE;YACvD,IAAI,CAACD,SAAS,CAAC,WAAW,CAAC,MAAM,EAAEH,aAAa;QAClD;QAEA,OAAO,IAAI;IACb;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">524</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/base-http/node.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { ServerResponse, IncomingMessage } from 'http'</span><span class="s3">\n</span><span class="s1">import type { Writable, Readable } from 'stream'</span><span class="s3">\n\n</span><span class="s1">import { SYMBOL_CLEARED_COOKIES } from '../api-utils'</span><span class="s3">\n</span><span class="s1">import type { NextApiRequestCookies } from '../api-utils'</span><span class="s3">\n\n</span><span class="s1">import { NEXT_REQUEST_META } from '../request-meta'</span><span class="s3">\n</span><span class="s1">import type { RequestMeta } from '../request-meta'</span><span class="s3">\n\n</span><span class="s1">import { BaseNextRequest, BaseNextResponse, type FetchMetric } from './index'</span><span class="s3">\n</span><span class="s1">import type { OutgoingHttpHeaders } from 'node:http'</span><span class="s3">\n\n</span><span class="s1">type Req = IncomingMessage &amp; {</span><span class="s3">\n  </span><span class="s1">[NEXT_REQUEST_META]?: RequestMeta</span><span class="s3">\n  </span><span class="s1">cookies?: NextApiRequestCookies</span><span class="s3">\n  </span><span class="s1">fetchMetrics?: FetchMetric[]</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class NodeNextRequest extends BaseNextRequest&lt;Readable&gt; {</span><span class="s3">\n  </span><span class="s1">public headers = this._req.headers</span><span class="s3">\n  </span><span class="s1">public fetchMetrics: FetchMetric[] | undefined = this._req?.fetchMetrics;</span><span class="s3">\n\n  </span><span class="s1">[NEXT_REQUEST_META]: RequestMeta = this._req[NEXT_REQUEST_META] || {}</span><span class="s3">\n\n  </span><span class="s1">constructor(private _req: Req) {</span><span class="s3">\n    </span><span class="s1">super(_req.method!.toUpperCase(), _req.url!, _req)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get originalRequest() {</span><span class="s3">\n    </span><span class="s1">// Need to mimic these changes to the original req object for places where we use it:</span><span class="s3">\n    </span><span class="s1">// render.tsx, api/ssg requests</span><span class="s3">\n    </span><span class="s1">this._req[NEXT_REQUEST_META] = this[NEXT_REQUEST_META]</span><span class="s3">\n    </span><span class="s1">this._req.url = this.url</span><span class="s3">\n    </span><span class="s1">this._req.cookies = this.cookies</span><span class="s3">\n    </span><span class="s1">return this._req</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set originalRequest(value: Req) {</span><span class="s3">\n    </span><span class="s1">this._req = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private streaming = false</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Returns the request body as a Web Readable Stream. The body here can only</span><span class="s3">\n   </span><span class="s1">* be read once as the body will start flowing as soon as the data handler</span><span class="s3">\n   </span><span class="s1">* is attached.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* @internal</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">public stream() {</span><span class="s3">\n    </span><span class="s1">if (this.streaming) {</span><span class="s3">\n      </span><span class="s1">throw new Error(</span><span class="s3">\n        </span><span class="s1">'Invariant: NodeNextRequest.stream() can only be called once'</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">this.streaming = true</span><span class="s3">\n\n    </span><span class="s1">return new ReadableStream({</span><span class="s3">\n      </span><span class="s1">start: (controller) =&gt; {</span><span class="s3">\n        </span><span class="s1">this._req.on('data', (chunk) =&gt; {</span><span class="s3">\n          </span><span class="s1">controller.enqueue(new Uint8Array(chunk))</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">this._req.on('end', () =&gt; {</span><span class="s3">\n          </span><span class="s1">controller.close()</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">this._req.on('error', (err) =&gt; {</span><span class="s3">\n          </span><span class="s1">controller.error(err)</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class NodeNextResponse extends BaseNextResponse&lt;Writable&gt; {</span><span class="s3">\n  </span><span class="s1">private textBody: string | undefined = undefined</span><span class="s3">\n\n  </span><span class="s1">public [SYMBOL_CLEARED_COOKIES]?: boolean</span><span class="s3">\n\n  </span><span class="s1">get originalResponse() {</span><span class="s3">\n    </span><span class="s1">if (SYMBOL_CLEARED_COOKIES in this) {</span><span class="s3">\n      </span><span class="s1">this._res[SYMBOL_CLEARED_COOKIES] = this[SYMBOL_CLEARED_COOKIES]</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return this._res</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">private _res: ServerResponse &amp; { [SYMBOL_CLEARED_COOKIES]?: boolean }</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">super(_res)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get sent() {</span><span class="s3">\n    </span><span class="s1">return this._res.finished || this._res.headersSent</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get statusCode() {</span><span class="s3">\n    </span><span class="s1">return this._res.statusCode</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set statusCode(value: number) {</span><span class="s3">\n    </span><span class="s1">this._res.statusCode = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">get statusMessage() {</span><span class="s3">\n    </span><span class="s1">return this._res.statusMessage</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">set statusMessage(value: string) {</span><span class="s3">\n    </span><span class="s1">this._res.statusMessage = value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">setHeader(name: string, value: string | string[]): this {</span><span class="s3">\n    </span><span class="s1">this._res.setHeader(name, value)</span><span class="s3">\n    </span><span class="s1">return this</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">removeHeader(name: string): this {</span><span class="s3">\n    </span><span class="s1">this._res.removeHeader(name)</span><span class="s3">\n    </span><span class="s1">return this</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">getHeaderValues(name: string): string[] | undefined {</span><span class="s3">\n    </span><span class="s1">const values = this._res.getHeader(name)</span><span class="s3">\n\n    </span><span class="s1">if (values === undefined) return undefined</span><span class="s3">\n\n    </span><span class="s1">return (Array.isArray(values) ? values : [values]).map((value) =&gt;</span><span class="s3">\n      </span><span class="s1">value.toString()</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">hasHeader(name: string): boolean {</span><span class="s3">\n    </span><span class="s1">return this._res.hasHeader(name)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">getHeader(name: string): string | undefined {</span><span class="s3">\n    </span><span class="s1">const values = this.getHeaderValues(name)</span><span class="s3">\n    </span><span class="s1">return Array.isArray(values) ? values.join(',') : undefined</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">getHeaders(): OutgoingHttpHeaders {</span><span class="s3">\n    </span><span class="s1">return this._res.getHeaders()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">appendHeader(name: string, value: string): this {</span><span class="s3">\n    </span><span class="s1">const currentValues = this.getHeaderValues(name) ?? []</span><span class="s3">\n\n    </span><span class="s1">if (!currentValues.includes(value)) {</span><span class="s3">\n      </span><span class="s1">this._res.setHeader(name, [...currentValues, value])</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return this</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">body(value: string) {</span><span class="s3">\n    </span><span class="s1">this.textBody = value</span><span class="s3">\n    </span><span class="s1">return this</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">send() {</span><span class="s3">\n    </span><span class="s1">this._res.end(this.textBody)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public onClose(callback: () =&gt; void) {</span><span class="s3">\n    </span><span class="s1">this.originalResponse.on('close', callback)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;SYMBOL_CLEARED_COOKIES&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_REQUEST_META&quot;</span><span class="s0">,</span><span class="s1">&quot;BaseNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;BaseNextResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;_req&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;toUpperCase&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchMetrics&quot;</span><span class="s0">,</span><span class="s1">&quot;streaming&quot;</span><span class="s0">,</span><span class="s1">&quot;originalRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;cookies&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;stream&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;ReadableStream&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;controller&quot;</span><span class="s0">,</span><span class="s1">&quot;on&quot;</span><span class="s0">,</span><span class="s1">&quot;chunk&quot;</span><span class="s0">,</span><span class="s1">&quot;enqueue&quot;</span><span class="s0">,</span><span class="s1">&quot;Uint8Array&quot;</span><span class="s0">,</span><span class="s1">&quot;close&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeNextResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;originalResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;_res&quot;</span><span class="s0">,</span><span class="s1">&quot;textBody&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;sent&quot;</span><span class="s0">,</span><span class="s1">&quot;finished&quot;</span><span class="s0">,</span><span class="s1">&quot;headersSent&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;statusMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;setHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;removeHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeaderValues&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;hasHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;appendHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;currentValues&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;send&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;onClose&quot;</span><span class="s0">,</span><span class="s1">&quot;callback&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">660</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/experimental/ppr.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* If set to `incremental`, only those leaf pages that export</span><span class="s3">\n </span><span class="s1">* `experimental_ppr = true` will have partial prerendering enabled. If any</span><span class="s3">\n </span><span class="s1">* page exports this value as `false` or does not export it at all will not</span><span class="s3">\n </span><span class="s1">* have partial prerendering enabled. If set to a boolean, the options for</span><span class="s3">\n </span><span class="s1">* `experimental_ppr` will be ignored.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">export type ExperimentalPPRConfig = boolean | 'incremental'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Returns true if partial prerendering is enabled for the application. It does</span><span class="s3">\n </span><span class="s1">* not tell you if a given route has PPR enabled, as that requires analysis of</span><span class="s3">\n </span><span class="s1">* the route's configuration.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @see {@link checkIsRoutePPREnabled} - for checking if a specific route has PPR enabled.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function checkIsAppPPREnabled(</span><span class="s3">\n  </span><span class="s1">config: ExperimentalPPRConfig | undefined</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">// If the config is undefined, partial prerendering is disabled.</span><span class="s3">\n  </span><span class="s1">if (typeof config === 'undefined') return false</span><span class="s3">\n\n  </span><span class="s1">// If the config is a boolean, use it directly.</span><span class="s3">\n  </span><span class="s1">if (typeof config === 'boolean') return config</span><span class="s3">\n\n  </span><span class="s1">// If the config is a string, it must be 'incremental' to enable partial</span><span class="s3">\n  </span><span class="s1">// prerendering.</span><span class="s3">\n  </span><span class="s1">if (config === 'incremental') return true</span><span class="s3">\n\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Returns true if partial prerendering is supported for the current page with</span><span class="s3">\n </span><span class="s1">* the provided app configuration. If the application doesn't have partial</span><span class="s3">\n </span><span class="s1">* prerendering enabled, this function will always return false. If you want to</span><span class="s3">\n </span><span class="s1">* check if the application has partial prerendering enabled</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @see {@link checkIsAppPPREnabled} for checking if the application has PPR enabled.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function checkIsRoutePPREnabled(</span><span class="s3">\n  </span><span class="s1">config: ExperimentalPPRConfig | undefined,</span><span class="s3">\n  </span><span class="s1">appConfig: {</span><span class="s3">\n    </span><span class="s1">experimental_ppr?: boolean</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">// If the config is undefined, partial prerendering is disabled.</span><span class="s3">\n  </span><span class="s1">if (typeof config === 'undefined') return false</span><span class="s3">\n\n  </span><span class="s1">// If the config is a boolean, use it directly.</span><span class="s3">\n  </span><span class="s1">if (typeof config === 'boolean') return config</span><span class="s3">\n\n  </span><span class="s1">// If the config is a string, it must be 'incremental' to enable partial</span><span class="s3">\n  </span><span class="s1">// prerendering.</span><span class="s3">\n  </span><span class="s1">if (config === 'incremental' &amp;&amp; appConfig.experimental_ppr === true) {</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;checkIsAppPPREnabled&quot;</span><span class="s0">,</span><span class="s1">&quot;config&quot;</span><span class="s0">,</span><span class="s1">&quot;checkIsRoutePPREnabled&quot;</span><span class="s0">,</span><span class="s1">&quot;appConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;experimental_ppr&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;;;;CAMC,GAID;;;;;;CAMC,GACD;;;;;;AAAO,SAASA,qBACdC,MAAyC;IAEzC,gEAAgE;IAChE,IAAI,OAAOA,WAAW,aAAa,OAAO;IAE1C,+CAA+C;IAC/C,IAAI,OAAOA,WAAW,WAAW,OAAOA;IAExC,wEAAwE;IACxE,gBAAgB;IAChB,IAAIA,WAAW,eAAe,OAAO;IAErC,OAAO;AACT;AAUO,SAASC,uBACdD,MAAyC,EACzCE,SAEC;IAED,gEAAgE;IAChE,IAAI,OAAOF,WAAW,aAAa,OAAO;IAE1C,+CAA+C;IAC/C,IAAI,OAAOA,WAAW,WAAW,OAAOA;IAExC,wEAAwE;IACxE,gBAAgB;IAChB,IAAIA,WAAW,iBAAiBE,UAAUC,gBAAgB,KAAK,MAAM;QACnE,OAAO;IACT;IAEA,OAAO;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">704</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { HtmlProps } from './html-context.shared-runtime'</span><span class="s3">\n</span><span class="s1">import type { ComponentType, JSX } from 'react'</span><span class="s3">\n</span><span class="s1">import type { DomainLocale } from '../../server/config'</span><span class="s3">\n</span><span class="s1">import type { Env } from '@next/env'</span><span class="s3">\n</span><span class="s1">import type { IncomingMessage, ServerResponse } from 'http'</span><span class="s3">\n</span><span class="s1">import type { NextRouter } from './router/router'</span><span class="s3">\n</span><span class="s1">import type { ParsedUrlQuery } from 'querystring'</span><span class="s3">\n</span><span class="s1">import type { PreviewData } from '../../types'</span><span class="s3">\n</span><span class="s1">import type { COMPILER_NAMES } from './constants'</span><span class="s3">\n</span><span class="s1">import type fs from 'fs'</span><span class="s3">\n\n</span><span class="s1">export type NextComponentType&lt;</span><span class="s3">\n  </span><span class="s1">Context extends BaseContext = NextPageContext,</span><span class="s3">\n  </span><span class="s1">InitialProps = {},</span><span class="s3">\n  </span><span class="s1">Props = {},</span><span class="s3">\n</span><span class="s1">&gt; = ComponentType&lt;Props&gt; &amp; {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Used for initial page load data population. Data returned from `getInitialProps` is serialized when server rendered.</span><span class="s3">\n   </span><span class="s1">* Make sure to return plain `Object` without using `Date`, `Map`, `Set`.</span><span class="s3">\n   </span><span class="s1">* @param context Context of `page`</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">getInitialProps?(context: Context): InitialProps | Promise&lt;InitialProps&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type DocumentType = NextComponentType&lt;</span><span class="s3">\n  </span><span class="s1">DocumentContext,</span><span class="s3">\n  </span><span class="s1">DocumentInitialProps,</span><span class="s3">\n  </span><span class="s1">DocumentProps</span><span class="s3">\n</span><span class="s1">&gt;</span><span class="s3">\n\n</span><span class="s1">export type AppType&lt;P = {}&gt; = NextComponentType&lt;</span><span class="s3">\n  </span><span class="s1">AppContextType,</span><span class="s3">\n  </span><span class="s1">P,</span><span class="s3">\n  </span><span class="s1">AppPropsType&lt;any, P&gt;</span><span class="s3">\n</span><span class="s1">&gt;</span><span class="s3">\n\n</span><span class="s1">export type AppTreeType = ComponentType&lt;</span><span class="s3">\n  </span><span class="s1">AppInitialProps &amp; { [name: string]: any }</span><span class="s3">\n</span><span class="s1">&gt;</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Web vitals provided to _app.reportWebVitals by Core Web Vitals plugin developed by Google Chrome team.</span><span class="s3">\n </span><span class="s1">* https://nextjs.org/blog/next-9-4#integrated-web-vitals-reporting</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const WEB_VITALS = ['CLS', 'FCP', 'FID', 'INP', 'LCP', 'TTFB'] as const</span><span class="s3">\n</span><span class="s1">export type NextWebVitalsMetric = {</span><span class="s3">\n  </span><span class="s1">id: string</span><span class="s3">\n  </span><span class="s1">startTime: number</span><span class="s3">\n  </span><span class="s1">value: number</span><span class="s3">\n  </span><span class="s1">attribution?: { [key: string]: unknown }</span><span class="s3">\n</span><span class="s1">} &amp; (</span><span class="s3">\n  </span><span class="s1">| {</span><span class="s3">\n      </span><span class="s1">label: 'web-vital'</span><span class="s3">\n      </span><span class="s1">name: (typeof WEB_VITALS)[number]</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">| {</span><span class="s3">\n      </span><span class="s1">label: 'custom'</span><span class="s3">\n      </span><span class="s1">name:</span><span class="s3">\n        </span><span class="s1">| 'Next.js-hydration'</span><span class="s3">\n        </span><span class="s1">| 'Next.js-route-change-to-render'</span><span class="s3">\n        </span><span class="s1">| 'Next.js-render'</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n\n</span><span class="s1">export type Enhancer&lt;C&gt; = (Component: C) =&gt; C</span><span class="s3">\n\n</span><span class="s1">export type ComponentsEnhancer =</span><span class="s3">\n  </span><span class="s1">| {</span><span class="s3">\n      </span><span class="s1">enhanceApp?: Enhancer&lt;AppType&gt;</span><span class="s3">\n      </span><span class="s1">enhanceComponent?: Enhancer&lt;NextComponentType&gt;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">| Enhancer&lt;NextComponentType&gt;</span><span class="s3">\n\n</span><span class="s1">export type RenderPageResult = {</span><span class="s3">\n  </span><span class="s1">html: string</span><span class="s3">\n  </span><span class="s1">head?: Array&lt;JSX.Element | null&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type RenderPage = (</span><span class="s3">\n  </span><span class="s1">options?: ComponentsEnhancer</span><span class="s3">\n</span><span class="s1">) =&gt; DocumentInitialProps | Promise&lt;DocumentInitialProps&gt;</span><span class="s3">\n\n</span><span class="s1">export type BaseContext = {</span><span class="s3">\n  </span><span class="s1">res?: ServerResponse</span><span class="s3">\n  </span><span class="s1">[k: string]: any</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type NEXT_DATA = {</span><span class="s3">\n  </span><span class="s1">props: Record&lt;string, any&gt;</span><span class="s3">\n  </span><span class="s1">page: string</span><span class="s3">\n  </span><span class="s1">query: ParsedUrlQuery</span><span class="s3">\n  </span><span class="s1">buildId: string</span><span class="s3">\n  </span><span class="s1">assetPrefix?: string</span><span class="s3">\n  </span><span class="s1">runtimeConfig?: { [key: string]: any }</span><span class="s3">\n  </span><span class="s1">nextExport?: boolean</span><span class="s3">\n  </span><span class="s1">autoExport?: boolean</span><span class="s3">\n  </span><span class="s1">isFallback?: boolean</span><span class="s3">\n  </span><span class="s1">isExperimentalCompile?: boolean</span><span class="s3">\n  </span><span class="s1">dynamicIds?: (string | number)[]</span><span class="s3">\n  </span><span class="s1">err?: Error &amp; {</span><span class="s3">\n    </span><span class="s1">statusCode?: number</span><span class="s3">\n    </span><span class="s1">source?: typeof COMPILER_NAMES.server | typeof COMPILER_NAMES.edgeServer</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">gsp?: boolean</span><span class="s3">\n  </span><span class="s1">gssp?: boolean</span><span class="s3">\n  </span><span class="s1">customServer?: boolean</span><span class="s3">\n  </span><span class="s1">gip?: boolean</span><span class="s3">\n  </span><span class="s1">appGip?: boolean</span><span class="s3">\n  </span><span class="s1">locale?: string</span><span class="s3">\n  </span><span class="s1">locales?: readonly string[]</span><span class="s3">\n  </span><span class="s1">defaultLocale?: string</span><span class="s3">\n  </span><span class="s1">domainLocales?: readonly DomainLocale[]</span><span class="s3">\n  </span><span class="s1">scriptLoader?: any[]</span><span class="s3">\n  </span><span class="s1">isPreview?: boolean</span><span class="s3">\n  </span><span class="s1">notFoundSrcPage?: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* `Next` context</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export interface NextPageContext {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Error object if encountered during rendering</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">err?: (Error &amp; { statusCode?: number }) | null</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* `HTTP` request object.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">req?: IncomingMessage</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* `HTTP` response object.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">res?: ServerResponse</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Path section of `URL`.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pathname: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Query string section of `URL` parsed as an object.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">query: ParsedUrlQuery</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* `String` of the actual path including query.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">asPath?: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The currently active locale</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">locale?: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* All configured locales</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">locales?: readonly string[]</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The configured default locale</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">defaultLocale?: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* `Component` the tree of the App to use if needing to render separately</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">AppTree: AppTreeType</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type AppContextType&lt;Router extends NextRouter = NextRouter&gt; = {</span><span class="s3">\n  </span><span class="s1">Component: NextComponentType&lt;NextPageContext&gt;</span><span class="s3">\n  </span><span class="s1">AppTree: AppTreeType</span><span class="s3">\n  </span><span class="s1">ctx: NextPageContext</span><span class="s3">\n  </span><span class="s1">router: Router</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type AppInitialProps&lt;PageProps = any&gt; = {</span><span class="s3">\n  </span><span class="s1">pageProps: PageProps</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type AppPropsType&lt;</span><span class="s3">\n  </span><span class="s1">Router extends NextRouter = NextRouter,</span><span class="s3">\n  </span><span class="s1">PageProps = {},</span><span class="s3">\n</span><span class="s1">&gt; = AppInitialProps&lt;PageProps&gt; &amp; {</span><span class="s3">\n  </span><span class="s1">Component: NextComponentType&lt;NextPageContext, any, any&gt;</span><span class="s3">\n  </span><span class="s1">router: Router</span><span class="s3">\n  </span><span class="s1">__N_SSG?: boolean</span><span class="s3">\n  </span><span class="s1">__N_SSP?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type DocumentContext = NextPageContext &amp; {</span><span class="s3">\n  </span><span class="s1">renderPage: RenderPage</span><span class="s3">\n  </span><span class="s1">defaultGetInitialProps(</span><span class="s3">\n    </span><span class="s1">ctx: DocumentContext,</span><span class="s3">\n    </span><span class="s1">options?: { nonce?: string }</span><span class="s3">\n  </span><span class="s1">): Promise&lt;DocumentInitialProps&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type DocumentInitialProps = RenderPageResult &amp; {</span><span class="s3">\n  </span><span class="s1">styles?: React.ReactElement[] | Iterable&lt;React.ReactNode&gt; | JSX.Element</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type DocumentProps = DocumentInitialProps &amp; HtmlProps</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Next `API` route request</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export interface NextApiRequest extends IncomingMessage {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Object of `query` values from url</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">query: Partial&lt;{</span><span class="s3">\n    </span><span class="s1">[key: string]: string | string[]</span><span class="s3">\n  </span><span class="s1">}&gt;</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Object of `cookies` from header</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">cookies: Partial&lt;{</span><span class="s3">\n    </span><span class="s1">[key: string]: string</span><span class="s3">\n  </span><span class="s1">}&gt;</span><span class="s3">\n\n  </span><span class="s1">body: any</span><span class="s3">\n\n  </span><span class="s1">env: Env</span><span class="s3">\n\n  </span><span class="s1">draftMode?: boolean</span><span class="s3">\n\n  </span><span class="s1">preview?: boolean</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Preview data set on the request, if any</span><span class="s3">\n   </span><span class="s1">* */</span><span class="s3">\n  </span><span class="s1">previewData?: PreviewData</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Send body of response</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">type Send&lt;T&gt; = (body: T) =&gt; void</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Next `API` route response</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export type NextApiResponse&lt;Data = any&gt; = ServerResponse &amp; {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Send data `any` data in response</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">send: Send&lt;Data&gt;</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Send data `json` data in response</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">json: Send&lt;Data&gt;</span><span class="s3">\n  </span><span class="s1">status: (statusCode: number) =&gt; NextApiResponse&lt;Data&gt;</span><span class="s3">\n  </span><span class="s1">redirect(url: string): NextApiResponse&lt;Data&gt;</span><span class="s3">\n  </span><span class="s1">redirect(status: number, url: string): NextApiResponse&lt;Data&gt;</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Set draft mode</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">setDraftMode: (options: { enable: boolean }) =&gt; NextApiResponse&lt;Data&gt;</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Set preview data for Next.js' prerender mode</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">setPreviewData: (</span><span class="s3">\n    </span><span class="s1">data: object | string,</span><span class="s3">\n    </span><span class="s1">options?: {</span><span class="s3">\n      </span><span class="s1">/**</span><span class="s3">\n       </span><span class="s1">* Specifies the number (in seconds) for the preview session to last for.</span><span class="s3">\n       </span><span class="s1">* The given number will be converted to an integer by rounding down.</span><span class="s3">\n       </span><span class="s1">* By default, no maximum age is set and the preview session finishes</span><span class="s3">\n       </span><span class="s1">* when the client shuts down (browser is closed).</span><span class="s3">\n       </span><span class="s1">*/</span><span class="s3">\n      </span><span class="s1">maxAge?: number</span><span class="s3">\n      </span><span class="s1">/**</span><span class="s3">\n       </span><span class="s1">* Specifies the path for the preview session to work under. By default,</span><span class="s3">\n       </span><span class="s1">* the path is considered the </span><span class="s3">\&quot;</span><span class="s1">default path</span><span class="s3">\&quot;</span><span class="s1">, i.e., any pages under </span><span class="s3">\&quot;</span><span class="s1">/</span><span class="s3">\&quot;</span><span class="s1">.</span><span class="s3">\n       </span><span class="s1">*/</span><span class="s3">\n      </span><span class="s1">path?: string</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">) =&gt; NextApiResponse&lt;Data&gt;</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Clear preview data for Next.js' prerender mode</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">clearPreviewData: (options?: { path?: string }) =&gt; NextApiResponse&lt;Data&gt;</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Revalidate a specific page and regenerate it using On-Demand Incremental</span><span class="s3">\n   </span><span class="s1">* Static Regeneration.</span><span class="s3">\n   </span><span class="s1">* The path should be an actual path, not a rewritten path. E.g. for</span><span class="s3">\n   </span><span class="s1">* </span><span class="s3">\&quot;</span><span class="s1">/blog/[slug]</span><span class="s3">\&quot; </span><span class="s1">this should be </span><span class="s3">\&quot;</span><span class="s1">/blog/post-1</span><span class="s3">\&quot;</span><span class="s1">.</span><span class="s3">\n   </span><span class="s1">* @link https://nextjs.org/docs/app/building-your-application/data-fetching/incremental-static-regeneration#on-demand-revalidation-with-revalidatepath</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">revalidate: (</span><span class="s3">\n    </span><span class="s1">urlPath: string,</span><span class="s3">\n    </span><span class="s1">opts?: {</span><span class="s3">\n      </span><span class="s1">unstable_onlyGenerated?: boolean</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">) =&gt; Promise&lt;void&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Next `API` route handler</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export type NextApiHandler&lt;T = any&gt; = (</span><span class="s3">\n  </span><span class="s1">req: NextApiRequest,</span><span class="s3">\n  </span><span class="s1">res: NextApiResponse&lt;T&gt;</span><span class="s3">\n</span><span class="s1">) =&gt; unknown | Promise&lt;unknown&gt;</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Utils</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function execOnce&lt;T extends (...args: any[]) =&gt; ReturnType&lt;T&gt;&gt;(</span><span class="s3">\n  </span><span class="s1">fn: T</span><span class="s3">\n</span><span class="s1">): T {</span><span class="s3">\n  </span><span class="s1">let used = false</span><span class="s3">\n  </span><span class="s1">let result: ReturnType&lt;T&gt;</span><span class="s3">\n\n  </span><span class="s1">return ((...args: any[]) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (!used) {</span><span class="s3">\n      </span><span class="s1">used = true</span><span class="s3">\n      </span><span class="s1">result = fn(...args)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return result</span><span class="s3">\n  </span><span class="s1">}) as T</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Scheme: https://tools.ietf.org/html/rfc3986#section-3.1</span><span class="s3">\n</span><span class="s1">// Absolute URL: https://tools.ietf.org/html/rfc3986#section-4.3</span><span class="s3">\n</span><span class="s1">const ABSOLUTE_URL_REGEX = /^[a-zA-Z][a-zA-Z</span><span class="s3">\\</span><span class="s1">d+</span><span class="s3">\\</span><span class="s1">-.]*?:/</span><span class="s3">\n</span><span class="s1">export const isAbsoluteUrl = (url: string) =&gt; ABSOLUTE_URL_REGEX.test(url)</span><span class="s3">\n\n</span><span class="s1">export function getLocationOrigin() {</span><span class="s3">\n  </span><span class="s1">const { protocol, hostname, port } = window.location</span><span class="s3">\n  </span><span class="s1">return `${protocol}//${hostname}${port ? ':' + port : ''}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getURL() {</span><span class="s3">\n  </span><span class="s1">const { href } = window.location</span><span class="s3">\n  </span><span class="s1">const origin = getLocationOrigin()</span><span class="s3">\n  </span><span class="s1">return href.substring(origin.length)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getDisplayName&lt;P&gt;(Component: ComponentType&lt;P&gt;) {</span><span class="s3">\n  </span><span class="s1">return typeof Component === 'string'</span><span class="s3">\n    </span><span class="s1">? Component</span><span class="s3">\n    </span><span class="s1">: Component.displayName || Component.name || 'Unknown'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isResSent(res: ServerResponse) {</span><span class="s3">\n  </span><span class="s1">return res.finished || res.headersSent</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function normalizeRepeatedSlashes(url: string) {</span><span class="s3">\n  </span><span class="s1">const urlParts = url.split('?')</span><span class="s3">\n  </span><span class="s1">const urlNoQuery = urlParts[0]</span><span class="s3">\n\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">urlNoQuery</span><span class="s3">\n      </span><span class="s1">// first we replace any non-encoded backslashes with forward</span><span class="s3">\n      </span><span class="s1">// then normalize repeated forward slashes</span><span class="s3">\n      </span><span class="s1">.replace(/</span><span class="s3">\\\\</span><span class="s1">/g, '/')</span><span class="s3">\n      </span><span class="s1">.replace(/</span><span class="s3">\\</span><span class="s1">/</span><span class="s3">\\</span><span class="s1">/+/g, '/') +</span><span class="s3">\n    </span><span class="s1">(urlParts[1] ? `?${urlParts.slice(1).join('?')}` : '')</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function loadGetInitialProps&lt;</span><span class="s3">\n  </span><span class="s1">C extends BaseContext,</span><span class="s3">\n  </span><span class="s1">IP = {},</span><span class="s3">\n  </span><span class="s1">P = {},</span><span class="s3">\n</span><span class="s1">&gt;(App: NextComponentType&lt;C, IP, P&gt;, ctx: C): Promise&lt;IP&gt; {</span><span class="s3">\n  </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n    </span><span class="s1">if (App.prototype?.getInitialProps) {</span><span class="s3">\n      </span><span class="s1">const message = `</span><span class="s3">\&quot;</span><span class="s1">${getDisplayName(</span><span class="s3">\n        </span><span class="s1">App</span><span class="s3">\n      </span><span class="s1">)}.getInitialProps()</span><span class="s3">\&quot; </span><span class="s1">is defined as an instance method - visit https://nextjs.org/docs/messages/get-initial-props-as-an-instance-method for more information.`</span><span class="s3">\n      </span><span class="s1">throw new Error(message)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">// when called from _app `ctx` is nested in `ctx`</span><span class="s3">\n  </span><span class="s1">const res = ctx.res || (ctx.ctx &amp;&amp; ctx.ctx.res)</span><span class="s3">\n\n  </span><span class="s1">if (!App.getInitialProps) {</span><span class="s3">\n    </span><span class="s1">if (ctx.ctx &amp;&amp; ctx.Component) {</span><span class="s3">\n      </span><span class="s1">// @ts-ignore pageProps default</span><span class="s3">\n      </span><span class="s1">return {</span><span class="s3">\n        </span><span class="s1">pageProps: await loadGetInitialProps(ctx.Component, ctx.ctx),</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return {} as IP</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const props = await App.getInitialProps(ctx)</span><span class="s3">\n\n  </span><span class="s1">if (res &amp;&amp; isResSent(res)) {</span><span class="s3">\n    </span><span class="s1">return props</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!props) {</span><span class="s3">\n    </span><span class="s1">const message = `</span><span class="s3">\&quot;</span><span class="s1">${getDisplayName(</span><span class="s3">\n      </span><span class="s1">App</span><span class="s3">\n    </span><span class="s1">)}.getInitialProps()</span><span class="s3">\&quot; </span><span class="s1">should resolve to an object. But found </span><span class="s3">\&quot;</span><span class="s1">${props}</span><span class="s3">\&quot; </span><span class="s1">instead.`</span><span class="s3">\n    </span><span class="s1">throw new Error(message)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n    </span><span class="s1">if (Object.keys(props).length === 0 &amp;&amp; !ctx.ctx) {</span><span class="s3">\n      </span><span class="s1">console.warn(</span><span class="s3">\n        </span><span class="s1">`${getDisplayName(</span><span class="s3">\n          </span><span class="s1">App</span><span class="s3">\n        </span><span class="s1">)} returned an empty object from </span><span class="s3">\\</span><span class="s1">`getInitialProps</span><span class="s3">\\</span><span class="s1">`. This de-optimizes and prevents automatic static optimization. https://nextjs.org/docs/messages/empty-object-getInitialProps`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return props</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const SP = typeof performance !== 'undefined'</span><span class="s3">\n</span><span class="s1">export const ST =</span><span class="s3">\n  </span><span class="s1">SP &amp;&amp;</span><span class="s3">\n  </span><span class="s1">(['mark', 'measure', 'getEntriesByName'] as const).every(</span><span class="s3">\n    </span><span class="s1">(method) =&gt; typeof performance[method] === 'function'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n</span><span class="s1">export class DecodeError extends Error {}</span><span class="s3">\n</span><span class="s1">export class NormalizeError extends Error {}</span><span class="s3">\n</span><span class="s1">export class PageNotFoundError extends Error {</span><span class="s3">\n  </span><span class="s1">code: string</span><span class="s3">\n\n  </span><span class="s1">constructor(page: string) {</span><span class="s3">\n    </span><span class="s1">super()</span><span class="s3">\n    </span><span class="s1">this.code = 'ENOENT'</span><span class="s3">\n    </span><span class="s1">this.name = 'PageNotFoundError'</span><span class="s3">\n    </span><span class="s1">this.message = `Cannot find module for page: ${page}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class MissingStaticPage extends Error {</span><span class="s3">\n  </span><span class="s1">constructor(page: string, message: string) {</span><span class="s3">\n    </span><span class="s1">super()</span><span class="s3">\n    </span><span class="s1">this.message = `Failed to load static file for page: ${page} ${message}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class MiddlewareNotFoundError extends Error {</span><span class="s3">\n  </span><span class="s1">code: string</span><span class="s3">\n  </span><span class="s1">constructor() {</span><span class="s3">\n    </span><span class="s1">super()</span><span class="s3">\n    </span><span class="s1">this.code = 'ENOENT'</span><span class="s3">\n    </span><span class="s1">this.message = `Cannot find the middleware module`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface CacheFs {</span><span class="s3">\n  </span><span class="s1">existsSync: typeof fs.existsSync</span><span class="s3">\n  </span><span class="s1">readFile: typeof fs.promises.readFile</span><span class="s3">\n  </span><span class="s1">readFileSync: typeof fs.readFileSync</span><span class="s3">\n  </span><span class="s1">writeFile(f: string, d: any): Promise&lt;void&gt;</span><span class="s3">\n  </span><span class="s1">mkdir(dir: string): Promise&lt;void | string&gt;</span><span class="s3">\n  </span><span class="s1">stat(f: string): Promise&lt;{ mtime: Date }&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function stringifyError(error: Error) {</span><span class="s3">\n  </span><span class="s1">return JSON.stringify({ message: error.message, stack: error.stack })</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;WEB_VITALS&quot;</span><span class="s0">,</span><span class="s1">&quot;execOnce&quot;</span><span class="s0">,</span><span class="s1">&quot;fn&quot;</span><span class="s0">,</span><span class="s1">&quot;used&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;ABSOLUTE_URL_REGEX&quot;</span><span class="s0">,</span><span class="s1">&quot;isAbsoluteUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;getLocationOrigin&quot;</span><span class="s0">,</span><span class="s1">&quot;protocol&quot;</span><span class="s0">,</span><span class="s1">&quot;hostname&quot;</span><span class="s0">,</span><span class="s1">&quot;port&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;location&quot;</span><span class="s0">,</span><span class="s1">&quot;getURL&quot;</span><span class="s0">,</span><span class="s1">&quot;href&quot;</span><span class="s0">,</span><span class="s1">&quot;origin&quot;</span><span class="s0">,</span><span class="s1">&quot;substring&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;getDisplayName&quot;</span><span class="s0">,</span><span class="s1">&quot;Component&quot;</span><span class="s0">,</span><span class="s1">&quot;displayName&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;isResSent&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;finished&quot;</span><span class="s0">,</span><span class="s1">&quot;headersSent&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeRepeatedSlashes&quot;</span><span class="s0">,</span><span class="s1">&quot;urlParts&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;urlNoQuery&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;loadGetInitialProps&quot;</span><span class="s0">,</span><span class="s1">&quot;App&quot;</span><span class="s0">,</span><span class="s1">&quot;ctx&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;prototype&quot;</span><span class="s0">,</span><span class="s1">&quot;getInitialProps&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;pageProps&quot;</span><span class="s0">,</span><span class="s1">&quot;props&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;warn&quot;</span><span class="s0">,</span><span class="s1">&quot;SP&quot;</span><span class="s0">,</span><span class="s1">&quot;performance&quot;</span><span class="s0">,</span><span class="s1">&quot;ST&quot;</span><span class="s0">,</span><span class="s1">&quot;every&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;DecodeError&quot;</span><span class="s0">,</span><span class="s1">&quot;NormalizeError&quot;</span><span class="s0">,</span><span class="s1">&quot;PageNotFoundError&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;code&quot;</span><span class="s0">,</span><span class="s1">&quot;MissingStaticPage&quot;</span><span class="s0">,</span><span class="s1">&quot;MiddlewareNotFoundError&quot;</span><span class="s0">,</span><span class="s1">&quot;stringifyError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;stack&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">874</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/lib/route-pattern-normalizer.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { Token } from 'next/dist/compiled/path-to-regexp'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Route pattern normalization utilities for path-to-regexp compatibility.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* path-to-regexp 6.3.0+ introduced stricter validation that rejects certain</span><span class="s3">\n </span><span class="s1">* patterns commonly used in Next.js interception routes. This module provides</span><span class="s3">\n </span><span class="s1">* normalization functions to make Next.js route patterns compatible with the</span><span class="s3">\n </span><span class="s1">* updated library while preserving all functionality.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Internal separator used to normalize adjacent parameter patterns.</span><span class="s3">\n </span><span class="s1">* This unique marker is inserted between adjacent parameters and stripped out</span><span class="s3">\n </span><span class="s1">* during parameter extraction to avoid conflicts with real URL content.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">const PARAM_SEPARATOR = '_NEXTSEP_'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Detects if a route pattern needs normalization for path-to-regexp compatibility.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function hasAdjacentParameterIssues(route: string): boolean {</span><span class="s3">\n  </span><span class="s1">if (typeof route !== 'string') return false</span><span class="s3">\n\n  </span><span class="s1">// Check for interception route markers followed immediately by parameters</span><span class="s3">\n  </span><span class="s1">// Pattern: /(.):param, /(..):param, /(...):param, /(.)(.):param etc.</span><span class="s3">\n  </span><span class="s1">// These patterns cause </span><span class="s3">\&quot;</span><span class="s1">Must have text between two parameters</span><span class="s3">\&quot; </span><span class="s1">errors</span><span class="s3">\n  </span><span class="s1">if (/</span><span class="s3">\\</span><span class="s1">/</span><span class="s3">\\</span><span class="s1">(</span><span class="s3">\\</span><span class="s1">.{1,3}</span><span class="s3">\\</span><span class="s1">):[^/</span><span class="s3">\\</span><span class="s1">s]+/.test(route)) {</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Check for basic adjacent parameters without separators</span><span class="s3">\n  </span><span class="s1">// Pattern: :param1:param2 (but not :param* or other URL patterns)</span><span class="s3">\n  </span><span class="s1">if (/:[a-zA-Z_][a-zA-Z0-9_]*:[a-zA-Z_][a-zA-Z0-9_]*/.test(route)) {</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Normalizes route patterns that have adjacent parameters without text between them.</span><span class="s3">\n </span><span class="s1">* Inserts a unique separator that can be safely stripped out later.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeAdjacentParameters(route: string): string {</span><span class="s3">\n  </span><span class="s1">let normalized = route</span><span class="s3">\n\n  </span><span class="s1">// Handle interception route patterns: (.):param -&gt; (.)_NEXTSEP_:param</span><span class="s3">\n  </span><span class="s1">normalized = normalized.replace(</span><span class="s3">\n    </span><span class="s1">/(</span><span class="s3">\\</span><span class="s1">([^)]*</span><span class="s3">\\</span><span class="s1">)):([^/</span><span class="s3">\\</span><span class="s1">s]+)/g,</span><span class="s3">\n    </span><span class="s1">`$1${PARAM_SEPARATOR}:$2`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">// Handle other adjacent parameter patterns: :param1:param2 -&gt; :param1_NEXTSEP_:param2</span><span class="s3">\n  </span><span class="s1">normalized = normalized.replace(/:([^:/</span><span class="s3">\\</span><span class="s1">s)]+)(?=:)/g, `:$1${PARAM_SEPARATOR}`)</span><span class="s3">\n\n  </span><span class="s1">return normalized</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Normalizes tokens that have repeating modifiers (* or +) but empty prefix and suffix.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* path-to-regexp 6.3.0+ introduced validation that throws:</span><span class="s3">\n </span><span class="s1">* </span><span class="s3">\&quot;</span><span class="s1">Can not repeat without prefix/suffix</span><span class="s3">\&quot;\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This occurs when a token has modifier: '*' or '+' with both prefix: '' and suffix: ''</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeTokensForRegexp(tokens: Token[]): Token[] {</span><span class="s3">\n  </span><span class="s1">return tokens.map((token) =&gt; {</span><span class="s3">\n    </span><span class="s1">// Token union type: Token = string | TokenObject</span><span class="s3">\n    </span><span class="s1">// Literal path segments are strings, parameters/wildcards are objects</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">typeof token === 'object' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">token !== null &amp;&amp;</span><span class="s3">\n      </span><span class="s1">// Not all token objects have 'modifier' property (e.g., simple text tokens)</span><span class="s3">\n      </span><span class="s1">'modifier' in token &amp;&amp;</span><span class="s3">\n      </span><span class="s1">// Only repeating modifiers (* or +) cause the validation error</span><span class="s3">\n      </span><span class="s1">// Other modifiers like '?' (optional) are fine</span><span class="s3">\n      </span><span class="s1">(token.modifier === '*' || token.modifier === '+') &amp;&amp;</span><span class="s3">\n      </span><span class="s1">// Token objects can have different shapes depending on route pattern</span><span class="s3">\n      </span><span class="s1">'prefix' in token &amp;&amp;</span><span class="s3">\n      </span><span class="s1">'suffix' in token &amp;&amp;</span><span class="s3">\n      </span><span class="s1">// Both prefix and suffix must be empty strings</span><span class="s3">\n      </span><span class="s1">// This is what causes the validation error in path-to-regexp</span><span class="s3">\n      </span><span class="s1">token.prefix === '' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">token.suffix === ''</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">// Add minimal prefix to satisfy path-to-regexp validation</span><span class="s3">\n      </span><span class="s1">// We use '/' as it's the most common path delimiter and won't break route matching</span><span class="s3">\n      </span><span class="s1">// The prefix gets used in regex generation but doesn't affect parameter extraction</span><span class="s3">\n      </span><span class="s1">return {</span><span class="s3">\n        </span><span class="s1">...token,</span><span class="s3">\n        </span><span class="s1">prefix: '/',</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return token</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Strips normalization separators from extracted route parameters.</span><span class="s3">\n </span><span class="s1">* Used by both server and client code to clean up parameters after route matching.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function stripParameterSeparators(</span><span class="s3">\n  </span><span class="s1">params: Record&lt;string, any&gt;</span><span class="s3">\n</span><span class="s1">): Record&lt;string, any&gt; {</span><span class="s3">\n  </span><span class="s1">const cleaned: Record&lt;string, any&gt; = {}</span><span class="s3">\n\n  </span><span class="s1">for (const [key, value] of Object.entries(params)) {</span><span class="s3">\n    </span><span class="s1">if (typeof value === 'string') {</span><span class="s3">\n      </span><span class="s1">// Remove the separator if it appears at the start of parameter values</span><span class="s3">\n      </span><span class="s1">cleaned[key] = value.replace(new RegExp(`^${PARAM_SEPARATOR}`), '')</span><span class="s3">\n    </span><span class="s1">} else if (Array.isArray(value)) {</span><span class="s3">\n      </span><span class="s1">// Handle array parameters (from repeated route segments)</span><span class="s3">\n      </span><span class="s1">cleaned[key] = value.map((item) =&gt;</span><span class="s3">\n        </span><span class="s1">typeof item === 'string'</span><span class="s3">\n          </span><span class="s1">? item.replace(new RegExp(`^${PARAM_SEPARATOR}`), '')</span><span class="s3">\n          </span><span class="s1">: item</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">cleaned[key] = value</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return cleaned</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;PARAM_SEPARATOR&quot;</span><span class="s0">,</span><span class="s1">&quot;hasAdjacentParameterIssues&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAdjacentParameters&quot;</span><span class="s0">,</span><span class="s1">&quot;normalized&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeTokensForRegexp&quot;</span><span class="s0">,</span><span class="s1">&quot;tokens&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;token&quot;</span><span class="s0">,</span><span class="s1">&quot;modifier&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;suffix&quot;</span><span class="s0">,</span><span class="s1">&quot;stripParameterSeparators&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;cleaned&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;item&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAEA;;;;;;;CAOC,GAED;;;;CAIC;;;;;;;;;;AACD,MAAMA,kBAAkB;AAKjB,SAASC,2BAA2BC,KAAa;IACtD,IAAI,OAAOA,UAAU,UAAU,OAAO;IAEtC,0EAA0E;IAC1E,qEAAqE;IACrE,sEAAsE;IACtE,IAAI,wBAAwBC,IAAI,CAACD,QAAQ;QACvC,OAAO;IACT;IAEA,yDAAyD;IACzD,kEAAkE;IAClE,IAAI,iDAAiDC,IAAI,CAACD,QAAQ;QAChE,OAAO;IACT;IAEA,OAAO;AACT;AAMO,SAASE,4BAA4BF,KAAa;IACvD,IAAIG,aAAaH;IAEjB,sEAAsE;IACtEG,aAAaA,WAAWC,OAAO,CAC7B,0BACA,CAAC,EAAE,EAAEN,gBAAgB,GAAG,CAAC;IAG3B,sFAAsF;IACtFK,aAAaA,WAAWC,OAAO,CAAC,sBAAsB,CAAC,GAAG,EAAEN,iBAAiB;IAE7E,OAAOK;AACT;AAUO,SAASE,yBAAyBC,MAAe;IACtD,OAAOA,OAAOC,GAAG,CAAC,CAACC;QACjB,iDAAiD;QACjD,sEAAsE;QACtE,IACE,OAAOA,UAAU,YACjBA,UAAU,QACV,4EAA4E;QAC5E,cAAcA,SACd,+DAA+D;QAC/D,+CAA+C;QAC9CA,CAAAA,MAAMC,QAAQ,KAAK,OAAOD,MAAMC,QAAQ,KAAK,GAAE,KAChD,qEAAqE;QACrE,YAAYD,SACZ,YAAYA,SACZ,+CAA+C;QAC/C,6DAA6D;QAC7DA,MAAME,MAAM,KAAK,MACjBF,MAAMG,MAAM,KAAK,IACjB;YACA,0DAA0D;YAC1D,mFAAmF;YACnF,mFAAmF;YACnF,OAAO;gBACL,GAAGH,KAAK;gBACRE,QAAQ;YACV;QACF;QACA,OAAOF;IACT;AACF;AAMO,SAASI,yBACdC,MAA2B;IAE3B,MAAMC,UAA+B,CAAC;IAEtC,KAAK,MAAM,CAACC,KAAKC,MAAM,IAAIC,OAAOC,OAAO,CAACL,QAAS;QACjD,IAAI,OAAOG,UAAU,UAAU;YAC7B,sEAAsE;YACtEF,OAAO,CAACC,IAAI,GAAGC,MAAMZ,OAAO,CAAC,IAAIe,OAAO,CAAC,CAAC,EAAErB,iBAAiB,GAAG;QAClE,OAAO,IAAIsB,MAAMC,OAAO,CAACL,QAAQ;YAC/B,yDAAyD;YACzDF,OAAO,CAACC,IAAI,GAAGC,MAAMT,GAAG,CAAC,CAACe,OACxB,OAAOA,SAAS,WACZA,KAAKlB,OAAO,CAAC,IAAIe,OAAO,CAAC,CAAC,EAAErB,iBAAiB,GAAG,MAChDwB;QAER,OAAO;YACLR,OAAO,CAACC,IAAI,GAAGC;QACjB;IACF;IAEA,OAAOF;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">960</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/route-match-utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Client-safe utilities for route matching that don't import server-side</span><span class="s3">\n </span><span class="s1">* utilities to avoid bundling issues with Turbopack</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">Key,</span><span class="s3">\n  </span><span class="s1">TokensToRegexpOptions,</span><span class="s3">\n  </span><span class="s1">ParseOptions,</span><span class="s3">\n  </span><span class="s1">TokensToFunctionOptions,</span><span class="s3">\n</span><span class="s1">} from 'next/dist/compiled/path-to-regexp'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">pathToRegexp,</span><span class="s3">\n  </span><span class="s1">compile,</span><span class="s3">\n  </span><span class="s1">regexpToFunction,</span><span class="s3">\n</span><span class="s1">} from 'next/dist/compiled/path-to-regexp'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">hasAdjacentParameterIssues,</span><span class="s3">\n  </span><span class="s1">normalizeAdjacentParameters,</span><span class="s3">\n  </span><span class="s1">stripParameterSeparators,</span><span class="s3">\n</span><span class="s1">} from '../../../../lib/route-pattern-normalizer'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Client-safe wrapper around pathToRegexp that handles path-to-regexp 6.3.0+ validation errors.</span><span class="s3">\n </span><span class="s1">* This includes both </span><span class="s3">\&quot;</span><span class="s1">Can not repeat without prefix/suffix</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">Must have text between parameters</span><span class="s3">\&quot; </span><span class="s1">errors.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function safePathToRegexp(</span><span class="s3">\n  </span><span class="s1">route: string | RegExp | Array&lt;string | RegExp&gt;,</span><span class="s3">\n  </span><span class="s1">keys?: Key[],</span><span class="s3">\n  </span><span class="s1">options?: TokensToRegexpOptions &amp; ParseOptions</span><span class="s3">\n</span><span class="s1">): RegExp {</span><span class="s3">\n  </span><span class="s1">if (typeof route !== 'string') {</span><span class="s3">\n    </span><span class="s1">return pathToRegexp(route, keys, options)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Check if normalization is needed and cache the result</span><span class="s3">\n  </span><span class="s1">const needsNormalization = hasAdjacentParameterIssues(route)</span><span class="s3">\n  </span><span class="s1">const routeToUse = needsNormalization</span><span class="s3">\n    </span><span class="s1">? normalizeAdjacentParameters(route)</span><span class="s3">\n    </span><span class="s1">: route</span><span class="s3">\n\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">return pathToRegexp(routeToUse, keys, options)</span><span class="s3">\n  </span><span class="s1">} catch (error) {</span><span class="s3">\n    </span><span class="s1">// Only try normalization if we haven't already normalized</span><span class="s3">\n    </span><span class="s1">if (!needsNormalization) {</span><span class="s3">\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">const normalizedRoute = normalizeAdjacentParameters(route)</span><span class="s3">\n        </span><span class="s1">return pathToRegexp(normalizedRoute, keys, options)</span><span class="s3">\n      </span><span class="s1">} catch (retryError) {</span><span class="s3">\n        </span><span class="s1">// If that doesn't work, fall back to original error</span><span class="s3">\n        </span><span class="s1">throw error</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">throw error</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Client-safe wrapper around compile that handles path-to-regexp 6.3.0+ validation errors.</span><span class="s3">\n </span><span class="s1">* No server-side error reporting to avoid bundling issues.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function safeCompile(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">options?: TokensToFunctionOptions &amp; ParseOptions</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">// Check if normalization is needed and cache the result</span><span class="s3">\n  </span><span class="s1">const needsNormalization = hasAdjacentParameterIssues(route)</span><span class="s3">\n  </span><span class="s1">const routeToUse = needsNormalization</span><span class="s3">\n    </span><span class="s1">? normalizeAdjacentParameters(route)</span><span class="s3">\n    </span><span class="s1">: route</span><span class="s3">\n\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">return compile(routeToUse, options)</span><span class="s3">\n  </span><span class="s1">} catch (error) {</span><span class="s3">\n    </span><span class="s1">// Only try normalization if we haven't already normalized</span><span class="s3">\n    </span><span class="s1">if (!needsNormalization) {</span><span class="s3">\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">const normalizedRoute = normalizeAdjacentParameters(route)</span><span class="s3">\n        </span><span class="s1">return compile(normalizedRoute, options)</span><span class="s3">\n      </span><span class="s1">} catch (retryError) {</span><span class="s3">\n        </span><span class="s1">// If that doesn't work, fall back to original error</span><span class="s3">\n        </span><span class="s1">throw error</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">throw error</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Client-safe wrapper around regexpToFunction that automatically cleans parameters.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function safeRegexpToFunction&lt;</span><span class="s3">\n  </span><span class="s1">T extends Record&lt;string, any&gt; = Record&lt;string, any&gt;,</span><span class="s3">\n</span><span class="s1">&gt;(regexp: RegExp, keys?: Key[]): (pathname: string) =&gt; { params: T } | false {</span><span class="s3">\n  </span><span class="s1">const originalMatcher = regexpToFunction&lt;T&gt;(regexp, keys || [])</span><span class="s3">\n\n  </span><span class="s1">return (pathname: string) =&gt; {</span><span class="s3">\n    </span><span class="s1">const result = originalMatcher(pathname)</span><span class="s3">\n    </span><span class="s1">if (!result) return false</span><span class="s3">\n\n    </span><span class="s1">// Clean parameters before returning</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">...result,</span><span class="s3">\n      </span><span class="s1">params: stripParameterSeparators(result.params as any) as T,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Safe wrapper for route matcher functions that automatically cleans parameters.</span><span class="s3">\n </span><span class="s1">* This is client-safe and doesn't import path-to-regexp.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function safeRouteMatcher&lt;T extends Record&lt;string, any&gt;&gt;(</span><span class="s3">\n  </span><span class="s1">matcherFn: (pathname: string) =&gt; false | T</span><span class="s3">\n</span><span class="s1">): (pathname: string) =&gt; false | T {</span><span class="s3">\n  </span><span class="s1">return (pathname: string) =&gt; {</span><span class="s3">\n    </span><span class="s1">const result = matcherFn(pathname)</span><span class="s3">\n    </span><span class="s1">if (!result) return false</span><span class="s3">\n\n    </span><span class="s1">// Clean parameters before returning</span><span class="s3">\n    </span><span class="s1">return stripParameterSeparators(result) as T</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;pathToRegexp&quot;</span><span class="s0">,</span><span class="s1">&quot;compile&quot;</span><span class="s0">,</span><span class="s1">&quot;regexpToFunction&quot;</span><span class="s0">,</span><span class="s1">&quot;hasAdjacentParameterIssues&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAdjacentParameters&quot;</span><span class="s0">,</span><span class="s1">&quot;stripParameterSeparators&quot;</span><span class="s0">,</span><span class="s1">&quot;safePathToRegexp&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;needsNormalization&quot;</span><span class="s0">,</span><span class="s1">&quot;routeToUse&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizedRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;retryError&quot;</span><span class="s0">,</span><span class="s1">&quot;safeCompile&quot;</span><span class="s0">,</span><span class="s1">&quot;safeRegexpToFunction&quot;</span><span class="s0">,</span><span class="s1">&quot;regexp&quot;</span><span class="s0">,</span><span class="s1">&quot;originalMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;safeRouteMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;matcherFn&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;CAGC;;;;;;;;;;AAQD,SACEA,YAAY,EACZC,OAAO,EACPC,gBAAgB,QACX,oCAAmC;AAC1C,SACEC,0BAA0B,EAC1BC,2BAA2B,EAC3BC,wBAAwB,QACnB,2CAA0C;;;AAM1C,SAASC,iBACdC,KAA+C,EAC/CC,IAAY,EACZC,OAA8C;IAE9C,IAAI,OAAOF,UAAU,UAAU;QAC7B,WAAOP,yLAAAA,EAAaO,OAAOC,MAAMC;IACnC;IAEA,wDAAwD;IACxD,MAAMC,yBAAqBP,0MAAAA,EAA2BI;IACtD,MAAMI,aAAaD,yBACfN,2MAAAA,EAA4BG,SAC5BA;IAEJ,IAAI;QACF,WAAOP,yLAAAA,EAAaW,YAAYH,MAAMC;IACxC,EAAE,OAAOG,OAAO;QACd,0DAA0D;QAC1D,IAAI,CAACF,oBAAoB;YACvB,IAAI;gBACF,MAAMG,sBAAkBT,2MAAAA,EAA4BG;gBACpD,WAAOP,yLAAAA,EAAaa,iBAAiBL,MAAMC;YAC7C,EAAE,OAAOK,YAAY;gBACnB,oDAAoD;gBACpD,MAAMF;YACR;QACF;QACA,MAAMA;IACR;AACF;AAMO,SAASG,YACdR,KAAa,EACbE,OAAgD;IAEhD,wDAAwD;IACxD,MAAMC,yBAAqBP,0MAAAA,EAA2BI;IACtD,MAAMI,aAAaD,yBACfN,2MAAAA,EAA4BG,SAC5BA;IAEJ,IAAI;QACF,WAAON,oLAAAA,EAAQU,YAAYF;IAC7B,EAAE,OAAOG,OAAO;QACd,0DAA0D;QAC1D,IAAI,CAACF,oBAAoB;YACvB,IAAI;gBACF,MAAMG,sBAAkBT,2MAAAA,EAA4BG;gBACpD,WAAON,oLAAAA,EAAQY,iBAAiBJ;YAClC,EAAE,OAAOK,YAAY;gBACnB,oDAAoD;gBACpD,MAAMF;YACR;QACF;QACA,MAAMA;IACR;AACF;AAKO,SAASI,qBAEdC,MAAc,EAAET,IAAY;IAC5B,MAAMU,sBAAkBhB,6LAAAA,EAAoBe,QAAQT,QAAQ,EAAE;IAE9D,OAAO,CAACW;QACN,MAAMC,SAASF,gBAAgBC;QAC/B,IAAI,CAACC,QAAQ,OAAO;QAEpB,oCAAoC;QACpC,OAAO;YACL,GAAGA,MAAM;YACTC,YAAQhB,wMAAAA,EAAyBe,OAAOC,MAAM;QAChD;IACF;AACF;AAMO,SAASC,iBACdC,SAA0C;IAE1C,OAAO,CAACJ;QACN,MAAMC,SAASG,UAAUJ;QACzB,IAAI,CAACC,QAAQ,OAAO;QAEpB,oCAAoC;QACpC,WAAOf,wMAAAA,EAAyBe;IAClC;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1044</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/route-matcher.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { Group } from './route-regex'</span><span class="s3">\n</span><span class="s1">import { DecodeError } from '../../utils'</span><span class="s3">\n</span><span class="s1">import type { Params } from '../../../../server/request/params'</span><span class="s3">\n</span><span class="s1">import { safeRouteMatcher } from './route-match-utils'</span><span class="s3">\n\n</span><span class="s1">export interface RouteMatchFn {</span><span class="s3">\n  </span><span class="s1">(pathname: string): false | Params</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type RouteMatcherOptions = {</span><span class="s3">\n  </span><span class="s1">// We only use the exec method of the RegExp object. This helps us avoid using</span><span class="s3">\n  </span><span class="s1">// type assertions that the passed in properties are of the correct type.</span><span class="s3">\n  </span><span class="s1">re: Pick&lt;RegExp, 'exec'&gt;</span><span class="s3">\n  </span><span class="s1">groups: Record&lt;string, Group&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getRouteMatcher({</span><span class="s3">\n  </span><span class="s1">re,</span><span class="s3">\n  </span><span class="s1">groups,</span><span class="s3">\n</span><span class="s1">}: RouteMatcherOptions): RouteMatchFn {</span><span class="s3">\n  </span><span class="s1">const rawMatcher = (pathname: string) =&gt; {</span><span class="s3">\n    </span><span class="s1">const routeMatch = re.exec(pathname)</span><span class="s3">\n    </span><span class="s1">if (!routeMatch) return false</span><span class="s3">\n\n    </span><span class="s1">const decode = (param: string) =&gt; {</span><span class="s3">\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">return decodeURIComponent(param)</span><span class="s3">\n      </span><span class="s1">} catch {</span><span class="s3">\n        </span><span class="s1">throw new DecodeError('failed to decode param')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const params: Params = {}</span><span class="s3">\n    </span><span class="s1">for (const [key, group] of Object.entries(groups)) {</span><span class="s3">\n      </span><span class="s1">const match = routeMatch[group.pos]</span><span class="s3">\n      </span><span class="s1">if (match !== undefined) {</span><span class="s3">\n        </span><span class="s1">if (group.repeat) {</span><span class="s3">\n          </span><span class="s1">params[key] = match.split('/').map((entry) =&gt; decode(entry))</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">params[key] = decode(match)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return params</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Wrap with safe matcher to handle parameter cleaning</span><span class="s3">\n  </span><span class="s1">return safeRouteMatcher(rawMatcher)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;DecodeError&quot;</span><span class="s0">,</span><span class="s1">&quot;safeRouteMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;getRouteMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;re&quot;</span><span class="s0">,</span><span class="s1">&quot;groups&quot;</span><span class="s0">,</span><span class="s1">&quot;rawMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;routeMatch&quot;</span><span class="s0">,</span><span class="s1">&quot;exec&quot;</span><span class="s0">,</span><span class="s1">&quot;decode&quot;</span><span class="s0">,</span><span class="s1">&quot;param&quot;</span><span class="s0">,</span><span class="s1">&quot;decodeURIComponent&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;group&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;match&quot;</span><span class="s0">,</span><span class="s1">&quot;pos&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;repeat&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;entry&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AACA,SAASA,WAAW,QAAQ,cAAa;AAEzC,SAASC,gBAAgB,QAAQ,sBAAqB;;;AAa/C,SAASC,gBAAgB,KAGV;IAHU,IAAA,EAC9BC,EAAE,EACFC,MAAM,EACc,GAHU;IAI9B,MAAMC,aAAa,CAACC;QAClB,MAAMC,aAAaJ,GAAGK,IAAI,CAACF;QAC3B,IAAI,CAACC,YAAY,OAAO;QAExB,MAAME,SAAS,CAACC;YACd,IAAI;gBACF,OAAOC,mBAAmBD;YAC5B,EAAE,OAAA,GAAM;gBACN,MAAM,OAAA,cAAyC,CAAzC,IAAIV,4KAAAA,CAAY,2BAAhB,qBAAA;2BAAA;gCAAA;kCAAA;gBAAwC;YAChD;QACF;QAEA,MAAMY,SAAiB,CAAC;QACxB,KAAK,MAAM,CAACC,KAAKC,MAAM,IAAIC,OAAOC,OAAO,CAACZ,QAAS;YACjD,MAAMa,QAAQV,UAAU,CAACO,MAAMI,GAAG,CAAC;YACnC,IAAID,UAAUE,WAAW;gBACvB,IAAIL,MAAMM,MAAM,EAAE;oBAChBR,MAAM,CAACC,IAAI,GAAGI,MAAMI,KAAK,CAAC,KAAKC,GAAG,CAAC,CAACC,QAAUd,OAAOc;gBACvD,OAAO;oBACLX,MAAM,CAACC,IAAI,GAAGJ,OAAOQ;gBACvB;YACF;QACF;QAEA,OAAOL;IACT;IAEA,sDAAsD;IACtD,WAAOX,sNAAAA,EAAiBI;AAC1B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1088</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/page-path/ensure-leading-slash.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* For a given page path, this function ensures that there is a leading slash.</span><span class="s3">\n </span><span class="s1">* If there is not a leading slash, one is added, otherwise it is noop.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function ensureLeadingSlash(path: string) {</span><span class="s3">\n  </span><span class="s1">return path.startsWith('/') ? path : `/${path}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ensureLeadingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;CAGC,GACD;;;;AAAO,SAASA,mBAAmBC,IAAY;IAC7C,OAAOA,KAAKC,UAAU,CAAC,OAAOD,OAAQ,MAAGA;AAC3C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1102</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/app-paths.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { ensureLeadingSlash } from '../../page-path/ensure-leading-slash'</span><span class="s3">\n</span><span class="s1">import { isGroupSegment } from '../../segment'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Normalizes an app route so it represents the actual request path. Essentially</span><span class="s3">\n </span><span class="s1">* performing the following transformations:</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/user/[id]/page` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/account/page` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/user/[id]/page` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/account/page` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/page` to `/`</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/user/[id]/route` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/account/route` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/user/[id]/route` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/account/route` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/route` to `/`</span><span class="s3">\n </span><span class="s1">* - `/` to `/`</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param route the app route to normalize</span><span class="s3">\n </span><span class="s1">* @returns the normalized pathname</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeAppPath(route: string) {</span><span class="s3">\n  </span><span class="s1">return ensureLeadingSlash(</span><span class="s3">\n    </span><span class="s1">route.split('/').reduce((pathname, segment, index, segments) =&gt; {</span><span class="s3">\n      </span><span class="s1">// Empty segments are ignored.</span><span class="s3">\n      </span><span class="s1">if (!segment) {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Groups are ignored.</span><span class="s3">\n      </span><span class="s1">if (isGroupSegment(segment)) {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Parallel segments are ignored.</span><span class="s3">\n      </span><span class="s1">if (segment[0] === '@') {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// The last segment (if it's a leaf) should be ignored.</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">(segment === 'page' || segment === 'route') &amp;&amp;</span><span class="s3">\n        </span><span class="s1">index === segments.length - 1</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return `${pathname}/${segment}`</span><span class="s3">\n    </span><span class="s1">}, '')</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Strips the `.rsc` extension if it's in the pathname.</span><span class="s3">\n </span><span class="s1">* Since this function is used on full urls it checks `?` for searchParams handling.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeRscURL(url: string) {</span><span class="s3">\n  </span><span class="s1">return url.replace(</span><span class="s3">\n    </span><span class="s1">/</span><span class="s3">\\</span><span class="s1">.rsc($|</span><span class="s3">\\</span><span class="s1">?)/,</span><span class="s3">\n    </span><span class="s1">// $1 ensures `?` is preserved</span><span class="s3">\n    </span><span class="s1">'$1'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ensureLeadingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;isGroupSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;reduce&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;segments&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeRscURL&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAAA,SAASA,kBAAkB,QAAQ,uCAAsC;AACzE,SAASC,cAAc,QAAQ,gBAAe;;;AAqBvC,SAASC,iBAAiBC,KAAa;IAC5C,WAAOH,wNAAAA,EACLG,MAAMC,KAAK,CAAC,KAAKC,MAAM,CAAC,CAACC,UAAUC,SAASC,OAAOC;QACjD,8BAA8B;QAC9B,IAAI,CAACF,SAAS;YACZ,OAAOD;QACT;QAEA,sBAAsB;QACtB,QAAIL,iLAAAA,EAAeM,UAAU;YAC3B,OAAOD;QACT;QAEA,iCAAiC;QACjC,IAAIC,OAAO,CAAC,EAAE,KAAK,KAAK;YACtB,OAAOD;QACT;QAEA,uDAAuD;QACvD,IACGC,CAAAA,YAAY,UAAUA,YAAY,OAAM,KACzCC,UAAUC,SAASC,MAAM,GAAG,GAC5B;YACA,OAAOJ;QACT;QAEA,OAAUA,WAAS,MAAGC;IACxB,GAAG;AAEP;AAMO,SAASI,gBAAgBC,GAAW;IACzC,OAAOA,IAAIC,OAAO,CAChB,eACA,AACA,8BAD8B;AAGlC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1140</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/interception-routes.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { normalizeAppPath } from './app-paths'</span><span class="s3">\n\n</span><span class="s1">// order matters here, the first match will be used</span><span class="s3">\n</span><span class="s1">export const INTERCEPTION_ROUTE_MARKERS = [</span><span class="s3">\n  </span><span class="s1">'(..)(..)',</span><span class="s3">\n  </span><span class="s1">'(.)',</span><span class="s3">\n  </span><span class="s1">'(..)',</span><span class="s3">\n  </span><span class="s1">'(...)',</span><span class="s3">\n</span><span class="s1">] as const</span><span class="s3">\n\n</span><span class="s1">export function isInterceptionRouteAppPath(path: string): boolean {</span><span class="s3">\n  </span><span class="s1">// TODO-APP: add more serious validation</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">path</span><span class="s3">\n      </span><span class="s1">.split('/')</span><span class="s3">\n      </span><span class="s1">.find((segment) =&gt;</span><span class="s3">\n        </span><span class="s1">INTERCEPTION_ROUTE_MARKERS.find((m) =&gt; segment.startsWith(m))</span><span class="s3">\n      </span><span class="s1">) !== undefined</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function extractInterceptionRouteInformation(path: string) {</span><span class="s3">\n  </span><span class="s1">let interceptingRoute: string | undefined,</span><span class="s3">\n    </span><span class="s1">marker: (typeof INTERCEPTION_ROUTE_MARKERS)[number] | undefined,</span><span class="s3">\n    </span><span class="s1">interceptedRoute: string | undefined</span><span class="s3">\n\n  </span><span class="s1">for (const segment of path.split('/')) {</span><span class="s3">\n    </span><span class="s1">marker = INTERCEPTION_ROUTE_MARKERS.find((m) =&gt; segment.startsWith(m))</span><span class="s3">\n    </span><span class="s1">if (marker) {</span><span class="s3">\n      </span><span class="s1">;[interceptingRoute, interceptedRoute] = path.split(marker, 2)</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!interceptingRoute || !marker || !interceptedRoute) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Invalid interception route: ${path}. Must be in the format /&lt;intercepting route&gt;/(..|...|..)(..)/&lt;intercepted route&gt;`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">interceptingRoute = normalizeAppPath(interceptingRoute) // normalize the path, e.g. /(blog)/feed -&gt; /feed</span><span class="s3">\n\n  </span><span class="s1">switch (marker) {</span><span class="s3">\n    </span><span class="s1">case '(.)':</span><span class="s3">\n      </span><span class="s1">// (.) indicates that we should match with sibling routes, so we just need to append the intercepted route to the intercepting route</span><span class="s3">\n      </span><span class="s1">if (interceptingRoute === '/') {</span><span class="s3">\n        </span><span class="s1">interceptedRoute = `/${interceptedRoute}`</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">interceptedRoute = interceptingRoute + '/' + interceptedRoute</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">case '(..)':</span><span class="s3">\n      </span><span class="s1">// (..) indicates that we should match at one level up, so we need to remove the last segment of the intercepting route</span><span class="s3">\n      </span><span class="s1">if (interceptingRoute === '/') {</span><span class="s3">\n        </span><span class="s1">throw new Error(</span><span class="s3">\n          </span><span class="s1">`Invalid interception route: ${path}. Cannot use (..) marker at the root level, use (.) instead.`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">interceptedRoute = interceptingRoute</span><span class="s3">\n        </span><span class="s1">.split('/')</span><span class="s3">\n        </span><span class="s1">.slice(0, -1)</span><span class="s3">\n        </span><span class="s1">.concat(interceptedRoute)</span><span class="s3">\n        </span><span class="s1">.join('/')</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">case '(...)':</span><span class="s3">\n      </span><span class="s1">// (...) will match the route segment in the root directory, so we need to use the root directory to prepend the intercepted route</span><span class="s3">\n      </span><span class="s1">interceptedRoute = '/' + interceptedRoute</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">case '(..)(..)':</span><span class="s3">\n      </span><span class="s1">// (..)(..) indicates that we should match at two levels up, so we need to remove the last two segments of the intercepting route</span><span class="s3">\n\n      </span><span class="s1">const splitInterceptingRoute = interceptingRoute.split('/')</span><span class="s3">\n      </span><span class="s1">if (splitInterceptingRoute.length &lt;= 2) {</span><span class="s3">\n        </span><span class="s1">throw new Error(</span><span class="s3">\n          </span><span class="s1">`Invalid interception route: ${path}. Cannot use (..)(..) marker at the root level or one level up.`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">interceptedRoute = splitInterceptingRoute</span><span class="s3">\n        </span><span class="s1">.slice(0, -2)</span><span class="s3">\n        </span><span class="s1">.concat(interceptedRoute)</span><span class="s3">\n        </span><span class="s1">.join('/')</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">throw new Error('Invariant: unexpected marker')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return { interceptingRoute, interceptedRoute }</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;INTERCEPTION_ROUTE_MARKERS&quot;</span><span class="s0">,</span><span class="s1">&quot;isInterceptionRouteAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;find&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;m&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;extractInterceptionRouteInformation&quot;</span><span class="s0">,</span><span class="s1">&quot;interceptingRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;marker&quot;</span><span class="s0">,</span><span class="s1">&quot;interceptedRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;concat&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;splitInterceptingRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;AAAA,SAASA,gBAAgB,QAAQ,cAAa;;AAGvC,MAAMC,6BAA6B;IACxC;IACA;IACA;IACA;CACD,CAAS;AAEH,SAASC,2BAA2BC,IAAY;IACrD,wCAAwC;IACxC,OACEA,KACGC,KAAK,CAAC,KACNC,IAAI,CAAC,CAACC,UACLL,2BAA2BI,IAAI,CAAC,CAACE,IAAMD,QAAQE,UAAU,CAACD,SACtDE;AAEZ;AAEO,SAASC,oCAAoCP,IAAY;IAC9D,IAAIQ,mBACFC,QACAC;IAEF,KAAK,MAAMP,WAAWH,KAAKC,KAAK,CAAC,KAAM;QACrCQ,SAASX,2BAA2BI,IAAI,CAAC,CAACE,IAAMD,QAAQE,UAAU,CAACD;QACnE,IAAIK,QAAQ;;YACT,CAACD,mBAAmBE,iBAAiB,GAAGV,KAAKC,KAAK,CAACQ,QAAQ;YAC5D;QACF;IACF;IAEA,IAAI,CAACD,qBAAqB,CAACC,UAAU,CAACC,kBAAkB;QACtD,MAAM,OAAA,cAEL,CAFK,IAAIC,MACP,iCAA8BX,OAAK,sFADhC,qBAAA;mBAAA;wBAAA;0BAAA;QAEN;IACF;IAEAQ,wBAAoBX,2MAAAA,EAAiBW,mBAAmB,iDAAiD;;IAEzG,OAAQC;QACN,KAAK;YACH,oIAAoI;YACpI,IAAID,sBAAsB,KAAK;gBAC7BE,mBAAoB,MAAGA;YACzB,OAAO;gBACLA,mBAAmBF,oBAAoB,MAAME;YAC/C;YACA;QACF,KAAK;YACH,uHAAuH;YACvH,IAAIF,sBAAsB,KAAK;gBAC7B,MAAM,OAAA,cAEL,CAFK,IAAIG,MACP,iCAA8BX,OAAK,iEADhC,qBAAA;2BAAA;gCAAA;kCAAA;gBAEN;YACF;YACAU,mBAAmBF,kBAChBP,KAAK,CAAC,KACNW,KAAK,CAAC,GAAG,CAAC,GACVC,MAAM,CAACH,kBACPI,IAAI,CAAC;YACR;QACF,KAAK;YACH,kIAAkI;YAClIJ,mBAAmB,MAAMA;YACzB;QACF,KAAK;YACH,iIAAiI;YAEjI,MAAMK,yBAAyBP,kBAAkBP,KAAK,CAAC;YACvD,IAAIc,uBAAuBC,MAAM,IAAI,GAAG;gBACtC,MAAM,OAAA,cAEL,CAFK,IAAIL,MACP,iCAA8BX,OAAK,oEADhC,qBAAA;2BAAA;gCAAA;kCAAA;gBAEN;YACF;YAEAU,mBAAmBK,uBAChBH,KAAK,CAAC,GAAG,CAAC,GACVC,MAAM,CAACH,kBACPI,IAAI,CAAC;YACR;QACF;YACE,MAAM,OAAA,cAAyC,CAAzC,IAAIH,MAAM,iCAAV,qBAAA;uBAAA;4BAAA;8BAAA;YAAwC;IAClD;IAEA,OAAO;QAAEH;QAAmBE;IAAiB;AAC/C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1231</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/escape-regexp.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// regexp is based on https://github.com/sindresorhus/escape-string-regexp</span><span class="s3">\n</span><span class="s1">const reHasRegExp = /[|</span><span class="s3">\\\\</span><span class="s1">{}()[</span><span class="s3">\\</span><span class="s1">]^$+*?.-]/</span><span class="s3">\n</span><span class="s1">const reReplaceRegExp = /[|</span><span class="s3">\\\\</span><span class="s1">{}()[</span><span class="s3">\\</span><span class="s1">]^$+*?.-]/g</span><span class="s3">\n\n</span><span class="s1">export function escapeStringRegexp(str: string) {</span><span class="s3">\n  </span><span class="s1">// see also: https://github.com/lodash/lodash/blob/2da024c3b4f9947a48517639de7560457cd4ec6c/escapeRegExp.js#L23</span><span class="s3">\n  </span><span class="s1">if (reHasRegExp.test(str)) {</span><span class="s3">\n    </span><span class="s1">return str.replace(reReplaceRegExp, '</span><span class="s3">\\\\</span><span class="s1">$&amp;')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return str</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;reHasRegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;reReplaceRegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;escapeStringRegexp&quot;</span><span class="s0">,</span><span class="s1">&quot;str&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,0EAA0E;;;;;AAC1E,MAAMA,cAAc;AACpB,MAAMC,kBAAkB;AAEjB,SAASC,mBAAmBC,GAAW;IAC5C,+GAA+G;IAC/G,IAAIH,YAAYI,IAAI,CAACD,MAAM;QACzB,OAAOA,IAAIE,OAAO,CAACJ,iBAAiB;IACtC;IACA,OAAOE;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1249</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/get-dynamic-param.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { DynamicParam } from '../../../../server/app-render/app-render'</span><span class="s3">\n</span><span class="s1">import type { DynamicParamTypesShort } from '../../../../server/app-render/types'</span><span class="s3">\n</span><span class="s1">import type { FallbackRouteParams } from '../../../../server/request/fallback-params'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Shared logic on client and server for creating a dynamic param value.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This code needs to be shared with the client so it can extract dynamic route</span><span class="s3">\n </span><span class="s1">* params from the URL without a server request.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Because everything in this module is sent to the client, we should aim to</span><span class="s3">\n </span><span class="s1">* keep this code as simple as possible. The special case handling for catchall</span><span class="s3">\n </span><span class="s1">* and optional is, alas, unfortunate.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function getDynamicParam(</span><span class="s3">\n  </span><span class="s1">params: { [key: string]: any },</span><span class="s3">\n  </span><span class="s1">segmentKey: string,</span><span class="s3">\n  </span><span class="s1">dynamicParamType: DynamicParamTypesShort,</span><span class="s3">\n  </span><span class="s1">pagePath: string,</span><span class="s3">\n  </span><span class="s1">fallbackRouteParams: FallbackRouteParams | null</span><span class="s3">\n</span><span class="s1">): DynamicParam {</span><span class="s3">\n  </span><span class="s1">let value = params[segmentKey]</span><span class="s3">\n\n  </span><span class="s1">if (fallbackRouteParams &amp;&amp; fallbackRouteParams.has(segmentKey)) {</span><span class="s3">\n    </span><span class="s1">value = fallbackRouteParams.get(segmentKey)</span><span class="s3">\n  </span><span class="s1">} else if (Array.isArray(value)) {</span><span class="s3">\n    </span><span class="s1">value = value.map((i) =&gt; encodeURIComponent(i))</span><span class="s3">\n  </span><span class="s1">} else if (typeof value === 'string') {</span><span class="s3">\n    </span><span class="s1">value = encodeURIComponent(value)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!value) {</span><span class="s3">\n    </span><span class="s1">const isCatchall = dynamicParamType === 'c'</span><span class="s3">\n    </span><span class="s1">const isOptionalCatchall = dynamicParamType === 'oc'</span><span class="s3">\n\n    </span><span class="s1">if (isCatchall || isOptionalCatchall) {</span><span class="s3">\n      </span><span class="s1">// handle the case where an optional catchall does not have a value,</span><span class="s3">\n      </span><span class="s1">// e.g. `/dashboard/[[...slug]]` when requesting `/dashboard`</span><span class="s3">\n      </span><span class="s1">if (isOptionalCatchall) {</span><span class="s3">\n        </span><span class="s1">return {</span><span class="s3">\n          </span><span class="s1">param: segmentKey,</span><span class="s3">\n          </span><span class="s1">value: null,</span><span class="s3">\n          </span><span class="s1">type: dynamicParamType,</span><span class="s3">\n          </span><span class="s1">treeSegment: [segmentKey, '', dynamicParamType],</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// handle the case where a catchall or optional catchall does not have a value,</span><span class="s3">\n      </span><span class="s1">// e.g. `/foo/bar/hello` and `@slot/[...catchall]` or `@slot/[[...catchall]]` is matched</span><span class="s3">\n      </span><span class="s1">value = pagePath</span><span class="s3">\n        </span><span class="s1">.split('/')</span><span class="s3">\n        </span><span class="s1">// remove the first empty string</span><span class="s3">\n        </span><span class="s1">.slice(1)</span><span class="s3">\n        </span><span class="s1">// replace any dynamic params with the actual values</span><span class="s3">\n        </span><span class="s1">.flatMap((pathSegment) =&gt; {</span><span class="s3">\n          </span><span class="s1">const param = parseParameter(pathSegment)</span><span class="s3">\n          </span><span class="s1">// if the segment matches a param, return the param value</span><span class="s3">\n          </span><span class="s1">// otherwise, it's a static segment, so just return that</span><span class="s3">\n          </span><span class="s1">return params[param.key] ?? param.key</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n\n      </span><span class="s1">return {</span><span class="s3">\n        </span><span class="s1">param: segmentKey,</span><span class="s3">\n        </span><span class="s1">value,</span><span class="s3">\n        </span><span class="s1">type: dynamicParamType,</span><span class="s3">\n        </span><span class="s1">// This value always has to be a string.</span><span class="s3">\n        </span><span class="s1">treeSegment: [segmentKey, value.join('/'), dynamicParamType],</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">param: segmentKey,</span><span class="s3">\n    </span><span class="s1">// The value that is passed to user code.</span><span class="s3">\n    </span><span class="s1">value: value,</span><span class="s3">\n    </span><span class="s1">// The value that is rendered in the router tree.</span><span class="s3">\n    </span><span class="s1">treeSegment: [</span><span class="s3">\n      </span><span class="s1">segmentKey,</span><span class="s3">\n      </span><span class="s1">Array.isArray(value) ? value.join('/') : value,</span><span class="s3">\n      </span><span class="s1">dynamicParamType,</span><span class="s3">\n    </span><span class="s1">],</span><span class="s3">\n    </span><span class="s1">type: dynamicParamType,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Regular expression pattern used to match route parameters.</span><span class="s3">\n </span><span class="s1">* Matches both single parameters and parameter groups.</span><span class="s3">\n </span><span class="s1">* Examples:</span><span class="s3">\n </span><span class="s1">*   - `[[...slug]]` matches parameter group with key 'slug', repeat: true, optional: true</span><span class="s3">\n </span><span class="s1">*   - `[...slug]` matches parameter group with key 'slug', repeat: true, optional: false</span><span class="s3">\n </span><span class="s1">*   - `[[foo]]` matches parameter with key 'foo', repeat: false, optional: true</span><span class="s3">\n </span><span class="s1">*   - `[bar]` matches parameter with key 'bar', repeat: false, optional: false</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const PARAMETER_PATTERN = /^([^[]*)</span><span class="s3">\\</span><span class="s1">[((?:</span><span class="s3">\\</span><span class="s1">[[^</span><span class="s3">\\</span><span class="s1">]]*</span><span class="s3">\\</span><span class="s1">])|[^</span><span class="s3">\\</span><span class="s1">]]+)</span><span class="s3">\\</span><span class="s1">](.*)$/</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Parses a given parameter from a route to a data structure that can be used</span><span class="s3">\n </span><span class="s1">* to generate the parametrized route.</span><span class="s3">\n </span><span class="s1">* Examples:</span><span class="s3">\n </span><span class="s1">*   - `[[...slug]]` -&gt; `{ key: 'slug', repeat: true, optional: true }`</span><span class="s3">\n </span><span class="s1">*   - `[...slug]` -&gt; `{ key: 'slug', repeat: true, optional: false }`</span><span class="s3">\n </span><span class="s1">*   - `[[foo]]` -&gt; `{ key: 'foo', repeat: false, optional: true }`</span><span class="s3">\n </span><span class="s1">*   - `[bar]` -&gt; `{ key: 'bar', repeat: false, optional: false }`</span><span class="s3">\n </span><span class="s1">*   - `fizz` -&gt; `{ key: 'fizz', repeat: false, optional: false }`</span><span class="s3">\n </span><span class="s1">* @param param - The parameter to parse.</span><span class="s3">\n </span><span class="s1">* @returns The parsed parameter as a data structure.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function parseParameter(param: string) {</span><span class="s3">\n  </span><span class="s1">const match = param.match(PARAMETER_PATTERN)</span><span class="s3">\n\n  </span><span class="s1">if (!match) {</span><span class="s3">\n    </span><span class="s1">return parseMatchedParameter(param)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return parseMatchedParameter(match[2])</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Parses a matched parameter from the PARAMETER_PATTERN regex to a data structure that can be used</span><span class="s3">\n </span><span class="s1">* to generate the parametrized route.</span><span class="s3">\n </span><span class="s1">* Examples:</span><span class="s3">\n </span><span class="s1">*   - `[...slug]` -&gt; `{ key: 'slug', repeat: true, optional: true }`</span><span class="s3">\n </span><span class="s1">*   - `...slug` -&gt; `{ key: 'slug', repeat: true, optional: false }`</span><span class="s3">\n </span><span class="s1">*   - `[foo]` -&gt; `{ key: 'foo', repeat: false, optional: true }`</span><span class="s3">\n </span><span class="s1">*   - `bar` -&gt; `{ key: 'bar', repeat: false, optional: false }`</span><span class="s3">\n </span><span class="s1">* @param param - The matched parameter to parse.</span><span class="s3">\n </span><span class="s1">* @returns The parsed parameter as a data structure.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function parseMatchedParameter(param: string) {</span><span class="s3">\n  </span><span class="s1">const optional = param.startsWith('[') &amp;&amp; param.endsWith(']')</span><span class="s3">\n  </span><span class="s1">if (optional) {</span><span class="s3">\n    </span><span class="s1">param = param.slice(1, -1)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const repeat = param.startsWith('...')</span><span class="s3">\n  </span><span class="s1">if (repeat) {</span><span class="s3">\n    </span><span class="s1">param = param.slice(3)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return { key: param, repeat, optional }</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getDynamicParam&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentKey&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicParamType&quot;</span><span class="s0">,</span><span class="s1">&quot;pagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;encodeURIComponent&quot;</span><span class="s0">,</span><span class="s1">&quot;isCatchall&quot;</span><span class="s0">,</span><span class="s1">&quot;isOptionalCatchall&quot;</span><span class="s0">,</span><span class="s1">&quot;param&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;treeSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;flatMap&quot;</span><span class="s0">,</span><span class="s1">&quot;pathSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;parseParameter&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;PARAMETER_PATTERN&quot;</span><span class="s0">,</span><span class="s1">&quot;match&quot;</span><span class="s0">,</span><span class="s1">&quot;parseMatchedParameter&quot;</span><span class="s0">,</span><span class="s1">&quot;optional&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;repeat&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAIA;;;;;;;;;;CAUC,GACD;;;;;;;;;;AAAO,SAASA,gBACdC,MAA8B,EAC9BC,UAAkB,EAClBC,gBAAwC,EACxCC,QAAgB,EAChBC,mBAA+C;IAE/C,IAAIC,QAAQL,MAAM,CAACC,WAAW;IAE9B,IAAIG,uBAAuBA,oBAAoBE,GAAG,CAACL,aAAa;QAC9DI,QAAQD,oBAAoBG,GAAG,CAACN;IAClC,OAAO,IAAIO,MAAMC,OAAO,CAACJ,QAAQ;QAC/BA,QAAQA,MAAMK,GAAG,CAAC,CAACC,IAAMC,mBAAmBD;IAC9C,OAAO,IAAI,OAAON,UAAU,UAAU;QACpCA,QAAQO,mBAAmBP;IAC7B;IAEA,IAAI,CAACA,OAAO;QACV,MAAMQ,aAAaX,qBAAqB;QACxC,MAAMY,qBAAqBZ,qBAAqB;QAEhD,IAAIW,cAAcC,oBAAoB;YACpC,oEAAoE;YACpE,6DAA6D;YAC7D,IAAIA,oBAAoB;gBACtB,OAAO;oBACLC,OAAOd;oBACPI,OAAO;oBACPW,MAAMd;oBACNe,aAAa;wBAAChB;wBAAY;wBAAIC;qBAAiB;gBACjD;YACF;YAEA,+EAA+E;YAC/E,wFAAwF;YACxFG,QAAQF,SACLe,KAAK,CAAC,KACP,gCAAgC;aAC/BC,KAAK,CAAC,GACP,oDAAoD;aACnDC,OAAO,CAAC,CAACC;gBACR,MAAMN,QAAQO,eAAeD;oBAGtBrB;gBAFP,yDAAyD;gBACzD,wDAAwD;gBACxD,OAAOA,CAAAA,oBAAAA,MAAM,CAACe,MAAMQ,GAAG,CAAC,KAAA,OAAjBvB,oBAAqBe,MAAMQ,GAAG;YACvC;YAEF,OAAO;gBACLR,OAAOd;gBACPI;gBACAW,MAAMd;gBACN,wCAAwC;gBACxCe,aAAa;oBAAChB;oBAAYI,MAAMmB,IAAI,CAAC;oBAAMtB;iBAAiB;YAC9D;QACF;IACF;IAEA,OAAO;QACLa,OAAOd;QACP,yCAAyC;QACzCI,OAAOA;QACP,iDAAiD;QACjDY,aAAa;YACXhB;YACAO,MAAMC,OAAO,CAACJ,SAASA,MAAMmB,IAAI,CAAC,OAAOnB;YACzCH;SACD;QACDc,MAAMd;IACR;AACF;AAWO,MAAMuB,oBAAoB,2CAA0C;AAcpE,SAASH,eAAeP,KAAa;IAC1C,MAAMW,QAAQX,MAAMW,KAAK,CAACD;IAE1B,IAAI,CAACC,OAAO;QACV,OAAOC,sBAAsBZ;IAC/B;IAEA,OAAOY,sBAAsBD,KAAK,CAAC,EAAE;AACvC;AAaO,SAASC,sBAAsBZ,KAAa;IACjD,MAAMa,WAAWb,MAAMc,UAAU,CAAC,QAAQd,MAAMe,QAAQ,CAAC;IACzD,IAAIF,UAAU;QACZb,QAAQA,MAAMI,KAAK,CAAC,GAAG,CAAC;IAC1B;IACA,MAAMY,SAAShB,MAAMc,UAAU,CAAC;IAChC,IAAIE,QAAQ;QACVhB,QAAQA,MAAMI,KAAK,CAAC;IACtB;IACA,OAAO;QAAEI,KAAKR;QAAOgB;QAAQH;IAAS;AACxC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1360</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/route-regex.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">NEXT_INTERCEPTION_MARKER_PREFIX,</span><span class="s3">\n  </span><span class="s1">NEXT_QUERY_PARAM_PREFIX,</span><span class="s3">\n</span><span class="s1">} from '../../../../lib/constants'</span><span class="s3">\n</span><span class="s1">import { INTERCEPTION_ROUTE_MARKERS } from './interception-routes'</span><span class="s3">\n</span><span class="s1">import { escapeStringRegexp } from '../../escape-regexp'</span><span class="s3">\n</span><span class="s1">import { removeTrailingSlash } from './remove-trailing-slash'</span><span class="s3">\n</span><span class="s1">import { PARAMETER_PATTERN, parseMatchedParameter } from './get-dynamic-param'</span><span class="s3">\n\n</span><span class="s1">export interface Group {</span><span class="s3">\n  </span><span class="s1">pos: number</span><span class="s3">\n  </span><span class="s1">repeat: boolean</span><span class="s3">\n  </span><span class="s1">optional: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface RouteRegex {</span><span class="s3">\n  </span><span class="s1">groups: { [groupName: string]: Group }</span><span class="s3">\n  </span><span class="s1">re: RegExp</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type GetNamedRouteRegexOptions = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether to prefix the route keys with the NEXT_INTERCEPTION_MARKER_PREFIX</span><span class="s3">\n   </span><span class="s1">* or NEXT_QUERY_PARAM_PREFIX. This is only relevant when creating the</span><span class="s3">\n   </span><span class="s1">* routes-manifest during the build.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">prefixRouteKeys: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether to include the suffix in the route regex. This means that when you</span><span class="s3">\n   </span><span class="s1">* have something like `/[...slug].json` the `.json` part will be included</span><span class="s3">\n   </span><span class="s1">* in the regex, yielding `/(.*).json` as the regex.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">includeSuffix?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether to include the prefix in the route regex. This means that when you</span><span class="s3">\n   </span><span class="s1">* have something like `/[...slug].json` the `/` part will be included</span><span class="s3">\n   </span><span class="s1">* in the regex, yielding `^/(.*).json$` as the regex.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* Note that interception markers will already be included without the need</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">includePrefix?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether to exclude the optional trailing slash from the route regex.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">excludeOptionalTrailingSlash?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether to backtrack duplicate keys. This is only relevant when creating</span><span class="s3">\n   </span><span class="s1">* the routes-manifest during the build.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">backreferenceDuplicateKeys?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type GetRouteRegexOptions = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether to include extra parts in the route regex. This means that when you</span><span class="s3">\n   </span><span class="s1">* have something like `/[...slug].json` the `.json` part will be included</span><span class="s3">\n   </span><span class="s1">* in the regex, yielding `/(.*).json` as the regex.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">includeSuffix?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether to include the prefix in the route regex. This means that when you</span><span class="s3">\n   </span><span class="s1">* have something like `/[...slug].json` the `/` part will be included</span><span class="s3">\n   </span><span class="s1">* in the regex, yielding `^/(.*).json$` as the regex.</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* Note that interception markers will already be included without the need</span><span class="s3">\n   </span><span class="s1">* of adding this option.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">includePrefix?: boolean</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Whether to exclude the optional trailing slash from the route regex.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">excludeOptionalTrailingSlash?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getParametrizedRoute(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">includeSuffix: boolean,</span><span class="s3">\n  </span><span class="s1">includePrefix: boolean</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const groups: { [groupName: string]: Group } = {}</span><span class="s3">\n  </span><span class="s1">let groupIndex = 1</span><span class="s3">\n\n  </span><span class="s1">const segments: string[] = []</span><span class="s3">\n  </span><span class="s1">for (const segment of removeTrailingSlash(route).slice(1).split('/')) {</span><span class="s3">\n    </span><span class="s1">const markerMatch = INTERCEPTION_ROUTE_MARKERS.find((m) =&gt;</span><span class="s3">\n      </span><span class="s1">segment.startsWith(m)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">const paramMatches = segment.match(PARAMETER_PATTERN) // Check for parameters</span><span class="s3">\n\n    </span><span class="s1">if (markerMatch &amp;&amp; paramMatches &amp;&amp; paramMatches[2]) {</span><span class="s3">\n      </span><span class="s1">const { key, optional, repeat } = parseMatchedParameter(paramMatches[2])</span><span class="s3">\n      </span><span class="s1">groups[key] = { pos: groupIndex++, repeat, optional }</span><span class="s3">\n      </span><span class="s1">segments.push(`/${escapeStringRegexp(markerMatch)}([^/]+?)`)</span><span class="s3">\n    </span><span class="s1">} else if (paramMatches &amp;&amp; paramMatches[2]) {</span><span class="s3">\n      </span><span class="s1">const { key, repeat, optional } = parseMatchedParameter(paramMatches[2])</span><span class="s3">\n      </span><span class="s1">groups[key] = { pos: groupIndex++, repeat, optional }</span><span class="s3">\n\n      </span><span class="s1">if (includePrefix &amp;&amp; paramMatches[1]) {</span><span class="s3">\n        </span><span class="s1">segments.push(`/${escapeStringRegexp(paramMatches[1])}`)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">let s = repeat ? (optional ? '(?:/(.+?))?' : '/(.+?)') : '/([^/]+?)'</span><span class="s3">\n\n      </span><span class="s1">// Remove the leading slash if includePrefix already added it.</span><span class="s3">\n      </span><span class="s1">if (includePrefix &amp;&amp; paramMatches[1]) {</span><span class="s3">\n        </span><span class="s1">s = s.substring(1)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">segments.push(s)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">segments.push(`/${escapeStringRegexp(segment)}`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// If there's a suffix, add it to the segments if it's enabled.</span><span class="s3">\n    </span><span class="s1">if (includeSuffix &amp;&amp; paramMatches &amp;&amp; paramMatches[3]) {</span><span class="s3">\n      </span><span class="s1">segments.push(escapeStringRegexp(paramMatches[3]))</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">parameterizedRoute: segments.join(''),</span><span class="s3">\n    </span><span class="s1">groups,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* From a normalized route this function generates a regular expression and</span><span class="s3">\n </span><span class="s1">* a corresponding groups object intended to be used to store matching groups</span><span class="s3">\n </span><span class="s1">* from the regular expression.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function getRouteRegex(</span><span class="s3">\n  </span><span class="s1">normalizedRoute: string,</span><span class="s3">\n  </span><span class="s1">{</span><span class="s3">\n    </span><span class="s1">includeSuffix = false,</span><span class="s3">\n    </span><span class="s1">includePrefix = false,</span><span class="s3">\n    </span><span class="s1">excludeOptionalTrailingSlash = false,</span><span class="s3">\n  </span><span class="s1">}: GetRouteRegexOptions = {}</span><span class="s3">\n</span><span class="s1">): RouteRegex {</span><span class="s3">\n  </span><span class="s1">const { parameterizedRoute, groups } = getParametrizedRoute(</span><span class="s3">\n    </span><span class="s1">normalizedRoute,</span><span class="s3">\n    </span><span class="s1">includeSuffix,</span><span class="s3">\n    </span><span class="s1">includePrefix</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">let re = parameterizedRoute</span><span class="s3">\n  </span><span class="s1">if (!excludeOptionalTrailingSlash) {</span><span class="s3">\n    </span><span class="s1">re += '(?:/)?'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">re: new RegExp(`^${re}$`),</span><span class="s3">\n    </span><span class="s1">groups: groups,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Builds a function to generate a minimal routeKey using only a-z and minimal</span><span class="s3">\n </span><span class="s1">* number of characters.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function buildGetSafeRouteKey() {</span><span class="s3">\n  </span><span class="s1">let i = 0</span><span class="s3">\n\n  </span><span class="s1">return () =&gt; {</span><span class="s3">\n    </span><span class="s1">let routeKey = ''</span><span class="s3">\n    </span><span class="s1">let j = ++i</span><span class="s3">\n    </span><span class="s1">while (j &gt; 0) {</span><span class="s3">\n      </span><span class="s1">routeKey += String.fromCharCode(97 + ((j - 1) % 26))</span><span class="s3">\n      </span><span class="s1">j = Math.floor((j - 1) / 26)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return routeKey</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getSafeKeyFromSegment({</span><span class="s3">\n  </span><span class="s1">interceptionMarker,</span><span class="s3">\n  </span><span class="s1">getSafeRouteKey,</span><span class="s3">\n  </span><span class="s1">segment,</span><span class="s3">\n  </span><span class="s1">routeKeys,</span><span class="s3">\n  </span><span class="s1">keyPrefix,</span><span class="s3">\n  </span><span class="s1">backreferenceDuplicateKeys,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">interceptionMarker?: string</span><span class="s3">\n  </span><span class="s1">getSafeRouteKey: () =&gt; string</span><span class="s3">\n  </span><span class="s1">segment: string</span><span class="s3">\n  </span><span class="s1">routeKeys: Record&lt;string, string&gt;</span><span class="s3">\n  </span><span class="s1">keyPrefix?: string</span><span class="s3">\n  </span><span class="s1">backreferenceDuplicateKeys: boolean</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">const { key, optional, repeat } = parseMatchedParameter(segment)</span><span class="s3">\n\n  </span><span class="s1">// replace any non-word characters since they can break</span><span class="s3">\n  </span><span class="s1">// the named regex</span><span class="s3">\n  </span><span class="s1">let cleanedKey = key.replace(/</span><span class="s3">\\</span><span class="s1">W/g, '')</span><span class="s3">\n\n  </span><span class="s1">if (keyPrefix) {</span><span class="s3">\n    </span><span class="s1">cleanedKey = `${keyPrefix}${cleanedKey}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">let invalidKey = false</span><span class="s3">\n\n  </span><span class="s1">// check if the key is still invalid and fallback to using a known</span><span class="s3">\n  </span><span class="s1">// safe key</span><span class="s3">\n  </span><span class="s1">if (cleanedKey.length === 0 || cleanedKey.length &gt; 30) {</span><span class="s3">\n    </span><span class="s1">invalidKey = true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (!isNaN(parseInt(cleanedKey.slice(0, 1)))) {</span><span class="s3">\n    </span><span class="s1">invalidKey = true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (invalidKey) {</span><span class="s3">\n    </span><span class="s1">cleanedKey = getSafeRouteKey()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const duplicateKey = cleanedKey in routeKeys</span><span class="s3">\n\n  </span><span class="s1">if (keyPrefix) {</span><span class="s3">\n    </span><span class="s1">routeKeys[cleanedKey] = `${keyPrefix}${key}`</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">routeKeys[cleanedKey] = key</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// if the segment has an interception marker, make sure that's part of the regex pattern</span><span class="s3">\n  </span><span class="s1">// this is to ensure that the route with the interception marker doesn't incorrectly match</span><span class="s3">\n  </span><span class="s1">// the non-intercepted route (ie /app/(.)[username] should not match /app/[username])</span><span class="s3">\n  </span><span class="s1">const interceptionPrefix = interceptionMarker</span><span class="s3">\n    </span><span class="s1">? escapeStringRegexp(interceptionMarker)</span><span class="s3">\n    </span><span class="s1">: ''</span><span class="s3">\n\n  </span><span class="s1">let pattern: string</span><span class="s3">\n  </span><span class="s1">if (duplicateKey &amp;&amp; backreferenceDuplicateKeys) {</span><span class="s3">\n    </span><span class="s1">// Use a backreference to the key to ensure that the key is the same value</span><span class="s3">\n    </span><span class="s1">// in each of the placeholders.</span><span class="s3">\n    </span><span class="s1">pattern = `</span><span class="s3">\\\\</span><span class="s1">k&lt;${cleanedKey}&gt;`</span><span class="s3">\n  </span><span class="s1">} else if (repeat) {</span><span class="s3">\n    </span><span class="s1">pattern = `(?&lt;${cleanedKey}&gt;.+?)`</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">pattern = `(?&lt;${cleanedKey}&gt;[^/]+?)`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return optional</span><span class="s3">\n    </span><span class="s1">? `(?:/${interceptionPrefix}${pattern})?`</span><span class="s3">\n    </span><span class="s1">: `/${interceptionPrefix}${pattern}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getNamedParametrizedRoute(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">prefixRouteKeys: boolean,</span><span class="s3">\n  </span><span class="s1">includeSuffix: boolean,</span><span class="s3">\n  </span><span class="s1">includePrefix: boolean,</span><span class="s3">\n  </span><span class="s1">backreferenceDuplicateKeys: boolean</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const getSafeRouteKey = buildGetSafeRouteKey()</span><span class="s3">\n  </span><span class="s1">const routeKeys: { [named: string]: string } = {}</span><span class="s3">\n\n  </span><span class="s1">const segments: string[] = []</span><span class="s3">\n  </span><span class="s1">for (const segment of removeTrailingSlash(route).slice(1).split('/')) {</span><span class="s3">\n    </span><span class="s1">const hasInterceptionMarker = INTERCEPTION_ROUTE_MARKERS.some((m) =&gt;</span><span class="s3">\n      </span><span class="s1">segment.startsWith(m)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">const paramMatches = segment.match(PARAMETER_PATTERN) // Check for parameters</span><span class="s3">\n\n    </span><span class="s1">if (hasInterceptionMarker &amp;&amp; paramMatches &amp;&amp; paramMatches[2]) {</span><span class="s3">\n      </span><span class="s1">// If there's an interception marker, add it to the segments.</span><span class="s3">\n      </span><span class="s1">segments.push(</span><span class="s3">\n        </span><span class="s1">getSafeKeyFromSegment({</span><span class="s3">\n          </span><span class="s1">getSafeRouteKey,</span><span class="s3">\n          </span><span class="s1">interceptionMarker: paramMatches[1],</span><span class="s3">\n          </span><span class="s1">segment: paramMatches[2],</span><span class="s3">\n          </span><span class="s1">routeKeys,</span><span class="s3">\n          </span><span class="s1">keyPrefix: prefixRouteKeys</span><span class="s3">\n            </span><span class="s1">? NEXT_INTERCEPTION_MARKER_PREFIX</span><span class="s3">\n            </span><span class="s1">: undefined,</span><span class="s3">\n          </span><span class="s1">backreferenceDuplicateKeys,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">} else if (paramMatches &amp;&amp; paramMatches[2]) {</span><span class="s3">\n      </span><span class="s1">// If there's a prefix, add it to the segments if it's enabled.</span><span class="s3">\n      </span><span class="s1">if (includePrefix &amp;&amp; paramMatches[1]) {</span><span class="s3">\n        </span><span class="s1">segments.push(`/${escapeStringRegexp(paramMatches[1])}`)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">let s = getSafeKeyFromSegment({</span><span class="s3">\n        </span><span class="s1">getSafeRouteKey,</span><span class="s3">\n        </span><span class="s1">segment: paramMatches[2],</span><span class="s3">\n        </span><span class="s1">routeKeys,</span><span class="s3">\n        </span><span class="s1">keyPrefix: prefixRouteKeys ? NEXT_QUERY_PARAM_PREFIX : undefined,</span><span class="s3">\n        </span><span class="s1">backreferenceDuplicateKeys,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n\n      </span><span class="s1">// Remove the leading slash if includePrefix already added it.</span><span class="s3">\n      </span><span class="s1">if (includePrefix &amp;&amp; paramMatches[1]) {</span><span class="s3">\n        </span><span class="s1">s = s.substring(1)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">segments.push(s)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">segments.push(`/${escapeStringRegexp(segment)}`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// If there's a suffix, add it to the segments if it's enabled.</span><span class="s3">\n    </span><span class="s1">if (includeSuffix &amp;&amp; paramMatches &amp;&amp; paramMatches[3]) {</span><span class="s3">\n      </span><span class="s1">segments.push(escapeStringRegexp(paramMatches[3]))</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">namedParameterizedRoute: segments.join(''),</span><span class="s3">\n    </span><span class="s1">routeKeys,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function extends `getRouteRegex` generating also a named regexp where</span><span class="s3">\n </span><span class="s1">* each group is named along with a routeKeys object that indexes the assigned</span><span class="s3">\n </span><span class="s1">* named group with its corresponding key. When the routeKeys need to be</span><span class="s3">\n </span><span class="s1">* prefixed to uniquely identify internally the </span><span class="s3">\&quot;</span><span class="s1">prefixRouteKey</span><span class="s3">\&quot; </span><span class="s1">arg should</span><span class="s3">\n </span><span class="s1">* be </span><span class="s3">\&quot;</span><span class="s1">true</span><span class="s3">\&quot; </span><span class="s1">currently this is only the case when creating the routes-manifest</span><span class="s3">\n </span><span class="s1">* during the build</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function getNamedRouteRegex(</span><span class="s3">\n  </span><span class="s1">normalizedRoute: string,</span><span class="s3">\n  </span><span class="s1">options: GetNamedRouteRegexOptions</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const result = getNamedParametrizedRoute(</span><span class="s3">\n    </span><span class="s1">normalizedRoute,</span><span class="s3">\n    </span><span class="s1">options.prefixRouteKeys,</span><span class="s3">\n    </span><span class="s1">options.includeSuffix ?? false,</span><span class="s3">\n    </span><span class="s1">options.includePrefix ?? false,</span><span class="s3">\n    </span><span class="s1">options.backreferenceDuplicateKeys ?? false</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">let namedRegex = result.namedParameterizedRoute</span><span class="s3">\n  </span><span class="s1">if (!options.excludeOptionalTrailingSlash) {</span><span class="s3">\n    </span><span class="s1">namedRegex += '(?:/)?'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">...getRouteRegex(normalizedRoute, options),</span><span class="s3">\n    </span><span class="s1">namedRegex: `^${namedRegex}$`,</span><span class="s3">\n    </span><span class="s1">routeKeys: result.routeKeys,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Generates a named regexp.</span><span class="s3">\n </span><span class="s1">* This is intended to be using for build time only.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function getNamedMiddlewareRegex(</span><span class="s3">\n  </span><span class="s1">normalizedRoute: string,</span><span class="s3">\n  </span><span class="s1">options: {</span><span class="s3">\n    </span><span class="s1">catchAll?: boolean</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const { parameterizedRoute } = getParametrizedRoute(</span><span class="s3">\n    </span><span class="s1">normalizedRoute,</span><span class="s3">\n    </span><span class="s1">false,</span><span class="s3">\n    </span><span class="s1">false</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">const { catchAll = true } = options</span><span class="s3">\n  </span><span class="s1">if (parameterizedRoute === '/') {</span><span class="s3">\n    </span><span class="s1">let catchAllRegex = catchAll ? '.*' : ''</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">namedRegex: `^/${catchAllRegex}$`,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { namedParameterizedRoute } = getNamedParametrizedRoute(</span><span class="s3">\n    </span><span class="s1">normalizedRoute,</span><span class="s3">\n    </span><span class="s1">false,</span><span class="s3">\n    </span><span class="s1">false,</span><span class="s3">\n    </span><span class="s1">false,</span><span class="s3">\n    </span><span class="s1">false</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">let catchAllGroupedRegex = catchAll ? '(?:(/.*)?)' : ''</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">namedRegex: `^${namedParameterizedRoute}${catchAllGroupedRegex}$`,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;NEXT_INTERCEPTION_MARKER_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_QUERY_PARAM_PREFIX&quot;</span><span class="s0">,</span><span class="s1">&quot;INTERCEPTION_ROUTE_MARKERS&quot;</span><span class="s0">,</span><span class="s1">&quot;escapeStringRegexp&quot;</span><span class="s0">,</span><span class="s1">&quot;removeTrailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;PARAMETER_PATTERN&quot;</span><span class="s0">,</span><span class="s1">&quot;parseMatchedParameter&quot;</span><span class="s0">,</span><span class="s1">&quot;getParametrizedRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;includeSuffix&quot;</span><span class="s0">,</span><span class="s1">&quot;includePrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;groups&quot;</span><span class="s0">,</span><span class="s1">&quot;groupIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;segments&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;markerMatch&quot;</span><span class="s0">,</span><span class="s1">&quot;find&quot;</span><span class="s0">,</span><span class="s1">&quot;m&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;paramMatches&quot;</span><span class="s0">,</span><span class="s1">&quot;match&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;optional&quot;</span><span class="s0">,</span><span class="s1">&quot;repeat&quot;</span><span class="s0">,</span><span class="s1">&quot;pos&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;s&quot;</span><span class="s0">,</span><span class="s1">&quot;substring&quot;</span><span class="s0">,</span><span class="s1">&quot;parameterizedRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;getRouteRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizedRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;excludeOptionalTrailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;re&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;buildGetSafeRouteKey&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;routeKey&quot;</span><span class="s0">,</span><span class="s1">&quot;j&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;fromCharCode&quot;</span><span class="s0">,</span><span class="s1">&quot;Math&quot;</span><span class="s0">,</span><span class="s1">&quot;floor&quot;</span><span class="s0">,</span><span class="s1">&quot;getSafeKeyFromSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;interceptionMarker&quot;</span><span class="s0">,</span><span class="s1">&quot;getSafeRouteKey&quot;</span><span class="s0">,</span><span class="s1">&quot;routeKeys&quot;</span><span class="s0">,</span><span class="s1">&quot;keyPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;backreferenceDuplicateKeys&quot;</span><span class="s0">,</span><span class="s1">&quot;cleanedKey&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidKey&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;isNaN&quot;</span><span class="s0">,</span><span class="s1">&quot;parseInt&quot;</span><span class="s0">,</span><span class="s1">&quot;duplicateKey&quot;</span><span class="s0">,</span><span class="s1">&quot;interceptionPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;pattern&quot;</span><span class="s0">,</span><span class="s1">&quot;getNamedParametrizedRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;prefixRouteKeys&quot;</span><span class="s0">,</span><span class="s1">&quot;hasInterceptionMarker&quot;</span><span class="s0">,</span><span class="s1">&quot;some&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;namedParameterizedRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;getNamedRouteRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;namedRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;getNamedMiddlewareRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;catchAll&quot;</span><span class="s0">,</span><span class="s1">&quot;catchAllRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;catchAllGroupedRegex&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;AAAA,SACEA,+BAA+B,EAC/BC,uBAAuB,QAClB,4BAA2B;AAClC,SAASC,0BAA0B,QAAQ,wBAAuB;AAClE,SAASC,kBAAkB,QAAQ,sBAAqB;AACxD,SAASC,mBAAmB,QAAQ,0BAAyB;AAC7D,SAASC,iBAAiB,EAAEC,qBAAqB,QAAQ,sBAAqB;;;;;;AAyE9E,SAASC,qBACPC,KAAa,EACbC,aAAsB,EACtBC,aAAsB;IAEtB,MAAMC,SAAyC,CAAC;IAChD,IAAIC,aAAa;IAEjB,MAAMC,WAAqB,EAAE;IAC7B,KAAK,MAAMC,eAAWV,6NAAAA,EAAoBI,OAAOO,KAAK,CAAC,GAAGC,KAAK,CAAC,KAAM;QACpE,MAAMC,cAAcf,+NAAAA,CAA2BgB,IAAI,CAAC,CAACC,IACnDL,QAAQM,UAAU,CAACD;QAErB,MAAME,eAAeP,QAAQQ,KAAK,CAACjB,uNAAAA,EAAmB,uBAAuB;;QAE7E,IAAIY,eAAeI,gBAAgBA,YAAY,CAAC,EAAE,EAAE;YAClD,MAAM,EAAEE,GAAG,EAAEC,QAAQ,EAAEC,MAAM,EAAE,OAAGnB,2NAAAA,EAAsBe,YAAY,CAAC,EAAE;YACvEV,MAAM,CAACY,IAAI,GAAG;gBAAEG,KAAKd;gBAAca;gBAAQD;YAAS;YACpDX,SAASc,IAAI,CAAE,UAAGxB,8LAAAA,EAAmBc,eAAa;QACpD,OAAO,IAAII,gBAAgBA,YAAY,CAAC,EAAE,EAAE;YAC1C,MAAM,EAAEE,GAAG,EAAEE,MAAM,EAAED,QAAQ,EAAE,OAAGlB,2NAAAA,EAAsBe,YAAY,CAAC,EAAE;YACvEV,MAAM,CAACY,IAAI,GAAG;gBAAEG,KAAKd;gBAAca;gBAAQD;YAAS;YAEpD,IAAId,iBAAiBW,YAAY,CAAC,EAAE,EAAE;gBACpCR,SAASc,IAAI,CAAE,UAAGxB,8LAAAA,EAAmBkB,YAAY,CAAC,EAAE;YACtD;YAEA,IAAIO,IAAIH,SAAUD,WAAW,gBAAgB,WAAY;YAEzD,8DAA8D;YAC9D,IAAId,iBAAiBW,YAAY,CAAC,EAAE,EAAE;gBACpCO,IAAIA,EAAEC,SAAS,CAAC;YAClB;YAEAhB,SAASc,IAAI,CAACC;QAChB,OAAO;YACLf,SAASc,IAAI,CAAE,UAAGxB,8LAAAA,EAAmBW;QACvC;QAEA,+DAA+D;QAC/D,IAAIL,iBAAiBY,gBAAgBA,YAAY,CAAC,EAAE,EAAE;YACpDR,SAASc,IAAI,KAACxB,8LAAAA,EAAmBkB,YAAY,CAAC,EAAE;QAClD;IACF;IAEA,OAAO;QACLS,oBAAoBjB,SAASkB,IAAI,CAAC;QAClCpB;IACF;AACF;AAOO,SAASqB,cACdC,eAAuB,EACvB,KAAA;IAAA,IAAA,EACExB,gBAAgB,KAAK,EACrBC,gBAAgB,KAAK,EACrBwB,+BAA+B,KAAK,EACf,GAJvB,UAAA,KAAA,IAI0B,CAAC,IAJ3B;IAMA,MAAM,EAAEJ,kBAAkB,EAAEnB,MAAM,EAAE,GAAGJ,qBACrC0B,iBACAxB,eACAC;IAGF,IAAIyB,KAAKL;IACT,IAAI,CAACI,8BAA8B;QACjCC,MAAM;IACR;IAEA,OAAO;QACLA,IAAI,IAAIC,OAAQ,MAAGD,KAAG;QACtBxB,QAAQA;IACV;AACF;AAEA;;;CAGC,GACD,SAAS0B;IACP,IAAIC,IAAI;IAER,OAAO;QACL,IAAIC,WAAW;QACf,IAAIC,IAAI,EAAEF;QACV,MAAOE,IAAI,EAAG;YACZD,YAAYE,OAAOC,YAAY,CAAC,KAAOF,CAAAA,IAAI,CAAA,IAAK;YAChDA,IAAIG,KAAKC,KAAK,CAAEJ,CAAAA,IAAI,CAAA,IAAK;QAC3B;QACA,OAAOD;IACT;AACF;AAEA,SAASM,sBAAsB,KAc9B;IAd8B,IAAA,EAC7BC,kBAAkB,EAClBC,eAAe,EACfjC,OAAO,EACPkC,SAAS,EACTC,SAAS,EACTC,0BAA0B,EAQ3B,GAd8B;IAe7B,MAAM,EAAE3B,GAAG,EAAEC,QAAQ,EAAEC,MAAM,EAAE,OAAGnB,2NAAAA,EAAsBQ;IAExD,uDAAuD;IACvD,kBAAkB;IAClB,IAAIqC,aAAa5B,IAAI6B,OAAO,CAAC,OAAO;IAEpC,IAAIH,WAAW;QACbE,aAAc,KAAEF,YAAYE;IAC9B;IACA,IAAIE,aAAa;IAEjB,kEAAkE;IAClE,WAAW;IACX,IAAIF,WAAWG,MAAM,KAAK,KAAKH,WAAWG,MAAM,GAAG,IAAI;QACrDD,aAAa;IACf;IACA,IAAI,CAACE,MAAMC,SAASL,WAAWpC,KAAK,CAAC,GAAG,MAAM;QAC5CsC,aAAa;IACf;IAEA,IAAIA,YAAY;QACdF,aAAaJ;IACf;IAEA,MAAMU,eAAeN,cAAcH;IAEnC,IAAIC,WAAW;QACbD,SAAS,CAACG,WAAW,GAAI,KAAEF,YAAY1B;IACzC,OAAO;QACLyB,SAAS,CAACG,WAAW,GAAG5B;IAC1B;IAEA,wFAAwF;IACxF,0FAA0F;IAC1F,qFAAqF;IACrF,MAAMmC,qBAAqBZ,yBACvB3C,8LAAAA,EAAmB2C,sBACnB;IAEJ,IAAIa;IACJ,IAAIF,gBAAgBP,4BAA4B;QAC9C,0EAA0E;QAC1E,+BAA+B;QAC/BS,UAAW,SAAMR,aAAW;IAC9B,OAAO,IAAI1B,QAAQ;QACjBkC,UAAW,QAAKR,aAAW;IAC7B,OAAO;QACLQ,UAAW,QAAKR,aAAW;IAC7B;IAEA,OAAO3B,WACF,SAAMkC,qBAAqBC,UAAQ,OACnC,MAAGD,qBAAqBC;AAC/B;AAEA,SAASC,0BACPpD,KAAa,EACbqD,eAAwB,EACxBpD,aAAsB,EACtBC,aAAsB,EACtBwC,0BAAmC;IAEnC,MAAMH,kBAAkBV;IACxB,MAAMW,YAAyC,CAAC;IAEhD,MAAMnC,WAAqB,EAAE;IAC7B,KAAK,MAAMC,eAAWV,6NAAAA,EAAoBI,OAAOO,KAAK,CAAC,GAAGC,KAAK,CAAC,KAAM;QACpE,MAAM8C,wBAAwB5D,+NAAAA,CAA2B6D,IAAI,CAAC,CAAC5C,IAC7DL,QAAQM,UAAU,CAACD;QAGrB,MAAME,eAAeP,QAAQQ,KAAK,CAACjB,uNAAAA,EAAmB,uBAAuB;;QAE7E,IAAIyD,yBAAyBzC,gBAAgBA,YAAY,CAAC,EAAE,EAAE;YAC5D,6DAA6D;YAC7DR,SAASc,IAAI,CACXkB,sBAAsB;gBACpBE;gBACAD,oBAAoBzB,YAAY,CAAC,EAAE;gBACnCP,SAASO,YAAY,CAAC,EAAE;gBACxB2B;gBACAC,WAAWY,kBACP7D,0LAAAA,GACAgE;gBACJd;YACF;QAEJ,OAAO,IAAI7B,gBAAgBA,YAAY,CAAC,EAAE,EAAE;YAC1C,+DAA+D;YAC/D,IAAIX,iBAAiBW,YAAY,CAAC,EAAE,EAAE;gBACpCR,SAASc,IAAI,CAAE,UAAGxB,8LAAAA,EAAmBkB,YAAY,CAAC,EAAE;YACtD;YAEA,IAAIO,IAAIiB,sBAAsB;gBAC5BE;gBACAjC,SAASO,YAAY,CAAC,EAAE;gBACxB2B;gBACAC,WAAWY,kBAAkB5D,kLAAAA,GAA0B+D;gBACvDd;YACF;YAEA,8DAA8D;YAC9D,IAAIxC,iBAAiBW,YAAY,CAAC,EAAE,EAAE;gBACpCO,IAAIA,EAAEC,SAAS,CAAC;YAClB;YAEAhB,SAASc,IAAI,CAACC;QAChB,OAAO;YACLf,SAASc,IAAI,CAAE,UAAGxB,8LAAAA,EAAmBW;QACvC;QAEA,+DAA+D;QAC/D,IAAIL,iBAAiBY,gBAAgBA,YAAY,CAAC,EAAE,EAAE;YACpDR,SAASc,IAAI,KAACxB,8LAAAA,EAAmBkB,YAAY,CAAC,EAAE;QAClD;IACF;IAEA,OAAO;QACL4C,yBAAyBpD,SAASkB,IAAI,CAAC;QACvCiB;IACF;AACF;AAUO,SAASkB,mBACdjC,eAAuB,EACvBkC,OAAkC;QAKhCA,wBACAA,wBACAA;IALF,MAAMC,SAASR,0BACb3B,iBACAkC,QAAQN,eAAe,EACvBM,CAAAA,yBAAAA,QAAQ1D,aAAa,KAAA,OAArB0D,yBAAyB,OACzBA,CAAAA,yBAAAA,QAAQzD,aAAa,KAAA,OAArByD,yBAAyB,OACzBA,CAAAA,sCAAAA,QAAQjB,0BAA0B,KAAA,OAAlCiB,sCAAsC;IAGxC,IAAIE,aAAaD,OAAOH,uBAAuB;IAC/C,IAAI,CAACE,QAAQjC,4BAA4B,EAAE;QACzCmC,cAAc;IAChB;IAEA,OAAO;QACL,GAAGrC,cAAcC,iBAAiBkC,QAAQ;QAC1CE,YAAa,MAAGA,aAAW;QAC3BrB,WAAWoB,OAAOpB,SAAS;IAC7B;AACF;AAMO,SAASsB,wBACdrC,eAAuB,EACvBkC,OAEC;IAED,MAAM,EAAErC,kBAAkB,EAAE,GAAGvB,qBAC7B0B,iBACA,OACA;IAEF,MAAM,EAAEsC,WAAW,IAAI,EAAE,GAAGJ;IAC5B,IAAIrC,uBAAuB,KAAK;QAC9B,IAAI0C,gBAAgBD,WAAW,OAAO;QACtC,OAAO;YACLF,YAAa,OAAIG,gBAAc;QACjC;IACF;IAEA,MAAM,EAAEP,uBAAuB,EAAE,GAAGL,0BAClC3B,iBACA,OACA,OACA,OACA;IAEF,IAAIwC,uBAAuBF,WAAW,eAAe;IACrD,OAAO;QACLF,YAAa,MAAGJ,0BAA0BQ,uBAAqB;IACjE;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1573</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/request/fallback-params.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { getRouteMatcher } from '../../shared/lib/router/utils/route-matcher'</span><span class="s3">\n</span><span class="s1">import { getRouteRegex } from '../../shared/lib/router/utils/route-regex'</span><span class="s3">\n\n</span><span class="s1">export type FallbackRouteParams = ReadonlyMap&lt;string, string&gt;</span><span class="s3">\n\n</span><span class="s1">function getParamKeys(page: string) {</span><span class="s3">\n  </span><span class="s1">const pattern = getRouteRegex(page)</span><span class="s3">\n  </span><span class="s1">const matcher = getRouteMatcher(pattern)</span><span class="s3">\n\n  </span><span class="s1">// Get the default list of allowed params.</span><span class="s3">\n  </span><span class="s1">return Object.keys(matcher(page))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getFallbackRouteParams(</span><span class="s3">\n  </span><span class="s1">pageOrKeys: string | readonly string[]</span><span class="s3">\n</span><span class="s1">): FallbackRouteParams | null {</span><span class="s3">\n  </span><span class="s1">let keys: readonly string[]</span><span class="s3">\n  </span><span class="s1">if (typeof pageOrKeys === 'string') {</span><span class="s3">\n    </span><span class="s1">keys = getParamKeys(pageOrKeys)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">keys = pageOrKeys</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If there are no keys, we can return early.</span><span class="s3">\n  </span><span class="s1">if (keys.length === 0) return null</span><span class="s3">\n\n  </span><span class="s1">const params = new Map&lt;string, string&gt;()</span><span class="s3">\n\n  </span><span class="s1">// As we're creating unique keys for each of the dynamic route params, we only</span><span class="s3">\n  </span><span class="s1">// need to generate a unique ID once per request because each of the keys will</span><span class="s3">\n  </span><span class="s1">// be also be unique.</span><span class="s3">\n  </span><span class="s1">const uniqueID = Math.random().toString(16).slice(2)</span><span class="s3">\n\n  </span><span class="s1">for (const key of keys) {</span><span class="s3">\n    </span><span class="s1">params.set(key, `%%drp:${key}:${uniqueID}%%`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return params</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getRouteMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;getRouteRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;getParamKeys&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;pattern&quot;</span><span class="s0">,</span><span class="s1">&quot;matcher&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;getFallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;pageOrKeys&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;uniqueID&quot;</span><span class="s0">,</span><span class="s1">&quot;Math&quot;</span><span class="s0">,</span><span class="s1">&quot;random&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,eAAe,QAAQ,8CAA6C;AAC7E,SAASC,aAAa,QAAQ,4CAA2C;;;AAIzE,SAASC,aAAaC,IAAY;IAChC,MAAMC,cAAUH,0MAAAA,EAAcE;IAC9B,MAAME,cAAUL,8MAAAA,EAAgBI;IAEhC,0CAA0C;IAC1C,OAAOE,OAAOC,IAAI,CAACF,QAAQF;AAC7B;AAEO,SAASK,uBACdC,UAAsC;IAEtC,IAAIF;IACJ,IAAI,OAAOE,eAAe,UAAU;QAClCF,OAAOL,aAAaO;IACtB,OAAO;QACLF,OAAOE;IACT;IAEA,6CAA6C;IAC7C,IAAIF,KAAKG,MAAM,KAAK,GAAG,OAAO;IAE9B,MAAMC,SAAS,IAAIC;IAEnB,8EAA8E;IAC9E,8EAA8E;IAC9E,qBAAqB;IACrB,MAAMC,WAAWC,KAAKC,MAAM,GAAGC,QAAQ,CAAC,IAAIC,KAAK,CAAC;IAElD,KAAK,MAAMC,OAAOX,KAAM;QACtBI,OAAOQ,GAAG,CAACD,KAAK,CAAC,MAAM,EAAEA,IAAI,CAAC,EAAEL,SAAS,EAAE,CAAC;IAC9C;IAEA,OAAOF;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1610</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/app-render/encryption-utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { ActionManifest } from '../../build/webpack/plugins/flight-client-entry-plugin'</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">ClientReferenceManifest,</span><span class="s3">\n  </span><span class="s1">ClientReferenceManifestForRsc,</span><span class="s3">\n</span><span class="s1">} from '../../build/webpack/plugins/flight-manifest-plugin'</span><span class="s3">\n</span><span class="s1">import type { DeepReadonly } from '../../shared/lib/deep-readonly'</span><span class="s3">\n</span><span class="s1">import { InvariantError } from '../../shared/lib/invariant-error'</span><span class="s3">\n</span><span class="s1">import { normalizeAppPath } from '../../shared/lib/router/utils/app-paths'</span><span class="s3">\n</span><span class="s1">import { workAsyncStorage } from './work-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">let __next_loaded_action_key: CryptoKey</span><span class="s3">\n\n</span><span class="s1">export function arrayBufferToString(</span><span class="s3">\n  </span><span class="s1">buffer: ArrayBuffer | Uint8Array&lt;ArrayBufferLike&gt;</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const bytes = new Uint8Array(buffer)</span><span class="s3">\n  </span><span class="s1">const len = bytes.byteLength</span><span class="s3">\n\n  </span><span class="s1">// @anonrig: V8 has a limit of 65535 arguments in a function.</span><span class="s3">\n  </span><span class="s1">// For len &lt; 65535, this is faster.</span><span class="s3">\n  </span><span class="s1">// https://github.com/vercel/next.js/pull/56377#pullrequestreview-1656181623</span><span class="s3">\n  </span><span class="s1">if (len &lt; 65535) {</span><span class="s3">\n    </span><span class="s1">return String.fromCharCode.apply(null, bytes as unknown as number[])</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let binary = ''</span><span class="s3">\n  </span><span class="s1">for (let i = 0; i &lt; len; i++) {</span><span class="s3">\n    </span><span class="s1">binary += String.fromCharCode(bytes[i])</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return binary</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function stringToUint8Array(binary: string) {</span><span class="s3">\n  </span><span class="s1">const len = binary.length</span><span class="s3">\n  </span><span class="s1">const arr = new Uint8Array(len)</span><span class="s3">\n\n  </span><span class="s1">for (let i = 0; i &lt; len; i++) {</span><span class="s3">\n    </span><span class="s1">arr[i] = binary.charCodeAt(i)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return arr</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function encrypt(key: CryptoKey, iv: Uint8Array, data: Uint8Array) {</span><span class="s3">\n  </span><span class="s1">return crypto.subtle.encrypt(</span><span class="s3">\n    </span><span class="s1">{</span><span class="s3">\n      </span><span class="s1">name: 'AES-GCM',</span><span class="s3">\n      </span><span class="s1">iv,</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">key,</span><span class="s3">\n    </span><span class="s1">data</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function decrypt(key: CryptoKey, iv: Uint8Array, data: Uint8Array) {</span><span class="s3">\n  </span><span class="s1">return crypto.subtle.decrypt(</span><span class="s3">\n    </span><span class="s1">{</span><span class="s3">\n      </span><span class="s1">name: 'AES-GCM',</span><span class="s3">\n      </span><span class="s1">iv,</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">key,</span><span class="s3">\n    </span><span class="s1">data</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// This is a global singleton that is used to encode/decode the action bound args from</span><span class="s3">\n</span><span class="s1">// the closure. This can't be using a AsyncLocalStorage as it might happen on the module</span><span class="s3">\n</span><span class="s1">// level. Since the client reference manifest won't be mutated, let's use a global singleton</span><span class="s3">\n</span><span class="s1">// to keep it.</span><span class="s3">\n</span><span class="s1">const SERVER_ACTION_MANIFESTS_SINGLETON = Symbol.for(</span><span class="s3">\n  </span><span class="s1">'next.server.action-manifests'</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n\n</span><span class="s1">export function setReferenceManifestsSingleton({</span><span class="s3">\n  </span><span class="s1">page,</span><span class="s3">\n  </span><span class="s1">clientReferenceManifest,</span><span class="s3">\n  </span><span class="s1">serverActionsManifest,</span><span class="s3">\n  </span><span class="s1">serverModuleMap,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">page: string</span><span class="s3">\n  </span><span class="s1">clientReferenceManifest: DeepReadonly&lt;ClientReferenceManifest&gt;</span><span class="s3">\n  </span><span class="s1">serverActionsManifest: DeepReadonly&lt;ActionManifest&gt;</span><span class="s3">\n  </span><span class="s1">serverModuleMap: {</span><span class="s3">\n    </span><span class="s1">[id: string]: {</span><span class="s3">\n      </span><span class="s1">id: string</span><span class="s3">\n      </span><span class="s1">chunks: string[]</span><span class="s3">\n      </span><span class="s1">name: string</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">// @ts-expect-error</span><span class="s3">\n  </span><span class="s1">const clientReferenceManifestsPerPage = globalThis[</span><span class="s3">\n    </span><span class="s1">SERVER_ACTION_MANIFESTS_SINGLETON</span><span class="s3">\n  </span><span class="s1">]?.clientReferenceManifestsPerPage as</span><span class="s3">\n    </span><span class="s1">| undefined</span><span class="s3">\n    </span><span class="s1">| DeepReadonly&lt;Record&lt;string, ClientReferenceManifest&gt;&gt;</span><span class="s3">\n\n  </span><span class="s1">// @ts-expect-error</span><span class="s3">\n  </span><span class="s1">globalThis[SERVER_ACTION_MANIFESTS_SINGLETON] = {</span><span class="s3">\n    </span><span class="s1">clientReferenceManifestsPerPage: {</span><span class="s3">\n      </span><span class="s1">...clientReferenceManifestsPerPage,</span><span class="s3">\n      </span><span class="s1">[normalizeAppPath(page)]: clientReferenceManifest,</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">serverActionsManifest,</span><span class="s3">\n    </span><span class="s1">serverModuleMap,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getServerModuleMap() {</span><span class="s3">\n  </span><span class="s1">const serverActionsManifestSingleton = (globalThis as any)[</span><span class="s3">\n    </span><span class="s1">SERVER_ACTION_MANIFESTS_SINGLETON</span><span class="s3">\n  </span><span class="s1">] as {</span><span class="s3">\n    </span><span class="s1">serverModuleMap: {</span><span class="s3">\n      </span><span class="s1">[id: string]: {</span><span class="s3">\n        </span><span class="s1">id: string</span><span class="s3">\n        </span><span class="s1">chunks: string[]</span><span class="s3">\n        </span><span class="s1">name: string</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!serverActionsManifestSingleton) {</span><span class="s3">\n    </span><span class="s1">throw new InvariantError('Missing manifest for Server Actions.')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return serverActionsManifestSingleton.serverModuleMap</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getClientReferenceManifestForRsc(): DeepReadonly&lt;ClientReferenceManifestForRsc&gt; {</span><span class="s3">\n  </span><span class="s1">const serverActionsManifestSingleton = (globalThis as any)[</span><span class="s3">\n    </span><span class="s1">SERVER_ACTION_MANIFESTS_SINGLETON</span><span class="s3">\n  </span><span class="s1">] as {</span><span class="s3">\n    </span><span class="s1">clientReferenceManifestsPerPage: DeepReadonly&lt;</span><span class="s3">\n      </span><span class="s1">Record&lt;string, ClientReferenceManifest&gt;</span><span class="s3">\n    </span><span class="s1">&gt;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!serverActionsManifestSingleton) {</span><span class="s3">\n    </span><span class="s1">throw new InvariantError('Missing manifest for Server Actions.')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { clientReferenceManifestsPerPage } = serverActionsManifestSingleton</span><span class="s3">\n  </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n\n  </span><span class="s1">if (!workStore) {</span><span class="s3">\n    </span><span class="s1">// If there's no work store defined, we can assume that a client reference</span><span class="s3">\n    </span><span class="s1">// manifest is needed during module evaluation, e.g. to create a server</span><span class="s3">\n    </span><span class="s1">// action using a higher-order function. This might also use client</span><span class="s3">\n    </span><span class="s1">// components which need to be serialized by Flight, and therefore client</span><span class="s3">\n    </span><span class="s1">// references need to be resolvable. To make this work, we're returning a</span><span class="s3">\n    </span><span class="s1">// merged manifest across all pages. This is fine as long as the module IDs</span><span class="s3">\n    </span><span class="s1">// are not page specific, which they are not for Webpack. TODO: Fix this in</span><span class="s3">\n    </span><span class="s1">// Turbopack.</span><span class="s3">\n    </span><span class="s1">return mergeClientReferenceManifests(clientReferenceManifestsPerPage)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const clientReferenceManifest =</span><span class="s3">\n    </span><span class="s1">clientReferenceManifestsPerPage[workStore.route]</span><span class="s3">\n\n  </span><span class="s1">if (!clientReferenceManifest) {</span><span class="s3">\n    </span><span class="s1">throw new InvariantError(</span><span class="s3">\n      </span><span class="s1">`Missing Client Reference Manifest for ${workStore.route}.`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return clientReferenceManifest</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function getActionEncryptionKey() {</span><span class="s3">\n  </span><span class="s1">if (__next_loaded_action_key) {</span><span class="s3">\n    </span><span class="s1">return __next_loaded_action_key</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const serverActionsManifestSingleton = (globalThis as any)[</span><span class="s3">\n    </span><span class="s1">SERVER_ACTION_MANIFESTS_SINGLETON</span><span class="s3">\n  </span><span class="s1">] as {</span><span class="s3">\n    </span><span class="s1">serverActionsManifest: DeepReadonly&lt;ActionManifest&gt;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!serverActionsManifestSingleton) {</span><span class="s3">\n    </span><span class="s1">throw new InvariantError('Missing manifest for Server Actions.')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const rawKey =</span><span class="s3">\n    </span><span class="s1">process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY ||</span><span class="s3">\n    </span><span class="s1">serverActionsManifestSingleton.serverActionsManifest.encryptionKey</span><span class="s3">\n\n  </span><span class="s1">if (rawKey === undefined) {</span><span class="s3">\n    </span><span class="s1">throw new InvariantError('Missing encryption key for Server Actions')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">__next_loaded_action_key = await crypto.subtle.importKey(</span><span class="s3">\n    </span><span class="s1">'raw',</span><span class="s3">\n    </span><span class="s1">stringToUint8Array(atob(rawKey)),</span><span class="s3">\n    </span><span class="s1">'AES-GCM',</span><span class="s3">\n    </span><span class="s1">true,</span><span class="s3">\n    </span><span class="s1">['encrypt', 'decrypt']</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">return __next_loaded_action_key</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function mergeClientReferenceManifests(</span><span class="s3">\n  </span><span class="s1">clientReferenceManifestsPerPage: DeepReadonly&lt;</span><span class="s3">\n    </span><span class="s1">Record&lt;string, ClientReferenceManifest&gt;</span><span class="s3">\n  </span><span class="s1">&gt;</span><span class="s3">\n</span><span class="s1">): ClientReferenceManifestForRsc {</span><span class="s3">\n  </span><span class="s1">const clientReferenceManifests = Object.values(</span><span class="s3">\n    </span><span class="s1">clientReferenceManifestsPerPage as Record&lt;string, ClientReferenceManifest&gt;</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">const mergedClientReferenceManifest: ClientReferenceManifestForRsc = {</span><span class="s3">\n    </span><span class="s1">clientModules: {},</span><span class="s3">\n    </span><span class="s1">edgeRscModuleMapping: {},</span><span class="s3">\n    </span><span class="s1">rscModuleMapping: {},</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">for (const clientReferenceManifest of clientReferenceManifests) {</span><span class="s3">\n    </span><span class="s1">mergedClientReferenceManifest.clientModules = {</span><span class="s3">\n      </span><span class="s1">...mergedClientReferenceManifest.clientModules,</span><span class="s3">\n      </span><span class="s1">...clientReferenceManifest.clientModules,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">mergedClientReferenceManifest.edgeRscModuleMapping = {</span><span class="s3">\n      </span><span class="s1">...mergedClientReferenceManifest.edgeRscModuleMapping,</span><span class="s3">\n      </span><span class="s1">...clientReferenceManifest.edgeRscModuleMapping,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">mergedClientReferenceManifest.rscModuleMapping = {</span><span class="s3">\n      </span><span class="s1">...mergedClientReferenceManifest.rscModuleMapping,</span><span class="s3">\n      </span><span class="s1">...clientReferenceManifest.rscModuleMapping,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return mergedClientReferenceManifest</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;__next_loaded_action_key&quot;</span><span class="s0">,</span><span class="s1">&quot;arrayBufferToString&quot;</span><span class="s0">,</span><span class="s1">&quot;buffer&quot;</span><span class="s0">,</span><span class="s1">&quot;bytes&quot;</span><span class="s0">,</span><span class="s1">&quot;Uint8Array&quot;</span><span class="s0">,</span><span class="s1">&quot;len&quot;</span><span class="s0">,</span><span class="s1">&quot;byteLength&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;fromCharCode&quot;</span><span class="s0">,</span><span class="s1">&quot;apply&quot;</span><span class="s0">,</span><span class="s1">&quot;binary&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;stringToUint8Array&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;arr&quot;</span><span class="s0">,</span><span class="s1">&quot;charCodeAt&quot;</span><span class="s0">,</span><span class="s1">&quot;encrypt&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;iv&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;crypto&quot;</span><span class="s0">,</span><span class="s1">&quot;subtle&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;decrypt&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_ACTION_MANIFESTS_SINGLETON&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;for&quot;</span><span class="s0">,</span><span class="s1">&quot;setReferenceManifestsSingleton&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;clientReferenceManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;serverActionsManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;serverModuleMap&quot;</span><span class="s0">,</span><span class="s1">&quot;globalThis&quot;</span><span class="s0">,</span><span class="s1">&quot;clientReferenceManifestsPerPage&quot;</span><span class="s0">,</span><span class="s1">&quot;getServerModuleMap&quot;</span><span class="s0">,</span><span class="s1">&quot;serverActionsManifestSingleton&quot;</span><span class="s0">,</span><span class="s1">&quot;getClientReferenceManifestForRsc&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;mergeClientReferenceManifests&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;getActionEncryptionKey&quot;</span><span class="s0">,</span><span class="s1">&quot;rawKey&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_SERVER_ACTIONS_ENCRYPTION_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;encryptionKey&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;importKey&quot;</span><span class="s0">,</span><span class="s1">&quot;atob&quot;</span><span class="s0">,</span><span class="s1">&quot;clientReferenceManifests&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;mergedClientReferenceManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;clientModules&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeRscModuleMapping&quot;</span><span class="s0">,</span><span class="s1">&quot;rscModuleMapping&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1785</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/html-bots.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// This regex contains the bots that we need to do a blocking render for and can't safely stream the response</span><span class="s3">\n</span><span class="s1">// due to how they parse the DOM. For example, they might explicitly check for metadata in the `head` tag, so we can't stream metadata tags after the `head` was sent.</span><span class="s3">\n</span><span class="s1">// Note: The pattern [</span><span class="s3">\\</span><span class="s1">w-]+-Google captures all Google crawlers with </span><span class="s3">\&quot;</span><span class="s1">-Google</span><span class="s3">\&quot; </span><span class="s1">suffix (e.g., Mediapartners-Google, AdsBot-Google, Storebot-Google)</span><span class="s3">\n</span><span class="s1">// as well as crawlers starting with </span><span class="s3">\&quot;</span><span class="s1">Google-</span><span class="s3">\&quot; </span><span class="s1">(e.g., Google-PageRenderer, Google-InspectionTool)</span><span class="s3">\n</span><span class="s1">export const HTML_LIMITED_BOT_UA_RE =</span><span class="s3">\n  </span><span class="s1">/[</span><span class="s3">\\</span><span class="s1">w-]+-Google|Google-[</span><span class="s3">\\</span><span class="s1">w-]+|Chrome-Lighthouse|Slurp|DuckDuckBot|baiduspider|yandex|sogou|bitlybot|tumblr|vkShare|quora link preview|redditbot|ia_archiver|Bingbot|BingPreview|applebot|facebookexternalhit|facebookcatalog|Twitterbot|LinkedInBot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|Yeti|googleweblight/i</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;HTML_LIMITED_BOT_UA_RE&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,6GAA6G;AAC7G,sKAAsK;AACtK,kJAAkJ;AAClJ,iGAAiG;;;;;AAC1F,MAAMA,yBACX,sTAAqT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1798</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/is-bot.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { HTML_LIMITED_BOT_UA_RE } from './html-bots'</span><span class="s3">\n\n</span><span class="s1">// Bot crawler that will spin up a headless browser and execute JS.</span><span class="s3">\n</span><span class="s1">// Only the main Googlebot search crawler executes JavaScript, not other Google crawlers.</span><span class="s3">\n</span><span class="s1">// x-ref: https://developers.google.com/search/docs/crawling-indexing/google-common-crawlers</span><span class="s3">\n</span><span class="s1">// This regex specifically matches </span><span class="s3">\&quot;</span><span class="s1">Googlebot</span><span class="s3">\&quot; </span><span class="s1">but NOT </span><span class="s3">\&quot;</span><span class="s1">Mediapartners-Google</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">AdsBot-Google</span><span class="s3">\&quot;</span><span class="s1">, etc.</span><span class="s3">\n</span><span class="s1">const HEADLESS_BROWSER_BOT_UA_RE = /Googlebot(?!-)|Googlebot$/i</span><span class="s3">\n\n</span><span class="s1">export const HTML_LIMITED_BOT_UA_RE_STRING = HTML_LIMITED_BOT_UA_RE.source</span><span class="s3">\n\n</span><span class="s1">export { HTML_LIMITED_BOT_UA_RE }</span><span class="s3">\n\n</span><span class="s1">function isDomBotUA(userAgent: string) {</span><span class="s3">\n  </span><span class="s1">return HEADLESS_BROWSER_BOT_UA_RE.test(userAgent)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function isHtmlLimitedBotUA(userAgent: string) {</span><span class="s3">\n  </span><span class="s1">return HTML_LIMITED_BOT_UA_RE.test(userAgent)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isBot(userAgent: string): boolean {</span><span class="s3">\n  </span><span class="s1">return isDomBotUA(userAgent) || isHtmlLimitedBotUA(userAgent)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getBotType(userAgent: string): 'dom' | 'html' | undefined {</span><span class="s3">\n  </span><span class="s1">if (isDomBotUA(userAgent)) {</span><span class="s3">\n    </span><span class="s1">return 'dom'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (isHtmlLimitedBotUA(userAgent)) {</span><span class="s3">\n    </span><span class="s1">return 'html'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;HTML_LIMITED_BOT_UA_RE&quot;</span><span class="s0">,</span><span class="s1">&quot;HEADLESS_BROWSER_BOT_UA_RE&quot;</span><span class="s0">,</span><span class="s1">&quot;HTML_LIMITED_BOT_UA_RE_STRING&quot;</span><span class="s0">,</span><span class="s1">&quot;source&quot;</span><span class="s0">,</span><span class="s1">&quot;isDomBotUA&quot;</span><span class="s0">,</span><span class="s1">&quot;userAgent&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;isHtmlLimitedBotUA&quot;</span><span class="s0">,</span><span class="s1">&quot;isBot&quot;</span><span class="s0">,</span><span class="s1">&quot;getBotType&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;AAAA,SAASA,sBAAsB,QAAQ,cAAa;;AAEpD,mEAAmE;AACnE,yFAAyF;AACzF,4FAA4F;AAC5F,oGAAoG;AACpG,MAAMC,6BAA6B;AAE5B,MAAMC,gCAAgCF,iNAAAA,CAAuBG,MAAM,CAAA;;AAI1E,SAASC,WAAWC,SAAiB;IACnC,OAAOJ,2BAA2BK,IAAI,CAACD;AACzC;AAEA,SAASE,mBAAmBF,SAAiB;IAC3C,OAAOL,iNAAAA,CAAuBM,IAAI,CAACD;AACrC;AAEO,SAASG,MAAMH,SAAiB;IACrC,OAAOD,WAAWC,cAAcE,mBAAmBF;AACrD;AAEO,SAASI,WAAWJ,SAAiB;IAC1C,IAAID,WAAWC,YAAY;QACzB,OAAO;IACT;IACA,IAAIE,mBAAmBF,YAAY;QACjC,OAAO;IACT;IACA,OAAOK;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1837</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/streaming-metadata.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">getBotType,</span><span class="s3">\n  </span><span class="s1">HTML_LIMITED_BOT_UA_RE_STRING,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/router/utils/is-bot'</span><span class="s3">\n</span><span class="s1">import type { BaseNextRequest } from '../base-http'</span><span class="s3">\n\n</span><span class="s1">export function shouldServeStreamingMetadata(</span><span class="s3">\n  </span><span class="s1">userAgent: string,</span><span class="s3">\n  </span><span class="s1">htmlLimitedBots: string | undefined</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">const blockingMetadataUARegex = new RegExp(</span><span class="s3">\n    </span><span class="s1">htmlLimitedBots || HTML_LIMITED_BOT_UA_RE_STRING,</span><span class="s3">\n    </span><span class="s1">'i'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">// Only block metadata for HTML-limited bots</span><span class="s3">\n  </span><span class="s1">if (userAgent &amp;&amp; blockingMetadataUARegex.test(userAgent)) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return true</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// When the request UA is a html-limited bot, we should do a dynamic render.</span><span class="s3">\n</span><span class="s1">// In this case, postpone state is not sent.</span><span class="s3">\n</span><span class="s1">export function isHtmlBotRequest(req: {</span><span class="s3">\n  </span><span class="s1">headers: BaseNextRequest['headers']</span><span class="s3">\n</span><span class="s1">}): boolean {</span><span class="s3">\n  </span><span class="s1">const ua = req.headers['user-agent'] || ''</span><span class="s3">\n  </span><span class="s1">const botType = getBotType(ua)</span><span class="s3">\n\n  </span><span class="s1">return botType === 'html'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getBotType&quot;</span><span class="s0">,</span><span class="s1">&quot;HTML_LIMITED_BOT_UA_RE_STRING&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldServeStreamingMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;userAgent&quot;</span><span class="s0">,</span><span class="s1">&quot;htmlLimitedBots&quot;</span><span class="s0">,</span><span class="s1">&quot;blockingMetadataUARegex&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;isHtmlBotRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;ua&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;botType&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAAA,SACEA,UAAU,EACVC,6BAA6B,QACxB,uCAAsC;;AAGtC,SAASC,6BACdC,SAAiB,EACjBC,eAAmC;IAEnC,MAAMC,0BAA0B,IAAIC,OAClCF,mBAAmBH,qOAAAA,EACnB;IAEF,4CAA4C;IAC5C,IAAIE,aAAaE,wBAAwBE,IAAI,CAACJ,YAAY;QACxD,OAAO;IACT;IACA,OAAO;AACT;AAIO,SAASK,iBAAiBC,GAEhC;IACC,MAAMC,KAAKD,IAAIE,OAAO,CAAC,aAAa,IAAI;IACxC,MAAMC,cAAUZ,kNAAAA,EAAWU;IAE3B,OAAOE,YAAY;AACrB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1862</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/app-render/action-utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { ActionManifest } from '../../build/webpack/plugins/flight-client-entry-plugin'</span><span class="s3">\n</span><span class="s1">import { normalizeAppPath } from '../../shared/lib/router/utils/app-paths'</span><span class="s3">\n</span><span class="s1">import { pathHasPrefix } from '../../shared/lib/router/utils/path-has-prefix'</span><span class="s3">\n</span><span class="s1">import { removePathPrefix } from '../../shared/lib/router/utils/remove-path-prefix'</span><span class="s3">\n</span><span class="s1">import { workAsyncStorage } from './work-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">// This function creates a Flight-acceptable server module map proxy from our</span><span class="s3">\n</span><span class="s1">// Server Reference Manifest similar to our client module map.</span><span class="s3">\n</span><span class="s1">// This is because our manifest contains a lot of internal Next.js data that</span><span class="s3">\n</span><span class="s1">// are relevant to the runtime, workers, etc. that React doesn't need to know.</span><span class="s3">\n</span><span class="s1">export function createServerModuleMap({</span><span class="s3">\n  </span><span class="s1">serverActionsManifest,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">serverActionsManifest: ActionManifest</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">return new Proxy(</span><span class="s3">\n    </span><span class="s1">{},</span><span class="s3">\n    </span><span class="s1">{</span><span class="s3">\n      </span><span class="s1">get: (_, id: string) =&gt; {</span><span class="s3">\n        </span><span class="s1">const workers =</span><span class="s3">\n          </span><span class="s1">serverActionsManifest[</span><span class="s3">\n            </span><span class="s1">process.env.NEXT_RUNTIME === 'edge' ? 'edge' : 'node'</span><span class="s3">\n          </span><span class="s1">]?.[id]?.workers</span><span class="s3">\n\n        </span><span class="s1">if (!workers) {</span><span class="s3">\n          </span><span class="s1">return undefined</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n\n        </span><span class="s1">let workerEntry:</span><span class="s3">\n          </span><span class="s1">| { moduleId: string | number; async: boolean }</span><span class="s3">\n          </span><span class="s1">| undefined</span><span class="s3">\n\n        </span><span class="s1">if (workStore) {</span><span class="s3">\n          </span><span class="s1">workerEntry = workers[normalizeWorkerPageName(workStore.page)]</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">// If there's no work store defined, we can assume that a server</span><span class="s3">\n          </span><span class="s1">// module map is needed during module evaluation, e.g. to create a</span><span class="s3">\n          </span><span class="s1">// server action using a higher-order function. Therefore it should be</span><span class="s3">\n          </span><span class="s1">// safe to return any entry from the manifest that matches the action</span><span class="s3">\n          </span><span class="s1">// ID. They all refer to the same module ID, which must also exist in</span><span class="s3">\n          </span><span class="s1">// the current page bundle. TODO: This is currently not guaranteed in</span><span class="s3">\n          </span><span class="s1">// Turbopack, and needs to be fixed.</span><span class="s3">\n          </span><span class="s1">workerEntry = Object.values(workers).at(0)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (!workerEntry) {</span><span class="s3">\n          </span><span class="s1">return undefined</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const { moduleId, async } = workerEntry</span><span class="s3">\n\n        </span><span class="s1">return { id: moduleId, name: id, chunks: [], async }</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Checks if the requested action has a worker for the current page.</span><span class="s3">\n </span><span class="s1">* If not, it returns the first worker that has a handler for the action.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function selectWorkerForForwarding(</span><span class="s3">\n  </span><span class="s1">actionId: string,</span><span class="s3">\n  </span><span class="s1">pageName: string,</span><span class="s3">\n  </span><span class="s1">serverActionsManifest: ActionManifest</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const workers =</span><span class="s3">\n    </span><span class="s1">serverActionsManifest[</span><span class="s3">\n      </span><span class="s1">process.env.NEXT_RUNTIME === 'edge' ? 'edge' : 'node'</span><span class="s3">\n    </span><span class="s1">][actionId]?.workers</span><span class="s3">\n  </span><span class="s1">const workerName = normalizeWorkerPageName(pageName)</span><span class="s3">\n\n  </span><span class="s1">// no workers, nothing to forward to</span><span class="s3">\n  </span><span class="s1">if (!workers) return</span><span class="s3">\n\n  </span><span class="s1">// if there is a worker for this page, no need to forward it.</span><span class="s3">\n  </span><span class="s1">if (workers[workerName]) {</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// otherwise, grab the first worker that has a handler for this action id</span><span class="s3">\n  </span><span class="s1">return denormalizeWorkerPageName(Object.keys(workers)[0])</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* The flight entry loader keys actions by bundlePath.</span><span class="s3">\n </span><span class="s1">* bundlePath corresponds with the relative path (including 'app') to the page entrypoint.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function normalizeWorkerPageName(pageName: string) {</span><span class="s3">\n  </span><span class="s1">if (pathHasPrefix(pageName, 'app')) {</span><span class="s3">\n    </span><span class="s1">return pageName</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return 'app' + pageName</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Converts a bundlePath (relative path to the entrypoint) to a routable page name</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function denormalizeWorkerPageName(bundlePath: string) {</span><span class="s3">\n  </span><span class="s1">return normalizeAppPath(removePathPrefix(bundlePath, 'app'))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;pathHasPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;removePathPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;createServerModuleMap&quot;</span><span class="s0">,</span><span class="s1">&quot;serverActionsManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;Proxy&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;_&quot;</span><span class="s0">,</span><span class="s1">&quot;id&quot;</span><span class="s0">,</span><span class="s1">&quot;workers&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;workerEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeWorkerPageName&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;at&quot;</span><span class="s0">,</span><span class="s1">&quot;moduleId&quot;</span><span class="s0">,</span><span class="s1">&quot;async&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;chunks&quot;</span><span class="s0">,</span><span class="s1">&quot;selectWorkerForForwarding&quot;</span><span class="s0">,</span><span class="s1">&quot;actionId&quot;</span><span class="s0">,</span><span class="s1">&quot;pageName&quot;</span><span class="s0">,</span><span class="s1">&quot;workerName&quot;</span><span class="s0">,</span><span class="s1">&quot;denormalizeWorkerPageName&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;bundlePath&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AACA,SAASA,gBAAgB,QAAQ,0CAAyC;AAC1E,SAASC,aAAa,QAAQ,gDAA+C;AAC7E,SAASC,gBAAgB,QAAQ,mDAAkD;AACnF,SAASC,gBAAgB,QAAQ,gCAA+B;;;;;AAMzD,SAASC,sBAAsB,EACpCC,qBAAqB,EAGtB;IACC,OAAO,IAAIC,MACT,CAAC,GACD;QACEC,KAAK,CAACC,GAAGC;gBAELJ,4BAAAA;YADF,MAAMK,UAAAA,CACJL,0BAAAA,qBAAqB,CACnBM,QAAQC,GAAG,CAACC,YAAY,KAAK,SAAS,0BAAS,OAChD,KAAA,OAAA,KAAA,IAAA,CAFDR,6BAAAA,uBAEG,CAACI,GAAG,KAAA,OAAA,KAAA,IAFPJ,2BAESK,OAAO;YAElB,IAAI,CAACA,SAAS;gBACZ,OAAOI;YACT;YAEA,MAAMC,YAAYZ,uRAAAA,CAAiBa,QAAQ;YAE3C,IAAIC;YAIJ,IAAIF,WAAW;gBACbE,cAAcP,OAAO,CAACQ,wBAAwBH,UAAUI,IAAI,EAAE;YAChE,OAAO;gBACL,gEAAgE;gBAChE,kEAAkE;gBAClE,sEAAsE;gBACtE,qEAAqE;gBACrE,qEAAqE;gBACrE,qEAAqE;gBACrE,oCAAoC;gBACpCF,cAAcG,OAAOC,MAAM,CAACX,SAASY,EAAE,CAAC;YAC1C;YAEA,IAAI,CAACL,aAAa;gBAChB,OAAOH;YACT;YAEA,MAAM,EAAES,QAAQ,EAAEC,KAAK,EAAE,GAAGP;YAE5B,OAAO;gBAAER,IAAIc;gBAAUE,MAAMhB;gBAAIiB,QAAQ,EAAE;gBAAEF;YAAM;QACrD;IACF;AAEJ;AAMO,SAASG,0BACdC,QAAgB,EAChBC,QAAgB,EAChBxB,qBAAqC;QAGnCA;IADF,MAAMK,UAAAA,CACJL,mCAAAA,qBAAqB,CACnBM,QAAQC,GAAG,CAACC,YAAY,KAAK,SAAS,0BAAS,OAChD,CAACe,SAAS,KAAA,OAAA,KAAA,IAFXvB,iCAEaK,OAAO;IACtB,MAAMoB,aAAaZ,wBAAwBW;IAE3C,oCAAoC;IACpC,IAAI,CAACnB,SAAS;IAEd,6DAA6D;IAC7D,IAAIA,OAAO,CAACoB,WAAW,EAAE;QACvB;IACF;IAEA,yEAAyE;IACzE,OAAOC,0BAA0BX,OAAOY,IAAI,CAACtB,QAAQ,CAAC,EAAE;AAC1D;AAEA;;;CAGC,GACD,SAASQ,wBAAwBW,QAAgB;IAC/C,QAAI5B,iNAAAA,EAAc4B,UAAU,QAAQ;QAClC,OAAOA;IACT;IAEA,OAAO,QAAQA;AACjB;AAEA;;CAEC,GACD,SAASE,0BAA0BE,UAAkB;IACnD,WAAOjC,2MAAAA,MAAiBE,uNAAAA,EAAiB+B,YAAY;AACvD&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1942</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/server-action-request-meta.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { IncomingMessage } from 'http'</span><span class="s3">\n</span><span class="s1">import type { BaseNextRequest } from '../base-http'</span><span class="s3">\n</span><span class="s1">import type { NextRequest } from '../web/exports'</span><span class="s3">\n</span><span class="s1">import { ACTION_HEADER } from '../../client/components/app-router-headers'</span><span class="s3">\n\n</span><span class="s1">export function getServerActionRequestMetadata(</span><span class="s3">\n  </span><span class="s1">req: IncomingMessage | BaseNextRequest | NextRequest</span><span class="s3">\n</span><span class="s1">): {</span><span class="s3">\n  </span><span class="s1">actionId: string | null</span><span class="s3">\n  </span><span class="s1">isURLEncodedAction: boolean</span><span class="s3">\n  </span><span class="s1">isMultipartAction: boolean</span><span class="s3">\n  </span><span class="s1">isFetchAction: boolean</span><span class="s3">\n  </span><span class="s1">isPossibleServerAction: boolean</span><span class="s3">\n</span><span class="s1">} {</span><span class="s3">\n  </span><span class="s1">let actionId: string | null</span><span class="s3">\n  </span><span class="s1">let contentType: string | null</span><span class="s3">\n\n  </span><span class="s1">if (req.headers instanceof Headers) {</span><span class="s3">\n    </span><span class="s1">actionId = req.headers.get(ACTION_HEADER) ?? null</span><span class="s3">\n    </span><span class="s1">contentType = req.headers.get('content-type')</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">actionId = (req.headers[ACTION_HEADER] as string) ?? null</span><span class="s3">\n    </span><span class="s1">contentType = req.headers['content-type'] ?? null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const isURLEncodedAction = Boolean(</span><span class="s3">\n    </span><span class="s1">req.method === 'POST' &amp;&amp; contentType === 'application/x-www-form-urlencoded'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">const isMultipartAction = Boolean(</span><span class="s3">\n    </span><span class="s1">req.method === 'POST' &amp;&amp; contentType?.startsWith('multipart/form-data')</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">const isFetchAction = Boolean(</span><span class="s3">\n    </span><span class="s1">actionId !== undefined &amp;&amp;</span><span class="s3">\n      </span><span class="s1">typeof actionId === 'string' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">req.method === 'POST'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">const isPossibleServerAction = Boolean(</span><span class="s3">\n    </span><span class="s1">isFetchAction || isURLEncodedAction || isMultipartAction</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">actionId,</span><span class="s3">\n    </span><span class="s1">isURLEncodedAction,</span><span class="s3">\n    </span><span class="s1">isMultipartAction,</span><span class="s3">\n    </span><span class="s1">isFetchAction,</span><span class="s3">\n    </span><span class="s1">isPossibleServerAction,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getIsPossibleServerAction(</span><span class="s3">\n  </span><span class="s1">req: IncomingMessage | BaseNextRequest | NextRequest</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">return getServerActionRequestMetadata(req).isPossibleServerAction</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ACTION_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;getServerActionRequestMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;actionId&quot;</span><span class="s0">,</span><span class="s1">&quot;contentType&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;Headers&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;isURLEncodedAction&quot;</span><span class="s0">,</span><span class="s1">&quot;Boolean&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;isMultipartAction&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;isFetchAction&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;isPossibleServerAction&quot;</span><span class="s0">,</span><span class="s1">&quot;getIsPossibleServerAction&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAGA,SAASA,aAAa,QAAQ,6CAA4C;;AAEnE,SAASC,+BACdC,GAAoD;IAQpD,IAAIC;IACJ,IAAIC;IAEJ,IAAIF,IAAIG,OAAO,YAAYC,SAAS;QAClCH,WAAWD,IAAIG,OAAO,CAACE,GAAG,CAACP,wMAAAA,KAAkB;QAC7CI,cAAcF,IAAIG,OAAO,CAACE,GAAG,CAAC;IAChC,OAAO;QACLJ,WAAYD,IAAIG,OAAO,CAACL,wMAAAA,CAAc,IAAe;QACrDI,cAAcF,IAAIG,OAAO,CAAC,eAAe,IAAI;IAC/C;IAEA,MAAMG,qBAAqBC,QACzBP,IAAIQ,MAAM,KAAK,UAAUN,gBAAgB;IAE3C,MAAMO,oBAAoBF,QACxBP,IAAIQ,MAAM,KAAK,UAAA,CAAUN,eAAAA,OAAAA,KAAAA,IAAAA,YAAaQ,UAAU,CAAC,sBAAA;IAEnD,MAAMC,gBAAgBJ,QACpBN,aAAaW,aACX,OAAOX,aAAa,YACpBD,IAAIQ,MAAM,KAAK;IAGnB,MAAMK,yBAAyBN,QAC7BI,iBAAiBL,sBAAsBG;IAGzC,OAAO;QACLR;QACAK;QACAG;QACAE;QACAE;IACF;AACF;AAEO,SAASC,0BACdd,GAAoD;IAEpD,OAAOD,+BAA+BC,KAAKa,sBAAsB;AACnE&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1979</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/lib/fallback.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Describes the different fallback modes that a given page can have.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const enum FallbackMode {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* A BLOCKING_STATIC_RENDER fallback will block the request until the page is</span><span class="s3">\n   </span><span class="s1">* generated. No fallback page will be rendered, and users will have to wait</span><span class="s3">\n   </span><span class="s1">* to render the page.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">BLOCKING_STATIC_RENDER = 'BLOCKING_STATIC_RENDER',</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* When set to PRERENDER, a fallback page will be sent to users in place of</span><span class="s3">\n   </span><span class="s1">* forcing them to wait for the page to be generated. This allows the user to</span><span class="s3">\n   </span><span class="s1">* see a rendered page earlier.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">PRERENDER = 'PRERENDER',</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* When set to NOT_FOUND, pages that are not already prerendered will result</span><span class="s3">\n   </span><span class="s1">* in a not found response.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">NOT_FOUND = 'NOT_FOUND',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* The fallback value returned from the `getStaticPaths` function.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export type GetStaticPathsFallback = boolean | 'blocking'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Parses the fallback field from the prerender manifest.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param fallbackField The fallback field from the prerender manifest.</span><span class="s3">\n </span><span class="s1">* @returns The fallback mode.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function parseFallbackField(</span><span class="s3">\n  </span><span class="s1">fallbackField: string | boolean | null | undefined</span><span class="s3">\n</span><span class="s1">): FallbackMode | undefined {</span><span class="s3">\n  </span><span class="s1">if (typeof fallbackField === 'string') {</span><span class="s3">\n    </span><span class="s1">return FallbackMode.PRERENDER</span><span class="s3">\n  </span><span class="s1">} else if (fallbackField === null) {</span><span class="s3">\n    </span><span class="s1">return FallbackMode.BLOCKING_STATIC_RENDER</span><span class="s3">\n  </span><span class="s1">} else if (fallbackField === false) {</span><span class="s3">\n    </span><span class="s1">return FallbackMode.NOT_FOUND</span><span class="s3">\n  </span><span class="s1">} else if (fallbackField === undefined) {</span><span class="s3">\n    </span><span class="s1">return undefined</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Invalid fallback option: ${fallbackField}. Fallback option must be a string, null, undefined, or false.`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function fallbackModeToFallbackField(</span><span class="s3">\n  </span><span class="s1">fallback: FallbackMode,</span><span class="s3">\n  </span><span class="s1">page: string | undefined</span><span class="s3">\n</span><span class="s1">): string | false | null {</span><span class="s3">\n  </span><span class="s1">switch (fallback) {</span><span class="s3">\n    </span><span class="s1">case FallbackMode.BLOCKING_STATIC_RENDER:</span><span class="s3">\n      </span><span class="s1">return null</span><span class="s3">\n    </span><span class="s1">case FallbackMode.NOT_FOUND:</span><span class="s3">\n      </span><span class="s1">return false</span><span class="s3">\n    </span><span class="s1">case FallbackMode.PRERENDER:</span><span class="s3">\n      </span><span class="s1">if (!page) {</span><span class="s3">\n        </span><span class="s1">throw new Error(</span><span class="s3">\n          </span><span class="s1">`Invariant: expected a page to be provided when fallback mode is </span><span class="s3">\&quot;</span><span class="s1">${fallback}</span><span class="s3">\&quot;</span><span class="s1">`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return page</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">throw new Error(`Invalid fallback mode: ${fallback}`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Parses the fallback from the static paths result.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param result The result from the static paths function.</span><span class="s3">\n </span><span class="s1">* @returns The fallback mode.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function parseStaticPathsResult(</span><span class="s3">\n  </span><span class="s1">result: GetStaticPathsFallback</span><span class="s3">\n</span><span class="s1">): FallbackMode {</span><span class="s3">\n  </span><span class="s1">if (result === true) {</span><span class="s3">\n    </span><span class="s1">return FallbackMode.PRERENDER</span><span class="s3">\n  </span><span class="s1">} else if (result === 'blocking') {</span><span class="s3">\n    </span><span class="s1">return FallbackMode.BLOCKING_STATIC_RENDER</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">return FallbackMode.NOT_FOUND</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;FallbackMode&quot;</span><span class="s0">,</span><span class="s1">&quot;parseFallbackField&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackField&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackModeToFallbackField&quot;</span><span class="s0">,</span><span class="s1">&quot;fallback&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;parseStaticPathsResult&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;CAEC,GACD;;;;;;;;;;AAAO,IAAWA,eAAAA,WAAAA,GAAAA,SAAAA,YAAAA;IAChB;;;;GAIC,GAAA,YAAA,CAAA,yBAAA,GAAA;IAGD;;;;GAIC,GAAA,YAAA,CAAA,YAAA,GAAA;IAGD;;;GAGC,GAAA,YAAA,CAAA,YAAA,GAAA;WAlBeA;MAoBjB;AAaM,SAASC,mBACdC,aAAkD;IAElD,IAAI,OAAOA,kBAAkB,UAAU;QACrC,OAAA;IACF,OAAO,IAAIA,kBAAkB,MAAM;QACjC,OAAA;IACF,OAAO,IAAIA,kBAAkB,OAAO;QAClC,OAAA;IACF,OAAO,IAAIA,kBAAkBC,WAAW;QACtC,OAAOA;IACT,OAAO;QACL,MAAM,OAAA,cAEL,CAFK,IAAIC,MACR,CAAC,yBAAyB,EAAEF,cAAc,8DAA8D,CAAC,GADrG,qBAAA;mBAAA;wBAAA;0BAAA;QAEN;IACF;AACF;AAEO,SAASG,4BACdC,QAAsB,EACtBC,IAAwB;IAExB,OAAQD;QACN,KAAA;YACE,OAAO;QACT,KAAA;YACE,OAAO;QACT,KAAA;YACE,IAAI,CAACC,MAAM;gBACT,MAAM,OAAA,cAEL,CAFK,IAAIH,MACR,CAAC,iEAAiE,EAAEE,SAAS,CAAC,CAAC,GAD3E,qBAAA;2BAAA;gCAAA;kCAAA;gBAEN;YACF;YAEA,OAAOC;QACT;YACE,MAAM,OAAA,cAA+C,CAA/C,IAAIH,MAAM,CAAC,uBAAuB,EAAEE,UAAU,GAA9C,qBAAA;uBAAA;4BAAA;8BAAA;YAA8C;IACxD;AACF;AAQO,SAASE,uBACdC,MAA8B;IAE9B,IAAIA,WAAW,MAAM;QACnB,OAAA;IACF,OAAO,IAAIA,WAAW,YAAY;QAChC,OAAA;IACF,OAAO;QACL,OAAA;IACF;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2061</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/etag.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* FNV-1a Hash implementation</span><span class="s3">\n </span><span class="s1">* @author Travis Webb (tjwebb) &lt;me@traviswebb.com&gt;</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Ported from https://github.com/tjwebb/fnv-plus/blob/master/index.js</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Simplified, optimized and add modified for 52 bit, which provides a larger hash space</span><span class="s3">\n </span><span class="s1">* and still making use of Javascript's 53-bit integer space.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const fnv1a52 = (str: string) =&gt; {</span><span class="s3">\n  </span><span class="s1">const len = str.length</span><span class="s3">\n  </span><span class="s1">let i = 0,</span><span class="s3">\n    </span><span class="s1">t0 = 0,</span><span class="s3">\n    </span><span class="s1">v0 = 0x2325,</span><span class="s3">\n    </span><span class="s1">t1 = 0,</span><span class="s3">\n    </span><span class="s1">v1 = 0x8422,</span><span class="s3">\n    </span><span class="s1">t2 = 0,</span><span class="s3">\n    </span><span class="s1">v2 = 0x9ce4,</span><span class="s3">\n    </span><span class="s1">t3 = 0,</span><span class="s3">\n    </span><span class="s1">v3 = 0xcbf2</span><span class="s3">\n\n  </span><span class="s1">while (i &lt; len) {</span><span class="s3">\n    </span><span class="s1">v0 ^= str.charCodeAt(i++)</span><span class="s3">\n    </span><span class="s1">t0 = v0 * 435</span><span class="s3">\n    </span><span class="s1">t1 = v1 * 435</span><span class="s3">\n    </span><span class="s1">t2 = v2 * 435</span><span class="s3">\n    </span><span class="s1">t3 = v3 * 435</span><span class="s3">\n    </span><span class="s1">t2 += v0 &lt;&lt; 8</span><span class="s3">\n    </span><span class="s1">t3 += v1 &lt;&lt; 8</span><span class="s3">\n    </span><span class="s1">t1 += t0 &gt;&gt;&gt; 16</span><span class="s3">\n    </span><span class="s1">v0 = t0 &amp; 65535</span><span class="s3">\n    </span><span class="s1">t2 += t1 &gt;&gt;&gt; 16</span><span class="s3">\n    </span><span class="s1">v1 = t1 &amp; 65535</span><span class="s3">\n    </span><span class="s1">v3 = (t3 + (t2 &gt;&gt;&gt; 16)) &amp; 65535</span><span class="s3">\n    </span><span class="s1">v2 = t2 &amp; 65535</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">(v3 &amp; 15) * 281474976710656 +</span><span class="s3">\n    </span><span class="s1">v2 * 4294967296 +</span><span class="s3">\n    </span><span class="s1">v1 * 65536 +</span><span class="s3">\n    </span><span class="s1">(v0 ^ (v3 &gt;&gt; 4))</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const generateETag = (payload: string, weak = false) =&gt; {</span><span class="s3">\n  </span><span class="s1">const prefix = weak ? 'W/</span><span class="s3">\&quot;</span><span class="s1">' : '</span><span class="s3">\&quot;</span><span class="s1">'</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">prefix + fnv1a52(payload).toString(36) + payload.length.toString(36) + '</span><span class="s3">\&quot;</span><span class="s1">'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;fnv1a52&quot;</span><span class="s0">,</span><span class="s1">&quot;str&quot;</span><span class="s0">,</span><span class="s1">&quot;len&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;t0&quot;</span><span class="s0">,</span><span class="s1">&quot;v0&quot;</span><span class="s0">,</span><span class="s1">&quot;t1&quot;</span><span class="s0">,</span><span class="s1">&quot;v1&quot;</span><span class="s0">,</span><span class="s1">&quot;t2&quot;</span><span class="s0">,</span><span class="s1">&quot;v2&quot;</span><span class="s0">,</span><span class="s1">&quot;t3&quot;</span><span class="s0">,</span><span class="s1">&quot;v3&quot;</span><span class="s0">,</span><span class="s1">&quot;charCodeAt&quot;</span><span class="s0">,</span><span class="s1">&quot;generateETag&quot;</span><span class="s0">,</span><span class="s1">&quot;payload&quot;</span><span class="s0">,</span><span class="s1">&quot;weak&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;;;;;;CAQC,GACD;;;;;;AAAO,MAAMA,UAAU,CAACC;IACtB,MAAMC,MAAMD,IAAIE,MAAM;IACtB,IAAIC,IAAI,GACNC,KAAK,GACLC,KAAK,QACLC,KAAK,GACLC,KAAK,QACLC,KAAK,GACLC,KAAK,QACLC,KAAK,GACLC,KAAK;IAEP,MAAOR,IAAIF,IAAK;QACdI,MAAML,IAAIY,UAAU,CAACT;QACrBC,KAAKC,KAAK;QACVC,KAAKC,KAAK;QACVC,KAAKC,KAAK;QACVC,KAAKC,KAAK;QACVH,MAAMH,MAAM;QACZK,MAAMH,MAAM;QACZD,MAAMF,OAAO;QACbC,KAAKD,KAAK;QACVI,MAAMF,OAAO;QACbC,KAAKD,KAAK;QACVK,KAAMD,KAAMF,CAAAA,OAAO,EAAC,IAAM;QAC1BC,KAAKD,KAAK;IACZ;IAEA,OACGG,CAAAA,KAAK,EAAC,IAAK,kBACZF,KAAK,aACLF,KAAK,QACJF,CAAAA,KAAMM,MAAM,CAAC;AAElB,EAAC;AAEM,MAAME,eAAe,CAACC,SAAiBC,OAAO,KAAK;IACxD,MAAMC,SAASD,OAAO,QAAQ;IAC9B,OACEC,SAASjB,QAAQe,SAASG,QAAQ,CAAC,MAAMH,QAAQZ,MAAM,CAACe,QAAQ,CAAC,MAAM;AAE3E,EAAC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2102</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/compiled/fresh/index.js&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;(()=&gt;{</span><span class="s3">\&quot;</span><span class="s1">use strict</span><span class="s3">\&quot;</span><span class="s1">;var e={695:e=&gt;{</span><span class="s3">\n</span><span class="s1">/*!</span><span class="s3">\n </span><span class="s1">* fresh</span><span class="s3">\n </span><span class="s1">* Copyright(c) 2012 TJ Holowaychuk</span><span class="s3">\n </span><span class="s1">* Copyright(c) 2016-2017 Douglas Christopher Wilson</span><span class="s3">\n </span><span class="s1">* MIT Licensed</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">var r=/(?:^|,)</span><span class="s3">\\</span><span class="s1">s*?no-cache</span><span class="s3">\\</span><span class="s1">s*?(?:,|$)/;e.exports=fresh;function fresh(e,a){var t=e[</span><span class="s3">\&quot;</span><span class="s1">if-modified-since</span><span class="s3">\&quot;</span><span class="s1">];var s=e[</span><span class="s3">\&quot;</span><span class="s1">if-none-match</span><span class="s3">\&quot;</span><span class="s1">];if(!t&amp;&amp;!s){return false}var i=e[</span><span class="s3">\&quot;</span><span class="s1">cache-control</span><span class="s3">\&quot;</span><span class="s1">];if(i&amp;&amp;r.test(i)){return false}if(s&amp;&amp;s!==</span><span class="s3">\&quot;</span><span class="s1">*</span><span class="s3">\&quot;</span><span class="s1">){var f=a[</span><span class="s3">\&quot;</span><span class="s1">etag</span><span class="s3">\&quot;</span><span class="s1">];if(!f){return false}var n=true;var u=parseTokenList(s);for(var _=0;_&lt;u.length;_++){var o=u[_];if(o===f||o===</span><span class="s3">\&quot;</span><span class="s1">W/</span><span class="s3">\&quot;</span><span class="s1">+f||</span><span class="s3">\&quot;</span><span class="s1">W/</span><span class="s3">\&quot;</span><span class="s1">+o===f){n=false;break}}if(n){return false}}if(t){var p=a[</span><span class="s3">\&quot;</span><span class="s1">last-modified</span><span class="s3">\&quot;</span><span class="s1">];var v=!p||!(parseHttpDate(p)&lt;=parseHttpDate(t));if(v){return false}}return true}function parseHttpDate(e){var r=e&amp;&amp;Date.parse(e);return typeof r===</span><span class="s3">\&quot;</span><span class="s1">number</span><span class="s3">\&quot;</span><span class="s1">?r:NaN}function parseTokenList(e){var r=0;var a=[];var t=0;for(var s=0,i=e.length;s&lt;i;s++){switch(e.charCodeAt(s)){case 32:if(t===r){t=r=s+1}break;case 44:a.push(e.substring(t,r));t=r=s+1;break;default:r=s+1;break}}a.push(e.substring(t,r));return a}}};var r={};function __nccwpck_require__(a){var t=r[a];if(t!==undefined){return t.exports}var s=r[a]={exports:{}};var i=true;try{e[a](s,s.exports,__nccwpck_require__);i=false}finally{if(i)delete r[a]}return s.exports}if(typeof __nccwpck_require__!==</span><span class="s3">\&quot;</span><span class="s1">undefined</span><span class="s3">\&quot;</span><span class="s1">)__nccwpck_require__.ab=__dirname+</span><span class="s3">\&quot;</span><span class="s1">/</span><span class="s3">\&quot;</span><span class="s1">;var a=__nccwpck_require__(695);module.exports=a})();&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,CAAC;IAAK;IAAa,IAAI,IAAE;QAAC,KAAI,CAAA;YAC9B;;;;;CAKC,GACD,IAAI,IAAE;YAAiC,EAAE,OAAO,GAAC;YAAM,SAAS,MAAM,CAAC,EAAC,CAAC;gBAAE,IAAI,IAAE,CAAC,CAAC,oBAAoB;gBAAC,IAAI,IAAE,CAAC,CAAC,gBAAgB;gBAAC,IAAG,CAAC,KAAG,CAAC,GAAE;oBAAC,OAAO;gBAAK;gBAAC,IAAI,IAAE,CAAC,CAAC,gBAAgB;gBAAC,IAAG,KAAG,EAAE,IAAI,CAAC,IAAG;oBAAC,OAAO;gBAAK;gBAAC,IAAG,KAAG,MAAI,KAAI;oBAAC,IAAI,IAAE,CAAC,CAAC,OAAO;oBAAC,IAAG,CAAC,GAAE;wBAAC,OAAO;oBAAK;oBAAC,IAAI,IAAE;oBAAK,IAAI,IAAE,eAAe;oBAAG,IAAI,IAAI,IAAE,GAAE,IAAE,EAAE,MAAM,EAAC,IAAI;wBAAC,IAAI,IAAE,CAAC,CAAC,EAAE;wBAAC,IAAG,MAAI,KAAG,MAAI,OAAK,KAAG,OAAK,MAAI,GAAE;4BAAC,IAAE;4BAAM;wBAAK;oBAAC;oBAAC,IAAG,GAAE;wBAAC,OAAO;oBAAK;gBAAC;gBAAC,IAAG,GAAE;oBAAC,IAAI,IAAE,CAAC,CAAC,gBAAgB;oBAAC,IAAI,IAAE,CAAC,KAAG,CAAC,CAAC,cAAc,MAAI,cAAc,EAAE;oBAAE,IAAG,GAAE;wBAAC,OAAO;oBAAK;gBAAC;gBAAC,OAAO;YAAI;YAAC,SAAS,cAAc,CAAC;gBAAE,IAAI,IAAE,KAAG,KAAK,KAAK,CAAC;gBAAG,OAAO,OAAO,MAAI,WAAS,IAAE;YAAG;YAAC,SAAS,eAAe,CAAC;gBAAE,IAAI,IAAE;gBAAE,IAAI,IAAE,EAAE;gBAAC,IAAI,IAAE;gBAAE,IAAI,IAAI,IAAE,GAAE,IAAE,EAAE,MAAM,EAAC,IAAE,GAAE,IAAI;oBAAC,OAAO,EAAE,UAAU,CAAC;wBAAI,KAAK;4BAAG,IAAG,MAAI,GAAE;gCAAC,IAAE,IAAE,IAAE;4BAAC;4BAAC;wBAAM,KAAK;4BAAG,EAAE,IAAI,CAAC,EAAE,SAAS,CAAC,GAAE;4BAAI,IAAE,IAAE,IAAE;4BAAE;wBAAM;4BAAQ,IAAE,IAAE;4BAAE;oBAAK;gBAAC;gBAAC,EAAE,IAAI,CAAC,EAAE,SAAS,CAAC,GAAE;gBAAI,OAAO;YAAC;QAAC;IAAC;IAAE,IAAI,IAAE,CAAC;IAAE,SAAS,oBAAoB,CAAC;QAAE,IAAI,IAAE,CAAC,CAAC,EAAE;QAAC,IAAG,MAAI,WAAU;YAAC,OAAO,EAAE,OAAO;QAAA;QAAC,IAAI,IAAE,CAAC,CAAC,EAAE,GAAC;YAAC,SAAQ,CAAC;QAAC;QAAE,IAAI,IAAE;QAAK,IAAG;YAAC,CAAC,CAAC,EAAE,CAAC,GAAE,EAAE,OAAO,EAAC;YAAqB,IAAE;QAAK,SAAQ;YAAC,IAAG,GAAE,OAAO,CAAC,CAAC,EAAE;QAAA;QAAC,OAAO,EAAE,OAAO;IAAA;IAAC,IAAG,OAAO,wBAAsB,aAAY,oBAAoB,EAAE,GAAC,kFAAU;IAAI,IAAI,IAAE,oBAAoB;IAAK,OAAO,OAAO,GAAC;AAAC,CAAC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2205</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/cache-control.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { CACHE_ONE_YEAR } from '../../lib/constants'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* The revalidate option used internally for pages. A value of `false` means</span><span class="s3">\n </span><span class="s1">* that the page should not be revalidated. A number means that the page</span><span class="s3">\n </span><span class="s1">* should be revalidated after the given number of seconds (this also includes</span><span class="s3">\n </span><span class="s1">* `1` which means to revalidate after 1 second). A value of `0` is not a valid</span><span class="s3">\n </span><span class="s1">* value for this option.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export type Revalidate = number | false</span><span class="s3">\n\n</span><span class="s1">export interface CacheControl {</span><span class="s3">\n  </span><span class="s1">revalidate: Revalidate</span><span class="s3">\n  </span><span class="s1">expire: number | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getCacheControlHeader({</span><span class="s3">\n  </span><span class="s1">revalidate,</span><span class="s3">\n  </span><span class="s1">expire,</span><span class="s3">\n</span><span class="s1">}: CacheControl): string {</span><span class="s3">\n  </span><span class="s1">const swrHeader =</span><span class="s3">\n    </span><span class="s1">typeof revalidate === 'number' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">expire !== undefined &amp;&amp;</span><span class="s3">\n    </span><span class="s1">revalidate &lt; expire</span><span class="s3">\n      </span><span class="s1">? `, stale-while-revalidate=${expire - revalidate}`</span><span class="s3">\n      </span><span class="s1">: ''</span><span class="s3">\n\n  </span><span class="s1">if (revalidate === 0) {</span><span class="s3">\n    </span><span class="s1">return 'private, no-cache, no-store, max-age=0, must-revalidate'</span><span class="s3">\n  </span><span class="s1">} else if (typeof revalidate === 'number') {</span><span class="s3">\n    </span><span class="s1">return `s-maxage=${revalidate}${swrHeader}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return `s-maxage=${CACHE_ONE_YEAR}${swrHeader}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;CACHE_ONE_YEAR&quot;</span><span class="s0">,</span><span class="s1">&quot;getCacheControlHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;expire&quot;</span><span class="s0">,</span><span class="s1">&quot;swrHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,cAAc,QAAQ,sBAAqB;;AAgB7C,SAASC,sBAAsB,EACpCC,UAAU,EACVC,MAAM,EACO;IACb,MAAMC,YACJ,OAAOF,eAAe,YACtBC,WAAWE,aACXH,aAAaC,SACT,CAAC,yBAAyB,EAAEA,SAASD,YAAY,GACjD;IAEN,IAAIA,eAAe,GAAG;QACpB,OAAO;IACT,OAAO,IAAI,OAAOA,eAAe,UAAU;QACzC,OAAO,CAAC,SAAS,EAAEA,aAAaE,WAAW;IAC7C;IAEA,OAAO,CAAC,SAAS,EAAEJ,yKAAAA,GAAiBI,WAAW;AACjD&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2224</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/send-payload.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { IncomingMessage, ServerResponse } from 'http'</span><span class="s3">\n</span><span class="s1">import type RenderResult from './render-result'</span><span class="s3">\n</span><span class="s1">import type { CacheControl } from './lib/cache-control'</span><span class="s3">\n\n</span><span class="s1">import { isResSent } from '../shared/lib/utils'</span><span class="s3">\n</span><span class="s1">import { generateETag } from './lib/etag'</span><span class="s3">\n</span><span class="s1">import fresh from 'next/dist/compiled/fresh'</span><span class="s3">\n</span><span class="s1">import { getCacheControlHeader } from './lib/cache-control'</span><span class="s3">\n</span><span class="s1">import { HTML_CONTENT_TYPE_HEADER } from '../lib/constants'</span><span class="s3">\n\n</span><span class="s1">export function sendEtagResponse(</span><span class="s3">\n  </span><span class="s1">req: IncomingMessage,</span><span class="s3">\n  </span><span class="s1">res: ServerResponse,</span><span class="s3">\n  </span><span class="s1">etag: string | undefined</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">if (etag) {</span><span class="s3">\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* The server generating a 304 response MUST generate any of the</span><span class="s3">\n     </span><span class="s1">* following header fields that would have been sent in a 200 (OK)</span><span class="s3">\n     </span><span class="s1">* response to the same request: Cache-Control, Content-Location, Date,</span><span class="s3">\n     </span><span class="s1">* ETag, Expires, and Vary. https://tools.ietf.org/html/rfc7232#section-4.1</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">res.setHeader('ETag', etag)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (fresh(req.headers, { etag })) {</span><span class="s3">\n    </span><span class="s1">res.statusCode = 304</span><span class="s3">\n    </span><span class="s1">res.end()</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function sendRenderResult({</span><span class="s3">\n  </span><span class="s1">req,</span><span class="s3">\n  </span><span class="s1">res,</span><span class="s3">\n  </span><span class="s1">result,</span><span class="s3">\n  </span><span class="s1">generateEtags,</span><span class="s3">\n  </span><span class="s1">poweredByHeader,</span><span class="s3">\n  </span><span class="s1">cacheControl,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">req: IncomingMessage</span><span class="s3">\n  </span><span class="s1">res: ServerResponse</span><span class="s3">\n  </span><span class="s1">result: RenderResult</span><span class="s3">\n  </span><span class="s1">generateEtags: boolean</span><span class="s3">\n  </span><span class="s1">poweredByHeader: boolean</span><span class="s3">\n  </span><span class="s1">cacheControl: CacheControl | undefined</span><span class="s3">\n</span><span class="s1">}): Promise&lt;void&gt; {</span><span class="s3">\n  </span><span class="s1">if (isResSent(res)) {</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (poweredByHeader &amp;&amp; result.contentType === HTML_CONTENT_TYPE_HEADER) {</span><span class="s3">\n    </span><span class="s1">res.setHeader('X-Powered-By', 'Next.js')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If cache control is already set on the response we don't</span><span class="s3">\n  </span><span class="s1">// override it to allow users to customize it via next.config</span><span class="s3">\n  </span><span class="s1">if (cacheControl &amp;&amp; !res.getHeader('Cache-Control')) {</span><span class="s3">\n    </span><span class="s1">res.setHeader('Cache-Control', getCacheControlHeader(cacheControl))</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const payload = result.isDynamic ? null : result.toUnchunkedString()</span><span class="s3">\n\n  </span><span class="s1">if (generateEtags &amp;&amp; payload !== null) {</span><span class="s3">\n    </span><span class="s1">const etag = generateETag(payload)</span><span class="s3">\n    </span><span class="s1">if (sendEtagResponse(req, res, etag)) {</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!res.getHeader('Content-Type') &amp;&amp; result.contentType) {</span><span class="s3">\n    </span><span class="s1">res.setHeader('Content-Type', result.contentType)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (payload) {</span><span class="s3">\n    </span><span class="s1">res.setHeader('Content-Length', Buffer.byteLength(payload))</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (req.method === 'HEAD') {</span><span class="s3">\n    </span><span class="s1">res.end(null)</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (payload !== null) {</span><span class="s3">\n    </span><span class="s1">res.end(payload)</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Pipe the render result to the response after we get a writer for it.</span><span class="s3">\n  </span><span class="s1">await result.pipeToNodeResponse(res)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isResSent&quot;</span><span class="s0">,</span><span class="s1">&quot;generateETag&quot;</span><span class="s0">,</span><span class="s1">&quot;fresh&quot;</span><span class="s0">,</span><span class="s1">&quot;getCacheControlHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;HTML_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;sendEtagResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;etag&quot;</span><span class="s0">,</span><span class="s1">&quot;setHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;sendRenderResult&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;generateEtags&quot;</span><span class="s0">,</span><span class="s1">&quot;poweredByHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheControl&quot;</span><span class="s0">,</span><span class="s1">&quot;contentType&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;payload&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;toUnchunkedString&quot;</span><span class="s0">,</span><span class="s1">&quot;Buffer&quot;</span><span class="s0">,</span><span class="s1">&quot;byteLength&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;pipeToNodeResponse&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAIA,SAASA,SAAS,QAAQ,sBAAqB;AAC/C,SAASC,YAAY,QAAQ,aAAY;AACzC,OAAOC,WAAW,2BAA0B;AAC5C,SAASC,qBAAqB,QAAQ,sBAAqB;AAC3D,SAASC,wBAAwB,QAAQ,mBAAkB;;;;;;AAEpD,SAASC,iBACdC,GAAoB,EACpBC,GAAmB,EACnBC,IAAwB;IAExB,IAAIA,MAAM;QACR;;;;;KAKC,GACDD,IAAIE,SAAS,CAAC,QAAQD;IACxB;IAEA,QAAIN,qKAAAA,EAAMI,IAAII,OAAO,EAAE;QAAEF;IAAK,IAAI;QAChCD,IAAII,UAAU,GAAG;QACjBJ,IAAIK,GAAG;QACP,OAAO;IACT;IAEA,OAAO;AACT;AAEO,eAAeC,iBAAiB,EACrCP,GAAG,EACHC,GAAG,EACHO,MAAM,EACNC,aAAa,EACbC,eAAe,EACfC,YAAY,EAQb;IACC,QAAIjB,0KAAAA,EAAUO,MAAM;QAClB;IACF;IAEA,IAAIS,mBAAmBF,OAAOI,WAAW,KAAKd,mLAAAA,EAA0B;QACtEG,IAAIE,SAAS,CAAC,gBAAgB;IAChC;IAEA,2DAA2D;IAC3D,6DAA6D;IAC7D,IAAIQ,gBAAgB,CAACV,IAAIY,SAAS,CAAC,kBAAkB;QACnDZ,IAAIE,SAAS,CAAC,qBAAiBN,iMAAAA,EAAsBc;IACvD;IAEA,MAAMG,UAAUN,OAAOO,SAAS,GAAG,OAAOP,OAAOQ,iBAAiB;IAElE,IAAIP,iBAAiBK,YAAY,MAAM;QACrC,MAAMZ,WAAOP,4KAAAA,EAAamB;QAC1B,IAAIf,iBAAiBC,KAAKC,KAAKC,OAAO;YACpC;QACF;IACF;IAEA,IAAI,CAACD,IAAIY,SAAS,CAAC,mBAAmBL,OAAOI,WAAW,EAAE;QACxDX,IAAIE,SAAS,CAAC,gBAAgBK,OAAOI,WAAW;IAClD;IAEA,IAAIE,SAAS;QACXb,IAAIE,SAAS,CAAC,kBAAkBc,OAAOC,UAAU,CAACJ;IACpD;IAEA,IAAId,IAAImB,MAAM,KAAK,QAAQ;QACzBlB,IAAIK,GAAG,CAAC;QACR;IACF;IAEA,IAAIQ,YAAY,MAAM;QACpBb,IAAIK,GAAG,CAACQ;QACR;IACF;IAEA,uEAAuE;IACvE,MAAMN,OAAOY,kBAAkB,CAACnB;AAClC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2307</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/build/templates/app-page.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { LoaderTree } from '../../server/lib/app-dir-module'</span><span class="s3">\n</span><span class="s1">import type { IncomingMessage, ServerResponse } from 'node:http'</span><span class="s3">\n\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">AppPageRouteModule,</span><span class="s3">\n  </span><span class="s1">type AppPageRouteHandlerContext,</span><span class="s3">\n</span><span class="s1">} from '../../server/route-modules/app-page/module.compiled' with { 'turbopack-transition': 'next-ssr' }</span><span class="s3">\n\n</span><span class="s1">import { RouteKind } from '../../server/route-kind' with { 'turbopack-transition': 'next-server-utility' }</span><span class="s3">\n\n</span><span class="s1">import { getRevalidateReason } from '../../server/instrumentation/utils'</span><span class="s3">\n</span><span class="s1">import { getTracer, SpanKind, type Span } from '../../server/lib/trace/tracer'</span><span class="s3">\n</span><span class="s1">import { getRequestMeta } from '../../server/request-meta'</span><span class="s3">\n</span><span class="s1">import { BaseServerSpan } from '../../server/lib/trace/constants'</span><span class="s3">\n</span><span class="s1">import { interopDefault } from '../../server/app-render/interop-default'</span><span class="s3">\n</span><span class="s1">import { stripFlightHeaders } from '../../server/app-render/strip-flight-headers'</span><span class="s3">\n</span><span class="s1">import { NodeNextRequest, NodeNextResponse } from '../../server/base-http/node'</span><span class="s3">\n</span><span class="s1">import { checkIsAppPPREnabled } from '../../server/lib/experimental/ppr'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">getFallbackRouteParams,</span><span class="s3">\n  </span><span class="s1">type FallbackRouteParams,</span><span class="s3">\n</span><span class="s1">} from '../../server/request/fallback-params'</span><span class="s3">\n</span><span class="s1">import { setReferenceManifestsSingleton } from '../../server/app-render/encryption-utils'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">isHtmlBotRequest,</span><span class="s3">\n  </span><span class="s1">shouldServeStreamingMetadata,</span><span class="s3">\n</span><span class="s1">} from '../../server/lib/streaming-metadata'</span><span class="s3">\n</span><span class="s1">import { createServerModuleMap } from '../../server/app-render/action-utils'</span><span class="s3">\n</span><span class="s1">import { normalizeAppPath } from '../../shared/lib/router/utils/app-paths'</span><span class="s3">\n</span><span class="s1">import { getIsPossibleServerAction } from '../../server/lib/server-action-request-meta'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">RSC_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_ROUTER_PREFETCH_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_IS_PRERENDER_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_DID_POSTPONE_HEADER,</span><span class="s3">\n  </span><span class="s1">RSC_CONTENT_TYPE_HEADER,</span><span class="s3">\n</span><span class="s1">} from '../../client/components/app-router-headers'</span><span class="s3">\n</span><span class="s1">import { getBotType, isBot } from '../../shared/lib/router/utils/is-bot'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">CachedRouteKind,</span><span class="s3">\n  </span><span class="s1">type CachedAppPageValue,</span><span class="s3">\n  </span><span class="s1">type CachedPageValue,</span><span class="s3">\n  </span><span class="s1">type ResponseCacheEntry,</span><span class="s3">\n  </span><span class="s1">type ResponseGenerator,</span><span class="s3">\n</span><span class="s1">} from '../../server/response-cache'</span><span class="s3">\n</span><span class="s1">import { FallbackMode, parseFallbackField } from '../../lib/fallback'</span><span class="s3">\n</span><span class="s1">import RenderResult from '../../server/render-result'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">CACHE_ONE_YEAR,</span><span class="s3">\n  </span><span class="s1">HTML_CONTENT_TYPE_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_CACHE_TAGS_HEADER,</span><span class="s3">\n</span><span class="s1">} from '../../lib/constants'</span><span class="s3">\n</span><span class="s1">import type { CacheControl } from '../../server/lib/cache-control'</span><span class="s3">\n</span><span class="s1">import { ENCODED_TAGS } from '../../server/stream-utils/encoded-tags'</span><span class="s3">\n</span><span class="s1">import { sendRenderResult } from '../../server/send-payload'</span><span class="s3">\n</span><span class="s1">import { NoFallbackError } from '../../shared/lib/no-fallback-error.external'</span><span class="s3">\n\n</span><span class="s1">// These are injected by the loader afterwards.</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* The tree created in next-app-loader that holds component segments and modules</span><span class="s3">\n </span><span class="s1">* and I've updated it.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">declare const tree: LoaderTree</span><span class="s3">\n</span><span class="s1">declare const pages: any</span><span class="s3">\n\n</span><span class="s1">// We inject the tree and pages here so that we can use them in the route</span><span class="s3">\n</span><span class="s1">// module.</span><span class="s3">\n</span><span class="s1">// INJECT:tree</span><span class="s3">\n</span><span class="s1">// INJECT:pages</span><span class="s3">\n\n</span><span class="s1">export { tree, pages }</span><span class="s3">\n\n</span><span class="s1">import GlobalError from 'VAR_MODULE_GLOBAL_ERROR' with { 'turbopack-transition': 'next-server-utility' }</span><span class="s3">\n\n</span><span class="s1">export { GlobalError }</span><span class="s3">\n\n</span><span class="s1">// These are injected by the loader afterwards.</span><span class="s3">\n</span><span class="s1">declare const __next_app_require__: (id: string | number) =&gt; unknown</span><span class="s3">\n</span><span class="s1">declare const __next_app_load_chunk__: (id: string | number) =&gt; Promise&lt;unknown&gt;</span><span class="s3">\n\n</span><span class="s1">// INJECT:__next_app_require__</span><span class="s3">\n</span><span class="s1">// INJECT:__next_app_load_chunk__</span><span class="s3">\n\n</span><span class="s1">export const __next_app__ = {</span><span class="s3">\n  </span><span class="s1">require: __next_app_require__,</span><span class="s3">\n  </span><span class="s1">loadChunk: __next_app_load_chunk__,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">import * as entryBase from '../../server/app-render/entry-base' with { 'turbopack-transition': 'next-server-utility' }</span><span class="s3">\n</span><span class="s1">import { RedirectStatusCode } from '../../client/components/redirect-status-code'</span><span class="s3">\n\n</span><span class="s1">export * from '../../server/app-render/entry-base' with { 'turbopack-transition': 'next-server-utility' }</span><span class="s3">\n\n</span><span class="s1">// Create and export the route module that will be consumed.</span><span class="s3">\n</span><span class="s1">export const routeModule = new AppPageRouteModule({</span><span class="s3">\n  </span><span class="s1">definition: {</span><span class="s3">\n    </span><span class="s1">kind: RouteKind.APP_PAGE,</span><span class="s3">\n    </span><span class="s1">page: 'VAR_DEFINITION_PAGE',</span><span class="s3">\n    </span><span class="s1">pathname: 'VAR_DEFINITION_PATHNAME',</span><span class="s3">\n    </span><span class="s1">// The following aren't used in production.</span><span class="s3">\n    </span><span class="s1">bundlePath: '',</span><span class="s3">\n    </span><span class="s1">filename: '',</span><span class="s3">\n    </span><span class="s1">appPaths: [],</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">userland: {</span><span class="s3">\n    </span><span class="s1">loaderTree: tree,</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',</span><span class="s3">\n  </span><span class="s1">relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',</span><span class="s3">\n</span><span class="s1">})</span><span class="s3">\n\n</span><span class="s1">export async function handler(</span><span class="s3">\n  </span><span class="s1">req: IncomingMessage,</span><span class="s3">\n  </span><span class="s1">res: ServerResponse,</span><span class="s3">\n  </span><span class="s1">ctx: {</span><span class="s3">\n    </span><span class="s1">waitUntil: (prom: Promise&lt;void&gt;) =&gt; void</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">let srcPage = 'VAR_DEFINITION_PAGE'</span><span class="s3">\n\n  </span><span class="s1">// turbopack doesn't normalize `/index` in the page name</span><span class="s3">\n  </span><span class="s1">// so we need to to process dynamic routes properly</span><span class="s3">\n  </span><span class="s1">// TODO: fix turbopack providing differing value from webpack</span><span class="s3">\n  </span><span class="s1">if (process.env.TURBOPACK) {</span><span class="s3">\n    </span><span class="s1">srcPage = srcPage.replace(/</span><span class="s3">\\</span><span class="s1">/index$/, '') || '/'</span><span class="s3">\n  </span><span class="s1">} else if (srcPage === '/index') {</span><span class="s3">\n    </span><span class="s1">// we always normalize /index specifically</span><span class="s3">\n    </span><span class="s1">srcPage = '/'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const multiZoneDraftMode = process.env</span><span class="s3">\n    </span><span class="s1">.__NEXT_MULTI_ZONE_DRAFT_MODE as any as boolean</span><span class="s3">\n\n  </span><span class="s1">const initialPostponed = getRequestMeta(req, 'postponed')</span><span class="s3">\n  </span><span class="s1">// TODO: replace with more specific flags</span><span class="s3">\n  </span><span class="s1">const minimalMode = getRequestMeta(req, 'minimalMode')</span><span class="s3">\n\n  </span><span class="s1">const prepareResult = await routeModule.prepare(req, res, {</span><span class="s3">\n    </span><span class="s1">srcPage,</span><span class="s3">\n    </span><span class="s1">multiZoneDraftMode,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">if (!prepareResult) {</span><span class="s3">\n    </span><span class="s1">res.statusCode = 400</span><span class="s3">\n    </span><span class="s1">res.end('Bad Request')</span><span class="s3">\n    </span><span class="s1">ctx.waitUntil?.(Promise.resolve())</span><span class="s3">\n    </span><span class="s1">return null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const {</span><span class="s3">\n    </span><span class="s1">buildId,</span><span class="s3">\n    </span><span class="s1">query,</span><span class="s3">\n    </span><span class="s1">params,</span><span class="s3">\n    </span><span class="s1">parsedUrl,</span><span class="s3">\n    </span><span class="s1">pageIsDynamic,</span><span class="s3">\n    </span><span class="s1">buildManifest,</span><span class="s3">\n    </span><span class="s1">nextFontManifest,</span><span class="s3">\n    </span><span class="s1">reactLoadableManifest,</span><span class="s3">\n    </span><span class="s1">serverActionsManifest,</span><span class="s3">\n    </span><span class="s1">clientReferenceManifest,</span><span class="s3">\n    </span><span class="s1">subresourceIntegrityManifest,</span><span class="s3">\n    </span><span class="s1">prerenderManifest,</span><span class="s3">\n    </span><span class="s1">isDraftMode,</span><span class="s3">\n    </span><span class="s1">resolvedPathname,</span><span class="s3">\n    </span><span class="s1">revalidateOnlyGenerated,</span><span class="s3">\n    </span><span class="s1">routerServerContext,</span><span class="s3">\n    </span><span class="s1">nextConfig,</span><span class="s3">\n    </span><span class="s1">interceptionRoutePatterns,</span><span class="s3">\n  </span><span class="s1">} = prepareResult</span><span class="s3">\n\n  </span><span class="s1">const pathname = parsedUrl.pathname || '/'</span><span class="s3">\n  </span><span class="s1">const normalizedSrcPage = normalizeAppPath(srcPage)</span><span class="s3">\n\n  </span><span class="s1">let { isOnDemandRevalidate } = prepareResult</span><span class="s3">\n\n  </span><span class="s1">const prerenderInfo = routeModule.match(pathname, prerenderManifest)</span><span class="s3">\n  </span><span class="s1">const isPrerendered = !!prerenderManifest.routes[resolvedPathname]</span><span class="s3">\n\n  </span><span class="s1">let isSSG = Boolean(</span><span class="s3">\n    </span><span class="s1">prerenderInfo ||</span><span class="s3">\n      </span><span class="s1">isPrerendered ||</span><span class="s3">\n      </span><span class="s1">prerenderManifest.routes[normalizedSrcPage]</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">const userAgent = req.headers['user-agent'] || ''</span><span class="s3">\n  </span><span class="s1">const botType = getBotType(userAgent)</span><span class="s3">\n  </span><span class="s1">const isHtmlBot = isHtmlBotRequest(req)</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If true, this indicates that the request being made is for an app</span><span class="s3">\n   </span><span class="s1">* prefetch request.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">const isPrefetchRSCRequest =</span><span class="s3">\n    </span><span class="s1">getRequestMeta(req, 'isPrefetchRSCRequest') ??</span><span class="s3">\n    </span><span class="s1">req.headers[NEXT_ROUTER_PREFETCH_HEADER] === '1' // exclude runtime prefetches, which use '2'</span><span class="s3">\n\n  </span><span class="s1">// NOTE: Don't delete headers[RSC] yet, it still needs to be used in renderToHTML later</span><span class="s3">\n\n  </span><span class="s1">const isRSCRequest =</span><span class="s3">\n    </span><span class="s1">getRequestMeta(req, 'isRSCRequest') ?? Boolean(req.headers[RSC_HEADER])</span><span class="s3">\n\n  </span><span class="s1">const isPossibleServerAction = getIsPossibleServerAction(req)</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If the route being rendered is an app page, and the ppr feature has been</span><span class="s3">\n   </span><span class="s1">* enabled, then the given route _could_ support PPR.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">const couldSupportPPR: boolean = checkIsAppPPREnabled(</span><span class="s3">\n    </span><span class="s1">nextConfig.experimental.ppr</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">// When enabled, this will allow the use of the `?__nextppronly` query to</span><span class="s3">\n  </span><span class="s1">// enable debugging of the static shell.</span><span class="s3">\n  </span><span class="s1">const hasDebugStaticShellQuery =</span><span class="s3">\n    </span><span class="s1">process.env.__NEXT_EXPERIMENTAL_STATIC_SHELL_DEBUGGING === '1' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof query.__nextppronly !== 'undefined' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">couldSupportPPR</span><span class="s3">\n\n  </span><span class="s1">// When enabled, this will allow the use of the `?__nextppronly` query</span><span class="s3">\n  </span><span class="s1">// to enable debugging of the fallback shell.</span><span class="s3">\n  </span><span class="s1">const hasDebugFallbackShellQuery =</span><span class="s3">\n    </span><span class="s1">hasDebugStaticShellQuery &amp;&amp; query.__nextppronly === 'fallback'</span><span class="s3">\n\n  </span><span class="s1">// This page supports PPR if it is marked as being `PARTIALLY_STATIC` in the</span><span class="s3">\n  </span><span class="s1">// prerender manifest and this is an app page.</span><span class="s3">\n  </span><span class="s1">const isRoutePPREnabled: boolean =</span><span class="s3">\n    </span><span class="s1">couldSupportPPR &amp;&amp;</span><span class="s3">\n    </span><span class="s1">((</span><span class="s3">\n      </span><span class="s1">prerenderManifest.routes[normalizedSrcPage] ??</span><span class="s3">\n      </span><span class="s1">prerenderManifest.dynamicRoutes[normalizedSrcPage]</span><span class="s3">\n    </span><span class="s1">)?.renderingMode === 'PARTIALLY_STATIC' ||</span><span class="s3">\n      </span><span class="s1">// Ideally we'd want to check the appConfig to see if this page has PPR</span><span class="s3">\n      </span><span class="s1">// enabled or not, but that would require plumbing the appConfig through</span><span class="s3">\n      </span><span class="s1">// to the server during development. We assume that the page supports it</span><span class="s3">\n      </span><span class="s1">// but only during development.</span><span class="s3">\n      </span><span class="s1">(hasDebugStaticShellQuery &amp;&amp;</span><span class="s3">\n        </span><span class="s1">(routeModule.isDev === true ||</span><span class="s3">\n          </span><span class="s1">routerServerContext?.experimentalTestProxy === true)))</span><span class="s3">\n\n  </span><span class="s1">const isDebugStaticShell: boolean =</span><span class="s3">\n    </span><span class="s1">hasDebugStaticShellQuery &amp;&amp; isRoutePPREnabled</span><span class="s3">\n\n  </span><span class="s1">// We should enable debugging dynamic accesses when the static shell</span><span class="s3">\n  </span><span class="s1">// debugging has been enabled and we're also in development mode.</span><span class="s3">\n  </span><span class="s1">const isDebugDynamicAccesses =</span><span class="s3">\n    </span><span class="s1">isDebugStaticShell &amp;&amp; routeModule.isDev === true</span><span class="s3">\n\n  </span><span class="s1">const isDebugFallbackShell = hasDebugFallbackShellQuery &amp;&amp; isRoutePPREnabled</span><span class="s3">\n\n  </span><span class="s1">// If we're in minimal mode, then try to get the postponed information from</span><span class="s3">\n  </span><span class="s1">// the request metadata. If available, use it for resuming the postponed</span><span class="s3">\n  </span><span class="s1">// render.</span><span class="s3">\n  </span><span class="s1">const minimalPostponed = isRoutePPREnabled ? initialPostponed : undefined</span><span class="s3">\n\n  </span><span class="s1">// If PPR is enabled, and this is a RSC request (but not a prefetch), then</span><span class="s3">\n  </span><span class="s1">// we can use this fact to only generate the flight data for the request</span><span class="s3">\n  </span><span class="s1">// because we can't cache the HTML (as it's also dynamic).</span><span class="s3">\n  </span><span class="s1">const isDynamicRSCRequest =</span><span class="s3">\n    </span><span class="s1">isRoutePPREnabled &amp;&amp; isRSCRequest &amp;&amp; !isPrefetchRSCRequest</span><span class="s3">\n\n  </span><span class="s1">// Need to read this before it's stripped by stripFlightHeaders. We don't</span><span class="s3">\n  </span><span class="s1">// need to transfer it to the request meta because it's only read</span><span class="s3">\n  </span><span class="s1">// within this function; the static segment data should have already been</span><span class="s3">\n  </span><span class="s1">// generated, so we will always either return a static response or a 404.</span><span class="s3">\n  </span><span class="s1">const segmentPrefetchHeader = getRequestMeta(req, 'segmentPrefetchRSCRequest')</span><span class="s3">\n\n  </span><span class="s1">// TODO: investigate existing bug with shouldServeStreamingMetadata always</span><span class="s3">\n  </span><span class="s1">// being true for a revalidate due to modifying the base-server this.renderOpts</span><span class="s3">\n  </span><span class="s1">// when fixing this to correct logic it causes hydration issue since we set</span><span class="s3">\n  </span><span class="s1">// serveStreamingMetadata to true during export</span><span class="s3">\n  </span><span class="s1">let serveStreamingMetadata = !userAgent</span><span class="s3">\n    </span><span class="s1">? true</span><span class="s3">\n    </span><span class="s1">: shouldServeStreamingMetadata(userAgent, nextConfig.htmlLimitedBots)</span><span class="s3">\n\n  </span><span class="s1">if (isHtmlBot &amp;&amp; isRoutePPREnabled) {</span><span class="s3">\n    </span><span class="s1">isSSG = false</span><span class="s3">\n    </span><span class="s1">serveStreamingMetadata = false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// In development, we always want to generate dynamic HTML.</span><span class="s3">\n  </span><span class="s1">let supportsDynamicResponse: boolean =</span><span class="s3">\n    </span><span class="s1">// If we're in development, we always support dynamic HTML, unless it's</span><span class="s3">\n    </span><span class="s1">// a data request, in which case we only produce static HTML.</span><span class="s3">\n    </span><span class="s1">routeModule.isDev === true ||</span><span class="s3">\n    </span><span class="s1">// If this is not SSG or does not have static paths, then it supports</span><span class="s3">\n    </span><span class="s1">// dynamic HTML.</span><span class="s3">\n    </span><span class="s1">!isSSG ||</span><span class="s3">\n    </span><span class="s1">// If this request has provided postponed data, it supports dynamic</span><span class="s3">\n    </span><span class="s1">// HTML.</span><span class="s3">\n    </span><span class="s1">typeof initialPostponed === 'string' ||</span><span class="s3">\n    </span><span class="s1">// If this is a dynamic RSC request, then this render supports dynamic</span><span class="s3">\n    </span><span class="s1">// HTML (it's dynamic).</span><span class="s3">\n    </span><span class="s1">isDynamicRSCRequest</span><span class="s3">\n\n  </span><span class="s1">// When html bots request PPR page, perform the full dynamic rendering.</span><span class="s3">\n  </span><span class="s1">const shouldWaitOnAllReady = isHtmlBot &amp;&amp; isRoutePPREnabled</span><span class="s3">\n\n  </span><span class="s1">let ssgCacheKey: string | null = null</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">!isDraftMode &amp;&amp;</span><span class="s3">\n    </span><span class="s1">isSSG &amp;&amp;</span><span class="s3">\n    </span><span class="s1">!supportsDynamicResponse &amp;&amp;</span><span class="s3">\n    </span><span class="s1">!isPossibleServerAction &amp;&amp;</span><span class="s3">\n    </span><span class="s1">!minimalPostponed &amp;&amp;</span><span class="s3">\n    </span><span class="s1">!isDynamicRSCRequest</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">ssgCacheKey = resolvedPathname</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// the staticPathKey differs from ssgCacheKey since</span><span class="s3">\n  </span><span class="s1">// ssgCacheKey is null in dev since we're always in </span><span class="s3">\&quot;</span><span class="s1">dynamic</span><span class="s3">\&quot;\n  </span><span class="s1">// mode in dev to bypass the cache, but we still need to honor</span><span class="s3">\n  </span><span class="s1">// dynamicParams = false in dev mode</span><span class="s3">\n  </span><span class="s1">let staticPathKey = ssgCacheKey</span><span class="s3">\n  </span><span class="s1">if (!staticPathKey &amp;&amp; routeModule.isDev) {</span><span class="s3">\n    </span><span class="s1">staticPathKey = resolvedPathname</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If this is a request for an app path that should be statically generated</span><span class="s3">\n  </span><span class="s1">// and we aren't in the edge runtime, strip the flight headers so it will</span><span class="s3">\n  </span><span class="s1">// generate the static response.</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">!routeModule.isDev &amp;&amp;</span><span class="s3">\n    </span><span class="s1">!isDraftMode &amp;&amp;</span><span class="s3">\n    </span><span class="s1">isSSG &amp;&amp;</span><span class="s3">\n    </span><span class="s1">isRSCRequest &amp;&amp;</span><span class="s3">\n    </span><span class="s1">!isDynamicRSCRequest</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">stripFlightHeaders(req.headers)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const ComponentMod = {</span><span class="s3">\n    </span><span class="s1">...entryBase,</span><span class="s3">\n    </span><span class="s1">tree,</span><span class="s3">\n    </span><span class="s1">pages,</span><span class="s3">\n    </span><span class="s1">GlobalError,</span><span class="s3">\n    </span><span class="s1">handler,</span><span class="s3">\n    </span><span class="s1">routeModule,</span><span class="s3">\n    </span><span class="s1">__next_app__,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Before rendering (which initializes component tree modules), we have to</span><span class="s3">\n  </span><span class="s1">// set the reference manifests to our global store so Server Action's</span><span class="s3">\n  </span><span class="s1">// encryption util can access to them at the top level of the page module.</span><span class="s3">\n  </span><span class="s1">if (serverActionsManifest &amp;&amp; clientReferenceManifest) {</span><span class="s3">\n    </span><span class="s1">setReferenceManifestsSingleton({</span><span class="s3">\n      </span><span class="s1">page: srcPage,</span><span class="s3">\n      </span><span class="s1">clientReferenceManifest,</span><span class="s3">\n      </span><span class="s1">serverActionsManifest,</span><span class="s3">\n      </span><span class="s1">serverModuleMap: createServerModuleMap({</span><span class="s3">\n        </span><span class="s1">serverActionsManifest,</span><span class="s3">\n      </span><span class="s1">}),</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const method = req.method || 'GET'</span><span class="s3">\n  </span><span class="s1">const tracer = getTracer()</span><span class="s3">\n  </span><span class="s1">const activeSpan = tracer.getActiveScopeSpan()</span><span class="s3">\n\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">const varyHeader = routeModule.getVaryHeader(</span><span class="s3">\n      </span><span class="s1">resolvedPathname,</span><span class="s3">\n      </span><span class="s1">interceptionRoutePatterns</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">res.setHeader('Vary', varyHeader)</span><span class="s3">\n    </span><span class="s1">const invokeRouteModule = async (</span><span class="s3">\n      </span><span class="s1">span: Span | undefined,</span><span class="s3">\n      </span><span class="s1">context: AppPageRouteHandlerContext</span><span class="s3">\n    </span><span class="s1">) =&gt; {</span><span class="s3">\n      </span><span class="s1">const nextReq = new NodeNextRequest(req)</span><span class="s3">\n      </span><span class="s1">const nextRes = new NodeNextResponse(res)</span><span class="s3">\n\n      </span><span class="s1">// TODO: adapt for putting the RDC inside the postponed data</span><span class="s3">\n      </span><span class="s1">// If we're in dev, and this isn't a prefetch or a server action,</span><span class="s3">\n      </span><span class="s1">// we should seed the resume data cache.</span><span class="s3">\n      </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">nextConfig.experimental.cacheComponents &amp;&amp;</span><span class="s3">\n          </span><span class="s1">!isPrefetchRSCRequest &amp;&amp;</span><span class="s3">\n          </span><span class="s1">!context.renderOpts.isPossibleServerAction</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">const warmup = await routeModule.warmup(nextReq, nextRes, context)</span><span class="s3">\n\n          </span><span class="s1">// If the warmup is successful, we should use the resume data</span><span class="s3">\n          </span><span class="s1">// cache from the warmup.</span><span class="s3">\n          </span><span class="s1">if (warmup.metadata.renderResumeDataCache) {</span><span class="s3">\n            </span><span class="s1">context.renderOpts.renderResumeDataCache =</span><span class="s3">\n              </span><span class="s1">warmup.metadata.renderResumeDataCache</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return routeModule.render(nextReq, nextRes, context).finally(() =&gt; {</span><span class="s3">\n        </span><span class="s1">if (!span) return</span><span class="s3">\n\n        </span><span class="s1">span.setAttributes({</span><span class="s3">\n          </span><span class="s1">'http.status_code': res.statusCode,</span><span class="s3">\n          </span><span class="s1">'next.rsc': false,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n\n        </span><span class="s1">const rootSpanAttributes = tracer.getRootSpanAttributes()</span><span class="s3">\n        </span><span class="s1">// We were unable to get attributes, probably OTEL is not enabled</span><span class="s3">\n        </span><span class="s1">if (!rootSpanAttributes) {</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">rootSpanAttributes.get('next.span_type') !==</span><span class="s3">\n          </span><span class="s1">BaseServerSpan.handleRequest</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">console.warn(</span><span class="s3">\n            </span><span class="s1">`Unexpected root span type '${rootSpanAttributes.get(</span><span class="s3">\n              </span><span class="s1">'next.span_type'</span><span class="s3">\n            </span><span class="s1">)}'. Please report this Next.js issue https://github.com/vercel/next.js`</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const route = rootSpanAttributes.get('next.route')</span><span class="s3">\n        </span><span class="s1">if (route) {</span><span class="s3">\n          </span><span class="s1">const name = `${method} ${route}`</span><span class="s3">\n\n          </span><span class="s1">span.setAttributes({</span><span class="s3">\n            </span><span class="s1">'next.route': route,</span><span class="s3">\n            </span><span class="s1">'http.route': route,</span><span class="s3">\n            </span><span class="s1">'next.span_name': name,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">span.updateName(name)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">span.updateName(`${method} ${req.url}`)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const doRender = async ({</span><span class="s3">\n      </span><span class="s1">span,</span><span class="s3">\n      </span><span class="s1">postponed,</span><span class="s3">\n      </span><span class="s1">fallbackRouteParams,</span><span class="s3">\n    </span><span class="s1">}: {</span><span class="s3">\n      </span><span class="s1">span?: Span</span><span class="s3">\n      </span><span class="s1">/**</span><span class="s3">\n       </span><span class="s1">* The postponed data for this render. This is only provided when resuming</span><span class="s3">\n       </span><span class="s1">* a render that has been postponed.</span><span class="s3">\n       </span><span class="s1">*/</span><span class="s3">\n      </span><span class="s1">postponed: string | undefined</span><span class="s3">\n\n      </span><span class="s1">/**</span><span class="s3">\n       </span><span class="s1">* The unknown route params for this render.</span><span class="s3">\n       </span><span class="s1">*/</span><span class="s3">\n      </span><span class="s1">fallbackRouteParams: FallbackRouteParams | null</span><span class="s3">\n    </span><span class="s1">}): Promise&lt;ResponseCacheEntry&gt; =&gt; {</span><span class="s3">\n      </span><span class="s1">const context: AppPageRouteHandlerContext = {</span><span class="s3">\n        </span><span class="s1">query,</span><span class="s3">\n        </span><span class="s1">params,</span><span class="s3">\n        </span><span class="s1">page: normalizedSrcPage,</span><span class="s3">\n        </span><span class="s1">sharedContext: {</span><span class="s3">\n          </span><span class="s1">buildId,</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">serverComponentsHmrCache: getRequestMeta(</span><span class="s3">\n          </span><span class="s1">req,</span><span class="s3">\n          </span><span class="s1">'serverComponentsHmrCache'</span><span class="s3">\n        </span><span class="s1">),</span><span class="s3">\n        </span><span class="s1">fallbackRouteParams,</span><span class="s3">\n        </span><span class="s1">renderOpts: {</span><span class="s3">\n          </span><span class="s1">App: () =&gt; null,</span><span class="s3">\n          </span><span class="s1">Document: () =&gt; null,</span><span class="s3">\n          </span><span class="s1">pageConfig: {},</span><span class="s3">\n          </span><span class="s1">ComponentMod,</span><span class="s3">\n          </span><span class="s1">Component: interopDefault(ComponentMod),</span><span class="s3">\n\n          </span><span class="s1">params,</span><span class="s3">\n          </span><span class="s1">routeModule,</span><span class="s3">\n          </span><span class="s1">page: srcPage,</span><span class="s3">\n          </span><span class="s1">postponed,</span><span class="s3">\n          </span><span class="s1">shouldWaitOnAllReady,</span><span class="s3">\n          </span><span class="s1">serveStreamingMetadata,</span><span class="s3">\n          </span><span class="s1">supportsDynamicResponse:</span><span class="s3">\n            </span><span class="s1">typeof postponed === 'string' || supportsDynamicResponse,</span><span class="s3">\n          </span><span class="s1">buildManifest,</span><span class="s3">\n          </span><span class="s1">nextFontManifest,</span><span class="s3">\n          </span><span class="s1">reactLoadableManifest,</span><span class="s3">\n          </span><span class="s1">subresourceIntegrityManifest,</span><span class="s3">\n          </span><span class="s1">serverActionsManifest,</span><span class="s3">\n          </span><span class="s1">clientReferenceManifest,</span><span class="s3">\n          </span><span class="s1">setIsrStatus: routerServerContext?.setIsrStatus,</span><span class="s3">\n\n          </span><span class="s1">dir:</span><span class="s3">\n            </span><span class="s1">process.env.NEXT_RUNTIME === 'nodejs'</span><span class="s3">\n              </span><span class="s1">? (require('path') as typeof import('path')).join(</span><span class="s3">\n                  </span><span class="s1">/* turbopackIgnore: true */</span><span class="s3">\n                  </span><span class="s1">process.cwd(),</span><span class="s3">\n                  </span><span class="s1">routeModule.relativeProjectDir</span><span class="s3">\n                </span><span class="s1">)</span><span class="s3">\n              </span><span class="s1">: `${process.cwd()}/${routeModule.relativeProjectDir}`,</span><span class="s3">\n          </span><span class="s1">isDraftMode,</span><span class="s3">\n          </span><span class="s1">isRevalidate: isSSG &amp;&amp; !postponed &amp;&amp; !isDynamicRSCRequest,</span><span class="s3">\n          </span><span class="s1">botType,</span><span class="s3">\n          </span><span class="s1">isOnDemandRevalidate,</span><span class="s3">\n          </span><span class="s1">isPossibleServerAction,</span><span class="s3">\n          </span><span class="s1">assetPrefix: nextConfig.assetPrefix,</span><span class="s3">\n          </span><span class="s1">nextConfigOutput: nextConfig.output,</span><span class="s3">\n          </span><span class="s1">crossOrigin: nextConfig.crossOrigin,</span><span class="s3">\n          </span><span class="s1">trailingSlash: nextConfig.trailingSlash,</span><span class="s3">\n          </span><span class="s1">previewProps: prerenderManifest.preview,</span><span class="s3">\n          </span><span class="s1">deploymentId: nextConfig.deploymentId,</span><span class="s3">\n          </span><span class="s1">enableTainting: nextConfig.experimental.taint,</span><span class="s3">\n          </span><span class="s1">htmlLimitedBots: nextConfig.htmlLimitedBots,</span><span class="s3">\n          </span><span class="s1">devtoolSegmentExplorer:</span><span class="s3">\n            </span><span class="s1">nextConfig.experimental.devtoolSegmentExplorer,</span><span class="s3">\n          </span><span class="s1">reactMaxHeadersLength: nextConfig.reactMaxHeadersLength,</span><span class="s3">\n\n          </span><span class="s1">multiZoneDraftMode,</span><span class="s3">\n          </span><span class="s1">incrementalCache: getRequestMeta(req, 'incrementalCache'),</span><span class="s3">\n          </span><span class="s1">cacheLifeProfiles: nextConfig.experimental.cacheLife,</span><span class="s3">\n          </span><span class="s1">basePath: nextConfig.basePath,</span><span class="s3">\n          </span><span class="s1">serverActions: nextConfig.experimental.serverActions,</span><span class="s3">\n\n          </span><span class="s1">...(isDebugStaticShell || isDebugDynamicAccesses</span><span class="s3">\n            </span><span class="s1">? {</span><span class="s3">\n                </span><span class="s1">nextExport: true,</span><span class="s3">\n                </span><span class="s1">supportsDynamicResponse: false,</span><span class="s3">\n                </span><span class="s1">isStaticGeneration: true,</span><span class="s3">\n                </span><span class="s1">isRevalidate: true,</span><span class="s3">\n                </span><span class="s1">isDebugDynamicAccesses: isDebugDynamicAccesses,</span><span class="s3">\n              </span><span class="s1">}</span><span class="s3">\n            </span><span class="s1">: {}),</span><span class="s3">\n\n          </span><span class="s1">experimental: {</span><span class="s3">\n            </span><span class="s1">isRoutePPREnabled,</span><span class="s3">\n            </span><span class="s1">expireTime: nextConfig.expireTime,</span><span class="s3">\n            </span><span class="s1">staleTimes: nextConfig.experimental.staleTimes,</span><span class="s3">\n            </span><span class="s1">cacheComponents: Boolean(nextConfig.experimental.cacheComponents),</span><span class="s3">\n            </span><span class="s1">clientSegmentCache: Boolean(</span><span class="s3">\n              </span><span class="s1">nextConfig.experimental.clientSegmentCache</span><span class="s3">\n            </span><span class="s1">),</span><span class="s3">\n            </span><span class="s1">clientParamParsing: Boolean(</span><span class="s3">\n              </span><span class="s1">nextConfig.experimental.clientParamParsing</span><span class="s3">\n            </span><span class="s1">),</span><span class="s3">\n            </span><span class="s1">dynamicOnHover: Boolean(nextConfig.experimental.dynamicOnHover),</span><span class="s3">\n            </span><span class="s1">inlineCss: Boolean(nextConfig.experimental.inlineCss),</span><span class="s3">\n            </span><span class="s1">authInterrupts: Boolean(nextConfig.experimental.authInterrupts),</span><span class="s3">\n            </span><span class="s1">clientTraceMetadata:</span><span class="s3">\n              </span><span class="s1">nextConfig.experimental.clientTraceMetadata || ([] as any),</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n\n          </span><span class="s1">waitUntil: ctx.waitUntil,</span><span class="s3">\n          </span><span class="s1">onClose: (cb) =&gt; {</span><span class="s3">\n            </span><span class="s1">res.on('close', cb)</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">onAfterTaskError: () =&gt; {},</span><span class="s3">\n\n          </span><span class="s1">onInstrumentationRequestError: (error, _request, errorContext) =&gt;</span><span class="s3">\n            </span><span class="s1">routeModule.onRequestError(</span><span class="s3">\n              </span><span class="s1">req,</span><span class="s3">\n              </span><span class="s1">error,</span><span class="s3">\n              </span><span class="s1">errorContext,</span><span class="s3">\n              </span><span class="s1">routerServerContext</span><span class="s3">\n            </span><span class="s1">),</span><span class="s3">\n          </span><span class="s1">err: getRequestMeta(req, 'invokeError'),</span><span class="s3">\n          </span><span class="s1">dev: routeModule.isDev,</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const result = await invokeRouteModule(span, context)</span><span class="s3">\n\n      </span><span class="s1">const { metadata } = result</span><span class="s3">\n\n      </span><span class="s1">const {</span><span class="s3">\n        </span><span class="s1">cacheControl,</span><span class="s3">\n        </span><span class="s1">headers = {},</span><span class="s3">\n        </span><span class="s1">// Add any fetch tags that were on the page to the response headers.</span><span class="s3">\n        </span><span class="s1">fetchTags: cacheTags,</span><span class="s3">\n      </span><span class="s1">} = metadata</span><span class="s3">\n\n      </span><span class="s1">if (cacheTags) {</span><span class="s3">\n        </span><span class="s1">headers[NEXT_CACHE_TAGS_HEADER] = cacheTags</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Pull any fetch metrics from the render onto the request.</span><span class="s3">\n      </span><span class="s1">;(req as any).fetchMetrics = metadata.fetchMetrics</span><span class="s3">\n\n      </span><span class="s1">// we don't throw static to dynamic errors in dev as isSSG</span><span class="s3">\n      </span><span class="s1">// is a best guess in dev since we don't have the prerender pass</span><span class="s3">\n      </span><span class="s1">// to know whether the path is actually static or not</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">isSSG &amp;&amp;</span><span class="s3">\n        </span><span class="s1">cacheControl?.revalidate === 0 &amp;&amp;</span><span class="s3">\n        </span><span class="s1">!routeModule.isDev &amp;&amp;</span><span class="s3">\n        </span><span class="s1">!isRoutePPREnabled</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">const staticBailoutInfo = metadata.staticBailoutInfo</span><span class="s3">\n\n        </span><span class="s1">const err = new Error(</span><span class="s3">\n          </span><span class="s1">`Page changed from static to dynamic at runtime ${resolvedPathname}${</span><span class="s3">\n            </span><span class="s1">staticBailoutInfo?.description</span><span class="s3">\n              </span><span class="s1">? `, reason: ${staticBailoutInfo.description}`</span><span class="s3">\n              </span><span class="s1">: ``</span><span class="s3">\n          </span><span class="s1">}` +</span><span class="s3">\n            </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">nsee more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">if (staticBailoutInfo?.stack) {</span><span class="s3">\n          </span><span class="s1">const stack = staticBailoutInfo.stack</span><span class="s3">\n          </span><span class="s1">err.stack = err.message + stack.substring(stack.indexOf('</span><span class="s3">\\</span><span class="s1">n'))</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">throw err</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return {</span><span class="s3">\n        </span><span class="s1">value: {</span><span class="s3">\n          </span><span class="s1">kind: CachedRouteKind.APP_PAGE,</span><span class="s3">\n          </span><span class="s1">html: result,</span><span class="s3">\n          </span><span class="s1">headers,</span><span class="s3">\n          </span><span class="s1">rscData: metadata.flightData,</span><span class="s3">\n          </span><span class="s1">postponed: metadata.postponed,</span><span class="s3">\n          </span><span class="s1">status: metadata.statusCode,</span><span class="s3">\n          </span><span class="s1">segmentData: metadata.segmentData,</span><span class="s3">\n        </span><span class="s1">} satisfies CachedAppPageValue,</span><span class="s3">\n        </span><span class="s1">cacheControl,</span><span class="s3">\n      </span><span class="s1">} satisfies ResponseCacheEntry</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const responseGenerator: ResponseGenerator = async ({</span><span class="s3">\n      </span><span class="s1">hasResolved,</span><span class="s3">\n      </span><span class="s1">previousCacheEntry,</span><span class="s3">\n      </span><span class="s1">isRevalidating,</span><span class="s3">\n      </span><span class="s1">span,</span><span class="s3">\n    </span><span class="s1">}) =&gt; {</span><span class="s3">\n      </span><span class="s1">const isProduction = routeModule.isDev === false</span><span class="s3">\n      </span><span class="s1">const didRespond = hasResolved || res.writableEnded</span><span class="s3">\n\n      </span><span class="s1">// skip on-demand revalidate if cache is not present and</span><span class="s3">\n      </span><span class="s1">// revalidate-if-generated is set</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">isOnDemandRevalidate &amp;&amp;</span><span class="s3">\n        </span><span class="s1">revalidateOnlyGenerated &amp;&amp;</span><span class="s3">\n        </span><span class="s1">!previousCacheEntry &amp;&amp;</span><span class="s3">\n        </span><span class="s1">!minimalMode</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">if (routerServerContext?.render404) {</span><span class="s3">\n          </span><span class="s1">await routerServerContext.render404(req, res)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">res.statusCode = 404</span><span class="s3">\n          </span><span class="s1">res.end('This page could not be found')</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">return null</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">let fallbackMode: FallbackMode | undefined</span><span class="s3">\n\n      </span><span class="s1">if (prerenderInfo) {</span><span class="s3">\n        </span><span class="s1">fallbackMode = parseFallbackField(prerenderInfo.fallback)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// When serving a HTML bot request, we want to serve a blocking render and</span><span class="s3">\n      </span><span class="s1">// not the prerendered page. This ensures that the correct content is served</span><span class="s3">\n      </span><span class="s1">// to the bot in the head.</span><span class="s3">\n      </span><span class="s1">if (fallbackMode === FallbackMode.PRERENDER &amp;&amp; isBot(userAgent)) {</span><span class="s3">\n        </span><span class="s1">if (!isRoutePPREnabled || isHtmlBot) {</span><span class="s3">\n          </span><span class="s1">fallbackMode = FallbackMode.BLOCKING_STATIC_RENDER</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (previousCacheEntry?.isStale === -1) {</span><span class="s3">\n        </span><span class="s1">isOnDemandRevalidate = true</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// TODO: adapt for PPR</span><span class="s3">\n      </span><span class="s1">// only allow on-demand revalidate for fallback: true/blocking</span><span class="s3">\n      </span><span class="s1">// or for prerendered fallback: false paths</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">isOnDemandRevalidate &amp;&amp;</span><span class="s3">\n        </span><span class="s1">(fallbackMode !== FallbackMode.NOT_FOUND || previousCacheEntry)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">fallbackMode = FallbackMode.BLOCKING_STATIC_RENDER</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">!minimalMode &amp;&amp;</span><span class="s3">\n        </span><span class="s1">fallbackMode !== FallbackMode.BLOCKING_STATIC_RENDER &amp;&amp;</span><span class="s3">\n        </span><span class="s1">staticPathKey &amp;&amp;</span><span class="s3">\n        </span><span class="s1">!didRespond &amp;&amp;</span><span class="s3">\n        </span><span class="s1">!isDraftMode &amp;&amp;</span><span class="s3">\n        </span><span class="s1">pageIsDynamic &amp;&amp;</span><span class="s3">\n        </span><span class="s1">(isProduction || !isPrerendered)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">// if the page has dynamicParams: false and this pathname wasn't</span><span class="s3">\n        </span><span class="s1">// prerendered trigger the no fallback handling</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">// In development, fall through to render to handle missing</span><span class="s3">\n          </span><span class="s1">// getStaticPaths.</span><span class="s3">\n          </span><span class="s1">(isProduction || prerenderInfo) &amp;&amp;</span><span class="s3">\n          </span><span class="s1">// When fallback isn't present, abort this render so we 404</span><span class="s3">\n          </span><span class="s1">fallbackMode === FallbackMode.NOT_FOUND</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">throw new NoFallbackError()</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">let fallbackResponse: ResponseCacheEntry | null | undefined</span><span class="s3">\n\n        </span><span class="s1">if (isRoutePPREnabled &amp;&amp; !isRSCRequest) {</span><span class="s3">\n          </span><span class="s1">const cacheKey =</span><span class="s3">\n            </span><span class="s1">typeof prerenderInfo?.fallback === 'string'</span><span class="s3">\n              </span><span class="s1">? prerenderInfo.fallback</span><span class="s3">\n              </span><span class="s1">: isProduction</span><span class="s3">\n                </span><span class="s1">? normalizedSrcPage</span><span class="s3">\n                </span><span class="s1">: null</span><span class="s3">\n\n          </span><span class="s1">// We use the response cache here to handle the revalidation and</span><span class="s3">\n          </span><span class="s1">// management of the fallback shell.</span><span class="s3">\n          </span><span class="s1">fallbackResponse = await routeModule.handleResponse({</span><span class="s3">\n            </span><span class="s1">cacheKey,</span><span class="s3">\n            </span><span class="s1">req,</span><span class="s3">\n            </span><span class="s1">nextConfig,</span><span class="s3">\n            </span><span class="s1">routeKind: RouteKind.APP_PAGE,</span><span class="s3">\n            </span><span class="s1">isFallback: true,</span><span class="s3">\n            </span><span class="s1">prerenderManifest,</span><span class="s3">\n            </span><span class="s1">isRoutePPREnabled,</span><span class="s3">\n            </span><span class="s1">responseGenerator: async () =&gt;</span><span class="s3">\n              </span><span class="s1">doRender({</span><span class="s3">\n                </span><span class="s1">span,</span><span class="s3">\n                </span><span class="s1">// We pass `undefined` as rendering a fallback isn't resumed</span><span class="s3">\n                </span><span class="s1">// here.</span><span class="s3">\n                </span><span class="s1">postponed: undefined,</span><span class="s3">\n                </span><span class="s1">fallbackRouteParams:</span><span class="s3">\n                  </span><span class="s1">// If we're in production or we're debugging the fallback</span><span class="s3">\n                  </span><span class="s1">// shell then we should postpone when dynamic params are</span><span class="s3">\n                  </span><span class="s1">// accessed.</span><span class="s3">\n                  </span><span class="s1">isProduction || isDebugFallbackShell</span><span class="s3">\n                    </span><span class="s1">? getFallbackRouteParams(normalizedSrcPage)</span><span class="s3">\n                    </span><span class="s1">: null,</span><span class="s3">\n              </span><span class="s1">}),</span><span class="s3">\n            </span><span class="s1">waitUntil: ctx.waitUntil,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n\n          </span><span class="s1">// If the fallback response was set to null, then we should return null.</span><span class="s3">\n          </span><span class="s1">if (fallbackResponse === null) return null</span><span class="s3">\n\n          </span><span class="s1">// Otherwise, if we did get a fallback response, we should return it.</span><span class="s3">\n          </span><span class="s1">if (fallbackResponse) {</span><span class="s3">\n            </span><span class="s1">// Remove the cache control from the response to prevent it from being</span><span class="s3">\n            </span><span class="s1">// used in the surrounding cache.</span><span class="s3">\n            </span><span class="s1">delete fallbackResponse.cacheControl</span><span class="s3">\n\n            </span><span class="s1">return fallbackResponse</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">// Only requests that aren't revalidating can be resumed. If we have the</span><span class="s3">\n      </span><span class="s1">// minimal postponed data, then we should resume the render with it.</span><span class="s3">\n      </span><span class="s1">const postponed =</span><span class="s3">\n        </span><span class="s1">!isOnDemandRevalidate &amp;&amp; !isRevalidating &amp;&amp; minimalPostponed</span><span class="s3">\n          </span><span class="s1">? minimalPostponed</span><span class="s3">\n          </span><span class="s1">: undefined</span><span class="s3">\n\n      </span><span class="s1">// When we're in minimal mode, if we're trying to debug the static shell,</span><span class="s3">\n      </span><span class="s1">// we should just return nothing instead of resuming the dynamic render.</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">(isDebugStaticShell || isDebugDynamicAccesses) &amp;&amp;</span><span class="s3">\n        </span><span class="s1">typeof postponed !== 'undefined'</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">return {</span><span class="s3">\n          </span><span class="s1">cacheControl: { revalidate: 1, expire: undefined },</span><span class="s3">\n          </span><span class="s1">value: {</span><span class="s3">\n            </span><span class="s1">kind: CachedRouteKind.PAGES,</span><span class="s3">\n            </span><span class="s1">html: RenderResult.EMPTY,</span><span class="s3">\n            </span><span class="s1">pageData: {},</span><span class="s3">\n            </span><span class="s1">headers: undefined,</span><span class="s3">\n            </span><span class="s1">status: undefined,</span><span class="s3">\n          </span><span class="s1">} satisfies CachedPageValue,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// If this is a dynamic route with PPR enabled and the default route</span><span class="s3">\n      </span><span class="s1">// matches were set, then we should pass the fallback route params to</span><span class="s3">\n      </span><span class="s1">// the renderer as this is a fallback revalidation request.</span><span class="s3">\n      </span><span class="s1">const fallbackRouteParams =</span><span class="s3">\n        </span><span class="s1">pageIsDynamic &amp;&amp;</span><span class="s3">\n        </span><span class="s1">isRoutePPREnabled &amp;&amp;</span><span class="s3">\n        </span><span class="s1">(getRequestMeta(req, 'renderFallbackShell') || isDebugFallbackShell)</span><span class="s3">\n          </span><span class="s1">? getFallbackRouteParams(pathname)</span><span class="s3">\n          </span><span class="s1">: null</span><span class="s3">\n\n      </span><span class="s1">// Perform the render.</span><span class="s3">\n      </span><span class="s1">return doRender({</span><span class="s3">\n        </span><span class="s1">span,</span><span class="s3">\n        </span><span class="s1">postponed,</span><span class="s3">\n        </span><span class="s1">fallbackRouteParams,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const handleResponse = async (span?: Span): Promise&lt;null | void&gt; =&gt; {</span><span class="s3">\n      </span><span class="s1">const cacheEntry = await routeModule.handleResponse({</span><span class="s3">\n        </span><span class="s1">cacheKey: ssgCacheKey,</span><span class="s3">\n        </span><span class="s1">responseGenerator: (c) =&gt;</span><span class="s3">\n          </span><span class="s1">responseGenerator({</span><span class="s3">\n            </span><span class="s1">span,</span><span class="s3">\n            </span><span class="s1">...c,</span><span class="s3">\n          </span><span class="s1">}),</span><span class="s3">\n        </span><span class="s1">routeKind: RouteKind.APP_PAGE,</span><span class="s3">\n        </span><span class="s1">isOnDemandRevalidate,</span><span class="s3">\n        </span><span class="s1">isRoutePPREnabled,</span><span class="s3">\n        </span><span class="s1">req,</span><span class="s3">\n        </span><span class="s1">nextConfig,</span><span class="s3">\n        </span><span class="s1">prerenderManifest,</span><span class="s3">\n        </span><span class="s1">waitUntil: ctx.waitUntil,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n\n      </span><span class="s1">if (isDraftMode) {</span><span class="s3">\n        </span><span class="s1">res.setHeader(</span><span class="s3">\n          </span><span class="s1">'Cache-Control',</span><span class="s3">\n          </span><span class="s1">'private, no-cache, no-store, max-age=0, must-revalidate'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// In dev, we should not cache pages for any reason.</span><span class="s3">\n      </span><span class="s1">if (routeModule.isDev) {</span><span class="s3">\n        </span><span class="s1">res.setHeader('Cache-Control', 'no-store, must-revalidate')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (!cacheEntry) {</span><span class="s3">\n        </span><span class="s1">if (ssgCacheKey) {</span><span class="s3">\n          </span><span class="s1">// A cache entry might not be generated if a response is written</span><span class="s3">\n          </span><span class="s1">// in `getInitialProps` or `getServerSideProps`, but those shouldn't</span><span class="s3">\n          </span><span class="s1">// have a cache key. If we do have a cache key but we don't end up</span><span class="s3">\n          </span><span class="s1">// with a cache entry, then either Next.js or the application has a</span><span class="s3">\n          </span><span class="s1">// bug that needs fixing.</span><span class="s3">\n          </span><span class="s1">throw new Error('invariant: cache entry required but not generated')</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">return null</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (cacheEntry.value?.kind !== CachedRouteKind.APP_PAGE) {</span><span class="s3">\n        </span><span class="s1">throw new Error(</span><span class="s3">\n          </span><span class="s1">`Invariant app-page handler received invalid cache entry ${cacheEntry.value?.kind}`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const didPostpone = typeof cacheEntry.value.postponed === 'string'</span><span class="s3">\n\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">isSSG &amp;&amp;</span><span class="s3">\n        </span><span class="s1">// We don't want to send a cache header for requests that contain dynamic</span><span class="s3">\n        </span><span class="s1">// data. If this is a Dynamic RSC request or wasn't a Prefetch RSC</span><span class="s3">\n        </span><span class="s1">// request, then we should set the cache header.</span><span class="s3">\n        </span><span class="s1">!isDynamicRSCRequest &amp;&amp;</span><span class="s3">\n        </span><span class="s1">(!didPostpone || isPrefetchRSCRequest)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">if (!minimalMode) {</span><span class="s3">\n          </span><span class="s1">// set x-nextjs-cache header to match the header</span><span class="s3">\n          </span><span class="s1">// we set for the image-optimizer</span><span class="s3">\n          </span><span class="s1">res.setHeader(</span><span class="s3">\n            </span><span class="s1">'x-nextjs-cache',</span><span class="s3">\n            </span><span class="s1">isOnDemandRevalidate</span><span class="s3">\n              </span><span class="s1">? 'REVALIDATED'</span><span class="s3">\n              </span><span class="s1">: cacheEntry.isMiss</span><span class="s3">\n                </span><span class="s1">? 'MISS'</span><span class="s3">\n                </span><span class="s1">: cacheEntry.isStale</span><span class="s3">\n                  </span><span class="s1">? 'STALE'</span><span class="s3">\n                  </span><span class="s1">: 'HIT'</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">// Set a header used by the client router to signal the response is static</span><span class="s3">\n        </span><span class="s1">// and should respect the `static` cache staleTime value.</span><span class="s3">\n        </span><span class="s1">res.setHeader(NEXT_IS_PRERENDER_HEADER, '1')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">const { value: cachedData } = cacheEntry</span><span class="s3">\n\n      </span><span class="s1">// Coerce the cache control parameter from the render.</span><span class="s3">\n      </span><span class="s1">let cacheControl: CacheControl | undefined</span><span class="s3">\n\n      </span><span class="s1">// If this is a resume request in minimal mode it is streamed with dynamic</span><span class="s3">\n      </span><span class="s1">// content and should not be cached.</span><span class="s3">\n      </span><span class="s1">if (minimalPostponed) {</span><span class="s3">\n        </span><span class="s1">cacheControl = { revalidate: 0, expire: undefined }</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// If this is in minimal mode and this is a flight request that isn't a</span><span class="s3">\n      </span><span class="s1">// prefetch request while PPR is enabled, it cannot be cached as it contains</span><span class="s3">\n      </span><span class="s1">// dynamic content.</span><span class="s3">\n      </span><span class="s1">else if (</span><span class="s3">\n        </span><span class="s1">minimalMode &amp;&amp;</span><span class="s3">\n        </span><span class="s1">isRSCRequest &amp;&amp;</span><span class="s3">\n        </span><span class="s1">!isPrefetchRSCRequest &amp;&amp;</span><span class="s3">\n        </span><span class="s1">isRoutePPREnabled</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">cacheControl = { revalidate: 0, expire: undefined }</span><span class="s3">\n      </span><span class="s1">} else if (!routeModule.isDev) {</span><span class="s3">\n        </span><span class="s1">// If this is a preview mode request, we shouldn't cache it</span><span class="s3">\n        </span><span class="s1">if (isDraftMode) {</span><span class="s3">\n          </span><span class="s1">cacheControl = { revalidate: 0, expire: undefined }</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// If this isn't SSG, then we should set change the header only if it is</span><span class="s3">\n        </span><span class="s1">// not set already.</span><span class="s3">\n        </span><span class="s1">else if (!isSSG) {</span><span class="s3">\n          </span><span class="s1">if (!res.getHeader('Cache-Control')) {</span><span class="s3">\n            </span><span class="s1">cacheControl = { revalidate: 0, expire: undefined }</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">} else if (cacheEntry.cacheControl) {</span><span class="s3">\n          </span><span class="s1">// If the cache entry has a cache control with a revalidate value that's</span><span class="s3">\n          </span><span class="s1">// a number, use it.</span><span class="s3">\n          </span><span class="s1">if (typeof cacheEntry.cacheControl.revalidate === 'number') {</span><span class="s3">\n            </span><span class="s1">if (cacheEntry.cacheControl.revalidate &lt; 1) {</span><span class="s3">\n              </span><span class="s1">throw new Error(</span><span class="s3">\n                </span><span class="s1">`Invalid revalidate configuration provided: ${cacheEntry.cacheControl.revalidate} &lt; 1`</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n\n            </span><span class="s1">cacheControl = {</span><span class="s3">\n              </span><span class="s1">revalidate: cacheEntry.cacheControl.revalidate,</span><span class="s3">\n              </span><span class="s1">expire: cacheEntry.cacheControl?.expire ?? nextConfig.expireTime,</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">// Otherwise if the revalidate value is false, then we should use the</span><span class="s3">\n          </span><span class="s1">// cache time of one year.</span><span class="s3">\n          </span><span class="s1">else {</span><span class="s3">\n            </span><span class="s1">cacheControl = { revalidate: CACHE_ONE_YEAR, expire: undefined }</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">cacheEntry.cacheControl = cacheControl</span><span class="s3">\n\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">typeof segmentPrefetchHeader === 'string' &amp;&amp;</span><span class="s3">\n        </span><span class="s1">cachedData?.kind === CachedRouteKind.APP_PAGE &amp;&amp;</span><span class="s3">\n        </span><span class="s1">cachedData.segmentData</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">// This is a prefetch request issued by the client Segment Cache. These</span><span class="s3">\n        </span><span class="s1">// should never reach the application layer (lambda). We should either</span><span class="s3">\n        </span><span class="s1">// respond from the cache (HIT) or respond with 204 No Content (MISS).</span><span class="s3">\n\n        </span><span class="s1">// Set a header to indicate that PPR is enabled for this route. This</span><span class="s3">\n        </span><span class="s1">// lets the client distinguish between a regular cache miss and a cache</span><span class="s3">\n        </span><span class="s1">// miss due to PPR being disabled. In other contexts this header is used</span><span class="s3">\n        </span><span class="s1">// to indicate that the response contains dynamic data, but here we're</span><span class="s3">\n        </span><span class="s1">// only using it to indicate that the feature is enabled  the segment</span><span class="s3">\n        </span><span class="s1">// response itself contains whether the data is dynamic.</span><span class="s3">\n        </span><span class="s1">res.setHeader(NEXT_DID_POSTPONE_HEADER, '2')</span><span class="s3">\n\n        </span><span class="s1">// Add the cache tags header to the response if it exists and we're in</span><span class="s3">\n        </span><span class="s1">// minimal mode while rendering a static page.</span><span class="s3">\n        </span><span class="s1">const tags = cachedData.headers?.[NEXT_CACHE_TAGS_HEADER]</span><span class="s3">\n        </span><span class="s1">if (minimalMode &amp;&amp; isSSG &amp;&amp; tags &amp;&amp; typeof tags === 'string') {</span><span class="s3">\n          </span><span class="s1">res.setHeader(NEXT_CACHE_TAGS_HEADER, tags)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const matchedSegment = cachedData.segmentData.get(segmentPrefetchHeader)</span><span class="s3">\n        </span><span class="s1">if (matchedSegment !== undefined) {</span><span class="s3">\n          </span><span class="s1">// Cache hit</span><span class="s3">\n          </span><span class="s1">return sendRenderResult({</span><span class="s3">\n            </span><span class="s1">req,</span><span class="s3">\n            </span><span class="s1">res,</span><span class="s3">\n            </span><span class="s1">generateEtags: nextConfig.generateEtags,</span><span class="s3">\n            </span><span class="s1">poweredByHeader: nextConfig.poweredByHeader,</span><span class="s3">\n            </span><span class="s1">result: RenderResult.fromStatic(</span><span class="s3">\n              </span><span class="s1">matchedSegment,</span><span class="s3">\n              </span><span class="s1">RSC_CONTENT_TYPE_HEADER</span><span class="s3">\n            </span><span class="s1">),</span><span class="s3">\n            </span><span class="s1">cacheControl: cacheEntry.cacheControl,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// Cache miss. Either a cache entry for this route has not been generated</span><span class="s3">\n        </span><span class="s1">// (which technically should not be possible when PPR is enabled, because</span><span class="s3">\n        </span><span class="s1">// at a minimum there should always be a fallback entry) or there's no</span><span class="s3">\n        </span><span class="s1">// match for the requested segment. Respond with a 204 No Content. We</span><span class="s3">\n        </span><span class="s1">// don't bother to respond with 404, because these requests are only</span><span class="s3">\n        </span><span class="s1">// issued as part of a prefetch.</span><span class="s3">\n        </span><span class="s1">res.statusCode = 204</span><span class="s3">\n        </span><span class="s1">return sendRenderResult({</span><span class="s3">\n          </span><span class="s1">req,</span><span class="s3">\n          </span><span class="s1">res,</span><span class="s3">\n          </span><span class="s1">generateEtags: nextConfig.generateEtags,</span><span class="s3">\n          </span><span class="s1">poweredByHeader: nextConfig.poweredByHeader,</span><span class="s3">\n          </span><span class="s1">result: RenderResult.EMPTY,</span><span class="s3">\n          </span><span class="s1">cacheControl: cacheEntry.cacheControl,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// If there's a callback for `onCacheEntry`, call it with the cache entry</span><span class="s3">\n      </span><span class="s1">// and the revalidate options.</span><span class="s3">\n      </span><span class="s1">const onCacheEntry = getRequestMeta(req, 'onCacheEntry')</span><span class="s3">\n      </span><span class="s1">if (onCacheEntry) {</span><span class="s3">\n        </span><span class="s1">const finished = await onCacheEntry(</span><span class="s3">\n          </span><span class="s1">{</span><span class="s3">\n            </span><span class="s1">...cacheEntry,</span><span class="s3">\n            </span><span class="s1">// TODO: remove this when upstream doesn't</span><span class="s3">\n            </span><span class="s1">// always expect this value to be </span><span class="s3">\&quot;</span><span class="s1">PAGE</span><span class="s3">\&quot;\n            </span><span class="s1">value: {</span><span class="s3">\n              </span><span class="s1">...cacheEntry.value,</span><span class="s3">\n              </span><span class="s1">kind: 'PAGE',</span><span class="s3">\n            </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">{</span><span class="s3">\n            </span><span class="s1">url: getRequestMeta(req, 'initURL'),</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">if (finished) {</span><span class="s3">\n          </span><span class="s1">// TODO: maybe we have to end the request?</span><span class="s3">\n          </span><span class="s1">return null</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// If the request has a postponed state and it's a resume request we</span><span class="s3">\n      </span><span class="s1">// should error.</span><span class="s3">\n      </span><span class="s1">if (didPostpone &amp;&amp; minimalPostponed) {</span><span class="s3">\n        </span><span class="s1">throw new Error(</span><span class="s3">\n          </span><span class="s1">'Invariant: postponed state should not be present on a resume request'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (cachedData.headers) {</span><span class="s3">\n        </span><span class="s1">const headers = { ...cachedData.headers }</span><span class="s3">\n\n        </span><span class="s1">if (!minimalMode || !isSSG) {</span><span class="s3">\n          </span><span class="s1">delete headers[NEXT_CACHE_TAGS_HEADER]</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">for (let [key, value] of Object.entries(headers)) {</span><span class="s3">\n          </span><span class="s1">if (typeof value === 'undefined') continue</span><span class="s3">\n\n          </span><span class="s1">if (Array.isArray(value)) {</span><span class="s3">\n            </span><span class="s1">for (const v of value) {</span><span class="s3">\n              </span><span class="s1">res.appendHeader(key, v)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">} else if (typeof value === 'number') {</span><span class="s3">\n            </span><span class="s1">value = value.toString()</span><span class="s3">\n            </span><span class="s1">res.appendHeader(key, value)</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">res.appendHeader(key, value)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Add the cache tags header to the response if it exists and we're in</span><span class="s3">\n      </span><span class="s1">// minimal mode while rendering a static page.</span><span class="s3">\n      </span><span class="s1">const tags = cachedData.headers?.[NEXT_CACHE_TAGS_HEADER]</span><span class="s3">\n      </span><span class="s1">if (minimalMode &amp;&amp; isSSG &amp;&amp; tags &amp;&amp; typeof tags === 'string') {</span><span class="s3">\n        </span><span class="s1">res.setHeader(NEXT_CACHE_TAGS_HEADER, tags)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// If the request is a data request, then we shouldn't set the status code</span><span class="s3">\n      </span><span class="s1">// from the response because it should always be 200. This should be gated</span><span class="s3">\n      </span><span class="s1">// behind the experimental PPR flag.</span><span class="s3">\n      </span><span class="s1">if (cachedData.status &amp;&amp; (!isRSCRequest || !isRoutePPREnabled)) {</span><span class="s3">\n        </span><span class="s1">res.statusCode = cachedData.status</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Redirect information is encoded in RSC payload, so we don't need to use redirect status codes</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">!minimalMode &amp;&amp;</span><span class="s3">\n        </span><span class="s1">cachedData.status &amp;&amp;</span><span class="s3">\n        </span><span class="s1">RedirectStatusCode[cachedData.status] &amp;&amp;</span><span class="s3">\n        </span><span class="s1">isRSCRequest</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">res.statusCode = 200</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Mark that the request did postpone.</span><span class="s3">\n      </span><span class="s1">if (didPostpone) {</span><span class="s3">\n        </span><span class="s1">res.setHeader(NEXT_DID_POSTPONE_HEADER, '1')</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// we don't go through this block when preview mode is true</span><span class="s3">\n      </span><span class="s1">// as preview mode is a dynamic request (bypasses cache) and doesn't</span><span class="s3">\n      </span><span class="s1">// generate both HTML and payloads in the same request so continue to just</span><span class="s3">\n      </span><span class="s1">// return the generated payload</span><span class="s3">\n      </span><span class="s1">if (isRSCRequest &amp;&amp; !isDraftMode) {</span><span class="s3">\n        </span><span class="s1">// If this is a dynamic RSC request, then stream the response.</span><span class="s3">\n        </span><span class="s1">if (typeof cachedData.rscData === 'undefined') {</span><span class="s3">\n          </span><span class="s1">if (cachedData.postponed) {</span><span class="s3">\n            </span><span class="s1">throw new Error('Invariant: Expected postponed to be undefined')</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">return sendRenderResult({</span><span class="s3">\n            </span><span class="s1">req,</span><span class="s3">\n            </span><span class="s1">res,</span><span class="s3">\n            </span><span class="s1">generateEtags: nextConfig.generateEtags,</span><span class="s3">\n            </span><span class="s1">poweredByHeader: nextConfig.poweredByHeader,</span><span class="s3">\n            </span><span class="s1">result: cachedData.html,</span><span class="s3">\n            </span><span class="s1">// Dynamic RSC responses cannot be cached, even if they're</span><span class="s3">\n            </span><span class="s1">// configured with `force-static` because we have no way of</span><span class="s3">\n            </span><span class="s1">// distinguishing between `force-static` and pages that have no</span><span class="s3">\n            </span><span class="s1">// postponed state.</span><span class="s3">\n            </span><span class="s1">// TODO: distinguish `force-static` from pages with no postponed state (static)</span><span class="s3">\n            </span><span class="s1">cacheControl: isDynamicRSCRequest</span><span class="s3">\n              </span><span class="s1">? { revalidate: 0, expire: undefined }</span><span class="s3">\n              </span><span class="s1">: cacheEntry.cacheControl,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// As this isn't a prefetch request, we should serve the static flight</span><span class="s3">\n        </span><span class="s1">// data.</span><span class="s3">\n        </span><span class="s1">return sendRenderResult({</span><span class="s3">\n          </span><span class="s1">req,</span><span class="s3">\n          </span><span class="s1">res,</span><span class="s3">\n          </span><span class="s1">generateEtags: nextConfig.generateEtags,</span><span class="s3">\n          </span><span class="s1">poweredByHeader: nextConfig.poweredByHeader,</span><span class="s3">\n          </span><span class="s1">result: RenderResult.fromStatic(</span><span class="s3">\n            </span><span class="s1">cachedData.rscData,</span><span class="s3">\n            </span><span class="s1">RSC_CONTENT_TYPE_HEADER</span><span class="s3">\n          </span><span class="s1">),</span><span class="s3">\n          </span><span class="s1">cacheControl: cacheEntry.cacheControl,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// This is a request for HTML data.</span><span class="s3">\n      </span><span class="s1">let body = cachedData.html</span><span class="s3">\n\n      </span><span class="s1">// If there's no postponed state, we should just serve the HTML. This</span><span class="s3">\n      </span><span class="s1">// should also be the case for a resume request because it's completed</span><span class="s3">\n      </span><span class="s1">// as a server render (rather than a static render).</span><span class="s3">\n      </span><span class="s1">if (!didPostpone || minimalMode || isRSCRequest) {</span><span class="s3">\n        </span><span class="s1">// If we're in test mode, we should add a sentinel chunk to the response</span><span class="s3">\n        </span><span class="s1">// that's between the static and dynamic parts so we can compare the</span><span class="s3">\n        </span><span class="s1">// chunks and add assertions.</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">process.env.__NEXT_TEST_MODE &amp;&amp;</span><span class="s3">\n          </span><span class="s1">minimalMode &amp;&amp;</span><span class="s3">\n          </span><span class="s1">isRoutePPREnabled &amp;&amp;</span><span class="s3">\n          </span><span class="s1">body.contentType === HTML_CONTENT_TYPE_HEADER</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">// As we're in minimal mode, the static part would have already been</span><span class="s3">\n          </span><span class="s1">// streamed first. The only part that this streams is the dynamic part</span><span class="s3">\n          </span><span class="s1">// so we should FIRST stream the sentinel and THEN the dynamic part.</span><span class="s3">\n          </span><span class="s1">body.unshift(createPPRBoundarySentinel())</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">return sendRenderResult({</span><span class="s3">\n          </span><span class="s1">req,</span><span class="s3">\n          </span><span class="s1">res,</span><span class="s3">\n          </span><span class="s1">generateEtags: nextConfig.generateEtags,</span><span class="s3">\n          </span><span class="s1">poweredByHeader: nextConfig.poweredByHeader,</span><span class="s3">\n          </span><span class="s1">result: body,</span><span class="s3">\n          </span><span class="s1">cacheControl: cacheEntry.cacheControl,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// If we're debugging the static shell or the dynamic API accesses, we</span><span class="s3">\n      </span><span class="s1">// should just serve the HTML without resuming the render. The returned</span><span class="s3">\n      </span><span class="s1">// HTML will be the static shell so all the Dynamic API's will be used</span><span class="s3">\n      </span><span class="s1">// during static generation.</span><span class="s3">\n      </span><span class="s1">if (isDebugStaticShell || isDebugDynamicAccesses) {</span><span class="s3">\n        </span><span class="s1">// Since we're not resuming the render, we need to at least add the</span><span class="s3">\n        </span><span class="s1">// closing body and html tags to create valid HTML.</span><span class="s3">\n        </span><span class="s1">body.push(</span><span class="s3">\n          </span><span class="s1">new ReadableStream({</span><span class="s3">\n            </span><span class="s1">start(controller) {</span><span class="s3">\n              </span><span class="s1">controller.enqueue(ENCODED_TAGS.CLOSED.BODY_AND_HTML)</span><span class="s3">\n              </span><span class="s1">controller.close()</span><span class="s3">\n            </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">return sendRenderResult({</span><span class="s3">\n          </span><span class="s1">req,</span><span class="s3">\n          </span><span class="s1">res,</span><span class="s3">\n          </span><span class="s1">generateEtags: nextConfig.generateEtags,</span><span class="s3">\n          </span><span class="s1">poweredByHeader: nextConfig.poweredByHeader,</span><span class="s3">\n          </span><span class="s1">result: body,</span><span class="s3">\n          </span><span class="s1">cacheControl: { revalidate: 0, expire: undefined },</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// If we're in test mode, we should add a sentinel chunk to the response</span><span class="s3">\n      </span><span class="s1">// that's between the static and dynamic parts so we can compare the</span><span class="s3">\n      </span><span class="s1">// chunks and add assertions.</span><span class="s3">\n      </span><span class="s1">if (process.env.__NEXT_TEST_MODE) {</span><span class="s3">\n        </span><span class="s1">body.push(createPPRBoundarySentinel())</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// This request has postponed, so let's create a new transformer that the</span><span class="s3">\n      </span><span class="s1">// dynamic data can pipe to that will attach the dynamic data to the end</span><span class="s3">\n      </span><span class="s1">// of the response.</span><span class="s3">\n      </span><span class="s1">const transformer = new TransformStream&lt;Uint8Array, Uint8Array&gt;()</span><span class="s3">\n      </span><span class="s1">body.push(transformer.readable)</span><span class="s3">\n\n      </span><span class="s1">// Perform the render again, but this time, provide the postponed state.</span><span class="s3">\n      </span><span class="s1">// We don't await because we want the result to start streaming now, and</span><span class="s3">\n      </span><span class="s1">// we've already chained the transformer's readable to the render result.</span><span class="s3">\n      </span><span class="s1">doRender({</span><span class="s3">\n        </span><span class="s1">span,</span><span class="s3">\n        </span><span class="s1">postponed: cachedData.postponed,</span><span class="s3">\n        </span><span class="s1">// This is a resume render, not a fallback render, so we don't need to</span><span class="s3">\n        </span><span class="s1">// set this.</span><span class="s3">\n        </span><span class="s1">fallbackRouteParams: null,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">.then(async (result) =&gt; {</span><span class="s3">\n          </span><span class="s1">if (!result) {</span><span class="s3">\n            </span><span class="s1">throw new Error('Invariant: expected a result to be returned')</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">if (result.value?.kind !== CachedRouteKind.APP_PAGE) {</span><span class="s3">\n            </span><span class="s1">throw new Error(</span><span class="s3">\n              </span><span class="s1">`Invariant: expected a page response, got ${result.value?.kind}`</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Pipe the resume result to the transformer.</span><span class="s3">\n          </span><span class="s1">await result.value.html.pipeTo(transformer.writable)</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">.catch((err) =&gt; {</span><span class="s3">\n          </span><span class="s1">// An error occurred during piping or preparing the render, abort</span><span class="s3">\n          </span><span class="s1">// the transformers writer so we can terminate the stream.</span><span class="s3">\n          </span><span class="s1">transformer.writable.abort(err).catch((e) =&gt; {</span><span class="s3">\n            </span><span class="s1">console.error(</span><span class="s3">\&quot;</span><span class="s1">couldn't abort transformer</span><span class="s3">\&quot;</span><span class="s1">, e)</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n\n      </span><span class="s1">return sendRenderResult({</span><span class="s3">\n        </span><span class="s1">req,</span><span class="s3">\n        </span><span class="s1">res,</span><span class="s3">\n        </span><span class="s1">generateEtags: nextConfig.generateEtags,</span><span class="s3">\n        </span><span class="s1">poweredByHeader: nextConfig.poweredByHeader,</span><span class="s3">\n        </span><span class="s1">result: body,</span><span class="s3">\n        </span><span class="s1">// We don't want to cache the response if it has postponed data because</span><span class="s3">\n        </span><span class="s1">// the response being sent to the client it's dynamic parts are streamed</span><span class="s3">\n        </span><span class="s1">// to the client on the same request.</span><span class="s3">\n        </span><span class="s1">cacheControl: { revalidate: 0, expire: undefined },</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// TODO: activeSpan code path is for when wrapped by</span><span class="s3">\n    </span><span class="s1">// next-server can be removed when this is no longer used</span><span class="s3">\n    </span><span class="s1">if (activeSpan) {</span><span class="s3">\n      </span><span class="s1">await handleResponse(activeSpan)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">return await tracer.withPropagatedContext(req.headers, () =&gt;</span><span class="s3">\n        </span><span class="s1">tracer.trace(</span><span class="s3">\n          </span><span class="s1">BaseServerSpan.handleRequest,</span><span class="s3">\n          </span><span class="s1">{</span><span class="s3">\n            </span><span class="s1">spanName: `${method} ${req.url}`,</span><span class="s3">\n            </span><span class="s1">kind: SpanKind.SERVER,</span><span class="s3">\n            </span><span class="s1">attributes: {</span><span class="s3">\n              </span><span class="s1">'http.method': method,</span><span class="s3">\n              </span><span class="s1">'http.target': req.url,</span><span class="s3">\n            </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">handleResponse</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} catch (err) {</span><span class="s3">\n    </span><span class="s1">if (!(err instanceof NoFallbackError)) {</span><span class="s3">\n      </span><span class="s1">await routeModule.onRequestError(</span><span class="s3">\n        </span><span class="s1">req,</span><span class="s3">\n        </span><span class="s1">err,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">routerKind: 'App Router',</span><span class="s3">\n          </span><span class="s1">routePath: srcPage,</span><span class="s3">\n          </span><span class="s1">routeType: 'render',</span><span class="s3">\n          </span><span class="s1">revalidateReason: getRevalidateReason({</span><span class="s3">\n            </span><span class="s1">isRevalidate: isSSG,</span><span class="s3">\n            </span><span class="s1">isOnDemandRevalidate,</span><span class="s3">\n          </span><span class="s1">}),</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">routerServerContext</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// rethrow so that we can handle serving error page</span><span class="s3">\n    </span><span class="s1">throw err</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// TODO: omit this from production builds, only test builds should include it</span><span class="s3">\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Creates a readable stream that emits a PPR boundary sentinel.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @returns A readable stream that emits a PPR boundary sentinel.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function createPPRBoundarySentinel() {</span><span class="s3">\n  </span><span class="s1">return new ReadableStream({</span><span class="s3">\n    </span><span class="s1">start(controller) {</span><span class="s3">\n      </span><span class="s1">controller.enqueue(</span><span class="s3">\n        </span><span class="s1">new TextEncoder().encode('&lt;!-- PPR_BOUNDARY_SENTINEL --&gt;')</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">controller.close()</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;AppPageRouteModule&quot;</span><span class="s0">,</span><span class="s1">&quot;RouteKind&quot;</span><span class="s0">,</span><span class="s1">&quot;getRevalidateReason&quot;</span><span class="s0">,</span><span class="s1">&quot;getTracer&quot;</span><span class="s0">,</span><span class="s1">&quot;SpanKind&quot;</span><span class="s0">,</span><span class="s1">&quot;getRequestMeta&quot;</span><span class="s0">,</span><span class="s1">&quot;BaseServerSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;interopDefault&quot;</span><span class="s0">,</span><span class="s1">&quot;stripFlightHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeNextRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeNextResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;checkIsAppPPREnabled&quot;</span><span class="s0">,</span><span class="s1">&quot;getFallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;setReferenceManifestsSingleton&quot;</span><span class="s0">,</span><span class="s1">&quot;isHtmlBotRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldServeStreamingMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;createServerModuleMap&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;getIsPossibleServerAction&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_PREFETCH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_IS_PRERENDER_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_DID_POSTPONE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;getBotType&quot;</span><span class="s0">,</span><span class="s1">&quot;isBot&quot;</span><span class="s0">,</span><span class="s1">&quot;CachedRouteKind&quot;</span><span class="s0">,</span><span class="s1">&quot;FallbackMode&quot;</span><span class="s0">,</span><span class="s1">&quot;parseFallbackField&quot;</span><span class="s0">,</span><span class="s1">&quot;RenderResult&quot;</span><span class="s0">,</span><span class="s1">&quot;CACHE_ONE_YEAR&quot;</span><span class="s0">,</span><span class="s1">&quot;HTML_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_CACHE_TAGS_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;ENCODED_TAGS&quot;</span><span class="s0">,</span><span class="s1">&quot;sendRenderResult&quot;</span><span class="s0">,</span><span class="s1">&quot;NoFallbackError&quot;</span><span class="s0">,</span><span class="s1">&quot;tree&quot;</span><span class="s0">,</span><span class="s1">&quot;pages&quot;</span><span class="s0">,</span><span class="s1">&quot;GlobalError&quot;</span><span class="s0">,</span><span class="s1">&quot;__next_app__&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;__next_app_require__&quot;</span><span class="s0">,</span><span class="s1">&quot;loadChunk&quot;</span><span class="s0">,</span><span class="s1">&quot;__next_app_load_chunk__&quot;</span><span class="s0">,</span><span class="s1">&quot;entryBase&quot;</span><span class="s0">,</span><span class="s1">&quot;RedirectStatusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;routeModule&quot;</span><span class="s0">,</span><span class="s1">&quot;definition&quot;</span><span class="s0">,</span><span class="s1">&quot;kind&quot;</span><span class="s0">,</span><span class="s1">&quot;APP_PAGE&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;bundlePath&quot;</span><span class="s0">,</span><span class="s1">&quot;filename&quot;</span><span class="s0">,</span><span class="s1">&quot;appPaths&quot;</span><span class="s0">,</span><span class="s1">&quot;userland&quot;</span><span class="s0">,</span><span class="s1">&quot;loaderTree&quot;</span><span class="s0">,</span><span class="s1">&quot;distDir&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_RELATIVE_DIST_DIR&quot;</span><span class="s0">,</span><span class="s1">&quot;relativeProjectDir&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_RELATIVE_PROJECT_DIR&quot;</span><span class="s0">,</span><span class="s1">&quot;handler&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;ctx&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;srcPage&quot;</span><span class="s0">,</span><span class="s1">&quot;TURBOPACK&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;multiZoneDraftMode&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_MULTI_ZONE_DRAFT_MODE&quot;</span><span class="s0">,</span><span class="s1">&quot;initialPostponed&quot;</span><span class="s0">,</span><span class="s1">&quot;minimalMode&quot;</span><span class="s0">,</span><span class="s1">&quot;prepareResult&quot;</span><span class="s0">,</span><span class="s1">&quot;prepare&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;end&quot;</span><span class="s0">,</span><span class="s1">&quot;waitUntil&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;query&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;parsedUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;pageIsDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;buildManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;nextFontManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;reactLoadableManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;serverActionsManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;clientReferenceManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;subresourceIntegrityManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;isDraftMode&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvedPathname&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidateOnlyGenerated&quot;</span><span class="s0">,</span><span class="s1">&quot;routerServerContext&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;interceptionRoutePatterns&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizedSrcPage&quot;</span><span class="s0">,</span><span class="s1">&quot;isOnDemandRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;match&quot;</span><span class="s0">,</span><span class="s1">&quot;isPrerendered&quot;</span><span class="s0">,</span><span class="s1">&quot;routes&quot;</span><span class="s0">,</span><span class="s1">&quot;isSSG&quot;</span><span class="s0">,</span><span class="s1">&quot;Boolean&quot;</span><span class="s0">,</span><span class="s1">&quot;userAgent&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;botType&quot;</span><span class="s0">,</span><span class="s1">&quot;isHtmlBot&quot;</span><span class="s0">,</span><span class="s1">&quot;isPrefetchRSCRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;isRSCRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;isPossibleServerAction&quot;</span><span class="s0">,</span><span class="s1">&quot;couldSupportPPR&quot;</span><span class="s0">,</span><span class="s1">&quot;experimental&quot;</span><span class="s0">,</span><span class="s1">&quot;ppr&quot;</span><span class="s0">,</span><span class="s1">&quot;hasDebugStaticShellQuery&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_EXPERIMENTAL_STATIC_SHELL_DEBUGGING&quot;</span><span class="s0">,</span><span class="s1">&quot;__nextppronly&quot;</span><span class="s0">,</span><span class="s1">&quot;hasDebugFallbackShellQuery&quot;</span><span class="s0">,</span><span class="s1">&quot;isRoutePPREnabled&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;renderingMode&quot;</span><span class="s0">,</span><span class="s1">&quot;isDev&quot;</span><span class="s0">,</span><span class="s1">&quot;experimentalTestProxy&quot;</span><span class="s0">,</span><span class="s1">&quot;isDebugStaticShell&quot;</span><span class="s0">,</span><span class="s1">&quot;isDebugDynamicAccesses&quot;</span><span class="s0">,</span><span class="s1">&quot;isDebugFallbackShell&quot;</span><span class="s0">,</span><span class="s1">&quot;minimalPostponed&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicRSCRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentPrefetchHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;serveStreamingMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;htmlLimitedBots&quot;</span><span class="s0">,</span><span class="s1">&quot;supportsDynamicResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldWaitOnAllReady&quot;</span><span class="s0">,</span><span class="s1">&quot;ssgCacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;staticPathKey&quot;</span><span class="s0">,</span><span class="s1">&quot;ComponentMod&quot;</span><span class="s0">,</span><span class="s1">&quot;serverModuleMap&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;tracer&quot;</span><span class="s0">,</span><span class="s1">&quot;activeSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;getActiveScopeSpan&quot;</span><span class="s0">,</span><span class="s1">&quot;varyHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;getVaryHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;setHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;invokeRouteModule&quot;</span><span class="s0">,</span><span class="s1">&quot;span&quot;</span><span class="s0">,</span><span class="s1">&quot;context&quot;</span><span class="s0">,</span><span class="s1">&quot;nextReq&quot;</span><span class="s0">,</span><span class="s1">&quot;nextRes&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheComponents&quot;</span><span class="s0">,</span><span class="s1">&quot;renderOpts&quot;</span><span class="s0">,</span><span class="s1">&quot;warmup&quot;</span><span class="s0">,</span><span class="s1">&quot;metadata&quot;</span><span class="s0">,</span><span class="s1">&quot;renderResumeDataCache&quot;</span><span class="s0">,</span><span class="s1">&quot;render&quot;</span><span class="s0">,</span><span class="s1">&quot;finally&quot;</span><span class="s0">,</span><span class="s1">&quot;setAttributes&quot;</span><span class="s0">,</span><span class="s1">&quot;rootSpanAttributes&quot;</span><span class="s0">,</span><span class="s1">&quot;getRootSpanAttributes&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;handleRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;warn&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;updateName&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;doRender&quot;</span><span class="s0">,</span><span class="s1">&quot;postponed&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;sharedContext&quot;</span><span class="s0">,</span><span class="s1">&quot;serverComponentsHmrCache&quot;</span><span class="s0">,</span><span class="s1">&quot;App&quot;</span><span class="s0">,</span><span class="s1">&quot;Document&quot;</span><span class="s0">,</span><span class="s1">&quot;pageConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;Component&quot;</span><span class="s0">,</span><span class="s1">&quot;setIsrStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;dir&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;cwd&quot;</span><span class="s0">,</span><span class="s1">&quot;isRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;assetPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;nextConfigOutput&quot;</span><span class="s0">,</span><span class="s1">&quot;output&quot;</span><span class="s0">,</span><span class="s1">&quot;crossOrigin&quot;</span><span class="s0">,</span><span class="s1">&quot;trailingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;previewProps&quot;</span><span class="s0">,</span><span class="s1">&quot;preview&quot;</span><span class="s0">,</span><span class="s1">&quot;deploymentId&quot;</span><span class="s0">,</span><span class="s1">&quot;enableTainting&quot;</span><span class="s0">,</span><span class="s1">&quot;taint&quot;</span><span class="s0">,</span><span class="s1">&quot;devtoolSegmentExplorer&quot;</span><span class="s0">,</span><span class="s1">&quot;reactMaxHeadersLength&quot;</span><span class="s0">,</span><span class="s1">&quot;incrementalCache&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheLifeProfiles&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheLife&quot;</span><span class="s0">,</span><span class="s1">&quot;basePath&quot;</span><span class="s0">,</span><span class="s1">&quot;serverActions&quot;</span><span class="s0">,</span><span class="s1">&quot;nextExport&quot;</span><span class="s0">,</span><span class="s1">&quot;isStaticGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;expireTime&quot;</span><span class="s0">,</span><span class="s1">&quot;staleTimes&quot;</span><span class="s0">,</span><span class="s1">&quot;clientSegmentCache&quot;</span><span class="s0">,</span><span class="s1">&quot;clientParamParsing&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicOnHover&quot;</span><span class="s0">,</span><span class="s1">&quot;inlineCss&quot;</span><span class="s0">,</span><span class="s1">&quot;authInterrupts&quot;</span><span class="s0">,</span><span class="s1">&quot;clientTraceMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;onClose&quot;</span><span class="s0">,</span><span class="s1">&quot;cb&quot;</span><span class="s0">,</span><span class="s1">&quot;on&quot;</span><span class="s0">,</span><span class="s1">&quot;onAfterTaskError&quot;</span><span class="s0">,</span><span class="s1">&quot;onInstrumentationRequestError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;_request&quot;</span><span class="s0">,</span><span class="s1">&quot;errorContext&quot;</span><span class="s0">,</span><span class="s1">&quot;onRequestError&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;dev&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheControl&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchTags&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheTags&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchMetrics&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;staticBailoutInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;description&quot;</span><span class="s0">,</span><span class="s1">&quot;stack&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;substring&quot;</span><span class="s0">,</span><span class="s1">&quot;indexOf&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;html&quot;</span><span class="s0">,</span><span class="s1">&quot;rscData&quot;</span><span class="s0">,</span><span class="s1">&quot;flightData&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentData&quot;</span><span class="s0">,</span><span class="s1">&quot;responseGenerator&quot;</span><span class="s0">,</span><span class="s1">&quot;hasResolved&quot;</span><span class="s0">,</span><span class="s1">&quot;previousCacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;isRevalidating&quot;</span><span class="s0">,</span><span class="s1">&quot;isProduction&quot;</span><span class="s0">,</span><span class="s1">&quot;didRespond&quot;</span><span class="s0">,</span><span class="s1">&quot;writableEnded&quot;</span><span class="s0">,</span><span class="s1">&quot;render404&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackMode&quot;</span><span class="s0">,</span><span class="s1">&quot;fallback&quot;</span><span class="s0">,</span><span class="s1">&quot;PRERENDER&quot;</span><span class="s0">,</span><span class="s1">&quot;BLOCKING_STATIC_RENDER&quot;</span><span class="s0">,</span><span class="s1">&quot;isStale&quot;</span><span class="s0">,</span><span class="s1">&quot;NOT_FOUND&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;handleResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;routeKind&quot;</span><span class="s0">,</span><span class="s1">&quot;isFallback&quot;</span><span class="s0">,</span><span class="s1">&quot;expire&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGES&quot;</span><span class="s0">,</span><span class="s1">&quot;EMPTY&quot;</span><span class="s0">,</span><span class="s1">&quot;pageData&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;cachedData&quot;</span><span class="s0">,</span><span class="s1">&quot;c&quot;</span><span class="s0">,</span><span class="s1">&quot;didPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;isMiss&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;tags&quot;</span><span class="s0">,</span><span class="s1">&quot;matchedSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;generateEtags&quot;</span><span class="s0">,</span><span class="s1">&quot;poweredByHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;fromStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;onCacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;finished&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;v&quot;</span><span class="s0">,</span><span class="s1">&quot;appendHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_TEST_MODE&quot;</span><span class="s0">,</span><span class="s1">&quot;contentType&quot;</span><span class="s0">,</span><span class="s1">&quot;unshift&quot;</span><span class="s0">,</span><span class="s1">&quot;createPPRBoundarySentinel&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;ReadableStream&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;controller&quot;</span><span class="s0">,</span><span class="s1">&quot;enqueue&quot;</span><span class="s0">,</span><span class="s1">&quot;CLOSED&quot;</span><span class="s0">,</span><span class="s1">&quot;BODY_AND_HTML&quot;</span><span class="s0">,</span><span class="s1">&quot;close&quot;</span><span class="s0">,</span><span class="s1">&quot;transformer&quot;</span><span class="s0">,</span><span class="s1">&quot;TransformStream&quot;</span><span class="s0">,</span><span class="s1">&quot;readable&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;pipeTo&quot;</span><span class="s0">,</span><span class="s1">&quot;writable&quot;</span><span class="s0">,</span><span class="s1">&quot;catch&quot;</span><span class="s0">,</span><span class="s1">&quot;abort&quot;</span><span class="s0">,</span><span class="s1">&quot;e&quot;</span><span class="s0">,</span><span class="s1">&quot;withPropagatedContext&quot;</span><span class="s0">,</span><span class="s1">&quot;trace&quot;</span><span class="s0">,</span><span class="s1">&quot;spanName&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER&quot;</span><span class="s0">,</span><span class="s1">&quot;attributes&quot;</span><span class="s0">,</span><span class="s1">&quot;routerKind&quot;</span><span class="s0">,</span><span class="s1">&quot;routePath&quot;</span><span class="s0">,</span><span class="s1">&quot;routeType&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidateReason&quot;</span><span class="s0">,</span><span class="s1">&quot;TextEncoder&quot;</span><span class="s0">,</span><span class="s1">&quot;encode&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}}]</span>
<span class="s0">}</span></pre>
</body>
</html>