<html>
<head>
<title>startup.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #8c8c8c; font-style: italic;}
.s4 { color: #1750eb;}
.s5 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
startup.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, {</span>
    <span class="s1">value: </span><span class="s2">true</span>
<span class="s1">});</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;enableMemoryDebuggingMode&quot;</span><span class="s1">, {</span>
    <span class="s1">enumerable: </span><span class="s2">true</span><span class="s1">,</span>
    <span class="s1">get: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">enableMemoryDebuggingMode;</span>
    <span class="s1">}</span>
<span class="s1">});</span>
<span class="s2">const </span><span class="s1">_v8 = </span><span class="s3">/*#__PURE__*/ </span><span class="s1">_interop_require_default(require(</span><span class="s0">&quot;v8&quot;</span><span class="s1">));</span>
<span class="s2">const </span><span class="s1">_log = require(</span><span class="s0">&quot;../../build/output/log&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">_picocolors = require(</span><span class="s0">&quot;../picocolors&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">_gcobserver = require(</span><span class="s0">&quot;./gc-observer&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">_trace = require(</span><span class="s0">&quot;./trace&quot;</span><span class="s1">);</span>
<span class="s2">function </span><span class="s1">_interop_require_default(obj) {</span>
    <span class="s2">return </span><span class="s1">obj &amp;&amp; obj.__esModule ? obj : {</span>
        <span class="s2">default</span><span class="s1">: obj</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s2">function </span><span class="s1">enableMemoryDebuggingMode() {</span>
    <span class="s3">// This will generate a heap snapshot when the program is close to the</span>
    <span class="s3">// memory limit. It does not give any warning to the user though which</span>
    <span class="s3">// can be jarring. If memory is large, this may take a long time.</span>
    <span class="s2">if </span><span class="s1">(</span><span class="s0">'setHeapSnapshotNearHeapLimit' </span><span class="s2">in </span><span class="s1">_v8.default) {</span>
        <span class="s1">_v8.default.setHeapSnapshotNearHeapLimit(</span><span class="s4">1</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">// This flag will kill the process when it starts to GC thrash when it's</span>
    <span class="s3">// close to the memory limit rather than continuing to try to collect</span>
    <span class="s3">// memory ineffectively.</span>
    <span class="s1">_v8.default.setFlagsFromString(</span><span class="s0">'--detect-ineffective-gcs-near-heap-limit'</span><span class="s1">);</span>
    <span class="s3">// This allows users to generate a heap snapshot on demand just by sending</span>
    <span class="s3">// a signal to the process.</span>
    <span class="s1">process.on(</span><span class="s0">'SIGUSR2'</span><span class="s1">, ()=&gt;{</span>
        <span class="s1">(</span><span class="s4">0</span><span class="s1">, _log.warn)(</span><span class="s0">`Received SIGUSR2 signal. Generating heap snapshot. </span><span class="s1">${(</span><span class="s4">0</span><span class="s1">, _picocolors.italic)(</span><span class="s0">'Note: this will take some time.'</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">);</span>
        <span class="s1">_v8.default.writeHeapSnapshot();</span>
    <span class="s1">});</span>
    <span class="s1">(</span><span class="s4">0</span><span class="s1">, _gcobserver.startObservingGc)();</span>
    <span class="s1">(</span><span class="s4">0</span><span class="s1">, _trace.startPeriodicMemoryUsageTracing)();</span>
    <span class="s1">(</span><span class="s4">0</span><span class="s1">, _log.warn)(</span><span class="s0">`Memory debugging mode is enabled. </span><span class="s1">${(</span><span class="s4">0</span><span class="s1">, _picocolors.italic)(</span><span class="s0">'Note: This will affect performance.'</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">);</span>
    <span class="s1">(</span><span class="s4">0</span><span class="s1">, _log.info)(</span><span class="s0">' - Heap snapshots will be automatically generated when the process reaches more than 70% of the memory limit and again when the process is just about to run out of memory.'</span><span class="s1">);</span>
    <span class="s1">(</span><span class="s4">0</span><span class="s1">, _log.info)(</span><span class="s0">` - To manually generate a heap snapshot, send the process a SIGUSR2 signal: </span><span class="s5">\`</span><span class="s0">kill -SIGUSR2 </span><span class="s1">${process.pid}</span><span class="s5">\`</span><span class="s0">`</span><span class="s1">);</span>
    <span class="s1">(</span><span class="s4">0</span><span class="s1">, _log.info)(</span><span class="s0">' - Heap snapshots when there is high memory will take a very long time to complete and may be difficult to analyze in tools.'</span><span class="s1">);</span>
    <span class="s1">(</span><span class="s4">0</span><span class="s1">, _log.info)(</span><span class="s0">' - See https://nextjs.org/docs/app/building-your-application/optimizing/memory-usage for more information.'</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">//# sourceMappingURL=startup.js.map</span></pre>
</body>
</html>