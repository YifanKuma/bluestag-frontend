<html>
<head>
<title>server-action-reducer.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
server-action-reducer.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../../src/client/components/router-reducer/reducers/server-action-reducer.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type {</span><span class="s3">\n  </span><span class="s1">ActionFlightResponse,</span><span class="s3">\n  </span><span class="s1">ActionResult,</span><span class="s3">\n</span><span class="s1">} from '../../../../server/app-render/types'</span><span class="s3">\n</span><span class="s1">import { callServer } from '../../../app-call-server'</span><span class="s3">\n</span><span class="s1">import { findSourceMapURL } from '../../../app-find-source-map-url'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">ACTION_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_ACTION_NOT_FOUND_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_IS_PRERENDER_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_ROUTER_STATE_TREE_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_URL,</span><span class="s3">\n  </span><span class="s1">RSC_CONTENT_TYPE_HEADER,</span><span class="s3">\n</span><span class="s1">} from '../../app-router-headers'</span><span class="s3">\n</span><span class="s1">import { UnrecognizedActionError } from '../../unrecognized-action-error'</span><span class="s3">\n\n</span><span class="s1">// TODO: Explicitly import from client.browser</span><span class="s3">\n</span><span class="s1">// eslint-disable-next-line import/no-extraneous-dependencies</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">createFromFetch as createFromFetchBrowser,</span><span class="s3">\n  </span><span class="s1">createTemporaryReferenceSet,</span><span class="s3">\n  </span><span class="s1">encodeReply,</span><span class="s3">\n</span><span class="s1">} from 'react-server-dom-webpack/client'</span><span class="s3">\n\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">PrefetchKind,</span><span class="s3">\n  </span><span class="s1">type ReadonlyReducerState,</span><span class="s3">\n  </span><span class="s1">type ReducerState,</span><span class="s3">\n  </span><span class="s1">type ServerActionAction,</span><span class="s3">\n  </span><span class="s1">type ServerActionMutable,</span><span class="s3">\n</span><span class="s1">} from '../router-reducer-types'</span><span class="s3">\n</span><span class="s1">import { assignLocation } from '../../../assign-location'</span><span class="s3">\n</span><span class="s1">import { createHrefFromUrl } from '../create-href-from-url'</span><span class="s3">\n</span><span class="s1">import { handleExternalUrl } from './navigate-reducer'</span><span class="s3">\n</span><span class="s1">import { applyRouterStatePatchToTree } from '../apply-router-state-patch-to-tree'</span><span class="s3">\n</span><span class="s1">import { isNavigatingToNewRootLayout } from '../is-navigating-to-new-root-layout'</span><span class="s3">\n</span><span class="s1">import type { CacheNode } from '../../../../shared/lib/app-router-context.shared-runtime'</span><span class="s3">\n</span><span class="s1">import { handleMutable } from '../handle-mutable'</span><span class="s3">\n</span><span class="s1">import { fillLazyItemsTillLeafWithHead } from '../fill-lazy-items-till-leaf-with-head'</span><span class="s3">\n</span><span class="s1">import { createEmptyCacheNode } from '../../app-router'</span><span class="s3">\n</span><span class="s1">import { hasInterceptionRouteInCurrentTree } from './has-interception-route-in-current-tree'</span><span class="s3">\n</span><span class="s1">import { handleSegmentMismatch } from '../handle-segment-mismatch'</span><span class="s3">\n</span><span class="s1">import { refreshInactiveParallelSegments } from '../refetch-inactive-parallel-segments'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">normalizeFlightData,</span><span class="s3">\n  </span><span class="s1">prepareFlightRouterStateForRequest,</span><span class="s3">\n  </span><span class="s1">type NormalizedFlightData,</span><span class="s3">\n</span><span class="s1">} from '../../../flight-data-helpers'</span><span class="s3">\n</span><span class="s1">import { getRedirectError } from '../../redirect'</span><span class="s3">\n</span><span class="s1">import { RedirectType } from '../../redirect-error'</span><span class="s3">\n</span><span class="s1">import { createSeededPrefetchCacheEntry } from '../prefetch-cache-utils'</span><span class="s3">\n</span><span class="s1">import { removeBasePath } from '../../../remove-base-path'</span><span class="s3">\n</span><span class="s1">import { hasBasePath } from '../../../has-base-path'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">extractInfoFromServerReferenceId,</span><span class="s3">\n  </span><span class="s1">omitUnusedArgs,</span><span class="s3">\n</span><span class="s1">} from '../../../../shared/lib/server-reference-info'</span><span class="s3">\n</span><span class="s1">import { revalidateEntireCache } from '../../segment-cache'</span><span class="s3">\n\n</span><span class="s1">const createFromFetch =</span><span class="s3">\n  </span><span class="s1">createFromFetchBrowser as (typeof import('react-server-dom-webpack/client.browser'))['createFromFetch']</span><span class="s3">\n\n</span><span class="s1">type FetchServerActionResult = {</span><span class="s3">\n  </span><span class="s1">redirectLocation: URL | undefined</span><span class="s3">\n  </span><span class="s1">redirectType: RedirectType | undefined</span><span class="s3">\n  </span><span class="s1">actionResult: ActionResult | undefined</span><span class="s3">\n  </span><span class="s1">actionFlightData: NormalizedFlightData[] | string | undefined</span><span class="s3">\n  </span><span class="s1">isPrerender: boolean</span><span class="s3">\n  </span><span class="s1">revalidatedParts: {</span><span class="s3">\n    </span><span class="s1">tag: boolean</span><span class="s3">\n    </span><span class="s1">cookie: boolean</span><span class="s3">\n    </span><span class="s1">paths: string[]</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">async function fetchServerAction(</span><span class="s3">\n  </span><span class="s1">state: ReadonlyReducerState,</span><span class="s3">\n  </span><span class="s1">nextUrl: ReadonlyReducerState['nextUrl'],</span><span class="s3">\n  </span><span class="s1">{ actionId, actionArgs }: ServerActionAction</span><span class="s3">\n</span><span class="s1">): Promise&lt;FetchServerActionResult&gt; {</span><span class="s3">\n  </span><span class="s1">const temporaryReferences = createTemporaryReferenceSet()</span><span class="s3">\n  </span><span class="s1">const info = extractInfoFromServerReferenceId(actionId)</span><span class="s3">\n\n  </span><span class="s1">// TODO: Currently, we're only omitting unused args for the experimental </span><span class="s3">\&quot;</span><span class="s1">use</span><span class="s3">\n  </span><span class="s1">// cache</span><span class="s3">\&quot; </span><span class="s1">functions. Once the server reference info byte feature is stable, we</span><span class="s3">\n  </span><span class="s1">// should apply this to server actions as well.</span><span class="s3">\n  </span><span class="s1">const usedArgs =</span><span class="s3">\n    </span><span class="s1">info.type === 'use-cache' ? omitUnusedArgs(actionArgs, info) : actionArgs</span><span class="s3">\n\n  </span><span class="s1">const body = await encodeReply(usedArgs, { temporaryReferences })</span><span class="s3">\n\n  </span><span class="s1">const res = await fetch(state.canonicalUrl, {</span><span class="s3">\n    </span><span class="s1">method: 'POST',</span><span class="s3">\n    </span><span class="s1">headers: {</span><span class="s3">\n      </span><span class="s1">Accept: RSC_CONTENT_TYPE_HEADER,</span><span class="s3">\n      </span><span class="s1">[ACTION_HEADER]: actionId,</span><span class="s3">\n      </span><span class="s1">[NEXT_ROUTER_STATE_TREE_HEADER]: prepareFlightRouterStateForRequest(</span><span class="s3">\n        </span><span class="s1">state.tree</span><span class="s3">\n      </span><span class="s1">),</span><span class="s3">\n      </span><span class="s1">...(process.env.NEXT_DEPLOYMENT_ID</span><span class="s3">\n        </span><span class="s1">? {</span><span class="s3">\n            </span><span class="s1">'x-deployment-id': process.env.NEXT_DEPLOYMENT_ID,</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">: {}),</span><span class="s3">\n      </span><span class="s1">...(nextUrl</span><span class="s3">\n        </span><span class="s1">? {</span><span class="s3">\n            </span><span class="s1">[NEXT_URL]: nextUrl,</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">: {}),</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">body,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">// Handle server actions that the server didn't recognize.</span><span class="s3">\n  </span><span class="s1">const unrecognizedActionHeader = res.headers.get(NEXT_ACTION_NOT_FOUND_HEADER)</span><span class="s3">\n  </span><span class="s1">if (unrecognizedActionHeader === '1') {</span><span class="s3">\n    </span><span class="s1">throw new UnrecognizedActionError(</span><span class="s3">\n      </span><span class="s1">`Server Action </span><span class="s3">\&quot;</span><span class="s1">${actionId}</span><span class="s3">\&quot; </span><span class="s1">was not found on the server. </span><span class="s3">\\</span><span class="s1">nRead more: https://nextjs.org/docs/messages/failed-to-find-server-action`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const redirectHeader = res.headers.get('x-action-redirect')</span><span class="s3">\n  </span><span class="s1">const [location, _redirectType] = redirectHeader?.split(';') || []</span><span class="s3">\n  </span><span class="s1">let redirectType: RedirectType | undefined</span><span class="s3">\n  </span><span class="s1">switch (_redirectType) {</span><span class="s3">\n    </span><span class="s1">case 'push':</span><span class="s3">\n      </span><span class="s1">redirectType = RedirectType.push</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">case 'replace':</span><span class="s3">\n      </span><span class="s1">redirectType = RedirectType.replace</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">redirectType = undefined</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const isPrerender = !!res.headers.get(NEXT_IS_PRERENDER_HEADER)</span><span class="s3">\n  </span><span class="s1">let revalidatedParts: FetchServerActionResult['revalidatedParts']</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">const revalidatedHeader = JSON.parse(</span><span class="s3">\n      </span><span class="s1">res.headers.get('x-action-revalidated') || '[[],0,0]'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">revalidatedParts = {</span><span class="s3">\n      </span><span class="s1">paths: revalidatedHeader[0] || [],</span><span class="s3">\n      </span><span class="s1">tag: !!revalidatedHeader[1],</span><span class="s3">\n      </span><span class="s1">cookie: revalidatedHeader[2],</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} catch (e) {</span><span class="s3">\n    </span><span class="s1">revalidatedParts = NO_REVALIDATED_PARTS</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const redirectLocation = location</span><span class="s3">\n    </span><span class="s1">? assignLocation(</span><span class="s3">\n        </span><span class="s1">location,</span><span class="s3">\n        </span><span class="s1">new URL(state.canonicalUrl, window.location.href)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">: undefined</span><span class="s3">\n\n  </span><span class="s1">const contentType = res.headers.get('content-type')</span><span class="s3">\n  </span><span class="s1">const isRscResponse = !!(</span><span class="s3">\n    </span><span class="s1">contentType &amp;&amp; contentType.startsWith(RSC_CONTENT_TYPE_HEADER)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">// Handle invalid server action responses.</span><span class="s3">\n  </span><span class="s1">// A valid response must have `content-type: text/x-component`, unless it's an external redirect.</span><span class="s3">\n  </span><span class="s1">// (external redirects have an 'x-action-redirect' header, but the body is an empty 'text/plain')</span><span class="s3">\n  </span><span class="s1">if (!isRscResponse &amp;&amp; !redirectLocation) {</span><span class="s3">\n    </span><span class="s1">// The server can respond with a text/plain error message, but we'll fallback to something generic</span><span class="s3">\n    </span><span class="s1">// if there isn't one.</span><span class="s3">\n    </span><span class="s1">const message =</span><span class="s3">\n      </span><span class="s1">res.status &gt;= 400 &amp;&amp; contentType === 'text/plain'</span><span class="s3">\n        </span><span class="s1">? await res.text()</span><span class="s3">\n        </span><span class="s1">: 'An unexpected response was received from the server.'</span><span class="s3">\n\n    </span><span class="s1">throw new Error(message)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let actionResult: FetchServerActionResult['actionResult']</span><span class="s3">\n  </span><span class="s1">let actionFlightData: FetchServerActionResult['actionFlightData']</span><span class="s3">\n  </span><span class="s1">if (isRscResponse) {</span><span class="s3">\n    </span><span class="s1">const response: ActionFlightResponse = await createFromFetch(</span><span class="s3">\n      </span><span class="s1">Promise.resolve(res),</span><span class="s3">\n      </span><span class="s1">{ callServer, findSourceMapURL, temporaryReferences }</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">// An internal redirect can send an RSC response, but does not have a useful `actionResult`.</span><span class="s3">\n    </span><span class="s1">actionResult = redirectLocation ? undefined : response.a</span><span class="s3">\n    </span><span class="s1">actionFlightData = normalizeFlightData(response.f)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">// An external redirect doesn't contain RSC data.</span><span class="s3">\n    </span><span class="s1">actionResult = undefined</span><span class="s3">\n    </span><span class="s1">actionFlightData = undefined</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">actionResult,</span><span class="s3">\n    </span><span class="s1">actionFlightData,</span><span class="s3">\n    </span><span class="s1">redirectLocation,</span><span class="s3">\n    </span><span class="s1">redirectType,</span><span class="s3">\n    </span><span class="s1">revalidatedParts,</span><span class="s3">\n    </span><span class="s1">isPrerender,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const NO_REVALIDATED_PARTS = {</span><span class="s3">\n  </span><span class="s1">paths: [],</span><span class="s3">\n  </span><span class="s1">tag: false,</span><span class="s3">\n  </span><span class="s1">cookie: false,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/*</span><span class="s3">\n </span><span class="s1">* This reducer is responsible for calling the server action and processing any side-effects from the server action.</span><span class="s3">\n </span><span class="s1">* It does not mutate the state by itself but rather delegates to other reducers to do the actual mutation.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function serverActionReducer(</span><span class="s3">\n  </span><span class="s1">state: ReadonlyReducerState,</span><span class="s3">\n  </span><span class="s1">action: ServerActionAction</span><span class="s3">\n</span><span class="s1">): ReducerState {</span><span class="s3">\n  </span><span class="s1">const { resolve, reject } = action</span><span class="s3">\n  </span><span class="s1">const mutable: ServerActionMutable = {}</span><span class="s3">\n\n  </span><span class="s1">let currentTree = state.tree</span><span class="s3">\n\n  </span><span class="s1">mutable.preserveCustomHistoryState = false</span><span class="s3">\n\n  </span><span class="s1">// only pass along the `nextUrl` param (used for interception routes) if the current route was intercepted.</span><span class="s3">\n  </span><span class="s1">// If the route has been intercepted, the action should be as well.</span><span class="s3">\n  </span><span class="s1">// Otherwise the server action might be intercepted with the wrong action id</span><span class="s3">\n  </span><span class="s1">// (ie, one that corresponds with the intercepted route)</span><span class="s3">\n  </span><span class="s1">const nextUrl =</span><span class="s3">\n    </span><span class="s1">state.nextUrl &amp;&amp; hasInterceptionRouteInCurrentTree(state.tree)</span><span class="s3">\n      </span><span class="s1">? state.nextUrl</span><span class="s3">\n      </span><span class="s1">: null</span><span class="s3">\n\n  </span><span class="s1">const navigatedAt = Date.now()</span><span class="s3">\n\n  </span><span class="s1">return fetchServerAction(state, nextUrl, action).then(</span><span class="s3">\n    </span><span class="s1">async ({</span><span class="s3">\n      </span><span class="s1">actionResult,</span><span class="s3">\n      </span><span class="s1">actionFlightData: flightData,</span><span class="s3">\n      </span><span class="s1">redirectLocation,</span><span class="s3">\n      </span><span class="s1">redirectType,</span><span class="s3">\n      </span><span class="s1">isPrerender,</span><span class="s3">\n      </span><span class="s1">revalidatedParts,</span><span class="s3">\n    </span><span class="s1">}) =&gt; {</span><span class="s3">\n      </span><span class="s1">let redirectHref: string | undefined</span><span class="s3">\n\n      </span><span class="s1">// honor the redirect type instead of defaulting to push in case of server actions.</span><span class="s3">\n      </span><span class="s1">if (redirectLocation) {</span><span class="s3">\n        </span><span class="s1">if (redirectType === RedirectType.replace) {</span><span class="s3">\n          </span><span class="s1">state.pushRef.pendingPush = false</span><span class="s3">\n          </span><span class="s1">mutable.pendingPush = false</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">state.pushRef.pendingPush = true</span><span class="s3">\n          </span><span class="s1">mutable.pendingPush = true</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">redirectHref = createHrefFromUrl(redirectLocation, false)</span><span class="s3">\n        </span><span class="s1">mutable.canonicalUrl = redirectHref</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (!flightData) {</span><span class="s3">\n        </span><span class="s1">resolve(actionResult)</span><span class="s3">\n\n        </span><span class="s1">// If there is a redirect but no flight data we need to do a mpaNavigation.</span><span class="s3">\n        </span><span class="s1">if (redirectLocation) {</span><span class="s3">\n          </span><span class="s1">return handleExternalUrl(</span><span class="s3">\n            </span><span class="s1">state,</span><span class="s3">\n            </span><span class="s1">mutable,</span><span class="s3">\n            </span><span class="s1">redirectLocation.href,</span><span class="s3">\n            </span><span class="s1">state.pushRef.pendingPush</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">return state</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (typeof flightData === 'string') {</span><span class="s3">\n        </span><span class="s1">// Handle case when navigating to page in `pages` from `app`</span><span class="s3">\n        </span><span class="s1">resolve(actionResult)</span><span class="s3">\n\n        </span><span class="s1">return handleExternalUrl(</span><span class="s3">\n          </span><span class="s1">state,</span><span class="s3">\n          </span><span class="s1">mutable,</span><span class="s3">\n          </span><span class="s1">flightData,</span><span class="s3">\n          </span><span class="s1">state.pushRef.pendingPush</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const actionRevalidated =</span><span class="s3">\n        </span><span class="s1">revalidatedParts.paths.length &gt; 0 ||</span><span class="s3">\n        </span><span class="s1">revalidatedParts.tag ||</span><span class="s3">\n        </span><span class="s1">revalidatedParts.cookie</span><span class="s3">\n\n      </span><span class="s1">for (const normalizedFlightData of flightData) {</span><span class="s3">\n        </span><span class="s1">const {</span><span class="s3">\n          </span><span class="s1">tree: treePatch,</span><span class="s3">\n          </span><span class="s1">seedData: cacheNodeSeedData,</span><span class="s3">\n          </span><span class="s1">head,</span><span class="s3">\n          </span><span class="s1">isRootRender,</span><span class="s3">\n        </span><span class="s1">} = normalizedFlightData</span><span class="s3">\n\n        </span><span class="s1">if (!isRootRender) {</span><span class="s3">\n          </span><span class="s1">// TODO-APP: handle this case better</span><span class="s3">\n          </span><span class="s1">console.log('SERVER ACTION APPLY FAILED')</span><span class="s3">\n          </span><span class="s1">resolve(actionResult)</span><span class="s3">\n\n          </span><span class="s1">return state</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// Given the path can only have two items the items are only the router state and rsc for the root.</span><span class="s3">\n        </span><span class="s1">const newTree = applyRouterStatePatchToTree(</span><span class="s3">\n          </span><span class="s1">// TODO-APP: remove ''</span><span class="s3">\n          </span><span class="s1">[''],</span><span class="s3">\n          </span><span class="s1">currentTree,</span><span class="s3">\n          </span><span class="s1">treePatch,</span><span class="s3">\n          </span><span class="s1">redirectHref ? redirectHref : state.canonicalUrl</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">if (newTree === null) {</span><span class="s3">\n          </span><span class="s1">resolve(actionResult)</span><span class="s3">\n\n          </span><span class="s1">return handleSegmentMismatch(state, action, treePatch)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (isNavigatingToNewRootLayout(currentTree, newTree)) {</span><span class="s3">\n          </span><span class="s1">resolve(actionResult)</span><span class="s3">\n\n          </span><span class="s1">return handleExternalUrl(</span><span class="s3">\n            </span><span class="s1">state,</span><span class="s3">\n            </span><span class="s1">mutable,</span><span class="s3">\n            </span><span class="s1">redirectHref || state.canonicalUrl,</span><span class="s3">\n            </span><span class="s1">state.pushRef.pendingPush</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// The server sent back RSC data for the server action, so we need to apply it to the cache.</span><span class="s3">\n        </span><span class="s1">if (cacheNodeSeedData !== null) {</span><span class="s3">\n          </span><span class="s1">const rsc = cacheNodeSeedData[1]</span><span class="s3">\n          </span><span class="s1">const cache: CacheNode = createEmptyCacheNode()</span><span class="s3">\n          </span><span class="s1">cache.rsc = rsc</span><span class="s3">\n          </span><span class="s1">cache.prefetchRsc = null</span><span class="s3">\n          </span><span class="s1">cache.loading = cacheNodeSeedData[3]</span><span class="s3">\n          </span><span class="s1">fillLazyItemsTillLeafWithHead(</span><span class="s3">\n            </span><span class="s1">navigatedAt,</span><span class="s3">\n            </span><span class="s1">cache,</span><span class="s3">\n            </span><span class="s1">// Existing cache is not passed in as server actions have to invalidate the entire cache.</span><span class="s3">\n            </span><span class="s1">undefined,</span><span class="s3">\n            </span><span class="s1">treePatch,</span><span class="s3">\n            </span><span class="s1">cacheNodeSeedData,</span><span class="s3">\n            </span><span class="s1">head,</span><span class="s3">\n            </span><span class="s1">undefined</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n\n          </span><span class="s1">mutable.cache = cache</span><span class="s3">\n          </span><span class="s1">if (process.env.__NEXT_CLIENT_SEGMENT_CACHE) {</span><span class="s3">\n            </span><span class="s1">revalidateEntireCache(state.nextUrl, newTree)</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">mutable.prefetchCache = new Map()</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">if (actionRevalidated) {</span><span class="s3">\n            </span><span class="s1">await refreshInactiveParallelSegments({</span><span class="s3">\n              </span><span class="s1">navigatedAt,</span><span class="s3">\n              </span><span class="s1">state,</span><span class="s3">\n              </span><span class="s1">updatedTree: newTree,</span><span class="s3">\n              </span><span class="s1">updatedCache: cache,</span><span class="s3">\n              </span><span class="s1">includeNextUrl: Boolean(nextUrl),</span><span class="s3">\n              </span><span class="s1">canonicalUrl: mutable.canonicalUrl || state.canonicalUrl,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">mutable.patchedTree = newTree</span><span class="s3">\n        </span><span class="s1">currentTree = newTree</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (redirectLocation &amp;&amp; redirectHref) {</span><span class="s3">\n        </span><span class="s1">if (!process.env.__NEXT_CLIENT_SEGMENT_CACHE &amp;&amp; !actionRevalidated) {</span><span class="s3">\n          </span><span class="s1">// Because the RedirectBoundary will trigger a navigation, we need to seed the prefetch cache</span><span class="s3">\n          </span><span class="s1">// with the FlightData that we got from the server action for the target page, so that it's</span><span class="s3">\n          </span><span class="s1">// available when the page is navigated to and doesn't need to be re-fetched.</span><span class="s3">\n          </span><span class="s1">// We only do this if the server action didn't revalidate any data, as in that case the</span><span class="s3">\n          </span><span class="s1">// client cache will be cleared and the data will be re-fetched anyway.</span><span class="s3">\n          </span><span class="s1">// NOTE: We don't do this in the Segment Cache implementation.</span><span class="s3">\n          </span><span class="s1">// Dynamic data should never be placed into the cache, unless it's</span><span class="s3">\n          </span><span class="s1">// </span><span class="s3">\&quot;</span><span class="s1">converted</span><span class="s3">\&quot; </span><span class="s1">to static data using &lt;Link prefetch={true}&gt;. What we</span><span class="s3">\n          </span><span class="s1">// do instead is re-prefetch links and forms whenever the cache is</span><span class="s3">\n          </span><span class="s1">// invalidated.</span><span class="s3">\n          </span><span class="s1">createSeededPrefetchCacheEntry({</span><span class="s3">\n            </span><span class="s1">url: redirectLocation,</span><span class="s3">\n            </span><span class="s1">data: {</span><span class="s3">\n              </span><span class="s1">flightData,</span><span class="s3">\n              </span><span class="s1">canonicalUrl: undefined,</span><span class="s3">\n              </span><span class="s1">couldBeIntercepted: false,</span><span class="s3">\n              </span><span class="s1">prerendered: false,</span><span class="s3">\n              </span><span class="s1">postponed: false,</span><span class="s3">\n              </span><span class="s1">// TODO: We should be able to set this if the server action</span><span class="s3">\n              </span><span class="s1">// returned a fully static response.</span><span class="s3">\n              </span><span class="s1">staleTime: -1,</span><span class="s3">\n            </span><span class="s1">},</span><span class="s3">\n            </span><span class="s1">tree: state.tree,</span><span class="s3">\n            </span><span class="s1">prefetchCache: state.prefetchCache,</span><span class="s3">\n            </span><span class="s1">nextUrl: state.nextUrl,</span><span class="s3">\n            </span><span class="s1">kind: isPrerender ? PrefetchKind.FULL : PrefetchKind.AUTO,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">mutable.prefetchCache = state.prefetchCache</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// If the action triggered a redirect, the action promise will be rejected with</span><span class="s3">\n        </span><span class="s1">// a redirect so that it's handled by RedirectBoundary as we won't have a valid</span><span class="s3">\n        </span><span class="s1">// action result to resolve the promise with. This will effectively reset the state of</span><span class="s3">\n        </span><span class="s1">// the component that called the action as the error boundary will remount the tree.</span><span class="s3">\n        </span><span class="s1">// The status code doesn't matter here as the action handler will have already sent</span><span class="s3">\n        </span><span class="s1">// a response with the correct status code.</span><span class="s3">\n        </span><span class="s1">reject(</span><span class="s3">\n          </span><span class="s1">getRedirectError(</span><span class="s3">\n            </span><span class="s1">hasBasePath(redirectHref)</span><span class="s3">\n              </span><span class="s1">? removeBasePath(redirectHref)</span><span class="s3">\n              </span><span class="s1">: redirectHref,</span><span class="s3">\n            </span><span class="s1">redirectType || RedirectType.push</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">resolve(actionResult)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return handleMutable(state, mutable)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">(e: any) =&gt; {</span><span class="s3">\n      </span><span class="s1">// When the server action is rejected we don't update the state and instead call the reject handler of the promise.</span><span class="s3">\n      </span><span class="s1">reject(e)</span><span class="s3">\n\n      </span><span class="s1">return state</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;serverActionReducer&quot;</span><span class="s0">,</span><span class="s1">&quot;createFromFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;createFromFetchBrowser&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchServerAction&quot;</span><span class="s0">,</span><span class="s1">&quot;state&quot;</span><span class="s0">,</span><span class="s1">&quot;nextUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;actionId&quot;</span><span class="s0">,</span><span class="s1">&quot;actionArgs&quot;</span><span class="s0">,</span><span class="s1">&quot;temporaryReferences&quot;</span><span class="s0">,</span><span class="s1">&quot;createTemporaryReferenceSet&quot;</span><span class="s0">,</span><span class="s1">&quot;info&quot;</span><span class="s0">,</span><span class="s1">&quot;extractInfoFromServerReferenceId&quot;</span><span class="s0">,</span><span class="s1">&quot;usedArgs&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;omitUnusedArgs&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;encodeReply&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;fetch&quot;</span><span class="s0">,</span><span class="s1">&quot;canonicalUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;Accept&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;ACTION_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_STATE_TREE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;prepareFlightRouterStateForRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;tree&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_DEPLOYMENT_ID&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_URL&quot;</span><span class="s0">,</span><span class="s1">&quot;unrecognizedActionHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ACTION_NOT_FOUND_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;UnrecognizedActionError&quot;</span><span class="s0">,</span><span class="s1">&quot;redirectHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;location&quot;</span><span class="s0">,</span><span class="s1">&quot;_redirectType&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;redirectType&quot;</span><span class="s0">,</span><span class="s1">&quot;RedirectType&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;isPrerender&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_IS_PRERENDER_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidatedParts&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidatedHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;parse&quot;</span><span class="s0">,</span><span class="s1">&quot;paths&quot;</span><span class="s0">,</span><span class="s1">&quot;tag&quot;</span><span class="s0">,</span><span class="s1">&quot;cookie&quot;</span><span class="s0">,</span><span class="s1">&quot;e&quot;</span><span class="s0">,</span><span class="s1">&quot;NO_REVALIDATED_PARTS&quot;</span><span class="s0">,</span><span class="s1">&quot;redirectLocation&quot;</span><span class="s0">,</span><span class="s1">&quot;assignLocation&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;href&quot;</span><span class="s0">,</span><span class="s1">&quot;contentType&quot;</span><span class="s0">,</span><span class="s1">&quot;isRscResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;text&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;actionResult&quot;</span><span class="s0">,</span><span class="s1">&quot;actionFlightData&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;callServer&quot;</span><span class="s0">,</span><span class="s1">&quot;findSourceMapURL&quot;</span><span class="s0">,</span><span class="s1">&quot;a&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeFlightData&quot;</span><span class="s0">,</span><span class="s1">&quot;f&quot;</span><span class="s0">,</span><span class="s1">&quot;action&quot;</span><span class="s0">,</span><span class="s1">&quot;reject&quot;</span><span class="s0">,</span><span class="s1">&quot;mutable&quot;</span><span class="s0">,</span><span class="s1">&quot;currentTree&quot;</span><span class="s0">,</span><span class="s1">&quot;preserveCustomHistoryState&quot;</span><span class="s0">,</span><span class="s1">&quot;hasInterceptionRouteInCurrentTree&quot;</span><span class="s0">,</span><span class="s1">&quot;navigatedAt&quot;</span><span class="s0">,</span><span class="s1">&quot;Date&quot;</span><span class="s0">,</span><span class="s1">&quot;now&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;flightData&quot;</span><span class="s0">,</span><span class="s1">&quot;redirectHref&quot;</span><span class="s0">,</span><span class="s1">&quot;pushRef&quot;</span><span class="s0">,</span><span class="s1">&quot;pendingPush&quot;</span><span class="s0">,</span><span class="s1">&quot;createHrefFromUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;handleExternalUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;actionRevalidated&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizedFlightData&quot;</span><span class="s0">,</span><span class="s1">&quot;treePatch&quot;</span><span class="s0">,</span><span class="s1">&quot;seedData&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheNodeSeedData&quot;</span><span class="s0">,</span><span class="s1">&quot;head&quot;</span><span class="s0">,</span><span class="s1">&quot;isRootRender&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;log&quot;</span><span class="s0">,</span><span class="s1">&quot;newTree&quot;</span><span class="s0">,</span><span class="s1">&quot;applyRouterStatePatchToTree&quot;</span><span class="s0">,</span><span class="s1">&quot;handleSegmentMismatch&quot;</span><span class="s0">,</span><span class="s1">&quot;isNavigatingToNewRootLayout&quot;</span><span class="s0">,</span><span class="s1">&quot;rsc&quot;</span><span class="s0">,</span><span class="s1">&quot;cache&quot;</span><span class="s0">,</span><span class="s1">&quot;createEmptyCacheNode&quot;</span><span class="s0">,</span><span class="s1">&quot;prefetchRsc&quot;</span><span class="s0">,</span><span class="s1">&quot;loading&quot;</span><span class="s0">,</span><span class="s1">&quot;fillLazyItemsTillLeafWithHead&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_CLIENT_SEGMENT_CACHE&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidateEntireCache&quot;</span><span class="s0">,</span><span class="s1">&quot;prefetchCache&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;refreshInactiveParallelSegments&quot;</span><span class="s0">,</span><span class="s1">&quot;updatedTree&quot;</span><span class="s0">,</span><span class="s1">&quot;updatedCache&quot;</span><span class="s0">,</span><span class="s1">&quot;includeNextUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;Boolean&quot;</span><span class="s0">,</span><span class="s1">&quot;patchedTree&quot;</span><span class="s0">,</span><span class="s1">&quot;createSeededPrefetchCacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;couldBeIntercepted&quot;</span><span class="s0">,</span><span class="s1">&quot;prerendered&quot;</span><span class="s0">,</span><span class="s1">&quot;postponed&quot;</span><span class="s0">,</span><span class="s1">&quot;staleTime&quot;</span><span class="s0">,</span><span class="s1">&quot;kind&quot;</span><span class="s0">,</span><span class="s1">&quot;PrefetchKind&quot;</span><span class="s0">,</span><span class="s1">&quot;FULL&quot;</span><span class="s0">,</span><span class="s1">&quot;AUTO&quot;</span><span class="s0">,</span><span class="s1">&quot;getRedirectError&quot;</span><span class="s0">,</span><span class="s1">&quot;hasBasePath&quot;</span><span class="s0">,</span><span class="s1">&quot;removeBasePath&quot;</span><span class="s0">,</span><span class="s1">&quot;handleMutable&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>