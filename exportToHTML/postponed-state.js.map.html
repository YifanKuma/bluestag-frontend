<html>
<head>
<title>postponed-state.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
postponed-state.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../src/server/app-render/postponed-state.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { FallbackRouteParams } from '../../server/request/fallback-params'</span><span class="s3">\n</span><span class="s1">import type { Params } from '../request/params'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">createPrerenderResumeDataCache,</span><span class="s3">\n  </span><span class="s1">createRenderResumeDataCache,</span><span class="s3">\n  </span><span class="s1">type PrerenderResumeDataCache,</span><span class="s3">\n  </span><span class="s1">type RenderResumeDataCache,</span><span class="s3">\n</span><span class="s1">} from '../resume-data-cache/resume-data-cache'</span><span class="s3">\n</span><span class="s1">import { stringifyResumeDataCache } from '../resume-data-cache/resume-data-cache'</span><span class="s3">\n\n</span><span class="s1">export enum DynamicState {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The dynamic access occurred during the RSC render phase.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">DATA = 1,</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The dynamic access occurred during the HTML shell render phase.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">HTML = 2,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* The postponed state for dynamic data.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export type DynamicDataPostponedState = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The type of dynamic state.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">readonly type: DynamicState.DATA</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The immutable resume data cache.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">readonly renderResumeDataCache: RenderResumeDataCache</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* The postponed state for dynamic HTML.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export type DynamicHTMLPostponedState = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The type of dynamic state.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">readonly type: DynamicState.HTML</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The postponed data used by React.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">readonly data: [</span><span class="s3">\n    </span><span class="s1">preludeState: DynamicHTMLPreludeState,</span><span class="s3">\n    </span><span class="s1">postponed: ReactPostponed,</span><span class="s3">\n  </span><span class="s1">]</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The immutable resume data cache.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">readonly renderResumeDataCache: RenderResumeDataCache</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const enum DynamicHTMLPreludeState {</span><span class="s3">\n  </span><span class="s1">Empty = 0,</span><span class="s3">\n  </span><span class="s1">Full = 1,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type ReactPostponed = NonNullable&lt;</span><span class="s3">\n  </span><span class="s1">import('react-dom/static').PrerenderResult['postponed']</span><span class="s3">\n</span><span class="s1">&gt;</span><span class="s3">\n\n</span><span class="s1">export type PostponedState =</span><span class="s3">\n  </span><span class="s1">| DynamicDataPostponedState</span><span class="s3">\n  </span><span class="s1">| DynamicHTMLPostponedState</span><span class="s3">\n\n</span><span class="s1">export async function getDynamicHTMLPostponedState(</span><span class="s3">\n  </span><span class="s1">postponed: ReactPostponed,</span><span class="s3">\n  </span><span class="s1">preludeState: DynamicHTMLPreludeState,</span><span class="s3">\n  </span><span class="s1">fallbackRouteParams: FallbackRouteParams | null,</span><span class="s3">\n  </span><span class="s1">resumeDataCache: PrerenderResumeDataCache | RenderResumeDataCache</span><span class="s3">\n</span><span class="s1">): Promise&lt;string&gt; {</span><span class="s3">\n  </span><span class="s1">const data: DynamicHTMLPostponedState['data'] = [preludeState, postponed]</span><span class="s3">\n  </span><span class="s1">const dataString = JSON.stringify(data)</span><span class="s3">\n\n  </span><span class="s1">if (!fallbackRouteParams || fallbackRouteParams.size === 0) {</span><span class="s3">\n    </span><span class="s1">// Serialized as `&lt;postponedString.length&gt;:&lt;postponedString&gt;&lt;renderResumeDataCache&gt;`</span><span class="s3">\n    </span><span class="s1">return `${dataString.length}:${dataString}${await stringifyResumeDataCache(</span><span class="s3">\n      </span><span class="s1">createRenderResumeDataCache(resumeDataCache)</span><span class="s3">\n    </span><span class="s1">)}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const replacements: Array&lt;[string, string]&gt; = Array.from(fallbackRouteParams)</span><span class="s3">\n  </span><span class="s1">const replacementsString = JSON.stringify(replacements)</span><span class="s3">\n\n  </span><span class="s1">// Serialized as `&lt;replacements.length&gt;&lt;replacements&gt;&lt;data&gt;`</span><span class="s3">\n  </span><span class="s1">const postponedString = `${replacementsString.length}${replacementsString}${dataString}`</span><span class="s3">\n\n  </span><span class="s1">// Serialized as `&lt;postponedString.length&gt;:&lt;postponedString&gt;&lt;renderResumeDataCache&gt;`</span><span class="s3">\n  </span><span class="s1">return `${postponedString.length}:${postponedString}${await stringifyResumeDataCache(resumeDataCache)}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function getDynamicDataPostponedState(</span><span class="s3">\n  </span><span class="s1">resumeDataCache: PrerenderResumeDataCache | RenderResumeDataCache</span><span class="s3">\n</span><span class="s1">): Promise&lt;string&gt; {</span><span class="s3">\n  </span><span class="s1">return `4:null${await stringifyResumeDataCache(createRenderResumeDataCache(resumeDataCache))}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function parsePostponedState(</span><span class="s3">\n  </span><span class="s1">state: string,</span><span class="s3">\n  </span><span class="s1">params: Params | undefined</span><span class="s3">\n</span><span class="s1">): PostponedState {</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">const postponedStringLengthMatch = state.match(/^([0-9]*):/)?.[1]</span><span class="s3">\n    </span><span class="s1">if (!postponedStringLengthMatch) {</span><span class="s3">\n      </span><span class="s1">throw new Error(`Invariant: invalid postponed state ${state}`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const postponedStringLength = parseInt(postponedStringLengthMatch)</span><span class="s3">\n\n    </span><span class="s1">// We add a `:` to the end of the length as the first character of the</span><span class="s3">\n    </span><span class="s1">// postponed string is the length of the replacement entries.</span><span class="s3">\n    </span><span class="s1">const postponedString = state.slice(</span><span class="s3">\n      </span><span class="s1">postponedStringLengthMatch.length + 1,</span><span class="s3">\n      </span><span class="s1">postponedStringLengthMatch.length + postponedStringLength + 1</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">const renderResumeDataCache = createRenderResumeDataCache(</span><span class="s3">\n      </span><span class="s1">state.slice(postponedStringLengthMatch.length + postponedStringLength + 1)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">if (postponedString === 'null') {</span><span class="s3">\n        </span><span class="s1">return { type: DynamicState.DATA, renderResumeDataCache }</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (/^[0-9]/.test(postponedString)) {</span><span class="s3">\n        </span><span class="s1">const match = postponedString.match(/^([0-9]*)/)?.[1]</span><span class="s3">\n        </span><span class="s1">if (!match) {</span><span class="s3">\n          </span><span class="s1">throw new Error(</span><span class="s3">\n            </span><span class="s1">`Invariant: invalid postponed state ${JSON.stringify(postponedString)}`</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// This is the length of the replacements entries.</span><span class="s3">\n        </span><span class="s1">const length = parseInt(match)</span><span class="s3">\n        </span><span class="s1">const replacements = JSON.parse(</span><span class="s3">\n          </span><span class="s1">postponedString.slice(</span><span class="s3">\n            </span><span class="s1">match.length,</span><span class="s3">\n            </span><span class="s1">// We then go to the end of the string.</span><span class="s3">\n            </span><span class="s1">match.length + length</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">) as ReadonlyArray&lt;[string, string]&gt;</span><span class="s3">\n\n        </span><span class="s1">let postponed = postponedString.slice(match.length + length)</span><span class="s3">\n        </span><span class="s1">for (const [key, searchValue] of replacements) {</span><span class="s3">\n          </span><span class="s1">const value = params?.[key] ?? ''</span><span class="s3">\n          </span><span class="s1">const replaceValue = Array.isArray(value) ? value.join('/') : value</span><span class="s3">\n          </span><span class="s1">postponed = postponed.replaceAll(searchValue, replaceValue)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">return {</span><span class="s3">\n          </span><span class="s1">type: DynamicState.HTML,</span><span class="s3">\n          </span><span class="s1">data: JSON.parse(postponed),</span><span class="s3">\n          </span><span class="s1">renderResumeDataCache,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return {</span><span class="s3">\n        </span><span class="s1">type: DynamicState.HTML,</span><span class="s3">\n        </span><span class="s1">data: JSON.parse(postponedString),</span><span class="s3">\n        </span><span class="s1">renderResumeDataCache,</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} catch (err) {</span><span class="s3">\n      </span><span class="s1">console.error('Failed to parse postponed state', err)</span><span class="s3">\n      </span><span class="s1">return { type: DynamicState.DATA, renderResumeDataCache }</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} catch (err) {</span><span class="s3">\n    </span><span class="s1">console.error('Failed to parse postponed state', err)</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">type: DynamicState.DATA,</span><span class="s3">\n      </span><span class="s1">renderResumeDataCache: createPrerenderResumeDataCache(),</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getPostponedFromState(state: DynamicHTMLPostponedState) {</span><span class="s3">\n  </span><span class="s1">const [preludeState, postponed] = state.data</span><span class="s3">\n  </span><span class="s1">return { preludeState, postponed }</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;DynamicHTMLPreludeState&quot;</span><span class="s0">,</span><span class="s1">&quot;DynamicState&quot;</span><span class="s0">,</span><span class="s1">&quot;getDynamicDataPostponedState&quot;</span><span class="s0">,</span><span class="s1">&quot;getDynamicHTMLPostponedState&quot;</span><span class="s0">,</span><span class="s1">&quot;getPostponedFromState&quot;</span><span class="s0">,</span><span class="s1">&quot;parsePostponedState&quot;</span><span class="s0">,</span><span class="s1">&quot;postponed&quot;</span><span class="s0">,</span><span class="s1">&quot;preludeState&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;resumeDataCache&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;dataString&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;size&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;stringifyResumeDataCache&quot;</span><span class="s0">,</span><span class="s1">&quot;createRenderResumeDataCache&quot;</span><span class="s0">,</span><span class="s1">&quot;replacements&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;replacementsString&quot;</span><span class="s0">,</span><span class="s1">&quot;postponedString&quot;</span><span class="s0">,</span><span class="s1">&quot;state&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;postponedStringLengthMatch&quot;</span><span class="s0">,</span><span class="s1">&quot;match&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;postponedStringLength&quot;</span><span class="s0">,</span><span class="s1">&quot;parseInt&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;renderResumeDataCache&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;parse&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;searchValue&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;replaceValue&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;replaceAll&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;createPrerenderResumeDataCache&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>