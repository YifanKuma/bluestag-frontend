<html>
<head>
<title>operations.h</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #8c8c8c; font-style: italic;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #00627a;}
.s4 { color: #067d17;}
.s5 { color: #000000;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
operations.h</font>
</center></td></tr></table>
<pre><span class="s0">// Copyright 2013 Lovell Fuller and others.</span>
<span class="s0">// SPDX-License-Identifier: Apache-2.0</span>

<span class="s2">#ifndef </span><span class="s3">SRC_OPERATIONS_H_</span>
<span class="s2">#define </span><span class="s3">SRC_OPERATIONS_H_</span>

<span class="s2">#include </span><span class="s4">&lt;algorithm&gt;</span>
<span class="s2">#include </span><span class="s4">&lt;functional&gt;</span>
<span class="s2">#include </span><span class="s4">&lt;memory&gt;</span>
<span class="s2">#include </span><span class="s4">&lt;tuple&gt;</span>
<span class="s2">#include </span><span class="s4">&lt;vips/vips8&gt;</span>

<span class="s2">using </span>vips<span class="s1">::VImage;</span>

<span class="s2">namespace </span>sharp <span class="s1">{</span>

  <span class="s0">/*</span>
   <span class="s0">* Tint an image using the provided RGB. 
   */</span>
  <span class="s1">VImage </span><span class="s3">Tint</span><span class="s1">(</span>VImage image<span class="s1">, </span>std<span class="s1">::</span>vector<span class="s1">&lt;</span><span class="s2">double</span><span class="s1">&gt; </span><span class="s2">const </span>tint<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Stretch luminance to cover full dynamic range. 
   */</span>
  <span class="s1">VImage </span><span class="s3">Normalise</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">int const </span>lower<span class="s1">, </span><span class="s2">int const </span>upper<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Contrast limiting adapative histogram equalization (CLAHE) 
   */</span>
  <span class="s1">VImage </span><span class="s3">Clahe</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">int const </span>width<span class="s1">, </span><span class="s2">int const </span>height<span class="s1">, </span><span class="s2">int const </span>maxSlope<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Gamma encoding/decoding 
   */</span>
  <span class="s1">VImage </span><span class="s3">Gamma</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">double const </span>exponent<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Flatten image to remove alpha channel 
   */</span>
  <span class="s1">VImage </span><span class="s3">Flatten</span><span class="s1">(</span>VImage image<span class="s1">, </span>std<span class="s1">::</span>vector<span class="s1">&lt;</span><span class="s2">double</span><span class="s1">&gt; </span>flattenBackground<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Produce the &quot;negative&quot; of the image. 
   */</span>
  <span class="s1">VImage </span><span class="s3">Negate</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">bool const </span>negateAlpha<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Gaussian blur. Use sigma of -1.0 for fast blur. 
   */</span>
  <span class="s1">VImage </span><span class="s3">Blur</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">double const </span>sigma<span class="s1">, </span>VipsPrecision precision<span class="s1">, </span><span class="s2">double const </span>minAmpl<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Convolution with a kernel. 
   */</span>
  <span class="s1">VImage </span><span class="s3">Convolve</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">int const </span>width<span class="s1">, </span><span class="s2">int const </span>height<span class="s1">,</span>
    <span class="s2">double const </span>scale<span class="s1">, </span><span class="s2">double const </span>offset<span class="s1">, </span>std<span class="s1">::</span>vector<span class="s1">&lt;</span><span class="s2">double</span><span class="s1">&gt; </span><span class="s2">const &amp;</span>kernel_v<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Sharpen flat and jagged areas. Use sigma of -1.0 for fast sharpen. 
   */</span>
  <span class="s1">VImage </span><span class="s3">Sharpen</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">double const </span>sigma<span class="s1">, </span><span class="s2">double const </span>m1<span class="s1">, </span><span class="s2">double const </span>m2<span class="s1">,</span>
    <span class="s2">double const </span>x1<span class="s1">, </span><span class="s2">double const </span>y2<span class="s1">, </span><span class="s2">double const </span>y3<span class="s1">);</span>

  <span class="s0">/*</span>
    <span class="s0">Threshold an image 
  */</span>
  <span class="s1">VImage </span><span class="s3">Threshold</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">double const </span>threshold<span class="s1">, </span><span class="s2">bool const </span>thresholdColor<span class="s1">);</span>

  <span class="s0">/*</span>
    <span class="s0">Perform boolean/bitwise operation on image color channels - results in one channel image 
  */</span>
  <span class="s1">VImage </span><span class="s3">Bandbool</span><span class="s1">(</span>VImage image<span class="s1">, </span>VipsOperationBoolean <span class="s2">const </span>boolean<span class="s1">);</span>

  <span class="s0">/*</span>
    <span class="s0">Perform bitwise boolean operation between images 
  */</span>
  <span class="s1">VImage </span><span class="s3">Boolean</span><span class="s1">(</span>VImage image<span class="s1">, </span>VImage imageR<span class="s1">, </span>VipsOperationBoolean <span class="s2">const </span>boolean<span class="s1">);</span>

  <span class="s0">/*</span>
    <span class="s0">Trim an image 
  */</span>
  <span class="s1">VImage </span><span class="s3">Trim</span><span class="s1">(</span>VImage image<span class="s1">, </span>std<span class="s1">::</span>vector<span class="s1">&lt;</span><span class="s2">double</span><span class="s1">&gt; </span>background<span class="s1">, </span><span class="s2">double </span>threshold<span class="s1">, </span><span class="s2">bool const </span>lineArt<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Linear adjustment (a * in + b) 
   */</span>
  <span class="s1">VImage </span><span class="s3">Linear</span><span class="s1">(</span>VImage image<span class="s1">, </span>std<span class="s1">::</span>vector<span class="s1">&lt;</span><span class="s2">double</span><span class="s1">&gt; </span><span class="s2">const </span>a<span class="s1">,  </span>std<span class="s1">::</span>vector<span class="s1">&lt;</span><span class="s2">double</span><span class="s1">&gt; </span><span class="s2">const </span>b<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Unflatten 
   */</span>
  <span class="s1">VImage </span><span class="s3">Unflatten</span><span class="s1">(</span>VImage image<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Recomb with a Matrix of the given bands/channel size. 
   * Eg. RGB will be a 3x3 matrix. 
   */</span>
  <span class="s1">VImage </span><span class="s3">Recomb</span><span class="s1">(</span>VImage image<span class="s1">, </span>std<span class="s1">::</span>vector<span class="s1">&lt;</span><span class="s2">double</span><span class="s1">&gt; </span><span class="s2">const &amp;</span>matrix<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Modulate brightness, saturation, hue and lightness 
   */</span>
  <span class="s1">VImage </span><span class="s3">Modulate</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">double const </span>brightness<span class="s1">, </span><span class="s2">double const </span>saturation<span class="s1">,</span>
                  <span class="s2">int const </span>hue<span class="s1">, </span><span class="s2">double const </span>lightness<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Ensure the image is in a given colourspace 
   */</span>
  <span class="s1">VImage </span><span class="s3">EnsureColourspace</span><span class="s1">(</span>VImage image<span class="s1">, </span>VipsInterpretation colourspace<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Split and crop each frame, reassemble, and update pageHeight. 
   */</span>
  <span class="s1">VImage </span><span class="s3">CropMultiPage</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">int </span>left<span class="s1">, </span><span class="s2">int </span>top<span class="s1">, </span><span class="s2">int </span>width<span class="s1">, </span><span class="s2">int </span>height<span class="s1">,</span>
                       <span class="s2">int </span>nPages<span class="s1">, </span><span class="s2">int *</span>pageHeight<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Split into frames, embed each frame, reassemble, and update pageHeight. 
   */</span>
  <span class="s1">VImage </span><span class="s3">EmbedMultiPage</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">int </span>left<span class="s1">, </span><span class="s2">int </span>top<span class="s1">, </span><span class="s2">int </span>width<span class="s1">, </span><span class="s2">int </span>height<span class="s1">,</span>
                        VipsExtend extendWith<span class="s1">, </span>std<span class="s1">::</span>vector<span class="s1">&lt;</span><span class="s2">double</span><span class="s1">&gt; </span>background<span class="s1">, </span><span class="s2">int </span>nPages<span class="s1">, </span><span class="s2">int *</span>pageHeight<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Dilate an image 
   */</span>
  <span class="s1">VImage </span><span class="s3">Dilate</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">int const </span>maskWidth<span class="s1">);</span>

  <span class="s0">/*</span>
   <span class="s0">* Erode an image 
   */</span>
  <span class="s1">VImage </span><span class="s3">Erode</span><span class="s1">(</span>VImage image<span class="s1">, </span><span class="s2">int const </span>maskWidth<span class="s1">);</span>
<span class="s1">}  </span><span class="s0">// namespace sharp</span>

<span class="s2">#endif  </span><span class="s0">// SRC_OPERATIONS_H_</span>
</pre>
</body>
</html>