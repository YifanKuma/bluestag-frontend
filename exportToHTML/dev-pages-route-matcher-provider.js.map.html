<html>
<head>
<title>dev-pages-route-matcher-provider.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
dev-pages-route-matcher-provider.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/server/route-matcher-providers/dev/dev-pages-route-matcher-provider.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { FileReader } from './helpers/file-reader/file-reader'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">PagesRouteMatcher,</span><span class="s3">\n  </span><span class="s1">PagesLocaleRouteMatcher,</span><span class="s3">\n</span><span class="s1">} from '../../route-matchers/pages-route-matcher'</span><span class="s3">\n</span><span class="s1">import { RouteKind } from '../../route-kind'</span><span class="s3">\n</span><span class="s1">import path from 'path'</span><span class="s3">\n</span><span class="s1">import type { LocaleRouteNormalizer } from '../../normalizers/locale-route-normalizer'</span><span class="s3">\n</span><span class="s1">import { FileCacheRouteMatcherProvider } from './file-cache-route-matcher-provider'</span><span class="s3">\n</span><span class="s1">import { DevPagesNormalizers } from '../../normalizers/built/pages'</span><span class="s3">\n\n</span><span class="s1">export class DevPagesRouteMatcherProvider extends FileCacheRouteMatcherProvider&lt;PagesRouteMatcher&gt; {</span><span class="s3">\n  </span><span class="s1">private readonly expression: RegExp</span><span class="s3">\n  </span><span class="s1">private readonly normalizers: DevPagesNormalizers</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">private readonly pagesDir: string,</span><span class="s3">\n    </span><span class="s1">private readonly extensions: ReadonlyArray&lt;string&gt;,</span><span class="s3">\n    </span><span class="s1">reader: FileReader,</span><span class="s3">\n    </span><span class="s1">private readonly localeNormalizer?: LocaleRouteNormalizer</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">super(pagesDir, reader)</span><span class="s3">\n\n    </span><span class="s1">// Match any route file that ends with `/${filename}.${extension}` under the</span><span class="s3">\n    </span><span class="s1">// pages directory.</span><span class="s3">\n    </span><span class="s1">this.expression = new RegExp(`</span><span class="s3">\\\\</span><span class="s1">.(?:${extensions.join('|')})$`)</span><span class="s3">\n\n    </span><span class="s1">this.normalizers = new DevPagesNormalizers(pagesDir, extensions)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private test(filename: string): boolean {</span><span class="s3">\n    </span><span class="s1">// If the file does not end in the correct extension it's not a match.</span><span class="s3">\n    </span><span class="s1">if (!this.expression.test(filename)) return false</span><span class="s3">\n\n    </span><span class="s1">// Pages routes must exist in the pages directory without the `/api/`</span><span class="s3">\n    </span><span class="s1">// prefix. The pathnames being tested here though are the full filenames,</span><span class="s3">\n    </span><span class="s1">// so we need to include the pages directory.</span><span class="s3">\n\n    </span><span class="s1">// TODO: could path separator normalization be needed here?</span><span class="s3">\n    </span><span class="s1">if (filename.startsWith(path.join(this.pagesDir, '/api/'))) return false</span><span class="s3">\n\n    </span><span class="s1">for (const extension of this.extensions) {</span><span class="s3">\n      </span><span class="s1">// We can also match if we have `pages/api.${extension}`, so check to</span><span class="s3">\n      </span><span class="s1">// see if it's a match.</span><span class="s3">\n      </span><span class="s1">if (filename === path.join(this.pagesDir, `api.${extension}`)) {</span><span class="s3">\n        </span><span class="s1">return false</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">protected async transform(</span><span class="s3">\n    </span><span class="s1">files: ReadonlyArray&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">): Promise&lt;ReadonlyArray&lt;PagesRouteMatcher&gt;&gt; {</span><span class="s3">\n    </span><span class="s1">const matchers: Array&lt;PagesRouteMatcher&gt; = []</span><span class="s3">\n    </span><span class="s1">for (const filename of files) {</span><span class="s3">\n      </span><span class="s1">// If the file isn't a match for this matcher, then skip it.</span><span class="s3">\n      </span><span class="s1">if (!this.test(filename)) continue</span><span class="s3">\n\n      </span><span class="s1">const pathname = this.normalizers.pathname.normalize(filename)</span><span class="s3">\n      </span><span class="s1">const page = this.normalizers.page.normalize(filename)</span><span class="s3">\n      </span><span class="s1">const bundlePath = this.normalizers.bundlePath.normalize(filename)</span><span class="s3">\n\n      </span><span class="s1">if (this.localeNormalizer) {</span><span class="s3">\n        </span><span class="s1">matchers.push(</span><span class="s3">\n          </span><span class="s1">new PagesLocaleRouteMatcher({</span><span class="s3">\n            </span><span class="s1">kind: RouteKind.PAGES,</span><span class="s3">\n            </span><span class="s1">pathname,</span><span class="s3">\n            </span><span class="s1">page,</span><span class="s3">\n            </span><span class="s1">bundlePath,</span><span class="s3">\n            </span><span class="s1">filename,</span><span class="s3">\n            </span><span class="s1">i18n: {},</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">matchers.push(</span><span class="s3">\n          </span><span class="s1">new PagesRouteMatcher({</span><span class="s3">\n            </span><span class="s1">kind: RouteKind.PAGES,</span><span class="s3">\n            </span><span class="s1">pathname,</span><span class="s3">\n            </span><span class="s1">page,</span><span class="s3">\n            </span><span class="s1">bundlePath,</span><span class="s3">\n            </span><span class="s1">filename,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return matchers</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;DevPagesRouteMatcherProvider&quot;</span><span class="s0">,</span><span class="s1">&quot;FileCacheRouteMatcherProvider&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;pagesDir&quot;</span><span class="s0">,</span><span class="s1">&quot;extensions&quot;</span><span class="s0">,</span><span class="s1">&quot;reader&quot;</span><span class="s0">,</span><span class="s1">&quot;localeNormalizer&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizers&quot;</span><span class="s0">,</span><span class="s1">&quot;DevPagesNormalizers&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;filename&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;extension&quot;</span><span class="s0">,</span><span class="s1">&quot;transform&quot;</span><span class="s0">,</span><span class="s1">&quot;files&quot;</span><span class="s0">,</span><span class="s1">&quot;matchers&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;normalize&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;bundlePath&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;PagesLocaleRouteMatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;kind&quot;</span><span class="s0">,</span><span class="s1">&quot;RouteKind&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGES&quot;</span><span class="s0">,</span><span class="s1">&quot;i18n&quot;</span><span class="s0">,</span><span class="s1">&quot;PagesRouteMatcher&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BAWaA;;;eAAAA;;;mCAPN;2BACmB;6DACT;+CAE6B;uBACV;;;;;;AAE7B,MAAMA,qCAAqCC,4DAA6B;IAI7EC,YACE,AAAiBC,QAAgB,EACjC,AAAiBC,UAAiC,EAClDC,MAAkB,EAClB,AAAiBC,gBAAwC,CACzD;QACA,KAAK,CAACH,UAAUE,cALCF,WAAAA,eACAC,aAAAA,iBAEAE,mBAAAA;QAIjB,4EAA4E;QAC5E,mBAAmB;QACnB,IAAI,CAACC,UAAU,GAAG,IAAIC,OAAO,CAAC,MAAM,EAAEJ,WAAWK,IAAI,CAAC,KAAK,EAAE,CAAC;QAE9D,IAAI,CAACC,WAAW,GAAG,IAAIC,0BAAmB,CAACR,UAAUC;IACvD;IAEQQ,KAAKC,QAAgB,EAAW;QACtC,sEAAsE;QACtE,IAAI,CAAC,IAAI,CAACN,UAAU,CAACK,IAAI,CAACC,WAAW,OAAO;QAE5C,qEAAqE;QACrE,yEAAyE;QACzE,6CAA6C;QAE7C,2DAA2D;QAC3D,IAAIA,SAASC,UAAU,CAACC,aAAI,CAACN,IAAI,CAAC,IAAI,CAACN,QAAQ,EAAE,WAAW,OAAO;QAEnE,KAAK,MAAMa,aAAa,IAAI,CAACZ,UAAU,CAAE;YACvC,qEAAqE;YACrE,uBAAuB;YACvB,IAAIS,aAAaE,aAAI,CAACN,IAAI,CAAC,IAAI,CAACN,QAAQ,EAAE,CAAC,IAAI,EAAEa,WAAW,GAAG;gBAC7D,OAAO;YACT;QACF;QAEA,OAAO;IACT;IAEA,MAAgBC,UACdC,KAA4B,EACe;QAC3C,MAAMC,WAAqC,EAAE;QAC7C,KAAK,MAAMN,YAAYK,MAAO;YAC5B,4DAA4D;YAC5D,IAAI,CAAC,IAAI,CAACN,IAAI,CAACC,WAAW;YAE1B,MAAMO,WAAW,IAAI,CAACV,WAAW,CAACU,QAAQ,CAACC,SAAS,CAACR;YACrD,MAAMS,OAAO,IAAI,CAACZ,WAAW,CAACY,IAAI,CAACD,SAAS,CAACR;YAC7C,MAAMU,aAAa,IAAI,CAACb,WAAW,CAACa,UAAU,CAACF,SAAS,CAACR;YAEzD,IAAI,IAAI,CAACP,gBAAgB,EAAE;gBACzBa,SAASK,IAAI,CACX,IAAIC,0CAAuB,CAAC;oBAC1BC,MAAMC,oBAAS,CAACC,KAAK;oBACrBR;oBACAE;oBACAC;oBACAV;oBACAgB,MAAM,CAAC;gBACT;YAEJ,OAAO;gBACLV,SAASK,IAAI,CACX,IAAIM,oCAAiB,CAAC;oBACpBJ,MAAMC,oBAAS,CAACC,KAAK;oBACrBR;oBACAE;oBACAC;oBACAV;gBACF;YAEJ;QACF;QAEA,OAAOM;IACT;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>