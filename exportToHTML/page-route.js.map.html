<html>
<head>
<title>page-route.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
page-route.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/experimental/testmode/playwright/page-route.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type {</span><span class="s3">\n  </span><span class="s1">Page,</span><span class="s3">\n  </span><span class="s1">Route,</span><span class="s3">\n  </span><span class="s1">Request as PlaywrightRequest,</span><span class="s3">\n</span><span class="s1">} from '@playwright/test'</span><span class="s3">\n</span><span class="s1">import type { FetchHandler } from './next-worker-fixture'</span><span class="s3">\n\n</span><span class="s1">function continueRoute(</span><span class="s3">\n  </span><span class="s1">route: Route,</span><span class="s3">\n  </span><span class="s1">request: PlaywrightRequest,</span><span class="s3">\n  </span><span class="s1">testHeaders: Record&lt;string, string&gt;</span><span class="s3">\n</span><span class="s1">): Promise&lt;void&gt; {</span><span class="s3">\n  </span><span class="s1">return route.continue({</span><span class="s3">\n    </span><span class="s1">headers: {</span><span class="s3">\n      </span><span class="s1">...request.headers(),</span><span class="s3">\n      </span><span class="s1">...testHeaders,</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function handleRoute(</span><span class="s3">\n  </span><span class="s1">route: Route,</span><span class="s3">\n  </span><span class="s1">page: Page,</span><span class="s3">\n  </span><span class="s1">testHeaders: Record&lt;string, string&gt;,</span><span class="s3">\n  </span><span class="s1">fetchHandler: FetchHandler | null</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const request = route.request()</span><span class="s3">\n\n  </span><span class="s1">// Continue the navigation and non-fetch requests.</span><span class="s3">\n  </span><span class="s1">if (request.isNavigationRequest() || request.resourceType() !== 'fetch') {</span><span class="s3">\n    </span><span class="s1">return continueRoute(route, request, testHeaders)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Continue the local requests. The followup requests will be intercepted</span><span class="s3">\n  </span><span class="s1">// on the server.</span><span class="s3">\n  </span><span class="s1">const pageOrigin = new URL(page.url()).origin</span><span class="s3">\n  </span><span class="s1">const requestOrigin = new URL(request.url()).origin</span><span class="s3">\n  </span><span class="s1">if (pageOrigin === requestOrigin) {</span><span class="s3">\n    </span><span class="s1">return continueRoute(route, request, testHeaders)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!fetchHandler) {</span><span class="s3">\n    </span><span class="s1">return route.abort()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const postData = request.postDataBuffer()</span><span class="s3">\n  </span><span class="s1">const fetchRequest = new Request(request.url(), {</span><span class="s3">\n    </span><span class="s1">method: request.method(),</span><span class="s3">\n    </span><span class="s1">headers: Object.fromEntries(</span><span class="s3">\n      </span><span class="s1">Object.entries(request.headers()).filter(</span><span class="s3">\n        </span><span class="s1">([name]) =&gt; !name.toLowerCase().startsWith('next-test-')</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">body: postData ?? null,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">const proxyResponse = await fetchHandler(fetchRequest)</span><span class="s3">\n  </span><span class="s1">if (!proxyResponse) {</span><span class="s3">\n    </span><span class="s1">return route.abort()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (proxyResponse === 'abort') {</span><span class="s3">\n    </span><span class="s1">return route.abort()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (proxyResponse === 'continue') {</span><span class="s3">\n    </span><span class="s1">return continueRoute(route, request, testHeaders)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const { status, headers, body } = proxyResponse</span><span class="s3">\n  </span><span class="s1">return route.fulfill({</span><span class="s3">\n    </span><span class="s1">status,</span><span class="s3">\n    </span><span class="s1">headers: Object.fromEntries(headers),</span><span class="s3">\n    </span><span class="s1">body: body ? Buffer.from(await proxyResponse.arrayBuffer()) : undefined,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;handleRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;continueRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;testHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;continue&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;isNavigationRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;resourceType&quot;</span><span class="s0">,</span><span class="s1">&quot;pageOrigin&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;origin&quot;</span><span class="s0">,</span><span class="s1">&quot;requestOrigin&quot;</span><span class="s0">,</span><span class="s1">&quot;abort&quot;</span><span class="s0">,</span><span class="s1">&quot;postData&quot;</span><span class="s0">,</span><span class="s1">&quot;postDataBuffer&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;Request&quot;</span><span class="s0">,</span><span class="s1">&quot;method&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;fromEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;proxyResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;fulfill&quot;</span><span class="s0">,</span><span class="s1">&quot;Buffer&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;arrayBuffer&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BAoBsBA;;;eAAAA;;;AAbtB,SAASC,cACPC,KAAY,EACZC,OAA0B,EAC1BC,WAAmC;IAEnC,OAAOF,MAAMG,QAAQ,CAAC;QACpBC,SAAS;YACP,GAAGH,QAAQG,OAAO,EAAE;YACpB,GAAGF,WAAW;QAChB;IACF;AACF;AAEO,eAAeJ,YACpBE,KAAY,EACZK,IAAU,EACVH,WAAmC,EACnCI,YAAiC;IAEjC,MAAML,UAAUD,MAAMC,OAAO;IAE7B,kDAAkD;IAClD,IAAIA,QAAQM,mBAAmB,MAAMN,QAAQO,YAAY,OAAO,SAAS;QACvE,OAAOT,cAAcC,OAAOC,SAASC;IACvC;IAEA,yEAAyE;IACzE,iBAAiB;IACjB,MAAMO,aAAa,IAAIC,IAAIL,KAAKM,GAAG,IAAIC,MAAM;IAC7C,MAAMC,gBAAgB,IAAIH,IAAIT,QAAQU,GAAG,IAAIC,MAAM;IACnD,IAAIH,eAAeI,eAAe;QAChC,OAAOd,cAAcC,OAAOC,SAASC;IACvC;IAEA,IAAI,CAACI,cAAc;QACjB,OAAON,MAAMc,KAAK;IACpB;IAEA,MAAMC,WAAWd,QAAQe,cAAc;IACvC,MAAMC,eAAe,IAAIC,QAAQjB,QAAQU,GAAG,IAAI;QAC9CQ,QAAQlB,QAAQkB,MAAM;QACtBf,SAASgB,OAAOC,WAAW,CACzBD,OAAOE,OAAO,CAACrB,QAAQG,OAAO,IAAImB,MAAM,CACtC,CAAC,CAACC,KAAK,GAAK,CAACA,KAAKC,WAAW,GAAGC,UAAU,CAAC;QAG/CC,MAAMZ,YAAY;IACpB;IAEA,MAAMa,gBAAgB,MAAMtB,aAAaW;IACzC,IAAI,CAACW,eAAe;QAClB,OAAO5B,MAAMc,KAAK;IACpB;IACA,IAAIc,kBAAkB,SAAS;QAC7B,OAAO5B,MAAMc,KAAK;IACpB;IACA,IAAIc,kBAAkB,YAAY;QAChC,OAAO7B,cAAcC,OAAOC,SAASC;IACvC;IACA,MAAM,EAAE2B,MAAM,EAAEzB,OAAO,EAAEuB,IAAI,EAAE,GAAGC;IAClC,OAAO5B,MAAM8B,OAAO,CAAC;QACnBD;QACAzB,SAASgB,OAAOC,WAAW,CAACjB;QAC5BuB,MAAMA,OAAOI,OAAOC,IAAI,CAAC,MAAMJ,cAAcK,WAAW,MAAMC;IAChE;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>