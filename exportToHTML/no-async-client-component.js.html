<html>
<head>
<title>no-async-client-component.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #264eff;}
.s4 { color: #1750eb;}
.s5 { color: #8c8c8c; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
no-async-client-component.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>
<span class="s2">var </span><span class="s1">_definerule = require(</span><span class="s0">&quot;../utils/define-rule&quot;</span><span class="s1">);</span>
<span class="s2">var </span><span class="s1">url = </span><span class="s0">'https://nextjs.org/docs/messages/no-async-client-component'</span><span class="s1">;</span>
<span class="s2">var </span><span class="s1">description = </span><span class="s0">'Prevent Client Components from being async functions.'</span><span class="s1">;</span>
<span class="s2">var </span><span class="s1">message = </span><span class="s0">&quot;&quot;</span><span class="s1">.concat(description, </span><span class="s0">&quot; See: &quot;</span><span class="s1">).concat(url);</span>
<span class="s2">function </span><span class="s1">isCapitalized(str) {</span>
    <span class="s2">return </span><span class="s3">/[A-Z]/</span><span class="s1">.test(str === </span><span class="s2">null </span><span class="s1">|| str === </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">? </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">: str[</span><span class="s4">0</span><span class="s1">]);</span>
<span class="s1">}</span>
<span class="s1">module.exports = (</span><span class="s4">0</span><span class="s1">, _definerule.defineRule)({</span>
    <span class="s1">meta: {</span>
        <span class="s1">docs: {</span>
            <span class="s1">description: description,</span>
            <span class="s1">recommended: </span><span class="s2">true</span><span class="s1">,</span>
            <span class="s1">url: url</span>
        <span class="s1">},</span>
        <span class="s1">type: </span><span class="s0">'problem'</span><span class="s1">,</span>
        <span class="s1">schema: []</span>
    <span class="s1">},</span>
    <span class="s1">create: </span><span class="s2">function </span><span class="s1">create(context) {</span>
        <span class="s2">return </span><span class="s1">{</span>
            <span class="s1">Program: </span><span class="s2">function </span><span class="s1">Program(node) {</span>
                <span class="s2">var </span><span class="s1">isClientComponent = </span><span class="s2">false</span><span class="s1">;</span>
                <span class="s2">var </span><span class="s1">_iteratorNormalCompletion = </span><span class="s2">true</span><span class="s1">, _didIteratorError = </span><span class="s2">false</span><span class="s1">, _iteratorError = undefined;</span>
                <span class="s2">try </span><span class="s1">{</span>
                    <span class="s2">var </span><span class="s1">_loop = </span><span class="s2">function</span><span class="s1">() {</span>
                        <span class="s2">var </span><span class="s1">block = _step.value;</span>
                        <span class="s2">if </span><span class="s1">(block.type === </span><span class="s0">'ExpressionStatement' </span><span class="s1">&amp;&amp; block.expression.type === </span><span class="s0">'Literal' </span><span class="s1">&amp;&amp; block.expression.value === </span><span class="s0">'use client'</span><span class="s1">) {</span>
                            <span class="s1">isClientComponent = </span><span class="s2">true</span><span class="s1">;</span>
                        <span class="s1">}</span>
                        <span class="s2">if </span><span class="s1">(block.type === </span><span class="s0">'ExportDefaultDeclaration' </span><span class="s1">&amp;&amp; isClientComponent) {</span>
                            <span class="s2">var </span><span class="s1">_block_declaration;</span>
                            <span class="s5">// export default async function MyComponent() {...}</span>
                            <span class="s2">if </span><span class="s1">(((_block_declaration = block.declaration) === </span><span class="s2">null </span><span class="s1">|| _block_declaration === </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">? </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">: _block_declaration.type) === </span><span class="s0">'FunctionDeclaration' </span><span class="s1">&amp;&amp; block.declaration.async &amp;&amp; isCapitalized(block.declaration.id.name)) {</span>
                                <span class="s1">context.report({</span>
                                    <span class="s1">node: block,</span>
                                    <span class="s1">message: message</span>
                                <span class="s1">});</span>
                            <span class="s1">}</span>
                            <span class="s5">// async function MyComponent() {...}; export default MyComponent;</span>
                            <span class="s2">if </span><span class="s1">(block.declaration.type === </span><span class="s0">'Identifier' </span><span class="s1">&amp;&amp; isCapitalized(block.declaration.name)) {</span>
                                <span class="s2">var </span><span class="s1">targetName = block.declaration.name;</span>
                                <span class="s2">var </span><span class="s1">functionDeclaration = node.body.find(</span><span class="s2">function</span><span class="s1">(localBlock) {</span>
                                    <span class="s2">if </span><span class="s1">(localBlock.type === </span><span class="s0">'FunctionDeclaration' </span><span class="s1">&amp;&amp; localBlock.id.name === targetName) </span><span class="s2">return true</span><span class="s1">;</span>
                                    <span class="s2">if </span><span class="s1">(localBlock.type === </span><span class="s0">'VariableDeclaration' </span><span class="s1">&amp;&amp; localBlock.declarations.find(</span><span class="s2">function</span><span class="s1">(declaration) {</span>
                                        <span class="s2">var </span><span class="s1">_declaration_id;</span>
                                        <span class="s2">return </span><span class="s1">((_declaration_id = declaration.id) === </span><span class="s2">null </span><span class="s1">|| _declaration_id === </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">? </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">: _declaration_id.type) === </span><span class="s0">'Identifier' </span><span class="s1">&amp;&amp; declaration.id.name === targetName;</span>
                                    <span class="s1">})) </span><span class="s2">return true</span><span class="s1">;</span>
                                    <span class="s2">return false</span><span class="s1">;</span>
                                <span class="s1">});</span>
                                <span class="s2">if </span><span class="s1">((functionDeclaration === </span><span class="s2">null </span><span class="s1">|| functionDeclaration === </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">? </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">: functionDeclaration.type) === </span><span class="s0">'FunctionDeclaration' </span><span class="s1">&amp;&amp; functionDeclaration.async) {</span>
                                    <span class="s1">context.report({</span>
                                        <span class="s1">node: functionDeclaration,</span>
                                        <span class="s1">message: message</span>
                                    <span class="s1">});</span>
                                <span class="s1">}</span>
                                <span class="s2">if </span><span class="s1">((functionDeclaration === </span><span class="s2">null </span><span class="s1">|| functionDeclaration === </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">? </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">: functionDeclaration.type) === </span><span class="s0">'VariableDeclaration'</span><span class="s1">) {</span>
                                    <span class="s2">var </span><span class="s1">_varDeclarator_init;</span>
                                    <span class="s2">var </span><span class="s1">varDeclarator = functionDeclaration.declarations.find(</span><span class="s2">function</span><span class="s1">(declaration) {</span>
                                        <span class="s2">var </span><span class="s1">_declaration_id;</span>
                                        <span class="s2">return </span><span class="s1">((_declaration_id = declaration.id) === </span><span class="s2">null </span><span class="s1">|| _declaration_id === </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">? </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">: _declaration_id.type) === </span><span class="s0">'Identifier' </span><span class="s1">&amp;&amp; declaration.id.name === targetName;</span>
                                    <span class="s1">});</span>
                                    <span class="s2">if </span><span class="s1">((varDeclarator === </span><span class="s2">null </span><span class="s1">|| varDeclarator === </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">? </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">: (_varDeclarator_init = varDeclarator.init) === </span><span class="s2">null </span><span class="s1">|| _varDeclarator_init === </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">? </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">: _varDeclarator_init.type) === </span><span class="s0">'ArrowFunctionExpression' </span><span class="s1">&amp;&amp; varDeclarator.init.async) {</span>
                                        <span class="s1">context.report({</span>
                                            <span class="s1">node: functionDeclaration,</span>
                                            <span class="s1">message: message</span>
                                        <span class="s1">});</span>
                                    <span class="s1">}</span>
                                <span class="s1">}</span>
                            <span class="s1">}</span>
                        <span class="s1">}</span>
                    <span class="s1">};</span>
                    <span class="s2">for</span><span class="s1">(</span><span class="s2">var </span><span class="s1">_iterator = node.body[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = </span><span class="s2">true</span><span class="s1">)_loop();</span>
                <span class="s1">} </span><span class="s2">catch </span><span class="s1">(err) {</span>
                    <span class="s1">_didIteratorError = </span><span class="s2">true</span><span class="s1">;</span>
                    <span class="s1">_iteratorError = err;</span>
                <span class="s1">} </span><span class="s2">finally</span><span class="s1">{</span>
                    <span class="s2">try </span><span class="s1">{</span>
                        <span class="s2">if </span><span class="s1">(!_iteratorNormalCompletion &amp;&amp; _iterator.return != </span><span class="s2">null</span><span class="s1">) {</span>
                            <span class="s1">_iterator.return();</span>
                        <span class="s1">}</span>
                    <span class="s1">} </span><span class="s2">finally</span><span class="s1">{</span>
                        <span class="s2">if </span><span class="s1">(_didIteratorError) {</span>
                            <span class="s2">throw </span><span class="s1">_iteratorError;</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
<span class="s1">});</span>
</pre>
</body>
</html>