<html>
<head>
<title>get-font-axes.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #8c8c8c; font-style: italic;}
.s4 { color: #1750eb;}
.s5 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
get-font-axes.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, { value: </span><span class="s2">true </span><span class="s1">});</span>
<span class="s1">exports.getFontAxes = getFontAxes;</span>
<span class="s2">const </span><span class="s1">format_available_values_1 = require(</span><span class="s0">&quot;../format-available-values&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">next_font_error_1 = require(</span><span class="s0">&quot;../next-font-error&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">google_fonts_metadata_1 = require(</span><span class="s0">&quot;./google-fonts-metadata&quot;</span><span class="s1">);</span>
<span class="s3">/**</span>
 <span class="s3">* Validates and gets the data for each font axis required to generate the Google Fonts URL.</span>
 <span class="s3">*/</span>
<span class="s2">function </span><span class="s1">getFontAxes(fontFamily, weights, styles, selectedVariableAxes) {</span>
    <span class="s2">const </span><span class="s1">hasItalic = styles.includes(</span><span class="s0">'italic'</span><span class="s1">);</span>
    <span class="s2">const </span><span class="s1">hasNormal = styles.includes(</span><span class="s0">'normal'</span><span class="s1">);</span>
    <span class="s3">// Make sure the order is correct, otherwise Google Fonts will return an error</span>
    <span class="s3">// If only normal is set, we can skip returning the ital axis as normal is the default</span>
    <span class="s2">const </span><span class="s1">ital = hasItalic ? [...(hasNormal ? [</span><span class="s0">'0'</span><span class="s1">] : []), </span><span class="s0">'1'</span><span class="s1">] : undefined;</span>
    <span class="s3">// Weights will always contain one element if it's a variable font</span>
    <span class="s2">if </span><span class="s1">(weights[</span><span class="s4">0</span><span class="s1">] === </span><span class="s0">'variable'</span><span class="s1">) {</span>
        <span class="s3">// Get all the available axes for the current font from the metadata file</span>
        <span class="s2">const </span><span class="s1">allAxes = google_fonts_metadata_1.googleFontsMetadata[fontFamily].axes;</span>
        <span class="s2">if </span><span class="s1">(!allAxes) {</span>
            <span class="s2">throw new </span><span class="s1">Error(</span><span class="s0">'invariant variable font without axes'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s2">if </span><span class="s1">(selectedVariableAxes) {</span>
            <span class="s3">// The axes other than weight and style that can be defined for the current variable font</span>
            <span class="s2">const </span><span class="s1">defineAbleAxes = allAxes</span>
                <span class="s1">.map(({ tag }) =&gt; tag)</span>
                <span class="s1">.filter((tag) =&gt; tag !== </span><span class="s0">'wght'</span><span class="s1">);</span>
            <span class="s2">if </span><span class="s1">(defineAbleAxes.length === </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s1">(</span><span class="s4">0</span><span class="s1">, next_font_error_1.nextFontError)(</span><span class="s0">`Font </span><span class="s5">\`</span><span class="s1">${fontFamily}</span><span class="s5">\` </span><span class="s0">has no definable </span><span class="s5">\`</span><span class="s0">axes</span><span class="s5">\`</span><span class="s0">`</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s2">if </span><span class="s1">(!Array.isArray(selectedVariableAxes)) {</span>
                <span class="s1">(</span><span class="s4">0</span><span class="s1">, next_font_error_1.nextFontError)(</span><span class="s0">`Invalid axes value for font </span><span class="s5">\`</span><span class="s1">${fontFamily}</span><span class="s5">\`</span><span class="s0">, expected an array of axes.</span><span class="s5">\n</span><span class="s0">Available axes: </span><span class="s1">${(</span><span class="s4">0</span><span class="s1">, format_available_values_1.formatAvailableValues)(defineAbleAxes)}</span><span class="s0">`</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s1">selectedVariableAxes.forEach((key) =&gt; {</span>
                <span class="s2">if </span><span class="s1">(!defineAbleAxes.some((tag) =&gt; tag === key)) {</span>
                    <span class="s1">(</span><span class="s4">0</span><span class="s1">, next_font_error_1.nextFontError)(</span><span class="s0">`Invalid axes value </span><span class="s5">\`</span><span class="s1">${key}</span><span class="s5">\` </span><span class="s0">for font </span><span class="s5">\`</span><span class="s1">${fontFamily}</span><span class="s5">\`</span><span class="s0">.</span><span class="s5">\n</span><span class="s0">Available axes: </span><span class="s1">${(</span><span class="s4">0</span><span class="s1">, format_available_values_1.formatAvailableValues)(defineAbleAxes)}</span><span class="s0">`</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s2">let </span><span class="s1">weightAxis;</span>
        <span class="s2">let </span><span class="s1">variableAxes;</span>
        <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">{ tag, min, max } of allAxes) {</span>
            <span class="s2">if </span><span class="s1">(tag === </span><span class="s0">'wght'</span><span class="s1">) {</span>
                <span class="s3">// In variable fonts the weight is a range</span>
                <span class="s1">weightAxis = </span><span class="s0">`</span><span class="s1">${min}</span><span class="s0">..</span><span class="s1">${max}</span><span class="s0">`</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s2">else if </span><span class="s1">(selectedVariableAxes === </span><span class="s2">null </span><span class="s1">|| selectedVariableAxes === </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">? </span><span class="s2">void </span><span class="s4">0 </span><span class="s1">: selectedVariableAxes.includes(tag)) {</span>
                <span class="s2">if </span><span class="s1">(!variableAxes) {</span>
                    <span class="s1">variableAxes = [];</span>
                <span class="s1">}</span>
                <span class="s1">variableAxes.push([tag, </span><span class="s0">`</span><span class="s1">${min}</span><span class="s0">..</span><span class="s1">${max}</span><span class="s0">`</span><span class="s1">]);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s2">return </span><span class="s1">{</span>
            <span class="s1">wght: weightAxis ? [weightAxis] : undefined,</span>
            <span class="s1">ital,</span>
            <span class="s1">variableAxes,</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
    <span class="s2">else </span><span class="s1">{</span>
        <span class="s2">return </span><span class="s1">{</span>
            <span class="s1">ital,</span>
            <span class="s1">wght: weights,</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
<span class="s1">}</span>
</pre>
</body>
</html>