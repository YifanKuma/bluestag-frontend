<html>
<head>
<title>middleware-plugin.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
middleware-plugin.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/build/webpack/plugins/middleware-plugin.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type {</span><span class="s3">\n  </span><span class="s1">AssetBinding,</span><span class="s3">\n  </span><span class="s1">EdgeMiddlewareMeta,</span><span class="s3">\n</span><span class="s1">} from '../loaders/get-module-build-info'</span><span class="s3">\n</span><span class="s1">import type { EdgeSSRMeta } from '../loaders/get-module-build-info'</span><span class="s3">\n</span><span class="s1">import type { MiddlewareMatcher } from '../../analysis/get-page-static-info'</span><span class="s3">\n</span><span class="s1">import { getNamedMiddlewareRegex } from '../../../shared/lib/router/utils/route-regex'</span><span class="s3">\n</span><span class="s1">import { getModuleBuildInfo } from '../loaders/get-module-build-info'</span><span class="s3">\n</span><span class="s1">import { getSortedRoutes } from '../../../shared/lib/router/utils'</span><span class="s3">\n</span><span class="s1">import { webpack, sources } from 'next/dist/compiled/webpack/webpack'</span><span class="s3">\n</span><span class="s1">import picomatch from 'next/dist/compiled/picomatch'</span><span class="s3">\n</span><span class="s1">import path from 'path'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">EDGE_RUNTIME_WEBPACK,</span><span class="s3">\n  </span><span class="s1">EDGE_UNSUPPORTED_NODE_APIS,</span><span class="s3">\n  </span><span class="s1">MIDDLEWARE_BUILD_MANIFEST,</span><span class="s3">\n  </span><span class="s1">CLIENT_REFERENCE_MANIFEST,</span><span class="s3">\n  </span><span class="s1">MIDDLEWARE_MANIFEST,</span><span class="s3">\n  </span><span class="s1">MIDDLEWARE_REACT_LOADABLE_MANIFEST,</span><span class="s3">\n  </span><span class="s1">SUBRESOURCE_INTEGRITY_MANIFEST,</span><span class="s3">\n  </span><span class="s1">NEXT_FONT_MANIFEST,</span><span class="s3">\n  </span><span class="s1">SERVER_REFERENCE_MANIFEST,</span><span class="s3">\n  </span><span class="s1">INTERCEPTION_ROUTE_REWRITE_MANIFEST,</span><span class="s3">\n  </span><span class="s1">DYNAMIC_CSS_MANIFEST,</span><span class="s3">\n</span><span class="s1">} from '../../../shared/lib/constants'</span><span class="s3">\n</span><span class="s1">import type { MiddlewareConfig } from '../../analysis/get-page-static-info'</span><span class="s3">\n</span><span class="s1">import type { Telemetry } from '../../../telemetry/storage'</span><span class="s3">\n</span><span class="s1">import { traceGlobals } from '../../../trace/shared'</span><span class="s3">\n</span><span class="s1">import { EVENT_BUILD_FEATURE_USAGE } from '../../../telemetry/events'</span><span class="s3">\n</span><span class="s1">import { normalizeAppPath } from '../../../shared/lib/router/utils/app-paths'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">INSTRUMENTATION_HOOK_FILENAME,</span><span class="s3">\n  </span><span class="s1">WEBPACK_LAYERS,</span><span class="s3">\n</span><span class="s1">} from '../../../lib/constants'</span><span class="s3">\n</span><span class="s1">import type { CustomRoutes } from '../../../lib/load-custom-routes'</span><span class="s3">\n</span><span class="s1">import { isInterceptionRouteRewrite } from '../../../lib/generate-interception-routes-rewrites'</span><span class="s3">\n</span><span class="s1">import { getDynamicCodeEvaluationError } from './wellknown-errors-plugin/parse-dynamic-code-evaluation-error'</span><span class="s3">\n</span><span class="s1">import { getModuleReferencesInOrder } from '../utils'</span><span class="s3">\n\n</span><span class="s1">const KNOWN_SAFE_DYNAMIC_PACKAGES =</span><span class="s3">\n  </span><span class="s1">require('../../../lib/known-edge-safe-packages.json') as string[]</span><span class="s3">\n\n</span><span class="s1">export interface EdgeFunctionDefinition {</span><span class="s3">\n  </span><span class="s1">files: string[]</span><span class="s3">\n  </span><span class="s1">name: string</span><span class="s3">\n  </span><span class="s1">page: string</span><span class="s3">\n  </span><span class="s1">matchers: MiddlewareMatcher[]</span><span class="s3">\n  </span><span class="s1">env: Record&lt;string, string&gt;</span><span class="s3">\n  </span><span class="s1">wasm?: AssetBinding[]</span><span class="s3">\n  </span><span class="s1">assets?: AssetBinding[]</span><span class="s3">\n  </span><span class="s1">regions?: string[] | string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface MiddlewareManifest {</span><span class="s3">\n  </span><span class="s1">version: 3</span><span class="s3">\n  </span><span class="s1">sortedMiddleware: string[]</span><span class="s3">\n  </span><span class="s1">middleware: { [page: string]: EdgeFunctionDefinition }</span><span class="s3">\n  </span><span class="s1">functions: { [page: string]: EdgeFunctionDefinition }</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface EntryMetadata {</span><span class="s3">\n  </span><span class="s1">edgeMiddleware?: EdgeMiddlewareMeta</span><span class="s3">\n  </span><span class="s1">edgeApiFunction?: EdgeMiddlewareMeta</span><span class="s3">\n  </span><span class="s1">edgeSSR?: EdgeSSRMeta</span><span class="s3">\n  </span><span class="s1">wasmBindings: Map&lt;string, string&gt;</span><span class="s3">\n  </span><span class="s1">assetBindings: Map&lt;string, string&gt;</span><span class="s3">\n  </span><span class="s1">regions?: string[] | string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const NAME = 'MiddlewarePlugin'</span><span class="s3">\n</span><span class="s1">const MANIFEST_VERSION = 3</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Checks the value of usingIndirectEval and when it is a set of modules it</span><span class="s3">\n </span><span class="s1">* check if any of the modules is actually being used. If the value is</span><span class="s3">\n </span><span class="s1">* simply truthy it will return true.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function isUsingIndirectEvalAndUsedByExports(args: {</span><span class="s3">\n  </span><span class="s1">module: webpack.Module</span><span class="s3">\n  </span><span class="s1">moduleGraph: webpack.ModuleGraph</span><span class="s3">\n  </span><span class="s1">runtime: any</span><span class="s3">\n  </span><span class="s1">usingIndirectEval: true | Set&lt;string&gt;</span><span class="s3">\n  </span><span class="s1">wp: typeof webpack</span><span class="s3">\n</span><span class="s1">}): boolean {</span><span class="s3">\n  </span><span class="s1">const { moduleGraph, runtime, module, usingIndirectEval, wp } = args</span><span class="s3">\n  </span><span class="s1">if (typeof usingIndirectEval === 'boolean') {</span><span class="s3">\n    </span><span class="s1">return usingIndirectEval</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const exportsInfo = moduleGraph.getExportsInfo(module)</span><span class="s3">\n  </span><span class="s1">for (const exportName of usingIndirectEval) {</span><span class="s3">\n    </span><span class="s1">if (exportsInfo.getUsed(exportName, runtime) !== wp.UsageState.Unused) {</span><span class="s3">\n      </span><span class="s1">return true</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getEntryFiles(</span><span class="s3">\n  </span><span class="s1">entryFiles: string[],</span><span class="s3">\n  </span><span class="s1">meta: EntryMetadata,</span><span class="s3">\n  </span><span class="s1">hasInstrumentationHook: boolean,</span><span class="s3">\n  </span><span class="s1">opts: Options</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const files: string[] = []</span><span class="s3">\n  </span><span class="s1">if (meta.edgeSSR) {</span><span class="s3">\n    </span><span class="s1">if (meta.edgeSSR.isServerComponent) {</span><span class="s3">\n      </span><span class="s1">files.push(`server/${SERVER_REFERENCE_MANIFEST}.js`)</span><span class="s3">\n      </span><span class="s1">if (opts.sriEnabled) {</span><span class="s3">\n        </span><span class="s1">files.push(`server/${SUBRESOURCE_INTEGRITY_MANIFEST}.js`)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">files.push(</span><span class="s3">\n        </span><span class="s1">...entryFiles</span><span class="s3">\n          </span><span class="s1">.filter(</span><span class="s3">\n            </span><span class="s1">(file) =&gt;</span><span class="s3">\n              </span><span class="s1">file.startsWith('app/') &amp;&amp; !file.endsWith('.hot-update.js')</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">.map(</span><span class="s3">\n            </span><span class="s1">(file) =&gt;</span><span class="s3">\n              </span><span class="s1">'server/' +</span><span class="s3">\n              </span><span class="s1">file.replace(/</span><span class="s3">\\</span><span class="s1">.js$/, '_' + CLIENT_REFERENCE_MANIFEST + '.js')</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">if (!opts.dev &amp;&amp; !meta.edgeSSR.isAppDir) {</span><span class="s3">\n      </span><span class="s1">files.push(`server/${DYNAMIC_CSS_MANIFEST}.js`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">files.push(</span><span class="s3">\n      </span><span class="s1">`server/${MIDDLEWARE_BUILD_MANIFEST}.js`,</span><span class="s3">\n      </span><span class="s1">`server/${MIDDLEWARE_REACT_LOADABLE_MANIFEST}.js`,</span><span class="s3">\n      </span><span class="s1">`server/${NEXT_FONT_MANIFEST}.js`,</span><span class="s3">\n      </span><span class="s1">`server/${INTERCEPTION_ROUTE_REWRITE_MANIFEST}.js`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (hasInstrumentationHook) {</span><span class="s3">\n    </span><span class="s1">files.push(`server/edge-${INSTRUMENTATION_HOOK_FILENAME}.js`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">files.push(</span><span class="s3">\n    </span><span class="s1">...entryFiles</span><span class="s3">\n      </span><span class="s1">.filter((file) =&gt; !file.endsWith('.hot-update.js'))</span><span class="s3">\n      </span><span class="s1">.map((file) =&gt; 'server/' + file)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">return files</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getCreateAssets(params: {</span><span class="s3">\n  </span><span class="s1">compilation: webpack.Compilation</span><span class="s3">\n  </span><span class="s1">metadataByEntry: Map&lt;string, EntryMetadata&gt;</span><span class="s3">\n  </span><span class="s1">opts: Options</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">const { compilation, metadataByEntry, opts } = params</span><span class="s3">\n  </span><span class="s1">return () =&gt; {</span><span class="s3">\n    </span><span class="s1">const middlewareManifest: MiddlewareManifest = {</span><span class="s3">\n      </span><span class="s1">version: MANIFEST_VERSION,</span><span class="s3">\n      </span><span class="s1">middleware: {},</span><span class="s3">\n      </span><span class="s1">functions: {},</span><span class="s3">\n      </span><span class="s1">sortedMiddleware: [],</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const hasInstrumentationHook = compilation.entrypoints.has(</span><span class="s3">\n      </span><span class="s1">INSTRUMENTATION_HOOK_FILENAME</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">// we only emit this entry for the edge runtime since it doesn't have access to a routes manifest</span><span class="s3">\n    </span><span class="s1">// and we don't need to provide the entire route manifest, just the interception routes.</span><span class="s3">\n    </span><span class="s1">const interceptionRewrites = JSON.stringify(</span><span class="s3">\n      </span><span class="s1">opts.rewrites.beforeFiles.filter(isInterceptionRouteRewrite)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">compilation.emitAsset(</span><span class="s3">\n      </span><span class="s1">`${INTERCEPTION_ROUTE_REWRITE_MANIFEST}.js`,</span><span class="s3">\n      </span><span class="s1">new sources.RawSource(</span><span class="s3">\n        </span><span class="s1">`self.__INTERCEPTION_ROUTE_REWRITE_MANIFEST=${JSON.stringify(</span><span class="s3">\n          </span><span class="s1">interceptionRewrites</span><span class="s3">\n        </span><span class="s1">)}`</span><span class="s3">\n      </span><span class="s1">) as unknown as webpack.sources.RawSource</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">for (const entrypoint of compilation.entrypoints.values()) {</span><span class="s3">\n      </span><span class="s1">if (!entrypoint.name) {</span><span class="s3">\n        </span><span class="s1">continue</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// There should always be metadata for the entrypoint.</span><span class="s3">\n      </span><span class="s1">const metadata = metadataByEntry.get(entrypoint.name)</span><span class="s3">\n      </span><span class="s1">const page =</span><span class="s3">\n        </span><span class="s1">metadata?.edgeMiddleware?.page ||</span><span class="s3">\n        </span><span class="s1">metadata?.edgeSSR?.page ||</span><span class="s3">\n        </span><span class="s1">metadata?.edgeApiFunction?.page</span><span class="s3">\n      </span><span class="s1">if (!page) {</span><span class="s3">\n        </span><span class="s1">continue</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const matcherSource = metadata.edgeSSR?.isAppDir</span><span class="s3">\n        </span><span class="s1">? normalizeAppPath(page)</span><span class="s3">\n        </span><span class="s1">: page</span><span class="s3">\n\n      </span><span class="s1">const catchAll = !metadata.edgeSSR &amp;&amp; !metadata.edgeApiFunction</span><span class="s3">\n\n      </span><span class="s1">const { namedRegex } = getNamedMiddlewareRegex(matcherSource, {</span><span class="s3">\n        </span><span class="s1">catchAll,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">const matchers = metadata?.edgeMiddleware?.matchers ?? [</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">regexp: namedRegex,</span><span class="s3">\n          </span><span class="s1">originalSource: page === '/' &amp;&amp; catchAll ? '/:path*' : matcherSource,</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">]</span><span class="s3">\n\n      </span><span class="s1">const isEdgeFunction = !!(metadata.edgeApiFunction || metadata.edgeSSR)</span><span class="s3">\n      </span><span class="s1">const edgeFunctionDefinition: EdgeFunctionDefinition = {</span><span class="s3">\n        </span><span class="s1">files: getEntryFiles(</span><span class="s3">\n          </span><span class="s1">entrypoint.getFiles(),</span><span class="s3">\n          </span><span class="s1">metadata,</span><span class="s3">\n          </span><span class="s1">hasInstrumentationHook,</span><span class="s3">\n          </span><span class="s1">opts</span><span class="s3">\n        </span><span class="s1">),</span><span class="s3">\n        </span><span class="s1">name: entrypoint.name,</span><span class="s3">\n        </span><span class="s1">page: page,</span><span class="s3">\n        </span><span class="s1">matchers,</span><span class="s3">\n        </span><span class="s1">wasm: Array.from(metadata.wasmBindings, ([name, filePath]) =&gt; ({</span><span class="s3">\n          </span><span class="s1">name,</span><span class="s3">\n          </span><span class="s1">filePath,</span><span class="s3">\n        </span><span class="s1">})),</span><span class="s3">\n        </span><span class="s1">assets: Array.from(metadata.assetBindings, ([name, filePath]) =&gt; ({</span><span class="s3">\n          </span><span class="s1">name,</span><span class="s3">\n          </span><span class="s1">filePath,</span><span class="s3">\n        </span><span class="s1">})),</span><span class="s3">\n        </span><span class="s1">env: opts.edgeEnvironments,</span><span class="s3">\n        </span><span class="s1">...(metadata.regions &amp;&amp; { regions: metadata.regions }),</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (isEdgeFunction) {</span><span class="s3">\n        </span><span class="s1">middlewareManifest.functions[page] = edgeFunctionDefinition</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">middlewareManifest.middleware[page] = edgeFunctionDefinition</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">middlewareManifest.sortedMiddleware = getSortedRoutes(</span><span class="s3">\n      </span><span class="s1">Object.keys(middlewareManifest.middleware)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">compilation.emitAsset(</span><span class="s3">\n      </span><span class="s1">MIDDLEWARE_MANIFEST,</span><span class="s3">\n      </span><span class="s1">new sources.RawSource(</span><span class="s3">\n        </span><span class="s1">JSON.stringify(middlewareManifest, null, 2)</span><span class="s3">\n      </span><span class="s1">) as unknown as webpack.sources.RawSource</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function buildWebpackError({</span><span class="s3">\n  </span><span class="s1">message,</span><span class="s3">\n  </span><span class="s1">loc,</span><span class="s3">\n  </span><span class="s1">compilation,</span><span class="s3">\n  </span><span class="s1">entryModule,</span><span class="s3">\n  </span><span class="s1">parser,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">message: string</span><span class="s3">\n  </span><span class="s1">loc?: any</span><span class="s3">\n  </span><span class="s1">compilation: webpack.Compilation</span><span class="s3">\n  </span><span class="s1">entryModule?: webpack.Module</span><span class="s3">\n  </span><span class="s1">parser?: webpack.javascript.JavascriptParser</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">const error = new compilation.compiler.webpack.WebpackError(message)</span><span class="s3">\n  </span><span class="s1">error.name = NAME</span><span class="s3">\n  </span><span class="s1">const module = entryModule ?? parser?.state.current</span><span class="s3">\n  </span><span class="s1">if (module) {</span><span class="s3">\n    </span><span class="s1">error.module = module</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">error.loc = loc</span><span class="s3">\n  </span><span class="s1">return error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function isInMiddlewareLayer(parser: webpack.javascript.JavascriptParser) {</span><span class="s3">\n  </span><span class="s1">const layer = parser.state.module?.layer</span><span class="s3">\n  </span><span class="s1">return layer === WEBPACK_LAYERS.middleware || layer === WEBPACK_LAYERS.apiEdge</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function isNodeJsModule(moduleName: string) {</span><span class="s3">\n  </span><span class="s1">return (require('module') as typeof import('module')).builtinModules.includes(</span><span class="s3">\n    </span><span class="s1">moduleName</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function isBunModule(moduleName: string) {</span><span class="s3">\n  </span><span class="s1">return moduleName === 'bun' || moduleName.startsWith('bun:')</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function isDynamicCodeEvaluationAllowed(</span><span class="s3">\n  </span><span class="s1">fileName: string,</span><span class="s3">\n  </span><span class="s1">middlewareConfig?: MiddlewareConfig,</span><span class="s3">\n  </span><span class="s1">rootDir?: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">// Some packages are known to use `eval` but are safe to use in the Edge</span><span class="s3">\n  </span><span class="s1">// Runtime because the dynamic code will never be executed.</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">KNOWN_SAFE_DYNAMIC_PACKAGES.some((pkg) =&gt;</span><span class="s3">\n      </span><span class="s1">fileName.includes(`/node_modules/${pkg}/`.replace(/</span><span class="s3">\\</span><span class="s1">//g, path.sep))</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const name = fileName.replace(rootDir ?? '', '')</span><span class="s3">\n\n  </span><span class="s1">return picomatch(middlewareConfig?.unstable_allowDynamic ?? [], {</span><span class="s3">\n    </span><span class="s1">dot: true,</span><span class="s3">\n  </span><span class="s1">})(name)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function buildUnsupportedApiError({</span><span class="s3">\n  </span><span class="s1">apiName,</span><span class="s3">\n  </span><span class="s1">loc,</span><span class="s3">\n  </span><span class="s1">...rest</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">apiName: string</span><span class="s3">\n  </span><span class="s1">loc: any</span><span class="s3">\n  </span><span class="s1">compilation: webpack.Compilation</span><span class="s3">\n  </span><span class="s1">parser: webpack.javascript.JavascriptParser</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">return buildWebpackError({</span><span class="s3">\n    </span><span class="s1">message: `A Node.js API is used (${apiName} at line: ${loc.start.line}) which is not supported in the Edge Runtime.</span><span class="s3">\n</span><span class="s1">Learn more: https://nextjs.org/docs/api-reference/edge-runtime`,</span><span class="s3">\n    </span><span class="s1">loc,</span><span class="s3">\n    </span><span class="s1">...rest,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function registerUnsupportedApiHooks(</span><span class="s3">\n  </span><span class="s1">parser: webpack.javascript.JavascriptParser,</span><span class="s3">\n  </span><span class="s1">compilation: webpack.Compilation</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">for (const expression of EDGE_UNSUPPORTED_NODE_APIS) {</span><span class="s3">\n    </span><span class="s1">const warnForUnsupportedApi = (node: any) =&gt; {</span><span class="s3">\n      </span><span class="s1">if (!isInMiddlewareLayer(parser)) {</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">compilation.warnings.push(</span><span class="s3">\n        </span><span class="s1">buildUnsupportedApiError({</span><span class="s3">\n          </span><span class="s1">compilation,</span><span class="s3">\n          </span><span class="s1">parser,</span><span class="s3">\n          </span><span class="s1">apiName: expression,</span><span class="s3">\n          </span><span class="s1">...node,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">return true</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">parser.hooks.call.for(expression).tap(NAME, warnForUnsupportedApi)</span><span class="s3">\n    </span><span class="s1">parser.hooks.expression.for(expression).tap(NAME, warnForUnsupportedApi)</span><span class="s3">\n    </span><span class="s1">parser.hooks.callMemberChain</span><span class="s3">\n      </span><span class="s1">.for(expression)</span><span class="s3">\n      </span><span class="s1">.tap(NAME, warnForUnsupportedApi)</span><span class="s3">\n    </span><span class="s1">parser.hooks.expressionMemberChain</span><span class="s3">\n      </span><span class="s1">.for(expression)</span><span class="s3">\n      </span><span class="s1">.tap(NAME, warnForUnsupportedApi)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const warnForUnsupportedProcessApi = (node: any, [callee]: string[]) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (!isInMiddlewareLayer(parser) || callee === 'env') {</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">compilation.warnings.push(</span><span class="s3">\n      </span><span class="s1">buildUnsupportedApiError({</span><span class="s3">\n        </span><span class="s1">compilation,</span><span class="s3">\n        </span><span class="s1">parser,</span><span class="s3">\n        </span><span class="s1">apiName: `process.${callee}`,</span><span class="s3">\n        </span><span class="s1">...node,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">parser.hooks.callMemberChain</span><span class="s3">\n    </span><span class="s1">.for('process')</span><span class="s3">\n    </span><span class="s1">.tap(NAME, warnForUnsupportedProcessApi)</span><span class="s3">\n  </span><span class="s1">parser.hooks.expressionMemberChain</span><span class="s3">\n    </span><span class="s1">.for('process')</span><span class="s3">\n    </span><span class="s1">.tap(NAME, warnForUnsupportedProcessApi)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getCodeAnalyzer(params: {</span><span class="s3">\n  </span><span class="s1">dev: boolean</span><span class="s3">\n  </span><span class="s1">compiler: webpack.Compiler</span><span class="s3">\n  </span><span class="s1">compilation: webpack.Compilation</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">return (parser: webpack.javascript.JavascriptParser) =&gt; {</span><span class="s3">\n    </span><span class="s1">const {</span><span class="s3">\n      </span><span class="s1">dev,</span><span class="s3">\n      </span><span class="s1">compiler: { webpack: wp },</span><span class="s3">\n      </span><span class="s1">compilation,</span><span class="s3">\n    </span><span class="s1">} = params</span><span class="s3">\n    </span><span class="s1">const { hooks } = parser</span><span class="s3">\n\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* For an expression this will check the graph to ensure it is being used</span><span class="s3">\n     </span><span class="s1">* by exports. Then it will store in the module buildInfo a boolean to</span><span class="s3">\n     </span><span class="s1">* express that it contains dynamic code and, if it is available, the</span><span class="s3">\n     </span><span class="s1">* module path that is using it.</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">const handleExpression = () =&gt; {</span><span class="s3">\n      </span><span class="s1">if (!isInMiddlewareLayer(parser)) {</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">wp.optimize.InnerGraph.onUsage(parser.state, (used = true) =&gt; {</span><span class="s3">\n        </span><span class="s1">const buildInfo = getModuleBuildInfo(parser.state.module)</span><span class="s3">\n        </span><span class="s1">if (buildInfo.usingIndirectEval === true || used === false) {</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (!buildInfo.usingIndirectEval || used === true) {</span><span class="s3">\n          </span><span class="s1">buildInfo.usingIndirectEval = used</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">buildInfo.usingIndirectEval = new Set([</span><span class="s3">\n          </span><span class="s1">...Array.from(buildInfo.usingIndirectEval),</span><span class="s3">\n          </span><span class="s1">...Array.from(used),</span><span class="s3">\n        </span><span class="s1">])</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* This expression handler allows to wrap a dynamic code expression with a</span><span class="s3">\n     </span><span class="s1">* function call where we can warn about dynamic code not being allowed</span><span class="s3">\n     </span><span class="s1">* but actually execute the expression.</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">const handleWrapExpression = (expr: any) =&gt; {</span><span class="s3">\n      </span><span class="s1">if (!isInMiddlewareLayer(parser)) {</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const { ConstDependency } = wp.dependencies</span><span class="s3">\n      </span><span class="s1">const dep1 = new ConstDependency(</span><span class="s3">\n        </span><span class="s1">'__next_eval__(function() { return ',</span><span class="s3">\n        </span><span class="s1">expr.range[0]</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">dep1.loc = expr.loc</span><span class="s3">\n      </span><span class="s1">parser.state.module.addPresentationalDependency(dep1)</span><span class="s3">\n      </span><span class="s1">const dep2 = new ConstDependency('})', expr.range[1])</span><span class="s3">\n      </span><span class="s1">dep2.loc = expr.loc</span><span class="s3">\n      </span><span class="s1">parser.state.module.addPresentationalDependency(dep2)</span><span class="s3">\n\n      </span><span class="s1">handleExpression()</span><span class="s3">\n      </span><span class="s1">return true</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* This expression handler allows to wrap a WebAssembly.compile invocation with a</span><span class="s3">\n     </span><span class="s1">* function call where we can warn about WASM code generation not being allowed</span><span class="s3">\n     </span><span class="s1">* but actually execute the expression.</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">const handleWrapWasmCompileExpression = (expr: any) =&gt; {</span><span class="s3">\n      </span><span class="s1">if (!isInMiddlewareLayer(parser)) {</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const { ConstDependency } = wp.dependencies</span><span class="s3">\n      </span><span class="s1">const dep1 = new ConstDependency(</span><span class="s3">\n        </span><span class="s1">'__next_webassembly_compile__(function() { return ',</span><span class="s3">\n        </span><span class="s1">expr.range[0]</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">dep1.loc = expr.loc</span><span class="s3">\n      </span><span class="s1">parser.state.module.addPresentationalDependency(dep1)</span><span class="s3">\n      </span><span class="s1">const dep2 = new ConstDependency('})', expr.range[1])</span><span class="s3">\n      </span><span class="s1">dep2.loc = expr.loc</span><span class="s3">\n      </span><span class="s1">parser.state.module.addPresentationalDependency(dep2)</span><span class="s3">\n\n      </span><span class="s1">handleExpression()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* This expression handler allows to wrap a WebAssembly.instatiate invocation with a</span><span class="s3">\n     </span><span class="s1">* function call where we can warn about WASM code generation not being allowed</span><span class="s3">\n     </span><span class="s1">* but actually execute the expression.</span><span class="s3">\n     </span><span class="s1">*</span><span class="s3">\n     </span><span class="s1">* Note that we don't update `usingIndirectEval`, i.e. we don't abort a production build</span><span class="s3">\n     </span><span class="s1">* since we can't determine statically if the first parameter is a module (legit use) or</span><span class="s3">\n     </span><span class="s1">* a buffer (dynamic code generation).</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">const handleWrapWasmInstantiateExpression = (expr: any) =&gt; {</span><span class="s3">\n      </span><span class="s1">if (!isInMiddlewareLayer(parser)) {</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (dev) {</span><span class="s3">\n        </span><span class="s1">const { ConstDependency } = wp.dependencies</span><span class="s3">\n        </span><span class="s1">const dep1 = new ConstDependency(</span><span class="s3">\n          </span><span class="s1">'__next_webassembly_instantiate__(function() { return ',</span><span class="s3">\n          </span><span class="s1">expr.range[0]</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">dep1.loc = expr.loc</span><span class="s3">\n        </span><span class="s1">parser.state.module.addPresentationalDependency(dep1)</span><span class="s3">\n        </span><span class="s1">const dep2 = new ConstDependency('})', expr.range[1])</span><span class="s3">\n        </span><span class="s1">dep2.loc = expr.loc</span><span class="s3">\n        </span><span class="s1">parser.state.module.addPresentationalDependency(dep2)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* Handler to store original source location of static and dynamic imports into module's buildInfo.</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">const handleImport = (node: any) =&gt; {</span><span class="s3">\n      </span><span class="s1">if (isInMiddlewareLayer(parser) &amp;&amp; node.source?.value &amp;&amp; node?.loc) {</span><span class="s3">\n        </span><span class="s1">const { module, source } = parser.state</span><span class="s3">\n        </span><span class="s1">const buildInfo = getModuleBuildInfo(module)</span><span class="s3">\n        </span><span class="s1">if (!buildInfo.importLocByPath) {</span><span class="s3">\n          </span><span class="s1">buildInfo.importLocByPath = new Map()</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const importedModule = node.source.value?.toString()</span><span class="s3">\n        </span><span class="s1">buildInfo.importLocByPath.set(importedModule, {</span><span class="s3">\n          </span><span class="s1">sourcePosition: {</span><span class="s3">\n            </span><span class="s1">...node.loc.start,</span><span class="s3">\n            </span><span class="s1">source: module.identifier(),</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">sourceContent: source.toString(),</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">!dev &amp;&amp;</span><span class="s3">\n          </span><span class="s1">(isNodeJsModule(importedModule) || isBunModule(importedModule)) &amp;&amp;</span><span class="s3">\n          </span><span class="s1">!SUPPORTED_NATIVE_MODULES.includes(importedModule)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">const isBun = isBunModule(importedModule)</span><span class="s3">\n          </span><span class="s1">compilation.warnings.push(</span><span class="s3">\n            </span><span class="s1">buildWebpackError({</span><span class="s3">\n              </span><span class="s1">message: `A ${isBun ? 'Bun' : 'Node.js'} module is loaded ('${importedModule}' at line ${node.loc.start.line}) which is not supported in the Edge Runtime.</span><span class="s3">\n</span><span class="s1">Learn More: https://nextjs.org/docs/messages/node-module-in-edge-runtime`,</span><span class="s3">\n              </span><span class="s1">compilation,</span><span class="s3">\n              </span><span class="s1">parser,</span><span class="s3">\n              </span><span class="s1">...node,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* A noop handler to skip analyzing some cases.</span><span class="s3">\n     </span><span class="s1">* Order matters: for it to work, it must be registered first</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">const skip = () =&gt; (isInMiddlewareLayer(parser) ? true : undefined)</span><span class="s3">\n\n    </span><span class="s1">for (const prefix of ['', 'global.']) {</span><span class="s3">\n      </span><span class="s1">hooks.expression.for(`${prefix}Function.prototype`).tap(NAME, skip)</span><span class="s3">\n      </span><span class="s1">hooks.expression.for(`${prefix}Function.bind`).tap(NAME, skip)</span><span class="s3">\n      </span><span class="s1">hooks.call.for(`${prefix}eval`).tap(NAME, handleWrapExpression)</span><span class="s3">\n      </span><span class="s1">hooks.call.for(`${prefix}Function`).tap(NAME, handleWrapExpression)</span><span class="s3">\n      </span><span class="s1">hooks.new.for(`${prefix}Function`).tap(NAME, handleWrapExpression)</span><span class="s3">\n      </span><span class="s1">hooks.call</span><span class="s3">\n        </span><span class="s1">.for(`${prefix}WebAssembly.compile`)</span><span class="s3">\n        </span><span class="s1">.tap(NAME, handleWrapWasmCompileExpression)</span><span class="s3">\n      </span><span class="s1">hooks.call</span><span class="s3">\n        </span><span class="s1">.for(`${prefix}WebAssembly.instantiate`)</span><span class="s3">\n        </span><span class="s1">.tap(NAME, handleWrapWasmInstantiateExpression)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">hooks.importCall.tap(NAME, handleImport)</span><span class="s3">\n    </span><span class="s1">hooks.import.tap(NAME, handleImport)</span><span class="s3">\n\n    </span><span class="s1">if (!dev) {</span><span class="s3">\n      </span><span class="s1">// do not issue compilation warning on dev: invoking code will provide details</span><span class="s3">\n      </span><span class="s1">registerUnsupportedApiHooks(parser, compilation)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">async function codeAnalyzerBySwc(</span><span class="s3">\n  </span><span class="s1">compilation: webpack.Compilation,</span><span class="s3">\n  </span><span class="s1">modules: Iterable&lt;webpack.Module&gt;,</span><span class="s3">\n  </span><span class="s1">dev: boolean</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const binding = require('../../swc') as typeof import('../../swc')</span><span class="s3">\n  </span><span class="s1">for (const module of modules) {</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">module.layer !== WEBPACK_LAYERS.middleware &amp;&amp;</span><span class="s3">\n      </span><span class="s1">module.layer !== WEBPACK_LAYERS.apiEdge</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">continue</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">if (module.constructor.name !== 'NormalModule') {</span><span class="s3">\n      </span><span class="s1">continue</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const normalModule = module as webpack.NormalModule</span><span class="s3">\n    </span><span class="s1">if (!normalModule.type.startsWith('javascript')) {</span><span class="s3">\n      </span><span class="s1">// Only analyze JavaScript modules</span><span class="s3">\n      </span><span class="s1">continue</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const originalSource = normalModule.originalSource()</span><span class="s3">\n    </span><span class="s1">if (!originalSource) {</span><span class="s3">\n      </span><span class="s1">continue</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const source = originalSource.source()</span><span class="s3">\n    </span><span class="s1">if (typeof source !== 'string') {</span><span class="s3">\n      </span><span class="s1">continue</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const diagnostics = await binding.warnForEdgeRuntime(source, !dev)</span><span class="s3">\n    </span><span class="s1">for (const diagnostic of diagnostics) {</span><span class="s3">\n      </span><span class="s1">const webpackError = buildWebpackError({</span><span class="s3">\n        </span><span class="s1">message: diagnostic.message,</span><span class="s3">\n        </span><span class="s1">loc: diagnostic.loc,</span><span class="s3">\n        </span><span class="s1">compilation,</span><span class="s3">\n        </span><span class="s1">entryModule: module,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">if (diagnostic.severity === 'Warning') {</span><span class="s3">\n        </span><span class="s1">compilation.warnings.push(webpackError)</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">compilation.errors.push(webpackError)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getExtractMetadata(params: {</span><span class="s3">\n  </span><span class="s1">compilation: webpack.Compilation</span><span class="s3">\n  </span><span class="s1">compiler: webpack.Compiler</span><span class="s3">\n  </span><span class="s1">dev: boolean</span><span class="s3">\n  </span><span class="s1">metadataByEntry: Map&lt;string, EntryMetadata&gt;</span><span class="s3">\n</span><span class="s1">}): () =&gt; Promise&lt;void&gt; {</span><span class="s3">\n  </span><span class="s1">const { dev, compilation, metadataByEntry, compiler } = params</span><span class="s3">\n  </span><span class="s1">const { webpack: wp } = compiler</span><span class="s3">\n  </span><span class="s1">return async () =&gt; {</span><span class="s3">\n    </span><span class="s1">metadataByEntry.clear()</span><span class="s3">\n    </span><span class="s1">const telemetry: Telemetry | undefined = traceGlobals.get('telemetry')</span><span class="s3">\n\n    </span><span class="s1">for (const [entryName, entry] of compilation.entries) {</span><span class="s3">\n      </span><span class="s1">if (entry.options.runtime !== EDGE_RUNTIME_WEBPACK) {</span><span class="s3">\n        </span><span class="s1">// Only process edge runtime entries</span><span class="s3">\n        </span><span class="s1">continue</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">const entryDependency = entry.dependencies?.[0]</span><span class="s3">\n      </span><span class="s1">const resolvedModule =</span><span class="s3">\n        </span><span class="s1">compilation.moduleGraph.getResolvedModule(entryDependency)</span><span class="s3">\n      </span><span class="s1">if (!resolvedModule) {</span><span class="s3">\n        </span><span class="s1">continue</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">const { rootDir, route } = getModuleBuildInfo(resolvedModule)</span><span class="s3">\n\n      </span><span class="s1">const { moduleGraph } = compilation</span><span class="s3">\n      </span><span class="s1">const modules = new Set&lt;webpack.NormalModule&gt;()</span><span class="s3">\n      </span><span class="s1">const addEntriesFromDependency = (dependency: any) =&gt; {</span><span class="s3">\n        </span><span class="s1">const module = moduleGraph.getModule(dependency)</span><span class="s3">\n        </span><span class="s1">if (module) {</span><span class="s3">\n          </span><span class="s1">modules.add(module as webpack.NormalModule)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">entry.dependencies.forEach(addEntriesFromDependency)</span><span class="s3">\n      </span><span class="s1">entry.includeDependencies.forEach(addEntriesFromDependency)</span><span class="s3">\n\n      </span><span class="s1">const entryMetadata: EntryMetadata = {</span><span class="s3">\n        </span><span class="s1">wasmBindings: new Map(),</span><span class="s3">\n        </span><span class="s1">assetBindings: new Map(),</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (route?.middlewareConfig?.regions) {</span><span class="s3">\n        </span><span class="s1">entryMetadata.regions = route.middlewareConfig.regions</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (route?.preferredRegion) {</span><span class="s3">\n        </span><span class="s1">const preferredRegion = route.preferredRegion</span><span class="s3">\n        </span><span class="s1">entryMetadata.regions =</span><span class="s3">\n          </span><span class="s1">// Ensures preferredRegion is always an array in the manifest.</span><span class="s3">\n          </span><span class="s1">typeof preferredRegion === 'string'</span><span class="s3">\n            </span><span class="s1">? [preferredRegion]</span><span class="s3">\n            </span><span class="s1">: preferredRegion</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">let ogImageGenerationCount = 0</span><span class="s3">\n\n      </span><span class="s1">for (const module of modules) {</span><span class="s3">\n        </span><span class="s1">const buildInfo = getModuleBuildInfo(module)</span><span class="s3">\n\n        </span><span class="s1">/**</span><span class="s3">\n         </span><span class="s1">* Check if it uses the image generation feature.</span><span class="s3">\n         </span><span class="s1">*/</span><span class="s3">\n        </span><span class="s1">if (!dev) {</span><span class="s3">\n          </span><span class="s1">const resource = module.resource</span><span class="s3">\n          </span><span class="s1">const hasOGImageGeneration =</span><span class="s3">\n            </span><span class="s1">resource &amp;&amp;</span><span class="s3">\n            </span><span class="s1">/[</span><span class="s3">\\\\</span><span class="s1">/]node_modules[</span><span class="s3">\\\\</span><span class="s1">/]@vercel[</span><span class="s3">\\\\</span><span class="s1">/]og[</span><span class="s3">\\\\</span><span class="s1">/]dist[</span><span class="s3">\\\\</span><span class="s1">/]index</span><span class="s3">\\</span><span class="s1">.(edge|node)</span><span class="s3">\\</span><span class="s1">.js$|[</span><span class="s3">\\\\</span><span class="s1">/]next[</span><span class="s3">\\\\</span><span class="s1">/]dist[</span><span class="s3">\\\\</span><span class="s1">/](esm[</span><span class="s3">\\\\</span><span class="s1">/])?server[</span><span class="s3">\\\\</span><span class="s1">/]og[</span><span class="s3">\\\\</span><span class="s1">/]image-response</span><span class="s3">\\</span><span class="s1">.js$/.test(</span><span class="s3">\n              </span><span class="s1">resource</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n\n          </span><span class="s1">if (hasOGImageGeneration) {</span><span class="s3">\n            </span><span class="s1">ogImageGenerationCount++</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">/**</span><span class="s3">\n         </span><span class="s1">* When building for production checks if the module is using `eval`</span><span class="s3">\n         </span><span class="s1">* and in such case produces a compilation error. The module has to</span><span class="s3">\n         </span><span class="s1">* be in use.</span><span class="s3">\n         </span><span class="s1">*/</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">!dev &amp;&amp;</span><span class="s3">\n          </span><span class="s1">buildInfo.usingIndirectEval &amp;&amp;</span><span class="s3">\n          </span><span class="s1">isUsingIndirectEvalAndUsedByExports({</span><span class="s3">\n            </span><span class="s1">module,</span><span class="s3">\n            </span><span class="s1">moduleGraph,</span><span class="s3">\n            </span><span class="s1">runtime: wp.util.runtime.getEntryRuntime(compilation, entryName),</span><span class="s3">\n            </span><span class="s1">usingIndirectEval: buildInfo.usingIndirectEval,</span><span class="s3">\n            </span><span class="s1">wp,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">const id = module.identifier()</span><span class="s3">\n          </span><span class="s1">if (/node_modules[</span><span class="s3">\\\\</span><span class="s1">/]regenerator-runtime[</span><span class="s3">\\\\</span><span class="s1">/]runtime</span><span class="s3">\\</span><span class="s1">.js/.test(id)) {</span><span class="s3">\n            </span><span class="s1">continue</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">if (route?.middlewareConfig?.unstable_allowDynamic) {</span><span class="s3">\n            </span><span class="s1">telemetry?.record({</span><span class="s3">\n              </span><span class="s1">eventName: 'NEXT_EDGE_ALLOW_DYNAMIC_USED',</span><span class="s3">\n              </span><span class="s1">payload: {</span><span class="s3">\n                </span><span class="s1">file: route?.absolutePagePath.replace(rootDir ?? '', ''),</span><span class="s3">\n                </span><span class="s1">config: route?.middlewareConfig,</span><span class="s3">\n                </span><span class="s1">fileWithDynamicCode: module.userRequest.replace(</span><span class="s3">\n                  </span><span class="s1">rootDir ?? '',</span><span class="s3">\n                  </span><span class="s1">''</span><span class="s3">\n                </span><span class="s1">),</span><span class="s3">\n              </span><span class="s1">},</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">if (</span><span class="s3">\n            </span><span class="s1">!isDynamicCodeEvaluationAllowed(</span><span class="s3">\n              </span><span class="s1">module.userRequest,</span><span class="s3">\n              </span><span class="s1">route?.middlewareConfig,</span><span class="s3">\n              </span><span class="s1">rootDir</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">) {</span><span class="s3">\n            </span><span class="s1">const message = `Dynamic Code Evaluation (e. g. 'eval', 'new Function', 'WebAssembly.compile') not allowed in Edge Runtime ${</span><span class="s3">\n              </span><span class="s1">typeof buildInfo.usingIndirectEval !== 'boolean'</span><span class="s3">\n                </span><span class="s1">? `</span><span class="s3">\\</span><span class="s1">nUsed by ${Array.from(buildInfo.usingIndirectEval).join(</span><span class="s3">\n                    </span><span class="s1">', '</span><span class="s3">\n                  </span><span class="s1">)}`</span><span class="s3">\n                </span><span class="s1">: ''</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\\</span><span class="s1">nLearn More: https://nextjs.org/docs/messages/edge-dynamic-code-evaluation`</span><span class="s3">\n            </span><span class="s1">compilation.errors.push(</span><span class="s3">\n              </span><span class="s1">getDynamicCodeEvaluationError(</span><span class="s3">\n                </span><span class="s1">message,</span><span class="s3">\n                </span><span class="s1">module,</span><span class="s3">\n                </span><span class="s1">compilation,</span><span class="s3">\n                </span><span class="s1">compiler</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">/**</span><span class="s3">\n         </span><span class="s1">* The entry module has to be either a page or a middleware and hold</span><span class="s3">\n         </span><span class="s1">* the corresponding metadata.</span><span class="s3">\n         </span><span class="s1">*/</span><span class="s3">\n        </span><span class="s1">if (buildInfo?.nextEdgeSSR) {</span><span class="s3">\n          </span><span class="s1">entryMetadata.edgeSSR = buildInfo.nextEdgeSSR</span><span class="s3">\n        </span><span class="s1">} else if (buildInfo?.nextEdgeMiddleware) {</span><span class="s3">\n          </span><span class="s1">entryMetadata.edgeMiddleware = buildInfo.nextEdgeMiddleware</span><span class="s3">\n        </span><span class="s1">} else if (buildInfo?.nextEdgeApiFunction) {</span><span class="s3">\n          </span><span class="s1">entryMetadata.edgeApiFunction = buildInfo.nextEdgeApiFunction</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">/**</span><span class="s3">\n         </span><span class="s1">* If the module is a WASM module we read the binding information and</span><span class="s3">\n         </span><span class="s1">* append it to the entry wasm bindings.</span><span class="s3">\n         </span><span class="s1">*/</span><span class="s3">\n        </span><span class="s1">if (buildInfo?.nextWasmMiddlewareBinding) {</span><span class="s3">\n          </span><span class="s1">entryMetadata.wasmBindings.set(</span><span class="s3">\n            </span><span class="s1">buildInfo.nextWasmMiddlewareBinding.name,</span><span class="s3">\n            </span><span class="s1">buildInfo.nextWasmMiddlewareBinding.filePath</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (buildInfo?.nextAssetMiddlewareBinding) {</span><span class="s3">\n          </span><span class="s1">entryMetadata.assetBindings.set(</span><span class="s3">\n            </span><span class="s1">buildInfo.nextAssetMiddlewareBinding.name,</span><span class="s3">\n            </span><span class="s1">buildInfo.nextAssetMiddlewareBinding.filePath</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">/**</span><span class="s3">\n         </span><span class="s1">* Append to the list of modules to process outgoingConnections from</span><span class="s3">\n         </span><span class="s1">* the module that is being processed.</span><span class="s3">\n         </span><span class="s1">*/</span><span class="s3">\n        </span><span class="s1">for (const conn of getModuleReferencesInOrder(module, moduleGraph)) {</span><span class="s3">\n          </span><span class="s1">if (conn.module) {</span><span class="s3">\n            </span><span class="s1">modules.add(conn.module as webpack.NormalModule)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">telemetry?.record({</span><span class="s3">\n        </span><span class="s1">eventName: EVENT_BUILD_FEATURE_USAGE,</span><span class="s3">\n        </span><span class="s1">payload: {</span><span class="s3">\n          </span><span class="s1">featureName: 'vercelImageGeneration',</span><span class="s3">\n          </span><span class="s1">invocationCount: ogImageGenerationCount,</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">metadataByEntry.set(entryName, entryMetadata)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// These values will be replaced again in edge runtime deployment build.</span><span class="s3">\n</span><span class="s1">// `buildId` represents BUILD_ID to be externalized in env vars.</span><span class="s3">\n</span><span class="s1">// `encryptionKey` represents server action encryption key to be externalized in env vars.</span><span class="s3">\n</span><span class="s1">type EdgeRuntimeEnvironments = Record&lt;string, string&gt; &amp; {</span><span class="s3">\n  </span><span class="s1">__NEXT_BUILD_ID: string</span><span class="s3">\n  </span><span class="s1">NEXT_SERVER_ACTIONS_ENCRYPTION_KEY: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface Options {</span><span class="s3">\n  </span><span class="s1">dev: boolean</span><span class="s3">\n  </span><span class="s1">sriEnabled: boolean</span><span class="s3">\n  </span><span class="s1">rewrites: CustomRoutes['rewrites']</span><span class="s3">\n  </span><span class="s1">edgeEnvironments: EdgeRuntimeEnvironments</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export default class MiddlewarePlugin {</span><span class="s3">\n  </span><span class="s1">private readonly dev: Options['dev']</span><span class="s3">\n  </span><span class="s1">private readonly sriEnabled: Options['sriEnabled']</span><span class="s3">\n  </span><span class="s1">private readonly rewrites: Options['rewrites']</span><span class="s3">\n  </span><span class="s1">private readonly edgeEnvironments: EdgeRuntimeEnvironments</span><span class="s3">\n\n  </span><span class="s1">constructor({ dev, sriEnabled, rewrites, edgeEnvironments }: Options) {</span><span class="s3">\n    </span><span class="s1">this.dev = dev</span><span class="s3">\n    </span><span class="s1">this.sriEnabled = sriEnabled</span><span class="s3">\n    </span><span class="s1">this.rewrites = rewrites</span><span class="s3">\n    </span><span class="s1">this.edgeEnvironments = edgeEnvironments</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public apply(compiler: webpack.Compiler) {</span><span class="s3">\n    </span><span class="s1">compiler.hooks.compilation.tap(NAME, (compilation, params) =&gt; {</span><span class="s3">\n      </span><span class="s1">// parser hooks aren't available in rspack</span><span class="s3">\n      </span><span class="s1">if (process.env.NEXT_RSPACK) {</span><span class="s3">\n        </span><span class="s1">compilation.hooks.finishModules.tapPromise(NAME, async (modules) =&gt; {</span><span class="s3">\n          </span><span class="s1">await codeAnalyzerBySwc(compilation, modules, this.dev)</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">const { hooks } = params.normalModuleFactory</span><span class="s3">\n        </span><span class="s1">/**</span><span class="s3">\n         </span><span class="s1">* This is the static code analysis phase.</span><span class="s3">\n         </span><span class="s1">*/</span><span class="s3">\n        </span><span class="s1">const codeAnalyzer = getCodeAnalyzer({</span><span class="s3">\n          </span><span class="s1">dev: this.dev,</span><span class="s3">\n          </span><span class="s1">compiler,</span><span class="s3">\n          </span><span class="s1">compilation,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n\n        </span><span class="s1">hooks.parser.for('javascript/auto').tap(NAME, codeAnalyzer)</span><span class="s3">\n        </span><span class="s1">hooks.parser.for('javascript/dynamic').tap(NAME, codeAnalyzer)</span><span class="s3">\n        </span><span class="s1">hooks.parser.for('javascript/esm').tap(NAME, codeAnalyzer)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">/**</span><span class="s3">\n       </span><span class="s1">* Extract all metadata for the entry points in a Map object.</span><span class="s3">\n       </span><span class="s1">*/</span><span class="s3">\n      </span><span class="s1">const metadataByEntry = new Map&lt;string, EntryMetadata&gt;()</span><span class="s3">\n      </span><span class="s1">compilation.hooks.finishModules.tapPromise(</span><span class="s3">\n        </span><span class="s1">NAME,</span><span class="s3">\n        </span><span class="s1">getExtractMetadata({</span><span class="s3">\n          </span><span class="s1">compilation,</span><span class="s3">\n          </span><span class="s1">compiler,</span><span class="s3">\n          </span><span class="s1">dev: this.dev,</span><span class="s3">\n          </span><span class="s1">metadataByEntry,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n\n      </span><span class="s1">/**</span><span class="s3">\n       </span><span class="s1">* Emit the middleware manifest.</span><span class="s3">\n       </span><span class="s1">*/</span><span class="s3">\n      </span><span class="s1">compilation.hooks.processAssets.tap(</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">name: 'NextJsMiddlewareManifest',</span><span class="s3">\n          </span><span class="s1">stage: webpack.Compilation.PROCESS_ASSETS_STAGE_ADDITIONS,</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">getCreateAssets({</span><span class="s3">\n          </span><span class="s1">compilation,</span><span class="s3">\n          </span><span class="s1">metadataByEntry,</span><span class="s3">\n          </span><span class="s1">opts: {</span><span class="s3">\n            </span><span class="s1">sriEnabled: this.sriEnabled,</span><span class="s3">\n            </span><span class="s1">rewrites: this.rewrites,</span><span class="s3">\n            </span><span class="s1">edgeEnvironments: this.edgeEnvironments,</span><span class="s3">\n            </span><span class="s1">dev: this.dev,</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const SUPPORTED_NATIVE_MODULES = [</span><span class="s3">\n  </span><span class="s1">'buffer',</span><span class="s3">\n  </span><span class="s1">'events',</span><span class="s3">\n  </span><span class="s1">'assert',</span><span class="s3">\n  </span><span class="s1">'util',</span><span class="s3">\n  </span><span class="s1">'async_hooks',</span><span class="s3">\n</span><span class="s1">] as const</span><span class="s3">\n\n</span><span class="s1">const supportedEdgePolyfills = new Set&lt;string&gt;(SUPPORTED_NATIVE_MODULES)</span><span class="s3">\n\n</span><span class="s1">export function getEdgePolyfilledModules() {</span><span class="s3">\n  </span><span class="s1">const records: Record&lt;string, string&gt; = {}</span><span class="s3">\n  </span><span class="s1">for (const mod of SUPPORTED_NATIVE_MODULES) {</span><span class="s3">\n    </span><span class="s1">records[mod] = `commonjs node:${mod}`</span><span class="s3">\n    </span><span class="s1">records[`node:${mod}`] = `commonjs node:${mod}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return records</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function handleWebpackExternalForEdgeRuntime({</span><span class="s3">\n  </span><span class="s1">request,</span><span class="s3">\n  </span><span class="s1">context,</span><span class="s3">\n  </span><span class="s1">contextInfo,</span><span class="s3">\n  </span><span class="s1">getResolve,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">request: string</span><span class="s3">\n  </span><span class="s1">context: string</span><span class="s3">\n  </span><span class="s1">contextInfo: any</span><span class="s3">\n  </span><span class="s1">getResolve: () =&gt; any</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">(contextInfo.issuerLayer === WEBPACK_LAYERS.middleware ||</span><span class="s3">\n      </span><span class="s1">contextInfo.issuerLayer === WEBPACK_LAYERS.apiEdge) &amp;&amp;</span><span class="s3">\n    </span><span class="s1">(isNodeJsModule(request) || isBunModule(request)) &amp;&amp;</span><span class="s3">\n    </span><span class="s1">!supportedEdgePolyfills.has(request)</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">// allows user to provide and use their polyfills, as we do with buffer.</span><span class="s3">\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">await getResolve()(context, request)</span><span class="s3">\n    </span><span class="s1">} catch {</span><span class="s3">\n      </span><span class="s1">return `root globalThis.__import_unsupported('${request}')`</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;SUPPORTED_NATIVE_MODULES&quot;</span><span class="s0">,</span><span class="s1">&quot;MiddlewarePlugin&quot;</span><span class="s0">,</span><span class="s1">&quot;getEdgePolyfilledModules&quot;</span><span class="s0">,</span><span class="s1">&quot;handleWebpackExternalForEdgeRuntime&quot;</span><span class="s0">,</span><span class="s1">&quot;KNOWN_SAFE_DYNAMIC_PACKAGES&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;MANIFEST_VERSION&quot;</span><span class="s0">,</span><span class="s1">&quot;isUsingIndirectEvalAndUsedByExports&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;moduleGraph&quot;</span><span class="s0">,</span><span class="s1">&quot;runtime&quot;</span><span class="s0">,</span><span class="s1">&quot;module&quot;</span><span class="s0">,</span><span class="s1">&quot;usingIndirectEval&quot;</span><span class="s0">,</span><span class="s1">&quot;wp&quot;</span><span class="s0">,</span><span class="s1">&quot;exportsInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;getExportsInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;exportName&quot;</span><span class="s0">,</span><span class="s1">&quot;getUsed&quot;</span><span class="s0">,</span><span class="s1">&quot;UsageState&quot;</span><span class="s0">,</span><span class="s1">&quot;Unused&quot;</span><span class="s0">,</span><span class="s1">&quot;getEntryFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;entryFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;meta&quot;</span><span class="s0">,</span><span class="s1">&quot;hasInstrumentationHook&quot;</span><span class="s0">,</span><span class="s1">&quot;opts&quot;</span><span class="s0">,</span><span class="s1">&quot;files&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeSSR&quot;</span><span class="s0">,</span><span class="s1">&quot;isServerComponent&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;SERVER_REFERENCE_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;sriEnabled&quot;</span><span class="s0">,</span><span class="s1">&quot;SUBRESOURCE_INTEGRITY_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;file&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;CLIENT_REFERENCE_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;dev&quot;</span><span class="s0">,</span><span class="s1">&quot;isAppDir&quot;</span><span class="s0">,</span><span class="s1">&quot;DYNAMIC_CSS_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;MIDDLEWARE_BUILD_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;MIDDLEWARE_REACT_LOADABLE_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_FONT_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;INTERCEPTION_ROUTE_REWRITE_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;INSTRUMENTATION_HOOK_FILENAME&quot;</span><span class="s0">,</span><span class="s1">&quot;getCreateAssets&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;compilation&quot;</span><span class="s0">,</span><span class="s1">&quot;metadataByEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;middlewareManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;version&quot;</span><span class="s0">,</span><span class="s1">&quot;middleware&quot;</span><span class="s0">,</span><span class="s1">&quot;functions&quot;</span><span class="s0">,</span><span class="s1">&quot;sortedMiddleware&quot;</span><span class="s0">,</span><span class="s1">&quot;entrypoints&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;interceptionRewrites&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;rewrites&quot;</span><span class="s0">,</span><span class="s1">&quot;beforeFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;isInterceptionRouteRewrite&quot;</span><span class="s0">,</span><span class="s1">&quot;emitAsset&quot;</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">,</span><span class="s1">&quot;RawSource&quot;</span><span class="s0">,</span><span class="s1">&quot;entrypoint&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;metadata&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeMiddleware&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeApiFunction&quot;</span><span class="s0">,</span><span class="s1">&quot;matcherSource&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;catchAll&quot;</span><span class="s0">,</span><span class="s1">&quot;namedRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;getNamedMiddlewareRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;matchers&quot;</span><span class="s0">,</span><span class="s1">&quot;regexp&quot;</span><span class="s0">,</span><span class="s1">&quot;originalSource&quot;</span><span class="s0">,</span><span class="s1">&quot;isEdgeFunction&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeFunctionDefinition&quot;</span><span class="s0">,</span><span class="s1">&quot;getFiles&quot;</span><span class="s0">,</span><span class="s1">&quot;wasm&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;wasmBindings&quot;</span><span class="s0">,</span><span class="s1">&quot;filePath&quot;</span><span class="s0">,</span><span class="s1">&quot;assets&quot;</span><span class="s0">,</span><span class="s1">&quot;assetBindings&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeEnvironments&quot;</span><span class="s0">,</span><span class="s1">&quot;regions&quot;</span><span class="s0">,</span><span class="s1">&quot;getSortedRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;MIDDLEWARE_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;buildWebpackError&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;loc&quot;</span><span class="s0">,</span><span class="s1">&quot;entryModule&quot;</span><span class="s0">,</span><span class="s1">&quot;parser&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;compiler&quot;</span><span class="s0">,</span><span class="s1">&quot;webpack&quot;</span><span class="s0">,</span><span class="s1">&quot;WebpackError&quot;</span><span class="s0">,</span><span class="s1">&quot;state&quot;</span><span class="s0">,</span><span class="s1">&quot;current&quot;</span><span class="s0">,</span><span class="s1">&quot;isInMiddlewareLayer&quot;</span><span class="s0">,</span><span class="s1">&quot;layer&quot;</span><span class="s0">,</span><span class="s1">&quot;WEBPACK_LAYERS&quot;</span><span class="s0">,</span><span class="s1">&quot;apiEdge&quot;</span><span class="s0">,</span><span class="s1">&quot;isNodeJsModule&quot;</span><span class="s0">,</span><span class="s1">&quot;moduleName&quot;</span><span class="s0">,</span><span class="s1">&quot;builtinModules&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;isBunModule&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicCodeEvaluationAllowed&quot;</span><span class="s0">,</span><span class="s1">&quot;fileName&quot;</span><span class="s0">,</span><span class="s1">&quot;middlewareConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;rootDir&quot;</span><span class="s0">,</span><span class="s1">&quot;some&quot;</span><span class="s0">,</span><span class="s1">&quot;pkg&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;sep&quot;</span><span class="s0">,</span><span class="s1">&quot;picomatch&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_allowDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;dot&quot;</span><span class="s0">,</span><span class="s1">&quot;buildUnsupportedApiError&quot;</span><span class="s0">,</span><span class="s1">&quot;apiName&quot;</span><span class="s0">,</span><span class="s1">&quot;rest&quot;</span><span class="s0">,</span><span class="s1">&quot;start&quot;</span><span class="s0">,</span><span class="s1">&quot;line&quot;</span><span class="s0">,</span><span class="s1">&quot;registerUnsupportedApiHooks&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;EDGE_UNSUPPORTED_NODE_APIS&quot;</span><span class="s0">,</span><span class="s1">&quot;warnForUnsupportedApi&quot;</span><span class="s0">,</span><span class="s1">&quot;node&quot;</span><span class="s0">,</span><span class="s1">&quot;warnings&quot;</span><span class="s0">,</span><span class="s1">&quot;hooks&quot;</span><span class="s0">,</span><span class="s1">&quot;call&quot;</span><span class="s0">,</span><span class="s1">&quot;for&quot;</span><span class="s0">,</span><span class="s1">&quot;tap&quot;</span><span class="s0">,</span><span class="s1">&quot;callMemberChain&quot;</span><span class="s0">,</span><span class="s1">&quot;expressionMemberChain&quot;</span><span class="s0">,</span><span class="s1">&quot;warnForUnsupportedProcessApi&quot;</span><span class="s0">,</span><span class="s1">&quot;callee&quot;</span><span class="s0">,</span><span class="s1">&quot;getCodeAnalyzer&quot;</span><span class="s0">,</span><span class="s1">&quot;handleExpression&quot;</span><span class="s0">,</span><span class="s1">&quot;optimize&quot;</span><span class="s0">,</span><span class="s1">&quot;InnerGraph&quot;</span><span class="s0">,</span><span class="s1">&quot;onUsage&quot;</span><span class="s0">,</span><span class="s1">&quot;used&quot;</span><span class="s0">,</span><span class="s1">&quot;buildInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;getModuleBuildInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;handleWrapExpression&quot;</span><span class="s0">,</span><span class="s1">&quot;expr&quot;</span><span class="s0">,</span><span class="s1">&quot;ConstDependency&quot;</span><span class="s0">,</span><span class="s1">&quot;dependencies&quot;</span><span class="s0">,</span><span class="s1">&quot;dep1&quot;</span><span class="s0">,</span><span class="s1">&quot;range&quot;</span><span class="s0">,</span><span class="s1">&quot;addPresentationalDependency&quot;</span><span class="s0">,</span><span class="s1">&quot;dep2&quot;</span><span class="s0">,</span><span class="s1">&quot;handleWrapWasmCompileExpression&quot;</span><span class="s0">,</span><span class="s1">&quot;handleWrapWasmInstantiateExpression&quot;</span><span class="s0">,</span><span class="s1">&quot;handleImport&quot;</span><span class="s0">,</span><span class="s1">&quot;source&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;importLocByPath&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;importedModule&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;sourcePosition&quot;</span><span class="s0">,</span><span class="s1">&quot;identifier&quot;</span><span class="s0">,</span><span class="s1">&quot;sourceContent&quot;</span><span class="s0">,</span><span class="s1">&quot;isBun&quot;</span><span class="s0">,</span><span class="s1">&quot;skip&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;new&quot;</span><span class="s0">,</span><span class="s1">&quot;importCall&quot;</span><span class="s0">,</span><span class="s1">&quot;import&quot;</span><span class="s0">,</span><span class="s1">&quot;codeAnalyzerBySwc&quot;</span><span class="s0">,</span><span class="s1">&quot;modules&quot;</span><span class="s0">,</span><span class="s1">&quot;binding&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;normalModule&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;diagnostics&quot;</span><span class="s0">,</span><span class="s1">&quot;warnForEdgeRuntime&quot;</span><span class="s0">,</span><span class="s1">&quot;diagnostic&quot;</span><span class="s0">,</span><span class="s1">&quot;webpackError&quot;</span><span class="s0">,</span><span class="s1">&quot;severity&quot;</span><span class="s0">,</span><span class="s1">&quot;errors&quot;</span><span class="s0">,</span><span class="s1">&quot;getExtractMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;clear&quot;</span><span class="s0">,</span><span class="s1">&quot;telemetry&quot;</span><span class="s0">,</span><span class="s1">&quot;traceGlobals&quot;</span><span class="s0">,</span><span class="s1">&quot;entryName&quot;</span><span class="s0">,</span><span class="s1">&quot;entry&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;EDGE_RUNTIME_WEBPACK&quot;</span><span class="s0">,</span><span class="s1">&quot;entryDependency&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvedModule&quot;</span><span class="s0">,</span><span class="s1">&quot;getResolvedModule&quot;</span><span class="s0">,</span><span class="s1">&quot;addEntriesFromDependency&quot;</span><span class="s0">,</span><span class="s1">&quot;dependency&quot;</span><span class="s0">,</span><span class="s1">&quot;getModule&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;includeDependencies&quot;</span><span class="s0">,</span><span class="s1">&quot;entryMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;preferredRegion&quot;</span><span class="s0">,</span><span class="s1">&quot;ogImageGenerationCount&quot;</span><span class="s0">,</span><span class="s1">&quot;resource&quot;</span><span class="s0">,</span><span class="s1">&quot;hasOGImageGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;util&quot;</span><span class="s0">,</span><span class="s1">&quot;getEntryRuntime&quot;</span><span class="s0">,</span><span class="s1">&quot;id&quot;</span><span class="s0">,</span><span class="s1">&quot;record&quot;</span><span class="s0">,</span><span class="s1">&quot;eventName&quot;</span><span class="s0">,</span><span class="s1">&quot;payload&quot;</span><span class="s0">,</span><span class="s1">&quot;absolutePagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;config&quot;</span><span class="s0">,</span><span class="s1">&quot;fileWithDynamicCode&quot;</span><span class="s0">,</span><span class="s1">&quot;userRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;getDynamicCodeEvaluationError&quot;</span><span class="s0">,</span><span class="s1">&quot;nextEdgeSSR&quot;</span><span class="s0">,</span><span class="s1">&quot;nextEdgeMiddleware&quot;</span><span class="s0">,</span><span class="s1">&quot;nextEdgeApiFunction&quot;</span><span class="s0">,</span><span class="s1">&quot;nextWasmMiddlewareBinding&quot;</span><span class="s0">,</span><span class="s1">&quot;nextAssetMiddlewareBinding&quot;</span><span class="s0">,</span><span class="s1">&quot;conn&quot;</span><span class="s0">,</span><span class="s1">&quot;getModuleReferencesInOrder&quot;</span><span class="s0">,</span><span class="s1">&quot;EVENT_BUILD_FEATURE_USAGE&quot;</span><span class="s0">,</span><span class="s1">&quot;featureName&quot;</span><span class="s0">,</span><span class="s1">&quot;invocationCount&quot;</span><span class="s0">,</span><span class="s1">&quot;apply&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RSPACK&quot;</span><span class="s0">,</span><span class="s1">&quot;finishModules&quot;</span><span class="s0">,</span><span class="s1">&quot;tapPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;normalModuleFactory&quot;</span><span class="s0">,</span><span class="s1">&quot;codeAnalyzer&quot;</span><span class="s0">,</span><span class="s1">&quot;processAssets&quot;</span><span class="s0">,</span><span class="s1">&quot;stage&quot;</span><span class="s0">,</span><span class="s1">&quot;Compilation&quot;</span><span class="s0">,</span><span class="s1">&quot;PROCESS_ASSETS_STAGE_ADDITIONS&quot;</span><span class="s0">,</span><span class="s1">&quot;supportedEdgePolyfills&quot;</span><span class="s0">,</span><span class="s1">&quot;records&quot;</span><span class="s0">,</span><span class="s1">&quot;mod&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;context&quot;</span><span class="s0">,</span><span class="s1">&quot;contextInfo&quot;</span><span class="s0">,</span><span class="s1">&quot;getResolve&quot;</span><span class="s0">,</span><span class="s1">&quot;issuerLayer&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>