<html>
<head>
<title>named.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #1750eb;}
.s4 { color: #8c8c8c; font-style: italic;}
.s5 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
named.js</font>
</center></td></tr></table>
<pre><span class="s0">'use strict'</span><span class="s1">;</span><span class="s2">var </span><span class="s1">_slicedToArray = </span><span class="s2">function </span><span class="s1">() {</span><span class="s2">function </span><span class="s1">sliceIterator(arr, i) {</span><span class="s2">var </span><span class="s1">_arr = [];</span><span class="s2">var </span><span class="s1">_n = </span><span class="s2">true</span><span class="s1">;</span><span class="s2">var </span><span class="s1">_d = </span><span class="s2">false</span><span class="s1">;</span><span class="s2">var </span><span class="s1">_e = undefined;</span><span class="s2">try </span><span class="s1">{</span><span class="s2">for </span><span class="s1">(</span><span class="s2">var </span><span class="s1">_i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = </span><span class="s2">true</span><span class="s1">) {_arr.push(_s.value);</span><span class="s2">if </span><span class="s1">(i &amp;&amp; _arr.length === i) </span><span class="s2">break</span><span class="s1">;}} </span><span class="s2">catch </span><span class="s1">(err) {_d = </span><span class="s2">true</span><span class="s1">;_e = err;} </span><span class="s2">finally </span><span class="s1">{</span><span class="s2">try </span><span class="s1">{</span><span class="s2">if </span><span class="s1">(!_n &amp;&amp; _i[</span><span class="s0">&quot;return&quot;</span><span class="s1">]) _i[</span><span class="s0">&quot;return&quot;</span><span class="s1">]();} </span><span class="s2">finally </span><span class="s1">{</span><span class="s2">if </span><span class="s1">(_d) </span><span class="s2">throw </span><span class="s1">_e;}}</span><span class="s2">return </span><span class="s1">_arr;}</span><span class="s2">return function </span><span class="s1">(arr, i) {</span><span class="s2">if </span><span class="s1">(Array.isArray(arr)) {</span><span class="s2">return </span><span class="s1">arr;} </span><span class="s2">else if </span><span class="s1">(Symbol.iterator </span><span class="s2">in </span><span class="s1">Object(arr)) {</span><span class="s2">return </span><span class="s1">sliceIterator(arr, i);} </span><span class="s2">else </span><span class="s1">{</span><span class="s2">throw new </span><span class="s1">TypeError(</span><span class="s0">&quot;Invalid attempt to destructure non-iterable instance&quot;</span><span class="s1">);}};}();</span><span class="s2">var </span><span class="s1">_path = require(</span><span class="s0">'path'</span><span class="s1">);</span><span class="s2">var </span><span class="s1">path = _interopRequireWildcard(_path);</span>
<span class="s2">var </span><span class="s1">_contextCompat = require(</span><span class="s0">'eslint-module-utils/contextCompat'</span><span class="s1">);</span>

<span class="s2">var </span><span class="s1">_builder = require(</span><span class="s0">'../exportMap/builder'</span><span class="s1">);</span><span class="s2">var </span><span class="s1">_builder2 = _interopRequireDefault(_builder);</span>
<span class="s2">var </span><span class="s1">_docsUrl = require(</span><span class="s0">'../docsUrl'</span><span class="s1">);</span><span class="s2">var </span><span class="s1">_docsUrl2 = _interopRequireDefault(_docsUrl);</span><span class="s2">function </span><span class="s1">_interopRequireDefault(obj) {</span><span class="s2">return </span><span class="s1">obj &amp;&amp; obj.__esModule ? obj : { </span><span class="s0">'default'</span><span class="s1">: obj };}</span><span class="s2">function </span><span class="s1">_interopRequireWildcard(obj) {</span><span class="s2">if </span><span class="s1">(obj &amp;&amp; obj.__esModule) {</span><span class="s2">return </span><span class="s1">obj;} </span><span class="s2">else </span><span class="s1">{</span><span class="s2">var </span><span class="s1">newObj = {};</span><span class="s2">if </span><span class="s1">(obj != </span><span class="s2">null</span><span class="s1">) {</span><span class="s2">for </span><span class="s1">(</span><span class="s2">var </span><span class="s1">key </span><span class="s2">in </span><span class="s1">obj) {</span><span class="s2">if </span><span class="s1">(Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];}}newObj[</span><span class="s0">'default'</span><span class="s1">] = obj;</span><span class="s2">return </span><span class="s1">newObj;}}</span>

<span class="s1">module.exports = {</span>
  <span class="s1">meta: {</span>
    <span class="s1">type: </span><span class="s0">'problem'</span><span class="s1">,</span>
    <span class="s1">docs: {</span>
      <span class="s1">category: </span><span class="s0">'Static analysis'</span><span class="s1">,</span>
      <span class="s1">description: </span><span class="s0">'Ensure named imports correspond to a named export in the remote file.'</span><span class="s1">,</span>
      <span class="s1">url: (</span><span class="s3">0</span><span class="s1">, _docsUrl2[</span><span class="s0">'default'</span><span class="s1">])(</span><span class="s0">'named'</span><span class="s1">) },</span>

    <span class="s1">schema: [</span>
    <span class="s1">{</span>
      <span class="s1">type: </span><span class="s0">'object'</span><span class="s1">,</span>
      <span class="s1">properties: {</span>
        <span class="s1">commonjs: {</span>
          <span class="s1">type: </span><span class="s0">'boolean' </span><span class="s1">} },</span>


      <span class="s1">additionalProperties: </span><span class="s2">false </span><span class="s1">}] },</span>




  <span class="s1">create: </span><span class="s2">function </span><span class="s1">() {</span><span class="s2">function </span><span class="s1">create(context) {</span>
      <span class="s2">var </span><span class="s1">options = context.options[</span><span class="s3">0</span><span class="s1">] || {};</span>

      <span class="s2">function </span><span class="s1">checkSpecifiers(key, type, node) {</span>
        <span class="s4">// ignore local exports and type imports/exports</span>
        <span class="s2">if </span><span class="s1">(</span>
        <span class="s1">node.source == </span><span class="s2">null </span><span class="s1">||</span>
        <span class="s1">node.importKind === </span><span class="s0">'type' </span><span class="s1">||</span>
        <span class="s1">node.importKind === </span><span class="s0">'typeof' </span><span class="s1">||</span>
        <span class="s1">node.exportKind === </span><span class="s0">'type'</span><span class="s1">)</span>
        <span class="s1">{</span>
          <span class="s2">return</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s2">if </span><span class="s1">(!node.specifiers.some(</span><span class="s2">function </span><span class="s1">(im) {</span><span class="s2">return </span><span class="s1">im.type === type;})) {</span>
          <span class="s2">return</span><span class="s1">; </span><span class="s4">// no named imports/exports</span>
        <span class="s1">}</span>

        <span class="s2">var </span><span class="s1">imports = _builder2[</span><span class="s0">'default'</span><span class="s1">].get(node.source.value, context);</span>
        <span class="s2">if </span><span class="s1">(imports == </span><span class="s2">null </span><span class="s1">|| imports.parseGoal === </span><span class="s0">'ambiguous'</span><span class="s1">) {</span>
          <span class="s2">return</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s2">if </span><span class="s1">(imports.errors.length) {</span>
          <span class="s1">imports.reportErrors(context, node);</span>
          <span class="s2">return</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s1">node.specifiers.forEach(</span><span class="s2">function </span><span class="s1">(im) {</span>
          <span class="s2">if </span><span class="s1">(</span>
          <span class="s1">im.type !== type</span>
          <span class="s4">// ignore type imports</span>
          <span class="s1">|| im.importKind === </span><span class="s0">'type' </span><span class="s1">|| im.importKind === </span><span class="s0">'typeof'</span><span class="s1">)</span>
          <span class="s1">{</span>
            <span class="s2">return</span><span class="s1">;</span>
          <span class="s1">}</span>

          <span class="s2">var </span><span class="s1">name = im[key].name || im[key].value;</span>

          <span class="s2">var </span><span class="s1">deepLookup = imports.hasDeep(name);</span>

          <span class="s2">if </span><span class="s1">(!deepLookup.found) {</span>
            <span class="s2">if </span><span class="s1">(deepLookup.path.length &gt; </span><span class="s3">1</span><span class="s1">) {</span>
              <span class="s2">var </span><span class="s1">deepPath = deepLookup.path.</span>
              <span class="s1">map(</span><span class="s2">function </span><span class="s1">(i) {</span><span class="s2">return </span><span class="s1">path.relative(path.dirname((</span><span class="s3">0</span><span class="s1">, _contextCompat.getPhysicalFilename)(context)), i.path);}).</span>
              <span class="s1">join(</span><span class="s0">' -&gt; '</span><span class="s1">);</span>

              <span class="s1">context.report(im[key], String(name) + </span><span class="s0">' not found via ' </span><span class="s1">+ String(deepPath));</span>
            <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
              <span class="s1">context.report(im[key], String(name) + </span><span class="s0">' not found in </span><span class="s5">\'</span><span class="s0">' </span><span class="s1">+ String(node.source.value) + </span><span class="s0">'</span><span class="s5">\'</span><span class="s0">'</span><span class="s1">);</span>
            <span class="s1">}</span>
          <span class="s1">}</span>
        <span class="s1">});</span>
      <span class="s1">}</span>

      <span class="s2">function </span><span class="s1">checkRequire(node) {</span>
        <span class="s2">if </span><span class="s1">(</span>
        <span class="s1">!options.commonjs ||</span>
        <span class="s1">node.type !== </span><span class="s0">'VariableDeclarator'</span>
        <span class="s4">// return if it's not an object destructure or it's an empty object destructure</span>
        <span class="s1">|| !node.id || node.id.type !== </span><span class="s0">'ObjectPattern' </span><span class="s1">|| node.id.properties.length === </span><span class="s3">0</span>
        <span class="s4">// return if there is no call expression on the right side</span>
        <span class="s1">|| !node.init || node.init.type !== </span><span class="s0">'CallExpression'</span><span class="s1">)</span>
        <span class="s1">{</span>
          <span class="s2">return</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s2">var </span><span class="s1">call = node.init;</span><span class="s2">var </span><span class="s1">_call$arguments = _slicedToArray(</span>
        <span class="s1">call.arguments, </span><span class="s3">1</span><span class="s1">),source = _call$arguments[</span><span class="s3">0</span><span class="s1">];</span>
        <span class="s2">var </span><span class="s1">variableImports = node.id.properties;</span>
        <span class="s2">var </span><span class="s1">variableExports = _builder2[</span><span class="s0">'default'</span><span class="s1">].get(source.value, context);</span>

        <span class="s2">if </span><span class="s1">(</span>
        <span class="s4">// return if it's not a commonjs require statement</span>
        <span class="s1">call.callee.type !== </span><span class="s0">'Identifier' </span><span class="s1">|| call.callee.name !== </span><span class="s0">'require' </span><span class="s1">|| call.arguments.length !== </span><span class="s3">1</span>
        <span class="s4">// return if it's not a string source</span>
        <span class="s1">|| source.type !== </span><span class="s0">'Literal' </span><span class="s1">||</span>
        <span class="s1">variableExports == </span><span class="s2">null </span><span class="s1">||</span>
        <span class="s1">variableExports.parseGoal === </span><span class="s0">'ambiguous'</span><span class="s1">)</span>
        <span class="s1">{</span>
          <span class="s2">return</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s2">if </span><span class="s1">(variableExports.errors.length) {</span>
          <span class="s1">variableExports.reportErrors(context, node);</span>
          <span class="s2">return</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s1">variableImports.forEach(</span><span class="s2">function </span><span class="s1">(im) {</span>
          <span class="s2">if </span><span class="s1">(im.type !== </span><span class="s0">'Property' </span><span class="s1">|| !im.key || im.key.type !== </span><span class="s0">'Identifier'</span><span class="s1">) {</span>
            <span class="s2">return</span><span class="s1">;</span>
          <span class="s1">}</span>

          <span class="s2">var </span><span class="s1">deepLookup = variableExports.hasDeep(im.key.name);</span>

          <span class="s2">if </span><span class="s1">(!deepLookup.found) {</span>
            <span class="s2">if </span><span class="s1">(deepLookup.path.length &gt; </span><span class="s3">1</span><span class="s1">) {</span>
              <span class="s2">var </span><span class="s1">deepPath = deepLookup.path.</span>
              <span class="s1">map(</span><span class="s2">function </span><span class="s1">(i) {</span><span class="s2">return </span><span class="s1">path.relative(path.dirname((</span><span class="s3">0</span><span class="s1">, _contextCompat.getFilename)(context)), i.path);}).</span>
              <span class="s1">join(</span><span class="s0">' -&gt; '</span><span class="s1">);</span>

              <span class="s1">context.report(im.key, String(im.key.name) + </span><span class="s0">' not found via ' </span><span class="s1">+ String(deepPath));</span>
            <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
              <span class="s1">context.report(im.key, String(im.key.name) + </span><span class="s0">' not found in </span><span class="s5">\'</span><span class="s0">' </span><span class="s1">+ String(source.value) + </span><span class="s0">'</span><span class="s5">\'</span><span class="s0">'</span><span class="s1">);</span>
            <span class="s1">}</span>
          <span class="s1">}</span>
        <span class="s1">});</span>
      <span class="s1">}</span>

      <span class="s2">return </span><span class="s1">{</span>
        <span class="s1">ImportDeclaration: checkSpecifiers.bind(</span><span class="s2">null</span><span class="s1">, </span><span class="s0">'imported'</span><span class="s1">, </span><span class="s0">'ImportSpecifier'</span><span class="s1">),</span>

        <span class="s1">ExportNamedDeclaration: checkSpecifiers.bind(</span><span class="s2">null</span><span class="s1">, </span><span class="s0">'local'</span><span class="s1">, </span><span class="s0">'ExportSpecifier'</span><span class="s1">),</span>

        <span class="s1">VariableDeclarator: checkRequire };</span>

    <span class="s1">}</span><span class="s2">return </span><span class="s1">create;}() };</span>
<span class="s4">//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9ydWxlcy9uYW1lZC5qcyJdLCJuYW1lcyI6WyJwYXRoIiwibW9kdWxlIiwiZXhwb3J0cyIsIm1ldGEiLCJ0eXBlIiwiZG9jcyIsImNhdGVnb3J5IiwiZGVzY3JpcHRpb24iLCJ1cmwiLCJzY2hlbWEiLCJwcm9wZXJ0aWVzIiwiY29tbW9uanMiLCJhZGRpdGlvbmFsUHJvcGVydGllcyIsImNyZWF0ZSIsImNvbnRleHQiLCJvcHRpb25zIiwiY2hlY2tTcGVjaWZpZXJzIiwia2V5Iiwibm9kZSIsInNvdXJjZSIsImltcG9ydEtpbmQiLCJleHBvcnRLaW5kIiwic3BlY2lmaWVycyIsInNvbWUiLCJpbSIsImltcG9ydHMiLCJFeHBvcnRNYXBCdWlsZGVyIiwiZ2V0IiwidmFsdWUiLCJwYXJzZUdvYWwiLCJlcnJvcnMiLCJsZW5ndGgiLCJyZXBvcnRFcnJvcnMiLCJmb3JFYWNoIiwibmFtZSIsImRlZXBMb29rdXAiLCJoYXNEZWVwIiwiZm91bmQiLCJkZWVwUGF0aCIsIm1hcCIsImkiLCJyZWxhdGl2ZSIsImRpcm5hbWUiLCJqb2luIiwicmVwb3J0IiwiY2hlY2tSZXF1aXJlIiwiaWQiLCJpbml0IiwiY2FsbCIsImFyZ3VtZW50cyIsInZhcmlhYmxlSW1wb3J0cyIsInZhcmlhYmxlRXhwb3J0cyIsImNhbGxlZSIsIkltcG9ydERlY2xhcmF0aW9uIiwiYmluZCIsIkV4cG9ydE5hbWVkRGVjbGFyYXRpb24iLCJWYXJpYWJsZURlY2xhcmF0b3IiXSwibWFwcGluZ3MiOiJxb0JBQUEsNEIsSUFBWUEsSTtBQUNaOztBQUVBLCtDO0FBQ0EscUM7O0FBRUFDLE9BQU9DLE9BQVAsR0FBaUI7QUFDZkMsUUFBTTtBQUNKQyxVQUFNLFNBREY7QUFFSkMsVUFBTTtBQUNKQyxnQkFBVSxpQkFETjtBQUVKQyxtQkFBYSx1RUFGVDtBQUdKQyxXQUFLLDBCQUFRLE9BQVIsQ0FIRCxFQUZGOztBQU9KQyxZQUFRO0FBQ047QUFDRUwsWUFBTSxRQURSO0FBRUVNLGtCQUFZ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QVdILFdBQVduQyxJQUFYO0FBQ2R1QyxpQkFEYyxDQUNWLFVBQUNDLENBQUQsVUFBT3hDLEtBQUt5QyxRQUFMLENBQWN6QyxLQUFLMEMsT0FBTCxDQUFhLGdDQUFZNUIsT0FBWixDQUFiLENBQWQsRUFBa0QwQixFQUFFeEMsSUFBcEQsQ0FBUCxFQURVO0FBRWQyQyxrQkFGYyxDQUVULE1BRlMsQ0FBakI7O0FBSUE3QixzQkFBUThCLE1BQVIsQ0FBZXBCLEdBQUdQLEdBQWxCLFNBQTBCTyxHQUFHUCxHQUFILENBQU9pQixJQUFqQywrQkFBdURJLFFBQXZEO0FBQ0QsYUFORCxNQU1PO0FBQ0x4QixzQkFBUThCLE1BQVIsQ0FBZXBCLEdBQUdQLEdBQWxCLFNBQTBCTyxHQUFHUCxHQUFILENBQU9pQixJQUFqQyxnQ0FBdURmLE9BQU9TLEtBQTlEO0FBQ0Q7QUFDRjtBQUNGLFNBbEJEO0FBbUJEOztBQUVELGFBQU87QUFDTHlCLDJCQUFtQnJDLGdCQUFnQnNDLElBQWhCLENBQXFCLElBQXJCLEVBQTJCLFVBQTNCLEVBQXVDLGlCQUF2QyxDQURkOztBQUdMQyxnQ0FBd0J2QyxnQkFBZ0JzQyxJQUFoQixDQUFxQixJQUFyQixFQUEyQixPQUEzQixFQUFvQyxpQkFBcEMsQ0FIbkI7O0FBS0xFLDRCQUFvQlgsWUFMZixFQUFQOztBQU9ELEtBekljLG1CQUFqQiIsImZpbGUiOiJuYW1lZC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBnZXRGaWxlbmFtZSwgZ2V0UGh5c2ljYWxGaWxlbmFtZSB9IGZyb20gJ2VzbGludC1tb2R1bGUtdXRpbHMvY29udGV4dENvbXBhdCc7XG5cbmltcG9ydCBFeHBvcnRNYXBCdWlsZGVyIGZyb20gJy4uL2V4cG9ydE1hcC9idWlsZGVyJztcbmltcG9ydCBkb2NzVXJsIGZyb20gJy4uL2RvY3NVcmwnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgbWV0YToge1xuICAgIHR5cGU6ICdwcm9ibGVtJyxcbiAgICBkb2NzOiB7XG4gICAgICBjYXRlZ29yeTogJ1N0YXRpYyBhbmFseXNpcycsXG4gICAgICBkZXNjcmlwdGlvbjogJ0Vuc3VyZSBuYW1lZCBpbXBvcnRzIGNvcnJlc3BvbmQgdG8gYSBuYW1lZCBleHBvcnQgaW4gdGhlIHJlbW90ZSBmaWxlLicsXG4gICAgICB1cmw6IGRvY3NVcmwoJ25hbWVkJyksXG4gICAgfSxcbiAgICBzY2hlbWE6IFtcbiAgICAgIHtcbiAgICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICBjb21tb25qczoge1xuICAgICAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGFkZGl0aW9uYWxQcm9wZXJ0aWVzOiBmYWxzZSxcbiAgICAgIH0sXG4gICAgXSxcbiAgfSxcblxuICBjcmVhdGUoY29udGV4dCkge1xuICAgIGNvbnN0IG9wdGlvbnMgPSBjb250ZXh0Lm9wdGlvbnNbMF0gfHwge307XG5cbiAgICBmdW5jdGlvbiBjaGVja1NwZWNpZmllcnMoa2V5LCB0eXBlLCBub2RlKSB7XG4gICAgICAvLyBpZ25vcmUgbG9jYWwgZXhwb3J0cyBhbmQgdHlwZSBpbXBvcnRzL2V4cG9ydHNcbiAgICAgIGlmIChcbiAgICAgICAgbm9kZS5zb3VyY2UgPT0gbnVsbFxuICAgICAgICB8fCBub2RlLmltcG9ydEtpbmQgPT09ICd0eXBlJ1xuICAgICAgICB8fCBub2RlLmltcG9ydEtpbmQgPT09ICd0eXBlb2YnXG4gICAgICAgIHx8IG5vZGUuZXhwb3J0S2luZCA9PT0gJ3R5cGUnXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoIW5vZGUuc3BlY2lmaWVycy5zb21lKChpbSkgPT4gaW0udHlwZSA9PT0gdHlwZSkpIHtcbiAgICAgICAgcmV0dXJuOyAvLyBubyBuYW1lZCBpbXBvcnRzL2V4cG9ydHNcbiAgICAgIH1cblxuICAgICAgY29uc3QgaW1wb3J0cyA9IEV4cG9ydE1hcEJ1aWxkZXIuZ2V0KG5vZGUuc291cmNlLnZhbHVlLCBjb250ZXh0KTtcbiAgICAgIGlmIChpbXBvcnRzID09IG51bGwgfHwgaW1wb3J0cy5wYXJzZUdvYWwgPT09ICdhbWJpZ3VvdXMnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKGltcG9ydHMuZXJyb3JzLmxlbmd0aCkge1xuICAgICAgICBpbXBvcnRzLnJlcG9ydEVycm9ycyhjb250ZXh0LCBub2RlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBub2RlLnNwZWNpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAoaW0pIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGltLnR5cGUgIT09IHR5cGVcbiAgICAgICAgICAvLyBpZ25vcmUgdHlwZSBpbXBvcnRzXG4gICAgICAgICAgfHwgaW0uaW1wb3J0S2luZCA9PT0gJ3R5cGUnIHx8IGltLmltcG9ydEtpbmQgPT09ICd0eXBlb2YnXG4gICAgICAgICkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5hbWUgPSBpbVtrZXldLm5hbWUgfHwgaW1ba2V5XS52YWx1ZTtcblxuICAgICAgICBjb25zdCBkZWVwTG9va3VwID0gaW1wb3J0cy5oYXNEZWVwKG5hbWUpO1xuXG4gICAgICAgIGlmICghZGVlcExvb2t1cC5mb3VuZCkge1xuICAgICAgICAgIGlmIChkZWVwTG9va3VwLnBhdGgubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgY29uc3QgZGVlcFBhdGggPSBkZWVwTG9va3VwLnBhdGhcbiAgICAgICAgICAgICAgLm1hcCgoaSkgPT4gcGF0aC5yZWxhdGl2ZShwYXRoLmRpcm5hbWUoZ2V0UGh5c2ljYWxGaWxlbmFtZShjb250ZXh0KSksIGkucGF0aCkpXG4gICAgICAgICAgICAgIC5qb2luKCcgLT4gJyk7XG5cbiAgICAgICAgICAgIGNvbnRleHQucmVwb3J0KGltW2tleV0sIGAke25hbWV9IG5vdCBmb3VuZCB2aWEgJHtkZWVwUGF0aH1gKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dC5yZXBvcnQoaW1ba2V5XSwgYCR7bmFtZX0gbm90IGZvdW5kIGluICcke25vZGUuc291cmNlLnZhbHVlfSdgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNoZWNrUmVxdWlyZShub2RlKSB7XG4gICAgICBpZiAoXG4gICAgICAgICFvcHRpb25zLmNvbW1vbmpzXG4gICAgICAgIHx8IG5vZGUudHlwZSAhPT0gJ1ZhcmlhYmxlRGVjbGFyYXRvcidcbiAgICAgICAgLy8gcmV0dXJuIGlmIGl0J3Mgbm90IGFuIG9iamVjdCBkZXN0cnVjdHVyZSBvciBpdCdzIGFuIGVtcHR5IG9iamVjdCBkZXN0cnVjdHVyZVxuICAgICAgICB8fCAhbm9kZS5pZCB8fCBub2RlLmlkLnR5cGUgIT09ICdPYmplY3RQYXR0ZXJuJyB8fCBub2RlLmlkLnByb3BlcnRpZXMubGVuZ3RoID09PSAwXG4gICAgICAgIC8vIHJldHVybiBpZiB0aGVyZSBpcyBubyBjYWxsIGV4cHJlc3Npb24gb24gdGhlIHJpZ2h0IHNpZGVcbiAgICAgICAgfHwgIW5vZGUuaW5pdCB8fCBub2RlLmluaXQudHlwZSAhPT0gJ0NhbGxFeHByZXNzaW9uJ1xuICAgICAgKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2FsbCA9IG5vZGUuaW5pdDtcbiAgICAgIGNvbnN0IFtzb3VyY2VdID0gY2FsbC5hcmd1bWVudHM7XG4gICAgICBjb25zdCB2YXJpYWJsZUltcG9ydHMgPSBub2RlLmlkLnByb3BlcnRpZXM7XG4gICAgICBjb25zdCB2YXJpYWJsZUV4cG9ydHMgPSBFeHBvcnRNYXBCdWlsZGVyLmdldChzb3VyY2UudmFsdWUsIGNvbnRleHQpO1xuXG4gICAgICBpZiAoXG4gICAgICAgIC8vIHJldHVybiBpZiBpdCdzIG5vdCBhIGNvbW1vbmpzIHJlcXVpcmUgc3RhdGVtZW50XG4gICAgICAgIGNhbGwuY2FsbGVlLnR5cGUgIT09ICdJZGVudGlmaWVyJyB8fCBjYWxsLmNhbGxlZS5uYW1lICE9PSAncmVxdWlyZScgfHwgY2FsbC5hcmd1bWVudHMubGVuZ3RoICE9PSAxXG4gICAgICAgIC8vIHJldHVybiBpZiBpdCdzIG5vdCBhIHN0cmluZyBzb3VyY2VcbiAgICAgICAgfHwgc291cmNlLnR5cGUgIT09ICdMaXRlcmFsJ1xuICAgICAgICB8fCB2YXJpYWJsZUV4cG9ydHMgPT0gbnVsbFxuICAgICAgICB8fCB2YXJpYWJsZUV4cG9ydHMucGFyc2VHb2FsID09PSAnYW1iaWd1b3VzJ1xuICAgICAgKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHZhcmlhYmxlRXhwb3J0cy5lcnJvcnMubGVuZ3RoKSB7XG4gICAgICAgIHZhcmlhYmxlRXhwb3J0cy5yZXBvcnRFcnJvcnMoY29udGV4dCwgbm9kZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyaWFibGVJbXBvcnRzLmZvckVhY2goZnVuY3Rpb24gKGltKSB7XG4gICAgICAgIGlmIChpbS50eXBlICE9PSAnUHJvcGVydHknIHx8ICFpbS5rZXkgfHwgaW0ua2V5LnR5cGUgIT09ICdJZGVudGlmaWVyJykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRlZXBMb29rdXAgPSB2YXJpYWJsZUV4cG9ydHMuaGFzRGVlcChpbS5rZXkubmFtZSk7XG5cbiAgICAgICAgaWYgKCFkZWVwTG9va3VwLmZvdW5kKSB7XG4gICAgICAgICAgaWYgKGRlZXBMb29rdXAucGF0aC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBjb25zdCBkZWVwUGF0aCA9IGRlZXBMb29rdXAucGF0aFxuICAgICAgICAgICAgICAubWFwKChpKSA9PiBwYXRoLnJlbGF0aXZlKHBhdGguZGlybmFtZShnZXRGaWxlbmFtZShjb250ZXh0KSksIGkucGF0aCkpXG4gICAgICAgICAgICAgIC5qb2luKCcgLT4gJyk7XG5cbiAgICAgICAgICAgIGNvbnRleHQucmVwb3J0KGltLmtleSwgYCR7aW0ua2V5Lm5hbWV9IG5vdCBmb3VuZCB2aWEgJHtkZWVwUGF0aH1gKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dC5yZXBvcnQoaW0ua2V5LCBgJHtpbS5rZXkubmFtZX0gbm90IGZvdW5kIGluICcke3NvdXJjZS52YWx1ZX0nYCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgSW1wb3J0RGVjbGFyYXRpb246IGNoZWNrU3BlY2lmaWVycy5iaW5kKG51bGwsICdpbXBvcnRlZCcsICdJbXBvcnRTcGVjaWZpZXInKSxcblxuICAgICAgRXhwb3J0TmFtZWREZWNsYXJhdGlvbjogY2hlY2tTcGVjaWZpZXJzLmJpbmQobnVsbCwgJ2xvY2FsJywgJ0V4cG9ydFNwZWNpZmllcicpLFxuXG4gICAgICBWYXJpYWJsZURlY2xhcmF0b3I6IGNoZWNrUmVxdWlyZSxcbiAgICB9O1xuICB9LFxufTtcbiJdfQ==</span></pre>
</body>
</html>