<html>
<head>
<title>next-worker-fixture.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
next-worker-fixture.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/experimental/testmode/playwright/next-worker-fixture.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { FetchHandlerResult, ProxyServer } from '../proxy'</span><span class="s3">\n</span><span class="s1">import { createProxyServer } from '../proxy'</span><span class="s3">\n\n</span><span class="s1">export type FetchHandler = (</span><span class="s3">\n  </span><span class="s1">request: Request</span><span class="s3">\n</span><span class="s1">) =&gt; FetchHandlerResult | Promise&lt;FetchHandlerResult&gt;</span><span class="s3">\n\n</span><span class="s1">export interface NextWorkerFixture {</span><span class="s3">\n  </span><span class="s1">proxyPort: number</span><span class="s3">\n  </span><span class="s1">onFetch: (testId: string, handler: FetchHandler) =&gt; void</span><span class="s3">\n  </span><span class="s1">cleanupTest: (testId: string) =&gt; void</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">class NextWorkerFixtureImpl implements NextWorkerFixture {</span><span class="s3">\n  </span><span class="s1">public proxyPort: number = 0</span><span class="s3">\n  </span><span class="s1">private proxyServer: ProxyServer | null = null</span><span class="s3">\n  </span><span class="s1">private proxyFetchMap = new Map&lt;string, FetchHandler&gt;()</span><span class="s3">\n\n  </span><span class="s1">async setup(): Promise&lt;void&gt; {</span><span class="s3">\n    </span><span class="s1">const server = await createProxyServer({</span><span class="s3">\n      </span><span class="s1">onFetch: this.handleProxyFetch.bind(this),</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n\n    </span><span class="s1">this.proxyPort = server.port</span><span class="s3">\n    </span><span class="s1">this.proxyServer = server</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">teardown(): void {</span><span class="s3">\n    </span><span class="s1">if (this.proxyServer) {</span><span class="s3">\n      </span><span class="s1">this.proxyServer.close()</span><span class="s3">\n      </span><span class="s1">this.proxyServer = null</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">cleanupTest(testId: string): void {</span><span class="s3">\n    </span><span class="s1">this.proxyFetchMap.delete(testId)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">onFetch(testId: string, handler: FetchHandler): void {</span><span class="s3">\n    </span><span class="s1">this.proxyFetchMap.set(testId, handler)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private async handleProxyFetch(</span><span class="s3">\n    </span><span class="s1">testId: string,</span><span class="s3">\n    </span><span class="s1">request: Request</span><span class="s3">\n  </span><span class="s1">): Promise&lt;FetchHandlerResult&gt; {</span><span class="s3">\n    </span><span class="s1">const handler = this.proxyFetchMap.get(testId)</span><span class="s3">\n    </span><span class="s1">return handler?.(request)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function applyNextWorkerFixture(</span><span class="s3">\n  </span><span class="s1">use: (fixture: NextWorkerFixture) =&gt; Promise&lt;void&gt;</span><span class="s3">\n</span><span class="s1">): Promise&lt;void&gt; {</span><span class="s3">\n  </span><span class="s1">const fixture = new NextWorkerFixtureImpl()</span><span class="s3">\n  </span><span class="s1">await fixture.setup()</span><span class="s3">\n  </span><span class="s1">// eslint-disable-next-line react-hooks/rules-of-hooks -- not React.use()</span><span class="s3">\n  </span><span class="s1">await use(fixture)</span><span class="s3">\n  </span><span class="s1">fixture.teardown()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;applyNextWorkerFixture&quot;</span><span class="s0">,</span><span class="s1">&quot;NextWorkerFixtureImpl&quot;</span><span class="s0">,</span><span class="s1">&quot;setup&quot;</span><span class="s0">,</span><span class="s1">&quot;server&quot;</span><span class="s0">,</span><span class="s1">&quot;createProxyServer&quot;</span><span class="s0">,</span><span class="s1">&quot;onFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;handleProxyFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;bind&quot;</span><span class="s0">,</span><span class="s1">&quot;proxyPort&quot;</span><span class="s0">,</span><span class="s1">&quot;port&quot;</span><span class="s0">,</span><span class="s1">&quot;proxyServer&quot;</span><span class="s0">,</span><span class="s1">&quot;teardown&quot;</span><span class="s0">,</span><span class="s1">&quot;close&quot;</span><span class="s0">,</span><span class="s1">&quot;cleanupTest&quot;</span><span class="s0">,</span><span class="s1">&quot;testId&quot;</span><span class="s0">,</span><span class="s1">&quot;proxyFetchMap&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;handler&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;use&quot;</span><span class="s0">,</span><span class="s1">&quot;fixture&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BAmDsBA;;;eAAAA;;;uBAlDY;AAYlC,MAAMC;IAKJ,MAAMC,QAAuB;QAC3B,MAAMC,SAAS,MAAMC,IAAAA,wBAAiB,EAAC;YACrCC,SAAS,IAAI,CAACC,gBAAgB,CAACC,IAAI,CAAC,IAAI;QAC1C;QAEA,IAAI,CAACC,SAAS,GAAGL,OAAOM,IAAI;QAC5B,IAAI,CAACC,WAAW,GAAGP;IACrB;IAEAQ,WAAiB;QACf,IAAI,IAAI,CAACD,WAAW,EAAE;YACpB,IAAI,CAACA,WAAW,CAACE,KAAK;YACtB,IAAI,CAACF,WAAW,GAAG;QACrB;IACF;IAEAG,YAAYC,MAAc,EAAQ;QAChC,IAAI,CAACC,aAAa,CAACC,MAAM,CAACF;IAC5B;IAEAT,QAAQS,MAAc,EAAEG,OAAqB,EAAQ;QACnD,IAAI,CAACF,aAAa,CAACG,GAAG,CAACJ,QAAQG;IACjC;IAEA,MAAcX,iBACZQ,MAAc,EACdK,OAAgB,EACa;QAC7B,MAAMF,UAAU,IAAI,CAACF,aAAa,CAACK,GAAG,CAACN;QACvC,OAAOG,2BAAAA,QAAUE;IACnB;;aAlCOX,YAAoB;aACnBE,cAAkC;aAClCK,gBAAgB,IAAIM;;AAiC9B;AAEO,eAAerB,uBACpBsB,GAAkD;IAElD,MAAMC,UAAU,IAAItB;IACpB,MAAMsB,QAAQrB,KAAK;IACnB,yEAAyE;IACzE,MAAMoB,IAAIC;IACVA,QAAQZ,QAAQ;AAClB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>