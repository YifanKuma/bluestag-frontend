<html>
<head>
<title>dev-bundler-service.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
dev-bundler-service.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../src/server/lib/dev-bundler-service.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { IncomingMessage } from 'http'</span><span class="s3">\n</span><span class="s1">import type { DevBundler } from './router-utils/setup-dev-bundler'</span><span class="s3">\n</span><span class="s1">import type { WorkerRequestHandler } from './types'</span><span class="s3">\n\n</span><span class="s1">import { LRUCache } from './lru-cache'</span><span class="s3">\n</span><span class="s1">import { createRequestResponseMocks } from './mock-request'</span><span class="s3">\n</span><span class="s1">import { HMR_ACTIONS_SENT_TO_BROWSER } from '../dev/hot-reloader-types'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* The DevBundlerService provides an interface to perform tasks with the</span><span class="s3">\n </span><span class="s1">* bundler while in development.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export class DevBundlerService {</span><span class="s3">\n  </span><span class="s1">public appIsrManifestInner: InstanceType&lt;typeof LRUCache&lt;boolean&gt;&gt;</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">private readonly bundler: DevBundler,</span><span class="s3">\n    </span><span class="s1">private readonly handler: WorkerRequestHandler</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">this.appIsrManifestInner = new LRUCache(</span><span class="s3">\n      </span><span class="s1">8_000,</span><span class="s3">\n\n      </span><span class="s1">function length() {</span><span class="s3">\n        </span><span class="s1">return 16</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">) as any</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public ensurePage: typeof this.bundler.hotReloader.ensurePage = async (</span><span class="s3">\n    </span><span class="s1">definition</span><span class="s3">\n  </span><span class="s1">) =&gt; {</span><span class="s3">\n    </span><span class="s1">// TODO: remove after ensure is pulled out of server</span><span class="s3">\n    </span><span class="s1">return await this.bundler.hotReloader.ensurePage(definition)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public logErrorWithOriginalStack =</span><span class="s3">\n    </span><span class="s1">this.bundler.logErrorWithOriginalStack.bind(this.bundler)</span><span class="s3">\n\n  </span><span class="s1">public async getFallbackErrorComponents(url?: string) {</span><span class="s3">\n    </span><span class="s1">await this.bundler.hotReloader.buildFallbackError()</span><span class="s3">\n    </span><span class="s1">// Build the error page to ensure the fallback is built too.</span><span class="s3">\n    </span><span class="s1">// TODO: See if this can be moved into hotReloader or removed.</span><span class="s3">\n    </span><span class="s1">await this.bundler.hotReloader.ensurePage({</span><span class="s3">\n      </span><span class="s1">page: '/_error',</span><span class="s3">\n      </span><span class="s1">clientOnly: false,</span><span class="s3">\n      </span><span class="s1">definition: undefined,</span><span class="s3">\n      </span><span class="s1">url,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public async getCompilationError(page: string) {</span><span class="s3">\n    </span><span class="s1">const errors = await this.bundler.hotReloader.getCompilationErrors(page)</span><span class="s3">\n    </span><span class="s1">if (!errors) return</span><span class="s3">\n\n    </span><span class="s1">// Return the very first error we found.</span><span class="s3">\n    </span><span class="s1">return errors[0]</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public async revalidate({</span><span class="s3">\n    </span><span class="s1">urlPath,</span><span class="s3">\n    </span><span class="s1">revalidateHeaders,</span><span class="s3">\n    </span><span class="s1">opts: revalidateOpts,</span><span class="s3">\n  </span><span class="s1">}: {</span><span class="s3">\n    </span><span class="s1">urlPath: string</span><span class="s3">\n    </span><span class="s1">revalidateHeaders: IncomingMessage['headers']</span><span class="s3">\n    </span><span class="s1">opts: any</span><span class="s3">\n  </span><span class="s1">}) {</span><span class="s3">\n    </span><span class="s1">const mocked = createRequestResponseMocks({</span><span class="s3">\n      </span><span class="s1">url: urlPath,</span><span class="s3">\n      </span><span class="s1">headers: revalidateHeaders,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n\n    </span><span class="s1">await this.handler(mocked.req, mocked.res)</span><span class="s3">\n    </span><span class="s1">await mocked.res.hasStreamed</span><span class="s3">\n\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">mocked.res.getHeader('x-nextjs-cache') !== 'REVALIDATED' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">mocked.res.statusCode !== 200 &amp;&amp;</span><span class="s3">\n      </span><span class="s1">!(mocked.res.statusCode === 404 &amp;&amp; revalidateOpts.unstable_onlyGenerated)</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">throw new Error(`Invalid response ${mocked.res.statusCode}`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return {}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public get appIsrManifest() {</span><span class="s3">\n    </span><span class="s1">const serializableManifest: Record&lt;string, boolean&gt; = {}</span><span class="s3">\n\n    </span><span class="s1">for (const [key, value] of this.appIsrManifestInner) {</span><span class="s3">\n      </span><span class="s1">serializableManifest[key] = value</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return serializableManifest</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public setIsrStatus(key: string, value: boolean | null) {</span><span class="s3">\n    </span><span class="s1">if (value === null) {</span><span class="s3">\n      </span><span class="s1">this.appIsrManifestInner.remove(key)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">this.appIsrManifestInner.set(key, value)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">this.bundler?.hotReloader?.send({</span><span class="s3">\n      </span><span class="s1">action: HMR_ACTIONS_SENT_TO_BROWSER.ISR_MANIFEST,</span><span class="s3">\n      </span><span class="s1">data: this.appIsrManifest,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public close() {</span><span class="s3">\n    </span><span class="s1">this.bundler.hotReloader.close()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;DevBundlerService&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;bundler&quot;</span><span class="s0">,</span><span class="s1">&quot;handler&quot;</span><span class="s0">,</span><span class="s1">&quot;ensurePage&quot;</span><span class="s0">,</span><span class="s1">&quot;definition&quot;</span><span class="s0">,</span><span class="s1">&quot;hotReloader&quot;</span><span class="s0">,</span><span class="s1">&quot;logErrorWithOriginalStack&quot;</span><span class="s0">,</span><span class="s1">&quot;bind&quot;</span><span class="s0">,</span><span class="s1">&quot;appIsrManifestInner&quot;</span><span class="s0">,</span><span class="s1">&quot;LRUCache&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;getFallbackErrorComponents&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;buildFallbackError&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;clientOnly&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;getCompilationError&quot;</span><span class="s0">,</span><span class="s1">&quot;errors&quot;</span><span class="s0">,</span><span class="s1">&quot;getCompilationErrors&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;urlPath&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidateHeaders&quot;</span><span class="s0">,</span><span class="s1">&quot;opts&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidateOpts&quot;</span><span class="s0">,</span><span class="s1">&quot;mocked&quot;</span><span class="s0">,</span><span class="s1">&quot;createRequestResponseMocks&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;req&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;hasStreamed&quot;</span><span class="s0">,</span><span class="s1">&quot;getHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_onlyGenerated&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;appIsrManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;serializableManifest&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;setIsrStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;remove&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;send&quot;</span><span class="s0">,</span><span class="s1">&quot;action&quot;</span><span class="s0">,</span><span class="s1">&quot;HMR_ACTIONS_SENT_TO_BROWSER&quot;</span><span class="s0">,</span><span class="s1">&quot;ISR_MANIFEST&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;close&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BAYaA;;;eAAAA;;;0BARY;6BACkB;kCACC;AAMrC,MAAMA;IAGXC,YACE,AAAiBC,OAAmB,EACpC,AAAiBC,OAA6B,CAC9C;aAFiBD,UAAAA;aACAC,UAAAA;aAWZC,aAAyD,OAC9DC;YAEA,oDAAoD;YACpD,OAAO,MAAM,IAAI,CAACH,OAAO,CAACI,WAAW,CAACF,UAAU,CAACC;QACnD;aAEOE,4BACL,IAAI,CAACL,OAAO,CAACK,yBAAyB,CAACC,IAAI,CAAC,IAAI,CAACN,OAAO;QAjBxD,IAAI,CAACO,mBAAmB,GAAG,IAAIC,kBAAQ,CACrC,MAEA,SAASC;YACP,OAAO;QACT;IAEJ;IAYA,MAAaC,2BAA2BC,GAAY,EAAE;QACpD,MAAM,IAAI,CAACX,OAAO,CAACI,WAAW,CAACQ,kBAAkB;QACjD,4DAA4D;QAC5D,8DAA8D;QAC9D,MAAM,IAAI,CAACZ,OAAO,CAACI,WAAW,CAACF,UAAU,CAAC;YACxCW,MAAM;YACNC,YAAY;YACZX,YAAYY;YACZJ;QACF;IACF;IAEA,MAAaK,oBAAoBH,IAAY,EAAE;QAC7C,MAAMI,SAAS,MAAM,IAAI,CAACjB,OAAO,CAACI,WAAW,CAACc,oBAAoB,CAACL;QACnE,IAAI,CAACI,QAAQ;QAEb,wCAAwC;QACxC,OAAOA,MAAM,CAAC,EAAE;IAClB;IAEA,MAAaE,WAAW,EACtBC,OAAO,EACPC,iBAAiB,EACjBC,MAAMC,cAAc,EAKrB,EAAE;QACD,MAAMC,SAASC,IAAAA,uCAA0B,EAAC;YACxCd,KAAKS;YACLM,SAASL;QACX;QAEA,MAAM,IAAI,CAACpB,OAAO,CAACuB,OAAOG,GAAG,EAAEH,OAAOI,GAAG;QACzC,MAAMJ,OAAOI,GAAG,CAACC,WAAW;QAE5B,IACEL,OAAOI,GAAG,CAACE,SAAS,CAAC,sBAAsB,iBAC3CN,OAAOI,GAAG,CAACG,UAAU,KAAK,OAC1B,CAAEP,CAAAA,OAAOI,GAAG,CAACG,UAAU,KAAK,OAAOR,eAAeS,sBAAsB,AAAD,GACvE;YACA,MAAM,qBAAsD,CAAtD,IAAIC,MAAM,CAAC,iBAAiB,EAAET,OAAOI,GAAG,CAACG,UAAU,EAAE,GAArD,qBAAA;uBAAA;4BAAA;8BAAA;YAAqD;QAC7D;QAEA,OAAO,CAAC;IACV;IAEA,IAAWG,iBAAiB;QAC1B,MAAMC,uBAAgD,CAAC;QAEvD,KAAK,MAAM,CAACC,KAAKC,MAAM,IAAI,IAAI,CAAC9B,mBAAmB,CAAE;YACnD4B,oBAAoB,CAACC,IAAI,GAAGC;QAC9B;QAEA,OAAOF;IACT;IAEOG,aAAaF,GAAW,EAAEC,KAAqB,EAAE;YAMtD,2BAAA;QALA,IAAIA,UAAU,MAAM;YAClB,IAAI,CAAC9B,mBAAmB,CAACgC,MAAM,CAACH;QAClC,OAAO;YACL,IAAI,CAAC7B,mBAAmB,CAACiC,GAAG,CAACJ,KAAKC;QACpC;SACA,gBAAA,IAAI,CAACrC,OAAO,sBAAZ,4BAAA,cAAcI,WAAW,qBAAzB,0BAA2BqC,IAAI,CAAC;YAC9BC,QAAQC,6CAA2B,CAACC,YAAY;YAChDC,MAAM,IAAI,CAACX,cAAc;QAC3B;IACF;IAEOY,QAAQ;QACb,IAAI,CAAC9C,OAAO,CAACI,WAAW,CAAC0C,KAAK;IAChC;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>