<html>
<head>
<title>coalesced-function.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
coalesced-function.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../src/lib/coalesced-function.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;type CoalescedInvoke&lt;T&gt; = {</span><span class="s3">\n  </span><span class="s1">isOrigin: boolean</span><span class="s3">\n  </span><span class="s1">value: T</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type UnwrapPromise&lt;T&gt; = T extends Promise&lt;infer U&gt; ? U : T</span><span class="s3">\n\n</span><span class="s1">const globalInvokeCache = new Map&lt;string, Promise&lt;CoalescedInvoke&lt;unknown&gt;&gt;&gt;()</span><span class="s3">\n\n</span><span class="s1">export function withCoalescedInvoke&lt;F extends (...args: any) =&gt; any&gt;(</span><span class="s3">\n  </span><span class="s1">func: F</span><span class="s3">\n</span><span class="s1">): (</span><span class="s3">\n  </span><span class="s1">key: string,</span><span class="s3">\n  </span><span class="s1">args: Parameters&lt;F&gt;</span><span class="s3">\n</span><span class="s1">) =&gt; Promise&lt;CoalescedInvoke&lt;UnwrapPromise&lt;ReturnType&lt;F&gt;&gt;&gt;&gt; {</span><span class="s3">\n  </span><span class="s1">return async function (key: string, args: Parameters&lt;F&gt;) {</span><span class="s3">\n    </span><span class="s1">const entry = globalInvokeCache.get(key)</span><span class="s3">\n    </span><span class="s1">if (entry) {</span><span class="s3">\n      </span><span class="s1">return entry.then((res) =&gt; ({</span><span class="s3">\n        </span><span class="s1">isOrigin: false,</span><span class="s3">\n        </span><span class="s1">value: res.value as UnwrapPromise&lt;ReturnType&lt;F&gt;&gt;,</span><span class="s3">\n      </span><span class="s1">}))</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">async function __wrapper() {</span><span class="s3">\n      </span><span class="s1">return await func.apply(undefined, args)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const future = __wrapper()</span><span class="s3">\n      </span><span class="s1">.then((res) =&gt; {</span><span class="s3">\n        </span><span class="s1">globalInvokeCache.delete(key)</span><span class="s3">\n        </span><span class="s1">return { isOrigin: true, value: res as UnwrapPromise&lt;ReturnType&lt;F&gt;&gt; }</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">.catch((err) =&gt; {</span><span class="s3">\n        </span><span class="s1">globalInvokeCache.delete(key)</span><span class="s3">\n        </span><span class="s1">return Promise.reject(err)</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">globalInvokeCache.set(key, future)</span><span class="s3">\n    </span><span class="s1">return future</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;withCoalescedInvoke&quot;</span><span class="s0">,</span><span class="s1">&quot;globalInvokeCache&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;func&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;entry&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;isOrigin&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;__wrapper&quot;</span><span class="s0">,</span><span class="s1">&quot;apply&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;future&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;catch&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;reject&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;+BASgBA;;;eAAAA;;;AAFhB,MAAMC,oBAAoB,IAAIC;AAEvB,SAASF,oBACdG,IAAO;IAKP,OAAO,eAAgBC,GAAW,EAAEC,IAAmB;QACrD,MAAMC,QAAQL,kBAAkBM,GAAG,CAACH;QACpC,IAAIE,OAAO;YACT,OAAOA,MAAME,IAAI,CAAC,CAACC,MAAS,CAAA;oBAC1BC,UAAU;oBACVC,OAAOF,IAAIE,KAAK;gBAClB,CAAA;QACF;QAEA,eAAeC;YACb,OAAO,MAAMT,KAAKU,KAAK,CAACC,WAAWT;QACrC;QAEA,MAAMU,SAASH,YACZJ,IAAI,CAAC,CAACC;YACLR,kBAAkBe,MAAM,CAACZ;YACzB,OAAO;gBAAEM,UAAU;gBAAMC,OAAOF;YAAoC;QACtE,GACCQ,KAAK,CAAC,CAACC;YACNjB,kBAAkBe,MAAM,CAACZ;YACzB,OAAOe,QAAQC,MAAM,CAACF;QACxB;QACFjB,kBAAkBoB,GAAG,CAACjB,KAAKW;QAC3B,OAAOA;IACT;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>