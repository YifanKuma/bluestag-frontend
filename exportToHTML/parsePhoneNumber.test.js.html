<html>
<head>
<title>parsePhoneNumber.test.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #8c8c8c; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
parsePhoneNumber.test.js</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">_parsePhoneNumber from </span><span class="s2">'./parsePhoneNumber.js'</span>
<span class="s0">import </span><span class="s1">metadata from </span><span class="s2">'../metadata.min.json' </span><span class="s0">with </span><span class="s1">{ type: </span><span class="s2">'json' </span><span class="s1">}</span>

<span class="s0">function </span><span class="s1">parsePhoneNumber(...parameters) {</span>
	<span class="s1">parameters.push(metadata)</span>
	<span class="s0">return </span><span class="s1">_parsePhoneNumber.apply(</span><span class="s0">this</span><span class="s1">, parameters)</span>
<span class="s1">}</span>

<span class="s0">const </span><span class="s1">USE_NON_GEOGRAPHIC_COUNTRY_CODE = </span><span class="s0">false</span>

<span class="s1">describe(</span><span class="s2">'parsePhoneNumber'</span><span class="s1">, () =&gt; {</span>
	<span class="s1">it(</span><span class="s2">'should parse phone numbers from string'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parsePhoneNumber(</span><span class="s2">'Phone: 8 (800) 555 35 35.'</span><span class="s1">, </span><span class="s2">'RU'</span><span class="s1">).nationalNumber).to.equal(</span><span class="s2">'8005553535'</span><span class="s1">)</span>
		<span class="s1">expect(parsePhoneNumber(</span><span class="s2">'3'</span><span class="s1">, </span><span class="s2">'RU'</span><span class="s1">)).to.be.undefined</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should work in edge cases'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parsePhoneNumber(</span><span class="s2">''</span><span class="s1">)).to.be.undefined</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse phone numbers when invalid country code is passed'</span><span class="s1">, () =&gt; {</span>
		<span class="s1">expect(parsePhoneNumber(</span><span class="s2">'Phone: +7 (800) 555 35 35.'</span><span class="s1">, </span><span class="s2">'XX'</span><span class="s1">).nationalNumber).to.equal(</span><span class="s2">'8005553535'</span><span class="s1">)</span>
		<span class="s1">expect(parsePhoneNumber(</span><span class="s2">'Phone: 8 (800) 555-35-35.'</span><span class="s1">, </span><span class="s2">'XX'</span><span class="s1">)).to.be.undefined</span>
	<span class="s1">})</span>


	<span class="s1">it(</span><span class="s2">'should parse non-geographic numbering plan phone numbers (extended)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">phoneNumber = parsePhoneNumber(</span><span class="s2">'+870773111632'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.number).to.equal(</span><span class="s2">'+870773111632'</span><span class="s1">)</span>
		<span class="s0">if </span><span class="s1">(USE_NON_GEOGRAPHIC_COUNTRY_CODE) {</span>
			<span class="s1">expect(phoneNumber.country).to.equal(</span><span class="s2">'001'</span><span class="s1">)</span>
		<span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
			<span class="s1">expect(phoneNumber.country).to.be.undefined</span>
		<span class="s1">}</span>
		<span class="s1">expect(phoneNumber.countryCallingCode).to.equal(</span><span class="s2">'870'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should parse non-geographic numbering plan phone numbers (default country code) (extended)'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">phoneNumber = parsePhoneNumber(</span><span class="s2">'773111632'</span><span class="s1">, { defaultCallingCode: </span><span class="s2">'870' </span><span class="s1">})</span>
		<span class="s1">expect(phoneNumber.number).to.equal(</span><span class="s2">'+870773111632'</span><span class="s1">)</span>
		<span class="s0">if </span><span class="s1">(USE_NON_GEOGRAPHIC_COUNTRY_CODE) {</span>
			<span class="s1">expect(phoneNumber.country).to.equal(</span><span class="s2">'001'</span><span class="s1">)</span>
		<span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
			<span class="s1">expect(phoneNumber.country).to.be.undefined</span>
		<span class="s1">}</span>
		<span class="s1">expect(phoneNumber.countryCallingCode).to.equal(</span><span class="s2">'870'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should determine the possibility of non-geographic phone numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">phoneNumber = parsePhoneNumber(</span><span class="s2">'+870773111632'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.isPossible()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
		<span class="s0">const </span><span class="s1">phoneNumber2 = parsePhoneNumber(</span><span class="s2">'+8707731116321'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber2.isPossible()).to.equal(</span><span class="s0">false</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should support `extract: false` flag'</span><span class="s1">, () =&gt; {</span>
		<span class="s0">const </span><span class="s1">testCorrectness = (number, expectedResult) =&gt; {</span>
			<span class="s0">const </span><span class="s1">result = expect(parsePhoneNumber(number, { extract: </span><span class="s0">false</span><span class="s1">, defaultCountry: </span><span class="s2">'US' </span><span class="s1">}))</span>
			<span class="s0">if </span><span class="s1">(expectedResult) {</span>
				<span class="s1">result.to.not.be.undefined</span>
			<span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
				<span class="s1">result.to.be.undefined</span>
			<span class="s1">}</span>
		<span class="s1">}</span>
		<span class="s1">testCorrectness(</span><span class="s2">'Call: (213) 373-4253'</span><span class="s1">, </span><span class="s0">false</span><span class="s1">)</span>
		<span class="s1">testCorrectness(</span><span class="s2">'(213) 373-4253x'</span><span class="s1">, </span><span class="s0">false</span><span class="s1">)</span>
		<span class="s1">testCorrectness(</span><span class="s2">'(213) 373-4253'</span><span class="s1">, </span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">testCorrectness(</span><span class="s2">'- (213) 373-4253 -'</span><span class="s1">, </span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">testCorrectness(</span><span class="s2">'+1 (213) 373-4253'</span><span class="s1">, </span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">testCorrectness(</span><span class="s2">' +1 (213) 373-4253'</span><span class="s1">, </span><span class="s0">false</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should not prematurely strip a possible national prefix from Chinese numbers'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// https://gitlab.com/catamphetamine/libphonenumber-js/-/issues/57</span>
		<span class="s0">const </span><span class="s1">phoneNumber = parsePhoneNumber(</span><span class="s2">'+86123456789'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.isPossible()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.isValid()).to.equal(</span><span class="s0">false</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.nationalNumber).to.equal(</span><span class="s2">'123456789'</span><span class="s1">)</span>
	<span class="s1">})</span>

	<span class="s1">it(</span><span class="s2">'should handle the cases when multiple countries share the same country calling code and a phone number is possible in non-&quot;main&quot; country and is not possible in the &quot;main&quot; country'</span><span class="s1">, () =&gt; {</span>
		<span class="s3">// Tests that Californian numbers `+1310xxxx` are considered possible.</span>
		<span class="s3">// https://gitlab.com/catamphetamine/react-phone-number-input/-/issues/228#note_1872536721</span>

		<span class="s0">const </span><span class="s1">phoneNumber = parsePhoneNumber(</span><span class="s2">'+13100000'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.country).to.equal(</span><span class="s2">'CA'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.isPossible()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.isValid()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumber.nationalNumber).to.equal(</span><span class="s2">'3100000'</span><span class="s1">)</span>

		<span class="s0">const </span><span class="s1">phoneNumberLocal = parsePhoneNumber(</span><span class="s2">'3100000'</span><span class="s1">, </span><span class="s2">'CA'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumberLocal.country).to.equal(</span><span class="s2">'CA'</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumberLocal.isPossible()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumberLocal.isValid()).to.equal(</span><span class="s0">true</span><span class="s1">)</span>
		<span class="s1">expect(phoneNumberLocal.nationalNumber).to.equal(</span><span class="s2">'3100000'</span><span class="s1">)</span>
	<span class="s1">})</span>
<span class="s1">})</span>
</pre>
</body>
</html>