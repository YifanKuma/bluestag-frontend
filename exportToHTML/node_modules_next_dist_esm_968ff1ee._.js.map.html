<html>
<head>
<title>node_modules_next_dist_esm_968ff1ee._.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
.s4 { color: #0033b3;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
node_modules_next_dist_esm_968ff1ee._.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span>
  <span class="s1">&quot;version&quot;</span><span class="s0">: </span><span class="s2">3</span><span class="s0">,</span>
  <span class="s1">&quot;sources&quot;</span><span class="s0">: [],</span>
  <span class="s1">&quot;sections&quot;</span><span class="s0">: [</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/router-reducer/router-reducer-types.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { CacheNode } from '../../../shared/lib/app-router-context.shared-runtime'</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">FlightRouterState,</span><span class="s3">\n  </span><span class="s1">FlightSegmentPath,</span><span class="s3">\n</span><span class="s1">} from '../../../server/app-render/types'</span><span class="s3">\n</span><span class="s1">import type { FetchServerResponseResult } from './fetch-server-response'</span><span class="s3">\n\n</span><span class="s1">export const ACTION_REFRESH = 'refresh'</span><span class="s3">\n</span><span class="s1">export const ACTION_NAVIGATE = 'navigate'</span><span class="s3">\n</span><span class="s1">export const ACTION_RESTORE = 'restore'</span><span class="s3">\n</span><span class="s1">export const ACTION_SERVER_PATCH = 'server-patch'</span><span class="s3">\n</span><span class="s1">export const ACTION_PREFETCH = 'prefetch'</span><span class="s3">\n</span><span class="s1">export const ACTION_HMR_REFRESH = 'hmr-refresh'</span><span class="s3">\n</span><span class="s1">export const ACTION_SERVER_ACTION = 'server-action'</span><span class="s3">\n\n</span><span class="s1">export type RouterChangeByServerResponse = ({</span><span class="s3">\n  </span><span class="s1">navigatedAt,</span><span class="s3">\n  </span><span class="s1">previousTree,</span><span class="s3">\n  </span><span class="s1">serverResponse,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">navigatedAt: number</span><span class="s3">\n  </span><span class="s1">previousTree: FlightRouterState</span><span class="s3">\n  </span><span class="s1">serverResponse: FetchServerResponseResult</span><span class="s3">\n</span><span class="s1">}) =&gt; void</span><span class="s3">\n\n</span><span class="s1">export interface Mutable {</span><span class="s3">\n  </span><span class="s1">mpaNavigation?: boolean</span><span class="s3">\n  </span><span class="s1">patchedTree?: FlightRouterState</span><span class="s3">\n  </span><span class="s1">canonicalUrl?: string</span><span class="s3">\n  </span><span class="s1">scrollableSegments?: FlightSegmentPath[]</span><span class="s3">\n  </span><span class="s1">pendingPush?: boolean</span><span class="s3">\n  </span><span class="s1">cache?: CacheNode</span><span class="s3">\n  </span><span class="s1">prefetchCache?: AppRouterState['prefetchCache']</span><span class="s3">\n  </span><span class="s1">hashFragment?: string</span><span class="s3">\n  </span><span class="s1">shouldScroll?: boolean</span><span class="s3">\n  </span><span class="s1">preserveCustomHistoryState?: boolean</span><span class="s3">\n  </span><span class="s1">onlyHashChange?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface ServerActionMutable extends Mutable {</span><span class="s3">\n  </span><span class="s1">inFlightServerAction?: Promise&lt;any&gt; | null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Refresh triggers a refresh of the full page data.</span><span class="s3">\n </span><span class="s1">* - fetches the Flight data and fills rsc at the root of the cache.</span><span class="s3">\n </span><span class="s1">* - The router state is updated at the root.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export interface RefreshAction {</span><span class="s3">\n  </span><span class="s1">type: typeof ACTION_REFRESH</span><span class="s3">\n  </span><span class="s1">origin: Location['origin']</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface HmrRefreshAction {</span><span class="s3">\n  </span><span class="s1">type: typeof ACTION_HMR_REFRESH</span><span class="s3">\n  </span><span class="s1">origin: Location['origin']</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type ServerActionDispatcher = (</span><span class="s3">\n  </span><span class="s1">args: Omit&lt;</span><span class="s3">\n    </span><span class="s1">ServerActionAction,</span><span class="s3">\n    </span><span class="s1">'type' | 'mutable' | 'navigate' | 'changeByServerResponse' | 'cache'</span><span class="s3">\n  </span><span class="s1">&gt;</span><span class="s3">\n</span><span class="s1">) =&gt; void</span><span class="s3">\n\n</span><span class="s1">export interface ServerActionAction {</span><span class="s3">\n  </span><span class="s1">type: typeof ACTION_SERVER_ACTION</span><span class="s3">\n  </span><span class="s1">actionId: string</span><span class="s3">\n  </span><span class="s1">actionArgs: any[]</span><span class="s3">\n  </span><span class="s1">resolve: (value: any) =&gt; void</span><span class="s3">\n  </span><span class="s1">reject: (reason?: any) =&gt; void</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Navigate triggers a navigation to the provided url. It supports two types: `push` and `replace`.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* `navigateType`:</span><span class="s3">\n </span><span class="s1">* - `push` - pushes a new history entry in the browser history</span><span class="s3">\n </span><span class="s1">* - `replace` - replaces the current history entry in the browser history</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Navigate has multiple cache heuristics:</span><span class="s3">\n </span><span class="s1">* - page was prefetched</span><span class="s3">\n </span><span class="s1">*  - Apply router state tree from prefetch</span><span class="s3">\n </span><span class="s1">*  - Apply Flight data from prefetch to the cache</span><span class="s3">\n </span><span class="s1">*  - If Flight data is a string, it's a redirect and the state is updated to trigger a redirect</span><span class="s3">\n </span><span class="s1">*  - Check if hard navigation is needed</span><span class="s3">\n </span><span class="s1">*    - Hard navigation happens when a dynamic parameter below the common layout changed</span><span class="s3">\n </span><span class="s1">*    - When hard navigation is needed the cache is invalidated below the flightSegmentPath</span><span class="s3">\n </span><span class="s1">*    - The missing cache nodes of the page will be fetched in layout-router and trigger the SERVER_PATCH action</span><span class="s3">\n </span><span class="s1">*  - If hard navigation is not needed</span><span class="s3">\n </span><span class="s1">*    - The cache is reused</span><span class="s3">\n </span><span class="s1">*    - If any cache nodes are missing they'll be fetched in layout-router and trigger the SERVER_PATCH action</span><span class="s3">\n </span><span class="s1">* - page was not prefetched</span><span class="s3">\n </span><span class="s1">*  - The navigate was called from `next/router` (`router.push()` / `router.replace()`) / `next/link` without prefetched data available (e.g. the prefetch didn't come back from the server before clicking the link)</span><span class="s3">\n </span><span class="s1">*    - Flight data is fetched in the reducer (suspends the reducer)</span><span class="s3">\n </span><span class="s1">*    - Router state tree is created based on Flight data</span><span class="s3">\n </span><span class="s1">*    - Cache is filled based on the Flight data</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Above steps explain 3 cases:</span><span class="s3">\n </span><span class="s1">* - `soft` - Reuses the existing cache and fetches missing nodes in layout-router.</span><span class="s3">\n </span><span class="s1">* - `hard` - Creates a new cache where cache nodes are removed below the common layout and fetches missing nodes in layout-router.</span><span class="s3">\n </span><span class="s1">* - `optimistic` (explicit no prefetch) - Creates a new cache and kicks off the data fetch in the reducer. The data fetch is awaited in the layout-router.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export interface NavigateAction {</span><span class="s3">\n  </span><span class="s1">type: typeof ACTION_NAVIGATE</span><span class="s3">\n  </span><span class="s1">url: URL</span><span class="s3">\n  </span><span class="s1">isExternalUrl: boolean</span><span class="s3">\n  </span><span class="s1">locationSearch: Location['search']</span><span class="s3">\n  </span><span class="s1">navigateType: 'push' | 'replace'</span><span class="s3">\n  </span><span class="s1">shouldScroll: boolean</span><span class="s3">\n  </span><span class="s1">allowAliasing: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Restore applies the provided router state.</span><span class="s3">\n </span><span class="s1">* - Used for `popstate` (back/forward navigation) where a known router state has to be applied.</span><span class="s3">\n </span><span class="s1">* - Also used when syncing the router state with `pushState`/`replaceState` calls.</span><span class="s3">\n </span><span class="s1">* - Router state is applied as-is from the history state, if available.</span><span class="s3">\n </span><span class="s1">* - If the history state does not contain the router state, the existing router state is used.</span><span class="s3">\n </span><span class="s1">* - If any cache node is missing it will be fetched in layout-router during rendering and the server-patch case.</span><span class="s3">\n </span><span class="s1">* - If existing cache nodes match these are used.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export interface RestoreAction {</span><span class="s3">\n  </span><span class="s1">type: typeof ACTION_RESTORE</span><span class="s3">\n  </span><span class="s1">url: URL</span><span class="s3">\n  </span><span class="s1">tree: FlightRouterState | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Server-patch applies the provided Flight data to the cache and router tree.</span><span class="s3">\n </span><span class="s1">* - Only triggered in layout-router.</span><span class="s3">\n </span><span class="s1">* - Creates a new cache and router state with the Flight data applied.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export interface ServerPatchAction {</span><span class="s3">\n  </span><span class="s1">type: typeof ACTION_SERVER_PATCH</span><span class="s3">\n  </span><span class="s1">navigatedAt: number</span><span class="s3">\n  </span><span class="s1">serverResponse: FetchServerResponseResult</span><span class="s3">\n  </span><span class="s1">previousTree: FlightRouterState</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* PrefetchKind defines the type of prefetching that should be done.</span><span class="s3">\n </span><span class="s1">* - `auto` - if the page is dynamic, prefetch the page data partially, if static prefetch the page data fully.</span><span class="s3">\n </span><span class="s1">* - `full` - prefetch the page data fully.</span><span class="s3">\n </span><span class="s1">* - `temporary` - a temporary prefetch entry is added to the cache, this is used when prefetch={false} is used in next/link or when you push a route programmatically.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">export enum PrefetchKind {</span><span class="s3">\n  </span><span class="s1">AUTO = 'auto',</span><span class="s3">\n  </span><span class="s1">FULL = 'full',</span><span class="s3">\n  </span><span class="s1">TEMPORARY = 'temporary',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Prefetch adds the provided FlightData to the prefetch cache</span><span class="s3">\n </span><span class="s1">* - Creates the router state tree based on the patch in FlightData</span><span class="s3">\n </span><span class="s1">* - Adds the FlightData to the prefetch cache</span><span class="s3">\n </span><span class="s1">* - In ACTION_NAVIGATE the prefetch cache is checked and the router state tree and FlightData are applied.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export interface PrefetchAction {</span><span class="s3">\n  </span><span class="s1">type: typeof ACTION_PREFETCH</span><span class="s3">\n  </span><span class="s1">url: URL</span><span class="s3">\n  </span><span class="s1">kind: PrefetchKind</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface PushRef {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If the app-router should push a new history entry in app-router's useEffect()</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pendingPush: boolean</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Multi-page navigation through location.href.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">mpaNavigation: boolean</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Skip applying the router state to the browser history state.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">preserveCustomHistoryState: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type FocusAndScrollRef = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If focus and scroll should be set in the layout-router's useEffect()</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">apply: boolean</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The hash fragment that should be scrolled to.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">hashFragment: string | null</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The paths of the segments that should be focused.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">segmentPaths: FlightSegmentPath[]</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If only the URLs hash fragment changed</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">onlyHashChange: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type PrefetchCacheEntry = {</span><span class="s3">\n  </span><span class="s1">treeAtTimeOfPrefetch: FlightRouterState</span><span class="s3">\n  </span><span class="s1">data: Promise&lt;FetchServerResponseResult&gt;</span><span class="s3">\n  </span><span class="s1">kind: PrefetchKind</span><span class="s3">\n  </span><span class="s1">prefetchTime: number</span><span class="s3">\n  </span><span class="s1">staleTime: number</span><span class="s3">\n  </span><span class="s1">lastUsedTime: number | null</span><span class="s3">\n  </span><span class="s1">key: string</span><span class="s3">\n  </span><span class="s1">status: PrefetchCacheEntryStatus</span><span class="s3">\n  </span><span class="s1">url: URL</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export enum PrefetchCacheEntryStatus {</span><span class="s3">\n  </span><span class="s1">fresh = 'fresh',</span><span class="s3">\n  </span><span class="s1">reusable = 'reusable',</span><span class="s3">\n  </span><span class="s1">expired = 'expired',</span><span class="s3">\n  </span><span class="s1">stale = 'stale',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Handles keeping the state of app-router.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export type AppRouterState = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The router state, this is written into the history state in app-router using replaceState/pushState.</span><span class="s3">\n   </span><span class="s1">* - Has to be serializable as it is written into the history state.</span><span class="s3">\n   </span><span class="s1">* - Holds which segments and parallel routes are shown on the screen.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">tree: FlightRouterState</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The cache holds React nodes for every segment that is shown on screen as well as previously shown segments.</span><span class="s3">\n   </span><span class="s1">* It also holds in-progress data requests.</span><span class="s3">\n   </span><span class="s1">* Prefetched data is stored separately in `prefetchCache`, that is applied during ACTION_NAVIGATE.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">cache: CacheNode</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Cache that holds prefetched Flight responses keyed by url.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">prefetchCache: Map&lt;string, PrefetchCacheEntry&gt;</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Decides if the update should create a new history entry and if the navigation has to trigger a browser navigation.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pushRef: PushRef</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Decides if the update should apply scroll and focus management.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">focusAndScrollRef: FocusAndScrollRef</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The canonical url that is pushed/replaced.</span><span class="s3">\n   </span><span class="s1">* - This is the url you see in the browser.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">canonicalUrl: string</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The underlying </span><span class="s3">\&quot;</span><span class="s1">url</span><span class="s3">\&quot; </span><span class="s1">representing the UI state, which is used for intercepting routes.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">nextUrl: string | null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type ReadonlyReducerState = Readonly&lt;AppRouterState&gt;</span><span class="s3">\n</span><span class="s1">export type ReducerState = Promise&lt;AppRouterState&gt; | AppRouterState</span><span class="s3">\n</span><span class="s1">export type ReducerActions = Readonly&lt;</span><span class="s3">\n  </span><span class="s1">| RefreshAction</span><span class="s3">\n  </span><span class="s1">| NavigateAction</span><span class="s3">\n  </span><span class="s1">| RestoreAction</span><span class="s3">\n  </span><span class="s1">| ServerPatchAction</span><span class="s3">\n  </span><span class="s1">| PrefetchAction</span><span class="s3">\n  </span><span class="s1">| HmrRefreshAction</span><span class="s3">\n  </span><span class="s1">| ServerActionAction</span><span class="s3">\n</span><span class="s1">&gt;</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ACTION_REFRESH&quot;</span><span class="s0">,</span><span class="s1">&quot;ACTION_NAVIGATE&quot;</span><span class="s0">,</span><span class="s1">&quot;ACTION_RESTORE&quot;</span><span class="s0">,</span><span class="s1">&quot;ACTION_SERVER_PATCH&quot;</span><span class="s0">,</span><span class="s1">&quot;ACTION_PREFETCH&quot;</span><span class="s0">,</span><span class="s1">&quot;ACTION_HMR_REFRESH&quot;</span><span class="s0">,</span><span class="s1">&quot;ACTION_SERVER_ACTION&quot;</span><span class="s0">,</span><span class="s1">&quot;PrefetchKind&quot;</span><span class="s0">,</span><span class="s1">&quot;PrefetchCacheEntryStatus&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;;;;;;AAOO,MAAMA,iBAAiB,UAAS;AAChC,MAAMC,kBAAkB,WAAU;AAClC,MAAMC,iBAAiB,UAAS;AAChC,MAAMC,sBAAsB,eAAc;AAC1C,MAAMC,kBAAkB,WAAU;AAClC,MAAMC,qBAAqB,cAAa;AACxC,MAAMC,uBAAuB,gBAAe;AAsI5C,IAAKC,eAAAA,WAAAA,GAAAA,SAAAA,YAAAA;;;;WAAAA;MAIX;AA4DM,IAAKC,2BAAAA,WAAAA,GAAAA,SAAAA,wBAAAA;;;;;WAAAA;MAKX&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">48</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/app-router-headers.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export const RSC_HEADER = 'rsc' as const</span><span class="s3">\n</span><span class="s1">export const ACTION_HEADER = 'next-action' as const</span><span class="s3">\n</span><span class="s1">// TODO: Instead of sending the full router state, we only need to send the</span><span class="s3">\n</span><span class="s1">// segment path. Saves bytes. Then we could also use this field for segment</span><span class="s3">\n</span><span class="s1">// prefetches, which also need to specify a particular segment.</span><span class="s3">\n</span><span class="s1">export const NEXT_ROUTER_STATE_TREE_HEADER = 'next-router-state-tree' as const</span><span class="s3">\n</span><span class="s1">export const NEXT_ROUTER_PREFETCH_HEADER = 'next-router-prefetch' as const</span><span class="s3">\n</span><span class="s1">// This contains the path to the segment being prefetched.</span><span class="s3">\n</span><span class="s1">// TODO: If we change next-router-state-tree to be a segment path, we can use</span><span class="s3">\n</span><span class="s1">// that instead. Then next-router-prefetch and next-router-segment-prefetch can</span><span class="s3">\n</span><span class="s1">// be merged into a single enum.</span><span class="s3">\n</span><span class="s1">export const NEXT_ROUTER_SEGMENT_PREFETCH_HEADER =</span><span class="s3">\n  </span><span class="s1">'next-router-segment-prefetch' as const</span><span class="s3">\n</span><span class="s1">export const NEXT_HMR_REFRESH_HEADER = 'next-hmr-refresh' as const</span><span class="s3">\n</span><span class="s1">export const NEXT_HMR_REFRESH_HASH_COOKIE = '__next_hmr_refresh_hash__' as const</span><span class="s3">\n</span><span class="s1">export const NEXT_URL = 'next-url' as const</span><span class="s3">\n</span><span class="s1">export const RSC_CONTENT_TYPE_HEADER = 'text/x-component' as const</span><span class="s3">\n\n</span><span class="s1">export const FLIGHT_HEADERS = [</span><span class="s3">\n  </span><span class="s1">RSC_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_ROUTER_STATE_TREE_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_ROUTER_PREFETCH_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_HMR_REFRESH_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_ROUTER_SEGMENT_PREFETCH_HEADER,</span><span class="s3">\n</span><span class="s1">] as const</span><span class="s3">\n\n</span><span class="s1">export const NEXT_RSC_UNION_QUERY = '_rsc' as const</span><span class="s3">\n\n</span><span class="s1">export const NEXT_ROUTER_STALE_TIME_HEADER = 'x-nextjs-stale-time' as const</span><span class="s3">\n</span><span class="s1">export const NEXT_DID_POSTPONE_HEADER = 'x-nextjs-postponed' as const</span><span class="s3">\n</span><span class="s1">export const NEXT_REWRITTEN_PATH_HEADER = 'x-nextjs-rewritten-path' as const</span><span class="s3">\n</span><span class="s1">export const NEXT_REWRITTEN_QUERY_HEADER = 'x-nextjs-rewritten-query' as const</span><span class="s3">\n</span><span class="s1">export const NEXT_IS_PRERENDER_HEADER = 'x-nextjs-prerender' as const</span><span class="s3">\n</span><span class="s1">export const NEXT_ACTION_NOT_FOUND_HEADER = 'x-nextjs-action-not-found' as const</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RSC_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;ACTION_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_STATE_TREE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_PREFETCH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_SEGMENT_PREFETCH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_HMR_REFRESH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_HMR_REFRESH_HASH_COOKIE&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_URL&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;FLIGHT_HEADERS&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RSC_UNION_QUERY&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_STALE_TIME_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_DID_POSTPONE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_REWRITTEN_PATH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_REWRITTEN_QUERY_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_IS_PRERENDER_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ACTION_NOT_FOUND_HEADER&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAO,MAAMA,aAAa,MAAc;AACjC,MAAMC,gBAAgB,cAAsB;AAI5C,MAAMC,gCAAgC,yBAAiC;AACvE,MAAMC,8BAA8B,uBAA+B;AAKnE,MAAMC,sCACX,+BAAuC;AAClC,MAAMC,0BAA0B,mBAA2B;AAC3D,MAAMC,+BAA+B,4BAAoC;AACzE,MAAMC,WAAW,WAAmB;AACpC,MAAMC,0BAA0B,mBAA2B;AAE3D,MAAMC,iBAAiB;IAC5BT;IACAE;IACAC;IACAE;IACAD;CACD,CAAS;AAEH,MAAMM,uBAAuB,OAAe;AAE5C,MAAMC,gCAAgC,sBAA8B;AACpE,MAAMC,2BAA2B,qBAA6B;AAC9D,MAAMC,6BAA6B,0BAAkC;AACrE,MAAMC,8BAA8B,2BAAmC;AACvE,MAAMC,2BAA2B,qBAA6B;AAC9D,MAAMC,+BAA+B,4BAAoC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">111</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/is-thenable.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Check to see if a value is Thenable.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param promise the maybe-thenable value</span><span class="s3">\n </span><span class="s1">* @returns true if the value is thenable</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function isThenable&lt;T = unknown&gt;(</span><span class="s3">\n  </span><span class="s1">promise: Promise&lt;T&gt; | T</span><span class="s3">\n</span><span class="s1">): promise is Promise&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">promise !== null &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof promise === 'object' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">'then' in promise &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof promise.then === 'function'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isThenable&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;;;CAKC,GACD;;;;AAAO,SAASA,WACdC,OAAuB;IAEvB,OACEA,YAAY,QACZ,OAAOA,YAAY,YACnB,UAAUA,WACV,OAAOA,QAAQC,IAAI,KAAK;AAE5B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">127</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/next-devtools/userspace/use-app-dev-rendering-indicator.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">import { useEffect, useTransition } from 'react'</span><span class="s3">\n</span><span class="s1">import { dispatcher } from 'next/dist/compiled/next-devtools'</span><span class="s3">\n\n</span><span class="s1">export const useAppDevRenderingIndicator = () =&gt; {</span><span class="s3">\n  </span><span class="s1">const [isPending, startTransition] = useTransition()</span><span class="s3">\n\n  </span><span class="s1">useEffect(() =&gt; {</span><span class="s3">\n    </span><span class="s1">if (isPending) {</span><span class="s3">\n      </span><span class="s1">dispatcher.renderingIndicatorShow()</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">dispatcher.renderingIndicatorHide()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}, [isPending])</span><span class="s3">\n\n  </span><span class="s1">return startTransition</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;useEffect&quot;</span><span class="s0">,</span><span class="s1">&quot;useTransition&quot;</span><span class="s0">,</span><span class="s1">&quot;dispatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;useAppDevRenderingIndicator&quot;</span><span class="s0">,</span><span class="s1">&quot;isPending&quot;</span><span class="s0">,</span><span class="s1">&quot;startTransition&quot;</span><span class="s0">,</span><span class="s1">&quot;renderingIndicatorShow&quot;</span><span class="s0">,</span><span class="s1">&quot;renderingIndicatorHide&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAEA,SAASA,SAAS,EAAEC,aAAa,QAAQ,QAAO;AAChD,SAASC,UAAU,QAAQ,mCAAkC;AAH7D;;;AAKO,MAAMC,8BAA8B;IACzC,MAAM,CAACC,WAAWC,gBAAgB,OAAGJ,sNAAAA;QAErCD,kNAAAA,EAAU;QACR,IAAII,WAAW;YACbF,mLAAAA,CAAWI,sBAAsB;QACnC,OAAO;YACLJ,mLAAAA,CAAWK,sBAAsB;QACnC;IACF,GAAG;QAACH;KAAU;IAEd,OAAOC;AACT,EAAC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">153</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/use-action-queue.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { Dispatch } from 'react'</span><span class="s3">\n</span><span class="s1">import React, { use } from 'react'</span><span class="s3">\n</span><span class="s1">import { isThenable } from '../../shared/lib/is-thenable'</span><span class="s3">\n</span><span class="s1">import type { AppRouterActionQueue } from './app-router-instance'</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">AppRouterState,</span><span class="s3">\n  </span><span class="s1">ReducerActions,</span><span class="s3">\n  </span><span class="s1">ReducerState,</span><span class="s3">\n</span><span class="s1">} from './router-reducer/router-reducer-types'</span><span class="s3">\n\n</span><span class="s1">// The app router state lives outside of React, so we can import the dispatch</span><span class="s3">\n</span><span class="s1">// method directly wherever we need it, rather than passing it around via props</span><span class="s3">\n</span><span class="s1">// or context.</span><span class="s3">\n</span><span class="s1">let dispatch: Dispatch&lt;ReducerActions&gt; | null = null</span><span class="s3">\n\n</span><span class="s1">export function dispatchAppRouterAction(action: ReducerActions) {</span><span class="s3">\n  </span><span class="s1">if (dispatch === null) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">'Internal Next.js error: Router action dispatched before initialization.'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">dispatch(action)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function useActionQueue(</span><span class="s3">\n  </span><span class="s1">actionQueue: AppRouterActionQueue</span><span class="s3">\n</span><span class="s1">): AppRouterState {</span><span class="s3">\n  </span><span class="s1">const [state, setState] = React.useState&lt;ReducerState&gt;(actionQueue.state)</span><span class="s3">\n\n  </span><span class="s1">// Because of a known issue that requires to decode Flight streams inside the</span><span class="s3">\n  </span><span class="s1">// render phase, we have to be a bit clever and assign the dispatch method to</span><span class="s3">\n  </span><span class="s1">// a module-level variable upon initialization. The useState hook in this</span><span class="s3">\n  </span><span class="s1">// module only exists to synchronize state that lives outside of React.</span><span class="s3">\n  </span><span class="s1">// Ideally, what we'd do instead is pass the state as a prop to root.render;</span><span class="s3">\n  </span><span class="s1">// this is conceptually how we're modeling the app router state, despite the</span><span class="s3">\n  </span><span class="s1">// weird implementation details.</span><span class="s3">\n  </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n    </span><span class="s1">const { useAppDevRenderingIndicator } =</span><span class="s3">\n      </span><span class="s1">require('../../next-devtools/userspace/use-app-dev-rendering-indicator') as typeof import('../../next-devtools/userspace/use-app-dev-rendering-indicator')</span><span class="s3">\n    </span><span class="s1">// eslint-disable-next-line react-hooks/rules-of-hooks</span><span class="s3">\n    </span><span class="s1">const appDevRenderingIndicator = useAppDevRenderingIndicator()</span><span class="s3">\n\n    </span><span class="s1">dispatch = (action: ReducerActions) =&gt; {</span><span class="s3">\n      </span><span class="s1">appDevRenderingIndicator(() =&gt; {</span><span class="s3">\n        </span><span class="s1">actionQueue.dispatch(action, setState)</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">dispatch = (action: ReducerActions) =&gt;</span><span class="s3">\n      </span><span class="s1">actionQueue.dispatch(action, setState)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return isThenable(state) ? use(state) : state</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;React&quot;</span><span class="s0">,</span><span class="s1">&quot;use&quot;</span><span class="s0">,</span><span class="s1">&quot;isThenable&quot;</span><span class="s0">,</span><span class="s1">&quot;dispatch&quot;</span><span class="s0">,</span><span class="s1">&quot;dispatchAppRouterAction&quot;</span><span class="s0">,</span><span class="s1">&quot;action&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;useActionQueue&quot;</span><span class="s0">,</span><span class="s1">&quot;actionQueue&quot;</span><span class="s0">,</span><span class="s1">&quot;state&quot;</span><span class="s0">,</span><span class="s1">&quot;setState&quot;</span><span class="s0">,</span><span class="s1">&quot;useState&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;useAppDevRenderingIndicator&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;appDevRenderingIndicator&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AACA,OAAOA,SAASC,GAAG,QAAQ,QAAO;AAClC,SAASC,UAAU,QAAQ,+BAA8B;;;AAQzD,6EAA6E;AAC7E,+EAA+E;AAC/E,cAAc;AACd,IAAIC,WAA4C;AAEzC,SAASC,wBAAwBC,MAAsB;IAC5D,IAAIF,aAAa,MAAM;QACrB,MAAM,OAAA,cAEL,CAFK,IAAIG,MACR,4EADI,qBAAA;mBAAA;wBAAA;0BAAA;QAEN;IACF;IACAH,SAASE;AACX;AAEO,SAASE,eACdC,WAAiC;IAEjC,MAAM,CAACC,OAAOC,SAAS,GAAGV,gNAAAA,CAAMW,QAAQ,CAAeH,YAAYC,KAAK;IAExE,6EAA6E;IAC7E,6EAA6E;IAC7E,yEAAyE;IACzE,uEAAuE;IACvE,4EAA4E;IAC5E,4EAA4E;IAC5E,gCAAgC;IAChC,IAAIG,QAAQC,GAAG,CAACC,QAAQ,KAAK,WAAc;QACzC,MAAM,EAAEC,2BAA2B,EAAE,GACnCC,QAAQ;QACV,sDAAsD;QACtD,MAAMC,2BAA2BF;QAEjCZ,WAAW,CAACE;YACVY,yBAAyB;gBACvBT,YAAYL,QAAQ,CAACE,QAAQK;YAC/B;QACF;IACF,OAAO;;IAKP,WAAOR,oLAAAA,EAAWO,aAASR,4MAAAA,EAAIQ,SAASA;AAC1C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">203</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/app-call-server.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { startTransition } from 'react'</span><span class="s3">\n</span><span class="s1">import { ACTION_SERVER_ACTION } from './components/router-reducer/router-reducer-types'</span><span class="s3">\n</span><span class="s1">import { dispatchAppRouterAction } from './components/use-action-queue'</span><span class="s3">\n\n</span><span class="s1">export async function callServer(actionId: string, actionArgs: any[]) {</span><span class="s3">\n  </span><span class="s1">return new Promise((resolve, reject) =&gt; {</span><span class="s3">\n    </span><span class="s1">startTransition(() =&gt; {</span><span class="s3">\n      </span><span class="s1">dispatchAppRouterAction({</span><span class="s3">\n        </span><span class="s1">type: ACTION_SERVER_ACTION,</span><span class="s3">\n        </span><span class="s1">actionId,</span><span class="s3">\n        </span><span class="s1">actionArgs,</span><span class="s3">\n        </span><span class="s1">resolve,</span><span class="s3">\n        </span><span class="s1">reject,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;startTransition&quot;</span><span class="s0">,</span><span class="s1">&quot;ACTION_SERVER_ACTION&quot;</span><span class="s0">,</span><span class="s1">&quot;dispatchAppRouterAction&quot;</span><span class="s0">,</span><span class="s1">&quot;callServer&quot;</span><span class="s0">,</span><span class="s1">&quot;actionId&quot;</span><span class="s0">,</span><span class="s1">&quot;actionArgs&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;reject&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,eAAe,QAAQ,QAAO;AACvC,SAASC,oBAAoB,QAAQ,mDAAkD;AACvF,SAASC,uBAAuB,QAAQ,gCAA+B;;;;AAEhE,eAAeC,WAAWC,QAAgB,EAAEC,UAAiB;IAClE,OAAO,IAAIC,QAAQ,CAACC,SAASC;YAC3BR,wNAAAA,EAAgB;gBACdE,gNAAAA,EAAwB;gBACtBO,MAAMR,sOAAAA;gBACNG;gBACAC;gBACAE;gBACAC;YACF;QACF;IACF;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">230</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/app-find-source-map-url.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const basePath = process.env.__NEXT_ROUTER_BASEPATH || ''</span><span class="s3">\n</span><span class="s1">const pathname = `${basePath}/__nextjs_source-map`</span><span class="s3">\n\n</span><span class="s1">export const findSourceMapURL =</span><span class="s3">\n  </span><span class="s1">process.env.NODE_ENV === 'development'</span><span class="s3">\n    </span><span class="s1">? function findSourceMapURL(filename: string): string | null {</span><span class="s3">\n        </span><span class="s1">if (filename === '') {</span><span class="s3">\n          </span><span class="s1">return null</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">filename.startsWith(document.location.origin) &amp;&amp;</span><span class="s3">\n          </span><span class="s1">filename.includes('/_next/static')</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">// This is a request for a client chunk. This can only happen when</span><span class="s3">\n          </span><span class="s1">// using Turbopack. In this case, since we control how those source</span><span class="s3">\n          </span><span class="s1">// maps are generated, we can safely assume that the sourceMappingURL</span><span class="s3">\n          </span><span class="s1">// is relative to the filename, with an added `.map` extension. The</span><span class="s3">\n          </span><span class="s1">// browser can just request this file, and it gets served through the</span><span class="s3">\n          </span><span class="s1">// normal dev server, without the need to route this through</span><span class="s3">\n          </span><span class="s1">// the `/__nextjs_source-map` dev middleware.</span><span class="s3">\n          </span><span class="s1">return `${filename}.map`</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">const url = new URL(pathname, document.location.origin)</span><span class="s3">\n        </span><span class="s1">url.searchParams.set('filename', filename)</span><span class="s3">\n\n        </span><span class="s1">return url.href</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">: undefined</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;basePath&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_ROUTER_BASEPATH&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;findSourceMapURL&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;filename&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;document&quot;</span><span class="s0">,</span><span class="s1">&quot;location&quot;</span><span class="s0">,</span><span class="s1">&quot;origin&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;searchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;href&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,MAAMA,WAAWC,QAAQC,GAAG,CAACC,sBAAsB,MAAI;AACvD,MAAMC,WAAY,KAAEJ,WAAS;AAEtB,MAAMK,mBACXJ,QAAQC,GAAG,CAACI,QAAQ,KAAK,cACrB,SAASD,iBAAiBE,QAAgB;IACxC,IAAIA,aAAa,IAAI;QACnB,OAAO;IACT;IAEA,IACEA,SAASC,UAAU,CAACC,SAASC,QAAQ,CAACC,MAAM,KAC5CJ,SAASK,QAAQ,CAAC,kBAClB;QACA,kEAAkE;QAClE,mEAAmE;QACnE,qEAAqE;QACrE,mEAAmE;QACnE,qEAAqE;QACrE,4DAA4D;QAC5D,6CAA6C;QAC7C,OAAQ,KAAEL,WAAS;IACrB;IAEA,MAAMM,MAAM,IAAIC,IAAIV,UAAUK,SAASC,QAAQ,CAACC,MAAM;IACtDE,IAAIE,YAAY,CAACC,GAAG,CAAC,YAAYT;IAEjC,OAAOM,IAAII,IAAI;AACjB,IACAC,UAAS&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">258</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/segment.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { Segment } from '../../server/app-render/types'</span><span class="s3">\n\n</span><span class="s1">export function isGroupSegment(segment: string) {</span><span class="s3">\n  </span><span class="s1">// Use array[0] for performant purpose</span><span class="s3">\n  </span><span class="s1">return segment[0] === '(' &amp;&amp; segment.endsWith(')')</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isParallelRouteSegment(segment: string) {</span><span class="s3">\n  </span><span class="s1">return segment.startsWith('@') &amp;&amp; segment !== '@children'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function addSearchParamsIfPageSegment(</span><span class="s3">\n  </span><span class="s1">segment: Segment,</span><span class="s3">\n  </span><span class="s1">searchParams: Record&lt;string, string | string[] | undefined&gt;</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const isPageSegment = segment.includes(PAGE_SEGMENT_KEY)</span><span class="s3">\n\n  </span><span class="s1">if (isPageSegment) {</span><span class="s3">\n    </span><span class="s1">const stringifiedQuery = JSON.stringify(searchParams)</span><span class="s3">\n    </span><span class="s1">return stringifiedQuery !== '{}'</span><span class="s3">\n      </span><span class="s1">? PAGE_SEGMENT_KEY + '?' + stringifiedQuery</span><span class="s3">\n      </span><span class="s1">: PAGE_SEGMENT_KEY</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return segment</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const PAGE_SEGMENT_KEY = '__PAGE__'</span><span class="s3">\n</span><span class="s1">export const DEFAULT_SEGMENT_KEY = '__DEFAULT__'</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isGroupSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;isParallelRouteSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;addSearchParamsIfPageSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;searchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;isPageSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGE_SEGMENT_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;stringifiedQuery&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;DEFAULT_SEGMENT_KEY&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;AAEO,SAASA,eAAeC,OAAe;IAC5C,sCAAsC;IACtC,OAAOA,OAAO,CAAC,EAAE,KAAK,OAAOA,QAAQC,QAAQ,CAAC;AAChD;AAEO,SAASC,uBAAuBF,OAAe;IACpD,OAAOA,QAAQG,UAAU,CAAC,QAAQH,YAAY;AAChD;AAEO,SAASI,6BACdJ,OAAgB,EAChBK,YAA2D;IAE3D,MAAMC,gBAAgBN,QAAQO,QAAQ,CAACC;IAEvC,IAAIF,eAAe;QACjB,MAAMG,mBAAmBC,KAAKC,SAAS,CAACN;QACxC,OAAOI,qBAAqB,OACxBD,mBAAmB,MAAMC,mBACzBD;IACN;IAEA,OAAOR;AACT;AAEO,MAAMQ,mBAAmB,WAAU;AACnC,MAAMI,sBAAsB,cAAa&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">291</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/flight-data-helpers.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type {</span><span class="s3">\n  </span><span class="s1">CacheNodeSeedData,</span><span class="s3">\n  </span><span class="s1">FlightData,</span><span class="s3">\n  </span><span class="s1">FlightDataPath,</span><span class="s3">\n  </span><span class="s1">FlightRouterState,</span><span class="s3">\n  </span><span class="s1">FlightSegmentPath,</span><span class="s3">\n  </span><span class="s1">Segment,</span><span class="s3">\n</span><span class="s1">} from '../server/app-render/types'</span><span class="s3">\n</span><span class="s1">import type { HeadData } from '../shared/lib/app-router-context.shared-runtime'</span><span class="s3">\n</span><span class="s1">import { PAGE_SEGMENT_KEY } from '../shared/lib/segment'</span><span class="s3">\n\n</span><span class="s1">export type NormalizedFlightData = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The full `FlightSegmentPath` inclusive of the final `Segment`</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">segmentPath: FlightSegmentPath</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The `FlightSegmentPath` exclusive of the final `Segment`</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">pathToSegment: FlightSegmentPath</span><span class="s3">\n  </span><span class="s1">segment: Segment</span><span class="s3">\n  </span><span class="s1">tree: FlightRouterState</span><span class="s3">\n  </span><span class="s1">seedData: CacheNodeSeedData | null</span><span class="s3">\n  </span><span class="s1">head: HeadData</span><span class="s3">\n  </span><span class="s1">isHeadPartial: boolean</span><span class="s3">\n  </span><span class="s1">isRootRender: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// TODO: We should only have to export `normalizeFlightData`, however because the initial flight data</span><span class="s3">\n</span><span class="s1">// that gets passed to `createInitialRouterState` doesn't conform to the `FlightDataPath` type (it's missing the root segment)</span><span class="s3">\n</span><span class="s1">// we're currently exporting it so we can use it directly. This should be fixed as part of the unification of</span><span class="s3">\n</span><span class="s1">// the different ways we express `FlightSegmentPath`.</span><span class="s3">\n</span><span class="s1">export function getFlightDataPartsFromPath(</span><span class="s3">\n  </span><span class="s1">flightDataPath: FlightDataPath</span><span class="s3">\n</span><span class="s1">): NormalizedFlightData {</span><span class="s3">\n  </span><span class="s1">// Pick the last 4 items from the `FlightDataPath` to get the [tree, seedData, viewport, isHeadPartial].</span><span class="s3">\n  </span><span class="s1">const flightDataPathLength = 4</span><span class="s3">\n  </span><span class="s1">// tree, seedData, and head are *always* the last three items in the `FlightDataPath`.</span><span class="s3">\n  </span><span class="s1">const [tree, seedData, head, isHeadPartial] =</span><span class="s3">\n    </span><span class="s1">flightDataPath.slice(-flightDataPathLength)</span><span class="s3">\n  </span><span class="s1">// The `FlightSegmentPath` is everything except the last three items. For a root render, it won't be present.</span><span class="s3">\n  </span><span class="s1">const segmentPath = flightDataPath.slice(0, -flightDataPathLength)</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">// TODO: Unify these two segment path helpers. We are inconsistently pushing an empty segment (</span><span class="s3">\&quot;\&quot;</span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">// to the start of the segment path in some places which makes it hard to use solely the segment path.</span><span class="s3">\n    </span><span class="s1">// Look for </span><span class="s3">\&quot;</span><span class="s1">// TODO-APP: remove ''</span><span class="s3">\&quot; </span><span class="s1">in the codebase.</span><span class="s3">\n    </span><span class="s1">pathToSegment: segmentPath.slice(0, -1),</span><span class="s3">\n    </span><span class="s1">segmentPath,</span><span class="s3">\n    </span><span class="s1">// if the `FlightDataPath` corresponds with the root, there'll be no segment path,</span><span class="s3">\n    </span><span class="s1">// in which case we default to ''.</span><span class="s3">\n    </span><span class="s1">segment: segmentPath[segmentPath.length - 1] ?? '',</span><span class="s3">\n    </span><span class="s1">tree,</span><span class="s3">\n    </span><span class="s1">seedData,</span><span class="s3">\n    </span><span class="s1">head,</span><span class="s3">\n    </span><span class="s1">isHeadPartial,</span><span class="s3">\n    </span><span class="s1">isRootRender: flightDataPath.length === flightDataPathLength,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getNextFlightSegmentPath(</span><span class="s3">\n  </span><span class="s1">flightSegmentPath: FlightSegmentPath</span><span class="s3">\n</span><span class="s1">): FlightSegmentPath {</span><span class="s3">\n  </span><span class="s1">// Since `FlightSegmentPath` is a repeated tuple of `Segment` and `ParallelRouteKey`, we slice off two items</span><span class="s3">\n  </span><span class="s1">// to get the next segment path.</span><span class="s3">\n  </span><span class="s1">return flightSegmentPath.slice(2)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function normalizeFlightData(</span><span class="s3">\n  </span><span class="s1">flightData: FlightData</span><span class="s3">\n</span><span class="s1">): NormalizedFlightData[] | string {</span><span class="s3">\n  </span><span class="s1">// FlightData can be a string when the server didn't respond with a proper flight response,</span><span class="s3">\n  </span><span class="s1">// or when a redirect happens, to signal to the client that it needs to perform an MPA navigation.</span><span class="s3">\n  </span><span class="s1">if (typeof flightData === 'string') {</span><span class="s3">\n    </span><span class="s1">return flightData</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return flightData.map((flightDataPath) =&gt;</span><span class="s3">\n    </span><span class="s1">getFlightDataPartsFromPath(flightDataPath)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function is used to prepare the flight router state for the request.</span><span class="s3">\n </span><span class="s1">* It removes markers that are not needed by the server, and are purely used</span><span class="s3">\n </span><span class="s1">* for stashing state on the client.</span><span class="s3">\n </span><span class="s1">* @param flightRouterState - The flight router state to prepare.</span><span class="s3">\n </span><span class="s1">* @param isHmrRefresh - Whether this is an HMR refresh request.</span><span class="s3">\n </span><span class="s1">* @returns The prepared flight router state.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function prepareFlightRouterStateForRequest(</span><span class="s3">\n  </span><span class="s1">flightRouterState: FlightRouterState,</span><span class="s3">\n  </span><span class="s1">isHmrRefresh?: boolean</span><span class="s3">\n</span><span class="s1">): string {</span><span class="s3">\n  </span><span class="s1">// HMR requests need the complete, unmodified state for proper functionality</span><span class="s3">\n  </span><span class="s1">if (isHmrRefresh) {</span><span class="s3">\n    </span><span class="s1">return encodeURIComponent(JSON.stringify(flightRouterState))</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return encodeURIComponent(</span><span class="s3">\n    </span><span class="s1">JSON.stringify(stripClientOnlyDataFromFlightRouterState(flightRouterState))</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Recursively strips client-only data from FlightRouterState while preserving</span><span class="s3">\n </span><span class="s1">* server-needed information for proper rendering decisions.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function stripClientOnlyDataFromFlightRouterState(</span><span class="s3">\n  </span><span class="s1">flightRouterState: FlightRouterState</span><span class="s3">\n</span><span class="s1">): FlightRouterState {</span><span class="s3">\n  </span><span class="s1">const [</span><span class="s3">\n    </span><span class="s1">segment,</span><span class="s3">\n    </span><span class="s1">parallelRoutes,</span><span class="s3">\n    </span><span class="s1">_url, // Intentionally unused - URLs are client-only</span><span class="s3">\n    </span><span class="s1">refreshMarker,</span><span class="s3">\n    </span><span class="s1">isRootLayout,</span><span class="s3">\n    </span><span class="s1">hasLoadingBoundary,</span><span class="s3">\n  </span><span class="s1">] = flightRouterState</span><span class="s3">\n\n  </span><span class="s1">// __PAGE__ segments are always fetched from the server, so there's</span><span class="s3">\n  </span><span class="s1">// no need to send them up</span><span class="s3">\n  </span><span class="s1">const cleanedSegment = stripSearchParamsFromPageSegment(segment)</span><span class="s3">\n\n  </span><span class="s1">// Recursively process parallel routes</span><span class="s3">\n  </span><span class="s1">const cleanedParallelRoutes: { [key: string]: FlightRouterState } = {}</span><span class="s3">\n  </span><span class="s1">for (const [key, childState] of Object.entries(parallelRoutes)) {</span><span class="s3">\n    </span><span class="s1">cleanedParallelRoutes[key] =</span><span class="s3">\n      </span><span class="s1">stripClientOnlyDataFromFlightRouterState(childState)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const result: FlightRouterState = [</span><span class="s3">\n    </span><span class="s1">cleanedSegment,</span><span class="s3">\n    </span><span class="s1">cleanedParallelRoutes,</span><span class="s3">\n    </span><span class="s1">null, // URLs omitted - server reconstructs paths from segments</span><span class="s3">\n    </span><span class="s1">shouldPreserveRefreshMarker(refreshMarker) ? refreshMarker : null,</span><span class="s3">\n  </span><span class="s1">]</span><span class="s3">\n\n  </span><span class="s1">// Append optional fields if present</span><span class="s3">\n  </span><span class="s1">if (isRootLayout !== undefined) {</span><span class="s3">\n    </span><span class="s1">result[4] = isRootLayout</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (hasLoadingBoundary !== undefined) {</span><span class="s3">\n    </span><span class="s1">result[5] = hasLoadingBoundary</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return result</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Strips search parameters from __PAGE__ segments to prevent sensitive</span><span class="s3">\n </span><span class="s1">* client-side data from being sent to the server.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function stripSearchParamsFromPageSegment(segment: Segment): Segment {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">typeof segment === 'string' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">segment.startsWith(PAGE_SEGMENT_KEY + '?')</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return PAGE_SEGMENT_KEY</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return segment</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Determines whether the refresh marker should be sent to the server</span><span class="s3">\n </span><span class="s1">* Client-only markers like 'refresh' are stripped, while server-needed markers</span><span class="s3">\n </span><span class="s1">* like 'refetch' and 'inside-shared-layout' are preserved.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function shouldPreserveRefreshMarker(</span><span class="s3">\n  </span><span class="s1">refreshMarker: FlightRouterState[3]</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">return Boolean(refreshMarker &amp;&amp; refreshMarker !== 'refresh')</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;PAGE_SEGMENT_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;getFlightDataPartsFromPath&quot;</span><span class="s0">,</span><span class="s1">&quot;flightDataPath&quot;</span><span class="s0">,</span><span class="s1">&quot;flightDataPathLength&quot;</span><span class="s0">,</span><span class="s1">&quot;tree&quot;</span><span class="s0">,</span><span class="s1">&quot;seedData&quot;</span><span class="s0">,</span><span class="s1">&quot;head&quot;</span><span class="s0">,</span><span class="s1">&quot;isHeadPartial&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;pathToSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;isRootRender&quot;</span><span class="s0">,</span><span class="s1">&quot;getNextFlightSegmentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;flightSegmentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeFlightData&quot;</span><span class="s0">,</span><span class="s1">&quot;flightData&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;prepareFlightRouterStateForRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;flightRouterState&quot;</span><span class="s0">,</span><span class="s1">&quot;isHmrRefresh&quot;</span><span class="s0">,</span><span class="s1">&quot;encodeURIComponent&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;stripClientOnlyDataFromFlightRouterState&quot;</span><span class="s0">,</span><span class="s1">&quot;parallelRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;_url&quot;</span><span class="s0">,</span><span class="s1">&quot;refreshMarker&quot;</span><span class="s0">,</span><span class="s1">&quot;isRootLayout&quot;</span><span class="s0">,</span><span class="s1">&quot;hasLoadingBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;cleanedSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;stripSearchParamsFromPageSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;cleanedParallelRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;childState&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldPreserveRefreshMarker&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;Boolean&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;AASA,SAASA,gBAAgB,QAAQ,wBAAuB;;AAuBjD,SAASC,2BACdC,cAA8B;IAE9B,wGAAwG;IACxG,MAAMC,uBAAuB;IAC7B,sFAAsF;IACtF,MAAM,CAACC,MAAMC,UAAUC,MAAMC,cAAc,GACzCL,eAAeM,KAAK,CAAC,CAACL;IACxB,6GAA6G;IAC7G,MAAMM,cAAcP,eAAeM,KAAK,CAAC,GAAG,CAACL;QAUlCM;IARX,OAAO;QACL,kGAAkG;QAClG,sGAAsG;QACtG,qDAAqD;QACrDC,eAAeD,YAAYD,KAAK,CAAC,GAAG,CAAC;QACrCC;QACA,kFAAkF;QAClF,kCAAkC;QAClCE,SAASF,CAAAA,gBAAAA,WAAW,CAACA,YAAYG,MAAM,GAAG,EAAE,KAAA,OAAnCH,gBAAuC;QAChDL;QACAC;QACAC;QACAC;QACAM,cAAcX,eAAeU,MAAM,KAAKT;IAC1C;AACF;AAEO,SAASW,yBACdC,iBAAoC;IAEpC,4GAA4G;IAC5G,gCAAgC;IAChC,OAAOA,kBAAkBP,KAAK,CAAC;AACjC;AAEO,SAASQ,oBACdC,UAAsB;IAEtB,2FAA2F;IAC3F,kGAAkG;IAClG,IAAI,OAAOA,eAAe,UAAU;QAClC,OAAOA;IACT;IAEA,OAAOA,WAAWC,GAAG,CAAC,CAAChB,iBACrBD,2BAA2BC;AAE/B;AAUO,SAASiB,mCACdC,iBAAoC,EACpCC,YAAsB;IAEtB,4EAA4E;IAC5E,IAAIA,cAAc;QAChB,OAAOC,mBAAmBC,KAAKC,SAAS,CAACJ;IAC3C;IAEA,OAAOE,mBACLC,KAAKC,SAAS,CAACC,yCAAyCL;AAE5D;AAEA;;;CAGC,GACD,SAASK,yCACPL,iBAAoC;IAEpC,MAAM,CACJT,SACAe,gBACAC,MACAC,eACAC,cACAC,mBACD,GAAGV;IAEJ,mEAAmE;IACnE,0BAA0B;IAC1B,MAAMW,iBAAiBC,iCAAiCrB;IAExD,sCAAsC;IACtC,MAAMsB,wBAA8D,CAAC;IACrE,KAAK,MAAM,CAACC,KAAKC,WAAW,IAAIC,OAAOC,OAAO,CAACX,gBAAiB;QAC9DO,qBAAqB,CAACC,IAAI,GACxBT,yCAAyCU;IAC7C;IAEA,MAAMG,SAA4B;QAChCP;QACAE;QACA;QACAM,4BAA4BX,iBAAiBA,gBAAgB;KAC9D;IAED,oCAAoC;IACpC,IAAIC,iBAAiBW,WAAW;QAC9BF,MAAM,CAAC,EAAE,GAAGT;IACd;IACA,IAAIC,uBAAuBU,WAAW;QACpCF,MAAM,CAAC,EAAE,GAAGR;IACd;IAEA,OAAOQ;AACT;AAEA;;;CAGC,GACD,SAASN,iCAAiCrB,OAAgB;IACxD,IACE,OAAOA,YAAY,YACnBA,QAAQ8B,UAAU,CAACzC,mLAAAA,GAAmB,MACtC;QACA,OAAOA,mLAAAA;IACT;IACA,OAAOW;AACT;AAEA;;;;CAIC,GACD,SAAS4B,4BACPX,aAAmC;IAEnC,OAAOc,QAAQd,iBAAiBA,kBAAkB;AACpD&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">395</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/app-build-id.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// This gets assigned as a side-effect during app initialization. Because it</span><span class="s3">\n</span><span class="s1">// represents the build used to create the JS bundle, it should never change</span><span class="s3">\n</span><span class="s1">// after being set, so we store it in a global variable.</span><span class="s3">\n</span><span class="s1">//</span><span class="s3">\n</span><span class="s1">// When performing RSC requests, if the incoming data has a different build ID,</span><span class="s3">\n</span><span class="s1">// we perform an MPA navigation/refresh to load the updated build and ensure</span><span class="s3">\n</span><span class="s1">// that the client and server in sync.</span><span class="s3">\n\n</span><span class="s1">// Starts as an empty string. In practice, because setAppBuildId is called</span><span class="s3">\n</span><span class="s1">// during initialization before hydration starts, this will always get</span><span class="s3">\n</span><span class="s1">// reassigned to the actual build ID before it's ever needed by a navigation.</span><span class="s3">\n</span><span class="s1">// If for some reasons it didn't, due to a bug or race condition, then on</span><span class="s3">\n</span><span class="s1">// navigation the build comparision would fail and trigger an MPA navigation.</span><span class="s3">\n</span><span class="s1">let globalBuildId: string = ''</span><span class="s3">\n\n</span><span class="s1">export function setAppBuildId(buildId: string) {</span><span class="s3">\n  </span><span class="s1">globalBuildId = buildId</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getAppBuildId(): string {</span><span class="s3">\n  </span><span class="s1">return globalBuildId</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;globalBuildId&quot;</span><span class="s0">,</span><span class="s1">&quot;setAppBuildId&quot;</span><span class="s0">,</span><span class="s1">&quot;buildId&quot;</span><span class="s0">,</span><span class="s1">&quot;getAppBuildId&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,4EAA4E;AAC5E,4EAA4E;AAC5E,wDAAwD;AACxD,EAAE;AACF,+EAA+E;AAC/E,4EAA4E;AAC5E,sCAAsC;AAEtC,0EAA0E;AAC1E,sEAAsE;AACtE,6EAA6E;AAC7E,yEAAyE;AACzE,6EAA6E;;;;;;;AAC7E,IAAIA,gBAAwB;AAErB,SAASC,cAAcC,OAAe;IAC3CF,gBAAgBE;AAClB;AAEO,SAASC;IACd,OAAOH;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">424</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/hash.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// http://www.cse.yorku.ca/~oz/hash.html</span><span class="s3">\n</span><span class="s1">// More specifically, 32-bit hash via djbxor</span><span class="s3">\n</span><span class="s1">// (ref: https://gist.github.com/eplawless/52813b1d8ad9af510d85?permalink_comment_id=3367765#gistcomment-3367765)</span><span class="s3">\n</span><span class="s1">// This is due to number type differences between rust for turbopack to js number types,</span><span class="s3">\n</span><span class="s1">// where rust does not have easy way to repreesnt js's 53-bit float number type for the matching</span><span class="s3">\n</span><span class="s1">// overflow behavior. This is more `correct` in terms of having canonical hash across different runtime / implementation</span><span class="s3">\n</span><span class="s1">// as can gaurantee determinstic output from 32bit hash.</span><span class="s3">\n</span><span class="s1">export function djb2Hash(str: string) {</span><span class="s3">\n  </span><span class="s1">let hash = 5381</span><span class="s3">\n  </span><span class="s1">for (let i = 0; i &lt; str.length; i++) {</span><span class="s3">\n    </span><span class="s1">const char = str.charCodeAt(i)</span><span class="s3">\n    </span><span class="s1">hash = ((hash &lt;&lt; 5) + hash + char) &amp; 0xffffffff</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return hash &gt;&gt;&gt; 0</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function hexHash(str: string) {</span><span class="s3">\n  </span><span class="s1">return djb2Hash(str).toString(36).slice(0, 5)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;djb2Hash&quot;</span><span class="s0">,</span><span class="s1">&quot;str&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;char&quot;</span><span class="s0">,</span><span class="s1">&quot;charCodeAt&quot;</span><span class="s0">,</span><span class="s1">&quot;hexHash&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,wCAAwC;AACxC,4CAA4C;AAC5C,iHAAiH;AACjH,wFAAwF;AACxF,gGAAgG;AAChG,wHAAwH;AACxH,wDAAwD;;;;;;;AACjD,SAASA,SAASC,GAAW;IAClC,IAAIC,OAAO;IACX,IAAK,IAAIC,IAAI,GAAGA,IAAIF,IAAIG,MAAM,EAAED,IAAK;QACnC,MAAME,OAAOJ,IAAIK,UAAU,CAACH;QAC5BD,OAASA,CAAAA,QAAQ,CAAA,IAAKA,OAAOG,OAAQ;IACvC;IACA,OAAOH,SAAS;AAClB;AAEO,SAASK,QAAQN,GAAW;IACjC,OAAOD,SAASC,KAAKO,QAAQ,CAAC,IAAIC,KAAK,CAAC,GAAG;AAC7C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">452</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/cache-busting-search-param.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { hexHash } from '../../hash'</span><span class="s3">\n\n</span><span class="s1">export function computeCacheBustingSearchParam(</span><span class="s3">\n  </span><span class="s1">prefetchHeader: '1' | '2' | '0' | undefined,</span><span class="s3">\n  </span><span class="s1">segmentPrefetchHeader: string | string[] | undefined,</span><span class="s3">\n  </span><span class="s1">stateTreeHeader: string | string[] | undefined,</span><span class="s3">\n  </span><span class="s1">nextUrlHeader: string | string[] | undefined</span><span class="s3">\n</span><span class="s1">): string {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">(prefetchHeader === undefined || prefetchHeader === '0') &amp;&amp;</span><span class="s3">\n    </span><span class="s1">segmentPrefetchHeader === undefined &amp;&amp;</span><span class="s3">\n    </span><span class="s1">stateTreeHeader === undefined &amp;&amp;</span><span class="s3">\n    </span><span class="s1">nextUrlHeader === undefined</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return ''</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return hexHash(</span><span class="s3">\n    </span><span class="s1">[</span><span class="s3">\n      </span><span class="s1">prefetchHeader || '0',</span><span class="s3">\n      </span><span class="s1">segmentPrefetchHeader || '0',</span><span class="s3">\n      </span><span class="s1">stateTreeHeader || '0',</span><span class="s3">\n      </span><span class="s1">nextUrlHeader || '0',</span><span class="s3">\n    </span><span class="s1">].join(',')</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;hexHash&quot;</span><span class="s0">,</span><span class="s1">&quot;computeCacheBustingSearchParam&quot;</span><span class="s0">,</span><span class="s1">&quot;prefetchHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentPrefetchHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;stateTreeHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;nextUrlHeader&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,OAAO,QAAQ,aAAY;;AAE7B,SAASC,+BACdC,cAA2C,EAC3CC,qBAAoD,EACpDC,eAA8C,EAC9CC,aAA4C;IAE5C,IACGH,CAAAA,mBAAmBI,aAAaJ,mBAAmB,GAAE,KACtDC,0BAA0BG,aAC1BF,oBAAoBE,aACpBD,kBAAkBC,WAClB;QACA,OAAO;IACT;IACA,WAAON,uKAAAA,EACL;QACEE,kBAAkB;QAClBC,yBAAyB;QACzBC,mBAAmB;QACnBC,iBAAiB;KAClB,CAACE,IAAI,CAAC;AAEX&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">473</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/router-reducer/set-cache-busting-search-param.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">import { computeCacheBustingSearchParam } from '../../../shared/lib/router/utils/cache-busting-search-param'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">NEXT_ROUTER_PREFETCH_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_ROUTER_SEGMENT_PREFETCH_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_ROUTER_STATE_TREE_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_URL,</span><span class="s3">\n  </span><span class="s1">NEXT_RSC_UNION_QUERY,</span><span class="s3">\n</span><span class="s1">} from '../app-router-headers'</span><span class="s3">\n</span><span class="s1">import type { RequestHeaders } from './fetch-server-response'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Mutates the provided URL by adding a cache-busting search parameter for CDNs that don't</span><span class="s3">\n </span><span class="s1">* support custom headers. This helps avoid caching conflicts by making each request unique.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Rather than relying on the Vary header which some CDNs ignore, we append a search param</span><span class="s3">\n </span><span class="s1">* to create a unique URL that forces a fresh request.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Example:</span><span class="s3">\n </span><span class="s1">* URL before: https://example.com/path?query=1</span><span class="s3">\n </span><span class="s1">* URL after: https://example.com/path?query=1&amp;_rsc=abc123</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Note: This function mutates the input URL directly and does not return anything.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* TODO: Since we need to use a search param anyway, we could simplify by removing the custom</span><span class="s3">\n </span><span class="s1">* headers approach entirely and just use search params.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const setCacheBustingSearchParam = (</span><span class="s3">\n  </span><span class="s1">url: URL,</span><span class="s3">\n  </span><span class="s1">headers: RequestHeaders</span><span class="s3">\n</span><span class="s1">): void =&gt; {</span><span class="s3">\n  </span><span class="s1">const uniqueCacheKey = computeCacheBustingSearchParam(</span><span class="s3">\n    </span><span class="s1">headers[NEXT_ROUTER_PREFETCH_HEADER],</span><span class="s3">\n    </span><span class="s1">headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER],</span><span class="s3">\n    </span><span class="s1">headers[NEXT_ROUTER_STATE_TREE_HEADER],</span><span class="s3">\n    </span><span class="s1">headers[NEXT_URL]</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">setCacheBustingSearchParamWithHash(url, uniqueCacheKey)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Sets a cache-busting search parameter on a URL using a provided hash value.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This function performs the same logic as `setCacheBustingSearchParam` but accepts</span><span class="s3">\n </span><span class="s1">* a pre-computed hash instead of computing it from headers.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Example:</span><span class="s3">\n </span><span class="s1">* URL before: https://example.com/path?query=1</span><span class="s3">\n </span><span class="s1">* hash: </span><span class="s3">\&quot;</span><span class="s1">abc123</span><span class="s3">\&quot;\n </span><span class="s1">* URL after: https://example.com/path?query=1&amp;_rsc=abc123</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* If the hash is null, we will set `_rsc` search param without a value.</span><span class="s3">\n </span><span class="s1">* Like this: https://example.com/path?query=1&amp;_rsc</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Note: This function mutates the input URL directly and does not return anything.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const setCacheBustingSearchParamWithHash = (</span><span class="s3">\n  </span><span class="s1">url: URL,</span><span class="s3">\n  </span><span class="s1">hash: string</span><span class="s3">\n</span><span class="s1">): void =&gt; {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Note that we intentionally do not use `url.searchParams.set` here:</span><span class="s3">\n   </span><span class="s1">*</span><span class="s3">\n   </span><span class="s1">* const url = new URL('https://example.com/search?q=custom%20spacing');</span><span class="s3">\n   </span><span class="s1">* url.searchParams.set('_rsc', 'abc123');</span><span class="s3">\n   </span><span class="s1">* console.log(url.toString()); // Outputs: https://example.com/search?q=custom+spacing&amp;_rsc=abc123</span><span class="s3">\n   </span><span class="s1">*                                                                             ^ &lt;--- this is causing confusion</span><span class="s3">\n   </span><span class="s1">* This is in fact intended based on https://url.spec.whatwg.org/#interface-urlsearchparams, but</span><span class="s3">\n   </span><span class="s1">* we want to preserve the %20 as %20 if that's what the user passed in, hence the custom</span><span class="s3">\n   </span><span class="s1">* logic below.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">const existingSearch = url.search</span><span class="s3">\n  </span><span class="s1">const rawQuery = existingSearch.startsWith('?')</span><span class="s3">\n    </span><span class="s1">? existingSearch.slice(1)</span><span class="s3">\n    </span><span class="s1">: existingSearch</span><span class="s3">\n\n  </span><span class="s1">// Always remove any existing cache busting param and add a fresh one to ensure</span><span class="s3">\n  </span><span class="s1">// we have the correct value based on current request headers</span><span class="s3">\n  </span><span class="s1">const pairs = rawQuery</span><span class="s3">\n    </span><span class="s1">.split('&amp;')</span><span class="s3">\n    </span><span class="s1">.filter((pair) =&gt; pair &amp;&amp; !pair.startsWith(`${NEXT_RSC_UNION_QUERY}=`))</span><span class="s3">\n\n  </span><span class="s1">if (hash.length &gt; 0) {</span><span class="s3">\n    </span><span class="s1">pairs.push(`${NEXT_RSC_UNION_QUERY}=${hash}`)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">pairs.push(`${NEXT_RSC_UNION_QUERY}`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">url.search = pairs.length ? `?${pairs.join('&amp;')}` : ''</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;computeCacheBustingSearchParam&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_PREFETCH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_SEGMENT_PREFETCH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_STATE_TREE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_URL&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RSC_UNION_QUERY&quot;</span><span class="s0">,</span><span class="s1">&quot;setCacheBustingSearchParam&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;uniqueCacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;setCacheBustingSearchParamWithHash&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">,</span><span class="s1">&quot;existingSearch&quot;</span><span class="s0">,</span><span class="s1">&quot;search&quot;</span><span class="s0">,</span><span class="s1">&quot;rawQuery&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;pairs&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;pair&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAEA,SAASA,8BAA8B,QAAQ,8DAA6D;AAC5G,SACEC,2BAA2B,EAC3BC,mCAAmC,EACnCC,6BAA6B,EAC7BC,QAAQ,EACRC,oBAAoB,QACf,wBAAuB;AAT9B;;;AA4BO,MAAMC,6BAA6B,CACxCC,KACAC;IAEA,MAAMC,qBAAiBT,gPAAAA,EACrBQ,OAAO,CAACP,sNAAAA,CAA4B,EACpCO,OAAO,CAACN,8NAAAA,CAAoC,EAC5CM,OAAO,CAACL,wNAAAA,CAA8B,EACtCK,OAAO,CAACJ,mMAAAA,CAAS;IAEnBM,mCAAmCH,KAAKE;AAC1C,EAAC;AAkBM,MAAMC,qCAAqC,CAChDH,KACAI;IAEA;;;;;;;;;;GAUC,GACD,MAAMC,iBAAiBL,IAAIM,MAAM;IACjC,MAAMC,WAAWF,eAAeG,UAAU,CAAC,OACvCH,eAAeI,KAAK,CAAC,KACrBJ;IAEJ,+EAA+E;IAC/E,6DAA6D;IAC7D,MAAMK,QAAQH,SACXI,KAAK,CAAC,KACNC,MAAM,CAAC,CAACC,OAASA,QAAQ,CAACA,KAAKL,UAAU,CAAE,KAAEV,+MAAAA,GAAqB;IAErE,IAAIM,KAAKU,MAAM,GAAG,GAAG;QACnBJ,MAAMK,IAAI,CAAIjB,+MAAAA,GAAqB,MAAGM;IACxC,OAAO;QACLM,MAAMK,IAAI,CAAE,KAAEjB,+MAAAA;IAChB;IACAE,IAAIM,MAAM,GAAGI,MAAMI,MAAM,GAAI,MAAGJ,MAAMM,IAAI,CAAC,OAAS;AACtD,EAAC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">515</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/segment-cache/segment-value-encoding.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { PAGE_SEGMENT_KEY } from '../segment'</span><span class="s3">\n</span><span class="s1">import type { Segment as FlightRouterStateSegment } from '../../../server/app-render/types'</span><span class="s3">\n\n</span><span class="s1">// TypeScript trick to simulate opaque types, like in Flow.</span><span class="s3">\n</span><span class="s1">type Opaque&lt;K, T&gt; = T &amp; { __brand: K }</span><span class="s3">\n\n</span><span class="s1">export type SegmentRequestKeyPart = Opaque&lt;'SegmentRequestKeyPart', string&gt;</span><span class="s3">\n</span><span class="s1">export type SegmentRequestKey = Opaque&lt;'SegmentRequestKey', string&gt;</span><span class="s3">\n</span><span class="s1">export type SegmentCacheKeyPart = Opaque&lt;'SegmentCacheKeyPart', string&gt;</span><span class="s3">\n</span><span class="s1">export type SegmentCacheKey = Opaque&lt;'SegmentCacheKey', string&gt;</span><span class="s3">\n\n</span><span class="s1">export const ROOT_SEGMENT_REQUEST_KEY = '' as SegmentRequestKey</span><span class="s3">\n</span><span class="s1">export const ROOT_SEGMENT_CACHE_KEY = '' as SegmentCacheKey</span><span class="s3">\n\n</span><span class="s1">export function createSegmentRequestKeyPart(</span><span class="s3">\n  </span><span class="s1">segment: FlightRouterStateSegment</span><span class="s3">\n</span><span class="s1">): SegmentRequestKeyPart {</span><span class="s3">\n  </span><span class="s1">if (typeof segment === 'string') {</span><span class="s3">\n    </span><span class="s1">if (segment.startsWith(PAGE_SEGMENT_KEY)) {</span><span class="s3">\n      </span><span class="s1">// The Flight Router State type sometimes includes the search params in</span><span class="s3">\n      </span><span class="s1">// the page segment. However, the Segment Cache tracks this as a separate</span><span class="s3">\n      </span><span class="s1">// key. So, we strip the search params here, and then add them back when</span><span class="s3">\n      </span><span class="s1">// the cache entry is turned back into a FlightRouterState. This is an</span><span class="s3">\n      </span><span class="s1">// unfortunate consequence of the FlightRouteState being used both as a</span><span class="s3">\n      </span><span class="s1">// transport type and as a cache key; we'll address this once more of the</span><span class="s3">\n      </span><span class="s1">// Segment Cache implementation has settled.</span><span class="s3">\n      </span><span class="s1">// TODO: We should hoist the search params out of the FlightRouterState</span><span class="s3">\n      </span><span class="s1">// type entirely, This is our plan for dynamic route params, too.</span><span class="s3">\n      </span><span class="s1">return PAGE_SEGMENT_KEY as SegmentRequestKeyPart</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const safeName =</span><span class="s3">\n      </span><span class="s1">// TODO: FlightRouterState encodes Not Found routes as </span><span class="s3">\&quot;</span><span class="s1">/_not-found</span><span class="s3">\&quot;</span><span class="s1">.</span><span class="s3">\n      </span><span class="s1">// But params typically don't include the leading slash. We should use</span><span class="s3">\n      </span><span class="s1">// a different encoding to avoid this special case.</span><span class="s3">\n      </span><span class="s1">segment === '/_not-found'</span><span class="s3">\n        </span><span class="s1">? '_not-found'</span><span class="s3">\n        </span><span class="s1">: encodeToFilesystemAndURLSafeString(segment)</span><span class="s3">\n    </span><span class="s1">// Since this is not a dynamic segment, it's fully encoded. It does not</span><span class="s3">\n    </span><span class="s1">// need to be </span><span class="s3">\&quot;</span><span class="s1">hydrated</span><span class="s3">\&quot; </span><span class="s1">with a param value.</span><span class="s3">\n    </span><span class="s1">return safeName as SegmentRequestKeyPart</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const name = segment[0]</span><span class="s3">\n  </span><span class="s1">const paramType = segment[2]</span><span class="s3">\n  </span><span class="s1">const safeName = encodeToFilesystemAndURLSafeString(name)</span><span class="s3">\n\n  </span><span class="s1">const encodedName = '$' + paramType + '$' + safeName</span><span class="s3">\n  </span><span class="s1">return encodedName as SegmentRequestKeyPart</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function appendSegmentRequestKeyPart(</span><span class="s3">\n  </span><span class="s1">parentRequestKey: SegmentRequestKey,</span><span class="s3">\n  </span><span class="s1">parallelRouteKey: string,</span><span class="s3">\n  </span><span class="s1">childRequestKeyPart: SegmentRequestKeyPart</span><span class="s3">\n</span><span class="s1">): SegmentRequestKey {</span><span class="s3">\n  </span><span class="s1">// Aside from being filesystem safe, segment keys are also designed so that</span><span class="s3">\n  </span><span class="s1">// each segment and parallel route creates its own subdirectory. Roughly in</span><span class="s3">\n  </span><span class="s1">// the same shape as the source app directory. This is mostly just for easier</span><span class="s3">\n  </span><span class="s1">// debugging (you can open up the build folder and navigate the output); if</span><span class="s3">\n  </span><span class="s1">// we wanted to do we could just use a flat structure.</span><span class="s3">\n\n  </span><span class="s1">// Omit the parallel route key for children, since this is the most</span><span class="s3">\n  </span><span class="s1">// common case. Saves some bytes (and it's what the app directory does).</span><span class="s3">\n  </span><span class="s1">const slotKey =</span><span class="s3">\n    </span><span class="s1">parallelRouteKey === 'children'</span><span class="s3">\n      </span><span class="s1">? childRequestKeyPart</span><span class="s3">\n      </span><span class="s1">: `@${encodeToFilesystemAndURLSafeString(parallelRouteKey)}/${childRequestKeyPart}`</span><span class="s3">\n  </span><span class="s1">return (parentRequestKey + '/' + slotKey) as SegmentRequestKey</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createSegmentCacheKeyPart(</span><span class="s3">\n  </span><span class="s1">requestKeyPart: SegmentRequestKeyPart,</span><span class="s3">\n  </span><span class="s1">segment: FlightRouterStateSegment</span><span class="s3">\n</span><span class="s1">): SegmentCacheKeyPart {</span><span class="s3">\n  </span><span class="s1">if (typeof segment === 'string') {</span><span class="s3">\n    </span><span class="s1">return requestKeyPart as any as SegmentCacheKeyPart</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const paramValue = segment[1]</span><span class="s3">\n  </span><span class="s1">const safeValue = encodeToFilesystemAndURLSafeString(paramValue)</span><span class="s3">\n  </span><span class="s1">return (requestKeyPart + '$' + safeValue) as SegmentCacheKeyPart</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function appendSegmentCacheKeyPart(</span><span class="s3">\n  </span><span class="s1">parentSegmentKey: SegmentCacheKey,</span><span class="s3">\n  </span><span class="s1">parallelRouteKey: string,</span><span class="s3">\n  </span><span class="s1">childCacheKeyPart: SegmentCacheKeyPart</span><span class="s3">\n</span><span class="s1">): SegmentCacheKey {</span><span class="s3">\n  </span><span class="s1">const slotKey =</span><span class="s3">\n    </span><span class="s1">parallelRouteKey === 'children'</span><span class="s3">\n      </span><span class="s1">? childCacheKeyPart</span><span class="s3">\n      </span><span class="s1">: `@${encodeToFilesystemAndURLSafeString(parallelRouteKey)}/${childCacheKeyPart}`</span><span class="s3">\n  </span><span class="s1">return (parentSegmentKey + '/' + slotKey) as SegmentCacheKey</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Define a regex pattern to match the most common characters found in a route</span><span class="s3">\n</span><span class="s1">// param. It excludes anything that might not be cross-platform filesystem</span><span class="s3">\n</span><span class="s1">// compatible, like |. It does not need to be precise because the fallback is to</span><span class="s3">\n</span><span class="s1">// just base64url-encode the whole parameter, which is fine; we just don't do it</span><span class="s3">\n</span><span class="s1">// by default for compactness, and for easier debugging.</span><span class="s3">\n</span><span class="s1">const simpleParamValueRegex = /^[a-zA-Z0-9</span><span class="s3">\\</span><span class="s1">-_@]+$/</span><span class="s3">\n\n</span><span class="s1">function encodeToFilesystemAndURLSafeString(value: string) {</span><span class="s3">\n  </span><span class="s1">if (simpleParamValueRegex.test(value)) {</span><span class="s3">\n    </span><span class="s1">return value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">// If there are any unsafe characters, base64url-encode the entire value.</span><span class="s3">\n  </span><span class="s1">// We also add a ! prefix so it doesn't collide with the simple case.</span><span class="s3">\n  </span><span class="s1">const base64url = btoa(value)</span><span class="s3">\n    </span><span class="s1">.replace(/</span><span class="s3">\\</span><span class="s1">+/g, '-') // Replace '+' with '-'</span><span class="s3">\n    </span><span class="s1">.replace(/</span><span class="s3">\\</span><span class="s1">//g, '_') // Replace '/' with '_'</span><span class="s3">\n    </span><span class="s1">.replace(/=+$/, '') // Remove trailing '='</span><span class="s3">\n  </span><span class="s1">return '!' + base64url</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function convertSegmentPathToStaticExportFilename(</span><span class="s3">\n  </span><span class="s1">segmentPath: string</span><span class="s3">\n</span><span class="s1">): string {</span><span class="s3">\n  </span><span class="s1">return `__next${segmentPath.replace(/</span><span class="s3">\\</span><span class="s1">//g, '.')}.txt`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;PAGE_SEGMENT_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_SEGMENT_REQUEST_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_SEGMENT_CACHE_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;createSegmentRequestKeyPart&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;safeName&quot;</span><span class="s0">,</span><span class="s1">&quot;encodeToFilesystemAndURLSafeString&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;paramType&quot;</span><span class="s0">,</span><span class="s1">&quot;encodedName&quot;</span><span class="s0">,</span><span class="s1">&quot;appendSegmentRequestKeyPart&quot;</span><span class="s0">,</span><span class="s1">&quot;parentRequestKey&quot;</span><span class="s0">,</span><span class="s1">&quot;parallelRouteKey&quot;</span><span class="s0">,</span><span class="s1">&quot;childRequestKeyPart&quot;</span><span class="s0">,</span><span class="s1">&quot;slotKey&quot;</span><span class="s0">,</span><span class="s1">&quot;createSegmentCacheKeyPart&quot;</span><span class="s0">,</span><span class="s1">&quot;requestKeyPart&quot;</span><span class="s0">,</span><span class="s1">&quot;paramValue&quot;</span><span class="s0">,</span><span class="s1">&quot;safeValue&quot;</span><span class="s0">,</span><span class="s1">&quot;appendSegmentCacheKeyPart&quot;</span><span class="s0">,</span><span class="s1">&quot;parentSegmentKey&quot;</span><span class="s0">,</span><span class="s1">&quot;childCacheKeyPart&quot;</span><span class="s0">,</span><span class="s1">&quot;simpleParamValueRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;base64url&quot;</span><span class="s0">,</span><span class="s1">&quot;btoa&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;convertSegmentPathToStaticExportFilename&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentPath&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;;AAAA,SAASA,gBAAgB,QAAQ,aAAY;;AAWtC,MAAMC,2BAA2B,GAAuB;AACxD,MAAMC,yBAAyB,GAAqB;AAEpD,SAASC,4BACdC,OAAiC;IAEjC,IAAI,OAAOA,YAAY,UAAU;QAC/B,IAAIA,QAAQC,UAAU,CAACL,mLAAAA,GAAmB;YACxC,uEAAuE;YACvE,yEAAyE;YACzE,wEAAwE;YACxE,sEAAsE;YACtE,uEAAuE;YACvE,yEAAyE;YACzE,4CAA4C;YAC5C,uEAAuE;YACvE,iEAAiE;YACjE,OAAOA,mLAAAA;QACT;QACA,MAAMM,WACJ,AACA,qEADqE,CACC;QACtE,mDAAmD;QACnDF,YAAY,gBACR,eACAG,mCAAmCH;QACzC,uEAAuE;QACvE,4CAA4C;QAC5C,OAAOE;IACT;IAEA,MAAME,OAAOJ,OAAO,CAAC,EAAE;IACvB,MAAMK,YAAYL,OAAO,CAAC,EAAE;IAC5B,MAAME,WAAWC,mCAAmCC;IAEpD,MAAME,cAAc,MAAMD,YAAY,MAAMH;IAC5C,OAAOI;AACT;AAEO,SAASC,4BACdC,gBAAmC,EACnCC,gBAAwB,EACxBC,mBAA0C;IAE1C,2EAA2E;IAC3E,2EAA2E;IAC3E,6EAA6E;IAC7E,2EAA2E;IAC3E,sDAAsD;IAEtD,mEAAmE;IACnE,wEAAwE;IACxE,MAAMC,UACJF,qBAAqB,aACjBC,sBACC,MAAGP,mCAAmCM,oBAAkB,MAAGC;IAClE,OAAQF,mBAAmB,MAAMG;AACnC;AAEO,SAASC,0BACdC,cAAqC,EACrCb,OAAiC;IAEjC,IAAI,OAAOA,YAAY,UAAU;QAC/B,OAAOa;IACT;IACA,MAAMC,aAAad,OAAO,CAAC,EAAE;IAC7B,MAAMe,YAAYZ,mCAAmCW;IACrD,OAAQD,iBAAiB,MAAME;AACjC;AAEO,SAASC,0BACdC,gBAAiC,EACjCR,gBAAwB,EACxBS,iBAAsC;IAEtC,MAAMP,UACJF,qBAAqB,aACjBS,oBACC,MAAGf,mCAAmCM,oBAAkB,MAAGS;IAClE,OAAQD,mBAAmB,MAAMN;AACnC;AAEA,8EAA8E;AAC9E,0EAA0E;AAC1E,gFAAgF;AAChF,gFAAgF;AAChF,wDAAwD;AACxD,MAAMQ,wBAAwB;AAE9B,SAAShB,mCAAmCiB,KAAa;IACvD,IAAID,sBAAsBE,IAAI,CAACD,QAAQ;QACrC,OAAOA;IACT;IACA,yEAAyE;IACzE,qEAAqE;IACrE,MAAME,YAAYC,KAAKH,OACpBI,OAAO,CAAC,OAAO,KAAK,uBAAuB;KAC3CA,OAAO,CAAC,OAAO,KAAK,uBAAuB;KAC3CA,OAAO,CAAC,OAAO,IAAI,sBAAsB;;IAC5C,OAAO,MAAMF;AACf;AAEO,SAASG,yCACdC,WAAmB;IAEnB,OAAQ,WAAQA,YAAYF,OAAO,CAAC,OAAO,OAAK;AAClD&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">610</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/route-params.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { DynamicParamTypesShort } from '../server/app-render/types'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">addSearchParamsIfPageSegment,</span><span class="s3">\n  </span><span class="s1">DEFAULT_SEGMENT_KEY,</span><span class="s3">\n  </span><span class="s1">PAGE_SEGMENT_KEY,</span><span class="s3">\n</span><span class="s1">} from '../shared/lib/segment'</span><span class="s3">\n</span><span class="s1">import { ROOT_SEGMENT_REQUEST_KEY } from '../shared/lib/segment-cache/segment-value-encoding'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">NEXT_REWRITTEN_PATH_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_REWRITTEN_QUERY_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_RSC_UNION_QUERY,</span><span class="s3">\n</span><span class="s1">} from './components/app-router-headers'</span><span class="s3">\n</span><span class="s1">import type { NormalizedSearch } from './components/segment-cache'</span><span class="s3">\n</span><span class="s1">import type { RSCResponse } from './components/router-reducer/fetch-server-response'</span><span class="s3">\n\n</span><span class="s1">export type RouteParamValue = string | Array&lt;string&gt; | null</span><span class="s3">\n\n</span><span class="s1">export type RouteParam = {</span><span class="s3">\n  </span><span class="s1">name: string</span><span class="s3">\n  </span><span class="s1">value: RouteParamValue</span><span class="s3">\n  </span><span class="s1">type: DynamicParamTypesShort</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getRenderedSearch(response: RSCResponse): NormalizedSearch {</span><span class="s3">\n  </span><span class="s1">// If the server performed a rewrite, the search params used to render the</span><span class="s3">\n  </span><span class="s1">// page will be different from the params in the request URL. In this case,</span><span class="s3">\n  </span><span class="s1">// the response will include a header that gives the rewritten search query.</span><span class="s3">\n  </span><span class="s1">const rewrittenQuery = response.headers.get(NEXT_REWRITTEN_QUERY_HEADER)</span><span class="s3">\n  </span><span class="s1">if (rewrittenQuery !== null) {</span><span class="s3">\n    </span><span class="s1">return (</span><span class="s3">\n      </span><span class="s1">rewrittenQuery === '' ? '' : '?' + rewrittenQuery</span><span class="s3">\n    </span><span class="s1">) as NormalizedSearch</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">// If the header is not present, there was no rewrite, so we use the search</span><span class="s3">\n  </span><span class="s1">// query of the response URL.</span><span class="s3">\n  </span><span class="s1">return urlToUrlWithoutFlightMarker(new URL(response.url))</span><span class="s3">\n    </span><span class="s1">.search as NormalizedSearch</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getRenderedPathname(response: RSCResponse): string {</span><span class="s3">\n  </span><span class="s1">// If the server performed a rewrite, the pathname used to render the</span><span class="s3">\n  </span><span class="s1">// page will be different from the pathname in the request URL. In this case,</span><span class="s3">\n  </span><span class="s1">// the response will include a header that gives the rewritten pathname.</span><span class="s3">\n  </span><span class="s1">const rewrittenPath = response.headers.get(NEXT_REWRITTEN_PATH_HEADER)</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">rewrittenPath ?? urlToUrlWithoutFlightMarker(new URL(response.url)).pathname</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function parseDynamicParamFromURLPart(</span><span class="s3">\n  </span><span class="s1">paramType: DynamicParamTypesShort,</span><span class="s3">\n  </span><span class="s1">pathnameParts: Array&lt;string&gt;,</span><span class="s3">\n  </span><span class="s1">partIndex: number</span><span class="s3">\n</span><span class="s1">): RouteParamValue {</span><span class="s3">\n  </span><span class="s1">// This needs to match the behavior in get-dynamic-param.ts.</span><span class="s3">\n  </span><span class="s1">switch (paramType) {</span><span class="s3">\n    </span><span class="s1">// Catchalls</span><span class="s3">\n    </span><span class="s1">case 'c':</span><span class="s3">\n    </span><span class="s1">case 'ci': {</span><span class="s3">\n      </span><span class="s1">// Catchalls receive all the remaining URL parts. If there are no</span><span class="s3">\n      </span><span class="s1">// remaining pathname parts, return an empty array.</span><span class="s3">\n      </span><span class="s1">return partIndex &lt; pathnameParts.length</span><span class="s3">\n        </span><span class="s1">? pathnameParts.slice(partIndex).map((s) =&gt; encodeURIComponent(s))</span><span class="s3">\n        </span><span class="s1">: []</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">// Optional catchalls</span><span class="s3">\n    </span><span class="s1">case 'oc': {</span><span class="s3">\n      </span><span class="s1">// Optional catchalls receive all the remaining URL parts, unless this is</span><span class="s3">\n      </span><span class="s1">// the end of the pathname, in which case they return null.</span><span class="s3">\n      </span><span class="s1">return partIndex &lt; pathnameParts.length</span><span class="s3">\n        </span><span class="s1">? pathnameParts.slice(partIndex).map((s) =&gt; encodeURIComponent(s))</span><span class="s3">\n        </span><span class="s1">: null</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">// Dynamic</span><span class="s3">\n    </span><span class="s1">case 'd':</span><span class="s3">\n    </span><span class="s1">case 'di': {</span><span class="s3">\n      </span><span class="s1">if (partIndex &gt;= pathnameParts.length) {</span><span class="s3">\n        </span><span class="s1">// The route tree expected there to be more parts in the URL than there</span><span class="s3">\n        </span><span class="s1">// actually are. This could happen if the x-nextjs-rewritten-path header</span><span class="s3">\n        </span><span class="s1">// is incorrectly set, or potentially due to bug in Next.js. TODO:</span><span class="s3">\n        </span><span class="s1">// Should this be a hard error? During a prefetch, we can just abort.</span><span class="s3">\n        </span><span class="s1">// During a client navigation, we could trigger a hard refresh. But if</span><span class="s3">\n        </span><span class="s1">// it happens during initial render, we don't really have any</span><span class="s3">\n        </span><span class="s1">// recovery options.</span><span class="s3">\n        </span><span class="s1">return ''</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return encodeURIComponent(pathnameParts[partIndex])</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">paramType satisfies never</span><span class="s3">\n      </span><span class="s1">return ''</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function doesStaticSegmentAppearInURL(segment: string): boolean {</span><span class="s3">\n  </span><span class="s1">// This is not a parameterized segment; however, we need to determine</span><span class="s3">\n  </span><span class="s1">// whether or not this segment appears in the URL. For example, this route</span><span class="s3">\n  </span><span class="s1">// groups do not appear in the URL, so they should be skipped. Any other</span><span class="s3">\n  </span><span class="s1">// special cases must be handled here.</span><span class="s3">\n  </span><span class="s1">// TODO: Consider encoding this directly into the router tree instead of</span><span class="s3">\n  </span><span class="s1">// inferring it on the client based on the segment type. Something like</span><span class="s3">\n  </span><span class="s1">// a `doesAppearInURL` flag in FlightRouterState.</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">segment === ROOT_SEGMENT_REQUEST_KEY ||</span><span class="s3">\n    </span><span class="s1">// For some reason, the loader tree sometimes includes extra __PAGE__</span><span class="s3">\n    </span><span class="s1">// </span><span class="s3">\&quot;</span><span class="s1">layouts</span><span class="s3">\&quot; </span><span class="s1">when part of a parallel route. But it's not a leaf node.</span><span class="s3">\n    </span><span class="s1">// Otherwise, we wouldn't need this special case because pages are</span><span class="s3">\n    </span><span class="s1">// always leaf nodes.</span><span class="s3">\n    </span><span class="s1">// TODO: Investigate why the loader produces these fake page segments.</span><span class="s3">\n    </span><span class="s1">segment.startsWith(PAGE_SEGMENT_KEY) ||</span><span class="s3">\n    </span><span class="s1">// Route groups.</span><span class="s3">\n    </span><span class="s1">(segment[0] === '(' &amp;&amp; segment.endsWith(')')) ||</span><span class="s3">\n    </span><span class="s1">segment === DEFAULT_SEGMENT_KEY ||</span><span class="s3">\n    </span><span class="s1">segment === '/_not-found'</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">// All other segment types appear in the URL</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getCacheKeyForDynamicParam(</span><span class="s3">\n  </span><span class="s1">paramValue: RouteParamValue,</span><span class="s3">\n  </span><span class="s1">renderedSearch: NormalizedSearch</span><span class="s3">\n</span><span class="s1">): string {</span><span class="s3">\n  </span><span class="s1">// This needs to match the logic in get-dynamic-param.ts, until we're able to</span><span class="s3">\n  </span><span class="s1">// unify the various implementations so that these are always computed on</span><span class="s3">\n  </span><span class="s1">// the client.</span><span class="s3">\n  </span><span class="s1">if (typeof paramValue === 'string') {</span><span class="s3">\n    </span><span class="s1">// TODO: Refactor or remove this helper function to accept a string rather</span><span class="s3">\n    </span><span class="s1">// than the whole segment type. Also we can probably just append the</span><span class="s3">\n    </span><span class="s1">// search string instead of turning it into JSON.</span><span class="s3">\n    </span><span class="s1">const pageSegmentWithSearchParams = addSearchParamsIfPageSegment(</span><span class="s3">\n      </span><span class="s1">paramValue,</span><span class="s3">\n      </span><span class="s1">Object.fromEntries(new URLSearchParams(renderedSearch))</span><span class="s3">\n    </span><span class="s1">) as string</span><span class="s3">\n    </span><span class="s1">return pageSegmentWithSearchParams</span><span class="s3">\n  </span><span class="s1">} else if (paramValue === null) {</span><span class="s3">\n    </span><span class="s1">return ''</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">return paramValue.join('/')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function urlToUrlWithoutFlightMarker(url: URL): URL {</span><span class="s3">\n  </span><span class="s1">const urlWithoutFlightParameters = new URL(url)</span><span class="s3">\n  </span><span class="s1">urlWithoutFlightParameters.searchParams.delete(NEXT_RSC_UNION_QUERY)</span><span class="s3">\n  </span><span class="s1">if (process.env.NODE_ENV === 'production') {</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">process.env.__NEXT_CONFIG_OUTPUT === 'export' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">urlWithoutFlightParameters.pathname.endsWith('.txt')</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">const { pathname } = urlWithoutFlightParameters</span><span class="s3">\n      </span><span class="s1">const length = pathname.endsWith('/index.txt') ? 10 : 4</span><span class="s3">\n      </span><span class="s1">// Slice off `/index.txt` or `.txt` from the end of the pathname</span><span class="s3">\n      </span><span class="s1">urlWithoutFlightParameters.pathname = pathname.slice(0, -length)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return urlWithoutFlightParameters</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getParamValueFromCacheKey(</span><span class="s3">\n  </span><span class="s1">paramCacheKey: string,</span><span class="s3">\n  </span><span class="s1">paramType: DynamicParamTypesShort</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">// Turn the cache key string sent by the server (as part of FlightRouterState)</span><span class="s3">\n  </span><span class="s1">// into a value that can be passed to `useParams` and client components.</span><span class="s3">\n  </span><span class="s1">const isCatchAll = paramType === 'c' || paramType === 'oc'</span><span class="s3">\n  </span><span class="s1">if (isCatchAll) {</span><span class="s3">\n    </span><span class="s1">// Catch-all param keys are a concatenation of the path segments.</span><span class="s3">\n    </span><span class="s1">// See equivalent logic in `getSelectedParams`.</span><span class="s3">\n    </span><span class="s1">// TODO: We should just pass the array directly, rather than concatenate</span><span class="s3">\n    </span><span class="s1">// it to a string and then split it back to an array. It needs to be an</span><span class="s3">\n    </span><span class="s1">// array in some places, like when passing a key React, but we can convert</span><span class="s3">\n    </span><span class="s1">// it at runtime in those places.</span><span class="s3">\n    </span><span class="s1">return paramCacheKey.split('/')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return paramCacheKey</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;addSearchParamsIfPageSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;DEFAULT_SEGMENT_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGE_SEGMENT_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_SEGMENT_REQUEST_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_REWRITTEN_PATH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_REWRITTEN_QUERY_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RSC_UNION_QUERY&quot;</span><span class="s0">,</span><span class="s1">&quot;getRenderedSearch&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;rewrittenQuery&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;urlToUrlWithoutFlightMarker&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;search&quot;</span><span class="s0">,</span><span class="s1">&quot;getRenderedPathname&quot;</span><span class="s0">,</span><span class="s1">&quot;rewrittenPath&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;parseDynamicParamFromURLPart&quot;</span><span class="s0">,</span><span class="s1">&quot;paramType&quot;</span><span class="s0">,</span><span class="s1">&quot;pathnameParts&quot;</span><span class="s0">,</span><span class="s1">&quot;partIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;s&quot;</span><span class="s0">,</span><span class="s1">&quot;encodeURIComponent&quot;</span><span class="s0">,</span><span class="s1">&quot;doesStaticSegmentAppearInURL&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;getCacheKeyForDynamicParam&quot;</span><span class="s0">,</span><span class="s1">&quot;paramValue&quot;</span><span class="s0">,</span><span class="s1">&quot;renderedSearch&quot;</span><span class="s0">,</span><span class="s1">&quot;pageSegmentWithSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;fromEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;URLSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;urlWithoutFlightParameters&quot;</span><span class="s0">,</span><span class="s1">&quot;searchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_CONFIG_OUTPUT&quot;</span><span class="s0">,</span><span class="s1">&quot;getParamValueFromCacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;paramCacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;isCatchAll&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">753</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/router-reducer/fetch-server-response.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">// TODO: Explicitly import from client.browser</span><span class="s3">\n</span><span class="s1">// eslint-disable-next-line import/no-extraneous-dependencies</span><span class="s3">\n</span><span class="s1">import { createFromReadableStream as createFromReadableStreamBrowser } from 'react-server-dom-webpack/client'</span><span class="s3">\n\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">FlightRouterState,</span><span class="s3">\n  </span><span class="s1">NavigationFlightResponse,</span><span class="s3">\n</span><span class="s1">} from '../../../server/app-render/types'</span><span class="s3">\n\n</span><span class="s1">import type { NEXT_ROUTER_SEGMENT_PREFETCH_HEADER } from '../app-router-headers'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">NEXT_ROUTER_PREFETCH_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_ROUTER_STATE_TREE_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_RSC_UNION_QUERY,</span><span class="s3">\n  </span><span class="s1">NEXT_URL,</span><span class="s3">\n  </span><span class="s1">RSC_HEADER,</span><span class="s3">\n  </span><span class="s1">RSC_CONTENT_TYPE_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_HMR_REFRESH_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_DID_POSTPONE_HEADER,</span><span class="s3">\n  </span><span class="s1">NEXT_ROUTER_STALE_TIME_HEADER,</span><span class="s3">\n</span><span class="s1">} from '../app-router-headers'</span><span class="s3">\n</span><span class="s1">import { callServer } from '../../app-call-server'</span><span class="s3">\n</span><span class="s1">import { findSourceMapURL } from '../../app-find-source-map-url'</span><span class="s3">\n</span><span class="s1">import { PrefetchKind } from './router-reducer-types'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">normalizeFlightData,</span><span class="s3">\n  </span><span class="s1">prepareFlightRouterStateForRequest,</span><span class="s3">\n  </span><span class="s1">type NormalizedFlightData,</span><span class="s3">\n</span><span class="s1">} from '../../flight-data-helpers'</span><span class="s3">\n</span><span class="s1">import { getAppBuildId } from '../../app-build-id'</span><span class="s3">\n</span><span class="s1">import { setCacheBustingSearchParam } from './set-cache-busting-search-param'</span><span class="s3">\n</span><span class="s1">import { urlToUrlWithoutFlightMarker } from '../../route-params'</span><span class="s3">\n\n</span><span class="s1">const createFromReadableStream =</span><span class="s3">\n  </span><span class="s1">createFromReadableStreamBrowser as (typeof import('react-server-dom-webpack/client.browser'))['createFromReadableStream']</span><span class="s3">\n\n</span><span class="s1">export interface FetchServerResponseOptions {</span><span class="s3">\n  </span><span class="s1">readonly flightRouterState: FlightRouterState</span><span class="s3">\n  </span><span class="s1">readonly nextUrl: string | null</span><span class="s3">\n  </span><span class="s1">readonly prefetchKind?: PrefetchKind</span><span class="s3">\n  </span><span class="s1">readonly isHmrRefresh?: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type FetchServerResponseResult = {</span><span class="s3">\n  </span><span class="s1">flightData: NormalizedFlightData[] | string</span><span class="s3">\n  </span><span class="s1">canonicalUrl: URL | undefined</span><span class="s3">\n  </span><span class="s1">couldBeIntercepted: boolean</span><span class="s3">\n  </span><span class="s1">prerendered: boolean</span><span class="s3">\n  </span><span class="s1">postponed: boolean</span><span class="s3">\n  </span><span class="s1">staleTime: number</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type RequestHeaders = {</span><span class="s3">\n  </span><span class="s1">[RSC_HEADER]?: '1'</span><span class="s3">\n  </span><span class="s1">[NEXT_ROUTER_STATE_TREE_HEADER]?: string</span><span class="s3">\n  </span><span class="s1">[NEXT_URL]?: string</span><span class="s3">\n  </span><span class="s1">[NEXT_ROUTER_PREFETCH_HEADER]?: '1' | '2'</span><span class="s3">\n  </span><span class="s1">[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER]?: string</span><span class="s3">\n  </span><span class="s1">'x-deployment-id'?: string</span><span class="s3">\n  </span><span class="s1">[NEXT_HMR_REFRESH_HEADER]?: '1'</span><span class="s3">\n  </span><span class="s1">// A header that is only added in test mode to assert on fetch priority</span><span class="s3">\n  </span><span class="s1">'Next-Test-Fetch-Priority'?: RequestInit['priority']</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function doMpaNavigation(url: string): FetchServerResponseResult {</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">flightData: urlToUrlWithoutFlightMarker(</span><span class="s3">\n      </span><span class="s1">new URL(url, location.origin)</span><span class="s3">\n    </span><span class="s1">).toString(),</span><span class="s3">\n    </span><span class="s1">canonicalUrl: undefined,</span><span class="s3">\n    </span><span class="s1">couldBeIntercepted: false,</span><span class="s3">\n    </span><span class="s1">prerendered: false,</span><span class="s3">\n    </span><span class="s1">postponed: false,</span><span class="s3">\n    </span><span class="s1">staleTime: -1,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">let abortController = new AbortController()</span><span class="s3">\n\n</span><span class="s1">if (typeof window !== 'undefined') {</span><span class="s3">\n  </span><span class="s1">// Abort any in-flight requests when the page is unloaded, e.g. due to</span><span class="s3">\n  </span><span class="s1">// reloading the page or performing hard navigations. This allows us to ignore</span><span class="s3">\n  </span><span class="s1">// what would otherwise be a thrown TypeError when the browser cancels the</span><span class="s3">\n  </span><span class="s1">// requests.</span><span class="s3">\n  </span><span class="s1">window.addEventListener('pagehide', () =&gt; {</span><span class="s3">\n    </span><span class="s1">abortController.abort()</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">// Use a fresh AbortController instance on pageshow, e.g. when navigating back</span><span class="s3">\n  </span><span class="s1">// and the JavaScript execution context is restored by the browser.</span><span class="s3">\n  </span><span class="s1">window.addEventListener('pageshow', () =&gt; {</span><span class="s3">\n    </span><span class="s1">abortController = new AbortController()</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Fetch the flight data for the provided url. Takes in the current router state</span><span class="s3">\n </span><span class="s1">* to decide what to render server-side.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export async function fetchServerResponse(</span><span class="s3">\n  </span><span class="s1">url: URL,</span><span class="s3">\n  </span><span class="s1">options: FetchServerResponseOptions</span><span class="s3">\n</span><span class="s1">): Promise&lt;FetchServerResponseResult&gt; {</span><span class="s3">\n  </span><span class="s1">const { flightRouterState, nextUrl, prefetchKind } = options</span><span class="s3">\n\n  </span><span class="s1">const headers: RequestHeaders = {</span><span class="s3">\n    </span><span class="s1">// Enable flight response</span><span class="s3">\n    </span><span class="s1">[RSC_HEADER]: '1',</span><span class="s3">\n    </span><span class="s1">// Provide the current router state</span><span class="s3">\n    </span><span class="s1">[NEXT_ROUTER_STATE_TREE_HEADER]: prepareFlightRouterStateForRequest(</span><span class="s3">\n      </span><span class="s1">flightRouterState,</span><span class="s3">\n      </span><span class="s1">options.isHmrRefresh</span><span class="s3">\n    </span><span class="s1">),</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* Three cases:</span><span class="s3">\n   </span><span class="s1">* - `prefetchKind` is `undefined`, it means it's a normal navigation, so we want to prefetch the page data fully</span><span class="s3">\n   </span><span class="s1">* - `prefetchKind` is `full` - we want to prefetch the whole page so same as above</span><span class="s3">\n   </span><span class="s1">* - `prefetchKind` is `auto` - if the page is dynamic, prefetch the page data partially, if static prefetch the page data fully</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">if (prefetchKind === PrefetchKind.AUTO) {</span><span class="s3">\n    </span><span class="s1">headers[NEXT_ROUTER_PREFETCH_HEADER] = '1'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (process.env.NODE_ENV === 'development' &amp;&amp; options.isHmrRefresh) {</span><span class="s3">\n    </span><span class="s1">headers[NEXT_HMR_REFRESH_HEADER] = '1'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (nextUrl) {</span><span class="s3">\n    </span><span class="s1">headers[NEXT_URL] = nextUrl</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">// When creating a </span><span class="s3">\&quot;</span><span class="s1">temporary</span><span class="s3">\&quot; </span><span class="s1">prefetch (the </span><span class="s3">\&quot;</span><span class="s1">on-demand</span><span class="s3">\&quot; </span><span class="s1">prefetch that gets created on navigation, if one doesn't exist)</span><span class="s3">\n    </span><span class="s1">// we send the request with a </span><span class="s3">\&quot;</span><span class="s1">high</span><span class="s3">\&quot; </span><span class="s1">priority as it's in response to a user interaction that could be blocking a transition.</span><span class="s3">\n    </span><span class="s1">// Otherwise, all other prefetches are sent with a </span><span class="s3">\&quot;</span><span class="s1">low</span><span class="s3">\&quot; </span><span class="s1">priority.</span><span class="s3">\n    </span><span class="s1">// We use </span><span class="s3">\&quot;</span><span class="s1">auto</span><span class="s3">\&quot; </span><span class="s1">for in all other cases to match the existing default, as this function is shared outside of prefetching.</span><span class="s3">\n    </span><span class="s1">const fetchPriority = prefetchKind</span><span class="s3">\n      </span><span class="s1">? prefetchKind === PrefetchKind.TEMPORARY</span><span class="s3">\n        </span><span class="s1">? 'high'</span><span class="s3">\n        </span><span class="s1">: 'low'</span><span class="s3">\n      </span><span class="s1">: 'auto'</span><span class="s3">\n\n    </span><span class="s1">if (process.env.NODE_ENV === 'production') {</span><span class="s3">\n      </span><span class="s1">if (process.env.__NEXT_CONFIG_OUTPUT === 'export') {</span><span class="s3">\n        </span><span class="s1">// In </span><span class="s3">\&quot;</span><span class="s1">output: export</span><span class="s3">\&quot; </span><span class="s1">mode, we can't rely on headers to distinguish</span><span class="s3">\n        </span><span class="s1">// between HTML and RSC requests. Instead, we append an extra prefix</span><span class="s3">\n        </span><span class="s1">// to the request.</span><span class="s3">\n        </span><span class="s1">url = new URL(url)</span><span class="s3">\n        </span><span class="s1">if (url.pathname.endsWith('/')) {</span><span class="s3">\n          </span><span class="s1">url.pathname += 'index.txt'</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">url.pathname += '.txt'</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const res = await createFetch(</span><span class="s3">\n      </span><span class="s1">url,</span><span class="s3">\n      </span><span class="s1">headers,</span><span class="s3">\n      </span><span class="s1">fetchPriority,</span><span class="s3">\n      </span><span class="s1">abortController.signal</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">const responseUrl = urlToUrlWithoutFlightMarker(new URL(res.url))</span><span class="s3">\n    </span><span class="s1">const canonicalUrl = res.redirected ? responseUrl : undefined</span><span class="s3">\n\n    </span><span class="s1">const contentType = res.headers.get('content-type') || ''</span><span class="s3">\n    </span><span class="s1">const interception = !!res.headers.get('vary')?.includes(NEXT_URL)</span><span class="s3">\n    </span><span class="s1">const postponed = !!res.headers.get(NEXT_DID_POSTPONE_HEADER)</span><span class="s3">\n    </span><span class="s1">const staleTimeHeaderSeconds = res.headers.get(</span><span class="s3">\n      </span><span class="s1">NEXT_ROUTER_STALE_TIME_HEADER</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">const staleTime =</span><span class="s3">\n      </span><span class="s1">staleTimeHeaderSeconds !== null</span><span class="s3">\n        </span><span class="s1">? parseInt(staleTimeHeaderSeconds, 10) * 1000</span><span class="s3">\n        </span><span class="s1">: -1</span><span class="s3">\n    </span><span class="s1">let isFlightResponse = contentType.startsWith(RSC_CONTENT_TYPE_HEADER)</span><span class="s3">\n\n    </span><span class="s1">if (process.env.NODE_ENV === 'production') {</span><span class="s3">\n      </span><span class="s1">if (process.env.__NEXT_CONFIG_OUTPUT === 'export') {</span><span class="s3">\n        </span><span class="s1">if (!isFlightResponse) {</span><span class="s3">\n          </span><span class="s1">isFlightResponse = contentType.startsWith('text/plain')</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// If fetch returns something different than flight response handle it like a mpa navigation</span><span class="s3">\n    </span><span class="s1">// If the fetch was not 200, we also handle it like a mpa navigation</span><span class="s3">\n    </span><span class="s1">if (!isFlightResponse || !res.ok || !res.body) {</span><span class="s3">\n      </span><span class="s1">// in case the original URL came with a hash, preserve it before redirecting to the new URL</span><span class="s3">\n      </span><span class="s1">if (url.hash) {</span><span class="s3">\n        </span><span class="s1">responseUrl.hash = url.hash</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return doMpaNavigation(responseUrl.toString())</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// We may navigate to a page that requires a different Webpack runtime.</span><span class="s3">\n    </span><span class="s1">// In prod, every page will have the same Webpack runtime.</span><span class="s3">\n    </span><span class="s1">// In dev, the Webpack runtime is minimal for each page.</span><span class="s3">\n    </span><span class="s1">// We need to ensure the Webpack runtime is updated before executing client-side JS of the new page.</span><span class="s3">\n    </span><span class="s1">if (process.env.NODE_ENV !== 'production' &amp;&amp; !process.env.TURBOPACK) {</span><span class="s3">\n      </span><span class="s1">await (</span><span class="s3">\n        </span><span class="s1">require('../../dev/hot-reloader/app/hot-reloader-app') as typeof import('../../dev/hot-reloader/app/hot-reloader-app')</span><span class="s3">\n      </span><span class="s1">).waitForWebpackRuntimeHotUpdate()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// Handle the `fetch` readable stream that can be unwrapped by `React.use`.</span><span class="s3">\n    </span><span class="s1">const flightStream = postponed</span><span class="s3">\n      </span><span class="s1">? createUnclosingPrefetchStream(res.body)</span><span class="s3">\n      </span><span class="s1">: res.body</span><span class="s3">\n    </span><span class="s1">const response = await (createFromNextReadableStream(</span><span class="s3">\n      </span><span class="s1">flightStream</span><span class="s3">\n    </span><span class="s1">) as Promise&lt;NavigationFlightResponse&gt;)</span><span class="s3">\n\n    </span><span class="s1">if (getAppBuildId() !== response.b) {</span><span class="s3">\n      </span><span class="s1">return doMpaNavigation(res.url)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">flightData: normalizeFlightData(response.f),</span><span class="s3">\n      </span><span class="s1">canonicalUrl: canonicalUrl,</span><span class="s3">\n      </span><span class="s1">couldBeIntercepted: interception,</span><span class="s3">\n      </span><span class="s1">prerendered: response.S,</span><span class="s3">\n      </span><span class="s1">postponed,</span><span class="s3">\n      </span><span class="s1">staleTime,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} catch (err) {</span><span class="s3">\n    </span><span class="s1">if (!abortController.signal.aborted) {</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`Failed to fetch RSC payload for ${url}. Falling back to browser navigation.`,</span><span class="s3">\n        </span><span class="s1">err</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// If fetch fails handle it like a mpa navigation</span><span class="s3">\n    </span><span class="s1">// TODO-APP: Add a test for the case where a CORS request fails, e.g. external url redirect coming from the response.</span><span class="s3">\n    </span><span class="s1">// See https://github.com/vercel/next.js/issues/43605#issuecomment-1451617521 for a reproduction.</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">flightData: url.toString(),</span><span class="s3">\n      </span><span class="s1">canonicalUrl: undefined,</span><span class="s3">\n      </span><span class="s1">couldBeIntercepted: false,</span><span class="s3">\n      </span><span class="s1">prerendered: false,</span><span class="s3">\n      </span><span class="s1">postponed: false,</span><span class="s3">\n      </span><span class="s1">staleTime: -1,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// This is a subset of the standard Response type. We use a custom type for</span><span class="s3">\n</span><span class="s1">// this so we can limit which details about the response leak into the rest of</span><span class="s3">\n</span><span class="s1">// the codebase. For example, there's some custom logic for manually following</span><span class="s3">\n</span><span class="s1">// redirects, so </span><span class="s3">\&quot;</span><span class="s1">redirected</span><span class="s3">\&quot; </span><span class="s1">in this type could be a composite of multiple</span><span class="s3">\n</span><span class="s1">// browser fetch calls; however, this fact should not leak to the caller.</span><span class="s3">\n</span><span class="s1">export type RSCResponse = {</span><span class="s3">\n  </span><span class="s1">ok: boolean</span><span class="s3">\n  </span><span class="s1">redirected: boolean</span><span class="s3">\n  </span><span class="s1">headers: Headers</span><span class="s3">\n  </span><span class="s1">body: ReadableStream&lt;Uint8Array&gt; | null</span><span class="s3">\n  </span><span class="s1">status: number</span><span class="s3">\n  </span><span class="s1">url: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export async function createFetch(</span><span class="s3">\n  </span><span class="s1">url: URL,</span><span class="s3">\n  </span><span class="s1">headers: RequestHeaders,</span><span class="s3">\n  </span><span class="s1">fetchPriority: 'auto' | 'high' | 'low' | null,</span><span class="s3">\n  </span><span class="s1">signal?: AbortSignal</span><span class="s3">\n</span><span class="s1">): Promise&lt;RSCResponse&gt; {</span><span class="s3">\n  </span><span class="s1">// TODO: In output: </span><span class="s3">\&quot;</span><span class="s1">export</span><span class="s3">\&quot; </span><span class="s1">mode, the headers do nothing. Omit them (and the</span><span class="s3">\n  </span><span class="s1">// cache busting search param) from the request so they're</span><span class="s3">\n  </span><span class="s1">// maximally cacheable.</span><span class="s3">\n\n  </span><span class="s1">if (process.env.__NEXT_TEST_MODE &amp;&amp; fetchPriority !== null) {</span><span class="s3">\n    </span><span class="s1">headers['Next-Test-Fetch-Priority'] = fetchPriority</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (process.env.NEXT_DEPLOYMENT_ID) {</span><span class="s3">\n    </span><span class="s1">headers['x-deployment-id'] = process.env.NEXT_DEPLOYMENT_ID</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const fetchOptions: RequestInit = {</span><span class="s3">\n    </span><span class="s1">// Backwards compat for older browsers. `same-origin` is the default in modern browsers.</span><span class="s3">\n    </span><span class="s1">credentials: 'same-origin',</span><span class="s3">\n    </span><span class="s1">headers,</span><span class="s3">\n    </span><span class="s1">priority: fetchPriority || undefined,</span><span class="s3">\n    </span><span class="s1">signal,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">// `fetchUrl` is slightly different from `url` because we add a cache-busting</span><span class="s3">\n  </span><span class="s1">// search param to it. This should not leak outside of this function, so we</span><span class="s3">\n  </span><span class="s1">// track them separately.</span><span class="s3">\n  </span><span class="s1">let fetchUrl = new URL(url)</span><span class="s3">\n  </span><span class="s1">setCacheBustingSearchParam(fetchUrl, headers)</span><span class="s3">\n  </span><span class="s1">let browserResponse = await fetch(fetchUrl, fetchOptions)</span><span class="s3">\n\n  </span><span class="s1">// If the server responds with a redirect (e.g. 307), and the redirected</span><span class="s3">\n  </span><span class="s1">// location does not contain the cache busting search param set in the</span><span class="s3">\n  </span><span class="s1">// original request, the response is likely invalid  when following the</span><span class="s3">\n  </span><span class="s1">// redirect, the browser forwards the request headers, but since the cache</span><span class="s3">\n  </span><span class="s1">// busting search param is missing, the server will reject the request due to</span><span class="s3">\n  </span><span class="s1">// a mismatch.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// Ideally, we would be able to intercept the redirect response and perform it</span><span class="s3">\n  </span><span class="s1">// manually, instead of letting the browser automatically follow it, but this</span><span class="s3">\n  </span><span class="s1">// is not allowed by the fetch API.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// So instead, we must </span><span class="s3">\&quot;</span><span class="s1">replay</span><span class="s3">\&quot; </span><span class="s1">the redirect by fetching the new location</span><span class="s3">\n  </span><span class="s1">// again, but this time we'll append the cache busting search param to prevent</span><span class="s3">\n  </span><span class="s1">// a mismatch.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// TODO: We can optimize Next.js's built-in middleware APIs by returning a</span><span class="s3">\n  </span><span class="s1">// custom status code, to prevent the browser from automatically following it.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// This does not affect Server Action-based redirects; those are encoded</span><span class="s3">\n  </span><span class="s1">// differently, as part of the Flight body. It only affects redirects that</span><span class="s3">\n  </span><span class="s1">// occur in a middleware or a third-party proxy.</span><span class="s3">\n\n  </span><span class="s1">let redirected = browserResponse.redirected</span><span class="s3">\n  </span><span class="s1">if (process.env.__NEXT_CLIENT_VALIDATE_RSC_REQUEST_HEADERS) {</span><span class="s3">\n    </span><span class="s1">// This is to prevent a redirect loop. Same limit used by Chrome.</span><span class="s3">\n    </span><span class="s1">const MAX_REDIRECTS = 20</span><span class="s3">\n    </span><span class="s1">for (let n = 0; n &lt; MAX_REDIRECTS; n++) {</span><span class="s3">\n      </span><span class="s1">if (!browserResponse.redirected) {</span><span class="s3">\n        </span><span class="s1">// The server did not perform a redirect.</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">const responseUrl = new URL(browserResponse.url, fetchUrl)</span><span class="s3">\n      </span><span class="s1">if (responseUrl.origin !== fetchUrl.origin) {</span><span class="s3">\n        </span><span class="s1">// The server redirected to an external URL. The rest of the logic below</span><span class="s3">\n        </span><span class="s1">// is not relevant, because it only applies to internal redirects.</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">responseUrl.searchParams.get(NEXT_RSC_UNION_QUERY) ===</span><span class="s3">\n        </span><span class="s1">fetchUrl.searchParams.get(NEXT_RSC_UNION_QUERY)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">// The redirected URL already includes the cache busting search param.</span><span class="s3">\n        </span><span class="s1">// This was probably intentional. Regardless, there's no reason to</span><span class="s3">\n        </span><span class="s1">// issue another request to this URL because it already has the param</span><span class="s3">\n        </span><span class="s1">// value that we would have added below.</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">// The RSC request was redirected. Assume the response is invalid.</span><span class="s3">\n      </span><span class="s1">//</span><span class="s3">\n      </span><span class="s1">// Append the cache busting search param to the redirected URL and</span><span class="s3">\n      </span><span class="s1">// fetch again.</span><span class="s3">\n      </span><span class="s1">fetchUrl = new URL(responseUrl)</span><span class="s3">\n      </span><span class="s1">setCacheBustingSearchParam(fetchUrl, headers)</span><span class="s3">\n      </span><span class="s1">browserResponse = await fetch(fetchUrl, fetchOptions)</span><span class="s3">\n      </span><span class="s1">// We just performed a manual redirect, so this is now true.</span><span class="s3">\n      </span><span class="s1">redirected = true</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Remove the cache busting search param from the response URL, to prevent it</span><span class="s3">\n  </span><span class="s1">// from leaking outside of this function.</span><span class="s3">\n  </span><span class="s1">const responseUrl = new URL(browserResponse.url, fetchUrl)</span><span class="s3">\n  </span><span class="s1">responseUrl.searchParams.delete(NEXT_RSC_UNION_QUERY)</span><span class="s3">\n\n  </span><span class="s1">const rscResponse: RSCResponse = {</span><span class="s3">\n    </span><span class="s1">url: responseUrl.href,</span><span class="s3">\n\n    </span><span class="s1">// This is true if any redirects occurred, either automatically by the</span><span class="s3">\n    </span><span class="s1">// browser, or manually by us. So it's different from</span><span class="s3">\n    </span><span class="s1">// `browserResponse.redirected`, which only tells us whether the browser</span><span class="s3">\n    </span><span class="s1">// followed a redirect, and only for the last response in the chain.</span><span class="s3">\n    </span><span class="s1">redirected,</span><span class="s3">\n\n    </span><span class="s1">// These can be copied from the last browser response we received. We</span><span class="s3">\n    </span><span class="s1">// intentionally only expose the subset of fields that are actually used</span><span class="s3">\n    </span><span class="s1">// elsewhere in the codebase.</span><span class="s3">\n    </span><span class="s1">ok: browserResponse.ok,</span><span class="s3">\n    </span><span class="s1">headers: browserResponse.headers,</span><span class="s3">\n    </span><span class="s1">body: browserResponse.body,</span><span class="s3">\n    </span><span class="s1">status: browserResponse.status,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return rscResponse</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createFromNextReadableStream(</span><span class="s3">\n  </span><span class="s1">flightStream: ReadableStream&lt;Uint8Array&gt;</span><span class="s3">\n</span><span class="s1">): Promise&lt;unknown&gt; {</span><span class="s3">\n  </span><span class="s1">return createFromReadableStream(flightStream, {</span><span class="s3">\n    </span><span class="s1">callServer,</span><span class="s3">\n    </span><span class="s1">findSourceMapURL,</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createUnclosingPrefetchStream(</span><span class="s3">\n  </span><span class="s1">originalFlightStream: ReadableStream&lt;Uint8Array&gt;</span><span class="s3">\n</span><span class="s1">): ReadableStream&lt;Uint8Array&gt; {</span><span class="s3">\n  </span><span class="s1">// When PPR is enabled, prefetch streams may contain references that never</span><span class="s3">\n  </span><span class="s1">// resolve, because that's how we encode dynamic data access. In the decoded</span><span class="s3">\n  </span><span class="s1">// object returned by the Flight client, these are reified into hanging</span><span class="s3">\n  </span><span class="s1">// promises that suspend during render, which is effectively what we want.</span><span class="s3">\n  </span><span class="s1">// The UI resolves when it switches to the dynamic data stream</span><span class="s3">\n  </span><span class="s1">// (via useDeferredValue(dynamic, static)).</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// However, the Flight implementation currently errors if the server closes</span><span class="s3">\n  </span><span class="s1">// the response before all the references are resolved. As a cheat to work</span><span class="s3">\n  </span><span class="s1">// around this, we wrap the original stream in a new stream that never closes,</span><span class="s3">\n  </span><span class="s1">// and therefore doesn't error.</span><span class="s3">\n  </span><span class="s1">const reader = originalFlightStream.getReader()</span><span class="s3">\n  </span><span class="s1">return new ReadableStream({</span><span class="s3">\n    </span><span class="s1">async pull(controller) {</span><span class="s3">\n      </span><span class="s1">while (true) {</span><span class="s3">\n        </span><span class="s1">const { done, value } = await reader.read()</span><span class="s3">\n        </span><span class="s1">if (!done) {</span><span class="s3">\n          </span><span class="s1">// Pass to the target stream and keep consuming the Flight response</span><span class="s3">\n          </span><span class="s1">// from the server.</span><span class="s3">\n          </span><span class="s1">controller.enqueue(value)</span><span class="s3">\n          </span><span class="s1">continue</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">// The server stream has closed. Exit, but intentionally do not close</span><span class="s3">\n        </span><span class="s1">// the target stream.</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;createFromReadableStream&quot;</span><span class="s0">,</span><span class="s1">&quot;createFromReadableStreamBrowser&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_PREFETCH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_STATE_TREE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RSC_UNION_QUERY&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_URL&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;RSC_CONTENT_TYPE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_HMR_REFRESH_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_DID_POSTPONE_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_ROUTER_STALE_TIME_HEADER&quot;</span><span class="s0">,</span><span class="s1">&quot;callServer&quot;</span><span class="s0">,</span><span class="s1">&quot;findSourceMapURL&quot;</span><span class="s0">,</span><span class="s1">&quot;PrefetchKind&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeFlightData&quot;</span><span class="s0">,</span><span class="s1">&quot;prepareFlightRouterStateForRequest&quot;</span><span class="s0">,</span><span class="s1">&quot;getAppBuildId&quot;</span><span class="s0">,</span><span class="s1">&quot;setCacheBustingSearchParam&quot;</span><span class="s0">,</span><span class="s1">&quot;urlToUrlWithoutFlightMarker&quot;</span><span class="s0">,</span><span class="s1">&quot;doMpaNavigation&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;flightData&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;location&quot;</span><span class="s0">,</span><span class="s1">&quot;origin&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;canonicalUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;couldBeIntercepted&quot;</span><span class="s0">,</span><span class="s1">&quot;prerendered&quot;</span><span class="s0">,</span><span class="s1">&quot;postponed&quot;</span><span class="s0">,</span><span class="s1">&quot;staleTime&quot;</span><span class="s0">,</span><span class="s1">&quot;abortController&quot;</span><span class="s0">,</span><span class="s1">&quot;AbortController&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;addEventListener&quot;</span><span class="s0">,</span><span class="s1">&quot;abort&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchServerResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;flightRouterState&quot;</span><span class="s0">,</span><span class="s1">&quot;nextUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;prefetchKind&quot;</span><span class="s0">,</span><span class="s1">&quot;headers&quot;</span><span class="s0">,</span><span class="s1">&quot;isHmrRefresh&quot;</span><span class="s0">,</span><span class="s1">&quot;AUTO&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;res&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchPriority&quot;</span><span class="s0">,</span><span class="s1">&quot;TEMPORARY&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_CONFIG_OUTPUT&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;createFetch&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;responseUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;redirected&quot;</span><span class="s0">,</span><span class="s1">&quot;contentType&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;interception&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;staleTimeHeaderSeconds&quot;</span><span class="s0">,</span><span class="s1">&quot;parseInt&quot;</span><span class="s0">,</span><span class="s1">&quot;isFlightResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;ok&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">,</span><span class="s1">&quot;TURBOPACK&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;waitForWebpackRuntimeHotUpdate&quot;</span><span class="s0">,</span><span class="s1">&quot;flightStream&quot;</span><span class="s0">,</span><span class="s1">&quot;createUnclosingPrefetchStream&quot;</span><span class="s0">,</span><span class="s1">&quot;response&quot;</span><span class="s0">,</span><span class="s1">&quot;createFromNextReadableStream&quot;</span><span class="s0">,</span><span class="s1">&quot;b&quot;</span><span class="s0">,</span><span class="s1">&quot;f&quot;</span><span class="s0">,</span><span class="s1">&quot;S&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;aborted&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_TEST_MODE&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_DEPLOYMENT_ID&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchOptions&quot;</span><span class="s0">,</span><span class="s1">&quot;credentials&quot;</span><span class="s0">,</span><span class="s1">&quot;priority&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;browserResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;fetch&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_CLIENT_VALIDATE_RSC_REQUEST_HEADERS&quot;</span><span class="s0">,</span><span class="s1">&quot;MAX_REDIRECTS&quot;</span><span class="s0">,</span><span class="s1">&quot;n&quot;</span><span class="s0">,</span><span class="s1">&quot;searchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;rscResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;href&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;originalFlightStream&quot;</span><span class="s0">,</span><span class="s1">&quot;reader&quot;</span><span class="s0">,</span><span class="s1">&quot;getReader&quot;</span><span class="s0">,</span><span class="s1">&quot;ReadableStream&quot;</span><span class="s0">,</span><span class="s1">&quot;pull&quot;</span><span class="s0">,</span><span class="s1">&quot;controller&quot;</span><span class="s0">,</span><span class="s1">&quot;done&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;read&quot;</span><span class="s0">,</span><span class="s1">&quot;enqueue&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">990</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/unresolved-thenable.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Create a </span><span class="s3">\&quot;</span><span class="s1">Thenable</span><span class="s3">\&quot; </span><span class="s1">that does not resolve. This is used to suspend indefinitely when data is not available yet.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const unresolvedThenable = {</span><span class="s3">\n  </span><span class="s1">then: () =&gt; {},</span><span class="s3">\n</span><span class="s1">} as PromiseLike&lt;void&gt;</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;unresolvedThenable&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;CAEC,GACD;;;;AAAO,MAAMA,qBAAqB;IAChCC,MAAM,KAAO;AACf,EAAsB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1003</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/navigation-untracked.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { useContext } from 'react'</span><span class="s3">\n</span><span class="s1">import { PathnameContext } from '../../shared/lib/hooks-client-context.shared-runtime'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This checks to see if the current render has any unknown route parameters.</span><span class="s3">\n </span><span class="s1">* It's used to trigger a different render path in the error boundary.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @returns true if there are any unknown route parameters, false otherwise</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function hasFallbackRouteParams(): boolean {</span><span class="s3">\n  </span><span class="s1">if (typeof window === 'undefined') {</span><span class="s3">\n    </span><span class="s1">// AsyncLocalStorage should not be included in the client bundle.</span><span class="s3">\n    </span><span class="s1">const { workUnitAsyncStorage } =</span><span class="s3">\n      </span><span class="s1">require('../../server/app-render/work-unit-async-storage.external') as typeof import('../../server/app-render/work-unit-async-storage.external')</span><span class="s3">\n\n    </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n    </span><span class="s1">if (!workUnitStore) return false</span><span class="s3">\n\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender':</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n        </span><span class="s1">const fallbackParams = workUnitStore.fallbackRouteParams</span><span class="s3">\n        </span><span class="s1">return fallbackParams ? fallbackParams.size &gt; 0 : false</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This returns a `null` value if there are any unknown route parameters, and</span><span class="s3">\n </span><span class="s1">* otherwise returns the pathname from the context. This is an alternative to</span><span class="s3">\n </span><span class="s1">* `usePathname` that is used in the error boundary to avoid rendering the</span><span class="s3">\n </span><span class="s1">* error boundary when there are unknown route parameters. This doesn't throw</span><span class="s3">\n </span><span class="s1">* when accessed with unknown route parameters.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @returns</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function useUntrackedPathname(): string | null {</span><span class="s3">\n  </span><span class="s1">// If there are any unknown route parameters we would typically throw</span><span class="s3">\n  </span><span class="s1">// an error, but this internal method allows us to return a null value instead</span><span class="s3">\n  </span><span class="s1">// for components that do not propagate the pathname to the static shell (like</span><span class="s3">\n  </span><span class="s1">// the error boundary).</span><span class="s3">\n  </span><span class="s1">if (hasFallbackRouteParams()) {</span><span class="s3">\n    </span><span class="s1">return null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// This shouldn't cause any issues related to conditional rendering because</span><span class="s3">\n  </span><span class="s1">// the environment will be consistent for the render.</span><span class="s3">\n  </span><span class="s1">// eslint-disable-next-line react-hooks/rules-of-hooks</span><span class="s3">\n  </span><span class="s1">return useContext(PathnameContext)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;useContext&quot;</span><span class="s0">,</span><span class="s1">&quot;PathnameContext&quot;</span><span class="s0">,</span><span class="s1">&quot;hasFallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitStore&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackParams&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;size&quot;</span><span class="s0">,</span><span class="s1">&quot;useUntrackedPathname&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,UAAU,QAAQ,QAAO;AAClC,SAASC,eAAe,QAAQ,uDAAsD;;;AAEtF;;;;;CAKC,GACD,SAASC;IACP,IAAI,OAAOC,WAAW,kBAAa;QACjC,iEAAiE;QACjE,MAAM,EAAEC,oBAAoB,EAAE,GAC5BC,QAAQ;QAEV,MAAMC,gBAAgBF,qBAAqBG,QAAQ;QACnD,IAAI,CAACD,eAAe,OAAO;QAE3B,OAAQA,cAAcE,IAAI;YACxB,KAAK;YACL,KAAK;YACL,KAAK;gBACH,MAAMC,iBAAiBH,cAAcI,mBAAmB;gBACxD,OAAOD,iBAAiBA,eAAeE,IAAI,GAAG,IAAI;YACpD,KAAK;YACL,KAAK;YACL,KAAK;YACL,KAAK;YACL,KAAK;YACL,KAAK;gBACH;YACF;gBACEL;QACJ;QAEA,OAAO;IACT;;;AAGF;AAaO,SAASM;IACd,qEAAqE;IACrE,8EAA8E;IAC9E,8EAA8E;IAC9E,uBAAuB;IACvB,IAAIV,0BAA0B;QAC5B,OAAO;IACT;IAEA,2EAA2E;IAC3E,qDAAqD;IACrD,sDAAsD;IACtD,WAAOF,mNAAAA,EAAWC,kPAAAA;AACpB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1060</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/http-access-fallback/http-access-fallback.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export const HTTPAccessErrorStatus = {</span><span class="s3">\n  </span><span class="s1">NOT_FOUND: 404,</span><span class="s3">\n  </span><span class="s1">FORBIDDEN: 403,</span><span class="s3">\n  </span><span class="s1">UNAUTHORIZED: 401,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const ALLOWED_CODES = new Set(Object.values(HTTPAccessErrorStatus))</span><span class="s3">\n\n</span><span class="s1">export const HTTP_ERROR_FALLBACK_ERROR_CODE = 'NEXT_HTTP_ERROR_FALLBACK'</span><span class="s3">\n\n</span><span class="s1">export type HTTPAccessFallbackError = Error &amp; {</span><span class="s3">\n  </span><span class="s1">digest: `${typeof HTTP_ERROR_FALLBACK_ERROR_CODE};${string}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Checks an error to determine if it's an error generated by</span><span class="s3">\n </span><span class="s1">* the HTTP navigation APIs `notFound()`, `forbidden()` or `unauthorized()`.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param error the error that may reference a HTTP access error</span><span class="s3">\n </span><span class="s1">* @returns true if the error is a HTTP access error</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function isHTTPAccessFallbackError(</span><span class="s3">\n  </span><span class="s1">error: unknown</span><span class="s3">\n</span><span class="s1">): error is HTTPAccessFallbackError {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">typeof error !== 'object' ||</span><span class="s3">\n    </span><span class="s1">error === null ||</span><span class="s3">\n    </span><span class="s1">!('digest' in error) ||</span><span class="s3">\n    </span><span class="s1">typeof error.digest !== 'string'</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const [prefix, httpStatus] = error.digest.split(';')</span><span class="s3">\n\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">prefix === HTTP_ERROR_FALLBACK_ERROR_CODE &amp;&amp;</span><span class="s3">\n    </span><span class="s1">ALLOWED_CODES.has(Number(httpStatus))</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getAccessFallbackHTTPStatus(</span><span class="s3">\n  </span><span class="s1">error: HTTPAccessFallbackError</span><span class="s3">\n</span><span class="s1">): number {</span><span class="s3">\n  </span><span class="s1">const httpStatus = error.digest.split(';')[1]</span><span class="s3">\n  </span><span class="s1">return Number(httpStatus)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getAccessFallbackErrorTypeByStatus(</span><span class="s3">\n  </span><span class="s1">status: number</span><span class="s3">\n</span><span class="s1">): 'not-found' | 'forbidden' | 'unauthorized' | undefined {</span><span class="s3">\n  </span><span class="s1">switch (status) {</span><span class="s3">\n    </span><span class="s1">case 401:</span><span class="s3">\n      </span><span class="s1">return 'unauthorized'</span><span class="s3">\n    </span><span class="s1">case 403:</span><span class="s3">\n      </span><span class="s1">return 'forbidden'</span><span class="s3">\n    </span><span class="s1">case 404:</span><span class="s3">\n      </span><span class="s1">return 'not-found'</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;HTTPAccessErrorStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;NOT_FOUND&quot;</span><span class="s0">,</span><span class="s1">&quot;FORBIDDEN&quot;</span><span class="s0">,</span><span class="s1">&quot;UNAUTHORIZED&quot;</span><span class="s0">,</span><span class="s1">&quot;ALLOWED_CODES&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;HTTP_ERROR_FALLBACK_ERROR_CODE&quot;</span><span class="s0">,</span><span class="s1">&quot;isHTTPAccessFallbackError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;httpStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;Number&quot;</span><span class="s0">,</span><span class="s1">&quot;getAccessFallbackHTTPStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;getAccessFallbackErrorTypeByStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;AAAO,MAAMA,wBAAwB;IACnCC,WAAW;IACXC,WAAW;IACXC,cAAc;AAChB,EAAC;AAED,MAAMC,gBAAgB,IAAIC,IAAIC,OAAOC,MAAM,CAACP;AAErC,MAAMQ,iCAAiC,2BAA0B;AAajE,SAASC,0BACdC,KAAc;IAEd,IACE,OAAOA,UAAU,YACjBA,UAAU,QACV,CAAE,CAAA,YAAYA,KAAI,KAClB,OAAOA,MAAMC,MAAM,KAAK,UACxB;QACA,OAAO;IACT;IACA,MAAM,CAACC,QAAQC,WAAW,GAAGH,MAAMC,MAAM,CAACG,KAAK,CAAC;IAEhD,OACEF,WAAWJ,kCACXJ,cAAcW,GAAG,CAACC,OAAOH;AAE7B;AAEO,SAASI,4BACdP,KAA8B;IAE9B,MAAMG,aAAaH,MAAMC,MAAM,CAACG,KAAK,CAAC,IAAI,CAAC,EAAE;IAC7C,OAAOE,OAAOH;AAChB;AAEO,SAASK,mCACdC,MAAc;IAEd,OAAQA;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT;YACE;IACJ;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1106</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/redirect-status-code.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export enum RedirectStatusCode {</span><span class="s3">\n  </span><span class="s1">SeeOther = 303,</span><span class="s3">\n  </span><span class="s1">TemporaryRedirect = 307,</span><span class="s3">\n  </span><span class="s1">PermanentRedirect = 308,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RedirectStatusCode&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,IAAKA,qBAAAA,WAAAA,GAAAA,SAAAA,kBAAAA;;;;WAAAA;MAIX&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1120</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/redirect-error.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { RedirectStatusCode } from './redirect-status-code'</span><span class="s3">\n\n</span><span class="s1">export const REDIRECT_ERROR_CODE = 'NEXT_REDIRECT'</span><span class="s3">\n\n</span><span class="s1">export enum RedirectType {</span><span class="s3">\n  </span><span class="s1">push = 'push',</span><span class="s3">\n  </span><span class="s1">replace = 'replace',</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type RedirectError = Error &amp; {</span><span class="s3">\n  </span><span class="s1">digest: `${typeof REDIRECT_ERROR_CODE};${RedirectType};${string};${RedirectStatusCode};`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Checks an error to determine if it's an error generated by the</span><span class="s3">\n </span><span class="s1">* `redirect(url)` helper.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param error the error that may reference a redirect error</span><span class="s3">\n </span><span class="s1">* @returns true if the error is a redirect error</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function isRedirectError(error: unknown): error is RedirectError {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">typeof error !== 'object' ||</span><span class="s3">\n    </span><span class="s1">error === null ||</span><span class="s3">\n    </span><span class="s1">!('digest' in error) ||</span><span class="s3">\n    </span><span class="s1">typeof error.digest !== 'string'</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const digest = error.digest.split(';')</span><span class="s3">\n  </span><span class="s1">const [errorCode, type] = digest</span><span class="s3">\n  </span><span class="s1">const destination = digest.slice(2, -2).join(';')</span><span class="s3">\n  </span><span class="s1">const status = digest.at(-2)</span><span class="s3">\n\n  </span><span class="s1">const statusCode = Number(status)</span><span class="s3">\n\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">errorCode === REDIRECT_ERROR_CODE &amp;&amp;</span><span class="s3">\n    </span><span class="s1">(type === 'replace' || type === 'push') &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof destination === 'string' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">!isNaN(statusCode) &amp;&amp;</span><span class="s3">\n    </span><span class="s1">statusCode in RedirectStatusCode</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RedirectStatusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;REDIRECT_ERROR_CODE&quot;</span><span class="s0">,</span><span class="s1">&quot;RedirectType&quot;</span><span class="s0">,</span><span class="s1">&quot;isRedirectError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;errorCode&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;destination&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;status&quot;</span><span class="s0">,</span><span class="s1">&quot;at&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;Number&quot;</span><span class="s0">,</span><span class="s1">&quot;isNaN&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;AAAA,SAASA,kBAAkB,QAAQ,yBAAwB;;AAEpD,MAAMC,sBAAsB,gBAAe;AAE3C,IAAKC,eAAAA,WAAAA,GAAAA,SAAAA,YAAAA;;;WAAAA;MAGX;AAaM,SAASC,gBAAgBC,KAAc;IAC5C,IACE,OAAOA,UAAU,YACjBA,UAAU,QACV,CAAE,CAAA,YAAYA,KAAI,KAClB,OAAOA,MAAMC,MAAM,KAAK,UACxB;QACA,OAAO;IACT;IAEA,MAAMA,SAASD,MAAMC,MAAM,CAACC,KAAK,CAAC;IAClC,MAAM,CAACC,WAAWC,KAAK,GAAGH;IAC1B,MAAMI,cAAcJ,OAAOK,KAAK,CAAC,GAAG,CAAC,GAAGC,IAAI,CAAC;IAC7C,MAAMC,SAASP,OAAOQ,EAAE,CAAC,CAAC;IAE1B,MAAMC,aAAaC,OAAOH;IAE1B,OACEL,cAAcN,uBACbO,CAAAA,SAAS,aAAaA,SAAS,MAAK,KACrC,OAAOC,gBAAgB,YACvB,CAACO,MAAMF,eACPA,cAAcd,+MAAAA;AAElB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1151</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/is-next-router-error.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">isHTTPAccessFallbackError,</span><span class="s3">\n  </span><span class="s1">type HTTPAccessFallbackError,</span><span class="s3">\n</span><span class="s1">} from './http-access-fallback/http-access-fallback'</span><span class="s3">\n</span><span class="s1">import { isRedirectError, type RedirectError } from './redirect-error'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Returns true if the error is a navigation signal error. These errors are</span><span class="s3">\n </span><span class="s1">* thrown by user code to perform navigation operations and interrupt the React</span><span class="s3">\n </span><span class="s1">* render.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function isNextRouterError(</span><span class="s3">\n  </span><span class="s1">error: unknown</span><span class="s3">\n</span><span class="s1">): error is RedirectError | HTTPAccessFallbackError {</span><span class="s3">\n  </span><span class="s1">return isRedirectError(error) || isHTTPAccessFallbackError(error)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isHTTPAccessFallbackError&quot;</span><span class="s0">,</span><span class="s1">&quot;isRedirectError&quot;</span><span class="s0">,</span><span class="s1">&quot;isNextRouterError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SACEA,yBAAyB,QAEpB,8CAA6C;AACpD,SAASC,eAAe,QAA4B,mBAAkB;;;AAO/D,SAASC,kBACdC,KAAc;IAEd,WAAOF,mMAAAA,EAAgBE,cAAUH,oPAAAA,EAA0BG;AAC7D&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1166</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/router-reducer/create-href-from-url.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export function createHrefFromUrl(</span><span class="s3">\n  </span><span class="s1">url: Pick&lt;URL, 'pathname' | 'search' | 'hash'&gt;,</span><span class="s3">\n  </span><span class="s1">includeHash: boolean = true</span><span class="s3">\n</span><span class="s1">): string {</span><span class="s3">\n  </span><span class="s1">return url.pathname + url.search + (includeHash ? url.hash : '')</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;createHrefFromUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;includeHash&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;search&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,SAASA,kBACdC,GAA8C,EAC9CC,WAA2B;IAA3BA,IAAAA,gBAAAA,KAAAA,GAAAA,cAAuB;IAEvB,OAAOD,IAAIE,QAAQ,GAAGF,IAAIG,MAAM,GAAIF,CAAAA,cAAcD,IAAII,IAAI,GAAG,EAAC;AAChE&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1178</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/nav-failure-handler.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { useEffect } from 'react'</span><span class="s3">\n</span><span class="s1">import { createHrefFromUrl } from './router-reducer/create-href-from-url'</span><span class="s3">\n\n</span><span class="s1">export function handleHardNavError(error: unknown): boolean {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">error &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof window !== 'undefined' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">window.next.__pendingUrl &amp;&amp;</span><span class="s3">\n    </span><span class="s1">createHrefFromUrl(new URL(window.location.href)) !==</span><span class="s3">\n      </span><span class="s1">createHrefFromUrl(window.next.__pendingUrl)</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">console.error(</span><span class="s3">\n      </span><span class="s1">`Error occurred during navigation, falling back to hard navigation`,</span><span class="s3">\n      </span><span class="s1">error</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">window.location.href = window.next.__pendingUrl.toString()</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function useNavFailureHandler() {</span><span class="s3">\n  </span><span class="s1">if (process.env.__NEXT_APP_NAV_FAIL_HANDLING) {</span><span class="s3">\n    </span><span class="s1">// this if is only for DCE of the feature flag not conditional</span><span class="s3">\n    </span><span class="s1">// eslint-disable-next-line react-hooks/rules-of-hooks</span><span class="s3">\n    </span><span class="s1">useEffect(() =&gt; {</span><span class="s3">\n      </span><span class="s1">const uncaughtExceptionHandler = (</span><span class="s3">\n        </span><span class="s1">evt: ErrorEvent | PromiseRejectionEvent</span><span class="s3">\n      </span><span class="s1">) =&gt; {</span><span class="s3">\n        </span><span class="s1">const error = 'reason' in evt ? evt.reason : evt.error</span><span class="s3">\n        </span><span class="s1">// if we have an unhandled exception/rejection during</span><span class="s3">\n        </span><span class="s1">// a navigation we fall back to a hard navigation to</span><span class="s3">\n        </span><span class="s1">// attempt recovering to a good state</span><span class="s3">\n        </span><span class="s1">handleHardNavError(error)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">window.addEventListener('unhandledrejection', uncaughtExceptionHandler)</span><span class="s3">\n      </span><span class="s1">window.addEventListener('error', uncaughtExceptionHandler)</span><span class="s3">\n      </span><span class="s1">return () =&gt; {</span><span class="s3">\n        </span><span class="s1">window.removeEventListener('error', uncaughtExceptionHandler)</span><span class="s3">\n        </span><span class="s1">window.removeEventListener(</span><span class="s3">\n          </span><span class="s1">'unhandledrejection',</span><span class="s3">\n          </span><span class="s1">uncaughtExceptionHandler</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}, [])</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;useEffect&quot;</span><span class="s0">,</span><span class="s1">&quot;createHrefFromUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;handleHardNavError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;next&quot;</span><span class="s0">,</span><span class="s1">&quot;__pendingUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;location&quot;</span><span class="s0">,</span><span class="s1">&quot;href&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;useNavFailureHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_APP_NAV_FAIL_HANDLING&quot;</span><span class="s0">,</span><span class="s1">&quot;uncaughtExceptionHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;evt&quot;</span><span class="s0">,</span><span class="s1">&quot;reason&quot;</span><span class="s0">,</span><span class="s1">&quot;addEventListener&quot;</span><span class="s0">,</span><span class="s1">&quot;removeEventListener&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAAA,SAASA,SAAS,QAAQ,QAAO;AACjC,SAASC,iBAAiB,QAAQ,wCAAuC;;;AAElE,SAASC,mBAAmBC,KAAc;IAC/C,IACEA,SACA,OAAOC,SAAW,eAClBA,OAAOC,IAAI,CAACC,YAAY,QACxBL,sOAAAA,EAAkB,IAAIM,IAAIH,OAAOI,QAAQ,CAACC,IAAI,WAC5CR,sOAAAA,EAAkBG,OAAOC,IAAI,CAACC,YAAY,GAC5C;;IAQF,OAAO;AACT;AAEO,SAASM;IACd,IAAIC,QAAQC,GAAG,CAACC,4BAA4B,EAAE;;AAwBhD&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1201</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/handle-isr-error.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const workAsyncStorage =</span><span class="s3">\n  </span><span class="s1">typeof window === 'undefined'</span><span class="s3">\n    </span><span class="s1">? (</span><span class="s3">\n        </span><span class="s1">require('../../server/app-render/work-async-storage.external') as typeof import('../../server/app-render/work-async-storage.external')</span><span class="s3">\n      </span><span class="s1">).workAsyncStorage</span><span class="s3">\n    </span><span class="s1">: undefined</span><span class="s3">\n\n</span><span class="s1">// if we are revalidating we want to re-throw the error so the</span><span class="s3">\n</span><span class="s1">// function crashes so we can maintain our previous cache</span><span class="s3">\n</span><span class="s1">// instead of caching the error page</span><span class="s3">\n</span><span class="s1">export function HandleISRError({ error }: { error: any }) {</span><span class="s3">\n  </span><span class="s1">if (workAsyncStorage) {</span><span class="s3">\n    </span><span class="s1">const store = workAsyncStorage.getStore()</span><span class="s3">\n    </span><span class="s1">if (store?.isRevalidate || store?.isStaticGeneration) {</span><span class="s3">\n      </span><span class="s1">console.error(error)</span><span class="s3">\n      </span><span class="s1">throw error</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;HandleISRError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;store&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;isRevalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;isStaticGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,MAAMA,mBACJ,OAAOC,WAAW,qBAEZC,QAAQ,uKACRF,gBAAgB,GAClBG;AAKC,SAASC,eAAe,KAAyB;IAAzB,IAAA,EAAEC,KAAK,EAAkB,GAAzB;IAC7B,IAAIL,kBAAkB;QACpB,MAAMM,QAAQN,iBAAiBO,QAAQ;QACvC,IAAID,CAAAA,SAAAA,OAAAA,KAAAA,IAAAA,MAAOE,YAAY,KAAA,CAAIF,SAAAA,OAAAA,KAAAA,IAAAA,MAAOG,kBAAkB,GAAE;YACpDC,QAAQL,KAAK,CAACA;YACd,MAAMA;QACR;IACF;IAEA,OAAO;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1221</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/html-bots.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// This regex contains the bots that we need to do a blocking render for and can't safely stream the response</span><span class="s3">\n</span><span class="s1">// due to how they parse the DOM. For example, they might explicitly check for metadata in the `head` tag, so we can't stream metadata tags after the `head` was sent.</span><span class="s3">\n</span><span class="s1">// Note: The pattern [</span><span class="s3">\\</span><span class="s1">w-]+-Google captures all Google crawlers with </span><span class="s3">\&quot;</span><span class="s1">-Google</span><span class="s3">\&quot; </span><span class="s1">suffix (e.g., Mediapartners-Google, AdsBot-Google, Storebot-Google)</span><span class="s3">\n</span><span class="s1">// as well as crawlers starting with </span><span class="s3">\&quot;</span><span class="s1">Google-</span><span class="s3">\&quot; </span><span class="s1">(e.g., Google-PageRenderer, Google-InspectionTool)</span><span class="s3">\n</span><span class="s1">export const HTML_LIMITED_BOT_UA_RE =</span><span class="s3">\n  </span><span class="s1">/[</span><span class="s3">\\</span><span class="s1">w-]+-Google|Google-[</span><span class="s3">\\</span><span class="s1">w-]+|Chrome-Lighthouse|Slurp|DuckDuckBot|baiduspider|yandex|sogou|bitlybot|tumblr|vkShare|quora link preview|redditbot|ia_archiver|Bingbot|BingPreview|applebot|facebookexternalhit|facebookcatalog|Twitterbot|LinkedInBot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|Yeti|googleweblight/i</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;HTML_LIMITED_BOT_UA_RE&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,6GAA6G;AAC7G,sKAAsK;AACtK,kJAAkJ;AAClJ,iGAAiG;;;;;AAC1F,MAAMA,yBACX,sTAAqT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1234</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/is-bot.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { HTML_LIMITED_BOT_UA_RE } from './html-bots'</span><span class="s3">\n\n</span><span class="s1">// Bot crawler that will spin up a headless browser and execute JS.</span><span class="s3">\n</span><span class="s1">// Only the main Googlebot search crawler executes JavaScript, not other Google crawlers.</span><span class="s3">\n</span><span class="s1">// x-ref: https://developers.google.com/search/docs/crawling-indexing/google-common-crawlers</span><span class="s3">\n</span><span class="s1">// This regex specifically matches </span><span class="s3">\&quot;</span><span class="s1">Googlebot</span><span class="s3">\&quot; </span><span class="s1">but NOT </span><span class="s3">\&quot;</span><span class="s1">Mediapartners-Google</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">AdsBot-Google</span><span class="s3">\&quot;</span><span class="s1">, etc.</span><span class="s3">\n</span><span class="s1">const HEADLESS_BROWSER_BOT_UA_RE = /Googlebot(?!-)|Googlebot$/i</span><span class="s3">\n\n</span><span class="s1">export const HTML_LIMITED_BOT_UA_RE_STRING = HTML_LIMITED_BOT_UA_RE.source</span><span class="s3">\n\n</span><span class="s1">export { HTML_LIMITED_BOT_UA_RE }</span><span class="s3">\n\n</span><span class="s1">function isDomBotUA(userAgent: string) {</span><span class="s3">\n  </span><span class="s1">return HEADLESS_BROWSER_BOT_UA_RE.test(userAgent)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function isHtmlLimitedBotUA(userAgent: string) {</span><span class="s3">\n  </span><span class="s1">return HTML_LIMITED_BOT_UA_RE.test(userAgent)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isBot(userAgent: string): boolean {</span><span class="s3">\n  </span><span class="s1">return isDomBotUA(userAgent) || isHtmlLimitedBotUA(userAgent)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getBotType(userAgent: string): 'dom' | 'html' | undefined {</span><span class="s3">\n  </span><span class="s1">if (isDomBotUA(userAgent)) {</span><span class="s3">\n    </span><span class="s1">return 'dom'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (isHtmlLimitedBotUA(userAgent)) {</span><span class="s3">\n    </span><span class="s1">return 'html'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;HTML_LIMITED_BOT_UA_RE&quot;</span><span class="s0">,</span><span class="s1">&quot;HEADLESS_BROWSER_BOT_UA_RE&quot;</span><span class="s0">,</span><span class="s1">&quot;HTML_LIMITED_BOT_UA_RE_STRING&quot;</span><span class="s0">,</span><span class="s1">&quot;source&quot;</span><span class="s0">,</span><span class="s1">&quot;isDomBotUA&quot;</span><span class="s0">,</span><span class="s1">&quot;userAgent&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;isHtmlLimitedBotUA&quot;</span><span class="s0">,</span><span class="s1">&quot;isBot&quot;</span><span class="s0">,</span><span class="s1">&quot;getBotType&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;AAAA,SAASA,sBAAsB,QAAQ,cAAa;;AAEpD,mEAAmE;AACnE,yFAAyF;AACzF,4FAA4F;AAC5F,oGAAoG;AACpG,MAAMC,6BAA6B;AAE5B,MAAMC,gCAAgCF,iNAAAA,CAAuBG,MAAM,CAAA;;AAI1E,SAASC,WAAWC,SAAiB;IACnC,OAAOJ,2BAA2BK,IAAI,CAACD;AACzC;AAEA,SAASE,mBAAmBF,SAAiB;IAC3C,OAAOL,iNAAAA,CAAuBM,IAAI,CAACD;AACrC;AAEO,SAASG,MAAMH,SAAiB;IACrC,OAAOD,WAAWC,cAAcE,mBAAmBF;AACrD;AAEO,SAASI,WAAWJ,SAAiB;IAC1C,IAAID,WAAWC,YAAY;QACzB,OAAO;IACT;IACA,IAAIE,mBAAmBF,YAAY;QACjC,OAAO;IACT;IACA,OAAOK;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1273</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/error-boundary.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">import React, { type JSX } from 'react'</span><span class="s3">\n</span><span class="s1">import { useUntrackedPathname } from './navigation-untracked'</span><span class="s3">\n</span><span class="s1">import { isNextRouterError } from './is-next-router-error'</span><span class="s3">\n</span><span class="s1">import { handleHardNavError } from './nav-failure-handler'</span><span class="s3">\n</span><span class="s1">import { HandleISRError } from './handle-isr-error'</span><span class="s3">\n</span><span class="s1">import { isBot } from '../../shared/lib/router/utils/is-bot'</span><span class="s3">\n\n</span><span class="s1">const isBotUserAgent =</span><span class="s3">\n  </span><span class="s1">typeof window !== 'undefined' &amp;&amp; isBot(window.navigator.userAgent)</span><span class="s3">\n\n</span><span class="s1">export type ErrorComponent = React.ComponentType&lt;{</span><span class="s3">\n  </span><span class="s1">error: Error</span><span class="s3">\n  </span><span class="s1">// global-error, there's no `reset` function;</span><span class="s3">\n  </span><span class="s1">// regular error boundary, there's a `reset` function.</span><span class="s3">\n  </span><span class="s1">reset?: () =&gt; void</span><span class="s3">\n</span><span class="s1">}&gt;</span><span class="s3">\n\n</span><span class="s1">export interface ErrorBoundaryProps {</span><span class="s3">\n  </span><span class="s1">children?: React.ReactNode</span><span class="s3">\n  </span><span class="s1">errorComponent: ErrorComponent | undefined</span><span class="s3">\n  </span><span class="s1">errorStyles?: React.ReactNode | undefined</span><span class="s3">\n  </span><span class="s1">errorScripts?: React.ReactNode | undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface ErrorBoundaryHandlerProps extends ErrorBoundaryProps {</span><span class="s3">\n  </span><span class="s1">pathname: string | null</span><span class="s3">\n  </span><span class="s1">errorComponent: ErrorComponent</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface ErrorBoundaryHandlerState {</span><span class="s3">\n  </span><span class="s1">error: Error | null</span><span class="s3">\n  </span><span class="s1">previousPathname: string | null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class ErrorBoundaryHandler extends React.Component&lt;</span><span class="s3">\n  </span><span class="s1">ErrorBoundaryHandlerProps,</span><span class="s3">\n  </span><span class="s1">ErrorBoundaryHandlerState</span><span class="s3">\n</span><span class="s1">&gt; {</span><span class="s3">\n  </span><span class="s1">constructor(props: ErrorBoundaryHandlerProps) {</span><span class="s3">\n    </span><span class="s1">super(props)</span><span class="s3">\n    </span><span class="s1">this.state = { error: null, previousPathname: this.props.pathname }</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static getDerivedStateFromError(error: Error) {</span><span class="s3">\n    </span><span class="s1">if (isNextRouterError(error)) {</span><span class="s3">\n      </span><span class="s1">// Re-throw if an expected internal Next.js router error occurs</span><span class="s3">\n      </span><span class="s1">// this means it should be handled by a different boundary (such as a NotFound boundary in a parent segment)</span><span class="s3">\n      </span><span class="s1">throw error</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return { error }</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static getDerivedStateFromProps(</span><span class="s3">\n    </span><span class="s1">props: ErrorBoundaryHandlerProps,</span><span class="s3">\n    </span><span class="s1">state: ErrorBoundaryHandlerState</span><span class="s3">\n  </span><span class="s1">): ErrorBoundaryHandlerState | null {</span><span class="s3">\n    </span><span class="s1">const { error } = state</span><span class="s3">\n\n    </span><span class="s1">// if we encounter an error while</span><span class="s3">\n    </span><span class="s1">// a navigation is pending we shouldn't render</span><span class="s3">\n    </span><span class="s1">// the error boundary and instead should fallback</span><span class="s3">\n    </span><span class="s1">// to a hard navigation to attempt recovering</span><span class="s3">\n    </span><span class="s1">if (process.env.__NEXT_APP_NAV_FAIL_HANDLING) {</span><span class="s3">\n      </span><span class="s1">if (error &amp;&amp; handleHardNavError(error)) {</span><span class="s3">\n        </span><span class="s1">// clear error so we don't render anything</span><span class="s3">\n        </span><span class="s1">return {</span><span class="s3">\n          </span><span class="s1">error: null,</span><span class="s3">\n          </span><span class="s1">previousPathname: props.pathname,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* Handles reset of the error boundary when a navigation happens.</span><span class="s3">\n     </span><span class="s1">* Ensures the error boundary does not stay enabled when navigating to a new page.</span><span class="s3">\n     </span><span class="s1">* Approach of setState in render is safe as it checks the previous pathname and then overrides</span><span class="s3">\n     </span><span class="s1">* it as outlined in https://react.dev/reference/react/useState#storing-information-from-previous-renders</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">if (props.pathname !== state.previousPathname &amp;&amp; state.error) {</span><span class="s3">\n      </span><span class="s1">return {</span><span class="s3">\n        </span><span class="s1">error: null,</span><span class="s3">\n        </span><span class="s1">previousPathname: props.pathname,</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">error: state.error,</span><span class="s3">\n      </span><span class="s1">previousPathname: props.pathname,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">reset = () =&gt; {</span><span class="s3">\n    </span><span class="s1">this.setState({ error: null })</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Explicit type is needed to avoid the generated `.d.ts` having a wide return type that could be specific to the `@types/react` version.</span><span class="s3">\n  </span><span class="s1">render(): React.ReactNode {</span><span class="s3">\n    </span><span class="s1">//When it's bot request, segment level error boundary will keep rendering the children,</span><span class="s3">\n    </span><span class="s1">// the final error will be caught by the root error boundary and determine wether need to apply graceful degrade.</span><span class="s3">\n    </span><span class="s1">if (this.state.error &amp;&amp; !isBotUserAgent) {</span><span class="s3">\n      </span><span class="s1">return (</span><span class="s3">\n        </span><span class="s1">&lt;&gt;</span><span class="s3">\n          </span><span class="s1">&lt;HandleISRError error={this.state.error} /&gt;</span><span class="s3">\n          </span><span class="s1">{this.props.errorStyles}</span><span class="s3">\n          </span><span class="s1">{this.props.errorScripts}</span><span class="s3">\n          </span><span class="s1">&lt;this.props.errorComponent</span><span class="s3">\n            </span><span class="s1">error={this.state.error}</span><span class="s3">\n            </span><span class="s1">reset={this.reset}</span><span class="s3">\n          </span><span class="s1">/&gt;</span><span class="s3">\n        </span><span class="s1">&lt;/&gt;</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return this.props.children</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Handles errors through `getDerivedStateFromError`.</span><span class="s3">\n </span><span class="s1">* Renders the provided error component and provides a way to `reset` the error boundary state.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Renders error boundary with the provided </span><span class="s3">\&quot;</span><span class="s1">errorComponent</span><span class="s3">\&quot; </span><span class="s1">property as the fallback.</span><span class="s3">\n </span><span class="s1">* If no </span><span class="s3">\&quot;</span><span class="s1">errorComponent</span><span class="s3">\&quot; </span><span class="s1">property is provided it renders the children without an error boundary.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function ErrorBoundary({</span><span class="s3">\n  </span><span class="s1">errorComponent,</span><span class="s3">\n  </span><span class="s1">errorStyles,</span><span class="s3">\n  </span><span class="s1">errorScripts,</span><span class="s3">\n  </span><span class="s1">children,</span><span class="s3">\n</span><span class="s1">}: ErrorBoundaryProps &amp; {</span><span class="s3">\n  </span><span class="s1">children: React.ReactNode</span><span class="s3">\n</span><span class="s1">}): JSX.Element {</span><span class="s3">\n  </span><span class="s1">// When we're rendering the missing params shell, this will return null. This</span><span class="s3">\n  </span><span class="s1">// is because we won't be rendering any not found boundaries or error</span><span class="s3">\n  </span><span class="s1">// boundaries for the missing params shell. When this runs on the client</span><span class="s3">\n  </span><span class="s1">// (where these errors can occur), we will get the correct pathname.</span><span class="s3">\n  </span><span class="s1">const pathname = useUntrackedPathname()</span><span class="s3">\n  </span><span class="s1">if (errorComponent) {</span><span class="s3">\n    </span><span class="s1">return (</span><span class="s3">\n      </span><span class="s1">&lt;ErrorBoundaryHandler</span><span class="s3">\n        </span><span class="s1">pathname={pathname}</span><span class="s3">\n        </span><span class="s1">errorComponent={errorComponent}</span><span class="s3">\n        </span><span class="s1">errorStyles={errorStyles}</span><span class="s3">\n        </span><span class="s1">errorScripts={errorScripts}</span><span class="s3">\n      </span><span class="s1">&gt;</span><span class="s3">\n        </span><span class="s1">{children}</span><span class="s3">\n      </span><span class="s1">&lt;/ErrorBoundaryHandler&gt;</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return &lt;&gt;{children}&lt;/&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;React&quot;</span><span class="s0">,</span><span class="s1">&quot;useUntrackedPathname&quot;</span><span class="s0">,</span><span class="s1">&quot;isNextRouterError&quot;</span><span class="s0">,</span><span class="s1">&quot;handleHardNavError&quot;</span><span class="s0">,</span><span class="s1">&quot;HandleISRError&quot;</span><span class="s0">,</span><span class="s1">&quot;isBot&quot;</span><span class="s0">,</span><span class="s1">&quot;isBotUserAgent&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;navigator&quot;</span><span class="s0">,</span><span class="s1">&quot;userAgent&quot;</span><span class="s0">,</span><span class="s1">&quot;ErrorBoundaryHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;Component&quot;</span><span class="s0">,</span><span class="s1">&quot;getDerivedStateFromError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;getDerivedStateFromProps&quot;</span><span class="s0">,</span><span class="s1">&quot;props&quot;</span><span class="s0">,</span><span class="s1">&quot;state&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_APP_NAV_FAIL_HANDLING&quot;</span><span class="s0">,</span><span class="s1">&quot;previousPathname&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;render&quot;</span><span class="s0">,</span><span class="s1">&quot;errorStyles&quot;</span><span class="s0">,</span><span class="s1">&quot;errorScripts&quot;</span><span class="s0">,</span><span class="s1">&quot;this&quot;</span><span class="s0">,</span><span class="s1">&quot;errorComponent&quot;</span><span class="s0">,</span><span class="s1">&quot;reset&quot;</span><span class="s0">,</span><span class="s1">&quot;children&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;setState&quot;</span><span class="s0">,</span><span class="s1">&quot;ErrorBoundary&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;AAEA,OAAOA,WAAyB,QAAO;AACvC,SAASC,oBAAoB,QAAQ,yBAAwB;AAC7D,SAASC,iBAAiB,QAAQ,yBAAwB;AAC1D,SAASC,kBAAkB,QAAQ,wBAAuB;AAC1D,SAASC,cAAc,QAAQ,qBAAoB;AACnD,SAASC,KAAK,QAAQ,uCAAsC;AAP5D;;;;;;;;AASA,MAAMC,iBACJ,OAAOC,SAAW,mBAAeF,6MAAAA,EAAME,OAAOC,SAAS,CAACC,SAAS;AA0B5D,MAAMC,6BAA6BV,gNAAAA,CAAMW,SAAS;IASvD,OAAOC,yBAAyBC,KAAY,EAAE;QAC5C,QAAIX,iNAAAA,EAAkBW,QAAQ;YAC5B,+DAA+D;YAC/D,4GAA4G;YAC5G,MAAMA;QACR;QAEA,OAAO;YAAEA;QAAM;IACjB;IAEA,OAAOC,yBACLC,KAAgC,EAChCC,KAAgC,EACE;QAClC,MAAM,EAAEH,KAAK,EAAE,GAAGG;QAElB,iCAAiC;QACjC,8CAA8C;QAC9C,iDAAiD;QACjD,6CAA6C;QAC7C,IAAIC,QAAQC,GAAG,CAACC,4BAA4B,EAAE;;QAU9C;;;;;KAKC,GACD,IAAIJ,MAAMM,QAAQ,KAAKL,MAAMI,gBAAgB,IAAIJ,MAAMH,KAAK,EAAE;YAC5D,OAAO;gBACLA,OAAO;gBACPO,kBAAkBL,MAAMM,QAAQ;YAClC;QACF;QACA,OAAO;YACLR,OAAOG,MAAMH,KAAK;YAClBO,kBAAkBL,MAAMM,QAAQ;QAClC;IACF;IAMA,yIAAyI;IACzIC,SAA0B;QACxB,uFAAuF;QACvF,iHAAiH;QACjH,IAAI,IAAI,CAACN,KAAK,CAACH,KAAK,IAAI,CAACP,gBAAgB;YACvC,OAAA,WAAA,OACE,+NAAA,EAAA,mOAAA,EAAA;;sCACE,8NAAA,EAACF,uMAAAA,EAAAA;wBAAeS,OAAO,IAAI,CAACG,KAAK,CAACH,KAAK;;oBACtC,IAAI,CAACE,KAAK,CAACQ,WAAW;oBACtB,IAAI,CAACR,KAAK,CAACS,YAAY;sCACxB,8NAAA,EAACC,IAAI,CAACV,KAAK,CAACW,cAAc,EAAA;wBACxBb,OAAO,IAAI,CAACG,KAAK,CAACH,KAAK;wBACvBc,OAAO,IAAI,CAACA,KAAK;;;;QAIzB;QAEA,OAAO,IAAI,CAACZ,KAAK,CAACa,QAAQ;IAC5B;IA5EAC,YAAYd,KAAgC,CAAE;QAC5C,KAAK,CAACA,QAAAA,IAAAA,CAoDRY,KAAAA,GAAQ;YACN,IAAI,CAACG,QAAQ,CAAC;gBAAEjB,OAAO;YAAK;QAC9B;QArDE,IAAI,CAACG,KAAK,GAAG;YAAEH,OAAO;YAAMO,kBAAkB,IAAI,CAACL,KAAK,CAACM,QAAQ;QAAC;IACpE;AA0EF;AAWO,SAASU,cAAc,KAO7B;IAP6B,IAAA,EAC5BL,cAAc,EACdH,WAAW,EACXC,YAAY,EACZI,QAAQ,EAGT,GAP6B;IAQ5B,6EAA6E;IAC7E,qEAAqE;IACrE,wEAAwE;IACxE,oEAAoE;IACpE,MAAMP,eAAWpB,8MAAAA;IACjB,IAAIyB,gBAAgB;QAClB,OAAA,WAAA,OACE,8NAAA,EAAChB,sBAAAA;YACCW,UAAUA;YACVK,gBAAgBA;YAChBH,aAAaA;YACbC,cAAcA;sBAEbI;;IAGP;IAEA,OAAA,WAAA,OAAO,8NAAA,EAAA,mOAAA,EAAA;kBAAGA;;AACZ&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1387</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/match-segments.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { Segment } from '../../server/app-render/types'</span><span class="s3">\n\n</span><span class="s1">export const matchSegment = (</span><span class="s3">\n  </span><span class="s1">existingSegment: Segment,</span><span class="s3">\n  </span><span class="s1">segment: Segment</span><span class="s3">\n</span><span class="s1">): boolean =&gt; {</span><span class="s3">\n  </span><span class="s1">// segment is either Array or string</span><span class="s3">\n  </span><span class="s1">if (typeof existingSegment === 'string') {</span><span class="s3">\n    </span><span class="s1">if (typeof segment === 'string') {</span><span class="s3">\n      </span><span class="s1">// Common case: segment is just a string</span><span class="s3">\n      </span><span class="s1">return existingSegment === segment</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (typeof segment === 'string') {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return existingSegment[0] === segment[0] &amp;&amp; existingSegment[1] === segment[1]</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;matchSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;existingSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAEO,MAAMA,eAAe,CAC1BC,iBACAC;IAEA,oCAAoC;IACpC,IAAI,OAAOD,oBAAoB,UAAU;QACvC,IAAI,OAAOC,YAAY,UAAU;YAC/B,wCAAwC;YACxC,OAAOD,oBAAoBC;QAC7B;QACA,OAAO;IACT;IAEA,IAAI,OAAOA,YAAY,UAAU;QAC/B,OAAO;IACT;IACA,OAAOD,eAAe,CAAC,EAAE,KAAKC,OAAO,CAAC,EAAE,IAAID,eAAe,CAAC,EAAE,KAAKC,OAAO,CAAC,EAAE;AAC/E,EAAC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1409</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/utils/warn-once.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;let warnOnce = (_: string) =&gt; {}</span><span class="s3">\n</span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n  </span><span class="s1">const warnings = new Set&lt;string&gt;()</span><span class="s3">\n  </span><span class="s1">warnOnce = (msg: string) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (!warnings.has(msg)) {</span><span class="s3">\n      </span><span class="s1">console.warn(msg)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">warnings.add(msg)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export { warnOnce }</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;warnOnce&quot;</span><span class="s0">,</span><span class="s1">&quot;_&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;warnings&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;msg&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;warn&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,IAAIA,WAAW,CAACC,KAAe;AAC/B,IAAIC,QAAQC,GAAG,CAACC,QAAQ,KAAK,WAAc;IACzC,MAAMC,WAAW,IAAIC;IACrBN,WAAW,CAACO;QACV,IAAI,CAACF,SAASG,GAAG,CAACD,MAAM;YACtBE,QAAQC,IAAI,CAACH;QACf;QACAF,SAASM,GAAG,CAACJ;IACf;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1429</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/disable-smooth-scroll.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { warnOnce } from '../../utils/warn-once'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Run function with `scroll-behavior: auto` applied to `&lt;html/&gt;`.</span><span class="s3">\n </span><span class="s1">* This css change will be reverted after the function finishes.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function disableSmoothScrollDuringRouteTransition(</span><span class="s3">\n  </span><span class="s1">fn: () =&gt; void,</span><span class="s3">\n  </span><span class="s1">options: { dontForceLayout?: boolean; onlyHashChange?: boolean } = {}</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">// if only the hash is changed, we don't need to disable smooth scrolling</span><span class="s3">\n  </span><span class="s1">// we only care to prevent smooth scrolling when navigating to a new page to avoid jarring UX</span><span class="s3">\n  </span><span class="s1">if (options.onlyHashChange) {</span><span class="s3">\n    </span><span class="s1">fn()</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const htmlElement = document.documentElement</span><span class="s3">\n  </span><span class="s1">const hasDataAttribute = htmlElement.dataset.scrollBehavior === 'smooth'</span><span class="s3">\n\n  </span><span class="s1">// Since this is a breaking change, this is temporarily flagged</span><span class="s3">\n  </span><span class="s1">// and will be false by default.</span><span class="s3">\n  </span><span class="s1">// In the next major (v16), this will be automatically enabled</span><span class="s3">\n  </span><span class="s1">if (process.env.__NEXT_OPTIMIZE_ROUTER_SCROLL) {</span><span class="s3">\n    </span><span class="s1">if (!hasDataAttribute) {</span><span class="s3">\n      </span><span class="s1">// No smooth scrolling configured, run directly without style manipulation</span><span class="s3">\n      </span><span class="s1">fn()</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">// Old behavior: always manipulate styles, but warn about upcoming change</span><span class="s3">\n\n    </span><span class="s1">// Warn if smooth scrolling is detected but no data attribute is present</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">process.env.NODE_ENV === 'development' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">!hasDataAttribute &amp;&amp;</span><span class="s3">\n      </span><span class="s1">getComputedStyle(htmlElement).scrollBehavior === 'smooth'</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">warnOnce(</span><span class="s3">\n        </span><span class="s1">'Detected `scroll-behavior: smooth` on the `&lt;html&gt;` element. In a future version, ' +</span><span class="s3">\n          </span><span class="s1">'Next.js will no longer automatically disable smooth scrolling during route transitions. ' +</span><span class="s3">\n          </span><span class="s1">'To prepare for this change, add `data-scroll-behavior=</span><span class="s3">\&quot;</span><span class="s1">smooth</span><span class="s3">\&quot;</span><span class="s1">` to your &lt;html&gt; element. ' +</span><span class="s3">\n          </span><span class="s1">'Learn more: https://nextjs.org/docs/messages/missing-data-scroll-behavior'</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Proceed with temporarily disabling smooth scrolling</span><span class="s3">\n  </span><span class="s1">const existing = htmlElement.style.scrollBehavior</span><span class="s3">\n  </span><span class="s1">htmlElement.style.scrollBehavior = 'auto'</span><span class="s3">\n  </span><span class="s1">if (!options.dontForceLayout) {</span><span class="s3">\n    </span><span class="s1">// In Chrome-based browsers we need to force reflow before calling `scrollTo`.</span><span class="s3">\n    </span><span class="s1">// Otherwise it will not pickup the change in scrollBehavior</span><span class="s3">\n    </span><span class="s1">// More info here: https://github.com/vercel/next.js/issues/40719#issuecomment-1336248042</span><span class="s3">\n    </span><span class="s1">htmlElement.getClientRects()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">fn()</span><span class="s3">\n  </span><span class="s1">htmlElement.style.scrollBehavior = existing</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;warnOnce&quot;</span><span class="s0">,</span><span class="s1">&quot;disableSmoothScrollDuringRouteTransition&quot;</span><span class="s0">,</span><span class="s1">&quot;fn&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;onlyHashChange&quot;</span><span class="s0">,</span><span class="s1">&quot;htmlElement&quot;</span><span class="s0">,</span><span class="s1">&quot;document&quot;</span><span class="s0">,</span><span class="s1">&quot;documentElement&quot;</span><span class="s0">,</span><span class="s1">&quot;hasDataAttribute&quot;</span><span class="s0">,</span><span class="s1">&quot;dataset&quot;</span><span class="s0">,</span><span class="s1">&quot;scrollBehavior&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_OPTIMIZE_ROUTER_SCROLL&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;getComputedStyle&quot;</span><span class="s0">,</span><span class="s1">&quot;existing&quot;</span><span class="s0">,</span><span class="s1">&quot;style&quot;</span><span class="s0">,</span><span class="s1">&quot;dontForceLayout&quot;</span><span class="s0">,</span><span class="s1">&quot;getClientRects&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,QAAQ,QAAQ,wBAAuB;;AAMzC,SAASC,yCACdC,EAAc,EACdC,OAAqE;IAArEA,IAAAA,YAAAA,KAAAA,GAAAA,UAAmE,CAAC;IAEpE,yEAAyE;IACzE,6FAA6F;IAC7F,IAAIA,QAAQC,cAAc,EAAE;QAC1BF;QACA;IACF;IAEA,MAAMG,cAAcC,SAASC,eAAe;IAC5C,MAAMC,mBAAmBH,YAAYI,OAAO,CAACC,cAAc,KAAK;IAEhE,+DAA+D;IAC/D,gCAAgC;IAChC,8DAA8D;IAC9D,IAAIC,QAAQC,GAAG,CAACC,6BAA6B,EAAE;;SAMxC;QACL,yEAAyE;QAEzE,wEAAwE;QACxE,IACEF,QAAQC,GAAG,CAACE,QAAQ,gCAAK,iBACzB,CAACN,oBACDO,iBAAiBV,aAAaK,cAAc,KAAK,UACjD;gBACAV,yLAAAA,EACE,sFACE,6FACA,6FACA;QAEN;IACF;IAEA,sDAAsD;IACtD,MAAMgB,WAAWX,YAAYY,KAAK,CAACP,cAAc;IACjDL,YAAYY,KAAK,CAACP,cAAc,GAAG;IACnC,IAAI,CAACP,QAAQe,eAAe,EAAE;QAC5B,8EAA8E;QAC9E,4DAA4D;QAC5D,yFAAyF;QACzFb,YAAYc,cAAc;IAC5B;IACAjB;IACAG,YAAYY,KAAK,CAACP,cAAc,GAAGM;AACrC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1473</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/router-reducer/reducers/get-segment-value.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { Segment } from '../../../../server/app-render/types'</span><span class="s3">\n\n</span><span class="s1">export function getSegmentValue(segment: Segment) {</span><span class="s3">\n  </span><span class="s1">return Array.isArray(segment) ? segment[1] : segment</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;getSegmentValue&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAEO,SAASA,gBAAgBC,OAAgB;IAC9C,OAAOC,MAAMC,OAAO,CAACF,WAAWA,OAAO,CAAC,EAAE,GAAGA;AAC/C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1484</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/redirect.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { RedirectStatusCode } from './redirect-status-code'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">RedirectType,</span><span class="s3">\n  </span><span class="s1">type RedirectError,</span><span class="s3">\n  </span><span class="s1">isRedirectError,</span><span class="s3">\n  </span><span class="s1">REDIRECT_ERROR_CODE,</span><span class="s3">\n</span><span class="s1">} from './redirect-error'</span><span class="s3">\n\n</span><span class="s1">const actionAsyncStorage =</span><span class="s3">\n  </span><span class="s1">typeof window === 'undefined'</span><span class="s3">\n    </span><span class="s1">? (</span><span class="s3">\n        </span><span class="s1">require('../../server/app-render/action-async-storage.external') as typeof import('../../server/app-render/action-async-storage.external')</span><span class="s3">\n      </span><span class="s1">).actionAsyncStorage</span><span class="s3">\n    </span><span class="s1">: undefined</span><span class="s3">\n\n</span><span class="s1">export function getRedirectError(</span><span class="s3">\n  </span><span class="s1">url: string,</span><span class="s3">\n  </span><span class="s1">type: RedirectType,</span><span class="s3">\n  </span><span class="s1">statusCode: RedirectStatusCode = RedirectStatusCode.TemporaryRedirect</span><span class="s3">\n</span><span class="s1">): RedirectError {</span><span class="s3">\n  </span><span class="s1">const error = new Error(REDIRECT_ERROR_CODE) as RedirectError</span><span class="s3">\n  </span><span class="s1">error.digest = `${REDIRECT_ERROR_CODE};${type};${url};${statusCode};`</span><span class="s3">\n  </span><span class="s1">return error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function allows you to redirect the user to another URL. It can be used in</span><span class="s3">\n </span><span class="s1">* [Server Components](https://nextjs.org/docs/app/building-your-application/rendering/server-components),</span><span class="s3">\n </span><span class="s1">* [Route Handlers](https://nextjs.org/docs/app/building-your-application/routing/route-handlers), and</span><span class="s3">\n </span><span class="s1">* [Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* - In a Server Component, this will insert a meta tag to redirect the user to the target page.</span><span class="s3">\n </span><span class="s1">* - In a Route Handler or Server Action, it will serve a 307/303 to the caller.</span><span class="s3">\n </span><span class="s1">* - In a Server Action, type defaults to 'push' and 'replace' elsewhere.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `redirect`](https://nextjs.org/docs/app/api-reference/functions/redirect)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function redirect(</span><span class="s3">\n  </span><span class="s1">/** The URL to redirect to */</span><span class="s3">\n  </span><span class="s1">url: string,</span><span class="s3">\n  </span><span class="s1">type?: RedirectType</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">type ??= actionAsyncStorage?.getStore()?.isAction</span><span class="s3">\n    </span><span class="s1">? RedirectType.push</span><span class="s3">\n    </span><span class="s1">: RedirectType.replace</span><span class="s3">\n\n  </span><span class="s1">throw getRedirectError(url, type, RedirectStatusCode.TemporaryRedirect)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function allows you to redirect the user to another URL. It can be used in</span><span class="s3">\n </span><span class="s1">* [Server Components](https://nextjs.org/docs/app/building-your-application/rendering/server-components),</span><span class="s3">\n </span><span class="s1">* [Route Handlers](https://nextjs.org/docs/app/building-your-application/routing/route-handlers), and</span><span class="s3">\n </span><span class="s1">* [Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* - In a Server Component, this will insert a meta tag to redirect the user to the target page.</span><span class="s3">\n </span><span class="s1">* - In a Route Handler or Server Action, it will serve a 308/303 to the caller.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `redirect`](https://nextjs.org/docs/app/api-reference/functions/redirect)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function permanentRedirect(</span><span class="s3">\n  </span><span class="s1">/** The URL to redirect to */</span><span class="s3">\n  </span><span class="s1">url: string,</span><span class="s3">\n  </span><span class="s1">type: RedirectType = RedirectType.replace</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">throw getRedirectError(url, type, RedirectStatusCode.PermanentRedirect)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Returns the encoded URL from the error if it's a RedirectError, null</span><span class="s3">\n </span><span class="s1">* otherwise. Note that this does not validate the URL returned.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param error the error that may be a redirect error</span><span class="s3">\n </span><span class="s1">* @return the url if the error was a redirect error</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function getURLFromRedirectError(error: RedirectError): string</span><span class="s3">\n</span><span class="s1">export function getURLFromRedirectError(error: unknown): string | null {</span><span class="s3">\n  </span><span class="s1">if (!isRedirectError(error)) return null</span><span class="s3">\n\n  </span><span class="s1">// Slices off the beginning of the digest that contains the code and the</span><span class="s3">\n  </span><span class="s1">// separating ';'.</span><span class="s3">\n  </span><span class="s1">return error.digest.split(';').slice(2, -2).join(';')</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getRedirectTypeFromError(error: RedirectError): RedirectType {</span><span class="s3">\n  </span><span class="s1">if (!isRedirectError(error)) {</span><span class="s3">\n    </span><span class="s1">throw new Error('Not a redirect error')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return error.digest.split(';', 2)[1] as RedirectType</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getRedirectStatusCodeFromError(error: RedirectError): number {</span><span class="s3">\n  </span><span class="s1">if (!isRedirectError(error)) {</span><span class="s3">\n    </span><span class="s1">throw new Error('Not a redirect error')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return Number(error.digest.split(';').at(-2))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RedirectStatusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;RedirectType&quot;</span><span class="s0">,</span><span class="s1">&quot;isRedirectError&quot;</span><span class="s0">,</span><span class="s1">&quot;REDIRECT_ERROR_CODE&quot;</span><span class="s0">,</span><span class="s1">&quot;actionAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;getRedirectError&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;statusCode&quot;</span><span class="s0">,</span><span class="s1">&quot;TemporaryRedirect&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;isAction&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;permanentRedirect&quot;</span><span class="s0">,</span><span class="s1">&quot;PermanentRedirect&quot;</span><span class="s0">,</span><span class="s1">&quot;getURLFromRedirectError&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;getRedirectTypeFromError&quot;</span><span class="s0">,</span><span class="s1">&quot;getRedirectStatusCodeFromError&quot;</span><span class="s0">,</span><span class="s1">&quot;Number&quot;</span><span class="s0">,</span><span class="s1">&quot;at&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;AAAA,SAASA,kBAAkB,QAAQ,yBAAwB;AAC3D,SACEC,YAAY,EAEZC,eAAe,EACfC,mBAAmB,QACd,mBAAkB;;;AAEzB,MAAMC,qBACJ,OAAOC,WAAW,qBAEZC,QAAQ,2KACRF,kBAAkB,GACpBG;AAEC,SAASC,iBACdC,GAAW,EACXC,IAAkB,EAClBC,UAAqE;IAArEA,IAAAA,eAAAA,KAAAA,GAAAA,aAAiCX,+MAAAA,CAAmBY,iBAAiB;IAErE,MAAMC,QAAQ,OAAA,cAA8B,CAA9B,IAAIC,MAAMX,uMAAAA,GAAV,qBAAA;eAAA;oBAAA;sBAAA;IAA6B;IAC3CU,MAAME,MAAM,GAAMZ,uMAAAA,GAAoB,MAAGO,OAAK,MAAGD,MAAI,MAAGE,aAAW;IACnE,OAAOE;AACT;AAcO,SAASG,SACd,2BAA2B,GAC3BP,GAAW,EACXC,IAAmB;QAEVN;IAATM,QAAAA,OAAAA,OAAAA,OAASN,CAAAA,sBAAAA,OAAAA,KAAAA,IAAAA,CAAAA,+BAAAA,mBAAoBa,QAAQ,EAAA,KAAA,OAAA,KAAA,IAA5Bb,6BAAgCc,QAAQ,IAC7CjB,gMAAAA,CAAakB,IAAI,GACjBlB,gMAAAA,CAAamB,OAAO;IAExB,MAAMZ,iBAAiBC,KAAKC,MAAMV,+MAAAA,CAAmBY,iBAAiB;AACxE;AAaO,SAASS,kBACd,2BAA2B,GAC3BZ,GAAW,EACXC,IAAyC;IAAzCA,IAAAA,SAAAA,KAAAA,GAAAA,OAAqBT,gMAAAA,CAAamB,OAAO;IAEzC,MAAMZ,iBAAiBC,KAAKC,MAAMV,+MAAAA,CAAmBsB,iBAAiB;AACxE;AAUO,SAASC,wBAAwBV,KAAc;IACpD,IAAI,KAACX,mMAAAA,EAAgBW,QAAQ,OAAO;IAEpC,wEAAwE;IACxE,kBAAkB;IAClB,OAAOA,MAAME,MAAM,CAACS,KAAK,CAAC,KAAKC,KAAK,CAAC,GAAG,CAAC,GAAGC,IAAI,CAAC;AACnD;AAEO,SAASC,yBAAyBd,KAAoB;IAC3D,IAAI,KAACX,mMAAAA,EAAgBW,QAAQ;QAC3B,MAAM,OAAA,cAAiC,CAAjC,IAAIC,MAAM,yBAAV,qBAAA;mBAAA;wBAAA;0BAAA;QAAgC;IACxC;IAEA,OAAOD,MAAME,MAAM,CAACS,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE;AACtC;AAEO,SAASI,+BAA+Bf,KAAoB;IACjE,IAAI,KAACX,mMAAAA,EAAgBW,QAAQ;QAC3B,MAAM,OAAA,cAAiC,CAAjC,IAAIC,MAAM,yBAAV,qBAAA;mBAAA;wBAAA;0BAAA;QAAgC;IACxC;IAEA,OAAOe,OAAOhB,MAAME,MAAM,CAACS,KAAK,CAAC,KAAKM,EAAE,CAAC,CAAC;AAC5C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1552</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/not-found.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">HTTP_ERROR_FALLBACK_ERROR_CODE,</span><span class="s3">\n  </span><span class="s1">type HTTPAccessFallbackError,</span><span class="s3">\n</span><span class="s1">} from './http-access-fallback/http-access-fallback'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function allows you to render the [not-found.js file](https://nextjs.org/docs/app/api-reference/file-conventions/not-found)</span><span class="s3">\n </span><span class="s1">* within a route segment as well as inject a tag.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* `notFound()` can be used in</span><span class="s3">\n </span><span class="s1">* [Server Components](https://nextjs.org/docs/app/building-your-application/rendering/server-components),</span><span class="s3">\n </span><span class="s1">* [Route Handlers](https://nextjs.org/docs/app/building-your-application/routing/route-handlers), and</span><span class="s3">\n </span><span class="s1">* [Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* - In a Server Component, this will insert a `&lt;meta name=</span><span class="s3">\&quot;</span><span class="s1">robots</span><span class="s3">\&quot; </span><span class="s1">content=</span><span class="s3">\&quot;</span><span class="s1">noindex</span><span class="s3">\&quot; </span><span class="s1">/&gt;` meta tag and set the status code to 404.</span><span class="s3">\n </span><span class="s1">* - In a Route Handler or Server Action, it will serve a 404 to the caller.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `notFound`](https://nextjs.org/docs/app/api-reference/functions/not-found)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">const DIGEST = `${HTTP_ERROR_FALLBACK_ERROR_CODE};404`</span><span class="s3">\n\n</span><span class="s1">export function notFound(): never {</span><span class="s3">\n  </span><span class="s1">// eslint-disable-next-line no-throw-literal</span><span class="s3">\n  </span><span class="s1">const error = new Error(DIGEST) as HTTPAccessFallbackError</span><span class="s3">\n  </span><span class="s1">;(error as HTTPAccessFallbackError).digest = DIGEST</span><span class="s3">\n\n  </span><span class="s1">throw error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;HTTP_ERROR_FALLBACK_ERROR_CODE&quot;</span><span class="s0">,</span><span class="s1">&quot;DIGEST&quot;</span><span class="s0">,</span><span class="s1">&quot;notFound&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SACEA,8BAA8B,QAEzB,8CAA6C;;AAEpD;;;;;;;;;;;;;CAaC,GAED,MAAMC,SAAU,KAAED,yPAAAA,GAA+B;AAE1C,SAASE;IACd,4CAA4C;IAC5C,MAAMC,QAAQ,OAAA,cAAiB,CAAjB,IAAIC,MAAMH,SAAV,qBAAA;eAAA;oBAAA;sBAAA;IAAgB;IAC5BE,MAAkCE,MAAM,GAAGJ;IAE7C,MAAME;AACR&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1586</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/forbidden.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">HTTP_ERROR_FALLBACK_ERROR_CODE,</span><span class="s3">\n  </span><span class="s1">type HTTPAccessFallbackError,</span><span class="s3">\n</span><span class="s1">} from './http-access-fallback/http-access-fallback'</span><span class="s3">\n\n</span><span class="s1">// TODO: Add `forbidden` docs</span><span class="s3">\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @experimental</span><span class="s3">\n </span><span class="s1">* This function allows you to render the [forbidden.js file](https://nextjs.org/docs/app/api-reference/file-conventions/forbidden)</span><span class="s3">\n </span><span class="s1">* within a route segment as well as inject a tag.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* `forbidden()` can be used in</span><span class="s3">\n </span><span class="s1">* [Server Components](https://nextjs.org/docs/app/building-your-application/rendering/server-components),</span><span class="s3">\n </span><span class="s1">* [Route Handlers](https://nextjs.org/docs/app/building-your-application/routing/route-handlers), and</span><span class="s3">\n </span><span class="s1">* [Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `forbidden`](https://nextjs.org/docs/app/api-reference/functions/forbidden)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">const DIGEST = `${HTTP_ERROR_FALLBACK_ERROR_CODE};403`</span><span class="s3">\n\n</span><span class="s1">export function forbidden(): never {</span><span class="s3">\n  </span><span class="s1">if (!process.env.__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`forbidden()</span><span class="s3">\\</span><span class="s1">` is experimental and only allowed to be enabled when </span><span class="s3">\\</span><span class="s1">`experimental.authInterrupts</span><span class="s3">\\</span><span class="s1">` is enabled.`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// eslint-disable-next-line no-throw-literal</span><span class="s3">\n  </span><span class="s1">const error = new Error(DIGEST) as HTTPAccessFallbackError</span><span class="s3">\n  </span><span class="s1">;(error as HTTPAccessFallbackError).digest = DIGEST</span><span class="s3">\n  </span><span class="s1">throw error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;HTTP_ERROR_FALLBACK_ERROR_CODE&quot;</span><span class="s0">,</span><span class="s1">&quot;DIGEST&quot;</span><span class="s0">,</span><span class="s1">&quot;forbidden&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SACEA,8BAA8B,QAEzB,8CAA6C;;AAEpD,6BAA6B;AAC7B;;;;;;;;;;;CAWC,GAED,MAAMC,SAAU,KAAED,yPAAAA,GAA+B;AAE1C,SAASE;IACd,IAAI,CAACC,QAAQC,GAAG,CAACC,uBAAqC,YAAF;QAClD,MAAM,OAAA,cAEL,CAFK,IAAIC,MACP,gHADG,qBAAA;mBAAA;wBAAA;0BAAA;QAEN;IACF;IAEA,4CAA4C;IAC5C,MAAMC,QAAQ,OAAA,cAAiB,CAAjB,IAAID,MAAML,SAAV,qBAAA;eAAA;oBAAA;sBAAA;IAAgB;IAC5BM,MAAkCC,MAAM,GAAGP;IAC7C,MAAMM;AACR&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1626</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/unauthorized.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">HTTP_ERROR_FALLBACK_ERROR_CODE,</span><span class="s3">\n  </span><span class="s1">type HTTPAccessFallbackError,</span><span class="s3">\n</span><span class="s1">} from './http-access-fallback/http-access-fallback'</span><span class="s3">\n\n</span><span class="s1">// TODO: Add `unauthorized` docs</span><span class="s3">\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @experimental</span><span class="s3">\n </span><span class="s1">* This function allows you to render the [unauthorized.js file](https://nextjs.org/docs/app/api-reference/file-conventions/unauthorized)</span><span class="s3">\n </span><span class="s1">* within a route segment as well as inject a tag.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* `unauthorized()` can be used in</span><span class="s3">\n </span><span class="s1">* [Server Components](https://nextjs.org/docs/app/building-your-application/rendering/server-components),</span><span class="s3">\n </span><span class="s1">* [Route Handlers](https://nextjs.org/docs/app/building-your-application/routing/route-handlers), and</span><span class="s3">\n </span><span class="s1">* [Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `unauthorized`](https://nextjs.org/docs/app/api-reference/functions/unauthorized)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">const DIGEST = `${HTTP_ERROR_FALLBACK_ERROR_CODE};401`</span><span class="s3">\n\n</span><span class="s1">export function unauthorized(): never {</span><span class="s3">\n  </span><span class="s1">if (!process.env.__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`unauthorized()</span><span class="s3">\\</span><span class="s1">` is experimental and only allowed to be used when </span><span class="s3">\\</span><span class="s1">`experimental.authInterrupts</span><span class="s3">\\</span><span class="s1">` is enabled.`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// eslint-disable-next-line no-throw-literal</span><span class="s3">\n  </span><span class="s1">const error = new Error(DIGEST) as HTTPAccessFallbackError</span><span class="s3">\n  </span><span class="s1">;(error as HTTPAccessFallbackError).digest = DIGEST</span><span class="s3">\n  </span><span class="s1">throw error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;HTTP_ERROR_FALLBACK_ERROR_CODE&quot;</span><span class="s0">,</span><span class="s1">&quot;DIGEST&quot;</span><span class="s0">,</span><span class="s1">&quot;unauthorized&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SACEA,8BAA8B,QAEzB,8CAA6C;;AAEpD,gCAAgC;AAChC;;;;;;;;;;;;CAYC,GAED,MAAMC,SAAU,KAAED,yPAAAA,GAA+B;AAE1C,SAASE;IACd,IAAI,CAACC,QAAQC,GAAG,CAACC,uBAAqC,YAAF;QAClD,MAAM,OAAA,cAEL,CAFK,IAAIC,MACP,gHADG,qBAAA;mBAAA;wBAAA;0BAAA;QAEN;IACF;IAEA,4CAA4C;IAC5C,MAAMC,QAAQ,OAAA,cAAiB,CAAjB,IAAID,MAAML,SAAV,qBAAA;eAAA;oBAAA;sBAAA;IAAgB;IAC5BM,MAAkCC,MAAM,GAAGP;IAC7C,MAAMM;AACR&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1667</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/dynamic-rendering-utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export function isHangingPromiseRejectionError(</span><span class="s3">\n  </span><span class="s1">err: unknown</span><span class="s3">\n</span><span class="s1">): err is HangingPromiseRejectionError {</span><span class="s3">\n  </span><span class="s1">if (typeof err !== 'object' || err === null || !('digest' in err)) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return err.digest === HANGING_PROMISE_REJECTION</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const HANGING_PROMISE_REJECTION = 'HANGING_PROMISE_REJECTION'</span><span class="s3">\n\n</span><span class="s1">class HangingPromiseRejectionError extends Error {</span><span class="s3">\n  </span><span class="s1">public readonly digest = HANGING_PROMISE_REJECTION</span><span class="s3">\n\n  </span><span class="s1">constructor(</span><span class="s3">\n    </span><span class="s1">public readonly route: string,</span><span class="s3">\n    </span><span class="s1">public readonly expression: string</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">super(</span><span class="s3">\n      </span><span class="s1">`During prerendering, ${expression} rejects when the prerender is complete. Typically these errors are handled by React but if you move ${expression} to a different context by using </span><span class="s3">\\</span><span class="s1">`setTimeout</span><span class="s3">\\</span><span class="s1">`, </span><span class="s3">\\</span><span class="s1">`after</span><span class="s3">\\</span><span class="s1">`, or similar functions you may observe this error and you should handle it in that context. This occurred at route </span><span class="s3">\&quot;</span><span class="s1">${route}</span><span class="s3">\&quot;</span><span class="s1">.`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type AbortListeners = Array&lt;(err: unknown) =&gt; void&gt;</span><span class="s3">\n</span><span class="s1">const abortListenersBySignal = new WeakMap&lt;AbortSignal, AbortListeners&gt;()</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function constructs a promise that will never resolve. This is primarily</span><span class="s3">\n </span><span class="s1">* useful for cacheComponents where we use promise resolution timing to determine which</span><span class="s3">\n </span><span class="s1">* parts of a render can be included in a prerender.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function makeHangingPromise&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">signal: AbortSignal,</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">): Promise&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">if (signal.aborted) {</span><span class="s3">\n    </span><span class="s1">return Promise.reject(new HangingPromiseRejectionError(route, expression))</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">const hangingPromise = new Promise&lt;T&gt;((_, reject) =&gt; {</span><span class="s3">\n      </span><span class="s1">const boundRejection = reject.bind(</span><span class="s3">\n        </span><span class="s1">null,</span><span class="s3">\n        </span><span class="s1">new HangingPromiseRejectionError(route, expression)</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">let currentListeners = abortListenersBySignal.get(signal)</span><span class="s3">\n      </span><span class="s1">if (currentListeners) {</span><span class="s3">\n        </span><span class="s1">currentListeners.push(boundRejection)</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">const listeners = [boundRejection]</span><span class="s3">\n        </span><span class="s1">abortListenersBySignal.set(signal, listeners)</span><span class="s3">\n        </span><span class="s1">signal.addEventListener(</span><span class="s3">\n          </span><span class="s1">'abort',</span><span class="s3">\n          </span><span class="s1">() =&gt; {</span><span class="s3">\n            </span><span class="s1">for (let i = 0; i &lt; listeners.length; i++) {</span><span class="s3">\n              </span><span class="s1">listeners[i]()</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">{ once: true }</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">// We are fine if no one actually awaits this promise. We shouldn't consider this an unhandled rejection so</span><span class="s3">\n    </span><span class="s1">// we attach a noop catch handler here to suppress this warning. If you actually await somewhere or construct</span><span class="s3">\n    </span><span class="s1">// your own promise out of it you'll need to ensure you handle the error when it rejects.</span><span class="s3">\n    </span><span class="s1">hangingPromise.catch(ignoreReject)</span><span class="s3">\n    </span><span class="s1">return hangingPromise</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function ignoreReject() {}</span><span class="s3">\n\n</span><span class="s1">export function makeDevtoolsIOAwarePromise&lt;T&gt;(underlying: T): Promise&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">// in React DevTools if we resolve in a setTimeout we will observe</span><span class="s3">\n  </span><span class="s1">// the promise resolution as something that can suspend a boundary or root.</span><span class="s3">\n  </span><span class="s1">return new Promise&lt;T&gt;((resolve) =&gt; {</span><span class="s3">\n    </span><span class="s1">// Must use setTimeout to be considered IO React DevTools. setImmediate will not work.</span><span class="s3">\n    </span><span class="s1">setTimeout(() =&gt; {</span><span class="s3">\n      </span><span class="s1">resolve(underlying)</span><span class="s3">\n    </span><span class="s1">}, 0)</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isHangingPromiseRejectionError&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;HANGING_PROMISE_REJECTION&quot;</span><span class="s0">,</span><span class="s1">&quot;HangingPromiseRejectionError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;abortListenersBySignal&quot;</span><span class="s0">,</span><span class="s1">&quot;WeakMap&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;aborted&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;reject&quot;</span><span class="s0">,</span><span class="s1">&quot;hangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;_&quot;</span><span class="s0">,</span><span class="s1">&quot;boundRejection&quot;</span><span class="s0">,</span><span class="s1">&quot;bind&quot;</span><span class="s0">,</span><span class="s1">&quot;currentListeners&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;listeners&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;addEventListener&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;once&quot;</span><span class="s0">,</span><span class="s1">&quot;catch&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreReject&quot;</span><span class="s0">,</span><span class="s1">&quot;makeDevtoolsIOAwarePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;underlying&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;setTimeout&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;AAAO,SAASA,+BACdC,GAAY;IAEZ,IAAI,OAAOA,QAAQ,YAAYA,QAAQ,QAAQ,CAAE,CAAA,YAAYA,GAAE,GAAI;QACjE,OAAO;IACT;IAEA,OAAOA,IAAIC,MAAM,KAAKC;AACxB;AAEA,MAAMA,4BAA4B;AAElC,MAAMC,qCAAqCC;IAGzCC,YACkBC,KAAa,EACbC,UAAkB,CAClC;QACA,KAAK,CACH,CAAC,qBAAqB,EAAEA,WAAW,qGAAqG,EAAEA,WAAW,8KAA8K,EAAED,MAAM,EAAE,CAAC,GAAA,IAAA,CAJhUA,KAAAA,GAAAA,OAAAA,IAAAA,CACAC,UAAAA,GAAAA,YAAAA,IAAAA,CAJFN,MAAAA,GAASC;IASzB;AACF;AAGA,MAAMM,yBAAyB,IAAIC;AAS5B,SAASC,mBACdC,MAAmB,EACnBL,KAAa,EACbC,UAAkB;IAElB,IAAII,OAAOC,OAAO,EAAE;QAClB,OAAOC,QAAQC,MAAM,CAAC,IAAIX,6BAA6BG,OAAOC;IAChE,OAAO;QACL,MAAMQ,iBAAiB,IAAIF,QAAW,CAACG,GAAGF;YACxC,MAAMG,iBAAiBH,OAAOI,IAAI,CAChC,MACA,IAAIf,6BAA6BG,OAAOC;YAE1C,IAAIY,mBAAmBX,uBAAuBY,GAAG,CAACT;YAClD,IAAIQ,kBAAkB;gBACpBA,iBAAiBE,IAAI,CAACJ;YACxB,OAAO;gBACL,MAAMK,YAAY;oBAACL;iBAAe;gBAClCT,uBAAuBe,GAAG,CAACZ,QAAQW;gBACnCX,OAAOa,gBAAgB,CACrB,SACA;oBACE,IAAK,IAAIC,IAAI,GAAGA,IAAIH,UAAUI,MAAM,EAAED,IAAK;wBACzCH,SAAS,CAACG,EAAE;oBACd;gBACF,GACA;oBAAEE,MAAM;gBAAK;YAEjB;QACF;QACA,2GAA2G;QAC3G,6GAA6G;QAC7G,yFAAyF;QACzFZ,eAAea,KAAK,CAACC;QACrB,OAAOd;IACT;AACF;AAEA,SAASc,gBAAgB;AAElB,SAASC,2BAA8BC,UAAa;IACzD,kEAAkE;IAClE,2EAA2E;IAC3E,OAAO,IAAIlB,QAAW,CAACmB;QACrB,sFAAsF;QACtFC,WAAW;YACTD,QAAQD;QACV,GAAG;IACL;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1733</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/lib/router-utils/is-postpone.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const REACT_POSTPONE_TYPE: symbol = Symbol.for('react.postpone')</span><span class="s3">\n\n</span><span class="s1">export function isPostpone(error: any): boolean {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">typeof error === 'object' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">error !== null &amp;&amp;</span><span class="s3">\n    </span><span class="s1">error.$$typeof === REACT_POSTPONE_TYPE</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;REACT_POSTPONE_TYPE&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;for&quot;</span><span class="s0">,</span><span class="s1">&quot;isPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;$$typeof&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,MAAMA,sBAA8BC,OAAOC,GAAG,CAAC;AAExC,SAASC,WAAWC,KAAU;IACnC,OACE,OAAOA,UAAU,YACjBA,UAAU,QACVA,MAAMC,QAAQ,KAAKL;AAEvB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1745</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/lazy-dynamic/bailout-to-csr.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// This has to be a shared module which is shared between client component error boundary and dynamic component</span><span class="s3">\n</span><span class="s1">const BAILOUT_TO_CSR = 'BAILOUT_TO_CLIENT_SIDE_RENDERING'</span><span class="s3">\n\n</span><span class="s1">/** An error that should be thrown when we want to bail out to client-side rendering. */</span><span class="s3">\n</span><span class="s1">export class BailoutToCSRError extends Error {</span><span class="s3">\n  </span><span class="s1">public readonly digest = BAILOUT_TO_CSR</span><span class="s3">\n\n  </span><span class="s1">constructor(public readonly reason: string) {</span><span class="s3">\n    </span><span class="s1">super(`Bail out to client-side rendering: ${reason}`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/** Checks if a passed argument is an error that is thrown if we want to bail out to client-side rendering. */</span><span class="s3">\n</span><span class="s1">export function isBailoutToCSRError(err: unknown): err is BailoutToCSRError {</span><span class="s3">\n  </span><span class="s1">if (typeof err !== 'object' || err === null || !('digest' in err)) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return err.digest === BAILOUT_TO_CSR</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;BAILOUT_TO_CSR&quot;</span><span class="s0">,</span><span class="s1">&quot;BailoutToCSRError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;reason&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;isBailoutToCSRError&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,+GAA+G;;;;;;;AAC/G,MAAMA,iBAAiB;AAGhB,MAAMC,0BAA0BC;IAGrCC,YAA4BC,MAAc,CAAE;QAC1C,KAAK,CAAE,wCAAqCA,SAAAA,IAAAA,CADlBA,MAAAA,GAAAA,QAAAA,IAAAA,CAFZC,MAAAA,GAASL;IAIzB;AACF;AAGO,SAASM,oBAAoBC,GAAY;IAC9C,IAAI,OAAOA,QAAQ,YAAYA,QAAQ,QAAQ,CAAE,CAAA,YAAYA,GAAE,GAAI;QACjE,OAAO;IACT;IAEA,OAAOA,IAAIF,MAAM,KAAKL;AACxB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1768</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/hooks-server-context.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const DYNAMIC_ERROR_CODE = 'DYNAMIC_SERVER_USAGE'</span><span class="s3">\n\n</span><span class="s1">export class DynamicServerError extends Error {</span><span class="s3">\n  </span><span class="s1">digest: typeof DYNAMIC_ERROR_CODE = DYNAMIC_ERROR_CODE</span><span class="s3">\n\n  </span><span class="s1">constructor(public readonly description: string) {</span><span class="s3">\n    </span><span class="s1">super(`Dynamic server usage: ${description}`)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isDynamicServerError(err: unknown): err is DynamicServerError {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">typeof err !== 'object' ||</span><span class="s3">\n    </span><span class="s1">err === null ||</span><span class="s3">\n    </span><span class="s1">!('digest' in err) ||</span><span class="s3">\n    </span><span class="s1">typeof err.digest !== 'string'</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return err.digest === DYNAMIC_ERROR_CODE</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;DYNAMIC_ERROR_CODE&quot;</span><span class="s0">,</span><span class="s1">&quot;DynamicServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;description&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAAA,MAAMA,qBAAqB;AAEpB,MAAMC,2BAA2BC;IAGtCC,YAA4BC,WAAmB,CAAE;QAC/C,KAAK,CAAE,2BAAwBA,cAAAA,IAAAA,CADLA,WAAAA,GAAAA,aAAAA,IAAAA,CAF5BC,MAAAA,GAAoCL;IAIpC;AACF;AAEO,SAASM,qBAAqBC,GAAY;IAC/C,IACE,OAAOA,QAAQ,YACfA,QAAQ,QACR,CAAE,CAAA,YAAYA,GAAE,KAChB,OAAOA,IAAIF,MAAM,KAAK,UACtB;QACA,OAAO;IACT;IAEA,OAAOE,IAAIF,MAAM,KAAKL;AACxB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1790</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/static-generation-bailout.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;const NEXT_STATIC_GEN_BAILOUT = 'NEXT_STATIC_GEN_BAILOUT'</span><span class="s3">\n\n</span><span class="s1">export class StaticGenBailoutError extends Error {</span><span class="s3">\n  </span><span class="s1">public readonly code = NEXT_STATIC_GEN_BAILOUT</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isStaticGenBailoutError(</span><span class="s3">\n  </span><span class="s1">error: unknown</span><span class="s3">\n</span><span class="s1">): error is StaticGenBailoutError {</span><span class="s3">\n  </span><span class="s1">if (typeof error !== 'object' || error === null || !('code' in error)) {</span><span class="s3">\n    </span><span class="s1">return false</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return error.code === NEXT_STATIC_GEN_BAILOUT</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;NEXT_STATIC_GEN_BAILOUT&quot;</span><span class="s0">,</span><span class="s1">&quot;StaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;code&quot;</span><span class="s0">,</span><span class="s1">&quot;isStaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAAA,MAAMA,0BAA0B;AAEzB,MAAMC,8BAA8BC;;QAApC,KAAA,IAAA,OAAA,IAAA,CACWC,IAAAA,GAAOH;;AACzB;AAEO,SAASI,wBACdC,KAAc;IAEd,IAAI,OAAOA,UAAU,YAAYA,UAAU,QAAQ,CAAE,CAAA,UAAUA,KAAI,GAAI;QACrE,OAAO;IACT;IAEA,OAAOA,MAAMF,IAAI,KAAKH;AACxB&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1812</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/lib/framework/boundary-constants.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export const METADATA_BOUNDARY_NAME = '__next_metadata_boundary__'</span><span class="s3">\n</span><span class="s1">export const VIEWPORT_BOUNDARY_NAME = '__next_viewport_boundary__'</span><span class="s3">\n</span><span class="s1">export const OUTLET_BOUNDARY_NAME = '__next_outlet_boundary__'</span><span class="s3">\n</span><span class="s1">export const ROOT_LAYOUT_BOUNDARY_NAME = '__next_root_layout_boundary__'</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;METADATA_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;VIEWPORT_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;OUTLET_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_LAYOUT_BOUNDARY_NAME&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;AAAO,MAAMA,yBAAyB,6BAA4B;AAC3D,MAAMC,yBAAyB,6BAA4B;AAC3D,MAAMC,uBAAuB,2BAA0B;AACvD,MAAMC,4BAA4B,gCAA+B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1830</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/lib/scheduler.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export type ScheduledFn&lt;T = void&gt; = () =&gt; T | PromiseLike&lt;T&gt;</span><span class="s3">\n</span><span class="s1">export type SchedulerFn&lt;T = void&gt; = (cb: ScheduledFn&lt;T&gt;) =&gt; void</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Schedules a function to be called on the next tick after the other promises</span><span class="s3">\n </span><span class="s1">* have been resolved.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param cb the function to schedule</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const scheduleOnNextTick = (cb: ScheduledFn&lt;void&gt;) =&gt; {</span><span class="s3">\n  </span><span class="s1">// We use Promise.resolve().then() here so that the operation is scheduled at</span><span class="s3">\n  </span><span class="s1">// the end of the promise job queue, we then add it to the next process tick</span><span class="s3">\n  </span><span class="s1">// to ensure it's evaluated afterwards.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// This was inspired by the implementation of the DataLoader interface: https://github.com/graphql/dataloader/blob/d336bd15282664e0be4b4a657cb796f09bafbc6b/src/index.js#L213-L255</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">Promise.resolve().then(() =&gt; {</span><span class="s3">\n    </span><span class="s1">if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n      </span><span class="s1">setTimeout(cb, 0)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">process.nextTick(cb)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Schedules a function to be called using `setImmediate` or `setTimeout` if</span><span class="s3">\n </span><span class="s1">* `setImmediate` is not available (like in the Edge runtime).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param cb the function to schedule</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const scheduleImmediate = (cb: ScheduledFn&lt;void&gt;): void =&gt; {</span><span class="s3">\n  </span><span class="s1">if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n    </span><span class="s1">setTimeout(cb, 0)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">setImmediate(cb)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* returns a promise than resolves in a future task. There is no guarantee that the task it resolves in</span><span class="s3">\n </span><span class="s1">* will be the next task but if you await it you can at least be sure that the current task is over and</span><span class="s3">\n </span><span class="s1">* most usefully that the entire microtask queue of the current task has been emptied.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function atLeastOneTask() {</span><span class="s3">\n  </span><span class="s1">return new Promise&lt;void&gt;((resolve) =&gt; scheduleImmediate(resolve))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This utility function is extracted to make it easier to find places where we are doing</span><span class="s3">\n </span><span class="s1">* specific timing tricks to try to schedule work after React has rendered. This is especially</span><span class="s3">\n </span><span class="s1">* important at the moment because Next.js uses the edge builds of React which use setTimeout to</span><span class="s3">\n </span><span class="s1">* schedule work when you might expect that something like setImmediate would do the trick.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Long term we should switch to the node versions of React rendering when possible and then</span><span class="s3">\n </span><span class="s1">* update this to use setImmediate rather than setTimeout</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function waitAtLeastOneReactRenderTask(): Promise&lt;void&gt; {</span><span class="s3">\n  </span><span class="s1">if (process.env.NEXT_RUNTIME === 'edge') {</span><span class="s3">\n    </span><span class="s1">return new Promise((r) =&gt; setTimeout(r, 0))</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">return new Promise((r) =&gt; setImmediate(r))</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;scheduleOnNextTick&quot;</span><span class="s0">,</span><span class="s1">&quot;cb&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_RUNTIME&quot;</span><span class="s0">,</span><span class="s1">&quot;setTimeout&quot;</span><span class="s0">,</span><span class="s1">&quot;nextTick&quot;</span><span class="s0">,</span><span class="s1">&quot;scheduleImmediate&quot;</span><span class="s0">,</span><span class="s1">&quot;setImmediate&quot;</span><span class="s0">,</span><span class="s1">&quot;atLeastOneTask&quot;</span><span class="s0">,</span><span class="s1">&quot;waitAtLeastOneReactRenderTask&quot;</span><span class="s0">,</span><span class="s1">&quot;r&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAGA;;;;;CAKC,GACD;;;;;;;;;;AAAO,MAAMA,qBAAqB,CAACC;IACjC,6EAA6E;IAC7E,4EAA4E;IAC5E,uCAAuC;IACvC,EAAE;IACF,kLAAkL;IAClL,EAAE;IACFC,QAAQC,OAAO,GAAGC,IAAI,CAAC;QACrB,IAAIC,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;aAElC;YACLF,QAAQI,QAAQ,CAACR;QACnB;IACF;AACF,EAAC;AAQM,MAAMS,oBAAoB,CAACT;IAChC,IAAII,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;SAElC;QACLI,aAAaV;IACf;AACF,EAAC;AAOM,SAASW;IACd,OAAO,IAAIV,QAAc,CAACC,UAAYO,kBAAkBP;AAC1D;AAWO,SAASU;IACd,IAAIR,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;SAElC;QACL,OAAO,IAAIL,QAAQ,CAACY,IAAMH,aAAaG;IACzC;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1881</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/invariant-error.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export class InvariantError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor(message: string, options?: ErrorOptions) {</span><span class="s3">\n    </span><span class="s1">super(</span><span class="s3">\n      </span><span class="s1">`Invariant: ${message.endsWith('.') ? message : message + '.'} This is a bug in Next.js.`,</span><span class="s3">\n      </span><span class="s1">options</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">this.name = 'InvariantError'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,MAAMA,uBAAuBC;IAClCC,YAAYC,OAAe,EAAEC,OAAsB,CAAE;QACnD,KAAK,CACF,gBAAaD,CAAAA,QAAQE,QAAQ,CAAC,OAAOF,UAAUA,UAAU,GAAE,IAAE,8BAC9DC;QAEF,IAAI,CAACE,IAAI,GAAG;IACd;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">1895</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/app-render/dynamic-rendering.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* The functions provided by this module are used to communicate certain properties</span><span class="s3">\n </span><span class="s1">* about the currently running code so that Next.js can make decisions on how to handle</span><span class="s3">\n </span><span class="s1">* the current execution in different rendering modes such as pre-rendering, resuming, and SSR.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Today Next.js treats all code as potentially static. Certain APIs may only make sense when dynamically rendering.</span><span class="s3">\n </span><span class="s1">* Traditionally this meant deopting the entire render to dynamic however with PPR we can now deopt parts</span><span class="s3">\n </span><span class="s1">* of a React tree as dynamic while still keeping other parts static. There are really two different kinds of</span><span class="s3">\n </span><span class="s1">* Dynamic indications.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* The first is simply an intention to be dynamic. unstable_noStore is an example of this where</span><span class="s3">\n </span><span class="s1">* the currently executing code simply declares that the current scope is dynamic but if you use it</span><span class="s3">\n </span><span class="s1">* inside unstable_cache it can still be cached. This type of indication can be removed if we ever</span><span class="s3">\n </span><span class="s1">* make the default dynamic to begin with because the only way you would ever be static is inside</span><span class="s3">\n </span><span class="s1">* a cache scope which this indication does not affect.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* The second is an indication that a dynamic data source was read. This is a stronger form of dynamic</span><span class="s3">\n </span><span class="s1">* because it means that it is inappropriate to cache this at all. using a dynamic data source inside</span><span class="s3">\n </span><span class="s1">* unstable_cache should error. If you want to use some dynamic data inside unstable_cache you should</span><span class="s3">\n </span><span class="s1">* read that data outside the cache and pass it in as an argument to the cached function.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">import type { WorkStore } from '../app-render/work-async-storage.external'</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">WorkUnitStore,</span><span class="s3">\n  </span><span class="s1">RequestStore,</span><span class="s3">\n  </span><span class="s1">PrerenderStoreLegacy,</span><span class="s3">\n  </span><span class="s1">PrerenderStoreModern,</span><span class="s3">\n  </span><span class="s1">PrerenderStoreModernRuntime,</span><span class="s3">\n</span><span class="s1">} from '../app-render/work-unit-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">// Once postpone is in stable we should switch to importing the postpone export directly</span><span class="s3">\n</span><span class="s1">import React from 'react'</span><span class="s3">\n\n</span><span class="s1">import { DynamicServerError } from '../../client/components/hooks-server-context'</span><span class="s3">\n</span><span class="s1">import { StaticGenBailoutError } from '../../client/components/static-generation-bailout'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">getRuntimeStagePromise,</span><span class="s3">\n  </span><span class="s1">workUnitAsyncStorage,</span><span class="s3">\n</span><span class="s1">} from './work-unit-async-storage.external'</span><span class="s3">\n</span><span class="s1">import { workAsyncStorage } from '../app-render/work-async-storage.external'</span><span class="s3">\n</span><span class="s1">import { makeHangingPromise } from '../dynamic-rendering-utils'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">METADATA_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">VIEWPORT_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">OUTLET_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">ROOT_LAYOUT_BOUNDARY_NAME,</span><span class="s3">\n</span><span class="s1">} from '../../lib/framework/boundary-constants'</span><span class="s3">\n</span><span class="s1">import { scheduleOnNextTick } from '../../lib/scheduler'</span><span class="s3">\n</span><span class="s1">import { BailoutToCSRError } from '../../shared/lib/lazy-dynamic/bailout-to-csr'</span><span class="s3">\n</span><span class="s1">import { InvariantError } from '../../shared/lib/invariant-error'</span><span class="s3">\n\n</span><span class="s1">const hasPostpone = typeof React.unstable_postpone === 'function'</span><span class="s3">\n\n</span><span class="s1">export type DynamicAccess = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* If debugging, this will contain the stack trace of where the dynamic access</span><span class="s3">\n   </span><span class="s1">* occurred. This is used to provide more information to the user about why</span><span class="s3">\n   </span><span class="s1">* their page is being rendered dynamically.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">stack?: string</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The expression that was accessed dynamically.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Stores dynamic reasons used during an RSC render.</span><span class="s3">\n</span><span class="s1">export type DynamicTrackingState = {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* When true, stack information will also be tracked during dynamic access.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">readonly isDebugDynamicAccesses: boolean | undefined</span><span class="s3">\n\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* The dynamic accesses that occurred during the render.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">readonly dynamicAccesses: Array&lt;DynamicAccess&gt;</span><span class="s3">\n\n  </span><span class="s1">syncDynamicErrorWithStack: null | Error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Stores dynamic reasons used during an SSR render.</span><span class="s3">\n</span><span class="s1">export type DynamicValidationState = {</span><span class="s3">\n  </span><span class="s1">hasSuspenseAboveBody: boolean</span><span class="s3">\n  </span><span class="s1">hasDynamicMetadata: boolean</span><span class="s3">\n  </span><span class="s1">hasDynamicViewport: boolean</span><span class="s3">\n  </span><span class="s1">hasAllowedDynamic: boolean</span><span class="s3">\n  </span><span class="s1">dynamicErrors: Array&lt;Error&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createDynamicTrackingState(</span><span class="s3">\n  </span><span class="s1">isDebugDynamicAccesses: boolean | undefined</span><span class="s3">\n</span><span class="s1">): DynamicTrackingState {</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">isDebugDynamicAccesses,</span><span class="s3">\n    </span><span class="s1">dynamicAccesses: [],</span><span class="s3">\n    </span><span class="s1">syncDynamicErrorWithStack: null,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createDynamicValidationState(): DynamicValidationState {</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">hasSuspenseAboveBody: false,</span><span class="s3">\n    </span><span class="s1">hasDynamicMetadata: false,</span><span class="s3">\n    </span><span class="s1">hasDynamicViewport: false,</span><span class="s3">\n    </span><span class="s1">hasAllowedDynamic: false,</span><span class="s3">\n    </span><span class="s1">dynamicErrors: [],</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function getFirstDynamicReason(</span><span class="s3">\n  </span><span class="s1">trackingState: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): undefined | string {</span><span class="s3">\n  </span><span class="s1">return trackingState.dynamicAccesses[0]?.expression</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function communicates that the current scope should be treated as dynamic.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* In most cases this function is a no-op but if called during</span><span class="s3">\n </span><span class="s1">* a PPR prerender it will postpone the current sub-tree and calling</span><span class="s3">\n </span><span class="s1">* it during a normal prerender will cause the entire prerender to abort</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function markCurrentScopeAsDynamic(</span><span class="s3">\n  </span><span class="s1">store: WorkStore,</span><span class="s3">\n  </span><span class="s1">workUnitStore: undefined | Exclude&lt;WorkUnitStore, PrerenderStoreModern&gt;,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">// Inside cache scopes, marking a scope as dynamic has no effect,</span><span class="s3">\n        </span><span class="s1">// because the outer cache scope creates a cache boundary. This is</span><span class="s3">\n        </span><span class="s1">// subtly different from reading a dynamic data source, which is</span><span class="s3">\n        </span><span class="s1">// forbidden inside a cache scope.</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n        </span><span class="s1">// A private cache scope is already dynamic by definition.</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If we're forcing dynamic rendering or we're forcing static rendering, we</span><span class="s3">\n  </span><span class="s1">// don't need to do anything here because the entire page is already dynamic</span><span class="s3">\n  </span><span class="s1">// or it's static and it should not throw or postpone here.</span><span class="s3">\n  </span><span class="s1">if (store.forceDynamic || store.forceStatic) return</span><span class="s3">\n\n  </span><span class="s1">if (store.dynamicShouldError) {</span><span class="s3">\n    </span><span class="s1">throw new StaticGenBailoutError(</span><span class="s3">\n      </span><span class="s1">`Route ${store.route} with </span><span class="s3">\\</span><span class="s1">`dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;\\</span><span class="s1">` couldn't be rendered statically because it used </span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n        </span><span class="s1">return postponeWithTracking(</span><span class="s3">\n          </span><span class="s1">store.route,</span><span class="s3">\n          </span><span class="s1">expression,</span><span class="s3">\n          </span><span class="s1">workUnitStore.dynamicTracking</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n        </span><span class="s1">workUnitStore.revalidate = 0</span><span class="s3">\n\n        </span><span class="s1">// We aren't prerendering, but we are generating a static page. We need</span><span class="s3">\n        </span><span class="s1">// to bail out of static generation.</span><span class="s3">\n        </span><span class="s1">const err = new DynamicServerError(</span><span class="s3">\n          </span><span class="s1">`Route ${store.route} couldn't be rendered statically because it used ${expression}. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">store.dynamicUsageDescription = expression</span><span class="s3">\n        </span><span class="s1">store.dynamicUsageStack = err.stack</span><span class="s3">\n\n        </span><span class="s1">throw err</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n          </span><span class="s1">workUnitStore.usedDynamic = true</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function is meant to be used when prerendering without cacheComponents or PPR.</span><span class="s3">\n </span><span class="s1">* When called during a build it will cause Next.js to consider the route as dynamic.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function throwToInterruptStaticGeneration(</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">store: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreLegacy</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">// We aren't prerendering but we are generating a static page. We need to bail out of static generation</span><span class="s3">\n  </span><span class="s1">const err = new DynamicServerError(</span><span class="s3">\n    </span><span class="s1">`Route ${store.route} couldn't be rendered statically because it used </span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">prerenderStore.revalidate = 0</span><span class="s3">\n\n  </span><span class="s1">store.dynamicUsageDescription = expression</span><span class="s3">\n  </span><span class="s1">store.dynamicUsageStack = err.stack</span><span class="s3">\n\n  </span><span class="s1">throw err</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function should be used to track whether something dynamic happened even when</span><span class="s3">\n </span><span class="s1">* we are in a dynamic render. This is useful for Dev where all renders are dynamic but</span><span class="s3">\n </span><span class="s1">* we still track whether dynamic APIs were accessed for helpful messaging</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function trackDynamicDataInDynamicRender(workUnitStore: WorkUnitStore) {</span><span class="s3">\n  </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'cache':</span><span class="s3">\n    </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n      </span><span class="s1">// Inside cache scopes, marking a scope as dynamic has no effect,</span><span class="s3">\n      </span><span class="s1">// because the outer cache scope creates a cache boundary. This is</span><span class="s3">\n      </span><span class="s1">// subtly different from reading a dynamic data source, which is</span><span class="s3">\n      </span><span class="s1">// forbidden inside a cache scope.</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">// A private cache scope is already dynamic by definition.</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">case 'prerender':</span><span class="s3">\n    </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n    </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">case 'request':</span><span class="s3">\n      </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n        </span><span class="s1">workUnitStore.usedDynamic = true</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function abortOnSynchronousDynamicDataAccess(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">const reason = `Route ${route} needs to bail out of prerendering at this point because it used ${expression}.`</span><span class="s3">\n\n  </span><span class="s1">const error = createPrerenderInterruptedError(reason)</span><span class="s3">\n\n  </span><span class="s1">prerenderStore.controller.abort(error)</span><span class="s3">\n\n  </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">dynamicTracking.dynamicAccesses.push({</span><span class="s3">\n      </span><span class="s1">// When we aren't debugging, we don't need to create another error for the</span><span class="s3">\n      </span><span class="s1">// stack trace.</span><span class="s3">\n      </span><span class="s1">stack: dynamicTracking.isDebugDynamicAccesses</span><span class="s3">\n        </span><span class="s1">? new Error().stack</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n      </span><span class="s1">expression,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function abortOnSynchronousPlatformIOAccess(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">errorWithStack: Error,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n  </span><span class="s1">abortOnSynchronousDynamicDataAccess(route, expression, prerenderStore)</span><span class="s3">\n  </span><span class="s1">// It is important that we set this tracking value after aborting. Aborts are executed</span><span class="s3">\n  </span><span class="s1">// synchronously except for the case where you abort during render itself. By setting this</span><span class="s3">\n  </span><span class="s1">// value late we can use it to determine if any of the aborted tasks are the task that</span><span class="s3">\n  </span><span class="s1">// called the sync IO expression in the first place.</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">if (dynamicTracking.syncDynamicErrorWithStack === null) {</span><span class="s3">\n      </span><span class="s1">dynamicTracking.syncDynamicErrorWithStack = errorWithStack</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function trackSynchronousPlatformIOAccessInDev(</span><span class="s3">\n  </span><span class="s1">requestStore: RequestStore</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">// We don't actually have a controller to abort but we do the semantic equivalent by</span><span class="s3">\n  </span><span class="s1">// advancing the request store out of prerender mode</span><span class="s3">\n  </span><span class="s1">requestStore.prerenderPhase = false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* use this function when prerendering with cacheComponents. If we are doing a</span><span class="s3">\n </span><span class="s1">* prospective prerender we don't actually abort because we want to discover</span><span class="s3">\n </span><span class="s1">* all caches for the shell. If this is the actual prerender we do abort.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This function accepts a prerenderStore but the caller should ensure we're</span><span class="s3">\n </span><span class="s1">* actually running in cacheComponents mode.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function abortAndThrowOnSynchronousRequestDataAccess(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">errorWithStack: Error,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">const prerenderSignal = prerenderStore.controller.signal</span><span class="s3">\n  </span><span class="s1">if (prerenderSignal.aborted === false) {</span><span class="s3">\n    </span><span class="s1">// TODO it would be better to move this aborted check into the callsite so we can avoid making</span><span class="s3">\n    </span><span class="s1">// the error object when it isn't relevant to the aborting of the prerender however</span><span class="s3">\n    </span><span class="s1">// since we need the throw semantics regardless of whether we abort it is easier to land</span><span class="s3">\n    </span><span class="s1">// this way. See how this was handled with `abortOnSynchronousPlatformIOAccess` for a closer</span><span class="s3">\n    </span><span class="s1">// to ideal implementation</span><span class="s3">\n    </span><span class="s1">abortOnSynchronousDynamicDataAccess(route, expression, prerenderStore)</span><span class="s3">\n    </span><span class="s1">// It is important that we set this tracking value after aborting. Aborts are executed</span><span class="s3">\n    </span><span class="s1">// synchronously except for the case where you abort during render itself. By setting this</span><span class="s3">\n    </span><span class="s1">// value late we can use it to determine if any of the aborted tasks are the task that</span><span class="s3">\n    </span><span class="s1">// called the sync IO expression in the first place.</span><span class="s3">\n    </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n    </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n      </span><span class="s1">if (dynamicTracking.syncDynamicErrorWithStack === null) {</span><span class="s3">\n        </span><span class="s1">dynamicTracking.syncDynamicErrorWithStack = errorWithStack</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">throw createPrerenderInterruptedError(</span><span class="s3">\n    </span><span class="s1">`Route ${route} needs to bail out of prerendering at this point because it used ${expression}.`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Use this function when dynamically prerendering with dynamicIO.</span><span class="s3">\n </span><span class="s1">* We don't want to error, because it's better to return something</span><span class="s3">\n </span><span class="s1">* (and we've already aborted the render at the point where the sync dynamic error occured),</span><span class="s3">\n </span><span class="s1">* but we should log an error server-side.</span><span class="s3">\n </span><span class="s1">* @internal</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function warnOnSyncDynamicError(dynamicTracking: DynamicTrackingState) {</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking.syncDynamicErrorWithStack) {</span><span class="s3">\n    </span><span class="s1">// the server did something sync dynamic, likely</span><span class="s3">\n    </span><span class="s1">// leading to an early termination of the prerender.</span><span class="s3">\n    </span><span class="s1">console.error(dynamicTracking.syncDynamicErrorWithStack)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// For now these implementations are the same so we just reexport</span><span class="s3">\n</span><span class="s1">export const trackSynchronousRequestDataAccessInDev =</span><span class="s3">\n  </span><span class="s1">trackSynchronousPlatformIOAccessInDev</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This component will call `React.postpone` that throws the postponed error.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">type PostponeProps = {</span><span class="s3">\n  </span><span class="s1">reason: string</span><span class="s3">\n  </span><span class="s1">route: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">export function Postpone({ reason, route }: PostponeProps): never {</span><span class="s3">\n  </span><span class="s1">const prerenderStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">const dynamicTracking =</span><span class="s3">\n    </span><span class="s1">prerenderStore &amp;&amp; prerenderStore.type === 'prerender-ppr'</span><span class="s3">\n      </span><span class="s1">? prerenderStore.dynamicTracking</span><span class="s3">\n      </span><span class="s1">: null</span><span class="s3">\n  </span><span class="s1">postponeWithTracking(route, reason, dynamicTracking)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function postponeWithTracking(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">dynamicTracking: null | DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">assertPostpone()</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">dynamicTracking.dynamicAccesses.push({</span><span class="s3">\n      </span><span class="s1">// When we aren't debugging, we don't need to create another error for the</span><span class="s3">\n      </span><span class="s1">// stack trace.</span><span class="s3">\n      </span><span class="s1">stack: dynamicTracking.isDebugDynamicAccesses</span><span class="s3">\n        </span><span class="s1">? new Error().stack</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n      </span><span class="s1">expression,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">React.unstable_postpone(createPostponeReason(route, expression))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createPostponeReason(route: string, expression: string) {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">`Route ${route} needs to bail out of prerendering at this point because it used ${expression}. ` +</span><span class="s3">\n    </span><span class="s1">`React throws this special object to indicate where. It should not be caught by ` +</span><span class="s3">\n    </span><span class="s1">`your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isDynamicPostpone(err: unknown) {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">typeof err === 'object' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">err !== null &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof (err as any).message === 'string'</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return isDynamicPostponeReason((err as any).message)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function isDynamicPostponeReason(reason: string) {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">reason.includes(</span><span class="s3">\n      </span><span class="s1">'needs to bail out of prerendering at this point because it used'</span><span class="s3">\n    </span><span class="s1">) &amp;&amp;</span><span class="s3">\n    </span><span class="s1">reason.includes(</span><span class="s3">\n      </span><span class="s1">'Learn more: https://nextjs.org/docs/messages/ppr-caught-error'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">if (isDynamicPostponeReason(createPostponeReason('%%%', '^^^')) === false) {</span><span class="s3">\n  </span><span class="s1">throw new Error(</span><span class="s3">\n    </span><span class="s1">'Invariant: isDynamicPostpone misidentified a postpone reason. This is a bug in Next.js'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const NEXT_PRERENDER_INTERRUPTED = 'NEXT_PRERENDER_INTERRUPTED'</span><span class="s3">\n\n</span><span class="s1">function createPrerenderInterruptedError(message: string): Error {</span><span class="s3">\n  </span><span class="s1">const error = new Error(message)</span><span class="s3">\n  </span><span class="s1">;(error as any).digest = NEXT_PRERENDER_INTERRUPTED</span><span class="s3">\n  </span><span class="s1">return error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">type DigestError = Error &amp; {</span><span class="s3">\n  </span><span class="s1">digest: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isPrerenderInterruptedError(</span><span class="s3">\n  </span><span class="s1">error: unknown</span><span class="s3">\n</span><span class="s1">): error is DigestError {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">typeof error === 'object' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">error !== null &amp;&amp;</span><span class="s3">\n    </span><span class="s1">(error as any).digest === NEXT_PRERENDER_INTERRUPTED &amp;&amp;</span><span class="s3">\n    </span><span class="s1">'name' in error &amp;&amp;</span><span class="s3">\n    </span><span class="s1">'message' in error &amp;&amp;</span><span class="s3">\n    </span><span class="s1">error instanceof Error</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function accessedDynamicData(</span><span class="s3">\n  </span><span class="s1">dynamicAccesses: Array&lt;DynamicAccess&gt;</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">return dynamicAccesses.length &gt; 0</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function consumeDynamicAccess(</span><span class="s3">\n  </span><span class="s1">serverDynamic: DynamicTrackingState,</span><span class="s3">\n  </span><span class="s1">clientDynamic: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): DynamicTrackingState['dynamicAccesses'] {</span><span class="s3">\n  </span><span class="s1">// We mutate because we only call this once we are no longer writing</span><span class="s3">\n  </span><span class="s1">// to the dynamicTrackingState and it's more efficient than creating a new</span><span class="s3">\n  </span><span class="s1">// array.</span><span class="s3">\n  </span><span class="s1">serverDynamic.dynamicAccesses.push(...clientDynamic.dynamicAccesses)</span><span class="s3">\n  </span><span class="s1">return serverDynamic.dynamicAccesses</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function formatDynamicAPIAccesses(</span><span class="s3">\n  </span><span class="s1">dynamicAccesses: Array&lt;DynamicAccess&gt;</span><span class="s3">\n</span><span class="s1">): string[] {</span><span class="s3">\n  </span><span class="s1">return dynamicAccesses</span><span class="s3">\n    </span><span class="s1">.filter(</span><span class="s3">\n      </span><span class="s1">(access): access is Required&lt;DynamicAccess&gt; =&gt;</span><span class="s3">\n        </span><span class="s1">typeof access.stack === 'string' &amp;&amp; access.stack.length &gt; 0</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">.map(({ expression, stack }) =&gt; {</span><span class="s3">\n      </span><span class="s1">stack = stack</span><span class="s3">\n        </span><span class="s1">.split('</span><span class="s3">\\</span><span class="s1">n')</span><span class="s3">\n        </span><span class="s1">// Remove the </span><span class="s3">\&quot;</span><span class="s1">Error: </span><span class="s3">\&quot; </span><span class="s1">prefix from the first line of the stack trace as</span><span class="s3">\n        </span><span class="s1">// well as the first 4 lines of the stack trace which is the distance</span><span class="s3">\n        </span><span class="s1">// from the user code and the `new Error().stack` call.</span><span class="s3">\n        </span><span class="s1">.slice(4)</span><span class="s3">\n        </span><span class="s1">.filter((line) =&gt; {</span><span class="s3">\n          </span><span class="s1">// Exclude Next.js internals from the stack trace.</span><span class="s3">\n          </span><span class="s1">if (line.includes('node_modules/next/')) {</span><span class="s3">\n            </span><span class="s1">return false</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Exclude anonymous functions from the stack trace.</span><span class="s3">\n          </span><span class="s1">if (line.includes(' (&lt;anonymous&gt;)')) {</span><span class="s3">\n            </span><span class="s1">return false</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Exclude Node.js internals from the stack trace.</span><span class="s3">\n          </span><span class="s1">if (line.includes(' (node:')) {</span><span class="s3">\n            </span><span class="s1">return false</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">return true</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">.join('</span><span class="s3">\\</span><span class="s1">n')</span><span class="s3">\n      </span><span class="s1">return `Dynamic API Usage Debug - ${expression}:</span><span class="s3">\\</span><span class="s1">n${stack}`</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function assertPostpone() {</span><span class="s3">\n  </span><span class="s1">if (!hasPostpone) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This is a bit of a hack to allow us to abort a render using a Postpone instance instead of an Error which changes React's</span><span class="s3">\n </span><span class="s1">* abort semantics slightly.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function createRenderInBrowserAbortSignal(): AbortSignal {</span><span class="s3">\n  </span><span class="s1">const controller = new AbortController()</span><span class="s3">\n  </span><span class="s1">controller.abort(new BailoutToCSRError('Render in Browser'))</span><span class="s3">\n  </span><span class="s1">return controller.signal</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* In a prerender, we may end up with hanging Promises as inputs due them</span><span class="s3">\n </span><span class="s1">* stalling on connection() or because they're loading dynamic data. In that</span><span class="s3">\n </span><span class="s1">* case we need to abort the encoding of arguments since they'll never complete.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function createHangingInputAbortSignal(</span><span class="s3">\n  </span><span class="s1">workUnitStore: WorkUnitStore</span><span class="s3">\n</span><span class="s1">): AbortSignal | undefined {</span><span class="s3">\n  </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'prerender':</span><span class="s3">\n    </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n      </span><span class="s1">const controller = new AbortController()</span><span class="s3">\n\n      </span><span class="s1">if (workUnitStore.cacheSignal) {</span><span class="s3">\n        </span><span class="s1">// If we have a cacheSignal it means we're in a prospective render. If</span><span class="s3">\n        </span><span class="s1">// the input we're waiting on is coming from another cache, we do want</span><span class="s3">\n        </span><span class="s1">// to wait for it so that we can resolve this cache entry too.</span><span class="s3">\n        </span><span class="s1">workUnitStore.cacheSignal.inputReady().then(() =&gt; {</span><span class="s3">\n          </span><span class="s1">controller.abort()</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">// Otherwise we're in the final render and we should already have all</span><span class="s3">\n        </span><span class="s1">// our caches filled.</span><span class="s3">\n        </span><span class="s1">// If the prerender uses stages, we have wait until the runtime stage,</span><span class="s3">\n        </span><span class="s1">// at which point all runtime inputs will be resolved.</span><span class="s3">\n        </span><span class="s1">// (otherwise, a runtime prerender might consider `cookies()` hanging</span><span class="s3">\n        </span><span class="s1">//  even though they'd resolve in the next task.)</span><span class="s3">\n        </span><span class="s1">//</span><span class="s3">\n        </span><span class="s1">// We might still be waiting on some microtasks so we</span><span class="s3">\n        </span><span class="s1">// wait one tick before giving up. When we give up, we still want to</span><span class="s3">\n        </span><span class="s1">// render the content of this cache as deeply as we can so that we can</span><span class="s3">\n        </span><span class="s1">// suspend as deeply as possible in the tree or not at all if we don't</span><span class="s3">\n        </span><span class="s1">// end up waiting for the input.</span><span class="s3">\n        </span><span class="s1">const runtimeStagePromise = getRuntimeStagePromise(workUnitStore)</span><span class="s3">\n        </span><span class="s1">if (runtimeStagePromise) {</span><span class="s3">\n          </span><span class="s1">runtimeStagePromise.then(() =&gt;</span><span class="s3">\n            </span><span class="s1">scheduleOnNextTick(() =&gt; controller.abort())</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">scheduleOnNextTick(() =&gt; controller.abort())</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return controller.signal</span><span class="s3">\n    </span><span class="s1">case 'prerender-client':</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n    </span><span class="s1">case 'request':</span><span class="s3">\n    </span><span class="s1">case 'cache':</span><span class="s3">\n    </span><span class="s1">case 'private-cache':</span><span class="s3">\n    </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n      </span><span class="s1">return undefined</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function annotateDynamicAccess(</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const dynamicTracking = prerenderStore.dynamicTracking</span><span class="s3">\n  </span><span class="s1">if (dynamicTracking) {</span><span class="s3">\n    </span><span class="s1">dynamicTracking.dynamicAccesses.push({</span><span class="s3">\n      </span><span class="s1">stack: dynamicTracking.isDebugDynamicAccesses</span><span class="s3">\n        </span><span class="s1">? new Error().stack</span><span class="s3">\n        </span><span class="s1">: undefined,</span><span class="s3">\n      </span><span class="s1">expression,</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function useDynamicRouteParams(expression: string) {</span><span class="s3">\n  </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workStore &amp;&amp; workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender': {</span><span class="s3">\n        </span><span class="s1">const fallbackParams = workUnitStore.fallbackRouteParams</span><span class="s3">\n        </span><span class="s1">if (fallbackParams &amp;&amp; fallbackParams.size &gt; 0) {</span><span class="s3">\n          </span><span class="s1">// We are in a prerender with cacheComponents semantics. We are going to</span><span class="s3">\n          </span><span class="s1">// hang here and never resolve. This will cause the currently</span><span class="s3">\n          </span><span class="s1">// rendering component to effectively be a dynamic hole.</span><span class="s3">\n          </span><span class="s1">React.use(</span><span class="s3">\n            </span><span class="s1">makeHangingPromise(</span><span class="s3">\n              </span><span class="s1">workUnitStore.renderSignal,</span><span class="s3">\n              </span><span class="s1">workStore.route,</span><span class="s3">\n              </span><span class="s1">expression</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr': {</span><span class="s3">\n        </span><span class="s1">const fallbackParams = workUnitStore.fallbackRouteParams</span><span class="s3">\n        </span><span class="s1">if (fallbackParams &amp;&amp; fallbackParams.size &gt; 0) {</span><span class="s3">\n          </span><span class="s1">return postponeWithTracking(</span><span class="s3">\n            </span><span class="s1">workStore.route,</span><span class="s3">\n            </span><span class="s1">expression,</span><span class="s3">\n            </span><span class="s1">workUnitStore.dynamicTracking</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">` was called during a runtime prerender. Next.js should be preventing ${expression} from being included in server components statically, but did not in this case.`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`${expression}</span><span class="s3">\\</span><span class="s1">` was called inside a cache scope. Next.js should be preventing ${expression} from being included in server components statically, but did not in this case.`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const hasSuspenseRegex = /</span><span class="s3">\\</span><span class="s1">n</span><span class="s3">\\</span><span class="s1">s+at Suspense </span><span class="s3">\\</span><span class="s1">(&lt;anonymous&gt;</span><span class="s3">\\</span><span class="s1">)/</span><span class="s3">\n\n</span><span class="s1">// Common implicit body tags that React will treat as body when placed directly in html</span><span class="s3">\n</span><span class="s1">const bodyAndImplicitTags =</span><span class="s3">\n  </span><span class="s1">'body|div|main|section|article|aside|header|footer|nav|form|p|span|h1|h2|h3|h4|h5|h6'</span><span class="s3">\n\n</span><span class="s1">// Detects when RootLayoutBoundary (our framework marker component) appears</span><span class="s3">\n</span><span class="s1">// after Suspense in the component stack, indicating the root layout is wrapped</span><span class="s3">\n</span><span class="s1">// within a Suspense boundary. Ensures no body/html/implicit-body components are in between.</span><span class="s3">\n</span><span class="s1">//</span><span class="s3">\n</span><span class="s1">// Example matches:</span><span class="s3">\n</span><span class="s1">//   at Suspense (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//   at __next_root_layout_boundary__ (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//</span><span class="s3">\n</span><span class="s1">// Or with other components in between (but not body/html/implicit-body):</span><span class="s3">\n</span><span class="s1">//   at Suspense (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//   at SomeComponent (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">//   at __next_root_layout_boundary__ (&lt;anonymous&gt;)</span><span class="s3">\n</span><span class="s1">const hasSuspenseBeforeRootLayoutWithoutBodyOrImplicitBodyRegex = new RegExp(</span><span class="s3">\n  </span><span class="s1">`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at Suspense </span><span class="s3">\\\\</span><span class="s1">(&lt;anonymous&gt;</span><span class="s3">\\\\</span><span class="s1">)(?:(?!</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at (?:${bodyAndImplicitTags}) </span><span class="s3">\\\\</span><span class="s1">(&lt;anonymous&gt;</span><span class="s3">\\\\</span><span class="s1">))[</span><span class="s3">\\\\</span><span class="s1">s</span><span class="s3">\\\\</span><span class="s1">S])*?</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${ROOT_LAYOUT_BOUNDARY_NAME} </span><span class="s3">\\\\</span><span class="s1">([^</span><span class="s3">\\\\</span><span class="s1">n]*</span><span class="s3">\\\\</span><span class="s1">)`</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n\n</span><span class="s1">const hasMetadataRegex = new RegExp(</span><span class="s3">\n  </span><span class="s1">`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${METADATA_BOUNDARY_NAME}[</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s]`</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n</span><span class="s1">const hasViewportRegex = new RegExp(</span><span class="s3">\n  </span><span class="s1">`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${VIEWPORT_BOUNDARY_NAME}[</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s]`</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n</span><span class="s1">const hasOutletRegex = new RegExp(`</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s+at ${OUTLET_BOUNDARY_NAME}[</span><span class="s3">\\\\</span><span class="s1">n</span><span class="s3">\\\\</span><span class="s1">s]`)</span><span class="s3">\n\n</span><span class="s1">export function trackAllowedDynamicAccess(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">componentStack: string,</span><span class="s3">\n  </span><span class="s1">dynamicValidation: DynamicValidationState,</span><span class="s3">\n  </span><span class="s1">clientDynamic: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (hasOutletRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">// We don't need to track that this is dynamic. It is only so when something else is also dynamic.</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (hasMetadataRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasDynamicMetadata = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (hasViewportRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasDynamicViewport = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (</span><span class="s3">\n    </span><span class="s1">hasSuspenseBeforeRootLayoutWithoutBodyOrImplicitBodyRegex.test(</span><span class="s3">\n      </span><span class="s1">componentStack</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">// For Suspense within body, the prelude wouldn't be empty so it wouldn't violate the empty static shells rule.</span><span class="s3">\n    </span><span class="s1">// But if you have Suspense above body, the prelude is empty but we allow that because having Suspense</span><span class="s3">\n    </span><span class="s1">// is an explicit signal from the user that they acknowledge the empty shell and want dynamic rendering.</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasAllowedDynamic = true</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasSuspenseAboveBody = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (hasSuspenseRegex.test(componentStack)) {</span><span class="s3">\n    </span><span class="s1">// this error had a Suspense boundary above it so we don't need to report it as a source</span><span class="s3">\n    </span><span class="s1">// of disallowed</span><span class="s3">\n    </span><span class="s1">dynamicValidation.hasAllowedDynamic = true</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else if (clientDynamic.syncDynamicErrorWithStack) {</span><span class="s3">\n    </span><span class="s1">// This task was the task that called the sync error.</span><span class="s3">\n    </span><span class="s1">dynamicValidation.dynamicErrors.push(</span><span class="s3">\n      </span><span class="s1">clientDynamic.syncDynamicErrorWithStack</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">const message = `Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot;</span><span class="s1">: A component accessed data, headers, params, searchParams, or a short-lived cache without a Suspense boundary nor a </span><span class="s3">\&quot;</span><span class="s1">use cache</span><span class="s3">\&quot; </span><span class="s1">above it. See more info: https://nextjs.org/docs/messages/next-prerender-missing-suspense`</span><span class="s3">\n    </span><span class="s1">const error = createErrorWithComponentOrOwnerStack(message, componentStack)</span><span class="s3">\n    </span><span class="s1">dynamicValidation.dynamicErrors.push(error)</span><span class="s3">\n    </span><span class="s1">return</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* In dev mode, we prefer using the owner stack, otherwise the provided</span><span class="s3">\n </span><span class="s1">* component stack is used.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function createErrorWithComponentOrOwnerStack(</span><span class="s3">\n  </span><span class="s1">message: string,</span><span class="s3">\n  </span><span class="s1">componentStack: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const ownerStack =</span><span class="s3">\n    </span><span class="s1">process.env.NODE_ENV !== 'production' &amp;&amp; React.captureOwnerStack</span><span class="s3">\n      </span><span class="s1">? React.captureOwnerStack()</span><span class="s3">\n      </span><span class="s1">: null</span><span class="s3">\n\n  </span><span class="s1">const error = new Error(message)</span><span class="s3">\n  </span><span class="s1">error.stack = error.name + ': ' + message + (ownerStack ?? componentStack)</span><span class="s3">\n  </span><span class="s1">return error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export enum PreludeState {</span><span class="s3">\n  </span><span class="s1">Full = 0,</span><span class="s3">\n  </span><span class="s1">Empty = 1,</span><span class="s3">\n  </span><span class="s1">Errored = 2,</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function logDisallowedDynamicError(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">error: Error</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">console.error(error)</span><span class="s3">\n\n  </span><span class="s1">if (!workStore.dev) {</span><span class="s3">\n    </span><span class="s1">if (workStore.hasReadableErrorStacks) {</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running </span><span class="s3">\\</span><span class="s1">`next dev</span><span class="s3">\\</span><span class="s1">`, then open </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">in your browser to investigate the error.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">console.error(`To get a more detailed stack trace and pinpoint the issue, try one of the following:</span><span class="s3">\n  </span><span class="s1">- Start the app in development mode by running </span><span class="s3">\\</span><span class="s1">`next dev</span><span class="s3">\\</span><span class="s1">`, then open </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">in your browser to investigate the error.</span><span class="s3">\n  </span><span class="s1">- Rerun the production build with </span><span class="s3">\\</span><span class="s1">`next build --debug-prerender</span><span class="s3">\\</span><span class="s1">` to generate better stack traces.`)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function throwIfDisallowedDynamic(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prelude: PreludeState,</span><span class="s3">\n  </span><span class="s1">dynamicValidation: DynamicValidationState,</span><span class="s3">\n  </span><span class="s1">serverDynamic: DynamicTrackingState</span><span class="s3">\n</span><span class="s1">): void {</span><span class="s3">\n  </span><span class="s1">if (prelude !== PreludeState.Full) {</span><span class="s3">\n    </span><span class="s1">if (dynamicValidation.hasSuspenseAboveBody) {</span><span class="s3">\n      </span><span class="s1">// This route has opted into allowing fully dynamic rendering</span><span class="s3">\n      </span><span class="s1">// by including a Suspense boundary above the body. In this case</span><span class="s3">\n      </span><span class="s1">// a lack of a shell is not considered disallowed so we simply return</span><span class="s3">\n      </span><span class="s1">return</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (serverDynamic.syncDynamicErrorWithStack) {</span><span class="s3">\n      </span><span class="s1">// There is no shell and the server did something sync dynamic likely</span><span class="s3">\n      </span><span class="s1">// leading to an early termination of the prerender before the shell</span><span class="s3">\n      </span><span class="s1">// could be completed. We terminate the build/validating render.</span><span class="s3">\n      </span><span class="s1">logDisallowedDynamicError(</span><span class="s3">\n        </span><span class="s1">workStore,</span><span class="s3">\n        </span><span class="s1">serverDynamic.syncDynamicErrorWithStack</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// We didn't have any sync bailouts but there may be user code which</span><span class="s3">\n    </span><span class="s1">// blocked the root. We would have captured these during the prerender</span><span class="s3">\n    </span><span class="s1">// and can log them here and then terminate the build/validating render</span><span class="s3">\n    </span><span class="s1">const dynamicErrors = dynamicValidation.dynamicErrors</span><span class="s3">\n    </span><span class="s1">if (dynamicErrors.length &gt; 0) {</span><span class="s3">\n      </span><span class="s1">for (let i = 0; i &lt; dynamicErrors.length; i++) {</span><span class="s3">\n        </span><span class="s1">logDisallowedDynamicError(workStore, dynamicErrors[i])</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// If we got this far then the only other thing that could be blocking</span><span class="s3">\n    </span><span class="s1">// the root is dynamic Viewport. If this is dynamic then</span><span class="s3">\n    </span><span class="s1">// you need to opt into that by adding a Suspense boundary above the body</span><span class="s3">\n    </span><span class="s1">// to indicate your are ok with fully dynamic rendering.</span><span class="s3">\n    </span><span class="s1">if (dynamicValidation.hasDynamicViewport) {</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">has a </span><span class="s3">\\</span><span class="s1">`generateViewport</span><span class="s3">\\</span><span class="s1">` that depends on Request data (</span><span class="s3">\\</span><span class="s1">`cookies()</span><span class="s3">\\</span><span class="s1">`, etc...) or uncached external data (</span><span class="s3">\\</span><span class="s1">`fetch(...)</span><span class="s3">\\</span><span class="s1">`, etc...) without explicitly allowing fully dynamic rendering. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-viewport`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (prelude === PreludeState.Empty) {</span><span class="s3">\n      </span><span class="s1">// If we ever get this far then we messed up the tracking of invalid dynamic.</span><span class="s3">\n      </span><span class="s1">// We still adhere to the constraint that you must produce a shell but invite the</span><span class="s3">\n      </span><span class="s1">// user to report this as a bug in Next.js.</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">did not produce a static shell and Next.js was unable to determine a reason. This is a bug in Next.js.`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">dynamicValidation.hasAllowedDynamic === false &amp;&amp;</span><span class="s3">\n      </span><span class="s1">dynamicValidation.hasDynamicMetadata</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">console.error(</span><span class="s3">\n        </span><span class="s1">`Route </span><span class="s3">\&quot;</span><span class="s1">${workStore.route}</span><span class="s3">\&quot; </span><span class="s1">has a </span><span class="s3">\\</span><span class="s1">`generateMetadata</span><span class="s3">\\</span><span class="s1">` that depends on Request data (</span><span class="s3">\\</span><span class="s1">`cookies()</span><span class="s3">\\</span><span class="s1">`, etc...) or uncached external data (</span><span class="s3">\\</span><span class="s1">`fetch(...)</span><span class="s3">\\</span><span class="s1">`, etc...) when the rest of the route does not. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-metadata`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">throw new StaticGenBailoutError()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function delayUntilRuntimeStage&lt;T&gt;(</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModernRuntime,</span><span class="s3">\n  </span><span class="s1">result: Promise&lt;T&gt;</span><span class="s3">\n</span><span class="s1">): Promise&lt;T&gt; {</span><span class="s3">\n  </span><span class="s1">if (prerenderStore.runtimeStagePromise) {</span><span class="s3">\n    </span><span class="s1">return prerenderStore.runtimeStagePromise.then(() =&gt; result)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return result</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;React&quot;</span><span class="s0">,</span><span class="s1">&quot;DynamicServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;StaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;getRuntimeStagePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;METADATA_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;VIEWPORT_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;OUTLET_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_LAYOUT_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;scheduleOnNextTick&quot;</span><span class="s0">,</span><span class="s1">&quot;BailoutToCSRError&quot;</span><span class="s0">,</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;hasPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_postpone&quot;</span><span class="s0">,</span><span class="s1">&quot;createDynamicTrackingState&quot;</span><span class="s0">,</span><span class="s1">&quot;isDebugDynamicAccesses&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicAccesses&quot;</span><span class="s0">,</span><span class="s1">&quot;syncDynamicErrorWithStack&quot;</span><span class="s0">,</span><span class="s1">&quot;createDynamicValidationState&quot;</span><span class="s0">,</span><span class="s1">&quot;hasSuspenseAboveBody&quot;</span><span class="s0">,</span><span class="s1">&quot;hasDynamicMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;hasDynamicViewport&quot;</span><span class="s0">,</span><span class="s1">&quot;hasAllowedDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicErrors&quot;</span><span class="s0">,</span><span class="s1">&quot;getFirstDynamicReason&quot;</span><span class="s0">,</span><span class="s1">&quot;trackingState&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;markCurrentScopeAsDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;store&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitStore&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;forceDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;forceStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicShouldError&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;postponeWithTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;revalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;err&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicUsageDescription&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicUsageStack&quot;</span><span class="s0">,</span><span class="s1">&quot;stack&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;usedDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;throwToInterruptStaticGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderStore&quot;</span><span class="s0">,</span><span class="s1">&quot;trackDynamicDataInDynamicRender&quot;</span><span class="s0">,</span><span class="s1">&quot;abortOnSynchronousDynamicDataAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;reason&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;createPrerenderInterruptedError&quot;</span><span class="s0">,</span><span class="s1">&quot;controller&quot;</span><span class="s0">,</span><span class="s1">&quot;abort&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;abortOnSynchronousPlatformIOAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;errorWithStack&quot;</span><span class="s0">,</span><span class="s1">&quot;trackSynchronousPlatformIOAccessInDev&quot;</span><span class="s0">,</span><span class="s1">&quot;requestStore&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderPhase&quot;</span><span class="s0">,</span><span class="s1">&quot;abortAndThrowOnSynchronousRequestDataAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;signal&quot;</span><span class="s0">,</span><span class="s1">&quot;aborted&quot;</span><span class="s0">,</span><span class="s1">&quot;warnOnSyncDynamicError&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;trackSynchronousRequestDataAccessInDev&quot;</span><span class="s0">,</span><span class="s1">&quot;Postpone&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;assertPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;createPostponeReason&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicPostponeReason&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;NEXT_PRERENDER_INTERRUPTED&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;isPrerenderInterruptedError&quot;</span><span class="s0">,</span><span class="s1">&quot;accessedDynamicData&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;consumeDynamicAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;serverDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;clientDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;formatDynamicAPIAccesses&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;access&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;line&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;createRenderInBrowserAbortSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;AbortController&quot;</span><span class="s0">,</span><span class="s1">&quot;createHangingInputAbortSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;inputReady&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;runtimeStagePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;annotateDynamicAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;useDynamicRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackParams&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;size&quot;</span><span class="s0">,</span><span class="s1">&quot;use&quot;</span><span class="s0">,</span><span class="s1">&quot;renderSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;hasSuspenseRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;bodyAndImplicitTags&quot;</span><span class="s0">,</span><span class="s1">&quot;hasSuspenseBeforeRootLayoutWithoutBodyOrImplicitBodyRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;hasMetadataRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;hasViewportRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;hasOutletRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;trackAllowedDynamicAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;componentStack&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicValidation&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;createErrorWithComponentOrOwnerStack&quot;</span><span class="s0">,</span><span class="s1">&quot;ownerStack&quot;</span><span class="s0">,</span><span class="s1">&quot;captureOwnerStack&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;PreludeState&quot;</span><span class="s0">,</span><span class="s1">&quot;logDisallowedDynamicError&quot;</span><span class="s0">,</span><span class="s1">&quot;dev&quot;</span><span class="s0">,</span><span class="s1">&quot;hasReadableErrorStacks&quot;</span><span class="s0">,</span><span class="s1">&quot;throwIfDisallowedDynamic&quot;</span><span class="s0">,</span><span class="s1">&quot;prelude&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;delayUntilRuntimeStage&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2513</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/unstable-rethrow.server.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { isHangingPromiseRejectionError } from '../../server/dynamic-rendering-utils'</span><span class="s3">\n</span><span class="s1">import { isPostpone } from '../../server/lib/router-utils/is-postpone'</span><span class="s3">\n</span><span class="s1">import { isBailoutToCSRError } from '../../shared/lib/lazy-dynamic/bailout-to-csr'</span><span class="s3">\n</span><span class="s1">import { isNextRouterError } from './is-next-router-error'</span><span class="s3">\n</span><span class="s1">import { isDynamicPostpone } from '../../server/app-render/dynamic-rendering'</span><span class="s3">\n</span><span class="s1">import { isDynamicServerError } from './hooks-server-context'</span><span class="s3">\n\n</span><span class="s1">export function unstable_rethrow(error: unknown): void {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">isNextRouterError(error) ||</span><span class="s3">\n    </span><span class="s1">isBailoutToCSRError(error) ||</span><span class="s3">\n    </span><span class="s1">isDynamicServerError(error) ||</span><span class="s3">\n    </span><span class="s1">isDynamicPostpone(error) ||</span><span class="s3">\n    </span><span class="s1">isPostpone(error) ||</span><span class="s3">\n    </span><span class="s1">isHangingPromiseRejectionError(error)</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">throw error</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (error instanceof Error &amp;&amp; 'cause' in error) {</span><span class="s3">\n    </span><span class="s1">unstable_rethrow(error.cause)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isHangingPromiseRejectionError&quot;</span><span class="s0">,</span><span class="s1">&quot;isPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;isBailoutToCSRError&quot;</span><span class="s0">,</span><span class="s1">&quot;isNextRouterError&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicPostpone&quot;</span><span class="s0">,</span><span class="s1">&quot;isDynamicServerError&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_rethrow&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;cause&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,8BAA8B,QAAQ,uCAAsC;AACrF,SAASC,UAAU,QAAQ,4CAA2C;AACtE,SAASC,mBAAmB,QAAQ,+CAA8C;AAClF,SAASC,iBAAiB,QAAQ,yBAAwB;AAC1D,SAASC,iBAAiB,QAAQ,4CAA2C;AAC7E,SAASC,oBAAoB,QAAQ,yBAAwB;;;;;;;AAEtD,SAASC,iBAAiBC,KAAc;IAC7C,QACEJ,iNAAAA,EAAkBI,cAClBL,sNAAAA,EAAoBK,cACpBF,iNAAAA,EAAqBE,cACrBH,2MAAAA,EAAkBG,cAClBN,uMAAAA,EAAWM,cACXP,gNAAAA,EAA+BO,QAC/B;QACA,MAAMA;IACR;IAEA,IAAIA,iBAAiBC,SAAS,WAAWD,OAAO;QAC9CD,iBAAiBC,MAAME,KAAK;IAC9B;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2541</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/unstable-rethrow.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* This function should be used to rethrow internal Next.js errors so that they can be handled by the framework.</span><span class="s3">\n </span><span class="s1">* When wrapping an API that uses errors to interrupt control flow, you should use this function before you do any error handling.</span><span class="s3">\n </span><span class="s1">* This function will rethrow the error if it is a Next.js error so it can be handled, otherwise it will do nothing.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `unstable_rethrow`](https://nextjs.org/docs/app/api-reference/functions/unstable_rethrow)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export const unstable_rethrow =</span><span class="s3">\n  </span><span class="s1">typeof window === 'undefined'</span><span class="s3">\n    </span><span class="s1">? (</span><span class="s3">\n        </span><span class="s1">require('./unstable-rethrow.server') as typeof import('./unstable-rethrow.server')</span><span class="s3">\n      </span><span class="s1">).unstable_rethrow</span><span class="s3">\n    </span><span class="s1">: (</span><span class="s3">\n        </span><span class="s1">require('./unstable-rethrow.browser') as typeof import('./unstable-rethrow.browser')</span><span class="s3">\n      </span><span class="s1">).unstable_rethrow</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;unstable_rethrow&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;;;;CAMC,GACD;;;;AAAO,MAAMA,mBACX,OAAOC,WAAW,qBAEZC,QAAQ,4HACRF,gBAAgB,GAEhBE,QAAQ,8BACRF,gBAAgB,CAAA&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2556</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/navigation.react-server.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/** @internal */</span><span class="s3">\n</span><span class="s1">class ReadonlyURLSearchParamsError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor() {</span><span class="s3">\n    </span><span class="s1">super(</span><span class="s3">\n      </span><span class="s1">'Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">class ReadonlyURLSearchParams extends URLSearchParams {</span><span class="s3">\n  </span><span class="s1">/** @deprecated Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams */</span><span class="s3">\n  </span><span class="s1">append() {</span><span class="s3">\n    </span><span class="s1">throw new ReadonlyURLSearchParamsError()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">/** @deprecated Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams */</span><span class="s3">\n  </span><span class="s1">delete() {</span><span class="s3">\n    </span><span class="s1">throw new ReadonlyURLSearchParamsError()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">/** @deprecated Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams */</span><span class="s3">\n  </span><span class="s1">set() {</span><span class="s3">\n    </span><span class="s1">throw new ReadonlyURLSearchParamsError()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">/** @deprecated Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams */</span><span class="s3">\n  </span><span class="s1">sort() {</span><span class="s3">\n    </span><span class="s1">throw new ReadonlyURLSearchParamsError()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function unstable_isUnrecognizedActionError(): boolean {</span><span class="s3">\n  </span><span class="s1">throw new Error(</span><span class="s3">\n    </span><span class="s1">'`unstable_isUnrecognizedActionError` can only be used on the client.'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export { redirect, permanentRedirect } from './redirect'</span><span class="s3">\n</span><span class="s1">export { RedirectType } from './redirect-error'</span><span class="s3">\n</span><span class="s1">export { notFound } from './not-found'</span><span class="s3">\n</span><span class="s1">export { forbidden } from './forbidden'</span><span class="s3">\n</span><span class="s1">export { unauthorized } from './unauthorized'</span><span class="s3">\n</span><span class="s1">export { unstable_rethrow } from './unstable-rethrow'</span><span class="s3">\n</span><span class="s1">export { ReadonlyURLSearchParams }</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ReadonlyURLSearchParamsError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;ReadonlyURLSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;URLSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;append&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;sort&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_isUnrecognizedActionError&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;permanentRedirect&quot;</span><span class="s0">,</span><span class="s1">&quot;RedirectType&quot;</span><span class="s0">,</span><span class="s1">&quot;notFound&quot;</span><span class="s0">,</span><span class="s1">&quot;forbidden&quot;</span><span class="s0">,</span><span class="s1">&quot;unauthorized&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_rethrow&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,cAAc;;;;;;AAkCd,SAASU,QAAQ,EAAEC,iBAAiB,QAAQ,aAAY;AACxD,SAASC,YAAY,QAAQ,mBAAkB;AAC/C,SAASC,QAAQ,QAAQ,cAAa;AACtC,SAASC,SAAS,QAAQ,cAAa;AACvC,SAASC,YAAY,QAAQ,iBAAgB;AAC7C,SAASC,gBAAgB,QAAQ,qBAAoB;AAtCrD,MAAMhB,qCAAqCC;IACzCC,aAAc;QACZ,KAAK,CACH;IAEJ;AACF;AAEA,MAAMC,gCAAgCC;IACpC,wKAAwK,GACxKC,SAAS;QACP,MAAM,IAAIL;IACZ;IACA,wKAAwK,GACxKM,SAAS;QACP,MAAM,IAAIN;IACZ;IACA,wKAAwK,GACxKO,MAAM;QACJ,MAAM,IAAIP;IACZ;IACA,wKAAwK,GACxKQ,OAAO;QACL,MAAM,IAAIR;IACZ;AACF;AAEO,SAASS;IACd,MAAM,OAAA,cAEL,CAFK,IAAIR,MACR,yEADI,qBAAA;eAAA;oBAAA;sBAAA;IAEN;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2606</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/unrecognized-action-error.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export class UnrecognizedActionError extends Error {</span><span class="s3">\n  </span><span class="s1">constructor(...args: ConstructorParameters&lt;typeof Error&gt;) {</span><span class="s3">\n    </span><span class="s1">super(...args)</span><span class="s3">\n    </span><span class="s1">this.name = 'UnrecognizedActionError'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Check whether a server action call failed because the server action was not recognized by the server.</span><span class="s3">\n </span><span class="s1">* This can happen if the client and the server are not from the same deployment.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Example usage:</span><span class="s3">\n </span><span class="s1">* ```ts</span><span class="s3">\n </span><span class="s1">* try {</span><span class="s3">\n </span><span class="s1">*   await myServerAction();</span><span class="s3">\n </span><span class="s1">* } catch (err) {</span><span class="s3">\n </span><span class="s1">*   if (unstable_isUnrecognizedActionError(err)) {</span><span class="s3">\n </span><span class="s1">*     // The client is from a different deployment than the server.</span><span class="s3">\n </span><span class="s1">*     // Reloading the page will fix this mismatch.</span><span class="s3">\n </span><span class="s1">*     window.alert(</span><span class="s3">\&quot;</span><span class="s1">Please refresh the page and try again</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n </span><span class="s1">*     return;</span><span class="s3">\n </span><span class="s1">*   }</span><span class="s3">\n </span><span class="s1">* }</span><span class="s3">\n </span><span class="s1">* ```</span><span class="s3">\n </span><span class="s1">* */</span><span class="s3">\n</span><span class="s1">export function unstable_isUnrecognizedActionError(</span><span class="s3">\n  </span><span class="s1">error: unknown</span><span class="s3">\n</span><span class="s1">): error is UnrecognizedActionError {</span><span class="s3">\n  </span><span class="s1">return !!(</span><span class="s3">\n    </span><span class="s1">error &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof error === 'object' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">error instanceof UnrecognizedActionError</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;UnrecognizedActionError&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_isUnrecognizedActionError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAAO,MAAMA,gCAAgCC;IAC3CC,YAAY,GAAGC,IAAyC,CAAE;QACxD,KAAK,IAAIA;QACT,IAAI,CAACC,IAAI,GAAG;IACd;AACF;AAoBO,SAASC,mCACdC,KAAc;IAEd,OAAO,CAAC,CACNA,CAAAA,SACA,OAAOA,UAAU,YACjBA,iBAAiBN,uBAAsB;AAE3C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2625</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/bailout-to-client-rendering.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { BailoutToCSRError } from '../../shared/lib/lazy-dynamic/bailout-to-csr'</span><span class="s3">\n</span><span class="s1">import { workAsyncStorage } from '../../server/app-render/work-async-storage.external'</span><span class="s3">\n</span><span class="s1">import { workUnitAsyncStorage } from '../../server/app-render/work-unit-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">export function bailoutToClientRendering(reason: string): void | never {</span><span class="s3">\n  </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n\n  </span><span class="s1">if (workStore?.forceStatic) return</span><span class="s3">\n\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender':</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n        </span><span class="s1">throw new BailoutToCSRError(reason)</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;BailoutToCSRError&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;bailoutToClientRendering&quot;</span><span class="s0">,</span><span class="s1">&quot;reason&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;forceStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitStore&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,SAASA,iBAAiB,QAAQ,+CAA8C;AAChF,SAASC,gBAAgB,QAAQ,sDAAqD;AACtF,SAASC,oBAAoB,QAAQ,2DAA0D;;;;AAExF,SAASC,yBAAyBC,MAAc;IACrD,MAAMC,YAAYJ,uRAAAA,CAAiBK,QAAQ;IAE3C,IAAID,aAAAA,OAAAA,KAAAA,IAAAA,UAAWE,WAAW,EAAE;IAE5B,MAAMC,gBAAgBN,2SAAAA,CAAqBI,QAAQ;IAEnD,IAAIE,eAAe;QACjB,OAAQA,cAAcC,IAAI;YACxB,KAAK;YACL,KAAK;YACL,KAAK;YACL,KAAK;YACL,KAAK;gBACH,MAAM,OAAA,cAA6B,CAA7B,IAAIT,oNAAAA,CAAkBI,SAAtB,qBAAA;2BAAA;gCAAA;kCAAA;gBAA4B;YACpC,KAAK;YACL,KAAK;YACL,KAAK;YACL,KAAK;gBACH;YACF;gBACEI;QACJ;IACF;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2665</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/navigation.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { FlightRouterState } from '../../server/app-render/types'</span><span class="s3">\n</span><span class="s1">import type { Params } from '../../server/request/params'</span><span class="s3">\n\n</span><span class="s1">import { useContext, useMemo } from 'react'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">AppRouterContext,</span><span class="s3">\n  </span><span class="s1">LayoutRouterContext,</span><span class="s3">\n  </span><span class="s1">type AppRouterInstance,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/app-router-context.shared-runtime'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">SearchParamsContext,</span><span class="s3">\n  </span><span class="s1">PathnameContext,</span><span class="s3">\n  </span><span class="s1">PathParamsContext,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/hooks-client-context.shared-runtime'</span><span class="s3">\n</span><span class="s1">import { getSegmentValue } from './router-reducer/reducers/get-segment-value'</span><span class="s3">\n</span><span class="s1">import { PAGE_SEGMENT_KEY, DEFAULT_SEGMENT_KEY } from '../../shared/lib/segment'</span><span class="s3">\n</span><span class="s1">import { ReadonlyURLSearchParams } from './navigation.react-server'</span><span class="s3">\n\n</span><span class="s1">const useDynamicRouteParams =</span><span class="s3">\n  </span><span class="s1">typeof window === 'undefined'</span><span class="s3">\n    </span><span class="s1">? (</span><span class="s3">\n        </span><span class="s1">require('../../server/app-render/dynamic-rendering') as typeof import('../../server/app-render/dynamic-rendering')</span><span class="s3">\n      </span><span class="s1">).useDynamicRouteParams</span><span class="s3">\n    </span><span class="s1">: undefined</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* A [Client Component](https://nextjs.org/docs/app/building-your-application/rendering/client-components) hook</span><span class="s3">\n </span><span class="s1">* that lets you *read* the current URL's search parameters.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Learn more about [`URLSearchParams` on MDN](https://developer.mozilla.org/docs/Web/API/URLSearchParams)</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @example</span><span class="s3">\n </span><span class="s1">* ```ts</span><span class="s3">\n </span><span class="s1">* </span><span class="s3">\&quot;</span><span class="s1">use client</span><span class="s3">\&quot;\n </span><span class="s1">* import { useSearchParams } from 'next/navigation'</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* export default function Page() {</span><span class="s3">\n </span><span class="s1">*   const searchParams = useSearchParams()</span><span class="s3">\n </span><span class="s1">*   searchParams.get('foo') // returns 'bar' when ?foo=bar</span><span class="s3">\n </span><span class="s1">*   // ...</span><span class="s3">\n </span><span class="s1">* }</span><span class="s3">\n </span><span class="s1">* ```</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `useSearchParams`](https://nextjs.org/docs/app/api-reference/functions/use-search-params)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">// Client components API</span><span class="s3">\n</span><span class="s1">export function useSearchParams(): ReadonlyURLSearchParams {</span><span class="s3">\n  </span><span class="s1">const searchParams = useContext(SearchParamsContext)</span><span class="s3">\n\n  </span><span class="s1">// In the case where this is `null`, the compat types added in</span><span class="s3">\n  </span><span class="s1">// `next-env.d.ts` will add a new overload that changes the return type to</span><span class="s3">\n  </span><span class="s1">// include `null`.</span><span class="s3">\n  </span><span class="s1">const readonlySearchParams = useMemo(() =&gt; {</span><span class="s3">\n    </span><span class="s1">if (!searchParams) {</span><span class="s3">\n      </span><span class="s1">// When the router is not ready in pages, we won't have the search params</span><span class="s3">\n      </span><span class="s1">// available.</span><span class="s3">\n      </span><span class="s1">return null</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return new ReadonlyURLSearchParams(searchParams)</span><span class="s3">\n  </span><span class="s1">}, [searchParams]) as ReadonlyURLSearchParams</span><span class="s3">\n\n  </span><span class="s1">if (typeof window === 'undefined') {</span><span class="s3">\n    </span><span class="s1">// AsyncLocalStorage should not be included in the client bundle.</span><span class="s3">\n    </span><span class="s1">const { bailoutToClientRendering } =</span><span class="s3">\n      </span><span class="s1">require('./bailout-to-client-rendering') as typeof import('./bailout-to-client-rendering')</span><span class="s3">\n    </span><span class="s1">// TODO-APP: handle dynamic = 'force-static' here and on the client</span><span class="s3">\n    </span><span class="s1">bailoutToClientRendering('useSearchParams()')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return readonlySearchParams</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* A [Client Component](https://nextjs.org/docs/app/building-your-application/rendering/client-components) hook</span><span class="s3">\n </span><span class="s1">* that lets you read the current URL's pathname.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @example</span><span class="s3">\n </span><span class="s1">* ```ts</span><span class="s3">\n </span><span class="s1">* </span><span class="s3">\&quot;</span><span class="s1">use client</span><span class="s3">\&quot;\n </span><span class="s1">* import { usePathname } from 'next/navigation'</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* export default function Page() {</span><span class="s3">\n </span><span class="s1">*  const pathname = usePathname() // returns </span><span class="s3">\&quot;</span><span class="s1">/dashboard</span><span class="s3">\&quot; </span><span class="s1">on /dashboard?foo=bar</span><span class="s3">\n </span><span class="s1">*  // ...</span><span class="s3">\n </span><span class="s1">* }</span><span class="s3">\n </span><span class="s1">* ```</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `usePathname`](https://nextjs.org/docs/app/api-reference/functions/use-pathname)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">// Client components API</span><span class="s3">\n</span><span class="s1">export function usePathname(): string {</span><span class="s3">\n  </span><span class="s1">useDynamicRouteParams?.('usePathname()')</span><span class="s3">\n\n  </span><span class="s1">// In the case where this is `null`, the compat types added in `next-env.d.ts`</span><span class="s3">\n  </span><span class="s1">// will add a new overload that changes the return type to include `null`.</span><span class="s3">\n  </span><span class="s1">return useContext(PathnameContext) as string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Client components API</span><span class="s3">\n</span><span class="s1">export {</span><span class="s3">\n  </span><span class="s1">ServerInsertedHTMLContext,</span><span class="s3">\n  </span><span class="s1">useServerInsertedHTML,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/server-inserted-html.shared-runtime'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This hook allows you to programmatically change routes inside [Client Component](https://nextjs.org/docs/app/building-your-application/rendering/client-components).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @example</span><span class="s3">\n </span><span class="s1">* ```ts</span><span class="s3">\n </span><span class="s1">* </span><span class="s3">\&quot;</span><span class="s1">use client</span><span class="s3">\&quot;\n </span><span class="s1">* import { useRouter } from 'next/navigation'</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* export default function Page() {</span><span class="s3">\n </span><span class="s1">*  const router = useRouter()</span><span class="s3">\n </span><span class="s1">*  // ...</span><span class="s3">\n </span><span class="s1">*  router.push('/dashboard') // Navigate to /dashboard</span><span class="s3">\n </span><span class="s1">* }</span><span class="s3">\n </span><span class="s1">* ```</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `useRouter`](https://nextjs.org/docs/app/api-reference/functions/use-router)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">// Client components API</span><span class="s3">\n</span><span class="s1">export function useRouter(): AppRouterInstance {</span><span class="s3">\n  </span><span class="s1">const router = useContext(AppRouterContext)</span><span class="s3">\n  </span><span class="s1">if (router === null) {</span><span class="s3">\n    </span><span class="s1">throw new Error('invariant expected app router to be mounted')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return router</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* A [Client Component](https://nextjs.org/docs/app/building-your-application/rendering/client-components) hook</span><span class="s3">\n </span><span class="s1">* that lets you read a route's dynamic params filled in by the current URL.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @example</span><span class="s3">\n </span><span class="s1">* ```ts</span><span class="s3">\n </span><span class="s1">* </span><span class="s3">\&quot;</span><span class="s1">use client</span><span class="s3">\&quot;\n </span><span class="s1">* import { useParams } from 'next/navigation'</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* export default function Page() {</span><span class="s3">\n </span><span class="s1">*   // on /dashboard/[team] where pathname is /dashboard/nextjs</span><span class="s3">\n </span><span class="s1">*   const { team } = useParams() // team === </span><span class="s3">\&quot;</span><span class="s1">nextjs</span><span class="s3">\&quot;\n </span><span class="s1">* }</span><span class="s3">\n </span><span class="s1">* ```</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `useParams`](https://nextjs.org/docs/app/api-reference/functions/use-params)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">// Client components API</span><span class="s3">\n</span><span class="s1">export function useParams&lt;T extends Params = Params&gt;(): T {</span><span class="s3">\n  </span><span class="s1">useDynamicRouteParams?.('useParams()')</span><span class="s3">\n\n  </span><span class="s1">return useContext(PathParamsContext) as T</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/** Get the canonical parameters from the current level to the leaf node. */</span><span class="s3">\n</span><span class="s1">// Client components API</span><span class="s3">\n</span><span class="s1">function getSelectedLayoutSegmentPath(</span><span class="s3">\n  </span><span class="s1">tree: FlightRouterState,</span><span class="s3">\n  </span><span class="s1">parallelRouteKey: string,</span><span class="s3">\n  </span><span class="s1">first = true,</span><span class="s3">\n  </span><span class="s1">segmentPath: string[] = []</span><span class="s3">\n</span><span class="s1">): string[] {</span><span class="s3">\n  </span><span class="s1">let node: FlightRouterState</span><span class="s3">\n  </span><span class="s1">if (first) {</span><span class="s3">\n    </span><span class="s1">// Use the provided parallel route key on the first parallel route</span><span class="s3">\n    </span><span class="s1">node = tree[1][parallelRouteKey]</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">// After first parallel route prefer children, if there's no children pick the first parallel route.</span><span class="s3">\n    </span><span class="s1">const parallelRoutes = tree[1]</span><span class="s3">\n    </span><span class="s1">node = parallelRoutes.children ?? Object.values(parallelRoutes)[0]</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!node) return segmentPath</span><span class="s3">\n  </span><span class="s1">const segment = node[0]</span><span class="s3">\n\n  </span><span class="s1">let segmentValue = getSegmentValue(segment)</span><span class="s3">\n\n  </span><span class="s1">if (!segmentValue || segmentValue.startsWith(PAGE_SEGMENT_KEY)) {</span><span class="s3">\n    </span><span class="s1">return segmentPath</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">segmentPath.push(segmentValue)</span><span class="s3">\n\n  </span><span class="s1">return getSelectedLayoutSegmentPath(</span><span class="s3">\n    </span><span class="s1">node,</span><span class="s3">\n    </span><span class="s1">parallelRouteKey,</span><span class="s3">\n    </span><span class="s1">false,</span><span class="s3">\n    </span><span class="s1">segmentPath</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* A [Client Component](https://nextjs.org/docs/app/building-your-application/rendering/client-components) hook</span><span class="s3">\n </span><span class="s1">* that lets you read the active route segments **below** the Layout it is called from.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @example</span><span class="s3">\n </span><span class="s1">* ```ts</span><span class="s3">\n </span><span class="s1">* 'use client'</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* import { useSelectedLayoutSegments } from 'next/navigation'</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* export default function ExampleClientComponent() {</span><span class="s3">\n </span><span class="s1">*   const segments = useSelectedLayoutSegments()</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">*   return (</span><span class="s3">\n </span><span class="s1">*     &lt;ul&gt;</span><span class="s3">\n </span><span class="s1">*       {segments.map((segment, index) =&gt; (</span><span class="s3">\n </span><span class="s1">*         &lt;li key={index}&gt;{segment}&lt;/li&gt;</span><span class="s3">\n </span><span class="s1">*       ))}</span><span class="s3">\n </span><span class="s1">*     &lt;/ul&gt;</span><span class="s3">\n </span><span class="s1">*   )</span><span class="s3">\n </span><span class="s1">* }</span><span class="s3">\n </span><span class="s1">* ```</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `useSelectedLayoutSegments`](https://nextjs.org/docs/app/api-reference/functions/use-selected-layout-segments)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">// Client components API</span><span class="s3">\n</span><span class="s1">export function useSelectedLayoutSegments(</span><span class="s3">\n  </span><span class="s1">parallelRouteKey: string = 'children'</span><span class="s3">\n</span><span class="s1">): string[] {</span><span class="s3">\n  </span><span class="s1">useDynamicRouteParams?.('useSelectedLayoutSegments()')</span><span class="s3">\n\n  </span><span class="s1">const context = useContext(LayoutRouterContext)</span><span class="s3">\n  </span><span class="s1">// @ts-expect-error This only happens in `pages`. Type is overwritten in navigation.d.ts</span><span class="s3">\n  </span><span class="s1">if (!context) return null</span><span class="s3">\n\n  </span><span class="s1">return getSelectedLayoutSegmentPath(context.parentTree, parallelRouteKey)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* A [Client Component](https://nextjs.org/docs/app/building-your-application/rendering/client-components) hook</span><span class="s3">\n </span><span class="s1">* that lets you read the active route segment **one level below** the Layout it is called from.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @example</span><span class="s3">\n </span><span class="s1">* ```ts</span><span class="s3">\n </span><span class="s1">* 'use client'</span><span class="s3">\n </span><span class="s1">* import { useSelectedLayoutSegment } from 'next/navigation'</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* export default function ExampleClientComponent() {</span><span class="s3">\n </span><span class="s1">*   const segment = useSelectedLayoutSegment()</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">*   return &lt;p&gt;Active segment: {segment}&lt;/p&gt;</span><span class="s3">\n </span><span class="s1">* }</span><span class="s3">\n </span><span class="s1">* ```</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Read more: [Next.js Docs: `useSelectedLayoutSegment`](https://nextjs.org/docs/app/api-reference/functions/use-selected-layout-segment)</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">// Client components API</span><span class="s3">\n</span><span class="s1">export function useSelectedLayoutSegment(</span><span class="s3">\n  </span><span class="s1">parallelRouteKey: string = 'children'</span><span class="s3">\n</span><span class="s1">): string | null {</span><span class="s3">\n  </span><span class="s1">useDynamicRouteParams?.('useSelectedLayoutSegment()')</span><span class="s3">\n\n  </span><span class="s1">const selectedLayoutSegments = useSelectedLayoutSegments(parallelRouteKey)</span><span class="s3">\n\n  </span><span class="s1">if (!selectedLayoutSegments || selectedLayoutSegments.length === 0) {</span><span class="s3">\n    </span><span class="s1">return null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const selectedLayoutSegment =</span><span class="s3">\n    </span><span class="s1">parallelRouteKey === 'children'</span><span class="s3">\n      </span><span class="s1">? selectedLayoutSegments[0]</span><span class="s3">\n      </span><span class="s1">: selectedLayoutSegments[selectedLayoutSegments.length - 1]</span><span class="s3">\n\n  </span><span class="s1">// if the default slot is showing, we return null since it's not technically </span><span class="s3">\&quot;</span><span class="s1">selected</span><span class="s3">\&quot; </span><span class="s1">(it's a fallback)</span><span class="s3">\n  </span><span class="s1">// and returning an internal value like `__DEFAULT__` would be confusing.</span><span class="s3">\n  </span><span class="s1">return selectedLayoutSegment === DEFAULT_SEGMENT_KEY</span><span class="s3">\n    </span><span class="s1">? null</span><span class="s3">\n    </span><span class="s1">: selectedLayoutSegment</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export { unstable_isUnrecognizedActionError } from './unrecognized-action-error'</span><span class="s3">\n\n</span><span class="s1">// Shared components APIs</span><span class="s3">\n</span><span class="s1">export {</span><span class="s3">\n  </span><span class="s1">notFound,</span><span class="s3">\n  </span><span class="s1">forbidden,</span><span class="s3">\n  </span><span class="s1">unauthorized,</span><span class="s3">\n  </span><span class="s1">redirect,</span><span class="s3">\n  </span><span class="s1">permanentRedirect,</span><span class="s3">\n  </span><span class="s1">RedirectType,</span><span class="s3">\n  </span><span class="s1">ReadonlyURLSearchParams,</span><span class="s3">\n  </span><span class="s1">unstable_rethrow,</span><span class="s3">\n</span><span class="s1">} from './navigation.react-server'</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;useContext&quot;</span><span class="s0">,</span><span class="s1">&quot;useMemo&quot;</span><span class="s0">,</span><span class="s1">&quot;AppRouterContext&quot;</span><span class="s0">,</span><span class="s1">&quot;LayoutRouterContext&quot;</span><span class="s0">,</span><span class="s1">&quot;SearchParamsContext&quot;</span><span class="s0">,</span><span class="s1">&quot;PathnameContext&quot;</span><span class="s0">,</span><span class="s1">&quot;PathParamsContext&quot;</span><span class="s0">,</span><span class="s1">&quot;getSegmentValue&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGE_SEGMENT_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;DEFAULT_SEGMENT_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;ReadonlyURLSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;useDynamicRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;useSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;searchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;readonlySearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;bailoutToClientRendering&quot;</span><span class="s0">,</span><span class="s1">&quot;usePathname&quot;</span><span class="s0">,</span><span class="s1">&quot;ServerInsertedHTMLContext&quot;</span><span class="s0">,</span><span class="s1">&quot;useServerInsertedHTML&quot;</span><span class="s0">,</span><span class="s1">&quot;useRouter&quot;</span><span class="s0">,</span><span class="s1">&quot;router&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;useParams&quot;</span><span class="s0">,</span><span class="s1">&quot;getSelectedLayoutSegmentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;tree&quot;</span><span class="s0">,</span><span class="s1">&quot;parallelRouteKey&quot;</span><span class="s0">,</span><span class="s1">&quot;first&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;node&quot;</span><span class="s0">,</span><span class="s1">&quot;parallelRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;children&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;values&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentValue&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;useSelectedLayoutSegments&quot;</span><span class="s0">,</span><span class="s1">&quot;context&quot;</span><span class="s0">,</span><span class="s1">&quot;parentTree&quot;</span><span class="s0">,</span><span class="s1">&quot;useSelectedLayoutSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;selectedLayoutSegments&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;selectedLayoutSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_isUnrecognizedActionError&quot;</span><span class="s0">,</span><span class="s1">&quot;notFound&quot;</span><span class="s0">,</span><span class="s1">&quot;forbidden&quot;</span><span class="s0">,</span><span class="s1">&quot;unauthorized&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;permanentRedirect&quot;</span><span class="s0">,</span><span class="s1">&quot;RedirectType&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_rethrow&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2790</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/redirect-boundary.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n</span><span class="s1">import React, { useEffect } from 'react'</span><span class="s3">\n</span><span class="s1">import type { AppRouterInstance } from '../../shared/lib/app-router-context.shared-runtime'</span><span class="s3">\n</span><span class="s1">import { useRouter } from './navigation'</span><span class="s3">\n</span><span class="s1">import { getRedirectTypeFromError, getURLFromRedirectError } from './redirect'</span><span class="s3">\n</span><span class="s1">import { RedirectType, isRedirectError } from './redirect-error'</span><span class="s3">\n\n</span><span class="s1">interface RedirectBoundaryProps {</span><span class="s3">\n  </span><span class="s1">router: AppRouterInstance</span><span class="s3">\n  </span><span class="s1">children: React.ReactNode</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function HandleRedirect({</span><span class="s3">\n  </span><span class="s1">redirect,</span><span class="s3">\n  </span><span class="s1">reset,</span><span class="s3">\n  </span><span class="s1">redirectType,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">redirect: string</span><span class="s3">\n  </span><span class="s1">redirectType: RedirectType</span><span class="s3">\n  </span><span class="s1">reset: () =&gt; void</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">const router = useRouter()</span><span class="s3">\n\n  </span><span class="s1">useEffect(() =&gt; {</span><span class="s3">\n    </span><span class="s1">React.startTransition(() =&gt; {</span><span class="s3">\n      </span><span class="s1">if (redirectType === RedirectType.push) {</span><span class="s3">\n        </span><span class="s1">router.push(redirect, {})</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">router.replace(redirect, {})</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">reset()</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}, [redirect, redirectType, reset, router])</span><span class="s3">\n\n  </span><span class="s1">return null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class RedirectErrorBoundary extends React.Component&lt;</span><span class="s3">\n  </span><span class="s1">RedirectBoundaryProps,</span><span class="s3">\n  </span><span class="s1">{ redirect: string | null; redirectType: RedirectType | null }</span><span class="s3">\n</span><span class="s1">&gt; {</span><span class="s3">\n  </span><span class="s1">constructor(props: RedirectBoundaryProps) {</span><span class="s3">\n    </span><span class="s1">super(props)</span><span class="s3">\n    </span><span class="s1">this.state = { redirect: null, redirectType: null }</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static getDerivedStateFromError(error: any) {</span><span class="s3">\n    </span><span class="s1">if (isRedirectError(error)) {</span><span class="s3">\n      </span><span class="s1">const url = getURLFromRedirectError(error)</span><span class="s3">\n      </span><span class="s1">const redirectType = getRedirectTypeFromError(error)</span><span class="s3">\n      </span><span class="s1">return { redirect: url, redirectType }</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">// Re-throw if error is not for redirect</span><span class="s3">\n    </span><span class="s1">throw error</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Explicit type is needed to avoid the generated `.d.ts` having a wide return type that could be specific to the `@types/react` version.</span><span class="s3">\n  </span><span class="s1">render(): React.ReactNode {</span><span class="s3">\n    </span><span class="s1">const { redirect, redirectType } = this.state</span><span class="s3">\n    </span><span class="s1">if (redirect !== null &amp;&amp; redirectType !== null) {</span><span class="s3">\n      </span><span class="s1">return (</span><span class="s3">\n        </span><span class="s1">&lt;HandleRedirect</span><span class="s3">\n          </span><span class="s1">redirect={redirect}</span><span class="s3">\n          </span><span class="s1">redirectType={redirectType}</span><span class="s3">\n          </span><span class="s1">reset={() =&gt; this.setState({ redirect: null })}</span><span class="s3">\n        </span><span class="s1">/&gt;</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return this.props.children</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function RedirectBoundary({ children }: { children: React.ReactNode }) {</span><span class="s3">\n  </span><span class="s1">const router = useRouter()</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">&lt;RedirectErrorBoundary router={router}&gt;{children}&lt;/RedirectErrorBoundary&gt;</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;React&quot;</span><span class="s0">,</span><span class="s1">&quot;useEffect&quot;</span><span class="s0">,</span><span class="s1">&quot;useRouter&quot;</span><span class="s0">,</span><span class="s1">&quot;getRedirectTypeFromError&quot;</span><span class="s0">,</span><span class="s1">&quot;getURLFromRedirectError&quot;</span><span class="s0">,</span><span class="s1">&quot;RedirectType&quot;</span><span class="s0">,</span><span class="s1">&quot;isRedirectError&quot;</span><span class="s0">,</span><span class="s1">&quot;HandleRedirect&quot;</span><span class="s0">,</span><span class="s1">&quot;redirect&quot;</span><span class="s0">,</span><span class="s1">&quot;reset&quot;</span><span class="s0">,</span><span class="s1">&quot;redirectType&quot;</span><span class="s0">,</span><span class="s1">&quot;router&quot;</span><span class="s0">,</span><span class="s1">&quot;startTransition&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;RedirectErrorBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;Component&quot;</span><span class="s0">,</span><span class="s1">&quot;getDerivedStateFromError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;render&quot;</span><span class="s0">,</span><span class="s1">&quot;state&quot;</span><span class="s0">,</span><span class="s1">&quot;setState&quot;</span><span class="s0">,</span><span class="s1">&quot;props&quot;</span><span class="s0">,</span><span class="s1">&quot;children&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;RedirectBoundary&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;AACA,OAAOA,SAASC,SAAS,QAAQ,QAAO;AAExC,SAASC,SAAS,QAAQ,eAAc;AACxC,SAASC,wBAAwB,EAAEC,uBAAuB,QAAQ,aAAY;AAC9E,SAASC,YAAY,EAAEC,eAAe,QAAQ,mBAAkB;AALhE;;;;;;AAYA,SAASC,eAAe,KAQvB;IARuB,IAAA,EACtBC,QAAQ,EACRC,KAAK,EACLC,YAAY,EAKb,GARuB;IAStB,MAAMC,aAAST,sMAAAA;QAEfD,kNAAAA,EAAU;QACRD,gNAAAA,CAAMY,eAAe,CAAC;YACpB,IAAIF,iBAAiBL,gMAAAA,CAAaQ,IAAI,EAAE;gBACtCF,OAAOE,IAAI,CAACL,UAAU,CAAC;YACzB,OAAO;gBACLG,OAAOG,OAAO,CAACN,UAAU,CAAC;YAC5B;YACAC;QACF;IACF,GAAG;QAACD;QAAUE;QAAcD;QAAOE;KAAO;IAE1C,OAAO;AACT;AAEO,MAAMI,8BAA8Bf,gNAAAA,CAAMgB,SAAS;IASxD,OAAOC,yBAAyBC,KAAU,EAAE;QAC1C,QAAIZ,mMAAAA,EAAgBY,QAAQ;YAC1B,MAAMC,UAAMf,kMAAAA,EAAwBc;YACpC,MAAMR,mBAAeP,mMAAAA,EAAyBe;YAC9C,OAAO;gBAAEV,UAAUW;gBAAKT;YAAa;QACvC;QACA,wCAAwC;QACxC,MAAMQ;IACR;IAEA,yIAAyI;IACzIE,SAA0B;QACxB,MAAM,EAAEZ,QAAQ,EAAEE,YAAY,EAAE,GAAG,IAAI,CAACW,KAAK;QAC7C,IAAIb,aAAa,QAAQE,iBAAiB,MAAM;YAC9C,OAAA,WAAA,OACE,8NAAA,EAACH,gBAAAA;gBACCC,UAAUA;gBACVE,cAAcA;gBACdD,OAAO,IAAM,IAAI,CAACa,QAAQ,CAAC;wBAAEd,UAAU;oBAAK;;QAGlD;QAEA,OAAO,IAAI,CAACe,KAAK,CAACC,QAAQ;IAC5B;IA7BAC,YAAYF,KAA4B,CAAE;QACxC,KAAK,CAACA;QACN,IAAI,CAACF,KAAK,GAAG;YAAEb,UAAU;YAAME,cAAc;QAAK;IACpD;AA2BF;AAEO,SAASgB,iBAAiB,KAA2C;IAA3C,IAAA,EAAEF,QAAQ,EAAiC,GAA3C;IAC/B,MAAMb,aAAST,sMAAAA;IACf,OAAA,WAAA,OACE,8NAAA,EAACa,uBAAAA;QAAsBJ,QAAQA;kBAASa;;AAE5C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">2874</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/http-access-fallback/error-boundary.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* HTTPAccessFallbackBoundary is a boundary that catches errors and renders a</span><span class="s3">\n </span><span class="s1">* fallback component for HTTP errors.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* It receives the status code, and determine if it should render fallbacks for few HTTP 4xx errors.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* e.g. 404</span><span class="s3">\n </span><span class="s1">* 404 represents not found, and the fallback component pair contains the component and its styles.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">import React, { useContext } from 'react'</span><span class="s3">\n</span><span class="s1">import { useUntrackedPathname } from '../navigation-untracked'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">HTTPAccessErrorStatus,</span><span class="s3">\n  </span><span class="s1">getAccessFallbackHTTPStatus,</span><span class="s3">\n  </span><span class="s1">getAccessFallbackErrorTypeByStatus,</span><span class="s3">\n  </span><span class="s1">isHTTPAccessFallbackError,</span><span class="s3">\n</span><span class="s1">} from './http-access-fallback'</span><span class="s3">\n</span><span class="s1">import { warnOnce } from '../../../shared/lib/utils/warn-once'</span><span class="s3">\n</span><span class="s1">import { MissingSlotContext } from '../../../shared/lib/app-router-context.shared-runtime'</span><span class="s3">\n\n</span><span class="s1">interface HTTPAccessFallbackBoundaryProps {</span><span class="s3">\n  </span><span class="s1">notFound?: React.ReactNode</span><span class="s3">\n  </span><span class="s1">forbidden?: React.ReactNode</span><span class="s3">\n  </span><span class="s1">unauthorized?: React.ReactNode</span><span class="s3">\n  </span><span class="s1">children: React.ReactNode</span><span class="s3">\n  </span><span class="s1">missingSlots?: Set&lt;string&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface HTTPAccessFallbackErrorBoundaryProps</span><span class="s3">\n  </span><span class="s1">extends HTTPAccessFallbackBoundaryProps {</span><span class="s3">\n  </span><span class="s1">pathname: string | null</span><span class="s3">\n  </span><span class="s1">missingSlots?: Set&lt;string&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface HTTPAccessBoundaryState {</span><span class="s3">\n  </span><span class="s1">triggeredStatus: number | undefined</span><span class="s3">\n  </span><span class="s1">previousPathname: string | null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">class HTTPAccessFallbackErrorBoundary extends React.Component&lt;</span><span class="s3">\n  </span><span class="s1">HTTPAccessFallbackErrorBoundaryProps,</span><span class="s3">\n  </span><span class="s1">HTTPAccessBoundaryState</span><span class="s3">\n</span><span class="s1">&gt; {</span><span class="s3">\n  </span><span class="s1">constructor(props: HTTPAccessFallbackErrorBoundaryProps) {</span><span class="s3">\n    </span><span class="s1">super(props)</span><span class="s3">\n    </span><span class="s1">this.state = {</span><span class="s3">\n      </span><span class="s1">triggeredStatus: undefined,</span><span class="s3">\n      </span><span class="s1">previousPathname: props.pathname,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">componentDidCatch(): void {</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">process.env.NODE_ENV === 'development' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">this.props.missingSlots &amp;&amp;</span><span class="s3">\n      </span><span class="s1">this.props.missingSlots.size &gt; 0 &amp;&amp;</span><span class="s3">\n      </span><span class="s1">// A missing children slot is the typical not-found case, so no need to warn</span><span class="s3">\n      </span><span class="s1">!this.props.missingSlots.has('children')</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">let warningMessage =</span><span class="s3">\n        </span><span class="s1">'No default component was found for a parallel route rendered on this page. Falling back to nearest NotFound boundary.</span><span class="s3">\\</span><span class="s1">n' +</span><span class="s3">\n        </span><span class="s1">'Learn more: https://nextjs.org/docs/app/building-your-application/routing/parallel-routes#defaultjs</span><span class="s3">\\</span><span class="s1">n</span><span class="s3">\\</span><span class="s1">n'</span><span class="s3">\n\n      </span><span class="s1">const formattedSlots = Array.from(this.props.missingSlots)</span><span class="s3">\n        </span><span class="s1">.sort((a, b) =&gt; a.localeCompare(b))</span><span class="s3">\n        </span><span class="s1">.map((slot) =&gt; `@${slot}`)</span><span class="s3">\n        </span><span class="s1">.join(', ')</span><span class="s3">\n\n      </span><span class="s1">warningMessage += 'Missing slots: ' + formattedSlots</span><span class="s3">\n\n      </span><span class="s1">warnOnce(warningMessage)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static getDerivedStateFromError(error: any) {</span><span class="s3">\n    </span><span class="s1">if (isHTTPAccessFallbackError(error)) {</span><span class="s3">\n      </span><span class="s1">const httpStatus = getAccessFallbackHTTPStatus(error)</span><span class="s3">\n      </span><span class="s1">return {</span><span class="s3">\n        </span><span class="s1">triggeredStatus: httpStatus,</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">// Re-throw if error is not for 404</span><span class="s3">\n    </span><span class="s1">throw error</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static getDerivedStateFromProps(</span><span class="s3">\n    </span><span class="s1">props: HTTPAccessFallbackErrorBoundaryProps,</span><span class="s3">\n    </span><span class="s1">state: HTTPAccessBoundaryState</span><span class="s3">\n  </span><span class="s1">): HTTPAccessBoundaryState | null {</span><span class="s3">\n    </span><span class="s1">/**</span><span class="s3">\n     </span><span class="s1">* Handles reset of the error boundary when a navigation happens.</span><span class="s3">\n     </span><span class="s1">* Ensures the error boundary does not stay enabled when navigating to a new page.</span><span class="s3">\n     </span><span class="s1">* Approach of setState in render is safe as it checks the previous pathname and then overrides</span><span class="s3">\n     </span><span class="s1">* it as outlined in https://react.dev/reference/react/useState#storing-information-from-previous-renders</span><span class="s3">\n     </span><span class="s1">*/</span><span class="s3">\n    </span><span class="s1">if (props.pathname !== state.previousPathname &amp;&amp; state.triggeredStatus) {</span><span class="s3">\n      </span><span class="s1">return {</span><span class="s3">\n        </span><span class="s1">triggeredStatus: undefined,</span><span class="s3">\n        </span><span class="s1">previousPathname: props.pathname,</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">triggeredStatus: state.triggeredStatus,</span><span class="s3">\n      </span><span class="s1">previousPathname: props.pathname,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">render() {</span><span class="s3">\n    </span><span class="s1">const { notFound, forbidden, unauthorized, children } = this.props</span><span class="s3">\n    </span><span class="s1">const { triggeredStatus } = this.state</span><span class="s3">\n    </span><span class="s1">const errorComponents = {</span><span class="s3">\n      </span><span class="s1">[HTTPAccessErrorStatus.NOT_FOUND]: notFound,</span><span class="s3">\n      </span><span class="s1">[HTTPAccessErrorStatus.FORBIDDEN]: forbidden,</span><span class="s3">\n      </span><span class="s1">[HTTPAccessErrorStatus.UNAUTHORIZED]: unauthorized,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (triggeredStatus) {</span><span class="s3">\n      </span><span class="s1">const isNotFound =</span><span class="s3">\n        </span><span class="s1">triggeredStatus === HTTPAccessErrorStatus.NOT_FOUND &amp;&amp; notFound</span><span class="s3">\n      </span><span class="s1">const isForbidden =</span><span class="s3">\n        </span><span class="s1">triggeredStatus === HTTPAccessErrorStatus.FORBIDDEN &amp;&amp; forbidden</span><span class="s3">\n      </span><span class="s1">const isUnauthorized =</span><span class="s3">\n        </span><span class="s1">triggeredStatus === HTTPAccessErrorStatus.UNAUTHORIZED &amp;&amp; unauthorized</span><span class="s3">\n\n      </span><span class="s1">// If there's no matched boundary in this layer, keep throwing the error by rendering the children</span><span class="s3">\n      </span><span class="s1">if (!(isNotFound || isForbidden || isUnauthorized)) {</span><span class="s3">\n        </span><span class="s1">return children</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return (</span><span class="s3">\n        </span><span class="s1">&lt;&gt;</span><span class="s3">\n          </span><span class="s1">&lt;meta name=</span><span class="s3">\&quot;</span><span class="s1">robots</span><span class="s3">\&quot; </span><span class="s1">content=</span><span class="s3">\&quot;</span><span class="s1">noindex</span><span class="s3">\&quot; </span><span class="s1">/&gt;</span><span class="s3">\n          </span><span class="s1">{process.env.NODE_ENV === 'development' &amp;&amp; (</span><span class="s3">\n            </span><span class="s1">&lt;meta</span><span class="s3">\n              </span><span class="s1">name=</span><span class="s3">\&quot;</span><span class="s1">boundary-next-error</span><span class="s3">\&quot;\n              </span><span class="s1">content={getAccessFallbackErrorTypeByStatus(triggeredStatus)}</span><span class="s3">\n            </span><span class="s1">/&gt;</span><span class="s3">\n          </span><span class="s1">)}</span><span class="s3">\n          </span><span class="s1">{errorComponents[triggeredStatus]}</span><span class="s3">\n        </span><span class="s1">&lt;/&gt;</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return children</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function HTTPAccessFallbackBoundary({</span><span class="s3">\n  </span><span class="s1">notFound,</span><span class="s3">\n  </span><span class="s1">forbidden,</span><span class="s3">\n  </span><span class="s1">unauthorized,</span><span class="s3">\n  </span><span class="s1">children,</span><span class="s3">\n</span><span class="s1">}: HTTPAccessFallbackBoundaryProps) {</span><span class="s3">\n  </span><span class="s1">// When we're rendering the missing params shell, this will return null. This</span><span class="s3">\n  </span><span class="s1">// is because we won't be rendering any not found boundaries or error</span><span class="s3">\n  </span><span class="s1">// boundaries for the missing params shell. When this runs on the client</span><span class="s3">\n  </span><span class="s1">// (where these error can occur), we will get the correct pathname.</span><span class="s3">\n  </span><span class="s1">const pathname = useUntrackedPathname()</span><span class="s3">\n  </span><span class="s1">const missingSlots = useContext(MissingSlotContext)</span><span class="s3">\n  </span><span class="s1">const hasErrorFallback = !!(notFound || forbidden || unauthorized)</span><span class="s3">\n\n  </span><span class="s1">if (hasErrorFallback) {</span><span class="s3">\n    </span><span class="s1">return (</span><span class="s3">\n      </span><span class="s1">&lt;HTTPAccessFallbackErrorBoundary</span><span class="s3">\n        </span><span class="s1">pathname={pathname}</span><span class="s3">\n        </span><span class="s1">notFound={notFound}</span><span class="s3">\n        </span><span class="s1">forbidden={forbidden}</span><span class="s3">\n        </span><span class="s1">unauthorized={unauthorized}</span><span class="s3">\n        </span><span class="s1">missingSlots={missingSlots}</span><span class="s3">\n      </span><span class="s1">&gt;</span><span class="s3">\n        </span><span class="s1">{children}</span><span class="s3">\n      </span><span class="s1">&lt;/HTTPAccessFallbackErrorBoundary&gt;</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return &lt;&gt;{children}&lt;/&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;React&quot;</span><span class="s0">,</span><span class="s1">&quot;useContext&quot;</span><span class="s0">,</span><span class="s1">&quot;useUntrackedPathname&quot;</span><span class="s0">,</span><span class="s1">&quot;HTTPAccessErrorStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;getAccessFallbackHTTPStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;getAccessFallbackErrorTypeByStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;isHTTPAccessFallbackError&quot;</span><span class="s0">,</span><span class="s1">&quot;warnOnce&quot;</span><span class="s0">,</span><span class="s1">&quot;MissingSlotContext&quot;</span><span class="s0">,</span><span class="s1">&quot;HTTPAccessFallbackErrorBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;Component&quot;</span><span class="s0">,</span><span class="s1">&quot;componentDidCatch&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;props&quot;</span><span class="s0">,</span><span class="s1">&quot;missingSlots&quot;</span><span class="s0">,</span><span class="s1">&quot;size&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;warningMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;formattedSlots&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;sort&quot;</span><span class="s0">,</span><span class="s1">&quot;a&quot;</span><span class="s0">,</span><span class="s1">&quot;b&quot;</span><span class="s0">,</span><span class="s1">&quot;localeCompare&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;slot&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;getDerivedStateFromError&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;httpStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;triggeredStatus&quot;</span><span class="s0">,</span><span class="s1">&quot;getDerivedStateFromProps&quot;</span><span class="s0">,</span><span class="s1">&quot;state&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;previousPathname&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;render&quot;</span><span class="s0">,</span><span class="s1">&quot;notFound&quot;</span><span class="s0">,</span><span class="s1">&quot;forbidden&quot;</span><span class="s0">,</span><span class="s1">&quot;unauthorized&quot;</span><span class="s0">,</span><span class="s1">&quot;children&quot;</span><span class="s0">,</span><span class="s1">&quot;errorComponents&quot;</span><span class="s0">,</span><span class="s1">&quot;NOT_FOUND&quot;</span><span class="s0">,</span><span class="s1">&quot;FORBIDDEN&quot;</span><span class="s0">,</span><span class="s1">&quot;UNAUTHORIZED&quot;</span><span class="s0">,</span><span class="s1">&quot;isNotFound&quot;</span><span class="s0">,</span><span class="s1">&quot;isForbidden&quot;</span><span class="s0">,</span><span class="s1">&quot;isUnauthorized&quot;</span><span class="s0">,</span><span class="s1">&quot;meta&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;content&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;HTTPAccessFallbackBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;hasErrorFallback&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;AAEA;;;;;;;;;CASC,GAED,OAAOA,SAASC,UAAU,QAAQ,QAAO;AACzC,SAASC,oBAAoB,QAAQ,0BAAyB;AAC9D,SACEC,qBAAqB,EACrBC,2BAA2B,EAC3BC,kCAAkC,EAClCC,yBAAyB,QACpB,yBAAwB;AAC/B,SAASC,QAAQ,QAAQ,sCAAqC;AAC9D,SAASC,kBAAkB,QAAQ,wDAAuD;AAtB1F;;;;;;;AA2CA,MAAMC,wCAAwCT,gNAAAA,CAAMU,SAAS;IAY3DC,oBAA0B;QACxB,IACEC,QAAQC,GAAG,CAACC,QAAQ,gCAAK,iBACzB,IAAI,CAACC,KAAK,CAACC,YAAY,IACvB,IAAI,CAACD,KAAK,CAACC,YAAY,CAACC,IAAI,GAAG,KAC/B,4EAA4E;QAC5E,CAAC,IAAI,CAACF,KAAK,CAACC,YAAY,CAACE,GAAG,CAAC,aAC7B;YACA,IAAIC,iBACF,4HACA;YAEF,MAAMC,iBAAiBC,MAAMC,IAAI,CAAC,IAAI,CAACP,KAAK,CAACC,YAAY,EACtDO,IAAI,CAAC,CAACC,GAAGC,IAAMD,EAAEE,aAAa,CAACD,IAC/BE,GAAG,CAAC,CAACC,OAAU,MAAGA,MAClBC,IAAI,CAAC;YAERV,kBAAkB,oBAAoBC;gBAEtCb,yLAAAA,EAASY;QACX;IACF;IAEA,OAAOW,yBAAyBC,KAAU,EAAE;QAC1C,IAAIzB,wPAAAA,EAA0ByB,QAAQ;YACpC,MAAMC,iBAAa5B,sPAAAA,EAA4B2B;YAC/C,OAAO;gBACLE,iBAAiBD;YACnB;QACF;QACA,mCAAmC;QACnC,MAAMD;IACR;IAEA,OAAOG,yBACLnB,KAA2C,EAC3CoB,KAA8B,EACE;QAChC;;;;;KAKC,GACD,IAAIpB,MAAMqB,QAAQ,KAAKD,MAAME,gBAAgB,IAAIF,MAAMF,eAAe,EAAE;YACtE,OAAO;gBACLA,iBAAiBK;gBACjBD,kBAAkBtB,MAAMqB,QAAQ;YAClC;QACF;QACA,OAAO;YACLH,iBAAiBE,MAAMF,eAAe;YACtCI,kBAAkBtB,MAAMqB,QAAQ;QAClC;IACF;IAEAG,SAAS;QACP,MAAM,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,YAAY,EAAEC,QAAQ,EAAE,GAAG,IAAI,CAAC5B,KAAK;QAClE,MAAM,EAAEkB,eAAe,EAAE,GAAG,IAAI,CAACE,KAAK;QACtC,MAAMS,kBAAkB;YACtB,CAACzC,gPAAAA,CAAsB0C,SAAS,CAAC,EAAEL;YACnC,CAACrC,gPAAAA,CAAsB2C,SAAS,CAAC,EAAEL;YACnC,CAACtC,gPAAAA,CAAsB4C,YAAY,CAAC,EAAEL;QACxC;QAEA,IAAIT,iBAAiB;YACnB,MAAMe,aACJf,oBAAoB9B,gPAAAA,CAAsB0C,SAAS,IAAIL;YACzD,MAAMS,cACJhB,oBAAoB9B,gPAAAA,CAAsB2C,SAAS,IAAIL;YACzD,MAAMS,iBACJjB,oBAAoB9B,gPAAAA,CAAsB4C,YAAY,IAAIL;YAE5D,kGAAkG;YAClG,IAAI,CAAEM,CAAAA,cAAcC,eAAeC,cAAa,GAAI;gBAClD,OAAOP;YACT;YAEA,OAAA,WAAA,OACE,+NAAA,EAAA,mOAAA,EAAA;;sCACE,8NAAA,EAACQ,QAAAA;wBAAKC,MAAK;wBAASC,SAAQ;;oBAC3BzC,QAAQC,GAAG,CAACC,QAAQ,gCAAK,iBAAA,WAAA,OACxB,8NAAA,EAACqC,QAAAA;wBACCC,MAAK;wBACLC,aAAShD,6PAAAA,EAAmC4B;;oBAG/CW,eAAe,CAACX,gBAAgB;;;QAGvC;QAEA,OAAOU;IACT;IArGAW,YAAYvC,KAA2C,CAAE;QACvD,KAAK,CAACA;QACN,IAAI,CAACoB,KAAK,GAAG;YACXF,iBAAiBK;YACjBD,kBAAkBtB,MAAMqB,QAAQ;QAClC;IACF;AAgGF;AAEO,SAASmB,2BAA2B,KAKT;IALS,IAAA,EACzCf,QAAQ,EACRC,SAAS,EACTC,YAAY,EACZC,QAAQ,EACwB,GALS;IAMzC,6EAA6E;IAC7E,qEAAqE;IACrE,wEAAwE;IACxE,mEAAmE;IACnE,MAAMP,eAAWlC,8MAAAA;IACjB,MAAMc,mBAAef,mNAAAA,EAAWO,mPAAAA;IAChC,MAAMgD,mBAAmB,CAAC,CAAEhB,CAAAA,YAAYC,aAAaC,YAAW;IAEhE,IAAIc,kBAAkB;QACpB,OAAA,WAAA,OACE,8NAAA,EAAC/C,iCAAAA;YACC2B,UAAUA;YACVI,UAAUA;YACVC,WAAWA;YACXC,cAAcA;YACd1B,cAAcA;sBAEb2B;;IAGP;IAEA,OAAA,WAAA,OAAO,8NAAA,EAAA,mOAAA,EAAA;kBAAGA;;AACZ&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3004</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/router-reducer/create-router-cache-key.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { Segment } from '../../../server/app-render/types'</span><span class="s3">\n</span><span class="s1">import { PAGE_SEGMENT_KEY } from '../../../shared/lib/segment'</span><span class="s3">\n\n</span><span class="s1">export function createRouterCacheKey(</span><span class="s3">\n  </span><span class="s1">segment: Segment,</span><span class="s3">\n  </span><span class="s1">withoutSearchParameters: boolean = false</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">// if the segment is an array, it means it's a dynamic segment</span><span class="s3">\n  </span><span class="s1">// for example, ['lang', 'en', 'd']. We need to convert it to a string to store it as a cache node key.</span><span class="s3">\n  </span><span class="s1">if (Array.isArray(segment)) {</span><span class="s3">\n    </span><span class="s1">return `${segment[0]}|${segment[1]}|${segment[2]}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Page segments might have search parameters, ie __PAGE__?foo=bar</span><span class="s3">\n  </span><span class="s1">// When `withoutSearchParameters` is true, we only want to return the page segment</span><span class="s3">\n  </span><span class="s1">if (withoutSearchParameters &amp;&amp; segment.startsWith(PAGE_SEGMENT_KEY)) {</span><span class="s3">\n    </span><span class="s1">return PAGE_SEGMENT_KEY</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return segment</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;PAGE_SEGMENT_KEY&quot;</span><span class="s0">,</span><span class="s1">&quot;createRouterCacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;withoutSearchParameters&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AACA,SAASA,gBAAgB,QAAQ,8BAA6B;;AAEvD,SAASC,qBACdC,OAAgB,EAChBC,uBAAwC;IAAxCA,IAAAA,4BAAAA,KAAAA,GAAAA,0BAAmC;IAEnC,8DAA8D;IAC9D,uGAAuG;IACvG,IAAIC,MAAMC,OAAO,CAACH,UAAU;QAC1B,OAAUA,OAAO,CAAC,EAAE,GAAC,MAAGA,OAAO,CAAC,EAAE,GAAC,MAAGA,OAAO,CAAC,EAAE;IAClD;IAEA,kEAAkE;IAClE,kFAAkF;IAClF,IAAIC,2BAA2BD,QAAQI,UAAU,CAACN,mLAAAA,GAAmB;QACnE,OAAOA,mLAAAA;IACT;IAEA,OAAOE;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3028</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/page-path/ensure-leading-slash.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* For a given page path, this function ensures that there is a leading slash.</span><span class="s3">\n </span><span class="s1">* If there is not a leading slash, one is added, otherwise it is noop.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function ensureLeadingSlash(path: string) {</span><span class="s3">\n  </span><span class="s1">return path.startsWith('/') ? path : `/${path}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ensureLeadingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA;;;CAGC,GACD;;;;AAAO,SAASA,mBAAmBC,IAAY;IAC7C,OAAOA,KAAKC,UAAU,CAAC,OAAOD,OAAQ,MAAGA;AAC3C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3042</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/app-paths.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { ensureLeadingSlash } from '../../page-path/ensure-leading-slash'</span><span class="s3">\n</span><span class="s1">import { isGroupSegment } from '../../segment'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Normalizes an app route so it represents the actual request path. Essentially</span><span class="s3">\n </span><span class="s1">* performing the following transformations:</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/user/[id]/page` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/account/page` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/user/[id]/page` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/account/page` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/page` to `/`</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/user/[id]/route` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/(dashboard)/account/route` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/user/[id]/route` to `/user/[id]`</span><span class="s3">\n </span><span class="s1">* - `/account/route` to `/account`</span><span class="s3">\n </span><span class="s1">* - `/route` to `/`</span><span class="s3">\n </span><span class="s1">* - `/` to `/`</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param route the app route to normalize</span><span class="s3">\n </span><span class="s1">* @returns the normalized pathname</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeAppPath(route: string) {</span><span class="s3">\n  </span><span class="s1">return ensureLeadingSlash(</span><span class="s3">\n    </span><span class="s1">route.split('/').reduce((pathname, segment, index, segments) =&gt; {</span><span class="s3">\n      </span><span class="s1">// Empty segments are ignored.</span><span class="s3">\n      </span><span class="s1">if (!segment) {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Groups are ignored.</span><span class="s3">\n      </span><span class="s1">if (isGroupSegment(segment)) {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Parallel segments are ignored.</span><span class="s3">\n      </span><span class="s1">if (segment[0] === '@') {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// The last segment (if it's a leaf) should be ignored.</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">(segment === 'page' || segment === 'route') &amp;&amp;</span><span class="s3">\n        </span><span class="s1">index === segments.length - 1</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">return pathname</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return `${pathname}/${segment}`</span><span class="s3">\n    </span><span class="s1">}, '')</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Strips the `.rsc` extension if it's in the pathname.</span><span class="s3">\n </span><span class="s1">* Since this function is used on full urls it checks `?` for searchParams handling.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function normalizeRscURL(url: string) {</span><span class="s3">\n  </span><span class="s1">return url.replace(</span><span class="s3">\n    </span><span class="s1">/</span><span class="s3">\\</span><span class="s1">.rsc($|</span><span class="s3">\\</span><span class="s1">?)/,</span><span class="s3">\n    </span><span class="s1">// $1 ensures `?` is preserved</span><span class="s3">\n    </span><span class="s1">'$1'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ensureLeadingSlash&quot;</span><span class="s0">,</span><span class="s1">&quot;isGroupSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;reduce&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;segments&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeRscURL&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AAAA,SAASA,kBAAkB,QAAQ,uCAAsC;AACzE,SAASC,cAAc,QAAQ,gBAAe;;;AAqBvC,SAASC,iBAAiBC,KAAa;IAC5C,WAAOH,wNAAAA,EACLG,MAAMC,KAAK,CAAC,KAAKC,MAAM,CAAC,CAACC,UAAUC,SAASC,OAAOC;QACjD,8BAA8B;QAC9B,IAAI,CAACF,SAAS;YACZ,OAAOD;QACT;QAEA,sBAAsB;QACtB,QAAIL,iLAAAA,EAAeM,UAAU;YAC3B,OAAOD;QACT;QAEA,iCAAiC;QACjC,IAAIC,OAAO,CAAC,EAAE,KAAK,KAAK;YACtB,OAAOD;QACT;QAEA,uDAAuD;QACvD,IACGC,CAAAA,YAAY,UAAUA,YAAY,OAAM,KACzCC,UAAUC,SAASC,MAAM,GAAG,GAC5B;YACA,OAAOJ;QACT;QAEA,OAAUA,WAAS,MAAGC;IACxB,GAAG;AAEP;AAMO,SAASI,gBAAgBC,GAAW;IACzC,OAAOA,IAAIC,OAAO,CAChB,eACA,AACA,8BAD8B;AAGlC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3080</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/router/utils/interception-routes.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { normalizeAppPath } from './app-paths'</span><span class="s3">\n\n</span><span class="s1">// order matters here, the first match will be used</span><span class="s3">\n</span><span class="s1">export const INTERCEPTION_ROUTE_MARKERS = [</span><span class="s3">\n  </span><span class="s1">'(..)(..)',</span><span class="s3">\n  </span><span class="s1">'(.)',</span><span class="s3">\n  </span><span class="s1">'(..)',</span><span class="s3">\n  </span><span class="s1">'(...)',</span><span class="s3">\n</span><span class="s1">] as const</span><span class="s3">\n\n</span><span class="s1">export function isInterceptionRouteAppPath(path: string): boolean {</span><span class="s3">\n  </span><span class="s1">// TODO-APP: add more serious validation</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">path</span><span class="s3">\n      </span><span class="s1">.split('/')</span><span class="s3">\n      </span><span class="s1">.find((segment) =&gt;</span><span class="s3">\n        </span><span class="s1">INTERCEPTION_ROUTE_MARKERS.find((m) =&gt; segment.startsWith(m))</span><span class="s3">\n      </span><span class="s1">) !== undefined</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function extractInterceptionRouteInformation(path: string) {</span><span class="s3">\n  </span><span class="s1">let interceptingRoute: string | undefined,</span><span class="s3">\n    </span><span class="s1">marker: (typeof INTERCEPTION_ROUTE_MARKERS)[number] | undefined,</span><span class="s3">\n    </span><span class="s1">interceptedRoute: string | undefined</span><span class="s3">\n\n  </span><span class="s1">for (const segment of path.split('/')) {</span><span class="s3">\n    </span><span class="s1">marker = INTERCEPTION_ROUTE_MARKERS.find((m) =&gt; segment.startsWith(m))</span><span class="s3">\n    </span><span class="s1">if (marker) {</span><span class="s3">\n      </span><span class="s1">;[interceptingRoute, interceptedRoute] = path.split(marker, 2)</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!interceptingRoute || !marker || !interceptedRoute) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Invalid interception route: ${path}. Must be in the format /&lt;intercepting route&gt;/(..|...|..)(..)/&lt;intercepted route&gt;`</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">interceptingRoute = normalizeAppPath(interceptingRoute) // normalize the path, e.g. /(blog)/feed -&gt; /feed</span><span class="s3">\n\n  </span><span class="s1">switch (marker) {</span><span class="s3">\n    </span><span class="s1">case '(.)':</span><span class="s3">\n      </span><span class="s1">// (.) indicates that we should match with sibling routes, so we just need to append the intercepted route to the intercepting route</span><span class="s3">\n      </span><span class="s1">if (interceptingRoute === '/') {</span><span class="s3">\n        </span><span class="s1">interceptedRoute = `/${interceptedRoute}`</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">interceptedRoute = interceptingRoute + '/' + interceptedRoute</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">case '(..)':</span><span class="s3">\n      </span><span class="s1">// (..) indicates that we should match at one level up, so we need to remove the last segment of the intercepting route</span><span class="s3">\n      </span><span class="s1">if (interceptingRoute === '/') {</span><span class="s3">\n        </span><span class="s1">throw new Error(</span><span class="s3">\n          </span><span class="s1">`Invalid interception route: ${path}. Cannot use (..) marker at the root level, use (.) instead.`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">interceptedRoute = interceptingRoute</span><span class="s3">\n        </span><span class="s1">.split('/')</span><span class="s3">\n        </span><span class="s1">.slice(0, -1)</span><span class="s3">\n        </span><span class="s1">.concat(interceptedRoute)</span><span class="s3">\n        </span><span class="s1">.join('/')</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">case '(...)':</span><span class="s3">\n      </span><span class="s1">// (...) will match the route segment in the root directory, so we need to use the root directory to prepend the intercepted route</span><span class="s3">\n      </span><span class="s1">interceptedRoute = '/' + interceptedRoute</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">case '(..)(..)':</span><span class="s3">\n      </span><span class="s1">// (..)(..) indicates that we should match at two levels up, so we need to remove the last two segments of the intercepting route</span><span class="s3">\n\n      </span><span class="s1">const splitInterceptingRoute = interceptingRoute.split('/')</span><span class="s3">\n      </span><span class="s1">if (splitInterceptingRoute.length &lt;= 2) {</span><span class="s3">\n        </span><span class="s1">throw new Error(</span><span class="s3">\n          </span><span class="s1">`Invalid interception route: ${path}. Cannot use (..)(..) marker at the root level or one level up.`</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">interceptedRoute = splitInterceptingRoute</span><span class="s3">\n        </span><span class="s1">.slice(0, -2)</span><span class="s3">\n        </span><span class="s1">.concat(interceptedRoute)</span><span class="s3">\n        </span><span class="s1">.join('/')</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">throw new Error('Invariant: unexpected marker')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return { interceptingRoute, interceptedRoute }</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;INTERCEPTION_ROUTE_MARKERS&quot;</span><span class="s0">,</span><span class="s1">&quot;isInterceptionRouteAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;find&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;m&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;extractInterceptionRouteInformation&quot;</span><span class="s0">,</span><span class="s1">&quot;interceptingRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;marker&quot;</span><span class="s0">,</span><span class="s1">&quot;interceptedRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;concat&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;splitInterceptingRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;AAAA,SAASA,gBAAgB,QAAQ,cAAa;;AAGvC,MAAMC,6BAA6B;IACxC;IACA;IACA;IACA;CACD,CAAS;AAEH,SAASC,2BAA2BC,IAAY;IACrD,wCAAwC;IACxC,OACEA,KACGC,KAAK,CAAC,KACNC,IAAI,CAAC,CAACC,UACLL,2BAA2BI,IAAI,CAAC,CAACE,IAAMD,QAAQE,UAAU,CAACD,SACtDE;AAEZ;AAEO,SAASC,oCAAoCP,IAAY;IAC9D,IAAIQ,mBACFC,QACAC;IAEF,KAAK,MAAMP,WAAWH,KAAKC,KAAK,CAAC,KAAM;QACrCQ,SAASX,2BAA2BI,IAAI,CAAC,CAACE,IAAMD,QAAQE,UAAU,CAACD;QACnE,IAAIK,QAAQ;;YACT,CAACD,mBAAmBE,iBAAiB,GAAGV,KAAKC,KAAK,CAACQ,QAAQ;YAC5D;QACF;IACF;IAEA,IAAI,CAACD,qBAAqB,CAACC,UAAU,CAACC,kBAAkB;QACtD,MAAM,OAAA,cAEL,CAFK,IAAIC,MACP,iCAA8BX,OAAK,sFADhC,qBAAA;mBAAA;wBAAA;0BAAA;QAEN;IACF;IAEAQ,wBAAoBX,2MAAAA,EAAiBW,mBAAmB,iDAAiD;;IAEzG,OAAQC;QACN,KAAK;YACH,oIAAoI;YACpI,IAAID,sBAAsB,KAAK;gBAC7BE,mBAAoB,MAAGA;YACzB,OAAO;gBACLA,mBAAmBF,oBAAoB,MAAME;YAC/C;YACA;QACF,KAAK;YACH,uHAAuH;YACvH,IAAIF,sBAAsB,KAAK;gBAC7B,MAAM,OAAA,cAEL,CAFK,IAAIG,MACP,iCAA8BX,OAAK,iEADhC,qBAAA;2BAAA;gCAAA;kCAAA;gBAEN;YACF;YACAU,mBAAmBF,kBAChBP,KAAK,CAAC,KACNW,KAAK,CAAC,GAAG,CAAC,GACVC,MAAM,CAACH,kBACPI,IAAI,CAAC;YACR;QACF,KAAK;YACH,kIAAkI;YAClIJ,mBAAmB,MAAMA;YACzB;QACF,KAAK;YACH,iIAAiI;YAEjI,MAAMK,yBAAyBP,kBAAkBP,KAAK,CAAC;YACvD,IAAIc,uBAAuBC,MAAM,IAAI,GAAG;gBACtC,MAAM,OAAA,cAEL,CAFK,IAAIL,MACP,iCAA8BX,OAAK,oEADhC,qBAAA;2BAAA;gCAAA;kCAAA;gBAEN;YACF;YAEAU,mBAAmBK,uBAChBH,KAAK,CAAC,GAAG,CAAC,GACVC,MAAM,CAACH,kBACPI,IAAI,CAAC;YACR;QACF;YACE,MAAM,OAAA,cAAyC,CAAzC,IAAIH,MAAM,iCAAV,qBAAA;uBAAA;4BAAA;8BAAA;YAAwC;IAClD;IAEA,OAAO;QAAEH;QAAmBE;IAAiB;AAC/C&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3171</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/router-reducer/reducers/has-interception-route-in-current-tree.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { FlightRouterState } from '../../../../server/app-render/types'</span><span class="s3">\n</span><span class="s1">import { isInterceptionRouteAppPath } from '../../../../shared/lib/router/utils/interception-routes'</span><span class="s3">\n\n</span><span class="s1">export function hasInterceptionRouteInCurrentTree([</span><span class="s3">\n  </span><span class="s1">segment,</span><span class="s3">\n  </span><span class="s1">parallelRoutes,</span><span class="s3">\n</span><span class="s1">]: FlightRouterState): boolean {</span><span class="s3">\n  </span><span class="s1">// If we have a dynamic segment, it's marked as an interception route by the presence of the `i` suffix.</span><span class="s3">\n  </span><span class="s1">if (Array.isArray(segment) &amp;&amp; (segment[2] === 'di' || segment[2] === 'ci')) {</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If segment is not an array, apply the existing string-based check</span><span class="s3">\n  </span><span class="s1">if (typeof segment === 'string' &amp;&amp; isInterceptionRouteAppPath(segment)) {</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Iterate through parallelRoutes if they exist</span><span class="s3">\n  </span><span class="s1">if (parallelRoutes) {</span><span class="s3">\n    </span><span class="s1">for (const key in parallelRoutes) {</span><span class="s3">\n      </span><span class="s1">if (hasInterceptionRouteInCurrentTree(parallelRoutes[key])) {</span><span class="s3">\n        </span><span class="s1">return true</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isInterceptionRouteAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;hasInterceptionRouteInCurrentTree&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;parallelRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AACA,SAASA,0BAA0B,QAAQ,0DAAyD;;AAE7F,SAASC,kCAAkC,KAG9B;IAH8B,IAAA,CAChDC,SACAC,eACkB,GAH8B;IAIhD,wGAAwG;IACxG,IAAIC,MAAMC,OAAO,CAACH,YAAaA,CAAAA,OAAO,CAAC,EAAE,KAAK,QAAQA,OAAO,CAAC,EAAE,KAAK,IAAG,GAAI;QAC1E,OAAO;IACT;IAEA,oEAAoE;IACpE,IAAI,OAAOA,YAAY,gBAAYF,+NAAAA,EAA2BE,UAAU;QACtE,OAAO;IACT;IAEA,+CAA+C;IAC/C,IAAIC,gBAAgB;QAClB,IAAK,MAAMG,OAAOH,eAAgB;YAChC,IAAIF,kCAAkCE,cAAc,CAACG,IAAI,GAAG;gBAC1D,OAAO;YACT;QACF;IACF;IAEA,OAAO;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3201</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/bfcache.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { FlightRouterState } from '../../server/app-render/types'</span><span class="s3">\n</span><span class="s1">import { useState } from 'react'</span><span class="s3">\n\n</span><span class="s1">// When the flag is disabled, only track the currently active tree</span><span class="s3">\n</span><span class="s1">const MAX_BF_CACHE_ENTRIES = process.env.__NEXT_ROUTER_BF_CACHE ? 3 : 1</span><span class="s3">\n\n</span><span class="s1">export type RouterBFCacheEntry = {</span><span class="s3">\n  </span><span class="s1">tree: FlightRouterState</span><span class="s3">\n  </span><span class="s1">stateKey: string</span><span class="s3">\n  </span><span class="s1">// The entries form a linked list, sorted in order of most recently active.</span><span class="s3">\n  </span><span class="s1">next: RouterBFCacheEntry | null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Keeps track of the most recent N trees (FlightRouterStates) that were active</span><span class="s3">\n </span><span class="s1">* at a certain segment level. E.g. for a segment </span><span class="s3">\&quot;</span><span class="s1">/a/b/[param]</span><span class="s3">\&quot;</span><span class="s1">, this hook</span><span class="s3">\n </span><span class="s1">* tracks the last N param values that the router rendered for N.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* The result of this hook precisely determines the number and order of</span><span class="s3">\n </span><span class="s1">* trees that are rendered in parallel at their segment level.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* The purpose of this cache is to we can preserve the React and DOM state of</span><span class="s3">\n </span><span class="s1">* some number of inactive trees, by rendering them in an &lt;Activity&gt; boundary.</span><span class="s3">\n </span><span class="s1">* That means it would not make sense for the the lifetime of the cache to be</span><span class="s3">\n </span><span class="s1">* any longer than the lifetime of the React tree; e.g. if the hook were</span><span class="s3">\n </span><span class="s1">* unmounted, then the React tree would be, too. So, we use React state to</span><span class="s3">\n </span><span class="s1">* manage it.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Note that we don't store the RSC data for the cache entries in this hook </span><span class="s3">\n </span><span class="s1">* the data for inactive segments is stored in the parent CacheNode, which</span><span class="s3">\n </span><span class="s1">* *does* have a longer lifetime than the React tree. This hook only determines</span><span class="s3">\n </span><span class="s1">* which of those trees should have their *state* preserved, by &lt;Activity&gt;.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function useRouterBFCache(</span><span class="s3">\n  </span><span class="s1">activeTree: FlightRouterState,</span><span class="s3">\n  </span><span class="s1">activeStateKey: string</span><span class="s3">\n</span><span class="s1">): RouterBFCacheEntry {</span><span class="s3">\n  </span><span class="s1">// The currently active entry. The entries form a linked list, sorted in</span><span class="s3">\n  </span><span class="s1">// order of most recently active. This allows us to reuse parts of the list</span><span class="s3">\n  </span><span class="s1">// without cloning, unless there's a reordering or removal.</span><span class="s3">\n  </span><span class="s1">// TODO: Once we start tracking back/forward history at each route level,</span><span class="s3">\n  </span><span class="s1">// we should use the history order instead. In other words, when traversing</span><span class="s3">\n  </span><span class="s1">// to an existing entry as a result of a popstate event, we should maintain</span><span class="s3">\n  </span><span class="s1">// the existing order instead of moving it to the front of the list. I think</span><span class="s3">\n  </span><span class="s1">// an initial implementation of this could be to pass an incrementing id</span><span class="s3">\n  </span><span class="s1">// to history.pushState/replaceState, then use that here for ordering.</span><span class="s3">\n  </span><span class="s1">const [prevActiveEntry, setPrevActiveEntry] = useState&lt;RouterBFCacheEntry&gt;(</span><span class="s3">\n    </span><span class="s1">() =&gt; {</span><span class="s3">\n      </span><span class="s1">const initialEntry: RouterBFCacheEntry = {</span><span class="s3">\n        </span><span class="s1">tree: activeTree,</span><span class="s3">\n        </span><span class="s1">stateKey: activeStateKey,</span><span class="s3">\n        </span><span class="s1">next: null,</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return initialEntry</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">if (prevActiveEntry.tree === activeTree) {</span><span class="s3">\n    </span><span class="s1">// Fast path. The active tree hasn't changed, so we can reuse the</span><span class="s3">\n    </span><span class="s1">// existing state.</span><span class="s3">\n    </span><span class="s1">return prevActiveEntry</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// The route tree changed. Note that this doesn't mean that the tree changed</span><span class="s3">\n  </span><span class="s1">// *at this level*  the change may be due to a child route. Either way, we</span><span class="s3">\n  </span><span class="s1">// need to either add or update the router tree in the bfcache.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// The rest of the code looks more complicated than it actually is because we</span><span class="s3">\n  </span><span class="s1">// can't mutate the state in place; we have to copy-on-write.</span><span class="s3">\n\n  </span><span class="s1">// Create a new entry for the active cache key. This is the head of the new</span><span class="s3">\n  </span><span class="s1">// linked list.</span><span class="s3">\n  </span><span class="s1">const newActiveEntry: RouterBFCacheEntry = {</span><span class="s3">\n    </span><span class="s1">tree: activeTree,</span><span class="s3">\n    </span><span class="s1">stateKey: activeStateKey,</span><span class="s3">\n    </span><span class="s1">next: null,</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// We need to append the old list onto the new list. If the head of the new</span><span class="s3">\n  </span><span class="s1">// list was already present in the cache, then we'll need to clone everything</span><span class="s3">\n  </span><span class="s1">// that came before it. Then we can reuse the rest.</span><span class="s3">\n  </span><span class="s1">let n = 1</span><span class="s3">\n  </span><span class="s1">let oldEntry: RouterBFCacheEntry | null = prevActiveEntry</span><span class="s3">\n  </span><span class="s1">let clonedEntry: RouterBFCacheEntry = newActiveEntry</span><span class="s3">\n  </span><span class="s1">while (oldEntry !== null &amp;&amp; n &lt; MAX_BF_CACHE_ENTRIES) {</span><span class="s3">\n    </span><span class="s1">if (oldEntry.stateKey === activeStateKey) {</span><span class="s3">\n      </span><span class="s1">// Fast path. This entry in the old list that corresponds to the key that</span><span class="s3">\n      </span><span class="s1">// is now active. We've already placed a clone of this entry at the front</span><span class="s3">\n      </span><span class="s1">// of the new list. We can reuse the rest of the old list without cloning.</span><span class="s3">\n      </span><span class="s1">// NOTE: We don't need to worry about eviction in this case because we</span><span class="s3">\n      </span><span class="s1">// haven't increased the size of the cache, and we assume the max size</span><span class="s3">\n      </span><span class="s1">// is constant across renders. If we were to change it to a dynamic limit,</span><span class="s3">\n      </span><span class="s1">// then the implementation would need to account for that.</span><span class="s3">\n      </span><span class="s1">clonedEntry.next = oldEntry.next</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">// Clone the entry and append it to the list.</span><span class="s3">\n      </span><span class="s1">n++</span><span class="s3">\n      </span><span class="s1">const entry: RouterBFCacheEntry = {</span><span class="s3">\n        </span><span class="s1">tree: oldEntry.tree,</span><span class="s3">\n        </span><span class="s1">stateKey: oldEntry.stateKey,</span><span class="s3">\n        </span><span class="s1">next: null,</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">clonedEntry.next = entry</span><span class="s3">\n      </span><span class="s1">clonedEntry = entry</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">oldEntry = oldEntry.next</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">setPrevActiveEntry(newActiveEntry)</span><span class="s3">\n  </span><span class="s1">return newActiveEntry</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;useState&quot;</span><span class="s0">,</span><span class="s1">&quot;MAX_BF_CACHE_ENTRIES&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_ROUTER_BF_CACHE&quot;</span><span class="s0">,</span><span class="s1">&quot;useRouterBFCache&quot;</span><span class="s0">,</span><span class="s1">&quot;activeTree&quot;</span><span class="s0">,</span><span class="s1">&quot;activeStateKey&quot;</span><span class="s0">,</span><span class="s1">&quot;prevActiveEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;setPrevActiveEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;initialEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;tree&quot;</span><span class="s0">,</span><span class="s1">&quot;stateKey&quot;</span><span class="s0">,</span><span class="s1">&quot;next&quot;</span><span class="s0">,</span><span class="s1">&quot;newActiveEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;n&quot;</span><span class="s0">,</span><span class="s1">&quot;oldEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;clonedEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;entry&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AACA,SAASA,QAAQ,QAAQ,QAAO;;AAEhC,kEAAkE;AAClE,MAAMC,uBAAuBC,QAAQC,GAAG,CAACC,sBAAsB,IAAG,0BAAI;AA6B/D,SAASC,iBACdC,UAA6B,EAC7BC,cAAsB;IAEtB,wEAAwE;IACxE,2EAA2E;IAC3E,2DAA2D;IAC3D,yEAAyE;IACzE,2EAA2E;IAC3E,2EAA2E;IAC3E,4EAA4E;IAC5E,wEAAwE;IACxE,sEAAsE;IACtE,MAAM,CAACC,iBAAiBC,mBAAmB,OAAGT,iNAAAA,EAC5C;QACE,MAAMU,eAAmC;YACvCC,MAAML;YACNM,UAAUL;YACVM,MAAM;QACR;QACA,OAAOH;IACT;IAGF,IAAIF,gBAAgBG,IAAI,KAAKL,YAAY;QACvC,iEAAiE;QACjE,kBAAkB;QAClB,OAAOE;IACT;IAEA,4EAA4E;IAC5E,2EAA2E;IAC3E,+DAA+D;IAC/D,EAAE;IACF,6EAA6E;IAC7E,6DAA6D;IAE7D,2EAA2E;IAC3E,eAAe;IACf,MAAMM,iBAAqC;QACzCH,MAAML;QACNM,UAAUL;QACVM,MAAM;IACR;IAEA,2EAA2E;IAC3E,6EAA6E;IAC7E,mDAAmD;IACnD,IAAIE,IAAI;IACR,IAAIC,WAAsCR;IAC1C,IAAIS,cAAkCH;IACtC,MAAOE,aAAa,QAAQD,IAAId,qBAAsB;QACpD,IAAIe,SAASJ,QAAQ,KAAKL,gBAAgB;YACxC,yEAAyE;YACzE,yEAAyE;YACzE,0EAA0E;YAC1E,sEAAsE;YACtE,sEAAsE;YACtE,0EAA0E;YAC1E,0DAA0D;YAC1DU,YAAYJ,IAAI,GAAGG,SAASH,IAAI;YAChC;QACF,OAAO;YACL,6CAA6C;YAC7CE;YACA,MAAMG,QAA4B;gBAChCP,MAAMK,SAASL,IAAI;gBACnBC,UAAUI,SAASJ,QAAQ;gBAC3BC,MAAM;YACR;YACAI,YAAYJ,IAAI,GAAGK;YACnBD,cAAcC;QAChB;QACAF,WAAWA,SAASH,IAAI;IAC1B;IAEAJ,mBAAmBK;IACnB,OAAOA;AACT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3282</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/next-devtools/userspace/app/segment-explorer-node.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">import type { ReactNode } from 'react'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">useState,</span><span class="s3">\n  </span><span class="s1">createContext,</span><span class="s3">\n  </span><span class="s1">useContext,</span><span class="s3">\n  </span><span class="s1">use,</span><span class="s3">\n  </span><span class="s1">useMemo,</span><span class="s3">\n  </span><span class="s1">useCallback,</span><span class="s3">\n</span><span class="s1">} from 'react'</span><span class="s3">\n</span><span class="s1">import { useLayoutEffect } from 'react'</span><span class="s3">\n</span><span class="s1">import { dispatcher } from 'next/dist/compiled/next-devtools'</span><span class="s3">\n</span><span class="s1">import { notFound } from '../../../client/components/not-found'</span><span class="s3">\n\n</span><span class="s1">export type SegmentBoundaryType =</span><span class="s3">\n  </span><span class="s1">| 'not-found'</span><span class="s3">\n  </span><span class="s1">| 'error'</span><span class="s3">\n  </span><span class="s1">| 'loading'</span><span class="s3">\n  </span><span class="s1">| 'global-error'</span><span class="s3">\n\n</span><span class="s1">export const SEGMENT_EXPLORER_SIMULATED_ERROR_MESSAGE =</span><span class="s3">\n  </span><span class="s1">'NEXT_DEVTOOLS_SIMULATED_ERROR'</span><span class="s3">\n\n</span><span class="s1">export type SegmentNodeState = {</span><span class="s3">\n  </span><span class="s1">type: string</span><span class="s3">\n  </span><span class="s1">pagePath: string</span><span class="s3">\n  </span><span class="s1">boundaryType: string | null</span><span class="s3">\n  </span><span class="s1">setBoundaryType: (type: SegmentBoundaryType | null) =&gt; void</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function SegmentTrieNode({</span><span class="s3">\n  </span><span class="s1">type,</span><span class="s3">\n  </span><span class="s1">pagePath,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">type: string</span><span class="s3">\n  </span><span class="s1">pagePath: string</span><span class="s3">\n</span><span class="s1">}): React.ReactNode {</span><span class="s3">\n  </span><span class="s1">const { boundaryType, setBoundaryType } = useSegmentState()</span><span class="s3">\n  </span><span class="s1">const nodeState: SegmentNodeState = useMemo(() =&gt; {</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">type,</span><span class="s3">\n      </span><span class="s1">pagePath,</span><span class="s3">\n      </span><span class="s1">boundaryType,</span><span class="s3">\n      </span><span class="s1">setBoundaryType,</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}, [type, pagePath, boundaryType, setBoundaryType])</span><span class="s3">\n\n  </span><span class="s1">// Use `useLayoutEffect` to ensure the state is updated during suspense.</span><span class="s3">\n  </span><span class="s1">// `useEffect` won't work as the state is preserved during suspense.</span><span class="s3">\n  </span><span class="s1">useLayoutEffect(() =&gt; {</span><span class="s3">\n    </span><span class="s1">dispatcher.segmentExplorerNodeAdd(nodeState)</span><span class="s3">\n    </span><span class="s1">return () =&gt; {</span><span class="s3">\n      </span><span class="s1">dispatcher.segmentExplorerNodeRemove(nodeState)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}, [nodeState])</span><span class="s3">\n\n  </span><span class="s1">return null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function NotFoundSegmentNode(): React.ReactNode {</span><span class="s3">\n  </span><span class="s1">notFound()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function ErrorSegmentNode(): React.ReactNode {</span><span class="s3">\n  </span><span class="s1">throw new Error(SEGMENT_EXPLORER_SIMULATED_ERROR_MESSAGE)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const forever = new Promise(() =&gt; {})</span><span class="s3">\n</span><span class="s1">function LoadingSegmentNode(): React.ReactNode {</span><span class="s3">\n  </span><span class="s1">use(forever)</span><span class="s3">\n  </span><span class="s1">return null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function SegmentViewStateNode({ page }: { page: string }) {</span><span class="s3">\n  </span><span class="s1">useLayoutEffect(() =&gt; {</span><span class="s3">\n    </span><span class="s1">dispatcher.segmentExplorerUpdateRouteState(page)</span><span class="s3">\n    </span><span class="s1">return () =&gt; {</span><span class="s3">\n      </span><span class="s1">dispatcher.segmentExplorerUpdateRouteState('')</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}, [page])</span><span class="s3">\n  </span><span class="s1">return null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function SegmentBoundaryTriggerNode() {</span><span class="s3">\n  </span><span class="s1">const { boundaryType } = useSegmentState()</span><span class="s3">\n  </span><span class="s1">let segmentNode: React.ReactNode = null</span><span class="s3">\n  </span><span class="s1">if (boundaryType === 'loading') {</span><span class="s3">\n    </span><span class="s1">segmentNode = &lt;LoadingSegmentNode /&gt;</span><span class="s3">\n  </span><span class="s1">} else if (boundaryType === 'not-found') {</span><span class="s3">\n    </span><span class="s1">segmentNode = &lt;NotFoundSegmentNode /&gt;</span><span class="s3">\n  </span><span class="s1">} else if (boundaryType === 'error') {</span><span class="s3">\n    </span><span class="s1">segmentNode = &lt;ErrorSegmentNode /&gt;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return segmentNode</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function SegmentViewNode({</span><span class="s3">\n  </span><span class="s1">type,</span><span class="s3">\n  </span><span class="s1">pagePath,</span><span class="s3">\n  </span><span class="s1">children,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">type: string</span><span class="s3">\n  </span><span class="s1">pagePath: string</span><span class="s3">\n  </span><span class="s1">children?: ReactNode</span><span class="s3">\n</span><span class="s1">}): React.ReactNode {</span><span class="s3">\n  </span><span class="s1">const segmentNode = (</span><span class="s3">\n    </span><span class="s1">&lt;SegmentTrieNode key={type} type={type} pagePath={pagePath} /&gt;</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">&lt;&gt;</span><span class="s3">\n      </span><span class="s1">{segmentNode}</span><span class="s3">\n      </span><span class="s1">{children}</span><span class="s3">\n    </span><span class="s1">&lt;/&gt;</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const SegmentStateContext = createContext&lt;{</span><span class="s3">\n  </span><span class="s1">boundaryType: SegmentBoundaryType | null</span><span class="s3">\n  </span><span class="s1">setBoundaryType: (type: SegmentBoundaryType | null) =&gt; void</span><span class="s3">\n</span><span class="s1">}&gt;({</span><span class="s3">\n  </span><span class="s1">boundaryType: null,</span><span class="s3">\n  </span><span class="s1">setBoundaryType: () =&gt; {},</span><span class="s3">\n</span><span class="s1">})</span><span class="s3">\n\n</span><span class="s1">export function SegmentStateProvider({ children }: { children: ReactNode }) {</span><span class="s3">\n  </span><span class="s1">const [boundaryType, setBoundaryType] = useState&lt;SegmentBoundaryType | null&gt;(</span><span class="s3">\n    </span><span class="s1">null</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">const [errorBoundaryKey, setErrorBoundaryKey] = useState(0)</span><span class="s3">\n  </span><span class="s1">const reloadBoundary = useCallback(</span><span class="s3">\n    </span><span class="s1">() =&gt; setErrorBoundaryKey((prev) =&gt; prev + 1),</span><span class="s3">\n    </span><span class="s1">[]</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">const setBoundaryTypeAndReload = useCallback(</span><span class="s3">\n    </span><span class="s1">(type: SegmentBoundaryType | null) =&gt; {</span><span class="s3">\n      </span><span class="s1">if (type === null) {</span><span class="s3">\n        </span><span class="s1">reloadBoundary()</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">setBoundaryType(type)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">[reloadBoundary]</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">&lt;SegmentStateContext.Provider</span><span class="s3">\n      </span><span class="s1">key={errorBoundaryKey}</span><span class="s3">\n      </span><span class="s1">value={{</span><span class="s3">\n        </span><span class="s1">boundaryType,</span><span class="s3">\n        </span><span class="s1">setBoundaryType: setBoundaryTypeAndReload,</span><span class="s3">\n      </span><span class="s1">}}</span><span class="s3">\n    </span><span class="s1">&gt;</span><span class="s3">\n      </span><span class="s1">{children}</span><span class="s3">\n    </span><span class="s1">&lt;/SegmentStateContext.Provider&gt;</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function useSegmentState() {</span><span class="s3">\n  </span><span class="s1">return useContext(SegmentStateContext)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;useState&quot;</span><span class="s0">,</span><span class="s1">&quot;createContext&quot;</span><span class="s0">,</span><span class="s1">&quot;useContext&quot;</span><span class="s0">,</span><span class="s1">&quot;use&quot;</span><span class="s0">,</span><span class="s1">&quot;useMemo&quot;</span><span class="s0">,</span><span class="s1">&quot;useCallback&quot;</span><span class="s0">,</span><span class="s1">&quot;useLayoutEffect&quot;</span><span class="s0">,</span><span class="s1">&quot;dispatcher&quot;</span><span class="s0">,</span><span class="s1">&quot;notFound&quot;</span><span class="s0">,</span><span class="s1">&quot;SEGMENT_EXPLORER_SIMULATED_ERROR_MESSAGE&quot;</span><span class="s0">,</span><span class="s1">&quot;SegmentTrieNode&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;pagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;boundaryType&quot;</span><span class="s0">,</span><span class="s1">&quot;setBoundaryType&quot;</span><span class="s0">,</span><span class="s1">&quot;useSegmentState&quot;</span><span class="s0">,</span><span class="s1">&quot;nodeState&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentExplorerNodeAdd&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentExplorerNodeRemove&quot;</span><span class="s0">,</span><span class="s1">&quot;NotFoundSegmentNode&quot;</span><span class="s0">,</span><span class="s1">&quot;ErrorSegmentNode&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;forever&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;LoadingSegmentNode&quot;</span><span class="s0">,</span><span class="s1">&quot;SegmentViewStateNode&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentExplorerUpdateRouteState&quot;</span><span class="s0">,</span><span class="s1">&quot;SegmentBoundaryTriggerNode&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentNode&quot;</span><span class="s0">,</span><span class="s1">&quot;SegmentViewNode&quot;</span><span class="s0">,</span><span class="s1">&quot;children&quot;</span><span class="s0">,</span><span class="s1">&quot;SegmentStateContext&quot;</span><span class="s0">,</span><span class="s1">&quot;SegmentStateProvider&quot;</span><span class="s0">,</span><span class="s1">&quot;errorBoundaryKey&quot;</span><span class="s0">,</span><span class="s1">&quot;setErrorBoundaryKey&quot;</span><span class="s0">,</span><span class="s1">&quot;reloadBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;prev&quot;</span><span class="s0">,</span><span class="s1">&quot;setBoundaryTypeAndReload&quot;</span><span class="s0">,</span><span class="s1">&quot;Provider&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3419</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/layout-router.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">CacheNode,</span><span class="s3">\n  </span><span class="s1">LazyCacheNode,</span><span class="s3">\n  </span><span class="s1">LoadingModuleData,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/app-router-context.shared-runtime'</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">FlightRouterState,</span><span class="s3">\n  </span><span class="s1">FlightSegmentPath,</span><span class="s3">\n</span><span class="s1">} from '../../server/app-render/types'</span><span class="s3">\n</span><span class="s1">import type { ErrorComponent } from './error-boundary'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">ACTION_SERVER_PATCH,</span><span class="s3">\n  </span><span class="s1">type FocusAndScrollRef,</span><span class="s3">\n</span><span class="s1">} from './router-reducer/router-reducer-types'</span><span class="s3">\n\n</span><span class="s1">import React, {</span><span class="s3">\n  </span><span class="s1">useContext,</span><span class="s3">\n  </span><span class="s1">use,</span><span class="s3">\n  </span><span class="s1">startTransition,</span><span class="s3">\n  </span><span class="s1">Suspense,</span><span class="s3">\n  </span><span class="s1">useDeferredValue,</span><span class="s3">\n  </span><span class="s1">type JSX,</span><span class="s3">\n</span><span class="s1">} from 'react'</span><span class="s3">\n</span><span class="s1">import ReactDOM from 'react-dom'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">LayoutRouterContext,</span><span class="s3">\n  </span><span class="s1">GlobalLayoutRouterContext,</span><span class="s3">\n  </span><span class="s1">TemplateContext,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/app-router-context.shared-runtime'</span><span class="s3">\n</span><span class="s1">import { fetchServerResponse } from './router-reducer/fetch-server-response'</span><span class="s3">\n</span><span class="s1">import { unresolvedThenable } from './unresolved-thenable'</span><span class="s3">\n</span><span class="s1">import { ErrorBoundary } from './error-boundary'</span><span class="s3">\n</span><span class="s1">import { matchSegment } from './match-segments'</span><span class="s3">\n</span><span class="s1">import { disableSmoothScrollDuringRouteTransition } from '../../shared/lib/router/utils/disable-smooth-scroll'</span><span class="s3">\n</span><span class="s1">import { RedirectBoundary } from './redirect-boundary'</span><span class="s3">\n</span><span class="s1">import { HTTPAccessFallbackBoundary } from './http-access-fallback/error-boundary'</span><span class="s3">\n</span><span class="s1">import { createRouterCacheKey } from './router-reducer/create-router-cache-key'</span><span class="s3">\n</span><span class="s1">import { hasInterceptionRouteInCurrentTree } from './router-reducer/reducers/has-interception-route-in-current-tree'</span><span class="s3">\n</span><span class="s1">import { dispatchAppRouterAction } from './use-action-queue'</span><span class="s3">\n</span><span class="s1">import { useRouterBFCache, type RouterBFCacheEntry } from './bfcache'</span><span class="s3">\n</span><span class="s1">import { normalizeAppPath } from '../../shared/lib/router/utils/app-paths'</span><span class="s3">\n\n</span><span class="s1">const Activity = process.env.__NEXT_ROUTER_BF_CACHE</span><span class="s3">\n  </span><span class="s1">? (require('react') as typeof import('react')).unstable_Activity</span><span class="s3">\n  </span><span class="s1">: null!</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Add refetch marker to router state at the point of the current layout segment.</span><span class="s3">\n </span><span class="s1">* This ensures the response returned is not further down than the current layout segment.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function walkAddRefetch(</span><span class="s3">\n  </span><span class="s1">segmentPathToWalk: FlightSegmentPath | undefined,</span><span class="s3">\n  </span><span class="s1">treeToRecreate: FlightRouterState</span><span class="s3">\n</span><span class="s1">): FlightRouterState {</span><span class="s3">\n  </span><span class="s1">if (segmentPathToWalk) {</span><span class="s3">\n    </span><span class="s1">const [segment, parallelRouteKey] = segmentPathToWalk</span><span class="s3">\n    </span><span class="s1">const isLast = segmentPathToWalk.length === 2</span><span class="s3">\n\n    </span><span class="s1">if (matchSegment(treeToRecreate[0], segment)) {</span><span class="s3">\n      </span><span class="s1">if (treeToRecreate[1].hasOwnProperty(parallelRouteKey)) {</span><span class="s3">\n        </span><span class="s1">if (isLast) {</span><span class="s3">\n          </span><span class="s1">const subTree = walkAddRefetch(</span><span class="s3">\n            </span><span class="s1">undefined,</span><span class="s3">\n            </span><span class="s1">treeToRecreate[1][parallelRouteKey]</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">return [</span><span class="s3">\n            </span><span class="s1">treeToRecreate[0],</span><span class="s3">\n            </span><span class="s1">{</span><span class="s3">\n              </span><span class="s1">...treeToRecreate[1],</span><span class="s3">\n              </span><span class="s1">[parallelRouteKey]: [</span><span class="s3">\n                </span><span class="s1">subTree[0],</span><span class="s3">\n                </span><span class="s1">subTree[1],</span><span class="s3">\n                </span><span class="s1">subTree[2],</span><span class="s3">\n                </span><span class="s1">'refetch',</span><span class="s3">\n              </span><span class="s1">],</span><span class="s3">\n            </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">]</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">return [</span><span class="s3">\n          </span><span class="s1">treeToRecreate[0],</span><span class="s3">\n          </span><span class="s1">{</span><span class="s3">\n            </span><span class="s1">...treeToRecreate[1],</span><span class="s3">\n            </span><span class="s1">[parallelRouteKey]: walkAddRefetch(</span><span class="s3">\n              </span><span class="s1">segmentPathToWalk.slice(2),</span><span class="s3">\n              </span><span class="s1">treeToRecreate[1][parallelRouteKey]</span><span class="s3">\n            </span><span class="s1">),</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">]</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return treeToRecreate</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const __DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE = (</span><span class="s3">\n  </span><span class="s1">ReactDOM as any</span><span class="s3">\n</span><span class="s1">).__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE</span><span class="s3">\n\n</span><span class="s1">// TODO-APP: Replace with new React API for finding dom nodes without a `ref` when available</span><span class="s3">\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Wraps ReactDOM.findDOMNode with additional logic to hide React Strict Mode warning</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function findDOMNode(</span><span class="s3">\n  </span><span class="s1">instance: React.ReactInstance | null | undefined</span><span class="s3">\n</span><span class="s1">): Element | Text | null {</span><span class="s3">\n  </span><span class="s1">// Tree-shake for server bundle</span><span class="s3">\n  </span><span class="s1">if (typeof window === 'undefined') return null</span><span class="s3">\n\n  </span><span class="s1">// __DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE.findDOMNode is null during module init.</span><span class="s3">\n  </span><span class="s1">// We need to lazily reference it.</span><span class="s3">\n  </span><span class="s1">const internal_reactDOMfindDOMNode =</span><span class="s3">\n    </span><span class="s1">__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE.findDOMNode</span><span class="s3">\n  </span><span class="s1">return internal_reactDOMfindDOMNode(instance)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const rectProperties = [</span><span class="s3">\n  </span><span class="s1">'bottom',</span><span class="s3">\n  </span><span class="s1">'height',</span><span class="s3">\n  </span><span class="s1">'left',</span><span class="s3">\n  </span><span class="s1">'right',</span><span class="s3">\n  </span><span class="s1">'top',</span><span class="s3">\n  </span><span class="s1">'width',</span><span class="s3">\n  </span><span class="s1">'x',</span><span class="s3">\n  </span><span class="s1">'y',</span><span class="s3">\n</span><span class="s1">] as const</span><span class="s3">\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Check if a HTMLElement is hidden or fixed/sticky position</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function shouldSkipElement(element: HTMLElement) {</span><span class="s3">\n  </span><span class="s1">// we ignore fixed or sticky positioned elements since they'll likely pass the </span><span class="s3">\&quot;</span><span class="s1">in-viewport</span><span class="s3">\&quot; </span><span class="s1">check</span><span class="s3">\n  </span><span class="s1">// and will result in a situation we bail on scroll because of something like a fixed nav,</span><span class="s3">\n  </span><span class="s1">// even though the actual page content is offscreen</span><span class="s3">\n  </span><span class="s1">if (['sticky', 'fixed'].includes(getComputedStyle(element).position)) {</span><span class="s3">\n    </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n      </span><span class="s1">console.warn(</span><span class="s3">\n        </span><span class="s1">'Skipping auto-scroll behavior due to `position: sticky` or `position: fixed` on element:',</span><span class="s3">\n        </span><span class="s1">element</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return true</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Uses `getBoundingClientRect` to check if the element is hidden instead of `offsetParent`</span><span class="s3">\n  </span><span class="s1">// because `offsetParent` doesn't consider document/body</span><span class="s3">\n  </span><span class="s1">const rect = element.getBoundingClientRect()</span><span class="s3">\n  </span><span class="s1">return rectProperties.every((item) =&gt; rect[item] === 0)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Check if the top corner of the HTMLElement is in the viewport.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function topOfElementInViewport(element: HTMLElement, viewportHeight: number) {</span><span class="s3">\n  </span><span class="s1">const rect = element.getBoundingClientRect()</span><span class="s3">\n  </span><span class="s1">return rect.top &gt;= 0 &amp;&amp; rect.top &lt;= viewportHeight</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Find the DOM node for a hash fragment.</span><span class="s3">\n </span><span class="s1">* If `top` the page has to scroll to the top of the page. This mirrors the browser's behavior.</span><span class="s3">\n </span><span class="s1">* If the hash fragment is an id, the page has to scroll to the element with that id.</span><span class="s3">\n </span><span class="s1">* If the hash fragment is a name, the page has to scroll to the first element with that name.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function getHashFragmentDomNode(hashFragment: string) {</span><span class="s3">\n  </span><span class="s1">// If the hash fragment is `top` the page has to scroll to the top of the page.</span><span class="s3">\n  </span><span class="s1">if (hashFragment === 'top') {</span><span class="s3">\n    </span><span class="s1">return document.body</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If the hash fragment is an id, the page has to scroll to the element with that id.</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">document.getElementById(hashFragment) ??</span><span class="s3">\n    </span><span class="s1">// If the hash fragment is a name, the page has to scroll to the first element with that name.</span><span class="s3">\n    </span><span class="s1">document.getElementsByName(hashFragment)[0]</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">interface ScrollAndFocusHandlerProps {</span><span class="s3">\n  </span><span class="s1">focusAndScrollRef: FocusAndScrollRef</span><span class="s3">\n  </span><span class="s1">children: React.ReactNode</span><span class="s3">\n  </span><span class="s1">segmentPath: FlightSegmentPath</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">class InnerScrollAndFocusHandler extends React.Component&lt;ScrollAndFocusHandlerProps&gt; {</span><span class="s3">\n  </span><span class="s1">handlePotentialScroll = () =&gt; {</span><span class="s3">\n    </span><span class="s1">// Handle scroll and focus, it's only applied once in the first useEffect that triggers that changed.</span><span class="s3">\n    </span><span class="s1">const { focusAndScrollRef, segmentPath } = this.props</span><span class="s3">\n\n    </span><span class="s1">if (focusAndScrollRef.apply) {</span><span class="s3">\n      </span><span class="s1">// segmentPaths is an array of segment paths that should be scrolled to</span><span class="s3">\n      </span><span class="s1">// if the current segment path is not in the array, the scroll is not applied</span><span class="s3">\n      </span><span class="s1">// unless the array is empty, in which case the scroll is always applied</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">focusAndScrollRef.segmentPaths.length !== 0 &amp;&amp;</span><span class="s3">\n        </span><span class="s1">!focusAndScrollRef.segmentPaths.some((scrollRefSegmentPath) =&gt;</span><span class="s3">\n          </span><span class="s1">segmentPath.every((segment, index) =&gt;</span><span class="s3">\n            </span><span class="s1">matchSegment(segment, scrollRefSegmentPath[index])</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">let domNode:</span><span class="s3">\n        </span><span class="s1">| ReturnType&lt;typeof getHashFragmentDomNode&gt;</span><span class="s3">\n        </span><span class="s1">| ReturnType&lt;typeof findDOMNode&gt; = null</span><span class="s3">\n      </span><span class="s1">const hashFragment = focusAndScrollRef.hashFragment</span><span class="s3">\n\n      </span><span class="s1">if (hashFragment) {</span><span class="s3">\n        </span><span class="s1">domNode = getHashFragmentDomNode(hashFragment)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// `findDOMNode` is tricky because it returns just the first child if the component is a fragment.</span><span class="s3">\n      </span><span class="s1">// This already caused a bug where the first child was a &lt;link/&gt; in head.</span><span class="s3">\n      </span><span class="s1">if (!domNode) {</span><span class="s3">\n        </span><span class="s1">domNode = findDOMNode(this)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// If there is no DOM node this layout-router level is skipped. It'll be handled higher-up in the tree.</span><span class="s3">\n      </span><span class="s1">if (!(domNode instanceof Element)) {</span><span class="s3">\n        </span><span class="s1">return</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Verify if the element is a HTMLElement and if we want to consider it for scroll behavior.</span><span class="s3">\n      </span><span class="s1">// If the element is skipped, try to select the next sibling and try again.</span><span class="s3">\n      </span><span class="s1">while (!(domNode instanceof HTMLElement) || shouldSkipElement(domNode)) {</span><span class="s3">\n        </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n          </span><span class="s1">if (domNode.parentElement?.localName === 'head') {</span><span class="s3">\n            </span><span class="s1">// TODO: We enter this state when metadata was rendered as part of the page or via Next.js.</span><span class="s3">\n            </span><span class="s1">// This is always a bug in Next.js and caused by React hoisting metadata.</span><span class="s3">\n            </span><span class="s1">// We need to replace `findDOMNode` in favor of Fragment Refs (when available) so that we can skip over metadata.</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">// No siblings found that match the criteria are found, so handle scroll higher up in the tree instead.</span><span class="s3">\n        </span><span class="s1">if (domNode.nextElementSibling === null) {</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">domNode = domNode.nextElementSibling</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// State is mutated to ensure that the focus and scroll is applied only once.</span><span class="s3">\n      </span><span class="s1">focusAndScrollRef.apply = false</span><span class="s3">\n      </span><span class="s1">focusAndScrollRef.hashFragment = null</span><span class="s3">\n      </span><span class="s1">focusAndScrollRef.segmentPaths = []</span><span class="s3">\n\n      </span><span class="s1">disableSmoothScrollDuringRouteTransition(</span><span class="s3">\n        </span><span class="s1">() =&gt; {</span><span class="s3">\n          </span><span class="s1">// In case of hash scroll, we only need to scroll the element into view</span><span class="s3">\n          </span><span class="s1">if (hashFragment) {</span><span class="s3">\n            </span><span class="s1">;(domNode as HTMLElement).scrollIntoView()</span><span class="s3">\n\n            </span><span class="s1">return</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">// Store the current viewport height because reading `clientHeight` causes a reflow,</span><span class="s3">\n          </span><span class="s1">// and it won't change during this function.</span><span class="s3">\n          </span><span class="s1">const htmlElement = document.documentElement</span><span class="s3">\n          </span><span class="s1">const viewportHeight = htmlElement.clientHeight</span><span class="s3">\n\n          </span><span class="s1">// If the element's top edge is already in the viewport, exit early.</span><span class="s3">\n          </span><span class="s1">if (topOfElementInViewport(domNode as HTMLElement, viewportHeight)) {</span><span class="s3">\n            </span><span class="s1">return</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">// Otherwise, try scrolling go the top of the document to be backward compatible with pages</span><span class="s3">\n          </span><span class="s1">// scrollIntoView() called on `&lt;html/&gt;` element scrolls horizontally on chrome and firefox (that shouldn't happen)</span><span class="s3">\n          </span><span class="s1">// We could use it to scroll horizontally following RTL but that also seems to be broken - it will always scroll left</span><span class="s3">\n          </span><span class="s1">// scrollLeft = 0 also seems to ignore RTL and manually checking for RTL is too much hassle so we will scroll just vertically</span><span class="s3">\n          </span><span class="s1">htmlElement.scrollTop = 0</span><span class="s3">\n\n          </span><span class="s1">// Scroll to domNode if domNode is not in viewport when scrolled to top of document</span><span class="s3">\n          </span><span class="s1">if (!topOfElementInViewport(domNode as HTMLElement, viewportHeight)) {</span><span class="s3">\n            </span><span class="s1">// Scroll into view doesn't scroll horizontally by default when not needed</span><span class="s3">\n            </span><span class="s1">;(domNode as HTMLElement).scrollIntoView()</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">// We will force layout by querying domNode position</span><span class="s3">\n          </span><span class="s1">dontForceLayout: true,</span><span class="s3">\n          </span><span class="s1">onlyHashChange: focusAndScrollRef.onlyHashChange,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n\n      </span><span class="s1">// Mutate after scrolling so that it can be read by `disableSmoothScrollDuringRouteTransition`</span><span class="s3">\n      </span><span class="s1">focusAndScrollRef.onlyHashChange = false</span><span class="s3">\n\n      </span><span class="s1">// Set focus on the element</span><span class="s3">\n      </span><span class="s1">domNode.focus()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">componentDidMount() {</span><span class="s3">\n    </span><span class="s1">this.handlePotentialScroll()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">componentDidUpdate() {</span><span class="s3">\n    </span><span class="s1">// Because this property is overwritten in handlePotentialScroll it's fine to always run it when true as it'll be set to false for subsequent renders.</span><span class="s3">\n    </span><span class="s1">if (this.props.focusAndScrollRef.apply) {</span><span class="s3">\n      </span><span class="s1">this.handlePotentialScroll()</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">render() {</span><span class="s3">\n    </span><span class="s1">return this.props.children</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function ScrollAndFocusHandler({</span><span class="s3">\n  </span><span class="s1">segmentPath,</span><span class="s3">\n  </span><span class="s1">children,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">segmentPath: FlightSegmentPath</span><span class="s3">\n  </span><span class="s1">children: React.ReactNode</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">const context = useContext(GlobalLayoutRouterContext)</span><span class="s3">\n  </span><span class="s1">if (!context) {</span><span class="s3">\n    </span><span class="s1">throw new Error('invariant global layout router not mounted')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">&lt;InnerScrollAndFocusHandler</span><span class="s3">\n      </span><span class="s1">segmentPath={segmentPath}</span><span class="s3">\n      </span><span class="s1">focusAndScrollRef={context.focusAndScrollRef}</span><span class="s3">\n    </span><span class="s1">&gt;</span><span class="s3">\n      </span><span class="s1">{children}</span><span class="s3">\n    </span><span class="s1">&lt;/InnerScrollAndFocusHandler&gt;</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* InnerLayoutRouter handles rendering the provided segment based on the cache.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function InnerLayoutRouter({</span><span class="s3">\n  </span><span class="s1">tree,</span><span class="s3">\n  </span><span class="s1">segmentPath,</span><span class="s3">\n  </span><span class="s1">cacheNode,</span><span class="s3">\n  </span><span class="s1">url,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">tree: FlightRouterState</span><span class="s3">\n  </span><span class="s1">segmentPath: FlightSegmentPath</span><span class="s3">\n  </span><span class="s1">cacheNode: CacheNode</span><span class="s3">\n  </span><span class="s1">url: string</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">const context = useContext(GlobalLayoutRouterContext)</span><span class="s3">\n  </span><span class="s1">if (!context) {</span><span class="s3">\n    </span><span class="s1">throw new Error('invariant global layout router not mounted')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { tree: fullTree } = context</span><span class="s3">\n\n  </span><span class="s1">// `rsc` represents the renderable node for this segment.</span><span class="s3">\n\n  </span><span class="s1">// If this segment has a `prefetchRsc`, it's the statically prefetched data.</span><span class="s3">\n  </span><span class="s1">// We should use that on initial render instead of `rsc`. Then we'll switch</span><span class="s3">\n  </span><span class="s1">// to `rsc` when the dynamic response streams in.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// If no prefetch data is available, then we go straight to rendering `rsc`.</span><span class="s3">\n  </span><span class="s1">const resolvedPrefetchRsc =</span><span class="s3">\n    </span><span class="s1">cacheNode.prefetchRsc !== null ? cacheNode.prefetchRsc : cacheNode.rsc</span><span class="s3">\n\n  </span><span class="s1">// We use `useDeferredValue` to handle switching between the prefetched and</span><span class="s3">\n  </span><span class="s1">// final values. The second argument is returned on initial render, then it</span><span class="s3">\n  </span><span class="s1">// re-renders with the first argument.</span><span class="s3">\n  </span><span class="s1">const rsc: any = useDeferredValue(cacheNode.rsc, resolvedPrefetchRsc)</span><span class="s3">\n\n  </span><span class="s1">// `rsc` is either a React node or a promise for a React node, except we</span><span class="s3">\n  </span><span class="s1">// special case `null` to represent that this segment's data is missing. If</span><span class="s3">\n  </span><span class="s1">// it's a promise, we need to unwrap it so we can determine whether or not the</span><span class="s3">\n  </span><span class="s1">// data is missing.</span><span class="s3">\n  </span><span class="s1">const resolvedRsc: React.ReactNode =</span><span class="s3">\n    </span><span class="s1">typeof rsc === 'object' &amp;&amp; rsc !== null &amp;&amp; typeof rsc.then === 'function'</span><span class="s3">\n      </span><span class="s1">? use(rsc)</span><span class="s3">\n      </span><span class="s1">: rsc</span><span class="s3">\n\n  </span><span class="s1">if (!resolvedRsc) {</span><span class="s3">\n    </span><span class="s1">// The data for this segment is not available, and there's no pending</span><span class="s3">\n    </span><span class="s1">// navigation that will be able to fulfill it. We need to fetch more from</span><span class="s3">\n    </span><span class="s1">// the server and patch the cache.</span><span class="s3">\n\n    </span><span class="s1">// Check if there's already a pending request.</span><span class="s3">\n    </span><span class="s1">let lazyData = cacheNode.lazyData</span><span class="s3">\n    </span><span class="s1">if (lazyData === null) {</span><span class="s3">\n      </span><span class="s1">/**</span><span class="s3">\n       </span><span class="s1">* Router state with refetch marker added</span><span class="s3">\n       </span><span class="s1">*/</span><span class="s3">\n      </span><span class="s1">// TODO-APP: remove ''</span><span class="s3">\n      </span><span class="s1">const refetchTree = walkAddRefetch(['', ...segmentPath], fullTree)</span><span class="s3">\n      </span><span class="s1">const includeNextUrl = hasInterceptionRouteInCurrentTree(fullTree)</span><span class="s3">\n      </span><span class="s1">const navigatedAt = Date.now()</span><span class="s3">\n      </span><span class="s1">cacheNode.lazyData = lazyData = fetchServerResponse(</span><span class="s3">\n        </span><span class="s1">new URL(url, location.origin),</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">flightRouterState: refetchTree,</span><span class="s3">\n          </span><span class="s1">nextUrl: includeNextUrl ? context.nextUrl : null,</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">).then((serverResponse) =&gt; {</span><span class="s3">\n        </span><span class="s1">startTransition(() =&gt; {</span><span class="s3">\n          </span><span class="s1">dispatchAppRouterAction({</span><span class="s3">\n            </span><span class="s1">type: ACTION_SERVER_PATCH,</span><span class="s3">\n            </span><span class="s1">previousTree: fullTree,</span><span class="s3">\n            </span><span class="s1">serverResponse,</span><span class="s3">\n            </span><span class="s1">navigatedAt,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n\n        </span><span class="s1">return serverResponse</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n\n      </span><span class="s1">// Suspend while waiting for lazyData to resolve</span><span class="s3">\n      </span><span class="s1">use(lazyData)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">// Suspend infinitely as `changeByServerResponse` will cause a different part of the tree to be rendered.</span><span class="s3">\n    </span><span class="s1">// A falsey `resolvedRsc` indicates missing data -- we should not commit that branch, and we need to wait for the data to arrive.</span><span class="s3">\n    </span><span class="s1">use(unresolvedThenable) as never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// If we get to this point, then we know we have something we can render.</span><span class="s3">\n  </span><span class="s1">const subtree = (</span><span class="s3">\n    </span><span class="s1">// The layout router context narrows down tree and childNodes at each level.</span><span class="s3">\n    </span><span class="s1">&lt;LayoutRouterContext.Provider</span><span class="s3">\n      </span><span class="s1">value={{</span><span class="s3">\n        </span><span class="s1">parentTree: tree,</span><span class="s3">\n        </span><span class="s1">parentCacheNode: cacheNode,</span><span class="s3">\n        </span><span class="s1">parentSegmentPath: segmentPath,</span><span class="s3">\n\n        </span><span class="s1">// TODO-APP: overriding of url for parallel routes</span><span class="s3">\n        </span><span class="s1">url: url,</span><span class="s3">\n      </span><span class="s1">}}</span><span class="s3">\n    </span><span class="s1">&gt;</span><span class="s3">\n      </span><span class="s1">{resolvedRsc}</span><span class="s3">\n    </span><span class="s1">&lt;/LayoutRouterContext.Provider&gt;</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">// Ensure root layout is not wrapped in a div as the root layout renders `&lt;html&gt;`</span><span class="s3">\n  </span><span class="s1">return subtree</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Renders suspense boundary with the provided </span><span class="s3">\&quot;</span><span class="s1">loading</span><span class="s3">\&quot; </span><span class="s1">property as the fallback.</span><span class="s3">\n </span><span class="s1">* If no loading property is provided it renders the children without a suspense boundary.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function LoadingBoundary({</span><span class="s3">\n  </span><span class="s1">loading,</span><span class="s3">\n  </span><span class="s1">children,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">loading: LoadingModuleData | Promise&lt;LoadingModuleData&gt;</span><span class="s3">\n  </span><span class="s1">children: React.ReactNode</span><span class="s3">\n</span><span class="s1">}): JSX.Element {</span><span class="s3">\n  </span><span class="s1">// If loading is a promise, unwrap it. This happens in cases where we haven't</span><span class="s3">\n  </span><span class="s1">// yet received the loading data from the server  which includes whether or</span><span class="s3">\n  </span><span class="s1">// not this layout has a loading component at all.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// It's OK to suspend here instead of inside the fallback because this</span><span class="s3">\n  </span><span class="s1">// promise will resolve simultaneously with the data for the segment itself.</span><span class="s3">\n  </span><span class="s1">// So it will never suspend for longer than it would have if we didn't use</span><span class="s3">\n  </span><span class="s1">// a Suspense fallback at all.</span><span class="s3">\n  </span><span class="s1">let loadingModuleData</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">typeof loading === 'object' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">loading !== null &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof (loading as any).then === 'function'</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">const promiseForLoading = loading as Promise&lt;LoadingModuleData&gt;</span><span class="s3">\n    </span><span class="s1">loadingModuleData = use(promiseForLoading)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">loadingModuleData = loading as LoadingModuleData</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (loadingModuleData) {</span><span class="s3">\n    </span><span class="s1">const loadingRsc = loadingModuleData[0]</span><span class="s3">\n    </span><span class="s1">const loadingStyles = loadingModuleData[1]</span><span class="s3">\n    </span><span class="s1">const loadingScripts = loadingModuleData[2]</span><span class="s3">\n    </span><span class="s1">return (</span><span class="s3">\n      </span><span class="s1">&lt;Suspense</span><span class="s3">\n        </span><span class="s1">fallback={</span><span class="s3">\n          </span><span class="s1">&lt;&gt;</span><span class="s3">\n            </span><span class="s1">{loadingStyles}</span><span class="s3">\n            </span><span class="s1">{loadingScripts}</span><span class="s3">\n            </span><span class="s1">{loadingRsc}</span><span class="s3">\n          </span><span class="s1">&lt;/&gt;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">&gt;</span><span class="s3">\n        </span><span class="s1">{children}</span><span class="s3">\n      </span><span class="s1">&lt;/Suspense&gt;</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return &lt;&gt;{children}&lt;/&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* OuterLayoutRouter handles the current segment as well as &lt;Offscreen&gt; rendering of other segments.</span><span class="s3">\n </span><span class="s1">* It can be rendered next to each other with a different `parallelRouterKey`, allowing for Parallel routes.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export default function OuterLayoutRouter({</span><span class="s3">\n  </span><span class="s1">parallelRouterKey,</span><span class="s3">\n  </span><span class="s1">error,</span><span class="s3">\n  </span><span class="s1">errorStyles,</span><span class="s3">\n  </span><span class="s1">errorScripts,</span><span class="s3">\n  </span><span class="s1">templateStyles,</span><span class="s3">\n  </span><span class="s1">templateScripts,</span><span class="s3">\n  </span><span class="s1">template,</span><span class="s3">\n  </span><span class="s1">notFound,</span><span class="s3">\n  </span><span class="s1">forbidden,</span><span class="s3">\n  </span><span class="s1">unauthorized,</span><span class="s3">\n  </span><span class="s1">segmentViewBoundaries,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">parallelRouterKey: string</span><span class="s3">\n  </span><span class="s1">error: ErrorComponent | undefined</span><span class="s3">\n  </span><span class="s1">errorStyles: React.ReactNode | undefined</span><span class="s3">\n  </span><span class="s1">errorScripts: React.ReactNode | undefined</span><span class="s3">\n  </span><span class="s1">templateStyles: React.ReactNode | undefined</span><span class="s3">\n  </span><span class="s1">templateScripts: React.ReactNode | undefined</span><span class="s3">\n  </span><span class="s1">template: React.ReactNode</span><span class="s3">\n  </span><span class="s1">notFound: React.ReactNode | undefined</span><span class="s3">\n  </span><span class="s1">forbidden: React.ReactNode | undefined</span><span class="s3">\n  </span><span class="s1">unauthorized: React.ReactNode | undefined</span><span class="s3">\n  </span><span class="s1">segmentViewBoundaries?: React.ReactNode</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">const context = useContext(LayoutRouterContext)</span><span class="s3">\n  </span><span class="s1">if (!context) {</span><span class="s3">\n    </span><span class="s1">throw new Error('invariant expected layout router to be mounted')</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const { parentTree, parentCacheNode, parentSegmentPath, url } = context</span><span class="s3">\n\n  </span><span class="s1">// Get the CacheNode for this segment by reading it from the parent segment's</span><span class="s3">\n  </span><span class="s1">// child map.</span><span class="s3">\n  </span><span class="s1">const parentParallelRoutes = parentCacheNode.parallelRoutes</span><span class="s3">\n  </span><span class="s1">let segmentMap = parentParallelRoutes.get(parallelRouterKey)</span><span class="s3">\n  </span><span class="s1">// If the parallel router cache node does not exist yet, create it.</span><span class="s3">\n  </span><span class="s1">// This writes to the cache when there is no item in the cache yet. It never *overwrites* existing cache items which is why it's safe in concurrent mode.</span><span class="s3">\n  </span><span class="s1">if (!segmentMap) {</span><span class="s3">\n    </span><span class="s1">segmentMap = new Map()</span><span class="s3">\n    </span><span class="s1">parentParallelRoutes.set(parallelRouterKey, segmentMap)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const parentTreeSegment = parentTree[0]</span><span class="s3">\n  </span><span class="s1">const segmentPath =</span><span class="s3">\n    </span><span class="s1">parentSegmentPath === null</span><span class="s3">\n      </span><span class="s1">? // TODO: The root segment value is currently omitted from the segment</span><span class="s3">\n        </span><span class="s1">// path. This has led to a bunch of special cases scattered throughout</span><span class="s3">\n        </span><span class="s1">// the code. We should clean this up.</span><span class="s3">\n        </span><span class="s1">[parallelRouterKey]</span><span class="s3">\n      </span><span class="s1">: parentSegmentPath.concat([parentTreeSegment, parallelRouterKey])</span><span class="s3">\n\n  </span><span class="s1">// The </span><span class="s3">\&quot;</span><span class="s1">state</span><span class="s3">\&quot; </span><span class="s1">key of a segment is the one passed to React  it represents the</span><span class="s3">\n  </span><span class="s1">// identity of the UI tree. Whenever the state key changes, the tree is</span><span class="s3">\n  </span><span class="s1">// recreated and the state is reset. In the App Router model, search params do</span><span class="s3">\n  </span><span class="s1">// not cause state to be lost, so two segments with the same segment path but</span><span class="s3">\n  </span><span class="s1">// different search params should have the same state key.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// The </span><span class="s3">\&quot;</span><span class="s1">cache</span><span class="s3">\&quot; </span><span class="s1">key of a segment, however, *does* include the search params, if</span><span class="s3">\n  </span><span class="s1">// it's possible that the segment accessed the search params on the server.</span><span class="s3">\n  </span><span class="s1">// (This only applies to page segments; layout segments cannot access search</span><span class="s3">\n  </span><span class="s1">// params on the server.)</span><span class="s3">\n  </span><span class="s1">const activeTree = parentTree[1][parallelRouterKey]</span><span class="s3">\n  </span><span class="s1">const activeSegment = activeTree[0]</span><span class="s3">\n  </span><span class="s1">const activeStateKey = createRouterCacheKey(activeSegment, true) // no search params</span><span class="s3">\n\n  </span><span class="s1">// At each level of the route tree, not only do we render the currently</span><span class="s3">\n  </span><span class="s1">// active segment  we also render the last N segments that were active at</span><span class="s3">\n  </span><span class="s1">// this level inside a hidden &lt;Activity&gt; boundary, to preserve their state</span><span class="s3">\n  </span><span class="s1">// if or when the user navigates to them again.</span><span class="s3">\n  </span><span class="s1">//</span><span class="s3">\n  </span><span class="s1">// bfcacheEntry is a linked list of FlightRouterStates.</span><span class="s3">\n  </span><span class="s1">let bfcacheEntry: RouterBFCacheEntry | null = useRouterBFCache(</span><span class="s3">\n    </span><span class="s1">activeTree,</span><span class="s3">\n    </span><span class="s1">activeStateKey</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">let children: Array&lt;React.ReactNode&gt; = []</span><span class="s3">\n  </span><span class="s1">do {</span><span class="s3">\n    </span><span class="s1">const tree = bfcacheEntry.tree</span><span class="s3">\n    </span><span class="s1">const stateKey = bfcacheEntry.stateKey</span><span class="s3">\n    </span><span class="s1">const segment = tree[0]</span><span class="s3">\n    </span><span class="s1">const cacheKey = createRouterCacheKey(segment)</span><span class="s3">\n\n    </span><span class="s1">// Read segment path from the parallel router cache node.</span><span class="s3">\n    </span><span class="s1">let cacheNode = segmentMap.get(cacheKey)</span><span class="s3">\n    </span><span class="s1">if (cacheNode === undefined) {</span><span class="s3">\n      </span><span class="s1">// When data is not available during rendering client-side we need to fetch</span><span class="s3">\n      </span><span class="s1">// it from the server.</span><span class="s3">\n      </span><span class="s1">const newLazyCacheNode: LazyCacheNode = {</span><span class="s3">\n        </span><span class="s1">lazyData: null,</span><span class="s3">\n        </span><span class="s1">rsc: null,</span><span class="s3">\n        </span><span class="s1">prefetchRsc: null,</span><span class="s3">\n        </span><span class="s1">head: null,</span><span class="s3">\n        </span><span class="s1">prefetchHead: null,</span><span class="s3">\n        </span><span class="s1">parallelRoutes: new Map(),</span><span class="s3">\n        </span><span class="s1">loading: null,</span><span class="s3">\n        </span><span class="s1">navigatedAt: -1,</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">// Flight data fetch kicked off during render and put into the cache.</span><span class="s3">\n      </span><span class="s1">cacheNode = newLazyCacheNode</span><span class="s3">\n      </span><span class="s1">segmentMap.set(cacheKey, newLazyCacheNode)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">/*</span><span class="s3">\n    </span><span class="s1">- Error boundary</span><span class="s3">\n      </span><span class="s1">- Only renders error boundary if error component is provided.</span><span class="s3">\n      </span><span class="s1">- Rendered for each segment to ensure they have their own error state.</span><span class="s3">\n      </span><span class="s1">- When gracefully degrade for bots, skip rendering error boundary.</span><span class="s3">\n    </span><span class="s1">- Loading boundary</span><span class="s3">\n      </span><span class="s1">- Only renders suspense boundary if loading components is provided.</span><span class="s3">\n      </span><span class="s1">- Rendered for each segment to ensure they have their own loading state.</span><span class="s3">\n      </span><span class="s1">- Passed to the router during rendering to ensure it can be immediately rendered when suspending on a Flight fetch.</span><span class="s3">\n  </span><span class="s1">*/</span><span class="s3">\n\n    </span><span class="s1">let segmentBoundaryTriggerNode: React.ReactNode = null</span><span class="s3">\n    </span><span class="s1">let segmentViewStateNode: React.ReactNode = null</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">process.env.NODE_ENV !== 'production' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">const { SegmentBoundaryTriggerNode, SegmentViewStateNode } =</span><span class="s3">\n        </span><span class="s1">require('../../next-devtools/userspace/app/segment-explorer-node') as typeof import('../../next-devtools/userspace/app/segment-explorer-node')</span><span class="s3">\n\n      </span><span class="s1">const pagePrefix = normalizeAppPath(url)</span><span class="s3">\n      </span><span class="s1">segmentViewStateNode = (</span><span class="s3">\n        </span><span class="s1">&lt;SegmentViewStateNode key={pagePrefix} page={pagePrefix} /&gt;</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n\n      </span><span class="s1">segmentBoundaryTriggerNode = (</span><span class="s3">\n        </span><span class="s1">&lt;&gt;</span><span class="s3">\n          </span><span class="s1">&lt;SegmentBoundaryTriggerNode /&gt;</span><span class="s3">\n        </span><span class="s1">&lt;/&gt;</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// TODO: The loading module data for a segment is stored on the parent, then</span><span class="s3">\n    </span><span class="s1">// applied to each of that parent segment's parallel route slots. In the</span><span class="s3">\n    </span><span class="s1">// simple case where there's only one parallel route (the `children` slot),</span><span class="s3">\n    </span><span class="s1">// this is no different from if the loading module data where stored on the</span><span class="s3">\n    </span><span class="s1">// child directly. But I'm not sure this actually makes sense when there are</span><span class="s3">\n    </span><span class="s1">// multiple parallel routes. It's not a huge issue because you always have</span><span class="s3">\n    </span><span class="s1">// the option to define a narrower loading boundary for a particular slot. But</span><span class="s3">\n    </span><span class="s1">// this sort of smells like an implementation accident to me.</span><span class="s3">\n    </span><span class="s1">const loadingModuleData = parentCacheNode.loading</span><span class="s3">\n    </span><span class="s1">let child = (</span><span class="s3">\n      </span><span class="s1">&lt;TemplateContext.Provider</span><span class="s3">\n        </span><span class="s1">key={stateKey}</span><span class="s3">\n        </span><span class="s1">value={</span><span class="s3">\n          </span><span class="s1">&lt;ScrollAndFocusHandler segmentPath={segmentPath}&gt;</span><span class="s3">\n            </span><span class="s1">&lt;ErrorBoundary</span><span class="s3">\n              </span><span class="s1">errorComponent={error}</span><span class="s3">\n              </span><span class="s1">errorStyles={errorStyles}</span><span class="s3">\n              </span><span class="s1">errorScripts={errorScripts}</span><span class="s3">\n            </span><span class="s1">&gt;</span><span class="s3">\n              </span><span class="s1">&lt;LoadingBoundary loading={loadingModuleData}&gt;</span><span class="s3">\n                </span><span class="s1">&lt;HTTPAccessFallbackBoundary</span><span class="s3">\n                  </span><span class="s1">notFound={notFound}</span><span class="s3">\n                  </span><span class="s1">forbidden={forbidden}</span><span class="s3">\n                  </span><span class="s1">unauthorized={unauthorized}</span><span class="s3">\n                </span><span class="s1">&gt;</span><span class="s3">\n                  </span><span class="s1">&lt;RedirectBoundary&gt;</span><span class="s3">\n                    </span><span class="s1">&lt;InnerLayoutRouter</span><span class="s3">\n                      </span><span class="s1">url={url}</span><span class="s3">\n                      </span><span class="s1">tree={tree}</span><span class="s3">\n                      </span><span class="s1">cacheNode={cacheNode}</span><span class="s3">\n                      </span><span class="s1">segmentPath={segmentPath}</span><span class="s3">\n                    </span><span class="s1">/&gt;</span><span class="s3">\n                    </span><span class="s1">{segmentBoundaryTriggerNode}</span><span class="s3">\n                  </span><span class="s1">&lt;/RedirectBoundary&gt;</span><span class="s3">\n                </span><span class="s1">&lt;/HTTPAccessFallbackBoundary&gt;</span><span class="s3">\n              </span><span class="s1">&lt;/LoadingBoundary&gt;</span><span class="s3">\n            </span><span class="s1">&lt;/ErrorBoundary&gt;</span><span class="s3">\n            </span><span class="s1">{segmentViewStateNode}</span><span class="s3">\n          </span><span class="s1">&lt;/ScrollAndFocusHandler&gt;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">&gt;</span><span class="s3">\n        </span><span class="s1">{templateStyles}</span><span class="s3">\n        </span><span class="s1">{templateScripts}</span><span class="s3">\n        </span><span class="s1">{template}</span><span class="s3">\n      </span><span class="s1">&lt;/TemplateContext.Provider&gt;</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n    </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n      </span><span class="s1">const { SegmentStateProvider } =</span><span class="s3">\n        </span><span class="s1">require('../../next-devtools/userspace/app/segment-explorer-node') as typeof import('../../next-devtools/userspace/app/segment-explorer-node')</span><span class="s3">\n\n      </span><span class="s1">child = (</span><span class="s3">\n        </span><span class="s1">&lt;SegmentStateProvider key={stateKey}&gt;</span><span class="s3">\n          </span><span class="s1">{child}</span><span class="s3">\n          </span><span class="s1">{segmentViewBoundaries}</span><span class="s3">\n        </span><span class="s1">&lt;/SegmentStateProvider&gt;</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (process.env.__NEXT_ROUTER_BF_CACHE) {</span><span class="s3">\n      </span><span class="s1">child = (</span><span class="s3">\n        </span><span class="s1">&lt;Activity</span><span class="s3">\n          </span><span class="s1">key={stateKey}</span><span class="s3">\n          </span><span class="s1">mode={stateKey === activeStateKey ? 'visible' : 'hidden'}</span><span class="s3">\n        </span><span class="s1">&gt;</span><span class="s3">\n          </span><span class="s1">{child}</span><span class="s3">\n        </span><span class="s1">&lt;/Activity&gt;</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">children.push(child)</span><span class="s3">\n\n    </span><span class="s1">bfcacheEntry = bfcacheEntry.next</span><span class="s3">\n  </span><span class="s1">} while (bfcacheEntry !== null)</span><span class="s3">\n\n  </span><span class="s1">return children</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ACTION_SERVER_PATCH&quot;</span><span class="s0">,</span><span class="s1">&quot;React&quot;</span><span class="s0">,</span><span class="s1">&quot;useContext&quot;</span><span class="s0">,</span><span class="s1">&quot;use&quot;</span><span class="s0">,</span><span class="s1">&quot;startTransition&quot;</span><span class="s0">,</span><span class="s1">&quot;Suspense&quot;</span><span class="s0">,</span><span class="s1">&quot;useDeferredValue&quot;</span><span class="s0">,</span><span class="s1">&quot;ReactDOM&quot;</span><span class="s0">,</span><span class="s1">&quot;LayoutRouterContext&quot;</span><span class="s0">,</span><span class="s1">&quot;GlobalLayoutRouterContext&quot;</span><span class="s0">,</span><span class="s1">&quot;TemplateContext&quot;</span><span class="s0">,</span><span class="s1">&quot;fetchServerResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;unresolvedThenable&quot;</span><span class="s0">,</span><span class="s1">&quot;ErrorBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;matchSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;disableSmoothScrollDuringRouteTransition&quot;</span><span class="s0">,</span><span class="s1">&quot;RedirectBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;HTTPAccessFallbackBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;createRouterCacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;hasInterceptionRouteInCurrentTree&quot;</span><span class="s0">,</span><span class="s1">&quot;dispatchAppRouterAction&quot;</span><span class="s0">,</span><span class="s1">&quot;useRouterBFCache&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeAppPath&quot;</span><span class="s0">,</span><span class="s1">&quot;Activity&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_ROUTER_BF_CACHE&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;unstable_Activity&quot;</span><span class="s0">,</span><span class="s1">&quot;walkAddRefetch&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentPathToWalk&quot;</span><span class="s0">,</span><span class="s1">&quot;treeToRecreate&quot;</span><span class="s0">,</span><span class="s1">&quot;segment&quot;</span><span class="s0">,</span><span class="s1">&quot;parallelRouteKey&quot;</span><span class="s0">,</span><span class="s1">&quot;isLast&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;hasOwnProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;subTree&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE&quot;</span><span class="s0">,</span><span class="s1">&quot;findDOMNode&quot;</span><span class="s0">,</span><span class="s1">&quot;instance&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;internal_reactDOMfindDOMNode&quot;</span><span class="s0">,</span><span class="s1">&quot;rectProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldSkipElement&quot;</span><span class="s0">,</span><span class="s1">&quot;element&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;getComputedStyle&quot;</span><span class="s0">,</span><span class="s1">&quot;position&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;warn&quot;</span><span class="s0">,</span><span class="s1">&quot;rect&quot;</span><span class="s0">,</span><span class="s1">&quot;getBoundingClientRect&quot;</span><span class="s0">,</span><span class="s1">&quot;every&quot;</span><span class="s0">,</span><span class="s1">&quot;item&quot;</span><span class="s0">,</span><span class="s1">&quot;topOfElementInViewport&quot;</span><span class="s0">,</span><span class="s1">&quot;viewportHeight&quot;</span><span class="s0">,</span><span class="s1">&quot;top&quot;</span><span class="s0">,</span><span class="s1">&quot;getHashFragmentDomNode&quot;</span><span class="s0">,</span><span class="s1">&quot;hashFragment&quot;</span><span class="s0">,</span><span class="s1">&quot;document&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;getElementById&quot;</span><span class="s0">,</span><span class="s1">&quot;getElementsByName&quot;</span><span class="s0">,</span><span class="s1">&quot;InnerScrollAndFocusHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;Component&quot;</span><span class="s0">,</span><span class="s1">&quot;componentDidMount&quot;</span><span class="s0">,</span><span class="s1">&quot;handlePotentialScroll&quot;</span><span class="s0">,</span><span class="s1">&quot;componentDidUpdate&quot;</span><span class="s0">,</span><span class="s1">&quot;props&quot;</span><span class="s0">,</span><span class="s1">&quot;focusAndScrollRef&quot;</span><span class="s0">,</span><span class="s1">&quot;apply&quot;</span><span class="s0">,</span><span class="s1">&quot;render&quot;</span><span class="s0">,</span><span class="s1">&quot;children&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentPaths&quot;</span><span class="s0">,</span><span class="s1">&quot;some&quot;</span><span class="s0">,</span><span class="s1">&quot;scrollRefSegmentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;domNode&quot;</span><span class="s0">,</span><span class="s1">&quot;Element&quot;</span><span class="s0">,</span><span class="s1">&quot;HTMLElement&quot;</span><span class="s0">,</span><span class="s1">&quot;parentElement&quot;</span><span class="s0">,</span><span class="s1">&quot;localName&quot;</span><span class="s0">,</span><span class="s1">&quot;nextElementSibling&quot;</span><span class="s0">,</span><span class="s1">&quot;scrollIntoView&quot;</span><span class="s0">,</span><span class="s1">&quot;htmlElement&quot;</span><span class="s0">,</span><span class="s1">&quot;documentElement&quot;</span><span class="s0">,</span><span class="s1">&quot;clientHeight&quot;</span><span class="s0">,</span><span class="s1">&quot;scrollTop&quot;</span><span class="s0">,</span><span class="s1">&quot;dontForceLayout&quot;</span><span class="s0">,</span><span class="s1">&quot;onlyHashChange&quot;</span><span class="s0">,</span><span class="s1">&quot;focus&quot;</span><span class="s0">,</span><span class="s1">&quot;ScrollAndFocusHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;context&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;InnerLayoutRouter&quot;</span><span class="s0">,</span><span class="s1">&quot;tree&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheNode&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;fullTree&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvedPrefetchRsc&quot;</span><span class="s0">,</span><span class="s1">&quot;prefetchRsc&quot;</span><span class="s0">,</span><span class="s1">&quot;rsc&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvedRsc&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;lazyData&quot;</span><span class="s0">,</span><span class="s1">&quot;refetchTree&quot;</span><span class="s0">,</span><span class="s1">&quot;includeNextUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;navigatedAt&quot;</span><span class="s0">,</span><span class="s1">&quot;Date&quot;</span><span class="s0">,</span><span class="s1">&quot;now&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;location&quot;</span><span class="s0">,</span><span class="s1">&quot;origin&quot;</span><span class="s0">,</span><span class="s1">&quot;flightRouterState&quot;</span><span class="s0">,</span><span class="s1">&quot;nextUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;serverResponse&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;previousTree&quot;</span><span class="s0">,</span><span class="s1">&quot;subtree&quot;</span><span class="s0">,</span><span class="s1">&quot;Provider&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;parentTree&quot;</span><span class="s0">,</span><span class="s1">&quot;parentCacheNode&quot;</span><span class="s0">,</span><span class="s1">&quot;parentSegmentPath&quot;</span><span class="s0">,</span><span class="s1">&quot;LoadingBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;loading&quot;</span><span class="s0">,</span><span class="s1">&quot;loadingModuleData&quot;</span><span class="s0">,</span><span class="s1">&quot;promiseForLoading&quot;</span><span class="s0">,</span><span class="s1">&quot;loadingRsc&quot;</span><span class="s0">,</span><span class="s1">&quot;loadingStyles&quot;</span><span class="s0">,</span><span class="s1">&quot;loadingScripts&quot;</span><span class="s0">,</span><span class="s1">&quot;fallback&quot;</span><span class="s0">,</span><span class="s1">&quot;OuterLayoutRouter&quot;</span><span class="s0">,</span><span class="s1">&quot;parallelRouterKey&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;errorStyles&quot;</span><span class="s0">,</span><span class="s1">&quot;errorScripts&quot;</span><span class="s0">,</span><span class="s1">&quot;templateStyles&quot;</span><span class="s0">,</span><span class="s1">&quot;templateScripts&quot;</span><span class="s0">,</span><span class="s1">&quot;template&quot;</span><span class="s0">,</span><span class="s1">&quot;notFound&quot;</span><span class="s0">,</span><span class="s1">&quot;forbidden&quot;</span><span class="s0">,</span><span class="s1">&quot;unauthorized&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentViewBoundaries&quot;</span><span class="s0">,</span><span class="s1">&quot;parentParallelRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;parallelRoutes&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentMap&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;parentTreeSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;concat&quot;</span><span class="s0">,</span><span class="s1">&quot;activeTree&quot;</span><span class="s0">,</span><span class="s1">&quot;activeSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;activeStateKey&quot;</span><span class="s0">,</span><span class="s1">&quot;bfcacheEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;stateKey&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheKey&quot;</span><span class="s0">,</span><span class="s1">&quot;newLazyCacheNode&quot;</span><span class="s0">,</span><span class="s1">&quot;head&quot;</span><span class="s0">,</span><span class="s1">&quot;prefetchHead&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentBoundaryTriggerNode&quot;</span><span class="s0">,</span><span class="s1">&quot;segmentViewStateNode&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_DEVTOOL_SEGMENT_EXPLORER&quot;</span><span class="s0">,</span><span class="s1">&quot;SegmentBoundaryTriggerNode&quot;</span><span class="s0">,</span><span class="s1">&quot;SegmentViewStateNode&quot;</span><span class="s0">,</span><span class="s1">&quot;pagePrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;page&quot;</span><span class="s0">,</span><span class="s1">&quot;child&quot;</span><span class="s0">,</span><span class="s1">&quot;errorComponent&quot;</span><span class="s0">,</span><span class="s1">&quot;SegmentStateProvider&quot;</span><span class="s0">,</span><span class="s1">&quot;mode&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;next&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3953</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/render-from-template-context.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">import React, { useContext, type JSX } from 'react'</span><span class="s3">\n</span><span class="s1">import { TemplateContext } from '../../shared/lib/app-router-context.shared-runtime'</span><span class="s3">\n\n</span><span class="s1">export default function RenderFromTemplateContext(): JSX.Element {</span><span class="s3">\n  </span><span class="s1">const children = useContext(TemplateContext)</span><span class="s3">\n  </span><span class="s1">return &lt;&gt;{children}&lt;/&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;React&quot;</span><span class="s0">,</span><span class="s1">&quot;useContext&quot;</span><span class="s0">,</span><span class="s1">&quot;TemplateContext&quot;</span><span class="s0">,</span><span class="s1">&quot;RenderFromTemplateContext&quot;</span><span class="s0">,</span><span class="s1">&quot;children&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;AAEA,OAAOA,SAASC,UAAU,QAAkB,QAAO;AACnD,SAASC,eAAe,QAAQ,qDAAoD;AAHpF;;;;AAKe,SAASC;IACtB,MAAMC,eAAWH,mNAAAA,EAAWC,gPAAAA;IAC5B,OAAA,WAAA,OAAO,8NAAA,EAAA,mOAAA,EAAA;kBAAGE;;AACZ&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">3974</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/web/spec-extension/adapters/reflect.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;export class ReflectAdapter {</span><span class="s3">\n  </span><span class="s1">static get&lt;T extends object&gt;(</span><span class="s3">\n    </span><span class="s1">target: T,</span><span class="s3">\n    </span><span class="s1">prop: string | symbol,</span><span class="s3">\n    </span><span class="s1">receiver: unknown</span><span class="s3">\n  </span><span class="s1">): any {</span><span class="s3">\n    </span><span class="s1">const value = Reflect.get(target, prop, receiver)</span><span class="s3">\n    </span><span class="s1">if (typeof value === 'function') {</span><span class="s3">\n      </span><span class="s1">return value.bind(target)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return value</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static set&lt;T extends object&gt;(</span><span class="s3">\n    </span><span class="s1">target: T,</span><span class="s3">\n    </span><span class="s1">prop: string | symbol,</span><span class="s3">\n    </span><span class="s1">value: any,</span><span class="s3">\n    </span><span class="s1">receiver: any</span><span class="s3">\n  </span><span class="s1">): boolean {</span><span class="s3">\n    </span><span class="s1">return Reflect.set(target, prop, value, receiver)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static has&lt;T extends object&gt;(target: T, prop: string | symbol): boolean {</span><span class="s3">\n    </span><span class="s1">return Reflect.has(target, prop)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">static deleteProperty&lt;T extends object&gt;(</span><span class="s3">\n    </span><span class="s1">target: T,</span><span class="s3">\n    </span><span class="s1">prop: string | symbol</span><span class="s3">\n  </span><span class="s1">): boolean {</span><span class="s3">\n    </span><span class="s1">return Reflect.deleteProperty(target, prop)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ReflectAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;receiver&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;Reflect&quot;</span><span class="s0">,</span><span class="s1">&quot;bind&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;deleteProperty&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAO,MAAMA;IACX,OAAOC,IACLC,MAAS,EACTC,IAAqB,EACrBC,QAAiB,EACZ;QACL,MAAMC,QAAQC,QAAQL,GAAG,CAACC,QAAQC,MAAMC;QACxC,IAAI,OAAOC,UAAU,YAAY;YAC/B,OAAOA,MAAME,IAAI,CAACL;QACpB;QAEA,OAAOG;IACT;IAEA,OAAOG,IACLN,MAAS,EACTC,IAAqB,EACrBE,KAAU,EACVD,QAAa,EACJ;QACT,OAAOE,QAAQE,GAAG,CAACN,QAAQC,MAAME,OAAOD;IAC1C;IAEA,OAAOK,IAAsBP,MAAS,EAAEC,IAAqB,EAAW;QACtE,OAAOG,QAAQG,GAAG,CAACP,QAAQC;IAC7B;IAEA,OAAOO,eACLR,MAAS,EACTC,IAAqB,EACZ;QACT,OAAOG,QAAQI,cAAc,CAACR,QAAQC;IACxC;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4000</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/create-deduped-by-callsite-server-error-logger.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import * as React from 'react'</span><span class="s3">\n\n</span><span class="s1">const errorRef: { current: null | Error } = { current: null }</span><span class="s3">\n\n</span><span class="s1">// React.cache is currently only available in canary/experimental React channels.</span><span class="s3">\n</span><span class="s1">const cache =</span><span class="s3">\n  </span><span class="s1">typeof React.cache === 'function'</span><span class="s3">\n    </span><span class="s1">? React.cache</span><span class="s3">\n    </span><span class="s1">: (fn: (key: unknown) =&gt; void) =&gt; fn</span><span class="s3">\n\n</span><span class="s1">// When Cache Components is enabled, we record these as errors so that they</span><span class="s3">\n</span><span class="s1">// are captured by the dev overlay as it's more critical to fix these</span><span class="s3">\n</span><span class="s1">// when enabled.</span><span class="s3">\n</span><span class="s1">const logErrorOrWarn = process.env.__NEXT_CACHE_COMPONENTS</span><span class="s3">\n  </span><span class="s1">? console.error</span><span class="s3">\n  </span><span class="s1">: console.warn</span><span class="s3">\n\n</span><span class="s1">// We don't want to dedupe across requests.</span><span class="s3">\n</span><span class="s1">// The developer might've just attempted to fix the warning so we should warn again if it still happens.</span><span class="s3">\n</span><span class="s1">const flushCurrentErrorIfNew = cache(</span><span class="s3">\n  </span><span class="s1">// eslint-disable-next-line @typescript-eslint/no-unused-vars -- cache key</span><span class="s3">\n  </span><span class="s1">(key: unknown) =&gt; {</span><span class="s3">\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">logErrorOrWarn(errorRef.current)</span><span class="s3">\n    </span><span class="s1">} finally {</span><span class="s3">\n      </span><span class="s1">errorRef.current = null</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Creates a function that logs an error message that is deduped by the userland</span><span class="s3">\n </span><span class="s1">* callsite.</span><span class="s3">\n </span><span class="s1">* This requires no indirection between the call of this function and the userland</span><span class="s3">\n </span><span class="s1">* callsite i.e. there's only a single library frame above this.</span><span class="s3">\n </span><span class="s1">* Do not use on the Client where sourcemaps and ignore listing might be enabled.</span><span class="s3">\n </span><span class="s1">* Only use that for warnings need a fix independent of the callstack.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param getMessage</span><span class="s3">\n </span><span class="s1">* @returns</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function createDedupedByCallsiteServerErrorLoggerDev&lt;Args extends any[]&gt;(</span><span class="s3">\n  </span><span class="s1">getMessage: (...args: Args) =&gt; Error</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">return function logDedupedError(...args: Args) {</span><span class="s3">\n    </span><span class="s1">const message = getMessage(...args)</span><span class="s3">\n\n    </span><span class="s1">if (process.env.NODE_ENV !== 'production') {</span><span class="s3">\n      </span><span class="s1">const callStackFrames = new Error().stack?.split('</span><span class="s3">\\</span><span class="s1">n')</span><span class="s3">\n      </span><span class="s1">if (callStackFrames === undefined || callStackFrames.length &lt; 4) {</span><span class="s3">\n        </span><span class="s1">logErrorOrWarn(message)</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">// Error:</span><span class="s3">\n        </span><span class="s1">//   logDedupedError</span><span class="s3">\n        </span><span class="s1">//   asyncApiBeingAccessedSynchronously</span><span class="s3">\n        </span><span class="s1">//   &lt;userland callsite&gt;</span><span class="s3">\n        </span><span class="s1">// TODO: This breaks if sourcemaps with ignore lists are enabled.</span><span class="s3">\n        </span><span class="s1">const key = callStackFrames[4]</span><span class="s3">\n        </span><span class="s1">errorRef.current = message</span><span class="s3">\n        </span><span class="s1">flushCurrentErrorIfNew(key)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">logErrorOrWarn(message)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;React&quot;</span><span class="s0">,</span><span class="s1">&quot;errorRef&quot;</span><span class="s0">,</span><span class="s1">&quot;current&quot;</span><span class="s0">,</span><span class="s1">&quot;cache&quot;</span><span class="s0">,</span><span class="s1">&quot;fn&quot;</span><span class="s0">,</span><span class="s1">&quot;logErrorOrWarn&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_CACHE_COMPONENTS&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;warn&quot;</span><span class="s0">,</span><span class="s1">&quot;flushCurrentErrorIfNew&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;createDedupedByCallsiteServerErrorLoggerDev&quot;</span><span class="s0">,</span><span class="s1">&quot;getMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;logDedupedError&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;callStackFrames&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;stack&quot;</span><span class="s0">,</span><span class="s1">&quot;split&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;AAAA,YAAYA,WAAW,QAAO;;AAE9B,MAAMC,WAAsC;IAAEC,SAAS;AAAK;AAE5D,iFAAiF;AACjF,MAAMC,QACJ,OAAOH,MAAMG,wMAAK,KAAK,aACnBH,MAAMG,wMAAK,GACX,CAACC,KAA+BA;AAEtC,2EAA2E;AAC3E,qEAAqE;AACrE,gBAAgB;AAChB,MAAMC,iBAAiBC,QAAQC,GAAG,CAACC,uBAAuB,GACtDC,QAAQC,KAAK,aACbD,QAAQE,IAAI;AAEhB,2CAA2C;AAC3C,wGAAwG;AACxG,MAAMC,yBAAyBT,MAC7B,AACA,CAACU,yEADyE;IAExE,IAAI;QACFR,eAAeJ,SAASC,OAAO;IACjC,SAAU;QACRD,SAASC,OAAO,GAAG;IACrB;AACF;AAcK,SAASY,4CACdC,UAAoC;IAEpC,OAAO,SAASC,gBAAgB,GAAGC,IAAU;QAC3C,MAAMC,UAAUH,cAAcE;QAE9B,IAAIX,QAAQC,GAAG,CAACY,QAAQ,KAAK,WAAc;gBACjB;YAAxB,MAAMC,kBAAAA,CAAkB,SAAA,IAAIC,QAAQC,KAAK,KAAA,OAAA,KAAA,IAAjB,OAAmBC,KAAK,CAAC;YACjD,IAAIH,oBAAoBI,aAAaJ,gBAAgBK,MAAM,GAAG,GAAG;gBAC/DpB,eAAea;YACjB,OAAO;gBACL,SAAS;gBACT,oBAAoB;gBACpB,uCAAuC;gBACvC,wBAAwB;gBACxB,iEAAiE;gBACjE,MAAML,MAAMO,eAAe,CAAC,EAAE;gBAC9BnB,SAASC,OAAO,GAAGgB;gBACnBN,uBAAuBC;YACzB;QACF,OAAO;;IAGT;AACF&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4050</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/shared/lib/utils/reflect-utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;// This regex will have fast negatives meaning valid identifiers may not pass</span><span class="s3">\n</span><span class="s1">// this test. However this is only used during static generation to provide hints</span><span class="s3">\n</span><span class="s1">// about why a page bailed out of some or all prerendering and we can use bracket notation</span><span class="s3">\n</span><span class="s1">// for example while `_` is a valid identifier it's ok to print `searchParams['_']`</span><span class="s3">\n</span><span class="s1">// even if this would have been fine too `searchParams._`</span><span class="s3">\n</span><span class="s1">const isDefinitelyAValidIdentifier = /^[A-Za-z_$][A-Za-z0-9_$]*$/</span><span class="s3">\n\n</span><span class="s1">export function describeStringPropertyAccess(target: string, prop: string) {</span><span class="s3">\n  </span><span class="s1">if (isDefinitelyAValidIdentifier.test(prop)) {</span><span class="s3">\n    </span><span class="s1">return `</span><span class="s3">\\</span><span class="s1">`${target}.${prop}</span><span class="s3">\\</span><span class="s1">``</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return `</span><span class="s3">\\</span><span class="s1">`${target}[${JSON.stringify(prop)}]</span><span class="s3">\\</span><span class="s1">``</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function describeHasCheckingStringProperty(</span><span class="s3">\n  </span><span class="s1">target: string,</span><span class="s3">\n  </span><span class="s1">prop: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const stringifiedProp = JSON.stringify(prop)</span><span class="s3">\n  </span><span class="s1">return `</span><span class="s3">\\</span><span class="s1">`Reflect.has(${target}, ${stringifiedProp})</span><span class="s3">\\</span><span class="s1">`, </span><span class="s3">\\</span><span class="s1">`${stringifiedProp} in ${target}</span><span class="s3">\\</span><span class="s1">`, or similar`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const wellKnownProperties = new Set([</span><span class="s3">\n  </span><span class="s1">'hasOwnProperty',</span><span class="s3">\n  </span><span class="s1">'isPrototypeOf',</span><span class="s3">\n  </span><span class="s1">'propertyIsEnumerable',</span><span class="s3">\n  </span><span class="s1">'toString',</span><span class="s3">\n  </span><span class="s1">'valueOf',</span><span class="s3">\n  </span><span class="s1">'toLocaleString',</span><span class="s3">\n\n  </span><span class="s1">// Promise prototype</span><span class="s3">\n  </span><span class="s1">// fallthrough</span><span class="s3">\n  </span><span class="s1">'then',</span><span class="s3">\n  </span><span class="s1">'catch',</span><span class="s3">\n  </span><span class="s1">'finally',</span><span class="s3">\n\n  </span><span class="s1">// React Promise extension</span><span class="s3">\n  </span><span class="s1">// fallthrough</span><span class="s3">\n  </span><span class="s1">'status',</span><span class="s3">\n\n  </span><span class="s1">// React introspection</span><span class="s3">\n  </span><span class="s1">'displayName',</span><span class="s3">\n  </span><span class="s1">'_debugInfo',</span><span class="s3">\n\n  </span><span class="s1">// Common tested properties</span><span class="s3">\n  </span><span class="s1">// fallthrough</span><span class="s3">\n  </span><span class="s1">'toJSON',</span><span class="s3">\n  </span><span class="s1">'$$typeof',</span><span class="s3">\n  </span><span class="s1">'__esModule',</span><span class="s3">\n</span><span class="s1">])</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;isDefinitelyAValidIdentifier&quot;</span><span class="s0">,</span><span class="s1">&quot;describeStringPropertyAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;describeHasCheckingStringProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;stringifiedProp&quot;</span><span class="s0">,</span><span class="s1">&quot;wellKnownProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;AAAA,6EAA6E;AAC7E,iFAAiF;AACjF,0FAA0F;AAC1F,uFAAuF;AACvF,2DAA2D;;;;;;;;;AAC3D,MAAMA,+BAA+B;AAE9B,SAASC,6BAA6BC,MAAc,EAAEC,IAAY;IACvE,IAAIH,6BAA6BI,IAAI,CAACD,OAAO;QAC3C,OAAQ,MAAID,SAAO,MAAGC,OAAK;IAC7B;IACA,OAAQ,MAAID,SAAO,MAAGG,KAAKC,SAAS,CAACH,QAAM;AAC7C;AAEO,SAASI,kCACdL,MAAc,EACdC,IAAY;IAEZ,MAAMK,kBAAkBH,KAAKC,SAAS,CAACH;IACvC,OAAQ,kBAAgBD,SAAO,OAAIM,kBAAgB,UAASA,kBAAgB,SAAMN,SAAO;AAC3F;AAEO,MAAMO,sBAAsB,IAAIC,IAAI;IACzC;IACA;IACA;IACA;IACA;IACA;IAEA,oBAAoB;IACpB,cAAc;IACd;IACA;IACA;IAEA,0BAA0B;IAC1B,cAAc;IACd;IAEA,sBAAsB;IACtB;IACA;IAEA,2BAA2B;IAC3B,cAAc;IACd;IACA;IACA;CACD,EAAC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4102</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/request/utils.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { StaticGenBailoutError } from '../../client/components/static-generation-bailout'</span><span class="s3">\n</span><span class="s1">import { afterTaskAsyncStorage } from '../app-render/after-task-async-storage.external'</span><span class="s3">\n</span><span class="s1">import type { WorkStore } from '../app-render/work-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">export function throwWithStaticGenerationBailoutError(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">throw new StaticGenBailoutError(</span><span class="s3">\n    </span><span class="s1">`Route ${route} couldn't be rendered statically because it used ${expression}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function throwWithStaticGenerationBailoutErrorWithDynamicError(</span><span class="s3">\n  </span><span class="s1">route: string,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">throw new StaticGenBailoutError(</span><span class="s3">\n    </span><span class="s1">`Route ${route} with </span><span class="s3">\\</span><span class="s1">`dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;\\</span><span class="s1">` couldn't be rendered statically because it used ${expression}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function throwForSearchParamsAccessInUseCache(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">constructorOpt: Function</span><span class="s3">\n</span><span class="s1">): never {</span><span class="s3">\n  </span><span class="s1">const error = new Error(</span><span class="s3">\n    </span><span class="s1">`Route ${workStore.route} used </span><span class="s3">\&quot;</span><span class="s1">searchParams</span><span class="s3">\&quot; </span><span class="s1">inside </span><span class="s3">\&quot;</span><span class="s1">use cache</span><span class="s3">\&quot;</span><span class="s1">. Accessing dynamic request data inside a cache scope is not supported. If you need some search params inside a cached function await </span><span class="s3">\&quot;</span><span class="s1">searchParams</span><span class="s3">\&quot; </span><span class="s1">outside of the cached function and pass only the required search params as arguments to the cached function. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">Error.captureStackTrace(error, constructorOpt)</span><span class="s3">\n  </span><span class="s1">workStore.invalidDynamicUsageError ??= error</span><span class="s3">\n\n  </span><span class="s1">throw error</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function isRequestAPICallableInsideAfter() {</span><span class="s3">\n  </span><span class="s1">const afterTaskStore = afterTaskAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">return afterTaskStore?.rootTaskSpawnPhase === 'action'</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;StaticGenBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;afterTaskAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;throwWithStaticGenerationBailoutError&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;throwWithStaticGenerationBailoutErrorWithDynamicError&quot;</span><span class="s0">,</span><span class="s1">&quot;throwForSearchParamsAccessInUseCache&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;constructorOpt&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;captureStackTrace&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidDynamicUsageError&quot;</span><span class="s0">,</span><span class="s1">&quot;isRequestAPICallableInsideAfter&quot;</span><span class="s0">,</span><span class="s1">&quot;afterTaskStore&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;rootTaskSpawnPhase&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;AAAA,SAASA,qBAAqB,QAAQ,oDAAmD;AACzF,SAASC,qBAAqB,QAAQ,kDAAiD;;;AAGhF,SAASC,sCACdC,KAAa,EACbC,UAAkB;IAElB,MAAM,OAAA,cAEL,CAFK,IAAIJ,uNAAAA,CACR,CAAC,MAAM,EAAEG,MAAM,iDAAiD,EAAEC,WAAW,0HAA0H,CAAC,GADpM,qBAAA;eAAA;oBAAA;sBAAA;IAEN;AACF;AAEO,SAASC,sDACdF,KAAa,EACbC,UAAkB;IAElB,MAAM,OAAA,cAEL,CAFK,IAAIJ,uNAAAA,CACR,CAAC,MAAM,EAAEG,MAAM,4EAA4E,EAAEC,WAAW,0HAA0H,CAAC,GAD/N,qBAAA;eAAA;oBAAA;sBAAA;IAEN;AACF;AAEO,SAASE,qCACdC,SAAoB,EACpBC,cAAwB;IAExB,MAAMC,QAAQ,OAAA,cAEb,CAFa,IAAIC,MAChB,CAAC,MAAM,EAAEH,UAAUJ,KAAK,CAAC,uXAAuX,CAAC,GADrY,qBAAA;eAAA;oBAAA;sBAAA;IAEd;IAEAO,MAAMC,iBAAiB,CAACF,OAAOD;IAC/BD,UAAUK,wBAAwB,KAAKH;IAEvC,MAAMA;AACR;AAEO,SAASI;IACd,MAAMC,iBAAiBb,8SAAAA,CAAsBc,QAAQ;IACrD,OAAOD,CAAAA,kBAAAA,OAAAA,KAAAA,IAAAA,eAAgBE,kBAAkB,MAAK;AAChD&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4148</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/request/search-params.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { WorkStore } from '../app-render/work-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">import { ReflectAdapter } from '../web/spec-extension/adapters/reflect'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">throwToInterruptStaticGeneration,</span><span class="s3">\n  </span><span class="s1">postponeWithTracking,</span><span class="s3">\n  </span><span class="s1">trackDynamicDataInDynamicRender,</span><span class="s3">\n  </span><span class="s1">annotateDynamicAccess,</span><span class="s3">\n  </span><span class="s1">trackSynchronousRequestDataAccessInDev,</span><span class="s3">\n  </span><span class="s1">delayUntilRuntimeStage,</span><span class="s3">\n</span><span class="s1">} from '../app-render/dynamic-rendering'</span><span class="s3">\n\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">workUnitAsyncStorage,</span><span class="s3">\n  </span><span class="s1">type PrerenderStoreLegacy,</span><span class="s3">\n  </span><span class="s1">type PrerenderStorePPR,</span><span class="s3">\n  </span><span class="s1">type PrerenderStoreModern,</span><span class="s3">\n  </span><span class="s1">type PrerenderStoreModernRuntime,</span><span class="s3">\n  </span><span class="s1">type StaticPrerenderStore,</span><span class="s3">\n  </span><span class="s1">throwInvariantForMissingStore,</span><span class="s3">\n</span><span class="s1">} from '../app-render/work-unit-async-storage.external'</span><span class="s3">\n</span><span class="s1">import { InvariantError } from '../../shared/lib/invariant-error'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">makeDevtoolsIOAwarePromise,</span><span class="s3">\n  </span><span class="s1">makeHangingPromise,</span><span class="s3">\n</span><span class="s1">} from '../dynamic-rendering-utils'</span><span class="s3">\n</span><span class="s1">import { createDedupedByCallsiteServerErrorLoggerDev } from '../create-deduped-by-callsite-server-error-logger'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">describeStringPropertyAccess,</span><span class="s3">\n  </span><span class="s1">describeHasCheckingStringProperty,</span><span class="s3">\n  </span><span class="s1">wellKnownProperties,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/utils/reflect-utils'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">throwWithStaticGenerationBailoutErrorWithDynamicError,</span><span class="s3">\n  </span><span class="s1">throwForSearchParamsAccessInUseCache,</span><span class="s3">\n</span><span class="s1">} from './utils'</span><span class="s3">\n\n</span><span class="s1">export type SearchParams = { [key: string]: string | string[] | undefined }</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* In this version of Next.js the `params` prop passed to Layouts, Pages, and other Segments is a Promise.</span><span class="s3">\n </span><span class="s1">* However to facilitate migration to this new Promise type you can currently still access params directly on the Promise instance passed to these Segments.</span><span class="s3">\n </span><span class="s1">* The `UnsafeUnwrappedSearchParams` type is available if you need to temporarily access the underlying params without first awaiting or `use`ing the Promise.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* In a future version of Next.js the `params` prop will be a plain Promise and this type will be removed.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Typically instances of `params` can be updated automatically to be treated as a Promise by a codemod published alongside this Next.js version however if you</span><span class="s3">\n </span><span class="s1">* have not yet run the codemod of the codemod cannot detect certain instances of `params` usage you should first try to refactor your code to await `params`.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* If refactoring is not possible but you still want to be able to access params directly without typescript errors you can cast the params Promise to this type</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* ```tsx</span><span class="s3">\n </span><span class="s1">* type Props = { searchParams: Promise&lt;{ foo: string }&gt; }</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* export default async function Page(props: Props) {</span><span class="s3">\n </span><span class="s1">*  const { searchParams } = (props.searchParams as unknown as UnsafeUnwrappedSearchParams&lt;typeof props.searchParams&gt;)</span><span class="s3">\n </span><span class="s1">*  return ...</span><span class="s3">\n </span><span class="s1">* }</span><span class="s3">\n </span><span class="s1">* ```</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This type is marked deprecated to help identify it as target for refactoring away.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @deprecated</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export type UnsafeUnwrappedSearchParams&lt;P&gt; =</span><span class="s3">\n  </span><span class="s1">P extends Promise&lt;infer U&gt; ? Omit&lt;U, 'then' | 'status' | 'value'&gt; : never</span><span class="s3">\n\n</span><span class="s1">export function createSearchParamsFromClient(</span><span class="s3">\n  </span><span class="s1">underlyingSearchParams: SearchParams,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender':</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n        </span><span class="s1">return createStaticPrerenderSearchParams(workStore, workUnitStore)</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">'createSearchParamsFromClient should not be called in a runtime prerender.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">'createSearchParamsFromClient should not be called in cache contexts.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">return createRenderSearchParams(underlyingSearchParams, workStore)</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">throwInvariantForMissingStore()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// generateMetadata always runs in RSC context so it is equivalent to a Server Page Component</span><span class="s3">\n</span><span class="s1">export const createServerSearchParamsForMetadata =</span><span class="s3">\n  </span><span class="s1">createServerSearchParamsForServerPage</span><span class="s3">\n\n</span><span class="s1">export function createServerSearchParamsForServerPage(</span><span class="s3">\n  </span><span class="s1">underlyingSearchParams: SearchParams,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender':</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n        </span><span class="s1">return createStaticPrerenderSearchParams(workStore, workUnitStore)</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">'createServerSearchParamsForServerPage should not be called in cache contexts.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n        </span><span class="s1">return createRuntimePrerenderSearchParams(</span><span class="s3">\n          </span><span class="s1">underlyingSearchParams,</span><span class="s3">\n          </span><span class="s1">workUnitStore</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">return createRenderSearchParams(underlyingSearchParams, workStore)</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">throwInvariantForMissingStore()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createPrerenderSearchParamsForClientPage(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">if (workStore.forceStatic) {</span><span class="s3">\n    </span><span class="s1">// When using forceStatic we override all other logic and always just return an empty</span><span class="s3">\n    </span><span class="s1">// dictionary object.</span><span class="s3">\n    </span><span class="s1">return Promise.resolve({})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender':</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n        </span><span class="s1">// We're prerendering in a mode that aborts (cacheComponents) and should stall</span><span class="s3">\n        </span><span class="s1">// the promise to ensure the RSC side is considered dynamic</span><span class="s3">\n        </span><span class="s1">return makeHangingPromise(</span><span class="s3">\n          </span><span class="s1">workUnitStore.renderSignal,</span><span class="s3">\n          </span><span class="s1">workStore.route,</span><span class="s3">\n          </span><span class="s1">'`searchParams`'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">'createPrerenderSearchParamsForClientPage should not be called in a runtime prerender.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">'createPrerenderSearchParamsForClientPage should not be called in cache contexts.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">return Promise.resolve({})</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">throwInvariantForMissingStore()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createStaticPrerenderSearchParams(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: StaticPrerenderStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">if (workStore.forceStatic) {</span><span class="s3">\n    </span><span class="s1">// When using forceStatic we override all other logic and always just return an empty</span><span class="s3">\n    </span><span class="s1">// dictionary object.</span><span class="s3">\n    </span><span class="s1">return Promise.resolve({})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">switch (prerenderStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'prerender':</span><span class="s3">\n    </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">// We are in a cacheComponents (PPR or otherwise) prerender</span><span class="s3">\n      </span><span class="s1">return makeHangingSearchParams(workStore, prerenderStore)</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">// We are in a legacy static generation and need to interrupt the</span><span class="s3">\n      </span><span class="s1">// prerender when search params are accessed.</span><span class="s3">\n      </span><span class="s1">return makeErroringExoticSearchParams(workStore, prerenderStore)</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">return prerenderStore satisfies never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createRuntimePrerenderSearchParams(</span><span class="s3">\n  </span><span class="s1">underlyingSearchParams: SearchParams,</span><span class="s3">\n  </span><span class="s1">workUnitStore: PrerenderStoreModernRuntime</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">return delayUntilRuntimeStage(</span><span class="s3">\n    </span><span class="s1">workUnitStore,</span><span class="s3">\n    </span><span class="s1">process.env.__NEXT_CACHE_COMPONENTS</span><span class="s3">\n      </span><span class="s1">? makeUntrackedSearchParams(underlyingSearchParams)</span><span class="s3">\n      </span><span class="s1">: makeUntrackedExoticSearchParams(underlyingSearchParams)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createRenderSearchParams(</span><span class="s3">\n  </span><span class="s1">underlyingSearchParams: SearchParams,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">if (workStore.forceStatic) {</span><span class="s3">\n    </span><span class="s1">// When using forceStatic we override all other logic and always just return an empty</span><span class="s3">\n    </span><span class="s1">// dictionary object.</span><span class="s3">\n    </span><span class="s1">return Promise.resolve({})</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n      </span><span class="s1">// Semantically we only need the dev tracking when running in `next dev`</span><span class="s3">\n      </span><span class="s1">// but since you would never use next dev with production NODE_ENV we use this</span><span class="s3">\n      </span><span class="s1">// as a proxy so we can statically exclude this code from production builds.</span><span class="s3">\n      </span><span class="s1">if (process.env.__NEXT_CACHE_COMPONENTS) {</span><span class="s3">\n        </span><span class="s1">return makeUntrackedSearchParamsWithDevWarnings(</span><span class="s3">\n          </span><span class="s1">underlyingSearchParams,</span><span class="s3">\n          </span><span class="s1">workStore</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return makeDynamicallyTrackedExoticSearchParamsWithDevWarnings(</span><span class="s3">\n        </span><span class="s1">underlyingSearchParams,</span><span class="s3">\n        </span><span class="s1">workStore</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if (process.env.__NEXT_CACHE_COMPONENTS) {</span><span class="s3">\n        </span><span class="s1">return makeUntrackedSearchParams(underlyingSearchParams)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return makeUntrackedExoticSearchParams(underlyingSearchParams)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface CacheLifetime {}</span><span class="s3">\n</span><span class="s1">const CachedSearchParams = new WeakMap&lt;CacheLifetime, Promise&lt;SearchParams&gt;&gt;()</span><span class="s3">\n\n</span><span class="s1">const CachedSearchParamsForUseCache = new WeakMap&lt;</span><span class="s3">\n  </span><span class="s1">CacheLifetime,</span><span class="s3">\n  </span><span class="s1">Promise&lt;SearchParams&gt;</span><span class="s3">\n</span><span class="s1">&gt;()</span><span class="s3">\n\n</span><span class="s1">function makeHangingSearchParams(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreModern</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedSearchParams = CachedSearchParams.get(prerenderStore)</span><span class="s3">\n  </span><span class="s1">if (cachedSearchParams) {</span><span class="s3">\n    </span><span class="s1">return cachedSearchParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const promise = makeHangingPromise&lt;SearchParams&gt;(</span><span class="s3">\n    </span><span class="s1">prerenderStore.renderSignal,</span><span class="s3">\n    </span><span class="s1">workStore.route,</span><span class="s3">\n    </span><span class="s1">'`searchParams`'</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">const proxiedPromise = new Proxy(promise, {</span><span class="s3">\n    </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n      </span><span class="s1">if (Object.hasOwn(promise, prop)) {</span><span class="s3">\n        </span><span class="s1">// The promise has this property directly. we must return it.</span><span class="s3">\n        </span><span class="s1">// We know it isn't a dynamic access because it can only be something</span><span class="s3">\n        </span><span class="s1">// that was previously written to the promise and thus not an underlying searchParam value</span><span class="s3">\n        </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">switch (prop) {</span><span class="s3">\n        </span><span class="s1">case 'then': {</span><span class="s3">\n          </span><span class="s1">const expression =</span><span class="s3">\n            </span><span class="s1">'`await searchParams`, `searchParams.then`, or similar'</span><span class="s3">\n          </span><span class="s1">annotateDynamicAccess(expression, prerenderStore)</span><span class="s3">\n          </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">case 'status': {</span><span class="s3">\n          </span><span class="s1">const expression =</span><span class="s3">\n            </span><span class="s1">'`use(searchParams)`, `searchParams.status`, or similar'</span><span class="s3">\n          </span><span class="s1">annotateDynamicAccess(expression, prerenderStore)</span><span class="s3">\n          </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">default: {</span><span class="s3">\n          </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">CachedSearchParams.set(prerenderStore, proxiedPromise)</span><span class="s3">\n  </span><span class="s1">return proxiedPromise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function makeErroringExoticSearchParams(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStoreLegacy | PrerenderStorePPR</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedSearchParams = CachedSearchParams.get(workStore)</span><span class="s3">\n  </span><span class="s1">if (cachedSearchParams) {</span><span class="s3">\n    </span><span class="s1">return cachedSearchParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const underlyingSearchParams = {}</span><span class="s3">\n  </span><span class="s1">// For search params we don't construct a ReactPromise because we want to interrupt</span><span class="s3">\n  </span><span class="s1">// rendering on any property access that was not set from outside and so we only want</span><span class="s3">\n  </span><span class="s1">// to have properties like value and status if React sets them.</span><span class="s3">\n  </span><span class="s1">const promise = Promise.resolve(underlyingSearchParams)</span><span class="s3">\n\n  </span><span class="s1">const proxiedPromise = new Proxy(promise, {</span><span class="s3">\n    </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n      </span><span class="s1">if (Object.hasOwn(promise, prop)) {</span><span class="s3">\n        </span><span class="s1">// The promise has this property directly. we must return it.</span><span class="s3">\n        </span><span class="s1">// We know it isn't a dynamic access because it can only be something</span><span class="s3">\n        </span><span class="s1">// that was previously written to the promise and thus not an underlying searchParam value</span><span class="s3">\n        </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">switch (prop) {</span><span class="s3">\n        </span><span class="s1">case 'then': {</span><span class="s3">\n          </span><span class="s1">const expression =</span><span class="s3">\n            </span><span class="s1">'`await searchParams`, `searchParams.then`, or similar'</span><span class="s3">\n          </span><span class="s1">if (workStore.dynamicShouldError) {</span><span class="s3">\n            </span><span class="s1">throwWithStaticGenerationBailoutErrorWithDynamicError(</span><span class="s3">\n              </span><span class="s1">workStore.route,</span><span class="s3">\n              </span><span class="s1">expression</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">} else if (prerenderStore.type === 'prerender-ppr') {</span><span class="s3">\n            </span><span class="s1">// PPR Prerender (no cacheComponents)</span><span class="s3">\n            </span><span class="s1">postponeWithTracking(</span><span class="s3">\n              </span><span class="s1">workStore.route,</span><span class="s3">\n              </span><span class="s1">expression,</span><span class="s3">\n              </span><span class="s1">prerenderStore.dynamicTracking</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">// Legacy Prerender</span><span class="s3">\n            </span><span class="s1">throwToInterruptStaticGeneration(</span><span class="s3">\n              </span><span class="s1">expression,</span><span class="s3">\n              </span><span class="s1">workStore,</span><span class="s3">\n              </span><span class="s1">prerenderStore</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">case 'status': {</span><span class="s3">\n          </span><span class="s1">const expression =</span><span class="s3">\n            </span><span class="s1">'`use(searchParams)`, `searchParams.status`, or similar'</span><span class="s3">\n          </span><span class="s1">if (workStore.dynamicShouldError) {</span><span class="s3">\n            </span><span class="s1">throwWithStaticGenerationBailoutErrorWithDynamicError(</span><span class="s3">\n              </span><span class="s1">workStore.route,</span><span class="s3">\n              </span><span class="s1">expression</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">} else if (prerenderStore.type === 'prerender-ppr') {</span><span class="s3">\n            </span><span class="s1">// PPR Prerender (no cacheComponents)</span><span class="s3">\n            </span><span class="s1">postponeWithTracking(</span><span class="s3">\n              </span><span class="s1">workStore.route,</span><span class="s3">\n              </span><span class="s1">expression,</span><span class="s3">\n              </span><span class="s1">prerenderStore.dynamicTracking</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">} else {</span><span class="s3">\n            </span><span class="s1">// Legacy Prerender</span><span class="s3">\n            </span><span class="s1">throwToInterruptStaticGeneration(</span><span class="s3">\n              </span><span class="s1">expression,</span><span class="s3">\n              </span><span class="s1">workStore,</span><span class="s3">\n              </span><span class="s1">prerenderStore</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">return</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">default: {</span><span class="s3">\n          </span><span class="s1">if (typeof prop === 'string' &amp;&amp; !wellKnownProperties.has(prop)) {</span><span class="s3">\n            </span><span class="s1">const expression = describeStringPropertyAccess(</span><span class="s3">\n              </span><span class="s1">'searchParams',</span><span class="s3">\n              </span><span class="s1">prop</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">if (workStore.dynamicShouldError) {</span><span class="s3">\n              </span><span class="s1">throwWithStaticGenerationBailoutErrorWithDynamicError(</span><span class="s3">\n                </span><span class="s1">workStore.route,</span><span class="s3">\n                </span><span class="s1">expression</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">} else if (prerenderStore.type === 'prerender-ppr') {</span><span class="s3">\n              </span><span class="s1">// PPR Prerender (no cacheComponents)</span><span class="s3">\n              </span><span class="s1">postponeWithTracking(</span><span class="s3">\n                </span><span class="s1">workStore.route,</span><span class="s3">\n                </span><span class="s1">expression,</span><span class="s3">\n                </span><span class="s1">prerenderStore.dynamicTracking</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">} else {</span><span class="s3">\n              </span><span class="s1">// Legacy Prerender</span><span class="s3">\n              </span><span class="s1">throwToInterruptStaticGeneration(</span><span class="s3">\n                </span><span class="s1">expression,</span><span class="s3">\n                </span><span class="s1">workStore,</span><span class="s3">\n                </span><span class="s1">prerenderStore</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">has(target, prop) {</span><span class="s3">\n      </span><span class="s1">// We don't expect key checking to be used except for testing the existence of</span><span class="s3">\n      </span><span class="s1">// searchParams so we make all has tests trigger dynamic. this means that `promise.then`</span><span class="s3">\n      </span><span class="s1">// can resolve to the then function on the Promise prototype but 'then' in promise will assume</span><span class="s3">\n      </span><span class="s1">// you are testing whether the searchParams has a 'then' property.</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">const expression = describeHasCheckingStringProperty(</span><span class="s3">\n          </span><span class="s1">'searchParams',</span><span class="s3">\n          </span><span class="s1">prop</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">if (workStore.dynamicShouldError) {</span><span class="s3">\n          </span><span class="s1">throwWithStaticGenerationBailoutErrorWithDynamicError(</span><span class="s3">\n            </span><span class="s1">workStore.route,</span><span class="s3">\n            </span><span class="s1">expression</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">} else if (prerenderStore.type === 'prerender-ppr') {</span><span class="s3">\n          </span><span class="s1">// PPR Prerender (no cacheComponents)</span><span class="s3">\n          </span><span class="s1">postponeWithTracking(</span><span class="s3">\n            </span><span class="s1">workStore.route,</span><span class="s3">\n            </span><span class="s1">expression,</span><span class="s3">\n            </span><span class="s1">prerenderStore.dynamicTracking</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">// Legacy Prerender</span><span class="s3">\n          </span><span class="s1">throwToInterruptStaticGeneration(</span><span class="s3">\n            </span><span class="s1">expression,</span><span class="s3">\n            </span><span class="s1">workStore,</span><span class="s3">\n            </span><span class="s1">prerenderStore</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">return false</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return ReflectAdapter.has(target, prop)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">ownKeys() {</span><span class="s3">\n      </span><span class="s1">const expression =</span><span class="s3">\n        </span><span class="s1">'`{...searchParams}`, `Object.keys(searchParams)`, or similar'</span><span class="s3">\n      </span><span class="s1">if (workStore.dynamicShouldError) {</span><span class="s3">\n        </span><span class="s1">throwWithStaticGenerationBailoutErrorWithDynamicError(</span><span class="s3">\n          </span><span class="s1">workStore.route,</span><span class="s3">\n          </span><span class="s1">expression</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">} else if (prerenderStore.type === 'prerender-ppr') {</span><span class="s3">\n        </span><span class="s1">// PPR Prerender (no cacheComponents)</span><span class="s3">\n        </span><span class="s1">postponeWithTracking(</span><span class="s3">\n          </span><span class="s1">workStore.route,</span><span class="s3">\n          </span><span class="s1">expression,</span><span class="s3">\n          </span><span class="s1">prerenderStore.dynamicTracking</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">// Legacy Prerender</span><span class="s3">\n        </span><span class="s1">throwToInterruptStaticGeneration(expression, workStore, prerenderStore)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">CachedSearchParams.set(workStore, proxiedPromise)</span><span class="s3">\n  </span><span class="s1">return proxiedPromise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This is a variation of `makeErroringExoticSearchParams` that always throws an</span><span class="s3">\n </span><span class="s1">* error on access, because accessing searchParams inside of `</span><span class="s3">\&quot;</span><span class="s1">use cache</span><span class="s3">\&quot;</span><span class="s1">` is</span><span class="s3">\n </span><span class="s1">* not allowed.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function makeErroringSearchParamsForUseCache(</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedSearchParams = CachedSearchParamsForUseCache.get(workStore)</span><span class="s3">\n  </span><span class="s1">if (cachedSearchParams) {</span><span class="s3">\n    </span><span class="s1">return cachedSearchParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const promise = Promise.resolve({})</span><span class="s3">\n\n  </span><span class="s1">const proxiedPromise = new Proxy(promise, {</span><span class="s3">\n    </span><span class="s1">get: function get(target, prop, receiver) {</span><span class="s3">\n      </span><span class="s1">if (Object.hasOwn(promise, prop)) {</span><span class="s3">\n        </span><span class="s1">// The promise has this property directly. we must return it. We know it</span><span class="s3">\n        </span><span class="s1">// isn't a dynamic access because it can only be something that was</span><span class="s3">\n        </span><span class="s1">// previously written to the promise and thus not an underlying</span><span class="s3">\n        </span><span class="s1">// searchParam value</span><span class="s3">\n        </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">typeof prop === 'string' &amp;&amp;</span><span class="s3">\n        </span><span class="s1">(prop === 'then' || !wellKnownProperties.has(prop))</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">throwForSearchParamsAccessInUseCache(workStore, get)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">has: function has(target, prop) {</span><span class="s3">\n      </span><span class="s1">// We don't expect key checking to be used except for testing the existence of</span><span class="s3">\n      </span><span class="s1">// searchParams so we make all has tests throw an error. this means that `promise.then`</span><span class="s3">\n      </span><span class="s1">// can resolve to the then function on the Promise prototype but 'then' in promise will assume</span><span class="s3">\n      </span><span class="s1">// you are testing whether the searchParams has a 'then' property.</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">typeof prop === 'string' &amp;&amp;</span><span class="s3">\n        </span><span class="s1">(prop === 'then' || !wellKnownProperties.has(prop))</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">throwForSearchParamsAccessInUseCache(workStore, has)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return ReflectAdapter.has(target, prop)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">ownKeys: function ownKeys() {</span><span class="s3">\n      </span><span class="s1">throwForSearchParamsAccessInUseCache(workStore, ownKeys)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">CachedSearchParamsForUseCache.set(workStore, proxiedPromise)</span><span class="s3">\n  </span><span class="s1">return proxiedPromise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function makeUntrackedExoticSearchParams(</span><span class="s3">\n  </span><span class="s1">underlyingSearchParams: SearchParams</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedSearchParams = CachedSearchParams.get(underlyingSearchParams)</span><span class="s3">\n  </span><span class="s1">if (cachedSearchParams) {</span><span class="s3">\n    </span><span class="s1">return cachedSearchParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// We don't use makeResolvedReactPromise here because searchParams</span><span class="s3">\n  </span><span class="s1">// supports copying with spread and we don't want to unnecessarily</span><span class="s3">\n  </span><span class="s1">// instrument the promise with spreadable properties of ReactPromise.</span><span class="s3">\n  </span><span class="s1">const promise = Promise.resolve(underlyingSearchParams)</span><span class="s3">\n  </span><span class="s1">CachedSearchParams.set(underlyingSearchParams, promise)</span><span class="s3">\n\n  </span><span class="s1">Object.keys(underlyingSearchParams).forEach((prop) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (!wellKnownProperties.has(prop)) {</span><span class="s3">\n      </span><span class="s1">Object.defineProperty(promise, prop, {</span><span class="s3">\n        </span><span class="s1">get() {</span><span class="s3">\n          </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n          </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n            </span><span class="s1">trackDynamicDataInDynamicRender(workUnitStore)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">return underlyingSearchParams[prop]</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">set(value) {</span><span class="s3">\n          </span><span class="s1">Object.defineProperty(promise, prop, {</span><span class="s3">\n            </span><span class="s1">value,</span><span class="s3">\n            </span><span class="s1">writable: true,</span><span class="s3">\n            </span><span class="s1">enumerable: true,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">enumerable: true,</span><span class="s3">\n        </span><span class="s1">configurable: true,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">return promise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function makeUntrackedSearchParams(</span><span class="s3">\n  </span><span class="s1">underlyingSearchParams: SearchParams</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedSearchParams = CachedSearchParams.get(underlyingSearchParams)</span><span class="s3">\n  </span><span class="s1">if (cachedSearchParams) {</span><span class="s3">\n    </span><span class="s1">return cachedSearchParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const promise = Promise.resolve(underlyingSearchParams)</span><span class="s3">\n  </span><span class="s1">CachedSearchParams.set(underlyingSearchParams, promise)</span><span class="s3">\n\n  </span><span class="s1">return promise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function makeDynamicallyTrackedExoticSearchParamsWithDevWarnings(</span><span class="s3">\n  </span><span class="s1">underlyingSearchParams: SearchParams,</span><span class="s3">\n  </span><span class="s1">store: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedSearchParams = CachedSearchParams.get(underlyingSearchParams)</span><span class="s3">\n  </span><span class="s1">if (cachedSearchParams) {</span><span class="s3">\n    </span><span class="s1">return cachedSearchParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const proxiedProperties = new Set&lt;string&gt;()</span><span class="s3">\n  </span><span class="s1">const unproxiedProperties: Array&lt;string&gt; = []</span><span class="s3">\n\n  </span><span class="s1">// We have an unfortunate sequence of events that requires this initialization logic. We want to instrument the underlying</span><span class="s3">\n  </span><span class="s1">// searchParams object to detect if you are accessing values in dev. This is used for warnings and for things like the static prerender</span><span class="s3">\n  </span><span class="s1">// indicator. However when we pass this proxy to our Promise.resolve() below the VM checks if the resolved value is a promise by looking</span><span class="s3">\n  </span><span class="s1">// at the `.then` property. To our dynamic tracking logic this is indistinguishable from a `then` searchParam and so we would normally trigger</span><span class="s3">\n  </span><span class="s1">// dynamic tracking. However we know that this .then is not real dynamic access, it's just how thenables resolve in sequence. So we introduce</span><span class="s3">\n  </span><span class="s1">// this initialization concept so we omit the dynamic check until after we've constructed our resolved promise.</span><span class="s3">\n  </span><span class="s1">let promiseInitialized = false</span><span class="s3">\n  </span><span class="s1">const proxiedUnderlying = new Proxy(underlyingSearchParams, {</span><span class="s3">\n    </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string' &amp;&amp; promiseInitialized) {</span><span class="s3">\n        </span><span class="s1">if (store.dynamicShouldError) {</span><span class="s3">\n          </span><span class="s1">const expression = describeStringPropertyAccess('searchParams', prop)</span><span class="s3">\n          </span><span class="s1">throwWithStaticGenerationBailoutErrorWithDynamicError(</span><span class="s3">\n            </span><span class="s1">store.route,</span><span class="s3">\n            </span><span class="s1">expression</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n        </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n          </span><span class="s1">trackDynamicDataInDynamicRender(workUnitStore)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">has(target, prop) {</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">if (store.dynamicShouldError) {</span><span class="s3">\n          </span><span class="s1">const expression = describeHasCheckingStringProperty(</span><span class="s3">\n            </span><span class="s1">'searchParams',</span><span class="s3">\n            </span><span class="s1">prop</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">throwWithStaticGenerationBailoutErrorWithDynamicError(</span><span class="s3">\n            </span><span class="s1">store.route,</span><span class="s3">\n            </span><span class="s1">expression</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return Reflect.has(target, prop)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">ownKeys(target) {</span><span class="s3">\n      </span><span class="s1">if (store.dynamicShouldError) {</span><span class="s3">\n        </span><span class="s1">const expression =</span><span class="s3">\n          </span><span class="s1">'`{...searchParams}`, `Object.keys(searchParams)`, or similar'</span><span class="s3">\n        </span><span class="s1">throwWithStaticGenerationBailoutErrorWithDynamicError(</span><span class="s3">\n          </span><span class="s1">store.route,</span><span class="s3">\n          </span><span class="s1">expression</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return Reflect.ownKeys(target)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">// We don't use makeResolvedReactPromise here because searchParams</span><span class="s3">\n  </span><span class="s1">// supports copying with spread and we don't want to unnecessarily</span><span class="s3">\n  </span><span class="s1">// instrument the promise with spreadable properties of ReactPromise.</span><span class="s3">\n  </span><span class="s1">const promise = makeDevtoolsIOAwarePromise(underlyingSearchParams)</span><span class="s3">\n  </span><span class="s1">promise.then(() =&gt; {</span><span class="s3">\n    </span><span class="s1">promiseInitialized = true</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">Object.keys(underlyingSearchParams).forEach((prop) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (wellKnownProperties.has(prop)) {</span><span class="s3">\n      </span><span class="s1">// These properties cannot be shadowed because they need to be the</span><span class="s3">\n      </span><span class="s1">// true underlying value for Promises to work correctly at runtime</span><span class="s3">\n      </span><span class="s1">unproxiedProperties.push(prop)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">proxiedProperties.add(prop)</span><span class="s3">\n      </span><span class="s1">Object.defineProperty(promise, prop, {</span><span class="s3">\n        </span><span class="s1">get() {</span><span class="s3">\n          </span><span class="s1">return proxiedUnderlying[prop]</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">set(newValue) {</span><span class="s3">\n          </span><span class="s1">Object.defineProperty(promise, prop, {</span><span class="s3">\n            </span><span class="s1">value: newValue,</span><span class="s3">\n            </span><span class="s1">writable: true,</span><span class="s3">\n            </span><span class="s1">enumerable: true,</span><span class="s3">\n          </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">enumerable: true,</span><span class="s3">\n        </span><span class="s1">configurable: true,</span><span class="s3">\n      </span><span class="s1">})</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">const proxiedPromise = new Proxy(promise, {</span><span class="s3">\n    </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n      </span><span class="s1">if (prop === 'then' &amp;&amp; store.dynamicShouldError) {</span><span class="s3">\n        </span><span class="s1">const expression = '`searchParams.then`'</span><span class="s3">\n        </span><span class="s1">throwWithStaticGenerationBailoutErrorWithDynamicError(</span><span class="s3">\n          </span><span class="s1">store.route,</span><span class="s3">\n          </span><span class="s1">expression</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">!wellKnownProperties.has(prop) &amp;&amp;</span><span class="s3">\n          </span><span class="s1">(proxiedProperties.has(prop) ||</span><span class="s3">\n            </span><span class="s1">// We are accessing a property that doesn't exist on the promise nor</span><span class="s3">\n            </span><span class="s1">// the underlying searchParams.</span><span class="s3">\n            </span><span class="s1">Reflect.has(target, prop) === false)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">const expression = describeStringPropertyAccess('searchParams', prop)</span><span class="s3">\n          </span><span class="s1">syncIODev(store.route, expression)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">set(target, prop, value, receiver) {</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">proxiedProperties.delete(prop)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return Reflect.set(target, prop, value, receiver)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">has(target, prop) {</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">!wellKnownProperties.has(prop) &amp;&amp;</span><span class="s3">\n          </span><span class="s1">(proxiedProperties.has(prop) ||</span><span class="s3">\n            </span><span class="s1">// We are accessing a property that doesn't exist on the promise nor</span><span class="s3">\n            </span><span class="s1">// the underlying searchParams.</span><span class="s3">\n            </span><span class="s1">Reflect.has(target, prop) === false)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">const expression = describeHasCheckingStringProperty(</span><span class="s3">\n            </span><span class="s1">'searchParams',</span><span class="s3">\n            </span><span class="s1">prop</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">syncIODev(store.route, expression)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return Reflect.has(target, prop)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">ownKeys(target) {</span><span class="s3">\n      </span><span class="s1">const expression = '`Object.keys(searchParams)` or similar'</span><span class="s3">\n      </span><span class="s1">syncIODev(store.route, expression, unproxiedProperties)</span><span class="s3">\n      </span><span class="s1">return Reflect.ownKeys(target)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">CachedSearchParams.set(underlyingSearchParams, proxiedPromise)</span><span class="s3">\n  </span><span class="s1">return proxiedPromise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Similar to `makeDynamicallyTrackedExoticSearchParamsWithDevWarnings`, but</span><span class="s3">\n</span><span class="s1">// just logging the sync access without actually defining the search params on</span><span class="s3">\n</span><span class="s1">// the promise.</span><span class="s3">\n</span><span class="s1">function makeUntrackedSearchParamsWithDevWarnings(</span><span class="s3">\n  </span><span class="s1">underlyingSearchParams: SearchParams,</span><span class="s3">\n  </span><span class="s1">store: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;SearchParams&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedSearchParams = CachedSearchParams.get(underlyingSearchParams)</span><span class="s3">\n  </span><span class="s1">if (cachedSearchParams) {</span><span class="s3">\n    </span><span class="s1">return cachedSearchParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const proxiedProperties = new Set&lt;string&gt;()</span><span class="s3">\n  </span><span class="s1">const unproxiedProperties: Array&lt;string&gt; = []</span><span class="s3">\n  </span><span class="s1">const promise = makeDevtoolsIOAwarePromise(underlyingSearchParams)</span><span class="s3">\n\n  </span><span class="s1">Object.keys(underlyingSearchParams).forEach((prop) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (wellKnownProperties.has(prop)) {</span><span class="s3">\n      </span><span class="s1">// These properties cannot be shadowed because they need to be the</span><span class="s3">\n      </span><span class="s1">// true underlying value for Promises to work correctly at runtime</span><span class="s3">\n      </span><span class="s1">unproxiedProperties.push(prop)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">proxiedProperties.add(prop)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">const proxiedPromise = new Proxy(promise, {</span><span class="s3">\n    </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">!wellKnownProperties.has(prop) &amp;&amp;</span><span class="s3">\n          </span><span class="s1">(proxiedProperties.has(prop) ||</span><span class="s3">\n            </span><span class="s1">// We are accessing a property that doesn't exist on the promise nor</span><span class="s3">\n            </span><span class="s1">// the underlying searchParams.</span><span class="s3">\n            </span><span class="s1">Reflect.has(target, prop) === false)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">const expression = describeStringPropertyAccess('searchParams', prop)</span><span class="s3">\n          </span><span class="s1">warnForSyncAccess(store.route, expression)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">set(target, prop, value, receiver) {</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">proxiedProperties.delete(prop)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return Reflect.set(target, prop, value, receiver)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">has(target, prop) {</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">!wellKnownProperties.has(prop) &amp;&amp;</span><span class="s3">\n          </span><span class="s1">(proxiedProperties.has(prop) ||</span><span class="s3">\n            </span><span class="s1">// We are accessing a property that doesn't exist on the promise nor</span><span class="s3">\n            </span><span class="s1">// the underlying searchParams.</span><span class="s3">\n            </span><span class="s1">Reflect.has(target, prop) === false)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">const expression = describeHasCheckingStringProperty(</span><span class="s3">\n            </span><span class="s1">'searchParams',</span><span class="s3">\n            </span><span class="s1">prop</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">warnForSyncAccess(store.route, expression)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return Reflect.has(target, prop)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">ownKeys(target) {</span><span class="s3">\n      </span><span class="s1">const expression = '`Object.keys(searchParams)` or similar'</span><span class="s3">\n      </span><span class="s1">warnForIncompleteEnumeration(store.route, expression, unproxiedProperties)</span><span class="s3">\n      </span><span class="s1">return Reflect.ownKeys(target)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">CachedSearchParams.set(underlyingSearchParams, proxiedPromise)</span><span class="s3">\n  </span><span class="s1">return proxiedPromise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function syncIODev(</span><span class="s3">\n  </span><span class="s1">route: string | undefined,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">missingProperties?: Array&lt;string&gt;</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">// In all cases we warn normally</span><span class="s3">\n  </span><span class="s1">if (missingProperties &amp;&amp; missingProperties.length &gt; 0) {</span><span class="s3">\n    </span><span class="s1">warnForIncompleteEnumeration(route, expression, missingProperties)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">warnForSyncAccess(route, expression)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">if (workUnitStore.prerenderPhase === true) {</span><span class="s3">\n          </span><span class="s1">// When we're rendering dynamically in dev, we need to advance out of</span><span class="s3">\n          </span><span class="s1">// the Prerender environment when we read Request data synchronously.</span><span class="s3">\n          </span><span class="s1">trackSynchronousRequestDataAccessInDev(workUnitStore)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">case 'prerender':</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const warnForSyncAccess = createDedupedByCallsiteServerErrorLoggerDev(</span><span class="s3">\n  </span><span class="s1">createSearchAccessError</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n\n</span><span class="s1">const warnForIncompleteEnumeration =</span><span class="s3">\n  </span><span class="s1">createDedupedByCallsiteServerErrorLoggerDev(createIncompleteEnumerationError)</span><span class="s3">\n\n</span><span class="s1">function createSearchAccessError(</span><span class="s3">\n  </span><span class="s1">route: string | undefined,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const prefix = route ? `Route </span><span class="s3">\&quot;</span><span class="s1">${route}</span><span class="s3">\&quot; </span><span class="s1">` : 'This route '</span><span class="s3">\n  </span><span class="s1">return new Error(</span><span class="s3">\n    </span><span class="s1">`${prefix}used ${expression}. ` +</span><span class="s3">\n      </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`searchParams</span><span class="s3">\\</span><span class="s1">` should be awaited before using its properties. ` +</span><span class="s3">\n      </span><span class="s1">`Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createIncompleteEnumerationError(</span><span class="s3">\n  </span><span class="s1">route: string | undefined,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">missingProperties: Array&lt;string&gt;</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const prefix = route ? `Route </span><span class="s3">\&quot;</span><span class="s1">${route}</span><span class="s3">\&quot; </span><span class="s1">` : 'This route '</span><span class="s3">\n  </span><span class="s1">return new Error(</span><span class="s3">\n    </span><span class="s1">`${prefix}used ${expression}. ` +</span><span class="s3">\n      </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`searchParams</span><span class="s3">\\</span><span class="s1">` should be awaited before using its properties. ` +</span><span class="s3">\n      </span><span class="s1">`The following properties were not available through enumeration ` +</span><span class="s3">\n      </span><span class="s1">`because they conflict with builtin or well-known property names: ` +</span><span class="s3">\n      </span><span class="s1">`${describeListOfPropertyNames(missingProperties)}. ` +</span><span class="s3">\n      </span><span class="s1">`Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function describeListOfPropertyNames(properties: Array&lt;string&gt;) {</span><span class="s3">\n  </span><span class="s1">switch (properties.length) {</span><span class="s3">\n    </span><span class="s1">case 0:</span><span class="s3">\n      </span><span class="s1">throw new InvariantError(</span><span class="s3">\n        </span><span class="s1">'Expected describeListOfPropertyNames to be called with a non-empty list of strings.'</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">case 1:</span><span class="s3">\n      </span><span class="s1">return `</span><span class="s3">\\</span><span class="s1">`${properties[0]}</span><span class="s3">\\</span><span class="s1">``</span><span class="s3">\n    </span><span class="s1">case 2:</span><span class="s3">\n      </span><span class="s1">return `</span><span class="s3">\\</span><span class="s1">`${properties[0]}</span><span class="s3">\\</span><span class="s1">` and </span><span class="s3">\\</span><span class="s1">`${properties[1]}</span><span class="s3">\\</span><span class="s1">``</span><span class="s3">\n    </span><span class="s1">default: {</span><span class="s3">\n      </span><span class="s1">let description = ''</span><span class="s3">\n      </span><span class="s1">for (let i = 0; i &lt; properties.length - 1; i++) {</span><span class="s3">\n        </span><span class="s1">description += `</span><span class="s3">\\</span><span class="s1">`${properties[i]}</span><span class="s3">\\</span><span class="s1">`, `</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">description += `, and </span><span class="s3">\\</span><span class="s1">`${properties[properties.length - 1]}</span><span class="s3">\\</span><span class="s1">``</span><span class="s3">\n      </span><span class="s1">return description</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;ReflectAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;throwToInterruptStaticGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;postponeWithTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;trackDynamicDataInDynamicRender&quot;</span><span class="s0">,</span><span class="s1">&quot;annotateDynamicAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;trackSynchronousRequestDataAccessInDev&quot;</span><span class="s0">,</span><span class="s1">&quot;delayUntilRuntimeStage&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;throwInvariantForMissingStore&quot;</span><span class="s0">,</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;makeDevtoolsIOAwarePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;createDedupedByCallsiteServerErrorLoggerDev&quot;</span><span class="s0">,</span><span class="s1">&quot;describeStringPropertyAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;describeHasCheckingStringProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;wellKnownProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;throwWithStaticGenerationBailoutErrorWithDynamicError&quot;</span><span class="s0">,</span><span class="s1">&quot;throwForSearchParamsAccessInUseCache&quot;</span><span class="s0">,</span><span class="s1">&quot;createSearchParamsFromClient&quot;</span><span class="s0">,</span><span class="s1">&quot;underlyingSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitStore&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;createStaticPrerenderSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;createRenderSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;createServerSearchParamsForMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;createServerSearchParamsForServerPage&quot;</span><span class="s0">,</span><span class="s1">&quot;createRuntimePrerenderSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;createPrerenderSearchParamsForClientPage&quot;</span><span class="s0">,</span><span class="s1">&quot;forceStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;renderSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderStore&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;makeErroringExoticSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_CACHE_COMPONENTS&quot;</span><span class="s0">,</span><span class="s1">&quot;makeUntrackedSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;makeUntrackedExoticSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;makeUntrackedSearchParamsWithDevWarnings&quot;</span><span class="s0">,</span><span class="s1">&quot;makeDynamicallyTrackedExoticSearchParamsWithDevWarnings&quot;</span><span class="s0">,</span><span class="s1">&quot;CachedSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;WeakMap&quot;</span><span class="s0">,</span><span class="s1">&quot;CachedSearchParamsForUseCache&quot;</span><span class="s0">,</span><span class="s1">&quot;cachedSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;proxiedPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;Proxy&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;receiver&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;hasOwn&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicShouldError&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;ownKeys&quot;</span><span class="s0">,</span><span class="s1">&quot;makeErroringSearchParamsForUseCache&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;defineProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;writable&quot;</span><span class="s0">,</span><span class="s1">&quot;enumerable&quot;</span><span class="s0">,</span><span class="s1">&quot;configurable&quot;</span><span class="s0">,</span><span class="s1">&quot;store&quot;</span><span class="s0">,</span><span class="s1">&quot;proxiedProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;unproxiedProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;promiseInitialized&quot;</span><span class="s0">,</span><span class="s1">&quot;proxiedUnderlying&quot;</span><span class="s0">,</span><span class="s1">&quot;Reflect&quot;</span><span class="s0">,</span><span class="s1">&quot;then&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;newValue&quot;</span><span class="s0">,</span><span class="s1">&quot;syncIODev&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;warnForSyncAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;warnForIncompleteEnumeration&quot;</span><span class="s0">,</span><span class="s1">&quot;missingProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderPhase&quot;</span><span class="s0">,</span><span class="s1">&quot;createSearchAccessError&quot;</span><span class="s0">,</span><span class="s1">&quot;createIncompleteEnumerationError&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;describeListOfPropertyNames&quot;</span><span class="s0">,</span><span class="s1">&quot;properties&quot;</span><span class="s0">,</span><span class="s1">&quot;description&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">4784</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/server/request/params.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">workAsyncStorage,</span><span class="s3">\n  </span><span class="s1">type WorkStore,</span><span class="s3">\n</span><span class="s1">} from '../app-render/work-async-storage.external'</span><span class="s3">\n</span><span class="s1">import type { FallbackRouteParams } from './fallback-params'</span><span class="s3">\n\n</span><span class="s1">import { ReflectAdapter } from '../web/spec-extension/adapters/reflect'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">throwToInterruptStaticGeneration,</span><span class="s3">\n  </span><span class="s1">postponeWithTracking,</span><span class="s3">\n  </span><span class="s1">trackSynchronousRequestDataAccessInDev,</span><span class="s3">\n  </span><span class="s1">delayUntilRuntimeStage,</span><span class="s3">\n</span><span class="s1">} from '../app-render/dynamic-rendering'</span><span class="s3">\n\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">workUnitAsyncStorage,</span><span class="s3">\n  </span><span class="s1">type PrerenderStorePPR,</span><span class="s3">\n  </span><span class="s1">type PrerenderStoreLegacy,</span><span class="s3">\n  </span><span class="s1">type StaticPrerenderStoreModern,</span><span class="s3">\n  </span><span class="s1">type StaticPrerenderStore,</span><span class="s3">\n  </span><span class="s1">throwInvariantForMissingStore,</span><span class="s3">\n  </span><span class="s1">type PrerenderStoreModernRuntime,</span><span class="s3">\n</span><span class="s1">} from '../app-render/work-unit-async-storage.external'</span><span class="s3">\n</span><span class="s1">import { InvariantError } from '../../shared/lib/invariant-error'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">describeStringPropertyAccess,</span><span class="s3">\n  </span><span class="s1">wellKnownProperties,</span><span class="s3">\n</span><span class="s1">} from '../../shared/lib/utils/reflect-utils'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">makeDevtoolsIOAwarePromise,</span><span class="s3">\n  </span><span class="s1">makeHangingPromise,</span><span class="s3">\n</span><span class="s1">} from '../dynamic-rendering-utils'</span><span class="s3">\n</span><span class="s1">import { createDedupedByCallsiteServerErrorLoggerDev } from '../create-deduped-by-callsite-server-error-logger'</span><span class="s3">\n</span><span class="s1">import { dynamicAccessAsyncStorage } from '../app-render/dynamic-access-async-storage.external'</span><span class="s3">\n\n</span><span class="s1">export type ParamValue = string | Array&lt;string&gt; | undefined</span><span class="s3">\n</span><span class="s1">export type Params = Record&lt;string, ParamValue&gt;</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* In this version of Next.js the `params` prop passed to Layouts, Pages, and other Segments is a Promise.</span><span class="s3">\n </span><span class="s1">* However to facilitate migration to this new Promise type you can currently still access params directly on the Promise instance passed to these Segments.</span><span class="s3">\n </span><span class="s1">* The `UnsafeUnwrappedParams` type is available if you need to temporarily access the underlying params without first awaiting or `use`ing the Promise.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* In a future version of Next.js the `params` prop will be a plain Promise and this type will be removed.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Typically instances of `params` can be updated automatically to be treated as a Promise by a codemod published alongside this Next.js version however if you</span><span class="s3">\n </span><span class="s1">* have not yet run the codemod of the codemod cannot detect certain instances of `params` usage you should first try to refactor your code to await `params`.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* If refactoring is not possible but you still want to be able to access params directly without typescript errors you can cast the params Promise to this type</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* ```tsx</span><span class="s3">\n </span><span class="s1">* type Props = { params: Promise&lt;{ id: string }&gt;}</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* export default async function Layout(props: Props) {</span><span class="s3">\n </span><span class="s1">*  const directParams = (props.params as unknown as UnsafeUnwrappedParams&lt;typeof props.params&gt;)</span><span class="s3">\n </span><span class="s1">*  return ...</span><span class="s3">\n </span><span class="s1">* }</span><span class="s3">\n </span><span class="s1">* ```</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This type is marked deprecated to help identify it as target for refactoring away.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @deprecated</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export type UnsafeUnwrappedParams&lt;P&gt; =</span><span class="s3">\n  </span><span class="s1">P extends Promise&lt;infer U&gt; ? Omit&lt;U, 'then' | 'status' | 'value'&gt; : never</span><span class="s3">\n\n</span><span class="s1">export function createParamsFromClient(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender':</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n        </span><span class="s1">return createStaticPrerenderParams(</span><span class="s3">\n          </span><span class="s1">underlyingParams,</span><span class="s3">\n          </span><span class="s1">workStore,</span><span class="s3">\n          </span><span class="s1">workUnitStore</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">'createParamsFromClient should not be called in cache contexts.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">'createParamsFromClient should not be called in a runtime prerender.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n          </span><span class="s1">// Semantically we only need the dev tracking when running in `next dev`</span><span class="s3">\n          </span><span class="s1">// but since you would never use next dev with production NODE_ENV we use this</span><span class="s3">\n          </span><span class="s1">// as a proxy so we can statically exclude this code from production builds.</span><span class="s3">\n          </span><span class="s1">const devFallbackParams = workUnitStore.devFallbackParams</span><span class="s3">\n          </span><span class="s1">return createRenderParamsInDev(</span><span class="s3">\n            </span><span class="s1">underlyingParams,</span><span class="s3">\n            </span><span class="s1">devFallbackParams,</span><span class="s3">\n            </span><span class="s1">workStore</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">return createRenderParamsInProd(underlyingParams)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">throwInvariantForMissingStore()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// generateMetadata always runs in RSC context so it is equivalent to a Server Page Component</span><span class="s3">\n</span><span class="s1">export type CreateServerParamsForMetadata = typeof createServerParamsForMetadata</span><span class="s3">\n</span><span class="s1">export const createServerParamsForMetadata = createServerParamsForServerSegment</span><span class="s3">\n\n</span><span class="s1">// routes always runs in RSC context so it is equivalent to a Server Page Component</span><span class="s3">\n</span><span class="s1">export function createServerParamsForRoute(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender':</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n        </span><span class="s1">return createStaticPrerenderParams(</span><span class="s3">\n          </span><span class="s1">underlyingParams,</span><span class="s3">\n          </span><span class="s1">workStore,</span><span class="s3">\n          </span><span class="s1">workUnitStore</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">'createServerParamsForRoute should not be called in cache contexts.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n        </span><span class="s1">return createRuntimePrerenderParams(underlyingParams, workUnitStore)</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n          </span><span class="s1">// Semantically we only need the dev tracking when running in `next dev`</span><span class="s3">\n          </span><span class="s1">// but since you would never use next dev with production NODE_ENV we use this</span><span class="s3">\n          </span><span class="s1">// as a proxy so we can statically exclude this code from production builds.</span><span class="s3">\n          </span><span class="s1">const devFallbackParams = workUnitStore.devFallbackParams</span><span class="s3">\n          </span><span class="s1">return createRenderParamsInDev(</span><span class="s3">\n            </span><span class="s1">underlyingParams,</span><span class="s3">\n            </span><span class="s1">devFallbackParams,</span><span class="s3">\n            </span><span class="s1">workStore</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">return createRenderParamsInProd(underlyingParams)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">throwInvariantForMissingStore()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createServerParamsForServerSegment(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender':</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n        </span><span class="s1">return createStaticPrerenderParams(</span><span class="s3">\n          </span><span class="s1">underlyingParams,</span><span class="s3">\n          </span><span class="s1">workStore,</span><span class="s3">\n          </span><span class="s1">workUnitStore</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">'createServerParamsForServerSegment should not be called in cache contexts.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n        </span><span class="s1">return createRuntimePrerenderParams(underlyingParams, workUnitStore)</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">if (process.env.NODE_ENV === 'development') {</span><span class="s3">\n          </span><span class="s1">// Semantically we only need the dev tracking when running in `next dev`</span><span class="s3">\n          </span><span class="s1">// but since you would never use next dev with production NODE_ENV we use this</span><span class="s3">\n          </span><span class="s1">// as a proxy so we can statically exclude this code from production builds.</span><span class="s3">\n          </span><span class="s1">const devFallbackParams = workUnitStore.devFallbackParams</span><span class="s3">\n          </span><span class="s1">return createRenderParamsInDev(</span><span class="s3">\n            </span><span class="s1">underlyingParams,</span><span class="s3">\n            </span><span class="s1">devFallbackParams,</span><span class="s3">\n            </span><span class="s1">workStore</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">return createRenderParamsInProd(underlyingParams)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">throwInvariantForMissingStore()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function createPrerenderParamsForClientSegment(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">const workStore = workAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (!workStore) {</span><span class="s3">\n    </span><span class="s1">throw new InvariantError(</span><span class="s3">\n      </span><span class="s1">'Missing workStore in createPrerenderParamsForClientSegment'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'prerender':</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n        </span><span class="s1">const fallbackParams = workUnitStore.fallbackRouteParams</span><span class="s3">\n        </span><span class="s1">if (fallbackParams) {</span><span class="s3">\n          </span><span class="s1">for (let key in underlyingParams) {</span><span class="s3">\n            </span><span class="s1">if (fallbackParams.has(key)) {</span><span class="s3">\n              </span><span class="s1">// This params object has one or more fallback params, so we need</span><span class="s3">\n              </span><span class="s1">// to consider the awaiting of this params object </span><span class="s3">\&quot;</span><span class="s1">dynamic</span><span class="s3">\&quot;</span><span class="s1">. Since</span><span class="s3">\n              </span><span class="s1">// we are in cacheComponents mode we encode this as a promise that never</span><span class="s3">\n              </span><span class="s1">// resolves.</span><span class="s3">\n              </span><span class="s1">return makeHangingPromise(</span><span class="s3">\n                </span><span class="s1">workUnitStore.renderSignal,</span><span class="s3">\n                </span><span class="s1">workStore.route,</span><span class="s3">\n                </span><span class="s1">'`params`'</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">throw new InvariantError(</span><span class="s3">\n          </span><span class="s1">'createPrerenderParamsForClientSegment should not be called in cache contexts.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">// We're prerendering in a mode that does not abort. We resolve the promise without</span><span class="s3">\n  </span><span class="s1">// any tracking because we're just transporting a value from server to client where the tracking</span><span class="s3">\n  </span><span class="s1">// will be applied.</span><span class="s3">\n  </span><span class="s1">return Promise.resolve(underlyingParams)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createStaticPrerenderParams(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: StaticPrerenderStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">switch (prerenderStore.type) {</span><span class="s3">\n    </span><span class="s1">case 'prerender':</span><span class="s3">\n    </span><span class="s1">case 'prerender-client': {</span><span class="s3">\n      </span><span class="s1">const fallbackParams = prerenderStore.fallbackRouteParams</span><span class="s3">\n      </span><span class="s1">if (fallbackParams) {</span><span class="s3">\n        </span><span class="s1">for (const key in underlyingParams) {</span><span class="s3">\n          </span><span class="s1">if (fallbackParams.has(key)) {</span><span class="s3">\n            </span><span class="s1">// This params object has one or more fallback params, so we need</span><span class="s3">\n            </span><span class="s1">// to consider the awaiting of this params object </span><span class="s3">\&quot;</span><span class="s1">dynamic</span><span class="s3">\&quot;</span><span class="s1">. Since</span><span class="s3">\n            </span><span class="s1">// we are in cacheComponents mode we encode this as a promise that never</span><span class="s3">\n            </span><span class="s1">// resolves.</span><span class="s3">\n            </span><span class="s1">return makeHangingParams(</span><span class="s3">\n              </span><span class="s1">underlyingParams,</span><span class="s3">\n              </span><span class="s1">workStore,</span><span class="s3">\n              </span><span class="s1">prerenderStore</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'prerender-ppr': {</span><span class="s3">\n      </span><span class="s1">const fallbackParams = prerenderStore.fallbackRouteParams</span><span class="s3">\n      </span><span class="s1">if (fallbackParams) {</span><span class="s3">\n        </span><span class="s1">for (const key in underlyingParams) {</span><span class="s3">\n          </span><span class="s1">if (fallbackParams.has(key)) {</span><span class="s3">\n            </span><span class="s1">return makeErroringExoticParams(</span><span class="s3">\n              </span><span class="s1">underlyingParams,</span><span class="s3">\n              </span><span class="s1">fallbackParams,</span><span class="s3">\n              </span><span class="s1">workStore,</span><span class="s3">\n              </span><span class="s1">prerenderStore</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">break</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">prerenderStore satisfies never</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (process.env.__NEXT_CACHE_COMPONENTS) {</span><span class="s3">\n    </span><span class="s1">return makeUntrackedParams(underlyingParams)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">return makeUntrackedExoticParams(underlyingParams)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createRuntimePrerenderParams(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">workUnitStore: PrerenderStoreModernRuntime</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">return delayUntilRuntimeStage(</span><span class="s3">\n    </span><span class="s1">workUnitStore,</span><span class="s3">\n    </span><span class="s1">process.env.__NEXT_CACHE_COMPONENTS</span><span class="s3">\n      </span><span class="s1">? makeUntrackedParams(underlyingParams)</span><span class="s3">\n      </span><span class="s1">: makeUntrackedExoticParams(underlyingParams)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createRenderParamsInProd(underlyingParams: Params): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">if (process.env.__NEXT_CACHE_COMPONENTS) {</span><span class="s3">\n    </span><span class="s1">return makeUntrackedParams(underlyingParams)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return makeUntrackedExoticParams(underlyingParams)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createRenderParamsInDev(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">devFallbackParams: FallbackRouteParams | null | undefined,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">let hasFallbackParams = false</span><span class="s3">\n  </span><span class="s1">if (devFallbackParams) {</span><span class="s3">\n    </span><span class="s1">for (let key in underlyingParams) {</span><span class="s3">\n      </span><span class="s1">if (devFallbackParams.has(key)) {</span><span class="s3">\n        </span><span class="s1">hasFallbackParams = true</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (process.env.__NEXT_CACHE_COMPONENTS) {</span><span class="s3">\n    </span><span class="s1">return makeDynamicallyTrackedParamsWithDevWarnings(</span><span class="s3">\n      </span><span class="s1">underlyingParams,</span><span class="s3">\n      </span><span class="s1">hasFallbackParams,</span><span class="s3">\n      </span><span class="s1">workStore</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return makeDynamicallyTrackedExoticParamsWithDevWarnings(</span><span class="s3">\n    </span><span class="s1">underlyingParams,</span><span class="s3">\n    </span><span class="s1">hasFallbackParams,</span><span class="s3">\n    </span><span class="s1">workStore</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">interface CacheLifetime {}</span><span class="s3">\n</span><span class="s1">const CachedParams = new WeakMap&lt;CacheLifetime, Promise&lt;Params&gt;&gt;()</span><span class="s3">\n\n</span><span class="s1">const fallbackParamsProxyHandler: ProxyHandler&lt;Promise&lt;Params&gt;&gt; = {</span><span class="s3">\n  </span><span class="s1">get: function get(target, prop, receiver) {</span><span class="s3">\n    </span><span class="s1">if (prop === 'then' || prop === 'catch' || prop === 'finally') {</span><span class="s3">\n      </span><span class="s1">const originalMethod = ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n\n      </span><span class="s1">return {</span><span class="s3">\n        </span><span class="s1">[prop]: (...args: unknown[]) =&gt; {</span><span class="s3">\n          </span><span class="s1">const store = dynamicAccessAsyncStorage.getStore()</span><span class="s3">\n\n          </span><span class="s1">if (store) {</span><span class="s3">\n            </span><span class="s1">store.abortController.abort(</span><span class="s3">\n              </span><span class="s1">new Error(`Accessed fallback </span><span class="s3">\\</span><span class="s1">`params</span><span class="s3">\\</span><span class="s1">` during prerendering.`)</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n\n          </span><span class="s1">return new Proxy(</span><span class="s3">\n            </span><span class="s1">originalMethod.apply(target, args),</span><span class="s3">\n            </span><span class="s1">fallbackParamsProxyHandler</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">}[prop]</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function makeHangingParams(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: StaticPrerenderStoreModern</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedParams = CachedParams.get(underlyingParams)</span><span class="s3">\n  </span><span class="s1">if (cachedParams) {</span><span class="s3">\n    </span><span class="s1">return cachedParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const promise = new Proxy(</span><span class="s3">\n    </span><span class="s1">makeHangingPromise&lt;Params&gt;(</span><span class="s3">\n      </span><span class="s1">prerenderStore.renderSignal,</span><span class="s3">\n      </span><span class="s1">workStore.route,</span><span class="s3">\n      </span><span class="s1">'`params`'</span><span class="s3">\n    </span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">fallbackParamsProxyHandler</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">CachedParams.set(underlyingParams, promise)</span><span class="s3">\n\n  </span><span class="s1">return promise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function makeErroringExoticParams(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">fallbackParams: FallbackRouteParams,</span><span class="s3">\n  </span><span class="s1">workStore: WorkStore,</span><span class="s3">\n  </span><span class="s1">prerenderStore: PrerenderStorePPR | PrerenderStoreLegacy</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedParams = CachedParams.get(underlyingParams)</span><span class="s3">\n  </span><span class="s1">if (cachedParams) {</span><span class="s3">\n    </span><span class="s1">return cachedParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const augmentedUnderlying = { ...underlyingParams }</span><span class="s3">\n\n  </span><span class="s1">// We don't use makeResolvedReactPromise here because params</span><span class="s3">\n  </span><span class="s1">// supports copying with spread and we don't want to unnecessarily</span><span class="s3">\n  </span><span class="s1">// instrument the promise with spreadable properties of ReactPromise.</span><span class="s3">\n  </span><span class="s1">const promise = Promise.resolve(augmentedUnderlying)</span><span class="s3">\n  </span><span class="s1">CachedParams.set(underlyingParams, promise)</span><span class="s3">\n\n  </span><span class="s1">Object.keys(underlyingParams).forEach((prop) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (wellKnownProperties.has(prop)) {</span><span class="s3">\n      </span><span class="s1">// These properties cannot be shadowed because they need to be the</span><span class="s3">\n      </span><span class="s1">// true underlying value for Promises to work correctly at runtime</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if (fallbackParams.has(prop)) {</span><span class="s3">\n        </span><span class="s1">Object.defineProperty(augmentedUnderlying, prop, {</span><span class="s3">\n          </span><span class="s1">get() {</span><span class="s3">\n            </span><span class="s1">const expression = describeStringPropertyAccess('params', prop)</span><span class="s3">\n            </span><span class="s1">// In most dynamic APIs we also throw if `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">` however</span><span class="s3">\n            </span><span class="s1">// for params is only dynamic when we're generating a fallback shell</span><span class="s3">\n            </span><span class="s1">// and even when `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">` we still support generating dynamic</span><span class="s3">\n            </span><span class="s1">// fallback shells</span><span class="s3">\n            </span><span class="s1">// TODO remove this comment when cacheComponents is the default since there</span><span class="s3">\n            </span><span class="s1">// will be no `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">`</span><span class="s3">\n            </span><span class="s1">if (prerenderStore.type === 'prerender-ppr') {</span><span class="s3">\n              </span><span class="s1">// PPR Prerender (no cacheComponents)</span><span class="s3">\n              </span><span class="s1">postponeWithTracking(</span><span class="s3">\n                </span><span class="s1">workStore.route,</span><span class="s3">\n                </span><span class="s1">expression,</span><span class="s3">\n                </span><span class="s1">prerenderStore.dynamicTracking</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">} else {</span><span class="s3">\n              </span><span class="s1">// Legacy Prerender</span><span class="s3">\n              </span><span class="s1">throwToInterruptStaticGeneration(</span><span class="s3">\n                </span><span class="s1">expression,</span><span class="s3">\n                </span><span class="s1">workStore,</span><span class="s3">\n                </span><span class="s1">prerenderStore</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">enumerable: true,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n        </span><span class="s1">Object.defineProperty(promise, prop, {</span><span class="s3">\n          </span><span class="s1">get() {</span><span class="s3">\n            </span><span class="s1">const expression = describeStringPropertyAccess('params', prop)</span><span class="s3">\n            </span><span class="s1">// In most dynamic APIs we also throw if `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">` however</span><span class="s3">\n            </span><span class="s1">// for params is only dynamic when we're generating a fallback shell</span><span class="s3">\n            </span><span class="s1">// and even when `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">` we still support generating dynamic</span><span class="s3">\n            </span><span class="s1">// fallback shells</span><span class="s3">\n            </span><span class="s1">// TODO remove this comment when cacheComponents is the default since there</span><span class="s3">\n            </span><span class="s1">// will be no `dynamic = </span><span class="s3">\&quot;</span><span class="s1">error</span><span class="s3">\&quot;</span><span class="s1">`</span><span class="s3">\n            </span><span class="s1">if (prerenderStore.type === 'prerender-ppr') {</span><span class="s3">\n              </span><span class="s1">// PPR Prerender (no cacheComponents)</span><span class="s3">\n              </span><span class="s1">postponeWithTracking(</span><span class="s3">\n                </span><span class="s1">workStore.route,</span><span class="s3">\n                </span><span class="s1">expression,</span><span class="s3">\n                </span><span class="s1">prerenderStore.dynamicTracking</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">} else {</span><span class="s3">\n              </span><span class="s1">// Legacy Prerender</span><span class="s3">\n              </span><span class="s1">throwToInterruptStaticGeneration(</span><span class="s3">\n                </span><span class="s1">expression,</span><span class="s3">\n                </span><span class="s1">workStore,</span><span class="s3">\n                </span><span class="s1">prerenderStore</span><span class="s3">\n              </span><span class="s1">)</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">set(newValue) {</span><span class="s3">\n            </span><span class="s1">Object.defineProperty(promise, prop, {</span><span class="s3">\n              </span><span class="s1">value: newValue,</span><span class="s3">\n              </span><span class="s1">writable: true,</span><span class="s3">\n              </span><span class="s1">enumerable: true,</span><span class="s3">\n            </span><span class="s1">})</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">enumerable: true,</span><span class="s3">\n          </span><span class="s1">configurable: true,</span><span class="s3">\n        </span><span class="s1">})</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">;(promise as any)[prop] = underlyingParams[prop]</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">return promise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function makeUntrackedExoticParams(underlyingParams: Params): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedParams = CachedParams.get(underlyingParams)</span><span class="s3">\n  </span><span class="s1">if (cachedParams) {</span><span class="s3">\n    </span><span class="s1">return cachedParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// We don't use makeResolvedReactPromise here because params</span><span class="s3">\n  </span><span class="s1">// supports copying with spread and we don't want to unnecessarily</span><span class="s3">\n  </span><span class="s1">// instrument the promise with spreadable properties of ReactPromise.</span><span class="s3">\n  </span><span class="s1">const promise = Promise.resolve(underlyingParams)</span><span class="s3">\n  </span><span class="s1">CachedParams.set(underlyingParams, promise)</span><span class="s3">\n\n  </span><span class="s1">Object.keys(underlyingParams).forEach((prop) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (wellKnownProperties.has(prop)) {</span><span class="s3">\n      </span><span class="s1">// These properties cannot be shadowed because they need to be the</span><span class="s3">\n      </span><span class="s1">// true underlying value for Promises to work correctly at runtime</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">;(promise as any)[prop] = underlyingParams[prop]</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">return promise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function makeUntrackedParams(underlyingParams: Params): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedParams = CachedParams.get(underlyingParams)</span><span class="s3">\n  </span><span class="s1">if (cachedParams) {</span><span class="s3">\n    </span><span class="s1">return cachedParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const promise = Promise.resolve(underlyingParams)</span><span class="s3">\n  </span><span class="s1">CachedParams.set(underlyingParams, promise)</span><span class="s3">\n\n  </span><span class="s1">return promise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function makeDynamicallyTrackedExoticParamsWithDevWarnings(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">hasFallbackParams: boolean,</span><span class="s3">\n  </span><span class="s1">store: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedParams = CachedParams.get(underlyingParams)</span><span class="s3">\n  </span><span class="s1">if (cachedParams) {</span><span class="s3">\n    </span><span class="s1">return cachedParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// We don't use makeResolvedReactPromise here because params</span><span class="s3">\n  </span><span class="s1">// supports copying with spread and we don't want to unnecessarily</span><span class="s3">\n  </span><span class="s1">// instrument the promise with spreadable properties of ReactPromise.</span><span class="s3">\n  </span><span class="s1">const promise = hasFallbackParams</span><span class="s3">\n    </span><span class="s1">? makeDevtoolsIOAwarePromise(underlyingParams)</span><span class="s3">\n    </span><span class="s1">: // We don't want to force an environment transition when this params is not part of the fallback params set</span><span class="s3">\n      </span><span class="s1">Promise.resolve(underlyingParams)</span><span class="s3">\n\n  </span><span class="s1">const proxiedProperties = new Set&lt;string&gt;()</span><span class="s3">\n  </span><span class="s1">const unproxiedProperties: Array&lt;string&gt; = []</span><span class="s3">\n\n  </span><span class="s1">Object.keys(underlyingParams).forEach((prop) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (wellKnownProperties.has(prop)) {</span><span class="s3">\n      </span><span class="s1">// These properties cannot be shadowed because they need to be the</span><span class="s3">\n      </span><span class="s1">// true underlying value for Promises to work correctly at runtime</span><span class="s3">\n      </span><span class="s1">unproxiedProperties.push(prop)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">proxiedProperties.add(prop)</span><span class="s3">\n      </span><span class="s1">;(promise as any)[prop] = underlyingParams[prop]</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">const proxiedPromise = new Proxy(promise, {</span><span class="s3">\n    </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">// We are accessing a property that was proxied to the promise instance</span><span class="s3">\n          </span><span class="s1">proxiedProperties.has(prop)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">const expression = describeStringPropertyAccess('params', prop)</span><span class="s3">\n          </span><span class="s1">syncIODev(store.route, expression)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">set(target, prop, value, receiver) {</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">proxiedProperties.delete(prop)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return ReflectAdapter.set(target, prop, value, receiver)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">ownKeys(target) {</span><span class="s3">\n      </span><span class="s1">const expression = '`...params` or similar expression'</span><span class="s3">\n      </span><span class="s1">syncIODev(store.route, expression, unproxiedProperties)</span><span class="s3">\n      </span><span class="s1">return Reflect.ownKeys(target)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">CachedParams.set(underlyingParams, proxiedPromise)</span><span class="s3">\n  </span><span class="s1">return proxiedPromise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Similar to `makeDynamicallyTrackedExoticParamsWithDevWarnings`, but just</span><span class="s3">\n</span><span class="s1">// logging the sync access without actually defining the params on the promise.</span><span class="s3">\n</span><span class="s1">function makeDynamicallyTrackedParamsWithDevWarnings(</span><span class="s3">\n  </span><span class="s1">underlyingParams: Params,</span><span class="s3">\n  </span><span class="s1">hasFallbackParams: boolean,</span><span class="s3">\n  </span><span class="s1">store: WorkStore</span><span class="s3">\n</span><span class="s1">): Promise&lt;Params&gt; {</span><span class="s3">\n  </span><span class="s1">const cachedParams = CachedParams.get(underlyingParams)</span><span class="s3">\n  </span><span class="s1">if (cachedParams) {</span><span class="s3">\n    </span><span class="s1">return cachedParams</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// We don't use makeResolvedReactPromise here because params</span><span class="s3">\n  </span><span class="s1">// supports copying with spread and we don't want to unnecessarily</span><span class="s3">\n  </span><span class="s1">// instrument the promise with spreadable properties of ReactPromise.</span><span class="s3">\n  </span><span class="s1">const promise = hasFallbackParams</span><span class="s3">\n    </span><span class="s1">? makeDevtoolsIOAwarePromise(underlyingParams)</span><span class="s3">\n    </span><span class="s1">: // We don't want to force an environment transition when this params is not part of the fallback params set</span><span class="s3">\n      </span><span class="s1">Promise.resolve(underlyingParams)</span><span class="s3">\n\n  </span><span class="s1">const proxiedProperties = new Set&lt;string&gt;()</span><span class="s3">\n  </span><span class="s1">const unproxiedProperties: Array&lt;string&gt; = []</span><span class="s3">\n\n  </span><span class="s1">Object.keys(underlyingParams).forEach((prop) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (wellKnownProperties.has(prop)) {</span><span class="s3">\n      </span><span class="s1">// These properties cannot be shadowed because they need to be the</span><span class="s3">\n      </span><span class="s1">// true underlying value for Promises to work correctly at runtime</span><span class="s3">\n      </span><span class="s1">unproxiedProperties.push(prop)</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">proxiedProperties.add(prop)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">const proxiedPromise = new Proxy(promise, {</span><span class="s3">\n    </span><span class="s1">get(target, prop, receiver) {</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">// We are accessing a property that was proxied to the promise instance</span><span class="s3">\n          </span><span class="s1">proxiedProperties.has(prop)</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">const expression = describeStringPropertyAccess('params', prop)</span><span class="s3">\n          </span><span class="s1">warnForSyncAccess(store.route, expression)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return ReflectAdapter.get(target, prop, receiver)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">set(target, prop, value, receiver) {</span><span class="s3">\n      </span><span class="s1">if (typeof prop === 'string') {</span><span class="s3">\n        </span><span class="s1">proxiedProperties.delete(prop)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">return ReflectAdapter.set(target, prop, value, receiver)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">ownKeys(target) {</span><span class="s3">\n      </span><span class="s1">const expression = '`...params` or similar expression'</span><span class="s3">\n      </span><span class="s1">warnForIncompleteEnumeration(store.route, expression, unproxiedProperties)</span><span class="s3">\n      </span><span class="s1">return Reflect.ownKeys(target)</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">})</span><span class="s3">\n\n  </span><span class="s1">CachedParams.set(underlyingParams, proxiedPromise)</span><span class="s3">\n  </span><span class="s1">return proxiedPromise</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function syncIODev(</span><span class="s3">\n  </span><span class="s1">route: string | undefined,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">missingProperties?: Array&lt;string&gt;</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const workUnitStore = workUnitAsyncStorage.getStore()</span><span class="s3">\n  </span><span class="s1">if (workUnitStore) {</span><span class="s3">\n    </span><span class="s1">switch (workUnitStore.type) {</span><span class="s3">\n      </span><span class="s1">case 'request':</span><span class="s3">\n        </span><span class="s1">if (workUnitStore.prerenderPhase === true) {</span><span class="s3">\n          </span><span class="s1">// When we're rendering dynamically in dev, we need to advance out of</span><span class="s3">\n          </span><span class="s1">// the Prerender environment when we read Request data synchronously.</span><span class="s3">\n          </span><span class="s1">trackSynchronousRequestDataAccessInDev(workUnitStore)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">case 'prerender':</span><span class="s3">\n      </span><span class="s1">case 'prerender-client':</span><span class="s3">\n      </span><span class="s1">case 'prerender-runtime':</span><span class="s3">\n      </span><span class="s1">case 'prerender-ppr':</span><span class="s3">\n      </span><span class="s1">case 'prerender-legacy':</span><span class="s3">\n      </span><span class="s1">case 'cache':</span><span class="s3">\n      </span><span class="s1">case 'private-cache':</span><span class="s3">\n      </span><span class="s1">case 'unstable-cache':</span><span class="s3">\n        </span><span class="s1">break</span><span class="s3">\n      </span><span class="s1">default:</span><span class="s3">\n        </span><span class="s1">workUnitStore satisfies never</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">// In all cases we warn normally</span><span class="s3">\n  </span><span class="s1">if (missingProperties &amp;&amp; missingProperties.length &gt; 0) {</span><span class="s3">\n    </span><span class="s1">warnForIncompleteEnumeration(route, expression, missingProperties)</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">warnForSyncAccess(route, expression)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const warnForSyncAccess = createDedupedByCallsiteServerErrorLoggerDev(</span><span class="s3">\n  </span><span class="s1">createParamsAccessError</span><span class="s3">\n</span><span class="s1">)</span><span class="s3">\n\n</span><span class="s1">const warnForIncompleteEnumeration =</span><span class="s3">\n  </span><span class="s1">createDedupedByCallsiteServerErrorLoggerDev(createIncompleteEnumerationError)</span><span class="s3">\n\n</span><span class="s1">function createParamsAccessError(</span><span class="s3">\n  </span><span class="s1">route: string | undefined,</span><span class="s3">\n  </span><span class="s1">expression: string</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const prefix = route ? `Route </span><span class="s3">\&quot;</span><span class="s1">${route}</span><span class="s3">\&quot; </span><span class="s1">` : 'This route '</span><span class="s3">\n  </span><span class="s1">return new Error(</span><span class="s3">\n    </span><span class="s1">`${prefix}used ${expression}. ` +</span><span class="s3">\n      </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`params</span><span class="s3">\\</span><span class="s1">` should be awaited before using its properties. ` +</span><span class="s3">\n      </span><span class="s1">`Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function createIncompleteEnumerationError(</span><span class="s3">\n  </span><span class="s1">route: string | undefined,</span><span class="s3">\n  </span><span class="s1">expression: string,</span><span class="s3">\n  </span><span class="s1">missingProperties: Array&lt;string&gt;</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const prefix = route ? `Route </span><span class="s3">\&quot;</span><span class="s1">${route}</span><span class="s3">\&quot; </span><span class="s1">` : 'This route '</span><span class="s3">\n  </span><span class="s1">return new Error(</span><span class="s3">\n    </span><span class="s1">`${prefix}used ${expression}. ` +</span><span class="s3">\n      </span><span class="s1">`</span><span class="s3">\\</span><span class="s1">`params</span><span class="s3">\\</span><span class="s1">` should be awaited before using its properties. ` +</span><span class="s3">\n      </span><span class="s1">`The following properties were not available through enumeration ` +</span><span class="s3">\n      </span><span class="s1">`because they conflict with builtin property names: ` +</span><span class="s3">\n      </span><span class="s1">`${describeListOfPropertyNames(missingProperties)}. ` +</span><span class="s3">\n      </span><span class="s1">`Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function describeListOfPropertyNames(properties: Array&lt;string&gt;) {</span><span class="s3">\n  </span><span class="s1">switch (properties.length) {</span><span class="s3">\n    </span><span class="s1">case 0:</span><span class="s3">\n      </span><span class="s1">throw new InvariantError(</span><span class="s3">\n        </span><span class="s1">'Expected describeListOfPropertyNames to be called with a non-empty list of strings.'</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">case 1:</span><span class="s3">\n      </span><span class="s1">return `</span><span class="s3">\\</span><span class="s1">`${properties[0]}</span><span class="s3">\\</span><span class="s1">``</span><span class="s3">\n    </span><span class="s1">case 2:</span><span class="s3">\n      </span><span class="s1">return `</span><span class="s3">\\</span><span class="s1">`${properties[0]}</span><span class="s3">\\</span><span class="s1">` and </span><span class="s3">\\</span><span class="s1">`${properties[1]}</span><span class="s3">\\</span><span class="s1">``</span><span class="s3">\n    </span><span class="s1">default: {</span><span class="s3">\n      </span><span class="s1">let description = ''</span><span class="s3">\n      </span><span class="s1">for (let i = 0; i &lt; properties.length - 1; i++) {</span><span class="s3">\n        </span><span class="s1">description += `</span><span class="s3">\\</span><span class="s1">`${properties[i]}</span><span class="s3">\\</span><span class="s1">`, `</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">description += `, and </span><span class="s3">\\</span><span class="s1">`${properties[properties.length - 1]}</span><span class="s3">\\</span><span class="s1">``</span><span class="s3">\n      </span><span class="s1">return description</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;ReflectAdapter&quot;</span><span class="s0">,</span><span class="s1">&quot;throwToInterruptStaticGeneration&quot;</span><span class="s0">,</span><span class="s1">&quot;postponeWithTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;trackSynchronousRequestDataAccessInDev&quot;</span><span class="s0">,</span><span class="s1">&quot;delayUntilRuntimeStage&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;throwInvariantForMissingStore&quot;</span><span class="s0">,</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;describeStringPropertyAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;wellKnownProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;makeDevtoolsIOAwarePromise&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;createDedupedByCallsiteServerErrorLoggerDev&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicAccessAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;createParamsFromClient&quot;</span><span class="s0">,</span><span class="s1">&quot;underlyingParams&quot;</span><span class="s0">,</span><span class="s1">&quot;workStore&quot;</span><span class="s0">,</span><span class="s1">&quot;workUnitStore&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;createStaticPrerenderParams&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;NODE_ENV&quot;</span><span class="s0">,</span><span class="s1">&quot;devFallbackParams&quot;</span><span class="s0">,</span><span class="s1">&quot;createRenderParamsInDev&quot;</span><span class="s0">,</span><span class="s1">&quot;createRenderParamsInProd&quot;</span><span class="s0">,</span><span class="s1">&quot;createServerParamsForMetadata&quot;</span><span class="s0">,</span><span class="s1">&quot;createServerParamsForServerSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;createServerParamsForRoute&quot;</span><span class="s0">,</span><span class="s1">&quot;createRuntimePrerenderParams&quot;</span><span class="s0">,</span><span class="s1">&quot;createPrerenderParamsForClientSegment&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackParams&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackRouteParams&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;renderSignal&quot;</span><span class="s0">,</span><span class="s1">&quot;route&quot;</span><span class="s0">,</span><span class="s1">&quot;Promise&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderStore&quot;</span><span class="s0">,</span><span class="s1">&quot;makeHangingParams&quot;</span><span class="s0">,</span><span class="s1">&quot;makeErroringExoticParams&quot;</span><span class="s0">,</span><span class="s1">&quot;__NEXT_CACHE_COMPONENTS&quot;</span><span class="s0">,</span><span class="s1">&quot;makeUntrackedParams&quot;</span><span class="s0">,</span><span class="s1">&quot;makeUntrackedExoticParams&quot;</span><span class="s0">,</span><span class="s1">&quot;hasFallbackParams&quot;</span><span class="s0">,</span><span class="s1">&quot;makeDynamicallyTrackedParamsWithDevWarnings&quot;</span><span class="s0">,</span><span class="s1">&quot;makeDynamicallyTrackedExoticParamsWithDevWarnings&quot;</span><span class="s0">,</span><span class="s1">&quot;CachedParams&quot;</span><span class="s0">,</span><span class="s1">&quot;WeakMap&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackParamsProxyHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;prop&quot;</span><span class="s0">,</span><span class="s1">&quot;receiver&quot;</span><span class="s0">,</span><span class="s1">&quot;originalMethod&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;store&quot;</span><span class="s0">,</span><span class="s1">&quot;abortController&quot;</span><span class="s0">,</span><span class="s1">&quot;abort&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;Proxy&quot;</span><span class="s0">,</span><span class="s1">&quot;apply&quot;</span><span class="s0">,</span><span class="s1">&quot;cachedParams&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;augmentedUnderlying&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;defineProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;expression&quot;</span><span class="s0">,</span><span class="s1">&quot;dynamicTracking&quot;</span><span class="s0">,</span><span class="s1">&quot;enumerable&quot;</span><span class="s0">,</span><span class="s1">&quot;newValue&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;writable&quot;</span><span class="s0">,</span><span class="s1">&quot;configurable&quot;</span><span class="s0">,</span><span class="s1">&quot;proxiedProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;unproxiedProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;proxiedPromise&quot;</span><span class="s0">,</span><span class="s1">&quot;syncIODev&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;ownKeys&quot;</span><span class="s0">,</span><span class="s1">&quot;Reflect&quot;</span><span class="s0">,</span><span class="s1">&quot;warnForSyncAccess&quot;</span><span class="s0">,</span><span class="s1">&quot;warnForIncompleteEnumeration&quot;</span><span class="s0">,</span><span class="s1">&quot;missingProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;prerenderPhase&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;createParamsAccessError&quot;</span><span class="s0">,</span><span class="s1">&quot;createIncompleteEnumerationError&quot;</span><span class="s0">,</span><span class="s1">&quot;prefix&quot;</span><span class="s0">,</span><span class="s1">&quot;describeListOfPropertyNames&quot;</span><span class="s0">,</span><span class="s1">&quot;properties&quot;</span><span class="s0">,</span><span class="s1">&quot;description&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5337</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/client-page.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">import type { ParsedUrlQuery } from 'querystring'</span><span class="s3">\n</span><span class="s1">import { InvariantError } from '../../shared/lib/invariant-error'</span><span class="s3">\n\n</span><span class="s1">import type { Params } from '../../server/request/params'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* When the Page is a client component we send the params and searchParams to this client wrapper</span><span class="s3">\n </span><span class="s1">* where they are turned into dynamically tracked values before being passed to the actual Page component.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* additionally we may send promises representing the params and searchParams. We don't ever use these passed</span><span class="s3">\n </span><span class="s1">* values but it can be necessary for the sender to send a Promise that doesn't resolve in certain situations.</span><span class="s3">\n </span><span class="s1">* It is up to the caller to decide if the promises are needed.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function ClientPageRoot({</span><span class="s3">\n  </span><span class="s1">Component,</span><span class="s3">\n  </span><span class="s1">searchParams,</span><span class="s3">\n  </span><span class="s1">params,</span><span class="s3">\n  </span><span class="s1">// eslint-disable-next-line @typescript-eslint/no-unused-vars</span><span class="s3">\n  </span><span class="s1">promises,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">Component: React.ComponentType&lt;any&gt;</span><span class="s3">\n  </span><span class="s1">searchParams: ParsedUrlQuery</span><span class="s3">\n  </span><span class="s1">params: Params</span><span class="s3">\n  </span><span class="s1">promises?: Array&lt;Promise&lt;any&gt;&gt;</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">if (typeof window === 'undefined') {</span><span class="s3">\n    </span><span class="s1">const { workAsyncStorage } =</span><span class="s3">\n      </span><span class="s1">require('../../server/app-render/work-async-storage.external') as typeof import('../../server/app-render/work-async-storage.external')</span><span class="s3">\n\n    </span><span class="s1">let clientSearchParams: Promise&lt;ParsedUrlQuery&gt;</span><span class="s3">\n    </span><span class="s1">let clientParams: Promise&lt;Params&gt;</span><span class="s3">\n    </span><span class="s1">// We are going to instrument the searchParams prop with tracking for the</span><span class="s3">\n    </span><span class="s1">// appropriate context. We wrap differently in prerendering vs rendering</span><span class="s3">\n    </span><span class="s1">const store = workAsyncStorage.getStore()</span><span class="s3">\n    </span><span class="s1">if (!store) {</span><span class="s3">\n      </span><span class="s1">throw new InvariantError(</span><span class="s3">\n        </span><span class="s1">'Expected workStore to exist when handling searchParams in a client Page.'</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const { createSearchParamsFromClient } =</span><span class="s3">\n      </span><span class="s1">require('../../server/request/search-params') as typeof import('../../server/request/search-params')</span><span class="s3">\n    </span><span class="s1">clientSearchParams = createSearchParamsFromClient(searchParams, store)</span><span class="s3">\n\n    </span><span class="s1">const { createParamsFromClient } =</span><span class="s3">\n      </span><span class="s1">require('../../server/request/params') as typeof import('../../server/request/params')</span><span class="s3">\n    </span><span class="s1">clientParams = createParamsFromClient(params, store)</span><span class="s3">\n\n    </span><span class="s1">return &lt;Component params={clientParams} searchParams={clientSearchParams} /&gt;</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">const { createRenderSearchParamsFromClient } =</span><span class="s3">\n      </span><span class="s1">require('../request/search-params.browser') as typeof import('../request/search-params.browser')</span><span class="s3">\n    </span><span class="s1">const clientSearchParams = createRenderSearchParamsFromClient(searchParams)</span><span class="s3">\n    </span><span class="s1">const { createRenderParamsFromClient } =</span><span class="s3">\n      </span><span class="s1">require('../request/params.browser') as typeof import('../request/params.browser')</span><span class="s3">\n    </span><span class="s1">const clientParams = createRenderParamsFromClient(params)</span><span class="s3">\n\n    </span><span class="s1">return &lt;Component params={clientParams} searchParams={clientSearchParams} /&gt;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;ClientPageRoot&quot;</span><span class="s0">,</span><span class="s1">&quot;Component&quot;</span><span class="s0">,</span><span class="s1">&quot;searchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;promises&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;clientSearchParams&quot;</span><span class="s0">,</span><span class="s1">&quot;clientParams&quot;</span><span class="s0">,</span><span class="s1">&quot;store&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;createSearchParamsFromClient&quot;</span><span class="s0">,</span><span class="s1">&quot;createParamsFromClient&quot;</span><span class="s0">,</span><span class="s1">&quot;createRenderSearchParamsFromClient&quot;</span><span class="s0">,</span><span class="s1">&quot;createRenderParamsFromClient&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;AAGA,SAASA,cAAc,QAAQ,mCAAkC;AAHjE;;;AAeO,SAASC,eAAe,KAW9B;IAX8B,IAAA,EAC7BC,SAAS,EACTC,YAAY,EACZC,MAAM,EACN,AACAC,QAAQ,EAMT,GAX8B,gDAIgC;IAQ7D,IAAI,OAAOC,WAAW,kBAAa;QACjC,MAAM,EAAEC,gBAAgB,EAAE,GACxBC,QAAQ;QAEV,IAAIC;QACJ,IAAIC;QACJ,yEAAyE;QACzE,wEAAwE;QACxE,MAAMC,QAAQJ,iBAAiBK,QAAQ;QACvC,IAAI,CAACD,OAAO;YACV,MAAM,OAAA,cAEL,CAFK,IAAIX,4LAAAA,CACR,6EADI,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;QAEA,MAAM,EAAEa,4BAA4B,EAAE,GACpCL,QAAQ;QACVC,qBAAqBI,6BAA6BV,cAAcQ;QAEhE,MAAM,EAAEG,sBAAsB,EAAE,GAC9BN,QAAQ;QACVE,eAAeI,uBAAuBV,QAAQO;QAE9C,OAAA,WAAA,OAAO,8NAAA,EAACT,WAAAA;YAAUE,QAAQM;YAAcP,cAAcM;;IACxD,OAAO;;AAUT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5377</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/client-segment.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">import { InvariantError } from '../../shared/lib/invariant-error'</span><span class="s3">\n\n</span><span class="s1">import type { Params } from '../../server/request/params'</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* When the Page is a client component we send the params to this client wrapper</span><span class="s3">\n </span><span class="s1">* where they are turned into dynamically tracked values before being passed to the actual Segment component.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* additionally we may send a promise representing params. We don't ever use this passed</span><span class="s3">\n </span><span class="s1">* value but it can be necessary for the sender to send a Promise that doesn't resolve in certain situations</span><span class="s3">\n </span><span class="s1">* such as when cacheComponents is enabled. It is up to the caller to decide if the promises are needed.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function ClientSegmentRoot({</span><span class="s3">\n  </span><span class="s1">Component,</span><span class="s3">\n  </span><span class="s1">slots,</span><span class="s3">\n  </span><span class="s1">params,</span><span class="s3">\n  </span><span class="s1">// eslint-disable-next-line @typescript-eslint/no-unused-vars</span><span class="s3">\n  </span><span class="s1">promise,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">Component: React.ComponentType&lt;any&gt;</span><span class="s3">\n  </span><span class="s1">slots: { [key: string]: React.ReactNode }</span><span class="s3">\n  </span><span class="s1">params: Params</span><span class="s3">\n  </span><span class="s1">promise?: Promise&lt;any&gt;</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">if (typeof window === 'undefined') {</span><span class="s3">\n    </span><span class="s1">const { workAsyncStorage } =</span><span class="s3">\n      </span><span class="s1">require('../../server/app-render/work-async-storage.external') as typeof import('../../server/app-render/work-async-storage.external')</span><span class="s3">\n\n    </span><span class="s1">let clientParams: Promise&lt;Params&gt;</span><span class="s3">\n    </span><span class="s1">// We are going to instrument the searchParams prop with tracking for the</span><span class="s3">\n    </span><span class="s1">// appropriate context. We wrap differently in prerendering vs rendering</span><span class="s3">\n    </span><span class="s1">const store = workAsyncStorage.getStore()</span><span class="s3">\n    </span><span class="s1">if (!store) {</span><span class="s3">\n      </span><span class="s1">throw new InvariantError(</span><span class="s3">\n        </span><span class="s1">'Expected workStore to exist when handling params in a client segment such as a Layout or Template.'</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const { createParamsFromClient } =</span><span class="s3">\n      </span><span class="s1">require('../../server/request/params') as typeof import('../../server/request/params')</span><span class="s3">\n    </span><span class="s1">clientParams = createParamsFromClient(params, store)</span><span class="s3">\n\n    </span><span class="s1">return &lt;Component {...slots} params={clientParams} /&gt;</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">const { createRenderParamsFromClient } =</span><span class="s3">\n      </span><span class="s1">require('../request/params.browser') as typeof import('../request/params.browser')</span><span class="s3">\n    </span><span class="s1">const clientParams = createRenderParamsFromClient(params)</span><span class="s3">\n    </span><span class="s1">return &lt;Component {...slots} params={clientParams} /&gt;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;InvariantError&quot;</span><span class="s0">,</span><span class="s1">&quot;ClientSegmentRoot&quot;</span><span class="s0">,</span><span class="s1">&quot;Component&quot;</span><span class="s0">,</span><span class="s1">&quot;slots&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;workAsyncStorage&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;clientParams&quot;</span><span class="s0">,</span><span class="s1">&quot;store&quot;</span><span class="s0">,</span><span class="s1">&quot;getStore&quot;</span><span class="s0">,</span><span class="s1">&quot;createParamsFromClient&quot;</span><span class="s0">,</span><span class="s1">&quot;createRenderParamsFromClient&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;AAEA,SAASA,cAAc,QAAQ,mCAAkC;AAFjE;;;AAcO,SAASC,kBAAkB,KAWjC;IAXiC,IAAA,EAChCC,SAAS,EACTC,KAAK,EACLC,MAAM,EACN,AACAC,OAAO,EAMR,GAXiC,iDAI6B;IAQ7D,IAAI,OAAOC,WAAW,kBAAa;QACjC,MAAM,EAAEC,gBAAgB,EAAE,GACxBC,QAAQ;QAEV,IAAIC;QACJ,yEAAyE;QACzE,wEAAwE;QACxE,MAAMC,QAAQH,iBAAiBI,QAAQ;QACvC,IAAI,CAACD,OAAO;YACV,MAAM,OAAA,cAEL,CAFK,IAAIV,4LAAAA,CACR,uGADI,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;QAEA,MAAM,EAAEY,sBAAsB,EAAE,GAC9BJ,QAAQ;QACVC,eAAeG,uBAAuBR,QAAQM;QAE9C,OAAA,WAAA,OAAO,8NAAA,EAACR,WAAAA;YAAW,GAAGC,KAAK;YAAEC,QAAQK;;IACvC,OAAO;;AAMT&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5414</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/lib/metadata/generate/icon-mark.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">// This is a client component that only renders during SSR,</span><span class="s3">\n</span><span class="s1">// but will be replaced during streaming with an icon insertion script tag.</span><span class="s3">\n</span><span class="s1">// We don't want it to be presented anywhere so it's only visible during streaming,</span><span class="s3">\n</span><span class="s1">// right after the icon meta tags so that browser can pick it up as soon as it's rendered.</span><span class="s3">\n</span><span class="s1">// Note: we don't just emit the script here because we only need the script if it's not in the head,</span><span class="s3">\n</span><span class="s1">// and we need it to be hoistable alongside the other metadata but sync scripts are not hoistable.</span><span class="s3">\n</span><span class="s1">export const IconMark = () =&gt; {</span><span class="s3">\n  </span><span class="s1">if (typeof window !== 'undefined') {</span><span class="s3">\n    </span><span class="s1">return null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return &lt;meta name=</span><span class="s3">\&quot;</span><span class="s1">nxt-icon</span><span class="s3">\&quot; </span><span class="s1">/&gt;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;IconMark&quot;</span><span class="s0">,</span><span class="s1">&quot;window&quot;</span><span class="s0">,</span><span class="s1">&quot;meta&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;AAAA;;AAQO,MAAMA,WAAW;IACtB,IAAI,OAAOC,WAAW,aAAa;;IAGnC,OAAA,WAAA,OAAO,8NAAA,EAACC,QAAAA;QAAKC,MAAK;;AACpB,EAAC&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5432</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/client/components/metadata/async-metadata.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">import { Suspense, use } from 'react'</span><span class="s3">\n</span><span class="s1">import type { StreamingMetadataResolvedState } from './types'</span><span class="s3">\n\n</span><span class="s1">function MetadataOutlet({</span><span class="s3">\n  </span><span class="s1">promise,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">promise: Promise&lt;StreamingMetadataResolvedState&gt;</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">const { error, digest } = use(promise)</span><span class="s3">\n  </span><span class="s1">if (error) {</span><span class="s3">\n    </span><span class="s1">if (digest) {</span><span class="s3">\n      </span><span class="s1">// The error will lose its original digest after passing from server layer to client layer</span><span class="s3">\n      </span><span class="s1">// We recover the digest property here to override the React created one if original digest exists.</span><span class="s3">\n      </span><span class="s1">;(error as any).digest = digest</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">throw error</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export function AsyncMetadataOutlet({</span><span class="s3">\n  </span><span class="s1">promise,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">promise: Promise&lt;StreamingMetadataResolvedState&gt;</span><span class="s3">\n</span><span class="s1">}) {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">&lt;Suspense fallback={null}&gt;</span><span class="s3">\n      </span><span class="s1">&lt;MetadataOutlet promise={promise} /&gt;</span><span class="s3">\n    </span><span class="s1">&lt;/Suspense&gt;</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;Suspense&quot;</span><span class="s0">,</span><span class="s1">&quot;use&quot;</span><span class="s0">,</span><span class="s1">&quot;MetadataOutlet&quot;</span><span class="s0">,</span><span class="s1">&quot;promise&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;digest&quot;</span><span class="s0">,</span><span class="s1">&quot;AsyncMetadataOutlet&quot;</span><span class="s0">,</span><span class="s1">&quot;fallback&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;AAEA,SAASA,QAAQ,EAAEC,GAAG,QAAQ,QAAO;AAFrC;;;AAKA,SAASC,eAAe,KAIvB;IAJuB,IAAA,EACtBC,OAAO,EAGR,GAJuB;IAKtB,MAAM,EAAEC,KAAK,EAAEC,MAAM,EAAE,GAAGJ,gNAAAA,EAAIE;IAC9B,IAAIC,OAAO;QACT,IAAIC,QAAQ;YACV,2FAA2F;YAC3F,mGAAmG;;YACjGD,MAAcC,MAAM,GAAGA;QAC3B;QACA,MAAMD;IACR;IACA,OAAO;AACT;AAEO,SAASE,oBAAoB,KAInC;IAJmC,IAAA,EAClCH,OAAO,EAGR,GAJmC;IAKlC,OAAA,WAAA,OACE,8NAAA,EAACH,iNAAAA,EAAAA;QAASO,UAAU;kBAClB,WAAA,OAAA,8NAAA,EAACL,gBAAAA;YAAeC,SAASA;;;AAG/B&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}},</span>
    <span class="s0">{</span><span class="s1">&quot;offset&quot;</span><span class="s0">: {</span><span class="s1">&quot;line&quot;</span><span class="s0">: </span><span class="s2">5468</span><span class="s0">, </span><span class="s1">&quot;column&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s0">}, </span><span class="s1">&quot;map&quot;</span><span class="s0">: {</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;file:///Users/dh/WebstormProjects/bluestag/node_modules/next/dist/src/lib/framework/boundary-components.tsx&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;'use client'</span><span class="s3">\n\n</span><span class="s1">import type { ReactNode } from 'react'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">METADATA_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">VIEWPORT_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">OUTLET_BOUNDARY_NAME,</span><span class="s3">\n  </span><span class="s1">ROOT_LAYOUT_BOUNDARY_NAME,</span><span class="s3">\n</span><span class="s1">} from './boundary-constants'</span><span class="s3">\n\n</span><span class="s1">// We use a namespace object to allow us to recover the name of the function</span><span class="s3">\n</span><span class="s1">// at runtime even when production bundling/minification is used.</span><span class="s3">\n</span><span class="s1">const NameSpace = {</span><span class="s3">\n  </span><span class="s1">[METADATA_BOUNDARY_NAME]: function ({ children }: { children: ReactNode }) {</span><span class="s3">\n    </span><span class="s1">return children</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">[VIEWPORT_BOUNDARY_NAME]: function ({ children }: { children: ReactNode }) {</span><span class="s3">\n    </span><span class="s1">return children</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">[OUTLET_BOUNDARY_NAME]: function ({ children }: { children: ReactNode }) {</span><span class="s3">\n    </span><span class="s1">return children</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">[ROOT_LAYOUT_BOUNDARY_NAME]: function ({</span><span class="s3">\n    </span><span class="s1">children,</span><span class="s3">\n  </span><span class="s1">}: {</span><span class="s3">\n    </span><span class="s1">children: ReactNode</span><span class="s3">\n  </span><span class="s1">}) {</span><span class="s3">\n    </span><span class="s1">return children</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const MetadataBoundary =</span><span class="s3">\n  </span><span class="s1">// We use slice(0) to trick the bundler into not inlining/minifying the function</span><span class="s3">\n  </span><span class="s1">// so it retains the name inferred from the namespace object</span><span class="s3">\n  </span><span class="s1">NameSpace[METADATA_BOUNDARY_NAME.slice(0) as typeof METADATA_BOUNDARY_NAME]</span><span class="s3">\n\n</span><span class="s1">export const ViewportBoundary =</span><span class="s3">\n  </span><span class="s1">// We use slice(0) to trick the bundler into not inlining/minifying the function</span><span class="s3">\n  </span><span class="s1">// so it retains the name inferred from the namespace object</span><span class="s3">\n  </span><span class="s1">NameSpace[VIEWPORT_BOUNDARY_NAME.slice(0) as typeof VIEWPORT_BOUNDARY_NAME]</span><span class="s3">\n\n</span><span class="s1">export const OutletBoundary =</span><span class="s3">\n  </span><span class="s1">// We use slice(0) to trick the bundler into not inlining/minifying the function</span><span class="s3">\n  </span><span class="s1">// so it retains the name inferred from the namespace object</span><span class="s3">\n  </span><span class="s1">NameSpace[OUTLET_BOUNDARY_NAME.slice(0) as typeof OUTLET_BOUNDARY_NAME]</span><span class="s3">\n\n</span><span class="s1">export const RootLayoutBoundary =</span><span class="s3">\n  </span><span class="s1">// We use slice(0) to trick the bundler into not inlining/minifying the function</span><span class="s3">\n  </span><span class="s1">// so it retains the name inferred from the namespace object</span><span class="s3">\n  </span><span class="s1">NameSpace[</span><span class="s3">\n    </span><span class="s1">ROOT_LAYOUT_BOUNDARY_NAME.slice(0) as typeof ROOT_LAYOUT_BOUNDARY_NAME</span><span class="s3">\n  </span><span class="s1">]</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;METADATA_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;VIEWPORT_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;OUTLET_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;ROOT_LAYOUT_BOUNDARY_NAME&quot;</span><span class="s0">,</span><span class="s1">&quot;NameSpace&quot;</span><span class="s0">,</span><span class="s1">&quot;children&quot;</span><span class="s0">,</span><span class="s1">&quot;MetadataBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;ViewportBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;OutletBoundary&quot;</span><span class="s0">,</span><span class="s1">&quot;RootLayoutBoundary&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;AAGA,SACEA,sBAAsB,EACtBC,sBAAsB,EACtBC,oBAAoB,EACpBC,yBAAyB,QACpB,uBAAsB;AAR7B;;AAUA,4EAA4E;AAC5E,iEAAiE;AACjE,MAAMC,YAAY;IAChB,CAACJ,0MAAAA,CAAuB,EAAE,SAAU,EAAEK,QAAQ,EAA2B;QACvE,OAAOA;IACT;IACA,CAACJ,0MAAAA,CAAuB,EAAE,SAAU,EAAEI,QAAQ,EAA2B;QACvE,OAAOA;IACT;IACA,CAACH,wMAAAA,CAAqB,EAAE,SAAU,EAAEG,QAAQ,EAA2B;QACrE,OAAOA;IACT;IACA,CAACF,6MAAAA,CAA0B,EAAE,SAAU,EACrCE,QAAQ,EAGT;QACC,OAAOA;IACT;AACF;AAEO,MAAMC,mBAEX,AADA,4DAC4D,oBADoB;AAEhFF,SAAS,CAACJ,0MAAAA,CAAuBO,KAAK,CAAC,GAAoC,CAAA;AAEtE,MAAMC,mBACX,AACA,4DAA4D,oBADoB;AAEhFJ,SAAS,CAACH,0MAAAA,CAAuBM,KAAK,CAAC,GAAoC,CAAA;AAEtE,MAAME,iBACX,AACA,4DAA4D,oBADoB;AAEhFL,SAAS,CAACF,wMAAAA,CAAqBK,KAAK,CAAC,GAAkC,CAAA;AAElE,MAAMG,qBACX,AACA,4DAA4D,oBADoB;AAEhFN,SAAS,CACPD,6MAAAA,CAA0BI,KAAK,CAAC,GACjC,CAAA&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">],</span><span class="s1">&quot;debugId&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}}]</span>
<span class="s0">}</span></pre>
</body>
</html>