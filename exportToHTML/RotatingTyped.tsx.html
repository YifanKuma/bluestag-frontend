<html>
<head>
<title>RotatingTyped.tsx</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #8c8c8c; font-style: italic;}
.s4 { color: #1750eb;}
.s5 { color: #174ad4;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
RotatingTyped.tsx</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use client&quot;</span><span class="s1">;</span>

<span class="s2">import </span><span class="s1">React, {useEffect, useRef, useState} from </span><span class="s0">&quot;react&quot;</span><span class="s1">;</span>

<span class="s1">type Props = {</span>
    <span class="s1">words: string[];</span>
    <span class="s1">typingMs?: number;     </span><span class="s3">// per character</span>
    <span class="s1">backspaceMs?: number;  </span><span class="s3">// per character</span>
    <span class="s1">holdMs?: number;       </span><span class="s3">// pause before backspacing</span>
    <span class="s1">loop?: boolean;</span>
    <span class="s1">className?: string;</span>
    <span class="s1">cursor?: string;</span>
<span class="s1">};</span>

<span class="s2">export default function </span><span class="s1">RotatingTyped({</span>
                                          <span class="s1">words,</span>
                                          <span class="s1">typingMs = </span><span class="s4">80</span><span class="s1">,</span>
                                          <span class="s1">backspaceMs = </span><span class="s4">40</span><span class="s1">,</span>
                                          <span class="s1">holdMs = </span><span class="s4">700</span><span class="s1">,</span>
                                          <span class="s1">loop = </span><span class="s2">true</span><span class="s1">,</span>
                                          <span class="s1">className,</span>
                                          <span class="s1">cursor = </span><span class="s0">&quot;|&quot;</span><span class="s1">,</span>
                                      <span class="s1">}: Props) {</span>
    <span class="s2">const </span><span class="s1">[i, setI] = useState(</span><span class="s4">0</span><span class="s1">);                </span><span class="s3">// which word</span>
    <span class="s2">const </span><span class="s1">[text, setText] = useState(</span><span class="s0">&quot;&quot;</span><span class="s1">);         </span><span class="s3">// shown substring</span>
    <span class="s2">const </span><span class="s1">[phase, setPhase] = useState&lt;</span><span class="s0">&quot;typing&quot; </span><span class="s1">| </span><span class="s0">&quot;holding&quot; </span><span class="s1">| </span><span class="s0">&quot;backspacing&quot;</span><span class="s1">&gt;(</span><span class="s0">&quot;typing&quot;</span><span class="s1">);</span>
    <span class="s2">const </span><span class="s1">timer = useRef&lt;number | </span><span class="s2">null</span><span class="s1">&gt;(</span><span class="s2">null</span><span class="s1">);</span>

    <span class="s1">useEffect(() =&gt; {</span>
        <span class="s2">const </span><span class="s1">clear = () =&gt; {</span>
            <span class="s2">if </span><span class="s1">(timer.current) window.clearTimeout(timer.current);</span>
        <span class="s1">};</span>

        <span class="s2">const </span><span class="s1">word = words[i % words.length];</span>

        <span class="s2">if </span><span class="s1">(phase === </span><span class="s0">&quot;typing&quot;</span><span class="s1">) {</span>
            <span class="s2">if </span><span class="s1">(text.length &lt; word.length) {</span>
                <span class="s1">timer.current = window.setTimeout(() =&gt; setText(word.slice(</span><span class="s4">0</span><span class="s1">, text.length + </span><span class="s4">1</span><span class="s1">)), typingMs);</span>
            <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
                <span class="s1">timer.current = window.setTimeout(() =&gt; setPhase(</span><span class="s0">&quot;holding&quot;</span><span class="s1">), holdMs);</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s2">else if </span><span class="s1">(phase === </span><span class="s0">&quot;holding&quot;</span><span class="s1">) {</span>
            <span class="s1">timer.current = window.setTimeout(() =&gt; setPhase(</span><span class="s0">&quot;backspacing&quot;</span><span class="s1">), holdMs);</span>
        <span class="s1">} </span><span class="s2">else if </span><span class="s1">(phase === </span><span class="s0">&quot;backspacing&quot;</span><span class="s1">) {</span>
            <span class="s2">if </span><span class="s1">(text.length &gt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s1">timer.current = window.setTimeout(() =&gt; setText(text.slice(</span><span class="s4">0</span><span class="s1">, -</span><span class="s4">1</span><span class="s1">)), backspaceMs);</span>
            <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
                <span class="s2">if </span><span class="s1">(!loop &amp;&amp; i + </span><span class="s4">1 </span><span class="s1">&gt;= words.length) </span><span class="s2">return </span><span class="s1">clear();</span>
                <span class="s1">setI((v) =&gt; (v + </span><span class="s4">1</span><span class="s1">) % words.length);</span>
                <span class="s1">setPhase(</span><span class="s0">&quot;typing&quot;</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s2">return </span><span class="s1">clear;</span>
    <span class="s1">}, [text, phase, i, words, typingMs, backspaceMs, holdMs, loop]);</span>

    <span class="s2">return </span><span class="s1">(</span>
        <span class="s1">&lt;</span><span class="s2">span </span><span class="s5">className</span><span class="s0">=</span><span class="s1">{className} </span><span class="s5">aria-live</span><span class="s0">=&quot;polite&quot;</span><span class="s1">&gt;</span>
      <span class="s1">{text}</span>
            <span class="s1">&lt;</span><span class="s2">span </span><span class="s5">className</span><span class="s0">=&quot;animate-pulse&quot;</span><span class="s1">&gt;{cursor}&lt;/</span><span class="s2">span</span><span class="s1">&gt;</span>
    <span class="s1">&lt;/</span><span class="s2">span</span><span class="s1">&gt;</span>
    <span class="s1">);</span>
<span class="s1">}</span></pre>
</body>
</html>