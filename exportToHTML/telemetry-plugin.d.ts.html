<html>
<head>
<title>telemetry-plugin.d.ts</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #8c8c8c; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
telemetry-plugin.d.ts</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">type { webpack } from </span><span class="s2">'next/dist/compiled/webpack/webpack'</span><span class="s1">;</span>
<span class="s0">import </span><span class="s1">{ type UseCacheTrackerKey } from </span><span class="s2">'./use-cache-tracker-utils'</span><span class="s1">;</span>
<span class="s3">/**</span>
 <span class="s3">* List of target triples next-swc native binary supports.</span>
 <span class="s3">*/</span>
<span class="s0">export </span><span class="s1">type SWC_TARGET_TRIPLE = </span><span class="s2">'x86_64-apple-darwin' </span><span class="s1">| </span><span class="s2">'x86_64-unknown-linux-gnu' </span><span class="s1">| </span><span class="s2">'x86_64-pc-windows-msvc' </span><span class="s1">| </span><span class="s2">'i686-pc-windows-msvc' </span><span class="s1">| </span><span class="s2">'aarch64-unknown-linux-gnu' </span><span class="s1">| </span><span class="s2">'armv7-unknown-linux-gnueabihf' </span><span class="s1">| </span><span class="s2">'aarch64-apple-darwin' </span><span class="s1">| </span><span class="s2">'aarch64-linux-android' </span><span class="s1">| </span><span class="s2">'arm-linux-androideabi' </span><span class="s1">| </span><span class="s2">'x86_64-unknown-freebsd' </span><span class="s1">| </span><span class="s2">'x86_64-unknown-linux-musl' </span><span class="s1">| </span><span class="s2">'aarch64-unknown-linux-musl' </span><span class="s1">| </span><span class="s2">'aarch64-pc-windows-msvc'</span><span class="s1">;</span>
<span class="s0">export </span><span class="s1">type Feature = </span><span class="s2">'next/image' </span><span class="s1">| </span><span class="s2">'next/future/image' </span><span class="s1">| </span><span class="s2">'next/legacy/image' </span><span class="s1">| </span><span class="s2">'next/script' </span><span class="s1">| </span><span class="s2">'next/dynamic' </span><span class="s1">| </span><span class="s2">'@next/font/google' </span><span class="s1">| </span><span class="s2">'@next/font/local' </span><span class="s1">| </span><span class="s2">'next/font/google' </span><span class="s1">| </span><span class="s2">'next/font/local' </span><span class="s1">| </span><span class="s2">'swcLoader' </span><span class="s1">| </span><span class="s2">'swcRelay' </span><span class="s1">| </span><span class="s2">'swcStyledComponents' </span><span class="s1">| </span><span class="s2">'swcReactRemoveProperties' </span><span class="s1">| </span><span class="s2">'swcExperimentalDecorators' </span><span class="s1">| </span><span class="s2">'swcRemoveConsole' </span><span class="s1">| </span><span class="s2">'swcImportSource' </span><span class="s1">| </span><span class="s2">'swcEmotion' </span><span class="s1">| </span><span class="s2">`swc/target/</span><span class="s1">${SWC_TARGET_TRIPLE}</span><span class="s2">` </span><span class="s1">| </span><span class="s2">'turbotrace' </span><span class="s1">| </span><span class="s2">'transpilePackages' </span><span class="s1">| </span><span class="s2">'skipMiddlewareUrlNormalize' </span><span class="s1">| </span><span class="s2">'skipTrailingSlashRedirect' </span><span class="s1">| </span><span class="s2">'modularizeImports' </span><span class="s1">| </span><span class="s2">'esmExternals' </span><span class="s1">| </span><span class="s2">'webpackPlugins' </span><span class="s1">| UseCacheTrackerKey;</span>
<span class="s0">interface </span><span class="s1">FeatureUsage {</span>
    <span class="s1">featureName: Feature;</span>
    <span class="s1">invocationCount: number;</span>
<span class="s1">}</span>
<span class="s0">export </span><span class="s1">type TelemetryLoaderContext = {</span>
    <span class="s1">eliminatedPackages?: Set&lt;string&gt;;</span>
    <span class="s1">useCacheTracker?: Map&lt;UseCacheTrackerKey, number&gt;;</span>
<span class="s1">};</span>
<span class="s3">/**</span>
 <span class="s3">* Plugin that queries the ModuleGraph to look for modules that correspond to</span>
 <span class="s3">* certain features (e.g. next/image and next/script) and record how many times</span>
 <span class="s3">* they are imported.</span>
 <span class="s3">*/</span>
<span class="s0">export </span><span class="s1">declare </span><span class="s0">class </span><span class="s1">TelemetryPlugin </span><span class="s0">implements </span><span class="s1">webpack.WebpackPluginInstance {</span>
    <span class="s0">private </span><span class="s1">usageTracker;</span>
    <span class="s1">constructor(buildFeaturesMap: Map&lt;Feature, boolean&gt;);</span>
    <span class="s1">addUsage(featureName: Feature, invocationCount: FeatureUsage[</span><span class="s2">'invocationCount'</span><span class="s1">]): </span><span class="s0">void</span><span class="s1">;</span>
    <span class="s1">apply(compiler: webpack.Compiler): </span><span class="s0">void</span><span class="s1">;</span>
    <span class="s1">usages(): FeatureUsage[];</span>
    <span class="s1">packagesUsedInServerSideProps(): string[];</span>
    <span class="s1">getUseCacheTracker(): Record&lt;UseCacheTrackerKey, number&gt;;</span>
<span class="s1">}</span>
<span class="s0">export </span><span class="s1">type TelemetryPluginState = {</span>
    <span class="s1">usages: ReturnType&lt;TelemetryPlugin[</span><span class="s2">'usages'</span><span class="s1">]&gt;;</span>
    <span class="s1">packagesUsedInServerSideProps: ReturnType&lt;TelemetryPlugin[</span><span class="s2">'packagesUsedInServerSideProps'</span><span class="s1">]&gt;;</span>
    <span class="s1">useCacheTracker: ReturnType&lt;TelemetryPlugin[</span><span class="s2">'getUseCacheTracker'</span><span class="s1">]&gt;;</span>
<span class="s1">};</span>
<span class="s0">export </span><span class="s1">{};</span>
</pre>
</body>
</html>