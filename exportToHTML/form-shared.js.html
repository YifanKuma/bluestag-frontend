<html>
<head>
<title>form-shared.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #1750eb;}
.s4 { color: #8c8c8c; font-style: italic;}
.s5 { color: #0037a6;}
.s6 { color: #264eff;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
form-shared.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, {</span>
    <span class="s1">value: </span><span class="s2">true</span>
<span class="s1">});</span>
<span class="s3">0 </span><span class="s1">&amp;&amp; (module.exports = {</span>
    <span class="s1">DISALLOWED_FORM_PROPS: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">checkFormActionUrl: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">createFormSubmitDestinationUrl: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">hasReactClientActionAttributes: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">hasUnsupportedSubmitterAttributes: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">isSupportedFormEncType: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">isSupportedFormMethod: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">isSupportedFormTarget: </span><span class="s2">null</span>
<span class="s1">});</span>
<span class="s2">function </span><span class="s1">_export(target, all) {</span>
    <span class="s2">for</span><span class="s1">(</span><span class="s2">var </span><span class="s1">name </span><span class="s2">in </span><span class="s1">all)Object.defineProperty(target, name, {</span>
        <span class="s1">enumerable: </span><span class="s2">true</span><span class="s1">,</span>
        <span class="s1">get: all[name]</span>
    <span class="s1">});</span>
<span class="s1">}</span>
<span class="s1">_export(exports, {</span>
    <span class="s1">DISALLOWED_FORM_PROPS: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">DISALLOWED_FORM_PROPS;</span>
    <span class="s1">},</span>
    <span class="s1">checkFormActionUrl: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">checkFormActionUrl;</span>
    <span class="s1">},</span>
    <span class="s1">createFormSubmitDestinationUrl: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">createFormSubmitDestinationUrl;</span>
    <span class="s1">},</span>
    <span class="s1">hasReactClientActionAttributes: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">hasReactClientActionAttributes;</span>
    <span class="s1">},</span>
    <span class="s1">hasUnsupportedSubmitterAttributes: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">hasUnsupportedSubmitterAttributes;</span>
    <span class="s1">},</span>
    <span class="s1">isSupportedFormEncType: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">isSupportedFormEncType;</span>
    <span class="s1">},</span>
    <span class="s1">isSupportedFormMethod: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">isSupportedFormMethod;</span>
    <span class="s1">},</span>
    <span class="s1">isSupportedFormTarget: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">isSupportedFormTarget;</span>
    <span class="s1">}</span>
<span class="s1">});</span>
<span class="s2">const </span><span class="s1">DISALLOWED_FORM_PROPS = [</span>
    <span class="s0">'method'</span><span class="s1">,</span>
    <span class="s0">'encType'</span><span class="s1">,</span>
    <span class="s0">'target'</span>
<span class="s1">];</span>
<span class="s2">function </span><span class="s1">createFormSubmitDestinationUrl(action, formElement) {</span>
    <span class="s2">let </span><span class="s1">targetUrl;</span>
    <span class="s2">try </span><span class="s1">{</span>
        <span class="s4">// NOTE: It might be more correct to resolve URLs relative to `document.baseURI`,</span>
        <span class="s4">// but we already do it relative to `location.href` elsewhere:</span>
        <span class="s4">//  (see e.g. https://github.com/vercel/next.js/blob/bb0e6722f87ceb2d43015f5b8a413d0072f2badf/packages/next/src/client/components/app-router.tsx#L146)</span>
        <span class="s4">// so it's better to stay consistent.</span>
        <span class="s2">const </span><span class="s1">base = window.location.href;</span>
        <span class="s1">targetUrl = </span><span class="s2">new </span><span class="s1">URL(action, base);</span>
    <span class="s1">} </span><span class="s2">catch </span><span class="s1">(err) {</span>
        <span class="s2">throw </span><span class="s1">Object.defineProperty(</span><span class="s2">new </span><span class="s1">Error(</span><span class="s0">'Cannot parse form action &quot;' </span><span class="s1">+ action + </span><span class="s0">'&quot; as a URL'</span><span class="s1">, {</span>
            <span class="s1">cause: err</span>
        <span class="s1">}), </span><span class="s0">&quot;__NEXT_ERROR_CODE&quot;</span><span class="s1">, {</span>
            <span class="s1">value: </span><span class="s0">&quot;E152&quot;</span><span class="s1">,</span>
            <span class="s1">enumerable: </span><span class="s2">false</span><span class="s1">,</span>
            <span class="s1">configurable: </span><span class="s2">true</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s2">if </span><span class="s1">(targetUrl.searchParams.size) {</span>
        <span class="s4">// url-encoded HTML forms *overwrite* any search params in the `action` url:</span>
        <span class="s4">//</span>
        <span class="s4">//  &quot;Let `query` be the result of running the application/x-www-form-urlencoded serializer [...]&quot;</span>
        <span class="s4">//  &quot;Set parsed action's query component to `query`.&quot;</span>
        <span class="s4">//   https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#submit-mutate-action</span>
        <span class="s4">//</span>
        <span class="s4">// We need to match that.</span>
        <span class="s4">// (note that all other parts of the URL, like `hash`, are preserved)</span>
        <span class="s1">targetUrl.search = </span><span class="s0">''</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">const </span><span class="s1">formData = </span><span class="s2">new </span><span class="s1">FormData(formElement);</span>
    <span class="s2">for </span><span class="s1">(</span><span class="s2">let </span><span class="s1">[name, value] of formData){</span>
        <span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">value !== </span><span class="s0">'string'</span><span class="s1">) {</span>
            <span class="s4">// For file inputs, the native browser behavior is to use the filename as the value instead:</span>
            <span class="s4">//</span>
            <span class="s4">//   &quot;If entry's value is a File object, then let value be entry's value's name. Otherwise, let value be entry's value.&quot;</span>
            <span class="s4">//   https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#converting-an-entry-list-to-a-list-of-name-value-pairs</span>
            <span class="s4">//</span>
            <span class="s2">if </span><span class="s1">(process.env.NODE_ENV === </span><span class="s0">'development'</span><span class="s1">) {</span>
                <span class="s1">console.warn(</span><span class="s0">&quot;&lt;Form&gt; only supports file inputs if `action` is a function. File inputs cannot be used if `action` is a string, &quot; </span><span class="s1">+ </span><span class="s0">&quot;because files cannot be encoded as search params.&quot;</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s1">value = value.name;</span>
        <span class="s1">}</span>
        <span class="s1">targetUrl.searchParams.append(name, value);</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">targetUrl;</span>
<span class="s1">}</span>
<span class="s2">function </span><span class="s1">checkFormActionUrl(action, source) {</span>
    <span class="s2">const </span><span class="s1">aPropName = source === </span><span class="s0">'action' </span><span class="s1">? </span><span class="s0">&quot;an `action`&quot; </span><span class="s1">: </span><span class="s0">&quot;a `formAction`&quot;</span><span class="s1">;</span>
    <span class="s2">let </span><span class="s1">testUrl;</span>
    <span class="s2">try </span><span class="s1">{</span>
        <span class="s1">testUrl = </span><span class="s2">new </span><span class="s1">URL(action, </span><span class="s0">'http://n'</span><span class="s1">);</span>
    <span class="s1">} </span><span class="s2">catch </span><span class="s1">(err) {</span>
        <span class="s1">console.error(</span><span class="s0">&quot;&lt;Form&gt; received &quot; </span><span class="s1">+ aPropName + </span><span class="s0">' that cannot be parsed as a URL: &quot;' </span><span class="s1">+ action + </span><span class="s0">'&quot;.'</span><span class="s1">);</span>
        <span class="s2">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// url-encoded HTML forms ignore any queryparams in the `action` url. We need to match that.</span>
    <span class="s2">if </span><span class="s1">(testUrl.searchParams.size) {</span>
        <span class="s1">console.warn(</span><span class="s0">&quot;&lt;Form&gt; received &quot; </span><span class="s1">+ aPropName + </span><span class="s0">' that contains search params: &quot;' </span><span class="s1">+ action + </span><span class="s0">'&quot;. This is not supported, and they will be ignored. ' </span><span class="s1">+ </span><span class="s0">'If you need to pass in additional search params, use an `&lt;input type=&quot;hidden&quot; /&gt;` instead.'</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s2">const </span><span class="s1">isSupportedFormEncType = (value)=&gt;value === </span><span class="s0">'application/x-www-form-urlencoded'</span><span class="s1">;</span>
<span class="s2">const </span><span class="s1">isSupportedFormMethod = (value)=&gt;value === </span><span class="s0">'get'</span><span class="s1">;</span>
<span class="s2">const </span><span class="s1">isSupportedFormTarget = (value)=&gt;value === </span><span class="s0">'_self'</span><span class="s1">;</span>
<span class="s2">function </span><span class="s1">hasUnsupportedSubmitterAttributes(submitter) {</span>
    <span class="s4">// A submitter can override `encType` for the form.</span>
    <span class="s2">const </span><span class="s1">formEncType = submitter.getAttribute(</span><span class="s0">'formEncType'</span><span class="s1">);</span>
    <span class="s2">if </span><span class="s1">(formEncType !== </span><span class="s2">null </span><span class="s1">&amp;&amp; !isSupportedFormEncType(formEncType)) {</span>
        <span class="s2">if </span><span class="s1">(process.env.NODE_ENV === </span><span class="s0">'development'</span><span class="s1">) {</span>
            <span class="s1">console.error(</span><span class="s0">&quot;&lt;Form&gt;'s `encType` was set to an unsupported value via `formEncType=</span><span class="s5">\&quot;</span><span class="s0">&quot; </span><span class="s1">+ formEncType + </span><span class="s0">'&quot;`. ' </span><span class="s1">+ </span><span class="s0">&quot;This will disable &lt;Form&gt;'s navigation functionality. If you need this, use a native &lt;form&gt; element instead.&quot;</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s2">return true</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// A submitter can override `method` for the form.</span>
    <span class="s2">const </span><span class="s1">formMethod = submitter.getAttribute(</span><span class="s0">'formMethod'</span><span class="s1">);</span>
    <span class="s2">if </span><span class="s1">(formMethod !== </span><span class="s2">null </span><span class="s1">&amp;&amp; !isSupportedFormMethod(formMethod)) {</span>
        <span class="s2">if </span><span class="s1">(process.env.NODE_ENV === </span><span class="s0">'development'</span><span class="s1">) {</span>
            <span class="s1">console.error(</span><span class="s0">&quot;&lt;Form&gt;'s `method` was set to an unsupported value via `formMethod=</span><span class="s5">\&quot;</span><span class="s0">&quot; </span><span class="s1">+ formMethod + </span><span class="s0">'&quot;`. ' </span><span class="s1">+ </span><span class="s0">&quot;This will disable &lt;Form&gt;'s navigation functionality. If you need this, use a native &lt;form&gt; element instead.&quot;</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s2">return true</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// A submitter can override `target` for the form.</span>
    <span class="s2">const </span><span class="s1">formTarget = submitter.getAttribute(</span><span class="s0">'formTarget'</span><span class="s1">);</span>
    <span class="s2">if </span><span class="s1">(formTarget !== </span><span class="s2">null </span><span class="s1">&amp;&amp; !isSupportedFormTarget(formTarget)) {</span>
        <span class="s2">if </span><span class="s1">(process.env.NODE_ENV === </span><span class="s0">'development'</span><span class="s1">) {</span>
            <span class="s1">console.error(</span><span class="s0">&quot;&lt;Form&gt;'s `target` was set to an unsupported value via `formTarget=</span><span class="s5">\&quot;</span><span class="s0">&quot; </span><span class="s1">+ formTarget + </span><span class="s0">'&quot;`. ' </span><span class="s1">+ </span><span class="s0">&quot;This will disable &lt;Form&gt;'s navigation functionality. If you need this, use a native &lt;form&gt; element instead.&quot;</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s2">return true</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">return false</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s2">function </span><span class="s1">hasReactClientActionAttributes(submitter) {</span>
    <span class="s4">// CSR: https://github.com/facebook/react/blob/942eb80381b96f8410eab1bef1c539bed1ab0eb1/packages/react-dom-bindings/src/client/ReactDOMComponent.js#L482-L487</span>
    <span class="s4">// SSR: https://github.com/facebook/react/blob/942eb80381b96f8410eab1bef1c539bed1ab0eb1/packages/react-dom-bindings/src/client/ReactDOMComponent.js#L2401</span>
    <span class="s2">const </span><span class="s1">action = submitter.getAttribute(</span><span class="s0">'formAction'</span><span class="s1">);</span>
    <span class="s2">return </span><span class="s1">action &amp;&amp; </span><span class="s6">/\s*javascript:/i</span><span class="s1">.test(action);</span>
<span class="s1">}</span>

<span class="s2">if </span><span class="s1">((</span><span class="s2">typeof </span><span class="s1">exports.default === </span><span class="s0">'function' </span><span class="s1">|| (</span><span class="s2">typeof </span><span class="s1">exports.default === </span><span class="s0">'object' </span><span class="s1">&amp;&amp; exports.default !== </span><span class="s2">null</span><span class="s1">)) &amp;&amp; </span><span class="s2">typeof </span><span class="s1">exports.default.__esModule === </span><span class="s0">'undefined'</span><span class="s1">) {</span>
  <span class="s1">Object.defineProperty(exports.default, </span><span class="s0">'__esModule'</span><span class="s1">, { value: </span><span class="s2">true </span><span class="s1">});</span>
  <span class="s1">Object.assign(exports.default, exports);</span>
  <span class="s1">module.exports = exports.default;</span>
<span class="s1">}</span>

<span class="s4">//# sourceMappingURL=form-shared.js.map</span></pre>
</body>
</html>