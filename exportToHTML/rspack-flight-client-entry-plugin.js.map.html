<html>
<head>
<title>rspack-flight-client-entry-plugin.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
.s1 { color: #067d17;}
.s2 { color: #1750eb;}
.s3 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
rspack-flight-client-entry-plugin.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../../src/build/webpack/plugins/rspack-flight-client-entry-plugin.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import type { Compiler } from '@rspack/core'</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">getInvalidator,</span><span class="s3">\n  </span><span class="s1">getEntries,</span><span class="s3">\n  </span><span class="s1">EntryTypes,</span><span class="s3">\n  </span><span class="s1">getEntryKey,</span><span class="s3">\n</span><span class="s1">} from '../../../server/dev/on-demand-entry-handler'</span><span class="s3">\n</span><span class="s1">import { COMPILER_NAMES } from '../../../shared/lib/constants'</span><span class="s3">\n\n</span><span class="s1">import { getProxiedPluginState } from '../../build-context'</span><span class="s3">\n</span><span class="s1">import { PAGE_TYPES } from '../../../lib/page-types'</span><span class="s3">\n</span><span class="s1">import { getRspackCore } from '../../../shared/lib/get-rspack'</span><span class="s3">\n\n</span><span class="s1">type Actions = {</span><span class="s3">\n  </span><span class="s1">[actionId: string]: {</span><span class="s3">\n    </span><span class="s1">workers: {</span><span class="s3">\n      </span><span class="s1">[name: string]: { moduleId: string | number; async: boolean }</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">// Record which layer the action is in (rsc or sc_action), in the specific entry.</span><span class="s3">\n    </span><span class="s1">layer: {</span><span class="s3">\n      </span><span class="s1">[name: string]: string</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type ActionManifest = {</span><span class="s3">\n  </span><span class="s1">// Assign a unique encryption key during production build.</span><span class="s3">\n  </span><span class="s1">encryptionKey: string</span><span class="s3">\n  </span><span class="s1">node: Actions</span><span class="s3">\n  </span><span class="s1">edge: Actions</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export interface ModuleInfo {</span><span class="s3">\n  </span><span class="s1">moduleId: string | number</span><span class="s3">\n  </span><span class="s1">async: boolean</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const pluginState = getProxiedPluginState({</span><span class="s3">\n  </span><span class="s1">// A map to track </span><span class="s3">\&quot;</span><span class="s1">action</span><span class="s3">\&quot; </span><span class="s1">-&gt; </span><span class="s3">\&quot;</span><span class="s1">list of bundles</span><span class="s3">\&quot;</span><span class="s1">.</span><span class="s3">\n  </span><span class="s1">serverActions: {} as ActionManifest['node'],</span><span class="s3">\n  </span><span class="s1">edgeServerActions: {} as ActionManifest['edge'],</span><span class="s3">\n\n  </span><span class="s1">serverActionModules: {} as {</span><span class="s3">\n    </span><span class="s1">[workerName: string]: { server?: ModuleInfo; client?: ModuleInfo }</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n\n  </span><span class="s1">edgeServerActionModules: {} as {</span><span class="s3">\n    </span><span class="s1">[workerName: string]: { server?: ModuleInfo; client?: ModuleInfo }</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n\n  </span><span class="s1">ssrModules: {} as { [ssrModuleId: string]: ModuleInfo },</span><span class="s3">\n  </span><span class="s1">edgeSsrModules: {} as { [ssrModuleId: string]: ModuleInfo },</span><span class="s3">\n\n  </span><span class="s1">rscModules: {} as { [rscModuleId: string]: ModuleInfo },</span><span class="s3">\n  </span><span class="s1">edgeRscModules: {} as { [rscModuleId: string]: ModuleInfo },</span><span class="s3">\n\n  </span><span class="s1">injectedClientEntries: {} as Record&lt;string, string&gt;,</span><span class="s3">\n</span><span class="s1">})</span><span class="s3">\n\n</span><span class="s1">interface Options {</span><span class="s3">\n  </span><span class="s1">dev: boolean</span><span class="s3">\n  </span><span class="s1">appDir: string</span><span class="s3">\n  </span><span class="s1">isEdgeServer: boolean</span><span class="s3">\n  </span><span class="s1">encryptionKey: string</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class RspackFlightClientEntryPlugin {</span><span class="s3">\n  </span><span class="s1">plugin: any</span><span class="s3">\n  </span><span class="s1">compiler?: Compiler</span><span class="s3">\n\n  </span><span class="s1">constructor(options: Options) {</span><span class="s3">\n    </span><span class="s1">const { FlightClientEntryPlugin } = getRspackCore()</span><span class="s3">\n\n    </span><span class="s1">this.plugin = new FlightClientEntryPlugin({</span><span class="s3">\n      </span><span class="s1">...options,</span><span class="s3">\n      </span><span class="s1">builtinAppLoader: !!process.env.BUILTIN_SWC_LOADER,</span><span class="s3">\n      </span><span class="s1">shouldInvalidateCb: ({</span><span class="s3">\n        </span><span class="s1">bundlePath,</span><span class="s3">\n        </span><span class="s1">entryName,</span><span class="s3">\n        </span><span class="s1">absolutePagePath,</span><span class="s3">\n        </span><span class="s1">clientBrowserLoader,</span><span class="s3">\n      </span><span class="s1">}: any) =&gt; {</span><span class="s3">\n        </span><span class="s1">let shouldInvalidate = false</span><span class="s3">\n        </span><span class="s1">const compiler = this.compiler!</span><span class="s3">\n\n        </span><span class="s1">const entries = getEntries(compiler.outputPath)</span><span class="s3">\n        </span><span class="s1">const pageKey = getEntryKey(</span><span class="s3">\n          </span><span class="s1">COMPILER_NAMES.client,</span><span class="s3">\n          </span><span class="s1">PAGE_TYPES.APP,</span><span class="s3">\n          </span><span class="s1">bundlePath</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n\n        </span><span class="s1">if (!entries[pageKey]) {</span><span class="s3">\n          </span><span class="s1">entries[pageKey] = {</span><span class="s3">\n            </span><span class="s1">type: EntryTypes.CHILD_ENTRY,</span><span class="s3">\n            </span><span class="s1">parentEntries: new Set([entryName]),</span><span class="s3">\n            </span><span class="s1">absoluteEntryFilePath: absolutePagePath,</span><span class="s3">\n            </span><span class="s1">bundlePath,</span><span class="s3">\n            </span><span class="s1">request: clientBrowserLoader,</span><span class="s3">\n            </span><span class="s1">dispose: false,</span><span class="s3">\n            </span><span class="s1">lastActiveTime: Date.now(),</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">shouldInvalidate = true</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">const entryData = entries[pageKey]</span><span class="s3">\n          </span><span class="s1">// New version of the client loader</span><span class="s3">\n          </span><span class="s1">if (entryData.request !== clientBrowserLoader) {</span><span class="s3">\n            </span><span class="s1">entryData.request = clientBrowserLoader</span><span class="s3">\n            </span><span class="s1">shouldInvalidate = true</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">if (entryData.type === EntryTypes.CHILD_ENTRY) {</span><span class="s3">\n            </span><span class="s1">entryData.parentEntries.add(entryName)</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">entryData.dispose = false</span><span class="s3">\n          </span><span class="s1">entryData.lastActiveTime = Date.now()</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">return shouldInvalidate</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">invalidateCb: () =&gt; {</span><span class="s3">\n        </span><span class="s1">const compiler = this.compiler!</span><span class="s3">\n\n        </span><span class="s1">// Invalidate in development to trigger recompilation</span><span class="s3">\n        </span><span class="s1">const invalidator = getInvalidator(compiler.outputPath)</span><span class="s3">\n        </span><span class="s1">// Check if any of the entry injections need an invalidation</span><span class="s3">\n        </span><span class="s1">if (invalidator) {</span><span class="s3">\n          </span><span class="s1">invalidator.invalidate([COMPILER_NAMES.client])</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">stateCb: (state: any) =&gt; {</span><span class="s3">\n        </span><span class="s1">Object.assign(pluginState.serverActions, state.serverActions)</span><span class="s3">\n        </span><span class="s1">Object.assign(pluginState.edgeServerActions, state.edgeServerActions)</span><span class="s3">\n        </span><span class="s1">Object.assign(</span><span class="s3">\n          </span><span class="s1">pluginState.serverActionModules,</span><span class="s3">\n          </span><span class="s1">state.serverActionModules</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">Object.assign(</span><span class="s3">\n          </span><span class="s1">pluginState.edgeServerActionModules,</span><span class="s3">\n          </span><span class="s1">state.edgeServerActionModules</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">Object.assign(pluginState.ssrModules, state.ssrModules)</span><span class="s3">\n        </span><span class="s1">Object.assign(pluginState.edgeSsrModules, state.edgeSsrModules)</span><span class="s3">\n        </span><span class="s1">Object.assign(pluginState.rscModules, state.rscModules)</span><span class="s3">\n        </span><span class="s1">Object.assign(pluginState.edgeRscModules, state.edgeRscModules)</span><span class="s3">\n        </span><span class="s1">Object.assign(</span><span class="s3">\n          </span><span class="s1">pluginState.injectedClientEntries,</span><span class="s3">\n          </span><span class="s1">state.injectedClientEntries</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">apply(compiler: Compiler) {</span><span class="s3">\n    </span><span class="s1">this.compiler = compiler</span><span class="s3">\n    </span><span class="s1">this.plugin.apply(compiler)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RspackFlightClientEntryPlugin&quot;</span><span class="s0">,</span><span class="s1">&quot;pluginState&quot;</span><span class="s0">,</span><span class="s1">&quot;getProxiedPluginState&quot;</span><span class="s0">,</span><span class="s1">&quot;serverActions&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeServerActions&quot;</span><span class="s0">,</span><span class="s1">&quot;serverActionModules&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeServerActionModules&quot;</span><span class="s0">,</span><span class="s1">&quot;ssrModules&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeSsrModules&quot;</span><span class="s0">,</span><span class="s1">&quot;rscModules&quot;</span><span class="s0">,</span><span class="s1">&quot;edgeRscModules&quot;</span><span class="s0">,</span><span class="s1">&quot;injectedClientEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;FlightClientEntryPlugin&quot;</span><span class="s0">,</span><span class="s1">&quot;getRspackCore&quot;</span><span class="s0">,</span><span class="s1">&quot;plugin&quot;</span><span class="s0">,</span><span class="s1">&quot;builtinAppLoader&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;BUILTIN_SWC_LOADER&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldInvalidateCb&quot;</span><span class="s0">,</span><span class="s1">&quot;bundlePath&quot;</span><span class="s0">,</span><span class="s1">&quot;entryName&quot;</span><span class="s0">,</span><span class="s1">&quot;absolutePagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;clientBrowserLoader&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldInvalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;compiler&quot;</span><span class="s0">,</span><span class="s1">&quot;entries&quot;</span><span class="s0">,</span><span class="s1">&quot;getEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;outputPath&quot;</span><span class="s0">,</span><span class="s1">&quot;pageKey&quot;</span><span class="s0">,</span><span class="s1">&quot;getEntryKey&quot;</span><span class="s0">,</span><span class="s1">&quot;COMPILER_NAMES&quot;</span><span class="s0">,</span><span class="s1">&quot;client&quot;</span><span class="s0">,</span><span class="s1">&quot;PAGE_TYPES&quot;</span><span class="s0">,</span><span class="s1">&quot;APP&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;EntryTypes&quot;</span><span class="s0">,</span><span class="s1">&quot;CHILD_ENTRY&quot;</span><span class="s0">,</span><span class="s1">&quot;parentEntries&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;absoluteEntryFilePath&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;dispose&quot;</span><span class="s0">,</span><span class="s1">&quot;lastActiveTime&quot;</span><span class="s0">,</span><span class="s1">&quot;Date&quot;</span><span class="s0">,</span><span class="s1">&quot;now&quot;</span><span class="s0">,</span><span class="s1">&quot;entryData&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidateCb&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidator&quot;</span><span class="s0">,</span><span class="s1">&quot;getInvalidator&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidate&quot;</span><span class="s0">,</span><span class="s1">&quot;stateCb&quot;</span><span class="s0">,</span><span class="s1">&quot;state&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;assign&quot;</span><span class="s0">,</span><span class="s1">&quot;apply&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreList&quot;</span><span class="s0">:[</span><span class="s2">0</span><span class="s0">]}</span></pre>
</body>
</html>