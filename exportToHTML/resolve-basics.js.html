<html>
<head>
<title>resolve-basics.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #1750eb;}
.s4 { color: #8c8c8c; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
resolve-basics.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>
<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, {</span>
    <span class="s1">value: </span><span class="s2">true</span>
<span class="s1">});</span>
<span class="s3">0 </span><span class="s1">&amp;&amp; (module.exports = {</span>
    <span class="s1">resolveAlternates: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">resolveAppLinks: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">resolveAppleWebApp: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">resolveFacebook: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">resolveItunes: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">resolvePagination: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">resolveRobots: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">resolveThemeColor: </span><span class="s2">null</span><span class="s1">,</span>
    <span class="s1">resolveVerification: </span><span class="s2">null</span>
<span class="s1">});</span>
<span class="s2">function </span><span class="s1">_export(target, all) {</span>
    <span class="s2">for</span><span class="s1">(</span><span class="s2">var </span><span class="s1">name </span><span class="s2">in </span><span class="s1">all)Object.defineProperty(target, name, {</span>
        <span class="s1">enumerable: </span><span class="s2">true</span><span class="s1">,</span>
        <span class="s1">get: all[name]</span>
    <span class="s1">});</span>
<span class="s1">}</span>
<span class="s1">_export(exports, {</span>
    <span class="s1">resolveAlternates: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveAlternates;</span>
    <span class="s1">},</span>
    <span class="s1">resolveAppLinks: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveAppLinks;</span>
    <span class="s1">},</span>
    <span class="s1">resolveAppleWebApp: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveAppleWebApp;</span>
    <span class="s1">},</span>
    <span class="s1">resolveFacebook: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveFacebook;</span>
    <span class="s1">},</span>
    <span class="s1">resolveItunes: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveItunes;</span>
    <span class="s1">},</span>
    <span class="s1">resolvePagination: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolvePagination;</span>
    <span class="s1">},</span>
    <span class="s1">resolveRobots: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveRobots;</span>
    <span class="s1">},</span>
    <span class="s1">resolveThemeColor: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveThemeColor;</span>
    <span class="s1">},</span>
    <span class="s1">resolveVerification: </span><span class="s2">function</span><span class="s1">() {</span>
        <span class="s2">return </span><span class="s1">resolveVerification;</span>
    <span class="s1">}</span>
<span class="s1">});</span>
<span class="s2">const </span><span class="s1">_utils = require(</span><span class="s0">&quot;../generate/utils&quot;</span><span class="s1">);</span>
<span class="s2">const </span><span class="s1">_resolveurl = require(</span><span class="s0">&quot;./resolve-url&quot;</span><span class="s1">);</span>
<span class="s2">function </span><span class="s1">resolveAlternateUrl(url, metadataBase, pathname, metadataContext) {</span>
    <span class="s4">// If alter native url is an URL instance,</span>
    <span class="s4">// we treat it as a URL base and resolve with current pathname</span>
    <span class="s2">if </span><span class="s1">(url </span><span class="s2">instanceof </span><span class="s1">URL) {</span>
        <span class="s2">const </span><span class="s1">newUrl = </span><span class="s2">new </span><span class="s1">URL(pathname, url);</span>
        <span class="s1">url.searchParams.forEach((value, key)=&gt;newUrl.searchParams.set(key, value));</span>
        <span class="s1">url = newUrl;</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">(</span><span class="s3">0</span><span class="s1">, _resolveurl.resolveAbsoluteUrlWithPathname)(url, metadataBase, pathname, metadataContext);</span>
<span class="s1">}</span>
<span class="s2">const </span><span class="s1">resolveThemeColor = (themeColor)=&gt;{</span>
    <span class="s2">var </span><span class="s1">_resolveAsArrayOrUndefined;</span>
    <span class="s2">if </span><span class="s1">(!themeColor) </span><span class="s2">return null</span><span class="s1">;</span>
    <span class="s2">const </span><span class="s1">themeColorDescriptors = [];</span>
    <span class="s1">(_resolveAsArrayOrUndefined = (</span><span class="s3">0</span><span class="s1">, _utils.resolveAsArrayOrUndefined)(themeColor)) == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: _resolveAsArrayOrUndefined.forEach((descriptor)=&gt;{</span>
        <span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">descriptor === </span><span class="s0">'string'</span><span class="s1">) themeColorDescriptors.push({</span>
            <span class="s1">color: descriptor</span>
        <span class="s1">});</span>
        <span class="s2">else if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">descriptor === </span><span class="s0">'object'</span><span class="s1">) themeColorDescriptors.push({</span>
            <span class="s1">color: descriptor.color,</span>
            <span class="s1">media: descriptor.media</span>
        <span class="s1">});</span>
    <span class="s1">});</span>
    <span class="s2">return </span><span class="s1">themeColorDescriptors;</span>
<span class="s1">};</span>
<span class="s1">async </span><span class="s2">function </span><span class="s1">resolveUrlValuesOfObject(obj, metadataBase, pathname, metadataContext) {</span>
    <span class="s2">if </span><span class="s1">(!obj) </span><span class="s2">return null</span><span class="s1">;</span>
    <span class="s2">const </span><span class="s1">result = {};</span>
    <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">[key, value] of Object.entries(obj)){</span>
        <span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">value === </span><span class="s0">'string' </span><span class="s1">|| value </span><span class="s2">instanceof </span><span class="s1">URL) {</span>
            <span class="s2">const </span><span class="s1">pathnameForUrl = </span><span class="s2">await </span><span class="s1">pathname;</span>
            <span class="s1">result[key] = [</span>
                <span class="s1">{</span>
                    <span class="s1">url: resolveAlternateUrl(value, metadataBase, pathnameForUrl, metadataContext)</span>
                <span class="s1">}</span>
            <span class="s1">];</span>
        <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value &amp;&amp; value.length) {</span>
            <span class="s1">result[key] = [];</span>
            <span class="s2">const </span><span class="s1">pathnameForUrl = </span><span class="s2">await </span><span class="s1">pathname;</span>
            <span class="s1">value.forEach((item, index)=&gt;{</span>
                <span class="s2">const </span><span class="s1">url = resolveAlternateUrl(item.url, metadataBase, pathnameForUrl, metadataContext);</span>
                <span class="s1">result[key][index] = {</span>
                    <span class="s1">url,</span>
                    <span class="s1">title: item.title</span>
                <span class="s1">};</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">result;</span>
<span class="s1">}</span>
<span class="s1">async </span><span class="s2">function </span><span class="s1">resolveCanonicalUrl(urlOrDescriptor, metadataBase, pathname, metadataContext) {</span>
    <span class="s2">if </span><span class="s1">(!urlOrDescriptor) </span><span class="s2">return null</span><span class="s1">;</span>
    <span class="s2">const </span><span class="s1">url = </span><span class="s2">typeof </span><span class="s1">urlOrDescriptor === </span><span class="s0">'string' </span><span class="s1">|| urlOrDescriptor </span><span class="s2">instanceof </span><span class="s1">URL ? urlOrDescriptor : urlOrDescriptor.url;</span>
    <span class="s2">const </span><span class="s1">pathnameForUrl = </span><span class="s2">await </span><span class="s1">pathname;</span>
    <span class="s4">// Return string url because structureClone can't handle URL instance</span>
    <span class="s2">return </span><span class="s1">{</span>
        <span class="s1">url: resolveAlternateUrl(url, metadataBase, pathnameForUrl, metadataContext)</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s2">const </span><span class="s1">resolveAlternates = async (alternates, metadataBase, pathname, context)=&gt;{</span>
    <span class="s2">if </span><span class="s1">(!alternates) </span><span class="s2">return null</span><span class="s1">;</span>
    <span class="s2">const </span><span class="s1">canonical = </span><span class="s2">await </span><span class="s1">resolveCanonicalUrl(alternates.canonical, metadataBase, pathname, context);</span>
    <span class="s2">const </span><span class="s1">languages = </span><span class="s2">await </span><span class="s1">resolveUrlValuesOfObject(alternates.languages, metadataBase, pathname, context);</span>
    <span class="s2">const </span><span class="s1">media = </span><span class="s2">await </span><span class="s1">resolveUrlValuesOfObject(alternates.media, metadataBase, pathname, context);</span>
    <span class="s2">const </span><span class="s1">types = </span><span class="s2">await </span><span class="s1">resolveUrlValuesOfObject(alternates.types, metadataBase, pathname, context);</span>
    <span class="s2">const </span><span class="s1">result = {</span>
        <span class="s1">canonical,</span>
        <span class="s1">languages,</span>
        <span class="s1">media,</span>
        <span class="s1">types</span>
    <span class="s1">};</span>
    <span class="s2">return </span><span class="s1">result;</span>
<span class="s1">};</span>
<span class="s2">const </span><span class="s1">robotsKeys = [</span>
    <span class="s0">'noarchive'</span><span class="s1">,</span>
    <span class="s0">'nosnippet'</span><span class="s1">,</span>
    <span class="s0">'noimageindex'</span><span class="s1">,</span>
    <span class="s0">'nocache'</span><span class="s1">,</span>
    <span class="s0">'notranslate'</span><span class="s1">,</span>
    <span class="s0">'indexifembedded'</span><span class="s1">,</span>
    <span class="s0">'nositelinkssearchbox'</span><span class="s1">,</span>
    <span class="s0">'unavailable_after'</span><span class="s1">,</span>
    <span class="s0">'max-video-preview'</span><span class="s1">,</span>
    <span class="s0">'max-image-preview'</span><span class="s1">,</span>
    <span class="s0">'max-snippet'</span>
<span class="s1">];</span>
<span class="s2">const </span><span class="s1">resolveRobotsValue = (robots)=&gt;{</span>
    <span class="s2">if </span><span class="s1">(!robots) </span><span class="s2">return null</span><span class="s1">;</span>
    <span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">robots === </span><span class="s0">'string'</span><span class="s1">) </span><span class="s2">return </span><span class="s1">robots;</span>
    <span class="s2">const </span><span class="s1">values = [];</span>
    <span class="s2">if </span><span class="s1">(robots.index) values.push(</span><span class="s0">'index'</span><span class="s1">);</span>
    <span class="s2">else if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">robots.index === </span><span class="s0">'boolean'</span><span class="s1">) values.push(</span><span class="s0">'noindex'</span><span class="s1">);</span>
    <span class="s2">if </span><span class="s1">(robots.follow) values.push(</span><span class="s0">'follow'</span><span class="s1">);</span>
    <span class="s2">else if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">robots.follow === </span><span class="s0">'boolean'</span><span class="s1">) values.push(</span><span class="s0">'nofollow'</span><span class="s1">);</span>
    <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">key of robotsKeys){</span>
        <span class="s2">const </span><span class="s1">value = robots[key];</span>
        <span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">value !== </span><span class="s0">'undefined' </span><span class="s1">&amp;&amp; value !== </span><span class="s2">false</span><span class="s1">) {</span>
            <span class="s1">values.push(</span><span class="s2">typeof </span><span class="s1">value === </span><span class="s0">'boolean' </span><span class="s1">? key : </span><span class="s0">`</span><span class="s1">${key}</span><span class="s0">:</span><span class="s1">${value}</span><span class="s0">`</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">values.join(</span><span class="s0">', '</span><span class="s1">);</span>
<span class="s1">};</span>
<span class="s2">const </span><span class="s1">resolveRobots = (robots)=&gt;{</span>
    <span class="s2">if </span><span class="s1">(!robots) </span><span class="s2">return null</span><span class="s1">;</span>
    <span class="s2">return </span><span class="s1">{</span>
        <span class="s1">basic: resolveRobotsValue(robots),</span>
        <span class="s1">googleBot: </span><span class="s2">typeof </span><span class="s1">robots !== </span><span class="s0">'string' </span><span class="s1">? resolveRobotsValue(robots.googleBot) : </span><span class="s2">null</span>
    <span class="s1">};</span>
<span class="s1">};</span>
<span class="s2">const </span><span class="s1">VerificationKeys = [</span>
    <span class="s0">'google'</span><span class="s1">,</span>
    <span class="s0">'yahoo'</span><span class="s1">,</span>
    <span class="s0">'yandex'</span><span class="s1">,</span>
    <span class="s0">'me'</span><span class="s1">,</span>
    <span class="s0">'other'</span>
<span class="s1">];</span>
<span class="s2">const </span><span class="s1">resolveVerification = (verification)=&gt;{</span>
    <span class="s2">if </span><span class="s1">(!verification) </span><span class="s2">return null</span><span class="s1">;</span>
    <span class="s2">const </span><span class="s1">res = {};</span>
    <span class="s2">for </span><span class="s1">(</span><span class="s2">const </span><span class="s1">key of VerificationKeys){</span>
        <span class="s2">const </span><span class="s1">value = verification[key];</span>
        <span class="s2">if </span><span class="s1">(value) {</span>
            <span class="s2">if </span><span class="s1">(key === </span><span class="s0">'other'</span><span class="s1">) {</span>
                <span class="s1">res.other = {};</span>
                <span class="s2">for</span><span class="s1">(</span><span class="s2">const </span><span class="s1">otherKey </span><span class="s2">in </span><span class="s1">verification.other){</span>
                    <span class="s2">const </span><span class="s1">otherValue = (</span><span class="s3">0</span><span class="s1">, _utils.resolveAsArrayOrUndefined)(verification.other[otherKey]);</span>
                    <span class="s2">if </span><span class="s1">(otherValue) res.other[otherKey] = otherValue;</span>
                <span class="s1">}</span>
            <span class="s1">} </span><span class="s2">else </span><span class="s1">res[key] = (</span><span class="s3">0</span><span class="s1">, _utils.resolveAsArrayOrUndefined)(value);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">res;</span>
<span class="s1">};</span>
<span class="s2">const </span><span class="s1">resolveAppleWebApp = (appWebApp)=&gt;{</span>
    <span class="s2">var </span><span class="s1">_resolveAsArrayOrUndefined;</span>
    <span class="s2">if </span><span class="s1">(!appWebApp) </span><span class="s2">return null</span><span class="s1">;</span>
    <span class="s2">if </span><span class="s1">(appWebApp === </span><span class="s2">true</span><span class="s1">) {</span>
        <span class="s2">return </span><span class="s1">{</span>
            <span class="s1">capable: </span><span class="s2">true</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
    <span class="s2">const </span><span class="s1">startupImages = appWebApp.startupImage ? (_resolveAsArrayOrUndefined = (</span><span class="s3">0</span><span class="s1">, _utils.resolveAsArrayOrUndefined)(appWebApp.startupImage)) == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: _resolveAsArrayOrUndefined.map((item)=&gt;</span><span class="s2">typeof </span><span class="s1">item === </span><span class="s0">'string' </span><span class="s1">? {</span>
            <span class="s1">url: item</span>
        <span class="s1">} : item) : </span><span class="s2">null</span><span class="s1">;</span>
    <span class="s2">return </span><span class="s1">{</span>
        <span class="s1">capable: </span><span class="s0">'capable' </span><span class="s2">in </span><span class="s1">appWebApp ? !!appWebApp.capable : </span><span class="s2">true</span><span class="s1">,</span>
        <span class="s1">title: appWebApp.title || </span><span class="s2">null</span><span class="s1">,</span>
        <span class="s1">startupImage: startupImages,</span>
        <span class="s1">statusBarStyle: appWebApp.statusBarStyle || </span><span class="s0">'default'</span>
    <span class="s1">};</span>
<span class="s1">};</span>
<span class="s2">const </span><span class="s1">resolveAppLinks = (appLinks)=&gt;{</span>
    <span class="s2">if </span><span class="s1">(!appLinks) </span><span class="s2">return null</span><span class="s1">;</span>
    <span class="s2">for</span><span class="s1">(</span><span class="s2">const </span><span class="s1">key </span><span class="s2">in </span><span class="s1">appLinks){</span>
        <span class="s4">// @ts-ignore // TODO: type infer</span>
        <span class="s1">appLinks[key] = (</span><span class="s3">0</span><span class="s1">, _utils.resolveAsArrayOrUndefined)(appLinks[key]);</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">appLinks;</span>
<span class="s1">};</span>
<span class="s2">const </span><span class="s1">resolveItunes = async (itunes, metadataBase, pathname, context)=&gt;{</span>
    <span class="s2">if </span><span class="s1">(!itunes) </span><span class="s2">return null</span><span class="s1">;</span>
    <span class="s2">return </span><span class="s1">{</span>
        <span class="s1">appId: itunes.appId,</span>
        <span class="s1">appArgument: itunes.appArgument ? resolveAlternateUrl(itunes.appArgument, metadataBase, </span><span class="s2">await </span><span class="s1">pathname, context) : undefined</span>
    <span class="s1">};</span>
<span class="s1">};</span>
<span class="s2">const </span><span class="s1">resolveFacebook = (facebook)=&gt;{</span>
    <span class="s2">if </span><span class="s1">(!facebook) </span><span class="s2">return null</span><span class="s1">;</span>
    <span class="s2">return </span><span class="s1">{</span>
        <span class="s1">appId: facebook.appId,</span>
        <span class="s1">admins: (</span><span class="s3">0</span><span class="s1">, _utils.resolveAsArrayOrUndefined)(facebook.admins)</span>
    <span class="s1">};</span>
<span class="s1">};</span>
<span class="s2">const </span><span class="s1">resolvePagination = async (pagination, metadataBase, pathname, context)=&gt;{</span>
    <span class="s2">return </span><span class="s1">{</span>
        <span class="s1">previous: (pagination == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: pagination.previous) ? resolveAlternateUrl(pagination.previous, metadataBase, </span><span class="s2">await </span><span class="s1">pathname, context) : </span><span class="s2">null</span><span class="s1">,</span>
        <span class="s1">next: (pagination == </span><span class="s2">null </span><span class="s1">? </span><span class="s2">void </span><span class="s3">0 </span><span class="s1">: pagination.next) ? resolveAlternateUrl(pagination.next, metadataBase, </span><span class="s2">await </span><span class="s1">pathname, context) : </span><span class="s2">null</span>
    <span class="s1">};</span>
<span class="s1">};</span>

<span class="s4">//# sourceMappingURL=resolve-basics.js.map</span></pre>
</body>
</html>