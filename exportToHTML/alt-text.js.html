<html>
<head>
<title>alt-text.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #067d17;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #1750eb;}
.s4 { color: #8c8c8c; font-style: italic;}
.s5 { color: #8c8c8c; font-style: italic;}
.s6 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
alt-text.js</font>
</center></td></tr></table>
<pre><span class="s0">&quot;use strict&quot;</span><span class="s1">;</span>

<span class="s1">Object.defineProperty(exports, </span><span class="s0">&quot;__esModule&quot;</span><span class="s1">, {</span>
  <span class="s1">value: </span><span class="s2">true</span>
<span class="s1">});</span>
<span class="s1">exports[</span><span class="s0">&quot;default&quot;</span><span class="s1">] = </span><span class="s2">void </span><span class="s3">0</span><span class="s1">;</span>
<span class="s2">var </span><span class="s1">_jsxAstUtils = require(</span><span class="s0">&quot;jsx-ast-utils&quot;</span><span class="s1">);</span>
<span class="s2">var </span><span class="s1">_arrayPrototype = _interopRequireDefault(require(</span><span class="s0">&quot;array.prototype.flatmap&quot;</span><span class="s1">));</span>
<span class="s2">var </span><span class="s1">_schemas = require(</span><span class="s0">&quot;../util/schemas&quot;</span><span class="s1">);</span>
<span class="s2">var </span><span class="s1">_getElementType = _interopRequireDefault(require(</span><span class="s0">&quot;../util/getElementType&quot;</span><span class="s1">));</span>
<span class="s2">var </span><span class="s1">_hasAccessibleChild = _interopRequireDefault(require(</span><span class="s0">&quot;../util/hasAccessibleChild&quot;</span><span class="s1">));</span>
<span class="s2">var </span><span class="s1">_isPresentationRole = _interopRequireDefault(require(</span><span class="s0">&quot;../util/isPresentationRole&quot;</span><span class="s1">));</span>
<span class="s2">function </span><span class="s1">_interopRequireDefault(e) { </span><span class="s2">return </span><span class="s1">e &amp;&amp; e.__esModule ? e : { </span><span class="s0">&quot;default&quot;</span><span class="s1">: e }; }</span>
<span class="s4">/**</span>
 <span class="s4">* </span><span class="s5">@fileoverview </span><span class="s4">Enforce all elements that require alternative text have it.</span>
 <span class="s4">* </span><span class="s5">@author </span><span class="s4">Ethan Cohen</span>
 <span class="s4">*/</span>

<span class="s4">// ----------------------------------------------------------------------------</span>
<span class="s4">// Rule Definition</span>
<span class="s4">// ----------------------------------------------------------------------------</span>

<span class="s2">var </span><span class="s1">DEFAULT_ELEMENTS = [</span><span class="s0">'img'</span><span class="s1">, </span><span class="s0">'object'</span><span class="s1">, </span><span class="s0">'area'</span><span class="s1">, </span><span class="s0">'input[type=&quot;image&quot;]'</span><span class="s1">];</span>
<span class="s2">var </span><span class="s1">schema = (</span><span class="s3">0</span><span class="s1">, _schemas.generateObjSchema)({</span>
  <span class="s1">elements: _schemas.arraySchema,</span>
  <span class="s1">img: _schemas.arraySchema,</span>
  <span class="s1">object: _schemas.arraySchema,</span>
  <span class="s1">area: _schemas.arraySchema,</span>
  <span class="s0">'input[type=&quot;image&quot;]'</span><span class="s1">: _schemas.arraySchema</span>
<span class="s1">});</span>
<span class="s2">var </span><span class="s1">ariaLabelHasValue = </span><span class="s2">function </span><span class="s1">ariaLabelHasValue(prop) {</span>
  <span class="s2">var </span><span class="s1">value = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getPropValue)(prop);</span>
  <span class="s2">if </span><span class="s1">(value === undefined) {</span>
    <span class="s2">return false</span><span class="s1">;</span>
  <span class="s1">}</span>
  <span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">value === </span><span class="s0">'string' </span><span class="s1">&amp;&amp; value.length === </span><span class="s3">0</span><span class="s1">) {</span>
    <span class="s2">return false</span><span class="s1">;</span>
  <span class="s1">}</span>
  <span class="s2">return true</span><span class="s1">;</span>
<span class="s1">};</span>
<span class="s2">var </span><span class="s1">ruleByElement = {</span>
  <span class="s1">img(context, node, nodeType) {</span>
    <span class="s2">var </span><span class="s1">altProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'alt'</span><span class="s1">);</span>

    <span class="s4">// Missing alt prop error.</span>
    <span class="s2">if </span><span class="s1">(altProp === undefined) {</span>
      <span class="s2">if </span><span class="s1">((</span><span class="s3">0</span><span class="s1">, _isPresentationRole[</span><span class="s0">&quot;default&quot;</span><span class="s1">])(nodeType, node.attributes)) {</span>
        <span class="s1">context.report({</span>
          <span class="s1">node,</span>
          <span class="s1">message: </span><span class="s0">'Prefer alt=&quot;&quot; over a presentational role. First rule of aria is to not use aria if it can be achieved via native HTML.'</span>
        <span class="s1">});</span>
        <span class="s2">return</span><span class="s1">;</span>
      <span class="s1">}</span>
      <span class="s4">// Check for `aria-label` to provide text alternative</span>
      <span class="s4">// Don't create an error if the attribute is used correctly. But if it</span>
      <span class="s4">// isn't, suggest that the developer use `alt` instead.</span>
      <span class="s2">var </span><span class="s1">ariaLabelProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'aria-label'</span><span class="s1">);</span>
      <span class="s2">if </span><span class="s1">(ariaLabelProp !== undefined) {</span>
        <span class="s2">if </span><span class="s1">(!ariaLabelHasValue(ariaLabelProp)) {</span>
          <span class="s1">context.report({</span>
            <span class="s1">node,</span>
            <span class="s1">message: </span><span class="s0">'The aria-label attribute must have a value. The alt attribute is preferred over aria-label for images.'</span>
          <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s2">return</span><span class="s1">;</span>
      <span class="s1">}</span>
      <span class="s4">// Check for `aria-labelledby` to provide text alternative</span>
      <span class="s4">// Don't create an error if the attribute is used correctly. But if it</span>
      <span class="s4">// isn't, suggest that the developer use `alt` instead.</span>
      <span class="s2">var </span><span class="s1">ariaLabelledbyProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'aria-labelledby'</span><span class="s1">);</span>
      <span class="s2">if </span><span class="s1">(ariaLabelledbyProp !== undefined) {</span>
        <span class="s2">if </span><span class="s1">(!ariaLabelHasValue(ariaLabelledbyProp)) {</span>
          <span class="s1">context.report({</span>
            <span class="s1">node,</span>
            <span class="s1">message: </span><span class="s0">'The aria-labelledby attribute must have a value. The alt attribute is preferred over aria-labelledby for images.'</span>
          <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s2">return</span><span class="s1">;</span>
      <span class="s1">}</span>
      <span class="s1">context.report({</span>
        <span class="s1">node,</span>
        <span class="s1">message: </span><span class="s0">&quot;&quot;</span><span class="s1">.concat(nodeType, </span><span class="s0">&quot; elements must have an alt prop, either with meaningful text, or an empty string for decorative images.&quot;</span><span class="s1">)</span>
      <span class="s1">});</span>
      <span class="s2">return</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s4">// Check if alt prop is undefined.</span>
    <span class="s2">var </span><span class="s1">altValue = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getPropValue)(altProp);</span>
    <span class="s2">var </span><span class="s1">isNullValued = altProp.value === </span><span class="s2">null</span><span class="s1">; </span><span class="s4">// &lt;img alt /&gt;</span>

    <span class="s2">if </span><span class="s1">(altValue &amp;&amp; !isNullValued || altValue === </span><span class="s0">''</span><span class="s1">) {</span>
      <span class="s2">return</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s4">// Undefined alt prop error.</span>
    <span class="s1">context.report({</span>
      <span class="s1">node,</span>
      <span class="s1">message: </span><span class="s0">&quot;Invalid alt value for &quot;</span><span class="s1">.concat(nodeType, </span><span class="s0">&quot;. Use alt=</span><span class="s6">\&quot;\&quot; </span><span class="s0">for presentational images.&quot;</span><span class="s1">)</span>
    <span class="s1">});</span>
  <span class="s1">},</span>
  <span class="s1">object(context, node, unusedNodeType, elementType) {</span>
    <span class="s2">var </span><span class="s1">ariaLabelProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'aria-label'</span><span class="s1">);</span>
    <span class="s2">var </span><span class="s1">arialLabelledByProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'aria-labelledby'</span><span class="s1">);</span>
    <span class="s2">var </span><span class="s1">hasLabel = ariaLabelHasValue(ariaLabelProp) || ariaLabelHasValue(arialLabelledByProp);</span>
    <span class="s2">var </span><span class="s1">titleProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getLiteralPropValue)((</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'title'</span><span class="s1">));</span>
    <span class="s2">var </span><span class="s1">hasTitleAttr = !!titleProp;</span>
    <span class="s2">if </span><span class="s1">(hasLabel || hasTitleAttr || (</span><span class="s3">0</span><span class="s1">, _hasAccessibleChild[</span><span class="s0">&quot;default&quot;</span><span class="s1">])(node.parent, elementType)) {</span>
      <span class="s2">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s1">context.report({</span>
      <span class="s1">node,</span>
      <span class="s1">message: </span><span class="s0">'Embedded &lt;object&gt; elements must have alternative text by providing inner text, aria-label or aria-labelledby props.'</span>
    <span class="s1">});</span>
  <span class="s1">},</span>
  <span class="s1">area(context, node) {</span>
    <span class="s2">var </span><span class="s1">ariaLabelProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'aria-label'</span><span class="s1">);</span>
    <span class="s2">var </span><span class="s1">arialLabelledByProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'aria-labelledby'</span><span class="s1">);</span>
    <span class="s2">var </span><span class="s1">hasLabel = ariaLabelHasValue(ariaLabelProp) || ariaLabelHasValue(arialLabelledByProp);</span>
    <span class="s2">if </span><span class="s1">(hasLabel) {</span>
      <span class="s2">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">var </span><span class="s1">altProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'alt'</span><span class="s1">);</span>
    <span class="s2">if </span><span class="s1">(altProp === undefined) {</span>
      <span class="s1">context.report({</span>
        <span class="s1">node,</span>
        <span class="s1">message: </span><span class="s0">'Each area of an image map must have a text alternative through the `alt`, `aria-label`, or `aria-labelledby` prop.'</span>
      <span class="s1">});</span>
      <span class="s2">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">var </span><span class="s1">altValue = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getPropValue)(altProp);</span>
    <span class="s2">var </span><span class="s1">isNullValued = altProp.value === </span><span class="s2">null</span><span class="s1">; </span><span class="s4">// &lt;area alt /&gt;</span>

    <span class="s2">if </span><span class="s1">(altValue &amp;&amp; !isNullValued || altValue === </span><span class="s0">''</span><span class="s1">) {</span>
      <span class="s2">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s1">context.report({</span>
      <span class="s1">node,</span>
      <span class="s1">message: </span><span class="s0">'Each area of an image map must have a text alternative through the `alt`, `aria-label`, or `aria-labelledby` prop.'</span>
    <span class="s1">});</span>
  <span class="s1">},</span>
  <span class="s0">'input[type=&quot;image&quot;]'</span><span class="s1">: </span><span class="s2">function </span><span class="s1">inputImage(context, node, nodeType) {</span>
    <span class="s4">// Only test input[type=&quot;image&quot;]</span>
    <span class="s2">if </span><span class="s1">(nodeType === </span><span class="s0">'input'</span><span class="s1">) {</span>
      <span class="s2">var </span><span class="s1">typePropValue = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getPropValue)((</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'type'</span><span class="s1">));</span>
      <span class="s2">if </span><span class="s1">(typePropValue !== </span><span class="s0">'image'</span><span class="s1">) {</span>
        <span class="s2">return</span><span class="s1">;</span>
      <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">var </span><span class="s1">ariaLabelProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'aria-label'</span><span class="s1">);</span>
    <span class="s2">var </span><span class="s1">arialLabelledByProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'aria-labelledby'</span><span class="s1">);</span>
    <span class="s2">var </span><span class="s1">hasLabel = ariaLabelHasValue(ariaLabelProp) || ariaLabelHasValue(arialLabelledByProp);</span>
    <span class="s2">if </span><span class="s1">(hasLabel) {</span>
      <span class="s2">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">var </span><span class="s1">altProp = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getProp)(node.attributes, </span><span class="s0">'alt'</span><span class="s1">);</span>
    <span class="s2">if </span><span class="s1">(altProp === undefined) {</span>
      <span class="s1">context.report({</span>
        <span class="s1">node,</span>
        <span class="s1">message: </span><span class="s0">'&lt;input&gt; elements with type=&quot;image&quot; must have a text alternative through the `alt`, `aria-label`, or `aria-labelledby` prop.'</span>
      <span class="s1">});</span>
      <span class="s2">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">var </span><span class="s1">altValue = (</span><span class="s3">0</span><span class="s1">, _jsxAstUtils.getPropValue)(altProp);</span>
    <span class="s2">var </span><span class="s1">isNullValued = altProp.value === </span><span class="s2">null</span><span class="s1">; </span><span class="s4">// &lt;area alt /&gt;</span>

    <span class="s2">if </span><span class="s1">(altValue &amp;&amp; !isNullValued || altValue === </span><span class="s0">''</span><span class="s1">) {</span>
      <span class="s2">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s1">context.report({</span>
      <span class="s1">node,</span>
      <span class="s1">message: </span><span class="s0">'&lt;input&gt; elements with type=&quot;image&quot; must have a text alternative through the `alt`, `aria-label`, or `aria-labelledby` prop.'</span>
    <span class="s1">});</span>
  <span class="s1">}</span>
<span class="s1">};</span>
<span class="s2">var </span><span class="s1">_default = exports[</span><span class="s0">&quot;default&quot;</span><span class="s1">] = {</span>
  <span class="s1">meta: {</span>
    <span class="s1">docs: {</span>
      <span class="s1">url: </span><span class="s0">'https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/tree/HEAD/docs/rules/alt-text.md'</span><span class="s1">,</span>
      <span class="s1">description: </span><span class="s0">'Enforce all elements that require alternative text have meaningful information to relay back to end user.'</span>
    <span class="s1">},</span>
    <span class="s1">schema: [schema]</span>
  <span class="s1">},</span>
  <span class="s1">create: </span><span class="s2">function </span><span class="s1">create(context) {</span>
    <span class="s2">var </span><span class="s1">options = context.options[</span><span class="s3">0</span><span class="s1">] || {};</span>
    <span class="s4">// Elements to validate for alt text.</span>
    <span class="s2">var </span><span class="s1">elementOptions = options.elements || DEFAULT_ELEMENTS;</span>
    <span class="s4">// Get custom components for just the elements that will be tested.</span>
    <span class="s2">var </span><span class="s1">customComponents = (</span><span class="s3">0</span><span class="s1">, _arrayPrototype[</span><span class="s0">&quot;default&quot;</span><span class="s1">])(elementOptions, </span><span class="s2">function </span><span class="s1">(element) {</span>
      <span class="s2">return </span><span class="s1">options[element];</span>
    <span class="s1">});</span>
    <span class="s2">var </span><span class="s1">typesToValidate = </span><span class="s2">new </span><span class="s1">Set([].concat(customComponents, elementOptions).map(</span><span class="s2">function </span><span class="s1">(type) {</span>
      <span class="s2">return </span><span class="s1">type === </span><span class="s0">'input[type=&quot;image&quot;]' </span><span class="s1">? </span><span class="s0">'input' </span><span class="s1">: type;</span>
    <span class="s1">}));</span>
    <span class="s2">var </span><span class="s1">elementType = (</span><span class="s3">0</span><span class="s1">, _getElementType[</span><span class="s0">&quot;default&quot;</span><span class="s1">])(context);</span>
    <span class="s2">return </span><span class="s1">{</span>
      <span class="s1">JSXOpeningElement(node) {</span>
        <span class="s2">var </span><span class="s1">nodeType = elementType(node);</span>
        <span class="s2">if </span><span class="s1">(!typesToValidate.has(nodeType)) {</span>
          <span class="s2">return</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s2">var </span><span class="s1">DOMElement = nodeType;</span>
        <span class="s2">if </span><span class="s1">(DOMElement === </span><span class="s0">'input'</span><span class="s1">) {</span>
          <span class="s1">DOMElement = </span><span class="s0">'input[type=&quot;image&quot;]'</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s4">// Map nodeType to the DOM element if we are running this on a custom component.</span>
        <span class="s2">if </span><span class="s1">(elementOptions.indexOf(DOMElement) === -</span><span class="s3">1</span><span class="s1">) {</span>
          <span class="s1">DOMElement = elementOptions.find(</span><span class="s2">function </span><span class="s1">(element) {</span>
            <span class="s2">var </span><span class="s1">customComponentsForElement = options[element] || [];</span>
            <span class="s2">return </span><span class="s1">customComponentsForElement.indexOf(nodeType) &gt; -</span><span class="s3">1</span><span class="s1">;</span>
          <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s1">ruleByElement[DOMElement](context, node, nodeType, elementType);</span>
      <span class="s1">}</span>
    <span class="s1">};</span>
  <span class="s1">}</span>
<span class="s1">};</span>
<span class="s1">module.exports = exports.default;</span></pre>
</body>
</html>